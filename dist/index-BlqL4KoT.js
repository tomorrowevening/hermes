var OEe=Object.defineProperty;var FEe=(o,e,t)=>e in o?OEe(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var et=(o,e,t)=>FEe(o,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();var vo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function H2e(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var nz={exports:{}},iw={},rz={exports:{}},Si={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xpe;function LEe(){if(xpe)return Si;xpe=1;var o=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),a=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),x=Symbol.iterator;function S(De){return De===null||typeof De!="object"?null:(De=x&&De[x]||De["@@iterator"],typeof De=="function"?De:null)}var C={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},I=Object.assign,L={};function U(De,_t,Jt){this.props=De,this.context=_t,this.refs=L,this.updater=Jt||C}U.prototype.isReactComponent={},U.prototype.setState=function(De,_t){if(typeof De!="object"&&typeof De!="function"&&De!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,De,_t,"setState")},U.prototype.forceUpdate=function(De){this.updater.enqueueForceUpdate(this,De,"forceUpdate")};function R(){}R.prototype=U.prototype;function $(De,_t,Jt){this.props=De,this.context=_t,this.refs=L,this.updater=Jt||C}var Z=$.prototype=new R;Z.constructor=$,I(Z,U.prototype),Z.isPureReactComponent=!0;var k=Array.isArray,ie=Object.prototype.hasOwnProperty,ue={current:null},ce={key:!0,ref:!0,__self:!0,__source:!0};function Q(De,_t,Jt){var dt,Dt={},gn=null,qt=null;if(_t!=null)for(dt in _t.ref!==void 0&&(qt=_t.ref),_t.key!==void 0&&(gn=""+_t.key),_t)ie.call(_t,dt)&&!ce.hasOwnProperty(dt)&&(Dt[dt]=_t[dt]);var wn=arguments.length-2;if(wn===1)Dt.children=Jt;else if(1<wn){for(var nr=Array(wn),qn=0;qn<wn;qn++)nr[qn]=arguments[qn+2];Dt.children=nr}if(De&&De.defaultProps)for(dt in wn=De.defaultProps,wn)Dt[dt]===void 0&&(Dt[dt]=wn[dt]);return{$$typeof:o,type:De,key:gn,ref:qt,props:Dt,_owner:ue.current}}function ae(De,_t){return{$$typeof:o,type:De.type,key:_t,ref:De.ref,props:De.props,_owner:De._owner}}function le(De){return typeof De=="object"&&De!==null&&De.$$typeof===o}function J(De){var _t={"=":"=0",":":"=2"};return"$"+De.replace(/[=:]/g,function(Jt){return _t[Jt]})}var Ue=/\/+/g;function je(De,_t){return typeof De=="object"&&De!==null&&De.key!=null?J(""+De.key):_t.toString(36)}function rt(De,_t,Jt,dt,Dt){var gn=typeof De;(gn==="undefined"||gn==="boolean")&&(De=null);var qt=!1;if(De===null)qt=!0;else switch(gn){case"string":case"number":qt=!0;break;case"object":switch(De.$$typeof){case o:case e:qt=!0}}if(qt)return qt=De,Dt=Dt(qt),De=dt===""?"."+je(qt,0):dt,k(Dt)?(Jt="",De!=null&&(Jt=De.replace(Ue,"$&/")+"/"),rt(Dt,_t,Jt,"",function(qn){return qn})):Dt!=null&&(le(Dt)&&(Dt=ae(Dt,Jt+(!Dt.key||qt&&qt.key===Dt.key?"":(""+Dt.key).replace(Ue,"$&/")+"/")+De)),_t.push(Dt)),1;if(qt=0,dt=dt===""?".":dt+":",k(De))for(var wn=0;wn<De.length;wn++){gn=De[wn];var nr=dt+je(gn,wn);qt+=rt(gn,_t,Jt,nr,Dt)}else if(nr=S(De),typeof nr=="function")for(De=nr.call(De),wn=0;!(gn=De.next()).done;)gn=gn.value,nr=dt+je(gn,wn++),qt+=rt(gn,_t,Jt,nr,Dt);else if(gn==="object")throw _t=String(De),Error("Objects are not valid as a React child (found: "+(_t==="[object Object]"?"object with keys {"+Object.keys(De).join(", ")+"}":_t)+"). If you meant to render a collection of children, use an array instead.");return qt}function at(De,_t,Jt){if(De==null)return De;var dt=[],Dt=0;return rt(De,dt,"","",function(gn){return _t.call(Jt,gn,Dt++)}),dt}function Se(De){if(De._status===-1){var _t=De._result;_t=_t(),_t.then(function(Jt){(De._status===0||De._status===-1)&&(De._status=1,De._result=Jt)},function(Jt){(De._status===0||De._status===-1)&&(De._status=2,De._result=Jt)}),De._status===-1&&(De._status=0,De._result=_t)}if(De._status===1)return De._result.default;throw De._result}var gt={current:null},Ae={transition:null},lt={ReactCurrentDispatcher:gt,ReactCurrentBatchConfig:Ae,ReactCurrentOwner:ue};function pt(){throw Error("act(...) is not supported in production builds of React.")}return Si.Children={map:at,forEach:function(De,_t,Jt){at(De,function(){_t.apply(this,arguments)},Jt)},count:function(De){var _t=0;return at(De,function(){_t++}),_t},toArray:function(De){return at(De,function(_t){return _t})||[]},only:function(De){if(!le(De))throw Error("React.Children.only expected to receive a single React element child.");return De}},Si.Component=U,Si.Fragment=t,Si.Profiler=r,Si.PureComponent=$,Si.StrictMode=n,Si.Suspense=h,Si.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lt,Si.act=pt,Si.cloneElement=function(De,_t,Jt){if(De==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+De+".");var dt=I({},De.props),Dt=De.key,gn=De.ref,qt=De._owner;if(_t!=null){if(_t.ref!==void 0&&(gn=_t.ref,qt=ue.current),_t.key!==void 0&&(Dt=""+_t.key),De.type&&De.type.defaultProps)var wn=De.type.defaultProps;for(nr in _t)ie.call(_t,nr)&&!ce.hasOwnProperty(nr)&&(dt[nr]=_t[nr]===void 0&&wn!==void 0?wn[nr]:_t[nr])}var nr=arguments.length-2;if(nr===1)dt.children=Jt;else if(1<nr){wn=Array(nr);for(var qn=0;qn<nr;qn++)wn[qn]=arguments[qn+2];dt.children=wn}return{$$typeof:o,type:De.type,key:Dt,ref:gn,props:dt,_owner:qt}},Si.createContext=function(De){return De={$$typeof:a,_currentValue:De,_currentValue2:De,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},De.Provider={$$typeof:i,_context:De},De.Consumer=De},Si.createElement=Q,Si.createFactory=function(De){var _t=Q.bind(null,De);return _t.type=De,_t},Si.createRef=function(){return{current:null}},Si.forwardRef=function(De){return{$$typeof:c,render:De}},Si.isValidElement=le,Si.lazy=function(De){return{$$typeof:v,_payload:{_status:-1,_result:De},_init:Se}},Si.memo=function(De,_t){return{$$typeof:p,type:De,compare:_t===void 0?null:_t}},Si.startTransition=function(De){var _t=Ae.transition;Ae.transition={};try{De()}finally{Ae.transition=_t}},Si.unstable_act=pt,Si.useCallback=function(De,_t){return gt.current.useCallback(De,_t)},Si.useContext=function(De){return gt.current.useContext(De)},Si.useDebugValue=function(){},Si.useDeferredValue=function(De){return gt.current.useDeferredValue(De)},Si.useEffect=function(De,_t){return gt.current.useEffect(De,_t)},Si.useId=function(){return gt.current.useId()},Si.useImperativeHandle=function(De,_t,Jt){return gt.current.useImperativeHandle(De,_t,Jt)},Si.useInsertionEffect=function(De,_t){return gt.current.useInsertionEffect(De,_t)},Si.useLayoutEffect=function(De,_t){return gt.current.useLayoutEffect(De,_t)},Si.useMemo=function(De,_t){return gt.current.useMemo(De,_t)},Si.useReducer=function(De,_t,Jt){return gt.current.useReducer(De,_t,Jt)},Si.useRef=function(De){return gt.current.useRef(De)},Si.useState=function(De){return gt.current.useState(De)},Si.useSyncExternalStore=function(De,_t,Jt){return gt.current.useSyncExternalStore(De,_t,Jt)},Si.useTransition=function(){return gt.current.useTransition()},Si.version="18.3.1",Si}var bpe;function sH(){return bpe||(bpe=1,rz.exports=LEe()),rz.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Spe;function BEe(){if(Spe)return iw;Spe=1;var o=sH(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,r=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function a(c,h,p){var v,x={},S=null,C=null;p!==void 0&&(S=""+p),h.key!==void 0&&(S=""+h.key),h.ref!==void 0&&(C=h.ref);for(v in h)n.call(h,v)&&!i.hasOwnProperty(v)&&(x[v]=h[v]);if(c&&c.defaultProps)for(v in h=c.defaultProps,h)x[v]===void 0&&(x[v]=h[v]);return{$$typeof:e,type:c,key:S,ref:C,props:x,_owner:r.current}}return iw.Fragment=t,iw.jsx=a,iw.jsxs=a,iw}var wpe;function UEe(){return wpe||(wpe=1,nz.exports=BEe()),nz.exports}var Je=UEe(),Rn=sH(),GP={},iz={exports:{}},mc={},sz={exports:{}},oz={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Epe;function zEe(){return Epe||(Epe=1,function(o){function e(Ae,lt){var pt=Ae.length;Ae.push(lt);e:for(;0<pt;){var De=pt-1>>>1,_t=Ae[De];if(0<r(_t,lt))Ae[De]=lt,Ae[pt]=_t,pt=De;else break e}}function t(Ae){return Ae.length===0?null:Ae[0]}function n(Ae){if(Ae.length===0)return null;var lt=Ae[0],pt=Ae.pop();if(pt!==lt){Ae[0]=pt;e:for(var De=0,_t=Ae.length,Jt=_t>>>1;De<Jt;){var dt=2*(De+1)-1,Dt=Ae[dt],gn=dt+1,qt=Ae[gn];if(0>r(Dt,pt))gn<_t&&0>r(qt,Dt)?(Ae[De]=qt,Ae[gn]=pt,De=gn):(Ae[De]=Dt,Ae[dt]=pt,De=dt);else if(gn<_t&&0>r(qt,pt))Ae[De]=qt,Ae[gn]=pt,De=gn;else break e}}return lt}function r(Ae,lt){var pt=Ae.sortIndex-lt.sortIndex;return pt!==0?pt:Ae.id-lt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;o.unstable_now=function(){return i.now()}}else{var a=Date,c=a.now();o.unstable_now=function(){return a.now()-c}}var h=[],p=[],v=1,x=null,S=3,C=!1,I=!1,L=!1,U=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,$=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function Z(Ae){for(var lt=t(p);lt!==null;){if(lt.callback===null)n(p);else if(lt.startTime<=Ae)n(p),lt.sortIndex=lt.expirationTime,e(h,lt);else break;lt=t(p)}}function k(Ae){if(L=!1,Z(Ae),!I)if(t(h)!==null)I=!0,Se(ie);else{var lt=t(p);lt!==null&&gt(k,lt.startTime-Ae)}}function ie(Ae,lt){I=!1,L&&(L=!1,R(Q),Q=-1),C=!0;var pt=S;try{for(Z(lt),x=t(h);x!==null&&(!(x.expirationTime>lt)||Ae&&!J());){var De=x.callback;if(typeof De=="function"){x.callback=null,S=x.priorityLevel;var _t=De(x.expirationTime<=lt);lt=o.unstable_now(),typeof _t=="function"?x.callback=_t:x===t(h)&&n(h),Z(lt)}else n(h);x=t(h)}if(x!==null)var Jt=!0;else{var dt=t(p);dt!==null&&gt(k,dt.startTime-lt),Jt=!1}return Jt}finally{x=null,S=pt,C=!1}}var ue=!1,ce=null,Q=-1,ae=5,le=-1;function J(){return!(o.unstable_now()-le<ae)}function Ue(){if(ce!==null){var Ae=o.unstable_now();le=Ae;var lt=!0;try{lt=ce(!0,Ae)}finally{lt?je():(ue=!1,ce=null)}}else ue=!1}var je;if(typeof $=="function")je=function(){$(Ue)};else if(typeof MessageChannel<"u"){var rt=new MessageChannel,at=rt.port2;rt.port1.onmessage=Ue,je=function(){at.postMessage(null)}}else je=function(){U(Ue,0)};function Se(Ae){ce=Ae,ue||(ue=!0,je())}function gt(Ae,lt){Q=U(function(){Ae(o.unstable_now())},lt)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(Ae){Ae.callback=null},o.unstable_continueExecution=function(){I||C||(I=!0,Se(ie))},o.unstable_forceFrameRate=function(Ae){0>Ae||125<Ae?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ae=0<Ae?Math.floor(1e3/Ae):5},o.unstable_getCurrentPriorityLevel=function(){return S},o.unstable_getFirstCallbackNode=function(){return t(h)},o.unstable_next=function(Ae){switch(S){case 1:case 2:case 3:var lt=3;break;default:lt=S}var pt=S;S=lt;try{return Ae()}finally{S=pt}},o.unstable_pauseExecution=function(){},o.unstable_requestPaint=function(){},o.unstable_runWithPriority=function(Ae,lt){switch(Ae){case 1:case 2:case 3:case 4:case 5:break;default:Ae=3}var pt=S;S=Ae;try{return lt()}finally{S=pt}},o.unstable_scheduleCallback=function(Ae,lt,pt){var De=o.unstable_now();switch(typeof pt=="object"&&pt!==null?(pt=pt.delay,pt=typeof pt=="number"&&0<pt?De+pt:De):pt=De,Ae){case 1:var _t=-1;break;case 2:_t=250;break;case 5:_t=1073741823;break;case 4:_t=1e4;break;default:_t=5e3}return _t=pt+_t,Ae={id:v++,callback:lt,priorityLevel:Ae,startTime:pt,expirationTime:_t,sortIndex:-1},pt>De?(Ae.sortIndex=pt,e(p,Ae),t(h)===null&&Ae===t(p)&&(L?(R(Q),Q=-1):L=!0,gt(k,pt-De))):(Ae.sortIndex=_t,e(h,Ae),I||C||(I=!0,Se(ie))),Ae},o.unstable_shouldYield=J,o.unstable_wrapCallback=function(Ae){var lt=S;return function(){var pt=S;S=lt;try{return Ae.apply(this,arguments)}finally{S=pt}}}}(oz)),oz}var Tpe;function VEe(){return Tpe||(Tpe=1,sz.exports=zEe()),sz.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mpe;function GEe(){if(Mpe)return mc;Mpe=1;var o=sH(),e=VEe();function t(d){for(var g="https://reactjs.org/docs/error-decoder.html?invariant="+d,M=1;M<arguments.length;M++)g+="&args[]="+encodeURIComponent(arguments[M]);return"Minified React error #"+d+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,r={};function i(d,g){a(d,g),a(d+"Capture",g)}function a(d,g){for(r[d]=g,d=0;d<g.length;d++)n.add(g[d])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),h=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,v={},x={};function S(d){return h.call(x,d)?!0:h.call(v,d)?!1:p.test(d)?x[d]=!0:(v[d]=!0,!1)}function C(d,g,M,O){if(M!==null&&M.type===0)return!1;switch(typeof g){case"function":case"symbol":return!0;case"boolean":return O?!1:M!==null?!M.acceptsBooleans:(d=d.toLowerCase().slice(0,5),d!=="data-"&&d!=="aria-");default:return!1}}function I(d,g,M,O){if(g===null||typeof g>"u"||C(d,g,M,O))return!0;if(O)return!1;if(M!==null)switch(M.type){case 3:return!g;case 4:return g===!1;case 5:return isNaN(g);case 6:return isNaN(g)||1>g}return!1}function L(d,g,M,O,q,ee,ge){this.acceptsBooleans=g===2||g===3||g===4,this.attributeName=O,this.attributeNamespace=q,this.mustUseProperty=M,this.propertyName=d,this.type=g,this.sanitizeURL=ee,this.removeEmptyString=ge}var U={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(d){U[d]=new L(d,0,!1,d,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(d){var g=d[0];U[g]=new L(g,1,!1,d[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(d){U[d]=new L(d,2,!1,d.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(d){U[d]=new L(d,2,!1,d,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(d){U[d]=new L(d,3,!1,d.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(d){U[d]=new L(d,3,!0,d,null,!1,!1)}),["capture","download"].forEach(function(d){U[d]=new L(d,4,!1,d,null,!1,!1)}),["cols","rows","size","span"].forEach(function(d){U[d]=new L(d,6,!1,d,null,!1,!1)}),["rowSpan","start"].forEach(function(d){U[d]=new L(d,5,!1,d.toLowerCase(),null,!1,!1)});var R=/[\-:]([a-z])/g;function $(d){return d[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(d){var g=d.replace(R,$);U[g]=new L(g,1,!1,d,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(d){var g=d.replace(R,$);U[g]=new L(g,1,!1,d,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(d){var g=d.replace(R,$);U[g]=new L(g,1,!1,d,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(d){U[d]=new L(d,1,!1,d.toLowerCase(),null,!1,!1)}),U.xlinkHref=new L("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(d){U[d]=new L(d,1,!1,d.toLowerCase(),null,!0,!0)});function Z(d,g,M,O){var q=U.hasOwnProperty(g)?U[g]:null;(q!==null?q.type!==0:O||!(2<g.length)||g[0]!=="o"&&g[0]!=="O"||g[1]!=="n"&&g[1]!=="N")&&(I(g,M,q,O)&&(M=null),O||q===null?S(g)&&(M===null?d.removeAttribute(g):d.setAttribute(g,""+M)):q.mustUseProperty?d[q.propertyName]=M===null?q.type===3?!1:"":M:(g=q.attributeName,O=q.attributeNamespace,M===null?d.removeAttribute(g):(q=q.type,M=q===3||q===4&&M===!0?"":""+M,O?d.setAttributeNS(O,g,M):d.setAttribute(g,M))))}var k=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ie=Symbol.for("react.element"),ue=Symbol.for("react.portal"),ce=Symbol.for("react.fragment"),Q=Symbol.for("react.strict_mode"),ae=Symbol.for("react.profiler"),le=Symbol.for("react.provider"),J=Symbol.for("react.context"),Ue=Symbol.for("react.forward_ref"),je=Symbol.for("react.suspense"),rt=Symbol.for("react.suspense_list"),at=Symbol.for("react.memo"),Se=Symbol.for("react.lazy"),gt=Symbol.for("react.offscreen"),Ae=Symbol.iterator;function lt(d){return d===null||typeof d!="object"?null:(d=Ae&&d[Ae]||d["@@iterator"],typeof d=="function"?d:null)}var pt=Object.assign,De;function _t(d){if(De===void 0)try{throw Error()}catch(M){var g=M.stack.trim().match(/\n( *(at )?)/);De=g&&g[1]||""}return`
`+De+d}var Jt=!1;function dt(d,g){if(!d||Jt)return"";Jt=!0;var M=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(g)if(g=function(){throw Error()},Object.defineProperty(g.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(g,[])}catch(Ot){var O=Ot}Reflect.construct(d,[],g)}else{try{g.call()}catch(Ot){O=Ot}d.call(g.prototype)}else{try{throw Error()}catch(Ot){O=Ot}d()}}catch(Ot){if(Ot&&O&&typeof Ot.stack=="string"){for(var q=Ot.stack.split(`
`),ee=O.stack.split(`
`),ge=q.length-1,Fe=ee.length-1;1<=ge&&0<=Fe&&q[ge]!==ee[Fe];)Fe--;for(;1<=ge&&0<=Fe;ge--,Fe--)if(q[ge]!==ee[Fe]){if(ge!==1||Fe!==1)do if(ge--,Fe--,0>Fe||q[ge]!==ee[Fe]){var Xe=`
`+q[ge].replace(" at new "," at ");return d.displayName&&Xe.includes("<anonymous>")&&(Xe=Xe.replace("<anonymous>",d.displayName)),Xe}while(1<=ge&&0<=Fe);break}}}finally{Jt=!1,Error.prepareStackTrace=M}return(d=d?d.displayName||d.name:"")?_t(d):""}function Dt(d){switch(d.tag){case 5:return _t(d.type);case 16:return _t("Lazy");case 13:return _t("Suspense");case 19:return _t("SuspenseList");case 0:case 2:case 15:return d=dt(d.type,!1),d;case 11:return d=dt(d.type.render,!1),d;case 1:return d=dt(d.type,!0),d;default:return""}}function gn(d){if(d==null)return null;if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d;switch(d){case ce:return"Fragment";case ue:return"Portal";case ae:return"Profiler";case Q:return"StrictMode";case je:return"Suspense";case rt:return"SuspenseList"}if(typeof d=="object")switch(d.$$typeof){case J:return(d.displayName||"Context")+".Consumer";case le:return(d._context.displayName||"Context")+".Provider";case Ue:var g=d.render;return d=d.displayName,d||(d=g.displayName||g.name||"",d=d!==""?"ForwardRef("+d+")":"ForwardRef"),d;case at:return g=d.displayName||null,g!==null?g:gn(d.type)||"Memo";case Se:g=d._payload,d=d._init;try{return gn(d(g))}catch{}}return null}function qt(d){var g=d.type;switch(d.tag){case 24:return"Cache";case 9:return(g.displayName||"Context")+".Consumer";case 10:return(g._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return d=g.render,d=d.displayName||d.name||"",g.displayName||(d!==""?"ForwardRef("+d+")":"ForwardRef");case 7:return"Fragment";case 5:return g;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return gn(g);case 8:return g===Q?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof g=="function")return g.displayName||g.name||null;if(typeof g=="string")return g}return null}function wn(d){switch(typeof d){case"boolean":case"number":case"string":case"undefined":return d;case"object":return d;default:return""}}function nr(d){var g=d.type;return(d=d.nodeName)&&d.toLowerCase()==="input"&&(g==="checkbox"||g==="radio")}function qn(d){var g=nr(d)?"checked":"value",M=Object.getOwnPropertyDescriptor(d.constructor.prototype,g),O=""+d[g];if(!d.hasOwnProperty(g)&&typeof M<"u"&&typeof M.get=="function"&&typeof M.set=="function"){var q=M.get,ee=M.set;return Object.defineProperty(d,g,{configurable:!0,get:function(){return q.call(this)},set:function(ge){O=""+ge,ee.call(this,ge)}}),Object.defineProperty(d,g,{enumerable:M.enumerable}),{getValue:function(){return O},setValue:function(ge){O=""+ge},stopTracking:function(){d._valueTracker=null,delete d[g]}}}}function ni(d){d._valueTracker||(d._valueTracker=qn(d))}function ai(d){if(!d)return!1;var g=d._valueTracker;if(!g)return!0;var M=g.getValue(),O="";return d&&(O=nr(d)?d.checked?"true":"false":d.value),d=O,d!==M?(g.setValue(d),!0):!1}function qr(d){if(d=d||(typeof document<"u"?document:void 0),typeof d>"u")return null;try{return d.activeElement||d.body}catch{return d.body}}function $e(d,g){var M=g.checked;return pt({},g,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:M??d._wrapperState.initialChecked})}function Ls(d,g){var M=g.defaultValue==null?"":g.defaultValue,O=g.checked!=null?g.checked:g.defaultChecked;M=wn(g.value!=null?g.value:M),d._wrapperState={initialChecked:O,initialValue:M,controlled:g.type==="checkbox"||g.type==="radio"?g.checked!=null:g.value!=null}}function li(d,g){g=g.checked,g!=null&&Z(d,"checked",g,!1)}function Ti(d,g){li(d,g);var M=wn(g.value),O=g.type;if(M!=null)O==="number"?(M===0&&d.value===""||d.value!=M)&&(d.value=""+M):d.value!==""+M&&(d.value=""+M);else if(O==="submit"||O==="reset"){d.removeAttribute("value");return}g.hasOwnProperty("value")?Pr(d,g.type,M):g.hasOwnProperty("defaultValue")&&Pr(d,g.type,wn(g.defaultValue)),g.checked==null&&g.defaultChecked!=null&&(d.defaultChecked=!!g.defaultChecked)}function Ln(d,g,M){if(g.hasOwnProperty("value")||g.hasOwnProperty("defaultValue")){var O=g.type;if(!(O!=="submit"&&O!=="reset"||g.value!==void 0&&g.value!==null))return;g=""+d._wrapperState.initialValue,M||g===d.value||(d.value=g),d.defaultValue=g}M=d.name,M!==""&&(d.name=""),d.defaultChecked=!!d._wrapperState.initialChecked,M!==""&&(d.name=M)}function Pr(d,g,M){(g!=="number"||qr(d.ownerDocument)!==d)&&(M==null?d.defaultValue=""+d._wrapperState.initialValue:d.defaultValue!==""+M&&(d.defaultValue=""+M))}var sr=Array.isArray;function dr(d,g,M,O){if(d=d.options,g){g={};for(var q=0;q<M.length;q++)g["$"+M[q]]=!0;for(M=0;M<d.length;M++)q=g.hasOwnProperty("$"+d[M].value),d[M].selected!==q&&(d[M].selected=q),q&&O&&(d[M].defaultSelected=!0)}else{for(M=""+wn(M),g=null,q=0;q<d.length;q++){if(d[q].value===M){d[q].selected=!0,O&&(d[q].defaultSelected=!0);return}g!==null||d[q].disabled||(g=d[q])}g!==null&&(g.selected=!0)}}function mi(d,g){if(g.dangerouslySetInnerHTML!=null)throw Error(t(91));return pt({},g,{value:void 0,defaultValue:void 0,children:""+d._wrapperState.initialValue})}function Oe(d,g){var M=g.value;if(M==null){if(M=g.children,g=g.defaultValue,M!=null){if(g!=null)throw Error(t(92));if(sr(M)){if(1<M.length)throw Error(t(93));M=M[0]}g=M}g==null&&(g=""),M=g}d._wrapperState={initialValue:wn(M)}}function _e(d,g){var M=wn(g.value),O=wn(g.defaultValue);M!=null&&(M=""+M,M!==d.value&&(d.value=M),g.defaultValue==null&&d.defaultValue!==M&&(d.defaultValue=M)),O!=null&&(d.defaultValue=""+O)}function Ct(d){var g=d.textContent;g===d._wrapperState.initialValue&&g!==""&&g!==null&&(d.value=g)}function Kt(d){switch(d){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Zt(d,g){return d==null||d==="http://www.w3.org/1999/xhtml"?Kt(g):d==="http://www.w3.org/2000/svg"&&g==="foreignObject"?"http://www.w3.org/1999/xhtml":d}var jt,or=function(d){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(g,M,O,q){MSApp.execUnsafeLocalFunction(function(){return d(g,M,O,q)})}:d}(function(d,g){if(d.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in d)d.innerHTML=g;else{for(jt=jt||document.createElement("div"),jt.innerHTML="<svg>"+g.valueOf().toString()+"</svg>",g=jt.firstChild;d.firstChild;)d.removeChild(d.firstChild);for(;g.firstChild;)d.appendChild(g.firstChild)}});function An(d,g){if(g){var M=d.firstChild;if(M&&M===d.lastChild&&M.nodeType===3){M.nodeValue=g;return}}d.textContent=g}var Gn={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ar=["Webkit","ms","Moz","O"];Object.keys(Gn).forEach(function(d){ar.forEach(function(g){g=g+d.charAt(0).toUpperCase()+d.substring(1),Gn[g]=Gn[d]})});function Qt(d,g,M){return g==null||typeof g=="boolean"||g===""?"":M||typeof g!="number"||g===0||Gn.hasOwnProperty(d)&&Gn[d]?(""+g).trim():g+"px"}function jn(d,g){d=d.style;for(var M in g)if(g.hasOwnProperty(M)){var O=M.indexOf("--")===0,q=Qt(M,g[M],O);M==="float"&&(M="cssFloat"),O?d.setProperty(M,q):d[M]=q}}var Cr=pt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function gr(d,g){if(g){if(Cr[d]&&(g.children!=null||g.dangerouslySetInnerHTML!=null))throw Error(t(137,d));if(g.dangerouslySetInnerHTML!=null){if(g.children!=null)throw Error(t(60));if(typeof g.dangerouslySetInnerHTML!="object"||!("__html"in g.dangerouslySetInnerHTML))throw Error(t(61))}if(g.style!=null&&typeof g.style!="object")throw Error(t(62))}}function Pn(d,g){if(d.indexOf("-")===-1)return typeof g.is=="string";switch(d){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wr=null;function Ze(d){return d=d.target||d.srcElement||window,d.correspondingUseElement&&(d=d.correspondingUseElement),d.nodeType===3?d.parentNode:d}var Tn=null,nn=null,Nn=null;function ln(d){if(d=Zh(d)){if(typeof Tn!="function")throw Error(t(280));var g=d.stateNode;g&&(g=h2(g),Tn(d.stateNode,d.type,g))}}function en(d){nn?Nn?Nn.push(d):Nn=[d]:nn=d}function Xn(){if(nn){var d=nn,g=Nn;if(Nn=nn=null,ln(d),g)for(d=0;d<g.length;d++)ln(g[d])}}function Sr(d,g){return d(g)}function _i(){}var Zr=!1;function Bs(d,g,M){if(Zr)return d(g,M);Zr=!0;try{return Sr(d,g,M)}finally{Zr=!1,(nn!==null||Nn!==null)&&(_i(),Xn())}}function so(d,g){var M=d.stateNode;if(M===null)return null;var O=h2(M);if(O===null)return null;M=O[g];e:switch(g){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(O=!O.disabled)||(d=d.type,O=!(d==="button"||d==="input"||d==="select"||d==="textarea")),d=!O;break e;default:d=!1}if(d)return null;if(M&&typeof M!="function")throw Error(t(231,g,typeof M));return M}var Cc=!1;if(c)try{var Ms={};Object.defineProperty(Ms,"passive",{get:function(){Cc=!0}}),window.addEventListener("test",Ms,Ms),window.removeEventListener("test",Ms,Ms)}catch{Cc=!1}function Us(d,g,M,O,q,ee,ge,Fe,Xe){var Ot=Array.prototype.slice.call(arguments,3);try{g.apply(M,Ot)}catch(on){this.onError(on)}}var h0=!1,Fl=null,$0=!1,Ro=null,Tu={onError:function(d){h0=!0,Fl=d}};function Mu(d,g,M,O,q,ee,ge,Fe,Xe){h0=!1,Fl=null,Us.apply(Tu,arguments)}function bf(d,g,M,O,q,ee,ge,Fe,Xe){if(Mu.apply(this,arguments),h0){if(h0){var Ot=Fl;h0=!1,Fl=null}else throw Error(t(198));$0||($0=!0,Ro=Ot)}}function oo(d){var g=d,M=d;if(d.alternate)for(;g.return;)g=g.return;else{d=g;do g=d,(g.flags&4098)!==0&&(M=g.return),d=g.return;while(d)}return g.tag===3?M:null}function Dh(d){if(d.tag===13){var g=d.memoizedState;if(g===null&&(d=d.alternate,d!==null&&(g=d.memoizedState)),g!==null)return g.dehydrated}return null}function Ll(d){if(oo(d)!==d)throw Error(t(188))}function Cu(d){var g=d.alternate;if(!g){if(g=oo(d),g===null)throw Error(t(188));return g!==d?null:d}for(var M=d,O=g;;){var q=M.return;if(q===null)break;var ee=q.alternate;if(ee===null){if(O=q.return,O!==null){M=O;continue}break}if(q.child===ee.child){for(ee=q.child;ee;){if(ee===M)return Ll(q),d;if(ee===O)return Ll(q),g;ee=ee.sibling}throw Error(t(188))}if(M.return!==O.return)M=q,O=ee;else{for(var ge=!1,Fe=q.child;Fe;){if(Fe===M){ge=!0,M=q,O=ee;break}if(Fe===O){ge=!0,O=q,M=ee;break}Fe=Fe.sibling}if(!ge){for(Fe=ee.child;Fe;){if(Fe===M){ge=!0,M=ee,O=q;break}if(Fe===O){ge=!0,O=ee,M=q;break}Fe=Fe.sibling}if(!ge)throw Error(t(189))}}if(M.alternate!==O)throw Error(t(190))}if(M.tag!==3)throw Error(t(188));return M.stateNode.current===M?d:g}function Oh(d){return d=Cu(d),d!==null?Fh(d):null}function Fh(d){if(d.tag===5||d.tag===6)return d;for(d=d.child;d!==null;){var g=Fh(d);if(g!==null)return g;d=d.sibling}return null}var Sf=e.unstable_scheduleCallback,we=e.unstable_cancelCallback,st=e.unstable_shouldYield,Pt=e.unstable_requestPaint,bt=e.unstable_now,ht=e.unstable_getCurrentPriorityLevel,yn=e.unstable_ImmediatePriority,On=e.unstable_UserBlockingPriority,Un=e.unstable_NormalPriority,Hn=e.unstable_LowPriority,lr=e.unstable_IdlePriority,yr=null,Yn=null;function Fr(d){if(Yn&&typeof Yn.onCommitFiberRoot=="function")try{Yn.onCommitFiberRoot(yr,d,void 0,(d.current.flags&128)===128)}catch{}}var Lr=Math.clz32?Math.clz32:ri,Ii=Math.log,Xi=Math.LN2;function ri(d){return d>>>=0,d===0?32:31-(Ii(d)/Xi|0)|0}var Jn=64,Yi=4194304;function Qr(d){switch(d&-d){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return d&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return d}}function Cs(d,g){var M=d.pendingLanes;if(M===0)return 0;var O=0,q=d.suspendedLanes,ee=d.pingedLanes,ge=M&268435455;if(ge!==0){var Fe=ge&~q;Fe!==0?O=Qr(Fe):(ee&=ge,ee!==0&&(O=Qr(ee)))}else ge=M&~q,ge!==0?O=Qr(ge):ee!==0&&(O=Qr(ee));if(O===0)return 0;if(g!==0&&g!==O&&(g&q)===0&&(q=O&-O,ee=g&-g,q>=ee||q===16&&(ee&4194240)!==0))return g;if((O&4)!==0&&(O|=M&16),g=d.entangledLanes,g!==0)for(d=d.entanglements,g&=O;0<g;)M=31-Lr(g),q=1<<M,O|=d[M],g&=~q;return O}function Ba(d,g){switch(d){case 1:case 2:case 4:return g+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ko(d,g){for(var M=d.suspendedLanes,O=d.pingedLanes,q=d.expirationTimes,ee=d.pendingLanes;0<ee;){var ge=31-Lr(ee),Fe=1<<ge,Xe=q[ge];Xe===-1?((Fe&M)===0||(Fe&O)!==0)&&(q[ge]=Ba(Fe,g)):Xe<=g&&(d.expiredLanes|=Fe),ee&=~Fe}}function d0(d){return d=d.pendingLanes&-1073741825,d!==0?d:d&1073741824?1073741824:0}function Ni(){var d=Jn;return Jn<<=1,(Jn&4194240)===0&&(Jn=64),d}function hs(d){for(var g=[],M=0;31>M;M++)g.push(d);return g}function As(d,g,M){d.pendingLanes|=g,g!==536870912&&(d.suspendedLanes=0,d.pingedLanes=0),d=d.eventTimes,g=31-Lr(g),d[g]=M}function zs(d,g){var M=d.pendingLanes&~g;d.pendingLanes=g,d.suspendedLanes=0,d.pingedLanes=0,d.expiredLanes&=g,d.mutableReadLanes&=g,d.entangledLanes&=g,g=d.entanglements;var O=d.eventTimes;for(d=d.expirationTimes;0<M;){var q=31-Lr(M),ee=1<<q;g[q]=0,O[q]=-1,d[q]=-1,M&=~ee}}function xs(d,g){var M=d.entangledLanes|=g;for(d=d.entanglements;M;){var O=31-Lr(M),q=1<<O;q&g|d[O]&g&&(d[O]|=g),M&=~q}}var hi=0;function eo(d){return d&=-d,1<d?4<d?(d&268435455)!==0?16:536870912:4:1}var Lh,a1,Bl,l1,Ug,c1=!1,Bh=[],q0=null,Vs=null,f0=null,Au=new Map,Pu=new Map,X0=[],zg="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function u1(d,g){switch(d){case"focusin":case"focusout":q0=null;break;case"dragenter":case"dragleave":Vs=null;break;case"mouseover":case"mouseout":f0=null;break;case"pointerover":case"pointerout":Au.delete(g.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pu.delete(g.pointerId)}}function Ru(d,g,M,O,q,ee){return d===null||d.nativeEvent!==ee?(d={blockedOn:g,domEventName:M,eventSystemFlags:O,nativeEvent:ee,targetContainers:[q]},g!==null&&(g=Zh(g),g!==null&&a1(g)),d):(d.eventSystemFlags|=O,g=d.targetContainers,q!==null&&g.indexOf(q)===-1&&g.push(q),d)}function Vg(d,g,M,O,q){switch(g){case"focusin":return q0=Ru(q0,d,g,M,O,q),!0;case"dragenter":return Vs=Ru(Vs,d,g,M,O,q),!0;case"mouseover":return f0=Ru(f0,d,g,M,O,q),!0;case"pointerover":var ee=q.pointerId;return Au.set(ee,Ru(Au.get(ee)||null,d,g,M,O,q)),!0;case"gotpointercapture":return ee=q.pointerId,Pu.set(ee,Ru(Pu.get(ee)||null,d,g,M,O,q)),!0}return!1}function Ul(d){var g=y0(d.target);if(g!==null){var M=oo(g);if(M!==null){if(g=M.tag,g===13){if(g=Dh(M),g!==null){d.blockedOn=g,Ug(d.priority,function(){Bl(M)});return}}else if(g===3&&M.stateNode.current.memoizedState.isDehydrated){d.blockedOn=M.tag===3?M.stateNode.containerInfo:null;return}}}d.blockedOn=null}function zl(d){if(d.blockedOn!==null)return!1;for(var g=d.targetContainers;0<g.length;){var M=Ef(d.domEventName,d.eventSystemFlags,g[0],d.nativeEvent);if(M===null){M=d.nativeEvent;var O=new M.constructor(M.type,M);wr=O,M.target.dispatchEvent(O),wr=null}else return g=Zh(M),g!==null&&a1(g),d.blockedOn=M,!1;g.shift()}return!0}function Gg(d,g,M){zl(d)&&M.delete(g)}function h1(){c1=!1,q0!==null&&zl(q0)&&(q0=null),Vs!==null&&zl(Vs)&&(Vs=null),f0!==null&&zl(f0)&&(f0=null),Au.forEach(Gg),Pu.forEach(Gg)}function ku(d,g){d.blockedOn===g&&(d.blockedOn=null,c1||(c1=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,h1)))}function Uh(d){function g(q){return ku(q,d)}if(0<Bh.length){ku(Bh[0],d);for(var M=1;M<Bh.length;M++){var O=Bh[M];O.blockedOn===d&&(O.blockedOn=null)}}for(q0!==null&&ku(q0,d),Vs!==null&&ku(Vs,d),f0!==null&&ku(f0,d),Au.forEach(g),Pu.forEach(g),M=0;M<X0.length;M++)O=X0[M],O.blockedOn===d&&(O.blockedOn=null);for(;0<X0.length&&(M=X0[0],M.blockedOn===null);)Ul(M),M.blockedOn===null&&X0.shift()}var Iu=k.ReactCurrentBatchConfig,Ua=!0;function Ac(d,g,M,O){var q=hi,ee=Iu.transition;Iu.transition=null;try{hi=1,Nu(d,g,M,O)}finally{hi=q,Iu.transition=ee}}function jg(d,g,M,O){var q=hi,ee=Iu.transition;Iu.transition=null;try{hi=4,Nu(d,g,M,O)}finally{hi=q,Iu.transition=ee}}function Nu(d,g,M,O){if(Ua){var q=Ef(d,g,M,O);if(q===null)i2(d,g,O,wf,M),u1(d,O);else if(Vg(q,d,g,M,O))O.stopPropagation();else if(u1(d,O),g&4&&-1<zg.indexOf(d)){for(;q!==null;){var ee=Zh(q);if(ee!==null&&Lh(ee),ee=Ef(d,g,M,O),ee===null&&i2(d,g,O,wf,M),ee===q)break;q=ee}q!==null&&O.stopPropagation()}else i2(d,g,O,null,M)}}var wf=null;function Ef(d,g,M,O){if(wf=null,d=Ze(O),d=y0(d),d!==null)if(g=oo(d),g===null)d=null;else if(M=g.tag,M===13){if(d=Dh(g),d!==null)return d;d=null}else if(M===3){if(g.stateNode.current.memoizedState.isDehydrated)return g.tag===3?g.stateNode.containerInfo:null;d=null}else g!==d&&(d=null);return wf=d,null}function d1(d){switch(d){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ht()){case yn:return 1;case On:return 4;case Un:case Hn:return 16;case lr:return 536870912;default:return 16}default:return 16}}var Y0=null,Tf=null,Du=null;function f1(){if(Du)return Du;var d,g=Tf,M=g.length,O,q="value"in Y0?Y0.value:Y0.textContent,ee=q.length;for(d=0;d<M&&g[d]===q[d];d++);var ge=M-d;for(O=1;O<=ge&&g[M-O]===q[ee-O];O++);return Du=q.slice(d,1<O?1-O:void 0)}function Mf(d){var g=d.keyCode;return"charCode"in d?(d=d.charCode,d===0&&g===13&&(d=13)):d=g,d===10&&(d=13),32<=d||d===13?d:0}function Vl(){return!0}function p1(){return!1}function ao(d){function g(M,O,q,ee,ge){this._reactName=M,this._targetInst=q,this.type=O,this.nativeEvent=ee,this.target=ge,this.currentTarget=null;for(var Fe in d)d.hasOwnProperty(Fe)&&(M=d[Fe],this[Fe]=M?M(ee):ee[Fe]);return this.isDefaultPrevented=(ee.defaultPrevented!=null?ee.defaultPrevented:ee.returnValue===!1)?Vl:p1,this.isPropagationStopped=p1,this}return pt(g.prototype,{preventDefault:function(){this.defaultPrevented=!0;var M=this.nativeEvent;M&&(M.preventDefault?M.preventDefault():typeof M.returnValue!="unknown"&&(M.returnValue=!1),this.isDefaultPrevented=Vl)},stopPropagation:function(){var M=this.nativeEvent;M&&(M.stopPropagation?M.stopPropagation():typeof M.cancelBubble!="unknown"&&(M.cancelBubble=!0),this.isPropagationStopped=Vl)},persist:function(){},isPersistent:Vl}),g}var Pc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(d){return d.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ba=ao(Pc),p0=pt({},Pc,{view:0,detail:0}),zh=ao(p0),Vh,K0,Rc,Z0=pt({},p0,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Af,button:0,buttons:0,relatedTarget:function(d){return d.relatedTarget===void 0?d.fromElement===d.srcElement?d.toElement:d.fromElement:d.relatedTarget},movementX:function(d){return"movementX"in d?d.movementX:(d!==Rc&&(Rc&&d.type==="mousemove"?(Vh=d.screenX-Rc.screenX,K0=d.screenY-Rc.screenY):K0=Vh=0,Rc=d),Vh)},movementY:function(d){return"movementY"in d?d.movementY:K0}}),Gs=ao(Z0),Gl=pt({},Z0,{dataTransfer:0}),Cf=ao(Gl),Hg=pt({},p0,{relatedTarget:0}),m0=ao(Hg),Gh=pt({},Pc,{animationName:0,elapsedTime:0,pseudoElement:0}),Wg=ao(Gh),$g=pt({},Pc,{clipboardData:function(d){return"clipboardData"in d?d.clipboardData:window.clipboardData}}),m1=ao($g),i4=pt({},Pc,{data:0}),Ou=ao(i4),g1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},y1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},qg={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Xg(d){var g=this.nativeEvent;return g.getModifierState?g.getModifierState(d):(d=qg[d])?!!g[d]:!1}function Af(){return Xg}var jh=pt({},p0,{key:function(d){if(d.key){var g=g1[d.key]||d.key;if(g!=="Unidentified")return g}return d.type==="keypress"?(d=Mf(d),d===13?"Enter":String.fromCharCode(d)):d.type==="keydown"||d.type==="keyup"?y1[d.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Af,charCode:function(d){return d.type==="keypress"?Mf(d):0},keyCode:function(d){return d.type==="keydown"||d.type==="keyup"?d.keyCode:0},which:function(d){return d.type==="keypress"?Mf(d):d.type==="keydown"||d.type==="keyup"?d.keyCode:0}}),bo=ao(jh),s4=pt({},Z0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Fu=ao(s4),v1=pt({},p0,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Af}),Yg=ao(v1),$o=pt({},Pc,{propertyName:0,elapsedTime:0,pseudoElement:0}),o4=ao($o),a4=pt({},Z0,{deltaX:function(d){return"deltaX"in d?d.deltaX:"wheelDeltaX"in d?-d.wheelDeltaX:0},deltaY:function(d){return"deltaY"in d?d.deltaY:"wheelDeltaY"in d?-d.wheelDeltaY:"wheelDelta"in d?-d.wheelDelta:0},deltaZ:0,deltaMode:0}),Kg=ao(a4),_1=[9,13,27,32],kc=c&&"CompositionEvent"in window,Qi=null;c&&"documentMode"in document&&(Qi=document.documentMode);var Hh=c&&"TextEvent"in window&&!Qi,Q0=c&&(!kc||Qi&&8<Qi&&11>=Qi),jl=" ",x1=!1;function xi(d,g){switch(d){case"keyup":return _1.indexOf(g.keyCode)!==-1;case"keydown":return g.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ic(d){return d=d.detail,typeof d=="object"&&"data"in d?d.data:null}var Lu=!1;function b1(d,g){switch(d){case"compositionend":return Ic(g);case"keypress":return g.which!==32?null:(x1=!0,jl);case"textInput":return d=g.data,d===jl&&x1?null:d;default:return null}}function S1(d,g){if(Lu)return d==="compositionend"||!kc&&xi(d,g)?(d=f1(),Du=Tf=Y0=null,Lu=!1,d):null;switch(d){case"paste":return null;case"keypress":if(!(g.ctrlKey||g.altKey||g.metaKey)||g.ctrlKey&&g.altKey){if(g.char&&1<g.char.length)return g.char;if(g.which)return String.fromCharCode(g.which)}return null;case"compositionend":return Q0&&g.locale!=="ko"?null:g.data;default:return null}}var w1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Zg(d){var g=d&&d.nodeName&&d.nodeName.toLowerCase();return g==="input"?!!w1[d.type]:g==="textarea"}function Wh(d,g,M,O){en(O),g=R1(g,"onChange"),0<g.length&&(M=new ba("onChange","change",null,M,O),d.push({event:M,listeners:g}))}var J0=null,Bu=null;function l4(d){n2(d,0)}function $h(d){var g=Oc(d);if(ai(g))return d}function E1(d,g){if(d==="change")return g}var T1=!1;if(c){var de;if(c){var Pe="oninput"in document;if(!Pe){var Ye=document.createElement("div");Ye.setAttribute("oninput","return;"),Pe=typeof Ye.oninput=="function"}de=Pe}else de=!1;T1=de&&(!document.documentMode||9<document.documentMode)}function Ut(){J0&&(J0.detachEvent("onpropertychange",Ar),Bu=J0=null)}function Ar(d){if(d.propertyName==="value"&&$h(Bu)){var g=[];Wh(g,Bu,d,Ze(d)),Bs(l4,g)}}function di(d,g,M){d==="focusin"?(Ut(),J0=g,Bu=M,J0.attachEvent("onpropertychange",Ar)):d==="focusout"&&Ut()}function to(d){if(d==="selectionchange"||d==="keyup"||d==="keydown")return $h(Bu)}function g0(d,g){if(d==="click")return $h(g)}function Pf(d,g){if(d==="input"||d==="change")return $h(g)}function Uu(d,g){return d===g&&(d!==0||1/d===1/g)||d!==d&&g!==g}var Io=typeof Object.is=="function"?Object.is:Uu;function qh(d,g){if(Io(d,g))return!0;if(typeof d!="object"||d===null||typeof g!="object"||g===null)return!1;var M=Object.keys(d),O=Object.keys(g);if(M.length!==O.length)return!1;for(O=0;O<M.length;O++){var q=M[O];if(!h.call(g,q)||!Io(d[q],g[q]))return!1}return!0}function c4(d){for(;d&&d.firstChild;)d=d.firstChild;return d}function R6(d,g){var M=c4(d);d=0;for(var O;M;){if(M.nodeType===3){if(O=d+M.textContent.length,d<=g&&O>=g)return{node:M,offset:g-d};d=O}e:{for(;M;){if(M.nextSibling){M=M.nextSibling;break e}M=M.parentNode}M=void 0}M=c4(M)}}function k6(d,g){return d&&g?d===g?!0:d&&d.nodeType===3?!1:g&&g.nodeType===3?k6(d,g.parentNode):"contains"in d?d.contains(g):d.compareDocumentPosition?!!(d.compareDocumentPosition(g)&16):!1:!1}function u4(){for(var d=window,g=qr();g instanceof d.HTMLIFrameElement;){try{var M=typeof g.contentWindow.location.href=="string"}catch{M=!1}if(M)d=g.contentWindow;else break;g=qr(d.document)}return g}function h4(d){var g=d&&d.nodeName&&d.nodeName.toLowerCase();return g&&(g==="input"&&(d.type==="text"||d.type==="search"||d.type==="tel"||d.type==="url"||d.type==="password")||g==="textarea"||d.contentEditable==="true")}function ox(d){var g=u4(),M=d.focusedElem,O=d.selectionRange;if(g!==M&&M&&M.ownerDocument&&k6(M.ownerDocument.documentElement,M)){if(O!==null&&h4(M)){if(g=O.start,d=O.end,d===void 0&&(d=g),"selectionStart"in M)M.selectionStart=g,M.selectionEnd=Math.min(d,M.value.length);else if(d=(g=M.ownerDocument||document)&&g.defaultView||window,d.getSelection){d=d.getSelection();var q=M.textContent.length,ee=Math.min(O.start,q);O=O.end===void 0?ee:Math.min(O.end,q),!d.extend&&ee>O&&(q=O,O=ee,ee=q),q=R6(M,ee);var ge=R6(M,O);q&&ge&&(d.rangeCount!==1||d.anchorNode!==q.node||d.anchorOffset!==q.offset||d.focusNode!==ge.node||d.focusOffset!==ge.offset)&&(g=g.createRange(),g.setStart(q.node,q.offset),d.removeAllRanges(),ee>O?(d.addRange(g),d.extend(ge.node,ge.offset)):(g.setEnd(ge.node,ge.offset),d.addRange(g)))}}for(g=[],d=M;d=d.parentNode;)d.nodeType===1&&g.push({element:d,left:d.scrollLeft,top:d.scrollTop});for(typeof M.focus=="function"&&M.focus(),M=0;M<g.length;M++)d=g[M],d.element.scrollLeft=d.left,d.element.scrollTop=d.top}}var I6=c&&"documentMode"in document&&11>=document.documentMode,el=null,d4=null,Xh=null,Rf=!1;function f4(d,g,M){var O=M.window===M?M.document:M.nodeType===9?M:M.ownerDocument;Rf||el==null||el!==qr(O)||(O=el,"selectionStart"in O&&h4(O)?O={start:O.selectionStart,end:O.selectionEnd}:(O=(O.ownerDocument&&O.ownerDocument.defaultView||window).getSelection(),O={anchorNode:O.anchorNode,anchorOffset:O.anchorOffset,focusNode:O.focusNode,focusOffset:O.focusOffset}),Xh&&qh(Xh,O)||(Xh=O,O=R1(d4,"onSelect"),0<O.length&&(g=new ba("onSelect","select",null,g,M),d.push({event:g,listeners:O}),g.target=el)))}function kf(d,g){var M={};return M[d.toLowerCase()]=g.toLowerCase(),M["Webkit"+d]="webkit"+g,M["Moz"+d]="moz"+g,M}var Nc={animationend:kf("Animation","AnimationEnd"),animationiteration:kf("Animation","AnimationIteration"),animationstart:kf("Animation","AnimationStart"),transitionend:kf("Transition","TransitionEnd")},M1={},Qg={};c&&(Qg=document.createElement("div").style,"AnimationEvent"in window||(delete Nc.animationend.animation,delete Nc.animationiteration.animation,delete Nc.animationstart.animation),"TransitionEvent"in window||delete Nc.transitionend.transition);function C1(d){if(M1[d])return M1[d];if(!Nc[d])return d;var g=Nc[d],M;for(M in g)if(g.hasOwnProperty(M)&&M in Qg)return M1[d]=g[M];return d}var N6=C1("animationend"),Jg=C1("animationiteration"),e2=C1("animationstart"),t2=C1("transitionend"),A1=new Map,p4="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Dc(d,g){A1.set(d,g),i(g,[d])}for(var If=0;If<p4.length;If++){var P1=p4[If],ax=P1.toLowerCase(),D6=P1[0].toUpperCase()+P1.slice(1);Dc(ax,"on"+D6)}Dc(N6,"onAnimationEnd"),Dc(Jg,"onAnimationIteration"),Dc(e2,"onAnimationStart"),Dc("dblclick","onDoubleClick"),Dc("focusin","onFocus"),Dc("focusout","onBlur"),Dc(t2,"onTransitionEnd"),a("onMouseEnter",["mouseout","mouseover"]),a("onMouseLeave",["mouseout","mouseover"]),a("onPointerEnter",["pointerout","pointerover"]),a("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Yh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),m4=new Set("cancel close invalid load scroll toggle".split(" ").concat(Yh));function g4(d,g,M){var O=d.type||"unknown-event";d.currentTarget=M,bf(O,g,void 0,d),d.currentTarget=null}function n2(d,g){g=(g&4)!==0;for(var M=0;M<d.length;M++){var O=d[M],q=O.event;O=O.listeners;e:{var ee=void 0;if(g)for(var ge=O.length-1;0<=ge;ge--){var Fe=O[ge],Xe=Fe.instance,Ot=Fe.currentTarget;if(Fe=Fe.listener,Xe!==ee&&q.isPropagationStopped())break e;g4(q,Fe,Ot),ee=Xe}else for(ge=0;ge<O.length;ge++){if(Fe=O[ge],Xe=Fe.instance,Ot=Fe.currentTarget,Fe=Fe.listener,Xe!==ee&&q.isPropagationStopped())break e;g4(q,Fe,Ot),ee=Xe}}}if($0)throw d=Ro,$0=!1,Ro=null,d}function Ji(d,g){var M=g[N1];M===void 0&&(M=g[N1]=new Set);var O=d+"__bubble";M.has(O)||(y4(g,d,2,!1),M.add(O))}function r2(d,g,M){var O=0;g&&(O|=4),y4(M,d,O,g)}var zu="_reactListening"+Math.random().toString(36).slice(2);function Nf(d){if(!d[zu]){d[zu]=!0,n.forEach(function(M){M!=="selectionchange"&&(m4.has(M)||r2(M,!1,d),r2(M,!0,d))});var g=d.nodeType===9?d:d.ownerDocument;g===null||g[zu]||(g[zu]=!0,r2("selectionchange",!1,g))}}function y4(d,g,M,O){switch(d1(g)){case 1:var q=Ac;break;case 4:q=jg;break;default:q=Nu}M=q.bind(null,g,M,d),q=void 0,!Cc||g!=="touchstart"&&g!=="touchmove"&&g!=="wheel"||(q=!0),O?q!==void 0?d.addEventListener(g,M,{capture:!0,passive:q}):d.addEventListener(g,M,!0):q!==void 0?d.addEventListener(g,M,{passive:q}):d.addEventListener(g,M,!1)}function i2(d,g,M,O,q){var ee=O;if((g&1)===0&&(g&2)===0&&O!==null)e:for(;;){if(O===null)return;var ge=O.tag;if(ge===3||ge===4){var Fe=O.stateNode.containerInfo;if(Fe===q||Fe.nodeType===8&&Fe.parentNode===q)break;if(ge===4)for(ge=O.return;ge!==null;){var Xe=ge.tag;if((Xe===3||Xe===4)&&(Xe=ge.stateNode.containerInfo,Xe===q||Xe.nodeType===8&&Xe.parentNode===q))return;ge=ge.return}for(;Fe!==null;){if(ge=y0(Fe),ge===null)return;if(Xe=ge.tag,Xe===5||Xe===6){O=ee=ge;continue e}Fe=Fe.parentNode}}O=O.return}Bs(function(){var Ot=ee,on=Ze(M),vn=[];e:{var an=A1.get(d);if(an!==void 0){var Wn=ba,$n=d;switch(d){case"keypress":if(Mf(M)===0)break e;case"keydown":case"keyup":Wn=bo;break;case"focusin":$n="focus",Wn=m0;break;case"focusout":$n="blur",Wn=m0;break;case"beforeblur":case"afterblur":Wn=m0;break;case"click":if(M.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Wn=Gs;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Wn=Cf;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Wn=Yg;break;case N6:case Jg:case e2:Wn=Wg;break;case t2:Wn=o4;break;case"scroll":Wn=zh;break;case"wheel":Wn=Kg;break;case"copy":case"cut":case"paste":Wn=m1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Wn=Fu}var Zn=(g&4)!==0,Hs=!Zn&&d==="scroll",xt=Zn?an!==null?an+"Capture":null:an;Zn=[];for(var tt=Ot,At;tt!==null;){At=tt;var En=At.stateNode;if(At.tag===5&&En!==null&&(At=En,xt!==null&&(En=so(tt,xt),En!=null&&Zn.push(Df(tt,En,At)))),Hs)break;tt=tt.return}0<Zn.length&&(an=new Wn(an,$n,null,M,on),vn.push({event:an,listeners:Zn}))}}if((g&7)===0){e:{if(an=d==="mouseover"||d==="pointerover",Wn=d==="mouseout"||d==="pointerout",an&&M!==wr&&($n=M.relatedTarget||M.fromElement)&&(y0($n)||$n[Wl]))break e;if((Wn||an)&&(an=on.window===on?on:(an=on.ownerDocument)?an.defaultView||an.parentWindow:window,Wn?($n=M.relatedTarget||M.toElement,Wn=Ot,$n=$n?y0($n):null,$n!==null&&(Hs=oo($n),$n!==Hs||$n.tag!==5&&$n.tag!==6)&&($n=null)):(Wn=null,$n=Ot),Wn!==$n)){if(Zn=Gs,En="onMouseLeave",xt="onMouseEnter",tt="mouse",(d==="pointerout"||d==="pointerover")&&(Zn=Fu,En="onPointerLeave",xt="onPointerEnter",tt="pointer"),Hs=Wn==null?an:Oc(Wn),At=$n==null?an:Oc($n),an=new Zn(En,tt+"leave",Wn,M,on),an.target=Hs,an.relatedTarget=At,En=null,y0(on)===Ot&&(Zn=new Zn(xt,tt+"enter",$n,M,on),Zn.target=At,Zn.relatedTarget=Hs,En=Zn),Hs=En,Wn&&$n)t:{for(Zn=Wn,xt=$n,tt=0,At=Zn;At;At=Kh(At))tt++;for(At=0,En=xt;En;En=Kh(En))At++;for(;0<tt-At;)Zn=Kh(Zn),tt--;for(;0<At-tt;)xt=Kh(xt),At--;for(;tt--;){if(Zn===xt||xt!==null&&Zn===xt.alternate)break t;Zn=Kh(Zn),xt=Kh(xt)}Zn=null}else Zn=null;Wn!==null&&v4(vn,an,Wn,Zn,!1),$n!==null&&Hs!==null&&v4(vn,Hs,$n,Zn,!0)}}e:{if(an=Ot?Oc(Ot):window,Wn=an.nodeName&&an.nodeName.toLowerCase(),Wn==="select"||Wn==="input"&&an.type==="file")var cr=E1;else if(Zg(an))if(T1)cr=Pf;else{cr=to;var Er=di}else(Wn=an.nodeName)&&Wn.toLowerCase()==="input"&&(an.type==="checkbox"||an.type==="radio")&&(cr=g0);if(cr&&(cr=cr(d,Ot))){Wh(vn,cr,M,on);break e}Er&&Er(d,an,Ot),d==="focusout"&&(Er=an._wrapperState)&&Er.controlled&&an.type==="number"&&Pr(an,"number",an.value)}switch(Er=Ot?Oc(Ot):window,d){case"focusin":(Zg(Er)||Er.contentEditable==="true")&&(el=Er,d4=Ot,Xh=null);break;case"focusout":Xh=d4=el=null;break;case"mousedown":Rf=!0;break;case"contextmenu":case"mouseup":case"dragend":Rf=!1,f4(vn,M,on);break;case"selectionchange":if(I6)break;case"keydown":case"keyup":f4(vn,M,on)}var Tr;if(kc)e:{switch(d){case"compositionstart":var Dr="onCompositionStart";break e;case"compositionend":Dr="onCompositionEnd";break e;case"compositionupdate":Dr="onCompositionUpdate";break e}Dr=void 0}else Lu?xi(d,M)&&(Dr="onCompositionEnd"):d==="keydown"&&M.keyCode===229&&(Dr="onCompositionStart");Dr&&(Q0&&M.locale!=="ko"&&(Lu||Dr!=="onCompositionStart"?Dr==="onCompositionEnd"&&Lu&&(Tr=f1()):(Y0=on,Tf="value"in Y0?Y0.value:Y0.textContent,Lu=!0)),Er=R1(Ot,Dr),0<Er.length&&(Dr=new Ou(Dr,d,null,M,on),vn.push({event:Dr,listeners:Er}),Tr?Dr.data=Tr:(Tr=Ic(M),Tr!==null&&(Dr.data=Tr)))),(Tr=Hh?b1(d,M):S1(d,M))&&(Ot=R1(Ot,"onBeforeInput"),0<Ot.length&&(on=new Ou("onBeforeInput","beforeinput",null,M,on),vn.push({event:on,listeners:Ot}),on.data=Tr))}n2(vn,g)})}function Df(d,g,M){return{instance:d,listener:g,currentTarget:M}}function R1(d,g){for(var M=g+"Capture",O=[];d!==null;){var q=d,ee=q.stateNode;q.tag===5&&ee!==null&&(q=ee,ee=so(d,M),ee!=null&&O.unshift(Df(d,ee,q)),ee=so(d,g),ee!=null&&O.push(Df(d,ee,q))),d=d.return}return O}function Kh(d){if(d===null)return null;do d=d.return;while(d&&d.tag!==5);return d||null}function v4(d,g,M,O,q){for(var ee=g._reactName,ge=[];M!==null&&M!==O;){var Fe=M,Xe=Fe.alternate,Ot=Fe.stateNode;if(Xe!==null&&Xe===O)break;Fe.tag===5&&Ot!==null&&(Fe=Ot,q?(Xe=so(M,ee),Xe!=null&&ge.unshift(Df(M,Xe,Fe))):q||(Xe=so(M,ee),Xe!=null&&ge.push(Df(M,Xe,Fe)))),M=M.return}ge.length!==0&&d.push({event:g,listeners:ge})}var O6=/\r\n?/g,F6=/\u0000|\uFFFD/g;function _4(d){return(typeof d=="string"?d:""+d).replace(O6,`
`).replace(F6,"")}function k1(d,g,M){if(g=_4(g),_4(d)!==g&&M)throw Error(t(425))}function I1(){}var s2=null,o2=null;function a2(d,g){return d==="textarea"||d==="noscript"||typeof g.children=="string"||typeof g.children=="number"||typeof g.dangerouslySetInnerHTML=="object"&&g.dangerouslySetInnerHTML!==null&&g.dangerouslySetInnerHTML.__html!=null}var l2=typeof setTimeout=="function"?setTimeout:void 0,es=typeof clearTimeout=="function"?clearTimeout:void 0,x4=typeof Promise=="function"?Promise:void 0,lx=typeof queueMicrotask=="function"?queueMicrotask:typeof x4<"u"?function(d){return x4.resolve(null).then(d).catch(cx)}:l2;function cx(d){setTimeout(function(){throw d})}function Of(d,g){var M=g,O=0;do{var q=M.nextSibling;if(d.removeChild(M),q&&q.nodeType===8)if(M=q.data,M==="/$"){if(O===0){d.removeChild(q),Uh(g);return}O--}else M!=="$"&&M!=="$?"&&M!=="$!"||O++;M=q}while(M);Uh(g)}function Hl(d){for(;d!=null;d=d.nextSibling){var g=d.nodeType;if(g===1||g===3)break;if(g===8){if(g=d.data,g==="$"||g==="$!"||g==="$?")break;if(g==="/$")return null}}return d}function c2(d){d=d.previousSibling;for(var g=0;d;){if(d.nodeType===8){var M=d.data;if(M==="$"||M==="$!"||M==="$?"){if(g===0)return d;g--}else M==="/$"&&g++}d=d.previousSibling}return null}var tl=Math.random().toString(36).slice(2),gi="__reactFiber$"+tl,Vu="__reactProps$"+tl,Wl="__reactContainer$"+tl,N1="__reactEvents$"+tl,b4="__reactListeners$"+tl,u2="__reactHandles$"+tl;function y0(d){var g=d[gi];if(g)return g;for(var M=d.parentNode;M;){if(g=M[Wl]||M[gi]){if(M=g.alternate,g.child!==null||M!==null&&M.child!==null)for(d=c2(d);d!==null;){if(M=d[gi])return M;d=c2(d)}return g}d=M,M=d.parentNode}return null}function Zh(d){return d=d[gi]||d[Wl],!d||d.tag!==5&&d.tag!==6&&d.tag!==13&&d.tag!==3?null:d}function Oc(d){if(d.tag===5||d.tag===6)return d.stateNode;throw Error(t(33))}function h2(d){return d[Vu]||null}var Fc=[],Gu=-1;function Lc(d){return{current:d}}function ts(d){0>Gu||(d.current=Fc[Gu],Fc[Gu]=null,Gu--)}function ns(d,g){Gu++,Fc[Gu]=d.current,d.current=g}var $l={},No=Lc($l),qo=Lc(!1),ju=$l;function Qh(d,g){var M=d.type.contextTypes;if(!M)return $l;var O=d.stateNode;if(O&&O.__reactInternalMemoizedUnmaskedChildContext===g)return O.__reactInternalMemoizedMaskedChildContext;var q={},ee;for(ee in M)q[ee]=g[ee];return O&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=g,d.__reactInternalMemoizedMaskedChildContext=q),q}function Sa(d){return d=d.childContextTypes,d!=null}function D1(){ts(qo),ts(No)}function S4(d,g,M){if(No.current!==$l)throw Error(t(168));ns(No,g),ns(qo,M)}function w4(d,g,M){var O=d.stateNode;if(g=g.childContextTypes,typeof O.getChildContext!="function")return M;O=O.getChildContext();for(var q in O)if(!(q in g))throw Error(t(108,qt(d)||"Unknown",q));return pt({},M,O)}function d2(d){return d=(d=d.stateNode)&&d.__reactInternalMemoizedMergedChildContext||$l,ju=No.current,ns(No,d),ns(qo,qo.current),!0}function L6(d,g,M){var O=d.stateNode;if(!O)throw Error(t(169));M?(d=w4(d,g,ju),O.__reactInternalMemoizedMergedChildContext=d,ts(qo),ts(No),ns(No,d)):ts(qo),ns(qo,M)}var v0=null,ql=!1,E4=!1;function T4(d){v0===null?v0=[d]:v0.push(d)}function B6(d){ql=!0,T4(d)}function nl(){if(!E4&&v0!==null){E4=!0;var d=0,g=hi;try{var M=v0;for(hi=1;d<M.length;d++){var O=M[d];do O=O(!0);while(O!==null)}v0=null,ql=!1}catch(q){throw v0!==null&&(v0=v0.slice(d+1)),Sf(yn,nl),q}finally{hi=g,E4=!1}}return null}var Hu=[],Jh=0,Bc=null,Uc=0,_0=[],wa=0,ed=null,rl=1,Xl="";function td(d,g){Hu[Jh++]=Uc,Hu[Jh++]=Bc,Bc=d,Uc=g}function U6(d,g,M){_0[wa++]=rl,_0[wa++]=Xl,_0[wa++]=ed,ed=d;var O=rl;d=Xl;var q=32-Lr(O)-1;O&=~(1<<q),M+=1;var ee=32-Lr(g)+q;if(30<ee){var ge=q-q%5;ee=(O&(1<<ge)-1).toString(32),O>>=ge,q-=ge,rl=1<<32-Lr(g)+q|M<<q|O,Xl=ee+d}else rl=1<<ee|M<<q|O,Xl=d}function O1(d){d.return!==null&&(td(d,1),U6(d,1,0))}function f2(d){for(;d===Bc;)Bc=Hu[--Jh],Hu[Jh]=null,Uc=Hu[--Jh],Hu[Jh]=null;for(;d===ed;)ed=_0[--wa],_0[wa]=null,Xl=_0[--wa],_0[wa]=null,rl=_0[--wa],_0[wa]=null}var Ea=null,Ta=null,ds=!1,il=null;function p2(d,g){var M=S0(5,null,null,0);M.elementType="DELETED",M.stateNode=g,M.return=d,g=d.deletions,g===null?(d.deletions=[M],d.flags|=16):g.push(M)}function M4(d,g){switch(d.tag){case 5:var M=d.type;return g=g.nodeType!==1||M.toLowerCase()!==g.nodeName.toLowerCase()?null:g,g!==null?(d.stateNode=g,Ea=d,Ta=Hl(g.firstChild),!0):!1;case 6:return g=d.pendingProps===""||g.nodeType!==3?null:g,g!==null?(d.stateNode=g,Ea=d,Ta=null,!0):!1;case 13:return g=g.nodeType!==8?null:g,g!==null?(M=ed!==null?{id:rl,overflow:Xl}:null,d.memoizedState={dehydrated:g,treeContext:M,retryLane:1073741824},M=S0(18,null,null,0),M.stateNode=g,M.return=d,d.child=M,Ea=d,Ta=null,!0):!1;default:return!1}}function m2(d){return(d.mode&1)!==0&&(d.flags&128)===0}function C4(d){if(ds){var g=Ta;if(g){var M=g;if(!M4(d,g)){if(m2(d))throw Error(t(418));g=Hl(M.nextSibling);var O=Ea;g&&M4(d,g)?p2(O,M):(d.flags=d.flags&-4097|2,ds=!1,Ea=d)}}else{if(m2(d))throw Error(t(418));d.flags=d.flags&-4097|2,ds=!1,Ea=d}}}function z6(d){for(d=d.return;d!==null&&d.tag!==5&&d.tag!==3&&d.tag!==13;)d=d.return;Ea=d}function F1(d){if(d!==Ea)return!1;if(!ds)return z6(d),ds=!0,!1;var g;if((g=d.tag!==3)&&!(g=d.tag!==5)&&(g=d.type,g=g!=="head"&&g!=="body"&&!a2(d.type,d.memoizedProps)),g&&(g=Ta)){if(m2(d))throw A4(),Error(t(418));for(;g;)p2(d,g),g=Hl(g.nextSibling)}if(z6(d),d.tag===13){if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(t(317));e:{for(d=d.nextSibling,g=0;d;){if(d.nodeType===8){var M=d.data;if(M==="/$"){if(g===0){Ta=Hl(d.nextSibling);break e}g--}else M!=="$"&&M!=="$!"&&M!=="$?"||g++}d=d.nextSibling}Ta=null}}else Ta=Ea?Hl(d.stateNode.nextSibling):null;return!0}function A4(){for(var d=Ta;d;)d=Hl(d.nextSibling)}function Ff(){Ta=Ea=null,ds=!1}function Wu(d){il===null?il=[d]:il.push(d)}var P4=k.ReactCurrentBatchConfig;function L1(d,g,M){if(d=M.ref,d!==null&&typeof d!="function"&&typeof d!="object"){if(M._owner){if(M=M._owner,M){if(M.tag!==1)throw Error(t(309));var O=M.stateNode}if(!O)throw Error(t(147,d));var q=O,ee=""+d;return g!==null&&g.ref!==null&&typeof g.ref=="function"&&g.ref._stringRef===ee?g.ref:(g=function(ge){var Fe=q.refs;ge===null?delete Fe[ee]:Fe[ee]=ge},g._stringRef=ee,g)}if(typeof d!="string")throw Error(t(284));if(!M._owner)throw Error(t(290,d))}return d}function g2(d,g){throw d=Object.prototype.toString.call(g),Error(t(31,d==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":d))}function B1(d){var g=d._init;return g(d._payload)}function V6(d){function g(xt,tt){if(d){var At=xt.deletions;At===null?(xt.deletions=[tt],xt.flags|=16):At.push(tt)}}function M(xt,tt){if(!d)return null;for(;tt!==null;)g(xt,tt),tt=tt.sibling;return null}function O(xt,tt){for(xt=new Map;tt!==null;)tt.key!==null?xt.set(tt.key,tt):xt.set(tt.index,tt),tt=tt.sibling;return xt}function q(xt,tt){return xt=rc(xt,tt),xt.index=0,xt.sibling=null,xt}function ee(xt,tt,At){return xt.index=At,d?(At=xt.alternate,At!==null?(At=At.index,At<tt?(xt.flags|=2,tt):At):(xt.flags|=2,tt)):(xt.flags|=1048576,tt)}function ge(xt){return d&&xt.alternate===null&&(xt.flags|=2),xt}function Fe(xt,tt,At,En){return tt===null||tt.tag!==6?(tt=a9(At,xt.mode,En),tt.return=xt,tt):(tt=q(tt,At),tt.return=xt,tt)}function Xe(xt,tt,At,En){var cr=At.type;return cr===ce?on(xt,tt,At.props.children,En,At.key):tt!==null&&(tt.elementType===cr||typeof cr=="object"&&cr!==null&&cr.$$typeof===Se&&B1(cr)===tt.type)?(En=q(tt,At.props),En.ref=L1(xt,tt,At),En.return=xt,En):(En=o9(At.type,At.key,At.props,null,xt.mode,En),En.ref=L1(xt,tt,At),En.return=xt,En)}function Ot(xt,tt,At,En){return tt===null||tt.tag!==4||tt.stateNode.containerInfo!==At.containerInfo||tt.stateNode.implementation!==At.implementation?(tt=v5(At,xt.mode,En),tt.return=xt,tt):(tt=q(tt,At.children||[]),tt.return=xt,tt)}function on(xt,tt,At,En,cr){return tt===null||tt.tag!==7?(tt=nh(At,xt.mode,En,cr),tt.return=xt,tt):(tt=q(tt,At),tt.return=xt,tt)}function vn(xt,tt,At){if(typeof tt=="string"&&tt!==""||typeof tt=="number")return tt=a9(""+tt,xt.mode,At),tt.return=xt,tt;if(typeof tt=="object"&&tt!==null){switch(tt.$$typeof){case ie:return At=o9(tt.type,tt.key,tt.props,null,xt.mode,At),At.ref=L1(xt,null,tt),At.return=xt,At;case ue:return tt=v5(tt,xt.mode,At),tt.return=xt,tt;case Se:var En=tt._init;return vn(xt,En(tt._payload),At)}if(sr(tt)||lt(tt))return tt=nh(tt,xt.mode,At,null),tt.return=xt,tt;g2(xt,tt)}return null}function an(xt,tt,At,En){var cr=tt!==null?tt.key:null;if(typeof At=="string"&&At!==""||typeof At=="number")return cr!==null?null:Fe(xt,tt,""+At,En);if(typeof At=="object"&&At!==null){switch(At.$$typeof){case ie:return At.key===cr?Xe(xt,tt,At,En):null;case ue:return At.key===cr?Ot(xt,tt,At,En):null;case Se:return cr=At._init,an(xt,tt,cr(At._payload),En)}if(sr(At)||lt(At))return cr!==null?null:on(xt,tt,At,En,null);g2(xt,At)}return null}function Wn(xt,tt,At,En,cr){if(typeof En=="string"&&En!==""||typeof En=="number")return xt=xt.get(At)||null,Fe(tt,xt,""+En,cr);if(typeof En=="object"&&En!==null){switch(En.$$typeof){case ie:return xt=xt.get(En.key===null?At:En.key)||null,Xe(tt,xt,En,cr);case ue:return xt=xt.get(En.key===null?At:En.key)||null,Ot(tt,xt,En,cr);case Se:var Er=En._init;return Wn(xt,tt,At,Er(En._payload),cr)}if(sr(En)||lt(En))return xt=xt.get(At)||null,on(tt,xt,En,cr,null);g2(tt,En)}return null}function $n(xt,tt,At,En){for(var cr=null,Er=null,Tr=tt,Dr=tt=0,Mo=null;Tr!==null&&Dr<At.length;Dr++){Tr.index>Dr?(Mo=Tr,Tr=null):Mo=Tr.sibling;var bi=an(xt,Tr,At[Dr],En);if(bi===null){Tr===null&&(Tr=Mo);break}d&&Tr&&bi.alternate===null&&g(xt,Tr),tt=ee(bi,tt,Dr),Er===null?cr=bi:Er.sibling=bi,Er=bi,Tr=Mo}if(Dr===At.length)return M(xt,Tr),ds&&td(xt,Dr),cr;if(Tr===null){for(;Dr<At.length;Dr++)Tr=vn(xt,At[Dr],En),Tr!==null&&(tt=ee(Tr,tt,Dr),Er===null?cr=Tr:Er.sibling=Tr,Er=Tr);return ds&&td(xt,Dr),cr}for(Tr=O(xt,Tr);Dr<At.length;Dr++)Mo=Wn(Tr,xt,Dr,At[Dr],En),Mo!==null&&(d&&Mo.alternate!==null&&Tr.delete(Mo.key===null?Dr:Mo.key),tt=ee(Mo,tt,Dr),Er===null?cr=Mo:Er.sibling=Mo,Er=Mo);return d&&Tr.forEach(function(Kc){return g(xt,Kc)}),ds&&td(xt,Dr),cr}function Zn(xt,tt,At,En){var cr=lt(At);if(typeof cr!="function")throw Error(t(150));if(At=cr.call(At),At==null)throw Error(t(151));for(var Er=cr=null,Tr=tt,Dr=tt=0,Mo=null,bi=At.next();Tr!==null&&!bi.done;Dr++,bi=At.next()){Tr.index>Dr?(Mo=Tr,Tr=null):Mo=Tr.sibling;var Kc=an(xt,Tr,bi.value,En);if(Kc===null){Tr===null&&(Tr=Mo);break}d&&Tr&&Kc.alternate===null&&g(xt,Tr),tt=ee(Kc,tt,Dr),Er===null?cr=Kc:Er.sibling=Kc,Er=Kc,Tr=Mo}if(bi.done)return M(xt,Tr),ds&&td(xt,Dr),cr;if(Tr===null){for(;!bi.done;Dr++,bi=At.next())bi=vn(xt,bi.value,En),bi!==null&&(tt=ee(bi,tt,Dr),Er===null?cr=bi:Er.sibling=bi,Er=bi);return ds&&td(xt,Dr),cr}for(Tr=O(xt,Tr);!bi.done;Dr++,bi=At.next())bi=Wn(Tr,xt,Dr,bi.value,En),bi!==null&&(d&&bi.alternate!==null&&Tr.delete(bi.key===null?Dr:bi.key),tt=ee(bi,tt,Dr),Er===null?cr=bi:Er.sibling=bi,Er=bi);return d&&Tr.forEach(function(mx){return g(xt,mx)}),ds&&td(xt,Dr),cr}function Hs(xt,tt,At,En){if(typeof At=="object"&&At!==null&&At.type===ce&&At.key===null&&(At=At.props.children),typeof At=="object"&&At!==null){switch(At.$$typeof){case ie:e:{for(var cr=At.key,Er=tt;Er!==null;){if(Er.key===cr){if(cr=At.type,cr===ce){if(Er.tag===7){M(xt,Er.sibling),tt=q(Er,At.props.children),tt.return=xt,xt=tt;break e}}else if(Er.elementType===cr||typeof cr=="object"&&cr!==null&&cr.$$typeof===Se&&B1(cr)===Er.type){M(xt,Er.sibling),tt=q(Er,At.props),tt.ref=L1(xt,Er,At),tt.return=xt,xt=tt;break e}M(xt,Er);break}else g(xt,Er);Er=Er.sibling}At.type===ce?(tt=nh(At.props.children,xt.mode,En,At.key),tt.return=xt,xt=tt):(En=o9(At.type,At.key,At.props,null,xt.mode,En),En.ref=L1(xt,tt,At),En.return=xt,xt=En)}return ge(xt);case ue:e:{for(Er=At.key;tt!==null;){if(tt.key===Er)if(tt.tag===4&&tt.stateNode.containerInfo===At.containerInfo&&tt.stateNode.implementation===At.implementation){M(xt,tt.sibling),tt=q(tt,At.children||[]),tt.return=xt,xt=tt;break e}else{M(xt,tt);break}else g(xt,tt);tt=tt.sibling}tt=v5(At,xt.mode,En),tt.return=xt,xt=tt}return ge(xt);case Se:return Er=At._init,Hs(xt,tt,Er(At._payload),En)}if(sr(At))return $n(xt,tt,At,En);if(lt(At))return Zn(xt,tt,At,En);g2(xt,At)}return typeof At=="string"&&At!==""||typeof At=="number"?(At=""+At,tt!==null&&tt.tag===6?(M(xt,tt.sibling),tt=q(tt,At),tt.return=xt,xt=tt):(M(xt,tt),tt=a9(At,xt.mode,En),tt.return=xt,xt=tt),ge(xt)):M(xt,tt)}return Hs}var Lf=V6(!0),nd=V6(!1),rd=Lc(null),y2=null,id=null,v2=null;function _2(){v2=id=y2=null}function R4(d){var g=rd.current;ts(rd),d._currentValue=g}function U1(d,g,M){for(;d!==null;){var O=d.alternate;if((d.childLanes&g)!==g?(d.childLanes|=g,O!==null&&(O.childLanes|=g)):O!==null&&(O.childLanes&g)!==g&&(O.childLanes|=g),d===M)break;d=d.return}}function zc(d,g){y2=d,v2=id=null,d=d.dependencies,d!==null&&d.firstContext!==null&&((d.lanes&g)!==0&&(Ma=!0),d.firstContext=null)}function x0(d){var g=d._currentValue;if(v2!==d)if(d={context:d,memoizedValue:g,next:null},id===null){if(y2===null)throw Error(t(308));id=d,y2.dependencies={lanes:0,firstContext:d}}else id=id.next=d;return g}var $u=null;function z1(d){$u===null?$u=[d]:$u.push(d)}function k4(d,g,M,O){var q=g.interleaved;return q===null?(M.next=M,z1(g)):(M.next=q.next,q.next=M),g.interleaved=M,Vc(d,O)}function Vc(d,g){d.lanes|=g;var M=d.alternate;for(M!==null&&(M.lanes|=g),M=d,d=d.return;d!==null;)d.childLanes|=g,M=d.alternate,M!==null&&(M.childLanes|=g),M=d,d=d.return;return M.tag===3?M.stateNode:null}var Yl=!1;function x2(d){d.updateQueue={baseState:d.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function sd(d,g){d=d.updateQueue,g.updateQueue===d&&(g.updateQueue={baseState:d.baseState,firstBaseUpdate:d.firstBaseUpdate,lastBaseUpdate:d.lastBaseUpdate,shared:d.shared,effects:d.effects})}function za(d,g){return{eventTime:d,lane:g,tag:0,payload:null,callback:null,next:null}}function sl(d,g,M){var O=d.updateQueue;if(O===null)return null;if(O=O.shared,(Mi&2)!==0){var q=O.pending;return q===null?g.next=g:(g.next=q.next,q.next=g),O.pending=g,Vc(d,M)}return q=O.interleaved,q===null?(g.next=g,z1(O)):(g.next=q.next,q.next=g),O.interleaved=g,Vc(d,M)}function V1(d,g,M){if(g=g.updateQueue,g!==null&&(g=g.shared,(M&4194240)!==0)){var O=g.lanes;O&=d.pendingLanes,M|=O,g.lanes=M,xs(d,M)}}function od(d,g){var M=d.updateQueue,O=d.alternate;if(O!==null&&(O=O.updateQueue,M===O)){var q=null,ee=null;if(M=M.firstBaseUpdate,M!==null){do{var ge={eventTime:M.eventTime,lane:M.lane,tag:M.tag,payload:M.payload,callback:M.callback,next:null};ee===null?q=ee=ge:ee=ee.next=ge,M=M.next}while(M!==null);ee===null?q=ee=g:ee=ee.next=g}else q=ee=g;M={baseState:O.baseState,firstBaseUpdate:q,lastBaseUpdate:ee,shared:O.shared,effects:O.effects},d.updateQueue=M;return}d=M.lastBaseUpdate,d===null?M.firstBaseUpdate=g:d.next=g,M.lastBaseUpdate=g}function Bf(d,g,M,O){var q=d.updateQueue;Yl=!1;var ee=q.firstBaseUpdate,ge=q.lastBaseUpdate,Fe=q.shared.pending;if(Fe!==null){q.shared.pending=null;var Xe=Fe,Ot=Xe.next;Xe.next=null,ge===null?ee=Ot:ge.next=Ot,ge=Xe;var on=d.alternate;on!==null&&(on=on.updateQueue,Fe=on.lastBaseUpdate,Fe!==ge&&(Fe===null?on.firstBaseUpdate=Ot:Fe.next=Ot,on.lastBaseUpdate=Xe))}if(ee!==null){var vn=q.baseState;ge=0,on=Ot=Xe=null,Fe=ee;do{var an=Fe.lane,Wn=Fe.eventTime;if((O&an)===an){on!==null&&(on=on.next={eventTime:Wn,lane:0,tag:Fe.tag,payload:Fe.payload,callback:Fe.callback,next:null});e:{var $n=d,Zn=Fe;switch(an=g,Wn=M,Zn.tag){case 1:if($n=Zn.payload,typeof $n=="function"){vn=$n.call(Wn,vn,an);break e}vn=$n;break e;case 3:$n.flags=$n.flags&-65537|128;case 0:if($n=Zn.payload,an=typeof $n=="function"?$n.call(Wn,vn,an):$n,an==null)break e;vn=pt({},vn,an);break e;case 2:Yl=!0}}Fe.callback!==null&&Fe.lane!==0&&(d.flags|=64,an=q.effects,an===null?q.effects=[Fe]:an.push(Fe))}else Wn={eventTime:Wn,lane:an,tag:Fe.tag,payload:Fe.payload,callback:Fe.callback,next:null},on===null?(Ot=on=Wn,Xe=vn):on=on.next=Wn,ge|=an;if(Fe=Fe.next,Fe===null){if(Fe=q.shared.pending,Fe===null)break;an=Fe,Fe=an.next,an.next=null,q.lastBaseUpdate=an,q.shared.pending=null}}while(!0);if(on===null&&(Xe=vn),q.baseState=Xe,q.firstBaseUpdate=Ot,q.lastBaseUpdate=on,g=q.shared.interleaved,g!==null){q=g;do ge|=q.lane,q=q.next;while(q!==g)}else ee===null&&(q.shared.lanes=0);tc|=ge,d.lanes=ge,d.memoizedState=vn}}function G6(d,g,M){if(d=g.effects,g.effects=null,d!==null)for(g=0;g<d.length;g++){var O=d[g],q=O.callback;if(q!==null){if(O.callback=null,O=M,typeof q!="function")throw Error(t(191,q));q.call(O)}}}var Uf={},Kl=Lc(Uf),G1=Lc(Uf),zf=Lc(Uf);function qu(d){if(d===Uf)throw Error(t(174));return d}function I4(d,g){switch(ns(zf,g),ns(G1,d),ns(Kl,Uf),d=g.nodeType,d){case 9:case 11:g=(g=g.documentElement)?g.namespaceURI:Zt(null,"");break;default:d=d===8?g.parentNode:g,g=d.namespaceURI||null,d=d.tagName,g=Zt(g,d)}ts(Kl),ns(Kl,g)}function Zl(){ts(Kl),ts(G1),ts(zf)}function j1(d){qu(zf.current);var g=qu(Kl.current),M=Zt(g,d.type);g!==M&&(ns(G1,d),ns(Kl,M))}function N4(d){G1.current===d&&(ts(Kl),ts(G1))}var fs=Lc(0);function b2(d){for(var g=d;g!==null;){if(g.tag===13){var M=g.memoizedState;if(M!==null&&(M=M.dehydrated,M===null||M.data==="$?"||M.data==="$!"))return g}else if(g.tag===19&&g.memoizedProps.revealOrder!==void 0){if((g.flags&128)!==0)return g}else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===d)break;for(;g.sibling===null;){if(g.return===null||g.return===d)return null;g=g.return}g.sibling.return=g.return,g=g.sibling}return null}var D4=[];function S2(){for(var d=0;d<D4.length;d++)D4[d]._workInProgressVersionPrimary=null;D4.length=0}var w2=k.ReactCurrentDispatcher,O4=k.ReactCurrentBatchConfig,Xu=0,Gi=null,bs=null,lo=null,E2=!1,Ql=!1,Gc=0,T2=0;function co(){throw Error(t(321))}function M2(d,g){if(g===null)return!1;for(var M=0;M<g.length&&M<d.length;M++)if(!Io(d[M],g[M]))return!1;return!0}function Vf(d,g,M,O,q,ee){if(Xu=ee,Gi=g,g.memoizedState=null,g.updateQueue=null,g.lanes=0,w2.current=d===null||d.memoizedState===null?j4:X6,d=M(O,q),Ql){ee=0;do{if(Ql=!1,Gc=0,25<=ee)throw Error(t(301));ee+=1,lo=bs=null,g.updateQueue=null,w2.current=ux,d=M(O,q)}while(Ql)}if(w2.current=Y1,g=bs!==null&&bs.next!==null,Xu=0,lo=bs=Gi=null,E2=!1,g)throw Error(t(300));return d}function H1(){var d=Gc!==0;return Gc=0,d}function Jl(){var d={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return lo===null?Gi.memoizedState=lo=d:lo=lo.next=d,lo}function Va(){if(bs===null){var d=Gi.alternate;d=d!==null?d.memoizedState:null}else d=bs.next;var g=lo===null?Gi.memoizedState:lo.next;if(g!==null)lo=g,bs=d;else{if(d===null)throw Error(t(310));bs=d,d={memoizedState:bs.memoizedState,baseState:bs.baseState,baseQueue:bs.baseQueue,queue:bs.queue,next:null},lo===null?Gi.memoizedState=lo=d:lo=lo.next=d}return lo}function Gf(d,g){return typeof g=="function"?g(d):g}function F4(d){var g=Va(),M=g.queue;if(M===null)throw Error(t(311));M.lastRenderedReducer=d;var O=bs,q=O.baseQueue,ee=M.pending;if(ee!==null){if(q!==null){var ge=q.next;q.next=ee.next,ee.next=ge}O.baseQueue=q=ee,M.pending=null}if(q!==null){ee=q.next,O=O.baseState;var Fe=ge=null,Xe=null,Ot=ee;do{var on=Ot.lane;if((Xu&on)===on)Xe!==null&&(Xe=Xe.next={lane:0,action:Ot.action,hasEagerState:Ot.hasEagerState,eagerState:Ot.eagerState,next:null}),O=Ot.hasEagerState?Ot.eagerState:d(O,Ot.action);else{var vn={lane:on,action:Ot.action,hasEagerState:Ot.hasEagerState,eagerState:Ot.eagerState,next:null};Xe===null?(Fe=Xe=vn,ge=O):Xe=Xe.next=vn,Gi.lanes|=on,tc|=on}Ot=Ot.next}while(Ot!==null&&Ot!==ee);Xe===null?ge=O:Xe.next=Fe,Io(O,g.memoizedState)||(Ma=!0),g.memoizedState=O,g.baseState=ge,g.baseQueue=Xe,M.lastRenderedState=O}if(d=M.interleaved,d!==null){q=d;do ee=q.lane,Gi.lanes|=ee,tc|=ee,q=q.next;while(q!==d)}else q===null&&(M.lanes=0);return[g.memoizedState,M.dispatch]}function C2(d){var g=Va(),M=g.queue;if(M===null)throw Error(t(311));M.lastRenderedReducer=d;var O=M.dispatch,q=M.pending,ee=g.memoizedState;if(q!==null){M.pending=null;var ge=q=q.next;do ee=d(ee,ge.action),ge=ge.next;while(ge!==q);Io(ee,g.memoizedState)||(Ma=!0),g.memoizedState=ee,g.baseQueue===null&&(g.baseState=ee),M.lastRenderedState=ee}return[ee,O]}function A2(){}function L4(d,g){var M=Gi,O=Va(),q=g(),ee=!Io(O.memoizedState,q);if(ee&&(O.memoizedState=q,Ma=!0),O=O.queue,cd(j6.bind(null,M,O,d),[d]),O.getSnapshot!==g||ee||lo!==null&&lo.memoizedState.tag&1){if(M.flags|=2048,Yu(9,U4.bind(null,M,O,q,g),void 0,null),wo===null)throw Error(t(349));(Xu&30)!==0||B4(M,g,q)}return q}function B4(d,g,M){d.flags|=16384,d={getSnapshot:g,value:M},g=Gi.updateQueue,g===null?(g={lastEffect:null,stores:null},Gi.updateQueue=g,g.stores=[d]):(M=g.stores,M===null?g.stores=[d]:M.push(d))}function U4(d,g,M,O){g.value=M,g.getSnapshot=O,ad(g)&&z4(d)}function j6(d,g,M){return M(function(){ad(g)&&z4(d)})}function ad(d){var g=d.getSnapshot;d=d.value;try{var M=g();return!Io(d,M)}catch{return!0}}function z4(d){var g=Vc(d,1);g!==null&&ul(g,d,1,-1)}function H6(d){var g=Jl();return typeof d=="function"&&(d=d()),g.memoizedState=g.baseState=d,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Gf,lastRenderedState:d},g.queue=d,d=d.dispatch=G4.bind(null,Gi,d),[g.memoizedState,d]}function Yu(d,g,M,O){return d={tag:d,create:g,destroy:M,deps:O,next:null},g=Gi.updateQueue,g===null?(g={lastEffect:null,stores:null},Gi.updateQueue=g,g.lastEffect=d.next=d):(M=g.lastEffect,M===null?g.lastEffect=d.next=d:(O=M.next,M.next=d,d.next=O,g.lastEffect=d)),d}function P2(){return Va().memoizedState}function W1(d,g,M,O){var q=Jl();Gi.flags|=d,q.memoizedState=Yu(1|g,M,void 0,O===void 0?null:O)}function $1(d,g,M,O){var q=Va();O=O===void 0?null:O;var ee=void 0;if(bs!==null){var ge=bs.memoizedState;if(ee=ge.destroy,O!==null&&M2(O,ge.deps)){q.memoizedState=Yu(g,M,ee,O);return}}Gi.flags|=d,q.memoizedState=Yu(1|g,M,ee,O)}function ld(d,g){return W1(8390656,8,d,g)}function cd(d,g){return $1(2048,8,d,g)}function V4(d,g){return $1(4,2,d,g)}function q1(d,g){return $1(4,4,d,g)}function jf(d,g){if(typeof g=="function")return d=d(),g(d),function(){g(null)};if(g!=null)return d=d(),g.current=d,function(){g.current=null}}function W6(d,g,M){return M=M!=null?M.concat([d]):null,$1(4,4,jf.bind(null,g,d),M)}function jc(){}function Hf(d,g){var M=Va();g=g===void 0?null:g;var O=M.memoizedState;return O!==null&&g!==null&&M2(g,O[1])?O[0]:(M.memoizedState=[d,g],d)}function R2(d,g){var M=Va();g=g===void 0?null:g;var O=M.memoizedState;return O!==null&&g!==null&&M2(g,O[1])?O[0]:(d=d(),M.memoizedState=[d,g],d)}function k2(d,g,M){return(Xu&21)===0?(d.baseState&&(d.baseState=!1,Ma=!0),d.memoizedState=M):(Io(M,g)||(M=Ni(),Gi.lanes|=M,tc|=M,d.baseState=!0),g)}function I2(d,g){var M=hi;hi=M!==0&&4>M?M:4,d(!0);var O=O4.transition;O4.transition={};try{d(!1),g()}finally{hi=M,O4.transition=O}}function $6(){return Va().memoizedState}function X1(d,g,M){var O=cl(d);if(M={lane:O,action:M,hasEagerState:!1,eagerState:null,next:null},q6(d))N2(g,M);else if(M=k4(d,g,M,O),M!==null){var q=To();ul(M,d,O,q),D2(M,g,O)}}function G4(d,g,M){var O=cl(d),q={lane:O,action:M,hasEagerState:!1,eagerState:null,next:null};if(q6(d))N2(g,q);else{var ee=d.alternate;if(d.lanes===0&&(ee===null||ee.lanes===0)&&(ee=g.lastRenderedReducer,ee!==null))try{var ge=g.lastRenderedState,Fe=ee(ge,M);if(q.hasEagerState=!0,q.eagerState=Fe,Io(Fe,ge)){var Xe=g.interleaved;Xe===null?(q.next=q,z1(g)):(q.next=Xe.next,Xe.next=q),g.interleaved=q;return}}catch{}finally{}M=k4(d,g,q,O),M!==null&&(q=To(),ul(M,d,O,q),D2(M,g,O))}}function q6(d){var g=d.alternate;return d===Gi||g!==null&&g===Gi}function N2(d,g){Ql=E2=!0;var M=d.pending;M===null?g.next=g:(g.next=M.next,M.next=g),d.pending=g}function D2(d,g,M){if((M&4194240)!==0){var O=g.lanes;O&=d.pendingLanes,M|=O,g.lanes=M,xs(d,M)}}var Y1={readContext:x0,useCallback:co,useContext:co,useEffect:co,useImperativeHandle:co,useInsertionEffect:co,useLayoutEffect:co,useMemo:co,useReducer:co,useRef:co,useState:co,useDebugValue:co,useDeferredValue:co,useTransition:co,useMutableSource:co,useSyncExternalStore:co,useId:co,unstable_isNewReconciler:!1},j4={readContext:x0,useCallback:function(d,g){return Jl().memoizedState=[d,g===void 0?null:g],d},useContext:x0,useEffect:ld,useImperativeHandle:function(d,g,M){return M=M!=null?M.concat([d]):null,W1(4194308,4,jf.bind(null,g,d),M)},useLayoutEffect:function(d,g){return W1(4194308,4,d,g)},useInsertionEffect:function(d,g){return W1(4,2,d,g)},useMemo:function(d,g){var M=Jl();return g=g===void 0?null:g,d=d(),M.memoizedState=[d,g],d},useReducer:function(d,g,M){var O=Jl();return g=M!==void 0?M(g):g,O.memoizedState=O.baseState=g,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:d,lastRenderedState:g},O.queue=d,d=d.dispatch=X1.bind(null,Gi,d),[O.memoizedState,d]},useRef:function(d){var g=Jl();return d={current:d},g.memoizedState=d},useState:H6,useDebugValue:jc,useDeferredValue:function(d){return Jl().memoizedState=d},useTransition:function(){var d=H6(!1),g=d[0];return d=I2.bind(null,d[1]),Jl().memoizedState=d,[g,d]},useMutableSource:function(){},useSyncExternalStore:function(d,g,M){var O=Gi,q=Jl();if(ds){if(M===void 0)throw Error(t(407));M=M()}else{if(M=g(),wo===null)throw Error(t(349));(Xu&30)!==0||B4(O,g,M)}q.memoizedState=M;var ee={value:M,getSnapshot:g};return q.queue=ee,ld(j6.bind(null,O,ee,d),[d]),O.flags|=2048,Yu(9,U4.bind(null,O,ee,M,g),void 0,null),M},useId:function(){var d=Jl(),g=wo.identifierPrefix;if(ds){var M=Xl,O=rl;M=(O&~(1<<32-Lr(O)-1)).toString(32)+M,g=":"+g+"R"+M,M=Gc++,0<M&&(g+="H"+M.toString(32)),g+=":"}else M=T2++,g=":"+g+"r"+M.toString(32)+":";return d.memoizedState=g},unstable_isNewReconciler:!1},X6={readContext:x0,useCallback:Hf,useContext:x0,useEffect:cd,useImperativeHandle:W6,useInsertionEffect:V4,useLayoutEffect:q1,useMemo:R2,useReducer:F4,useRef:P2,useState:function(){return F4(Gf)},useDebugValue:jc,useDeferredValue:function(d){var g=Va();return k2(g,bs.memoizedState,d)},useTransition:function(){var d=F4(Gf)[0],g=Va().memoizedState;return[d,g]},useMutableSource:A2,useSyncExternalStore:L4,useId:$6,unstable_isNewReconciler:!1},ux={readContext:x0,useCallback:Hf,useContext:x0,useEffect:cd,useImperativeHandle:W6,useInsertionEffect:V4,useLayoutEffect:q1,useMemo:R2,useReducer:C2,useRef:P2,useState:function(){return C2(Gf)},useDebugValue:jc,useDeferredValue:function(d){var g=Va();return bs===null?g.memoizedState=d:k2(g,bs.memoizedState,d)},useTransition:function(){var d=C2(Gf)[0],g=Va().memoizedState;return[d,g]},useMutableSource:A2,useSyncExternalStore:L4,useId:$6,unstable_isNewReconciler:!1};function ol(d,g){if(d&&d.defaultProps){g=pt({},g),d=d.defaultProps;for(var M in d)g[M]===void 0&&(g[M]=d[M]);return g}return g}function O2(d,g,M,O){g=d.memoizedState,M=M(O,g),M=M==null?g:pt({},g,M),d.memoizedState=M,d.lanes===0&&(d.updateQueue.baseState=M)}var K1={isMounted:function(d){return(d=d._reactInternals)?oo(d)===d:!1},enqueueSetState:function(d,g,M){d=d._reactInternals;var O=To(),q=cl(d),ee=za(O,q);ee.payload=g,M!=null&&(ee.callback=M),g=sl(d,ee,q),g!==null&&(ul(g,d,q,O),V1(g,d,q))},enqueueReplaceState:function(d,g,M){d=d._reactInternals;var O=To(),q=cl(d),ee=za(O,q);ee.tag=1,ee.payload=g,M!=null&&(ee.callback=M),g=sl(d,ee,q),g!==null&&(ul(g,d,q,O),V1(g,d,q))},enqueueForceUpdate:function(d,g){d=d._reactInternals;var M=To(),O=cl(d),q=za(M,O);q.tag=2,g!=null&&(q.callback=g),g=sl(d,q,O),g!==null&&(ul(g,d,O,M),V1(g,d,O))}};function Hc(d,g,M,O,q,ee,ge){return d=d.stateNode,typeof d.shouldComponentUpdate=="function"?d.shouldComponentUpdate(O,ee,ge):g.prototype&&g.prototype.isPureReactComponent?!qh(M,O)||!qh(q,ee):!0}function Ku(d,g,M){var O=!1,q=$l,ee=g.contextType;return typeof ee=="object"&&ee!==null?ee=x0(ee):(q=Sa(g)?ju:No.current,O=g.contextTypes,ee=(O=O!=null)?Qh(d,q):$l),g=new g(M,ee),d.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=K1,d.stateNode=g,g._reactInternals=d,O&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=q,d.__reactInternalMemoizedMaskedChildContext=ee),g}function H4(d,g,M,O){d=g.state,typeof g.componentWillReceiveProps=="function"&&g.componentWillReceiveProps(M,O),typeof g.UNSAFE_componentWillReceiveProps=="function"&&g.UNSAFE_componentWillReceiveProps(M,O),g.state!==d&&K1.enqueueReplaceState(g,g.state,null)}function F2(d,g,M,O){var q=d.stateNode;q.props=M,q.state=d.memoizedState,q.refs={},x2(d);var ee=g.contextType;typeof ee=="object"&&ee!==null?q.context=x0(ee):(ee=Sa(g)?ju:No.current,q.context=Qh(d,ee)),q.state=d.memoizedState,ee=g.getDerivedStateFromProps,typeof ee=="function"&&(O2(d,g,ee,M),q.state=d.memoizedState),typeof g.getDerivedStateFromProps=="function"||typeof q.getSnapshotBeforeUpdate=="function"||typeof q.UNSAFE_componentWillMount!="function"&&typeof q.componentWillMount!="function"||(g=q.state,typeof q.componentWillMount=="function"&&q.componentWillMount(),typeof q.UNSAFE_componentWillMount=="function"&&q.UNSAFE_componentWillMount(),g!==q.state&&K1.enqueueReplaceState(q,q.state,null),Bf(d,M,q,O),q.state=d.memoizedState),typeof q.componentDidMount=="function"&&(d.flags|=4194308)}function Wc(d,g){try{var M="",O=g;do M+=Dt(O),O=O.return;while(O);var q=M}catch(ee){q=`
Error generating stack: `+ee.message+`
`+ee.stack}return{value:d,source:g,stack:q,digest:null}}function L2(d,g,M){return{value:d,source:null,stack:M??null,digest:g??null}}function W4(d,g){try{console.error(g.value)}catch(M){setTimeout(function(){throw M})}}var Z1=typeof WeakMap=="function"?WeakMap:Map;function $4(d,g,M){M=za(-1,M),M.tag=3,M.payload={element:null};var O=g.value;return M.callback=function(){sm||(sm=!0,h5=O),W4(d,g)},M}function Q1(d,g,M){M=za(-1,M),M.tag=3;var O=d.type.getDerivedStateFromError;if(typeof O=="function"){var q=g.value;M.payload=function(){return O(q)},M.callback=function(){W4(d,g)}}var ee=d.stateNode;return ee!==null&&typeof ee.componentDidCatch=="function"&&(M.callback=function(){W4(d,g),typeof O!="function"&&(b0===null?b0=new Set([this]):b0.add(this));var ge=g.stack;this.componentDidCatch(g.value,{componentStack:ge!==null?ge:""})}),M}function Y6(d,g,M){var O=d.pingCache;if(O===null){O=d.pingCache=new Z1;var q=new Set;O.set(g,q)}else q=O.get(g),q===void 0&&(q=new Set,O.set(g,q));q.has(M)||(q.add(M),d=gy.bind(null,d,g,M),g.then(d,d))}function K6(d){do{var g;if((g=d.tag===13)&&(g=d.memoizedState,g=g!==null?g.dehydrated!==null:!0),g)return d;d=d.return}while(d!==null);return null}function q4(d,g,M,O,q){return(d.mode&1)===0?(d===g?d.flags|=65536:(d.flags|=128,M.flags|=131072,M.flags&=-52805,M.tag===1&&(M.alternate===null?M.tag=17:(g=za(-1,1),g.tag=2,sl(M,g,1))),M.lanes|=1),d):(d.flags|=65536,d.lanes=q,d)}var hx=k.ReactCurrentOwner,Ma=!1;function ii(d,g,M,O){g.child=d===null?nd(g,null,M,O):Lf(g,d.child,M,O)}function Wf(d,g,M,O,q){M=M.render;var ee=g.ref;return zc(g,q),O=Vf(d,g,M,O,ee,q),M=H1(),d!==null&&!Ma?(g.updateQueue=d.updateQueue,g.flags&=-2053,d.lanes&=~q,$c(d,g,q)):(ds&&M&&O1(g),g.flags|=1,ii(d,g,O,q),g.child)}function Z6(d,g,M,O,q){if(d===null){var ee=M.type;return typeof ee=="function"&&!i9(ee)&&ee.defaultProps===void 0&&M.compare===null&&M.defaultProps===void 0?(g.tag=15,g.type=ee,X4(d,g,ee,O,q)):(d=o9(M.type,null,O,g,g.mode,q),d.ref=g.ref,d.return=g,g.child=d)}if(ee=d.child,(d.lanes&q)===0){var ge=ee.memoizedProps;if(M=M.compare,M=M!==null?M:qh,M(ge,O)&&d.ref===g.ref)return $c(d,g,q)}return g.flags|=1,d=rc(ee,O),d.ref=g.ref,d.return=g,g.child=d}function X4(d,g,M,O,q){if(d!==null){var ee=d.memoizedProps;if(qh(ee,O)&&d.ref===g.ref)if(Ma=!1,g.pendingProps=O=ee,(d.lanes&q)!==0)(d.flags&131072)!==0&&(Ma=!0);else return g.lanes=d.lanes,$c(d,g,q)}return B2(d,g,M,O,q)}function Q6(d,g,M){var O=g.pendingProps,q=O.children,ee=d!==null?d.memoizedState:null;if(O.mode==="hidden")if((g.mode&1)===0)g.memoizedState={baseLanes:0,cachePool:null,transitions:null},ns(Kf,Ha),Ha|=M;else{if((M&1073741824)===0)return d=ee!==null?ee.baseLanes|M:M,g.lanes=g.childLanes=1073741824,g.memoizedState={baseLanes:d,cachePool:null,transitions:null},g.updateQueue=null,ns(Kf,Ha),Ha|=d,null;g.memoizedState={baseLanes:0,cachePool:null,transitions:null},O=ee!==null?ee.baseLanes:M,ns(Kf,Ha),Ha|=O}else ee!==null?(O=ee.baseLanes|M,g.memoizedState=null):O=M,ns(Kf,Ha),Ha|=O;return ii(d,g,q,M),g.child}function J6(d,g){var M=g.ref;(d===null&&M!==null||d!==null&&d.ref!==M)&&(g.flags|=512,g.flags|=2097152)}function B2(d,g,M,O,q){var ee=Sa(M)?ju:No.current;return ee=Qh(g,ee),zc(g,q),M=Vf(d,g,M,O,ee,q),O=H1(),d!==null&&!Ma?(g.updateQueue=d.updateQueue,g.flags&=-2053,d.lanes&=~q,$c(d,g,q)):(ds&&O&&O1(g),g.flags|=1,ii(d,g,M,q),g.child)}function ey(d,g,M,O,q){if(Sa(M)){var ee=!0;d2(g)}else ee=!1;if(zc(g,q),g.stateNode===null)em(d,g),Ku(g,M,O),F2(g,M,O,q),O=!0;else if(d===null){var ge=g.stateNode,Fe=g.memoizedProps;ge.props=Fe;var Xe=ge.context,Ot=M.contextType;typeof Ot=="object"&&Ot!==null?Ot=x0(Ot):(Ot=Sa(M)?ju:No.current,Ot=Qh(g,Ot));var on=M.getDerivedStateFromProps,vn=typeof on=="function"||typeof ge.getSnapshotBeforeUpdate=="function";vn||typeof ge.UNSAFE_componentWillReceiveProps!="function"&&typeof ge.componentWillReceiveProps!="function"||(Fe!==O||Xe!==Ot)&&H4(g,ge,O,Ot),Yl=!1;var an=g.memoizedState;ge.state=an,Bf(g,O,ge,q),Xe=g.memoizedState,Fe!==O||an!==Xe||qo.current||Yl?(typeof on=="function"&&(O2(g,M,on,O),Xe=g.memoizedState),(Fe=Yl||Hc(g,M,Fe,O,an,Xe,Ot))?(vn||typeof ge.UNSAFE_componentWillMount!="function"&&typeof ge.componentWillMount!="function"||(typeof ge.componentWillMount=="function"&&ge.componentWillMount(),typeof ge.UNSAFE_componentWillMount=="function"&&ge.UNSAFE_componentWillMount()),typeof ge.componentDidMount=="function"&&(g.flags|=4194308)):(typeof ge.componentDidMount=="function"&&(g.flags|=4194308),g.memoizedProps=O,g.memoizedState=Xe),ge.props=O,ge.state=Xe,ge.context=Ot,O=Fe):(typeof ge.componentDidMount=="function"&&(g.flags|=4194308),O=!1)}else{ge=g.stateNode,sd(d,g),Fe=g.memoizedProps,Ot=g.type===g.elementType?Fe:ol(g.type,Fe),ge.props=Ot,vn=g.pendingProps,an=ge.context,Xe=M.contextType,typeof Xe=="object"&&Xe!==null?Xe=x0(Xe):(Xe=Sa(M)?ju:No.current,Xe=Qh(g,Xe));var Wn=M.getDerivedStateFromProps;(on=typeof Wn=="function"||typeof ge.getSnapshotBeforeUpdate=="function")||typeof ge.UNSAFE_componentWillReceiveProps!="function"&&typeof ge.componentWillReceiveProps!="function"||(Fe!==vn||an!==Xe)&&H4(g,ge,O,Xe),Yl=!1,an=g.memoizedState,ge.state=an,Bf(g,O,ge,q);var $n=g.memoizedState;Fe!==vn||an!==$n||qo.current||Yl?(typeof Wn=="function"&&(O2(g,M,Wn,O),$n=g.memoizedState),(Ot=Yl||Hc(g,M,Ot,O,an,$n,Xe)||!1)?(on||typeof ge.UNSAFE_componentWillUpdate!="function"&&typeof ge.componentWillUpdate!="function"||(typeof ge.componentWillUpdate=="function"&&ge.componentWillUpdate(O,$n,Xe),typeof ge.UNSAFE_componentWillUpdate=="function"&&ge.UNSAFE_componentWillUpdate(O,$n,Xe)),typeof ge.componentDidUpdate=="function"&&(g.flags|=4),typeof ge.getSnapshotBeforeUpdate=="function"&&(g.flags|=1024)):(typeof ge.componentDidUpdate!="function"||Fe===d.memoizedProps&&an===d.memoizedState||(g.flags|=4),typeof ge.getSnapshotBeforeUpdate!="function"||Fe===d.memoizedProps&&an===d.memoizedState||(g.flags|=1024),g.memoizedProps=O,g.memoizedState=$n),ge.props=O,ge.state=$n,ge.context=Xe,O=Ot):(typeof ge.componentDidUpdate!="function"||Fe===d.memoizedProps&&an===d.memoizedState||(g.flags|=4),typeof ge.getSnapshotBeforeUpdate!="function"||Fe===d.memoizedProps&&an===d.memoizedState||(g.flags|=1024),O=!1)}return Y4(d,g,M,O,ee,q)}function Y4(d,g,M,O,q,ee){J6(d,g);var ge=(g.flags&128)!==0;if(!O&&!ge)return q&&L6(g,M,!1),$c(d,g,ee);O=g.stateNode,hx.current=g;var Fe=ge&&typeof M.getDerivedStateFromError!="function"?null:O.render();return g.flags|=1,d!==null&&ge?(g.child=Lf(g,d.child,null,ee),g.child=Lf(g,null,Fe,ee)):ii(d,g,Fe,ee),g.memoizedState=O.state,q&&L6(g,M,!0),g.child}function K4(d){var g=d.stateNode;g.pendingContext?S4(d,g.pendingContext,g.pendingContext!==g.context):g.context&&S4(d,g.context,!1),I4(d,g.containerInfo)}function ty(d,g,M,O,q){return Ff(),Wu(q),g.flags|=256,ii(d,g,M,O),g.child}var Z4={dehydrated:null,treeContext:null,retryLane:0};function U2(d){return{baseLanes:d,cachePool:null,transitions:null}}function ny(d,g,M){var O=g.pendingProps,q=fs.current,ee=!1,ge=(g.flags&128)!==0,Fe;if((Fe=ge)||(Fe=d!==null&&d.memoizedState===null?!1:(q&2)!==0),Fe?(ee=!0,g.flags&=-129):(d===null||d.memoizedState!==null)&&(q|=1),ns(fs,q&1),d===null)return C4(g),d=g.memoizedState,d!==null&&(d=d.dehydrated,d!==null)?((g.mode&1)===0?g.lanes=1:d.data==="$!"?g.lanes=8:g.lanes=1073741824,null):(ge=O.children,d=O.fallback,ee?(O=g.mode,ee=g.child,ge={mode:"hidden",children:ge},(O&1)===0&&ee!==null?(ee.childLanes=0,ee.pendingProps=ge):ee=um(ge,O,0,null),d=nh(d,O,M,null),ee.return=g,d.return=g,ee.sibling=d,g.child=ee,g.child.memoizedState=U2(M),g.memoizedState=Z4,d):Q4(g,ge));if(q=d.memoizedState,q!==null&&(Fe=q.dehydrated,Fe!==null))return ry(d,g,ge,O,Fe,q,M);if(ee){ee=O.fallback,ge=g.mode,q=d.child,Fe=q.sibling;var Xe={mode:"hidden",children:O.children};return(ge&1)===0&&g.child!==q?(O=g.child,O.childLanes=0,O.pendingProps=Xe,g.deletions=null):(O=rc(q,Xe),O.subtreeFlags=q.subtreeFlags&14680064),Fe!==null?ee=rc(Fe,ee):(ee=nh(ee,ge,M,null),ee.flags|=2),ee.return=g,O.return=g,O.sibling=ee,g.child=O,O=ee,ee=g.child,ge=d.child.memoizedState,ge=ge===null?U2(M):{baseLanes:ge.baseLanes|M,cachePool:null,transitions:ge.transitions},ee.memoizedState=ge,ee.childLanes=d.childLanes&~M,g.memoizedState=Z4,O}return ee=d.child,d=ee.sibling,O=rc(ee,{mode:"visible",children:O.children}),(g.mode&1)===0&&(O.lanes=M),O.return=g,O.sibling=null,d!==null&&(M=g.deletions,M===null?(g.deletions=[d],g.flags|=16):M.push(d)),g.child=O,g.memoizedState=null,O}function Q4(d,g){return g=um({mode:"visible",children:g},d.mode,0,null),g.return=d,d.child=g}function J1(d,g,M,O){return O!==null&&Wu(O),Lf(g,d.child,null,M),d=Q4(g,g.pendingProps.children),d.flags|=2,g.memoizedState=null,d}function ry(d,g,M,O,q,ee,ge){if(M)return g.flags&256?(g.flags&=-257,O=L2(Error(t(422))),J1(d,g,ge,O)):g.memoizedState!==null?(g.child=d.child,g.flags|=128,null):(ee=O.fallback,q=g.mode,O=um({mode:"visible",children:O.children},q,0,null),ee=nh(ee,q,ge,null),ee.flags|=2,O.return=g,ee.return=g,O.sibling=ee,g.child=O,(g.mode&1)!==0&&Lf(g,d.child,null,ge),g.child.memoizedState=U2(ge),g.memoizedState=Z4,ee);if((g.mode&1)===0)return J1(d,g,ge,null);if(q.data==="$!"){if(O=q.nextSibling&&q.nextSibling.dataset,O)var Fe=O.dgst;return O=Fe,ee=Error(t(419)),O=L2(ee,O,void 0),J1(d,g,ge,O)}if(Fe=(ge&d.childLanes)!==0,Ma||Fe){if(O=wo,O!==null){switch(ge&-ge){case 4:q=2;break;case 16:q=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:q=32;break;case 536870912:q=268435456;break;default:q=0}q=(q&(O.suspendedLanes|ge))!==0?0:q,q!==0&&q!==ee.retryLane&&(ee.retryLane=q,Vc(d,q),ul(O,d,q,-1))}return cm(),O=L2(Error(t(421))),J1(d,g,ge,O)}return q.data==="$?"?(g.flags|=128,g.child=d.child,g=n9.bind(null,d),q._reactRetry=g,null):(d=ee.treeContext,Ta=Hl(q.nextSibling),Ea=g,ds=!0,il=null,d!==null&&(_0[wa++]=rl,_0[wa++]=Xl,_0[wa++]=ed,rl=d.id,Xl=d.overflow,ed=g),g=Q4(g,O.children),g.flags|=4096,g)}function iy(d,g,M){d.lanes|=g;var O=d.alternate;O!==null&&(O.lanes|=g),U1(d.return,g,M)}function Zu(d,g,M,O,q){var ee=d.memoizedState;ee===null?d.memoizedState={isBackwards:g,rendering:null,renderingStartTime:0,last:O,tail:M,tailMode:q}:(ee.isBackwards=g,ee.rendering=null,ee.renderingStartTime=0,ee.last=O,ee.tail=M,ee.tailMode=q)}function $f(d,g,M){var O=g.pendingProps,q=O.revealOrder,ee=O.tail;if(ii(d,g,O.children,M),O=fs.current,(O&2)!==0)O=O&1|2,g.flags|=128;else{if(d!==null&&(d.flags&128)!==0)e:for(d=g.child;d!==null;){if(d.tag===13)d.memoizedState!==null&&iy(d,M,g);else if(d.tag===19)iy(d,M,g);else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===g)break e;for(;d.sibling===null;){if(d.return===null||d.return===g)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}O&=1}if(ns(fs,O),(g.mode&1)===0)g.memoizedState=null;else switch(q){case"forwards":for(M=g.child,q=null;M!==null;)d=M.alternate,d!==null&&b2(d)===null&&(q=M),M=M.sibling;M=q,M===null?(q=g.child,g.child=null):(q=M.sibling,M.sibling=null),Zu(g,!1,q,M,ee);break;case"backwards":for(M=null,q=g.child,g.child=null;q!==null;){if(d=q.alternate,d!==null&&b2(d)===null){g.child=q;break}d=q.sibling,q.sibling=M,M=q,q=d}Zu(g,!0,M,null,ee);break;case"together":Zu(g,!1,null,null,void 0);break;default:g.memoizedState=null}return g.child}function em(d,g){(g.mode&1)===0&&d!==null&&(d.alternate=null,g.alternate=null,g.flags|=2)}function $c(d,g,M){if(d!==null&&(g.dependencies=d.dependencies),tc|=g.lanes,(M&g.childLanes)===0)return null;if(d!==null&&g.child!==d.child)throw Error(t(153));if(g.child!==null){for(d=g.child,M=rc(d,d.pendingProps),g.child=M,M.return=g;d.sibling!==null;)d=d.sibling,M=M.sibling=rc(d,d.pendingProps),M.return=g;M.sibling=null}return g.child}function sy(d,g,M){switch(g.tag){case 3:K4(g),Ff();break;case 5:j1(g);break;case 1:Sa(g.type)&&d2(g);break;case 4:I4(g,g.stateNode.containerInfo);break;case 10:var O=g.type._context,q=g.memoizedProps.value;ns(rd,O._currentValue),O._currentValue=q;break;case 13:if(O=g.memoizedState,O!==null)return O.dehydrated!==null?(ns(fs,fs.current&1),g.flags|=128,null):(M&g.child.childLanes)!==0?ny(d,g,M):(ns(fs,fs.current&1),d=$c(d,g,M),d!==null?d.sibling:null);ns(fs,fs.current&1);break;case 19:if(O=(M&g.childLanes)!==0,(d.flags&128)!==0){if(O)return $f(d,g,M);g.flags|=128}if(q=g.memoizedState,q!==null&&(q.rendering=null,q.tail=null,q.lastEffect=null),ns(fs,fs.current),O)break;return null;case 22:case 23:return g.lanes=0,Q6(d,g,M)}return $c(d,g,M)}var oy,J4,e5,ay;oy=function(d,g){for(var M=g.child;M!==null;){if(M.tag===5||M.tag===6)d.appendChild(M.stateNode);else if(M.tag!==4&&M.child!==null){M.child.return=M,M=M.child;continue}if(M===g)break;for(;M.sibling===null;){if(M.return===null||M.return===g)return;M=M.return}M.sibling.return=M.return,M=M.sibling}},J4=function(){},e5=function(d,g,M,O){var q=d.memoizedProps;if(q!==O){d=g.stateNode,qu(Kl.current);var ee=null;switch(M){case"input":q=$e(d,q),O=$e(d,O),ee=[];break;case"select":q=pt({},q,{value:void 0}),O=pt({},O,{value:void 0}),ee=[];break;case"textarea":q=mi(d,q),O=mi(d,O),ee=[];break;default:typeof q.onClick!="function"&&typeof O.onClick=="function"&&(d.onclick=I1)}gr(M,O);var ge;M=null;for(Ot in q)if(!O.hasOwnProperty(Ot)&&q.hasOwnProperty(Ot)&&q[Ot]!=null)if(Ot==="style"){var Fe=q[Ot];for(ge in Fe)Fe.hasOwnProperty(ge)&&(M||(M={}),M[ge]="")}else Ot!=="dangerouslySetInnerHTML"&&Ot!=="children"&&Ot!=="suppressContentEditableWarning"&&Ot!=="suppressHydrationWarning"&&Ot!=="autoFocus"&&(r.hasOwnProperty(Ot)?ee||(ee=[]):(ee=ee||[]).push(Ot,null));for(Ot in O){var Xe=O[Ot];if(Fe=q!=null?q[Ot]:void 0,O.hasOwnProperty(Ot)&&Xe!==Fe&&(Xe!=null||Fe!=null))if(Ot==="style")if(Fe){for(ge in Fe)!Fe.hasOwnProperty(ge)||Xe&&Xe.hasOwnProperty(ge)||(M||(M={}),M[ge]="");for(ge in Xe)Xe.hasOwnProperty(ge)&&Fe[ge]!==Xe[ge]&&(M||(M={}),M[ge]=Xe[ge])}else M||(ee||(ee=[]),ee.push(Ot,M)),M=Xe;else Ot==="dangerouslySetInnerHTML"?(Xe=Xe?Xe.__html:void 0,Fe=Fe?Fe.__html:void 0,Xe!=null&&Fe!==Xe&&(ee=ee||[]).push(Ot,Xe)):Ot==="children"?typeof Xe!="string"&&typeof Xe!="number"||(ee=ee||[]).push(Ot,""+Xe):Ot!=="suppressContentEditableWarning"&&Ot!=="suppressHydrationWarning"&&(r.hasOwnProperty(Ot)?(Xe!=null&&Ot==="onScroll"&&Ji("scroll",d),ee||Fe===Xe||(ee=[])):(ee=ee||[]).push(Ot,Xe))}M&&(ee=ee||[]).push("style",M);var Ot=ee;(g.updateQueue=Ot)&&(g.flags|=4)}},ay=function(d,g,M,O){M!==O&&(g.flags|=4)};function qf(d,g){if(!ds)switch(d.tailMode){case"hidden":g=d.tail;for(var M=null;g!==null;)g.alternate!==null&&(M=g),g=g.sibling;M===null?d.tail=null:M.sibling=null;break;case"collapsed":M=d.tail;for(var O=null;M!==null;)M.alternate!==null&&(O=M),M=M.sibling;O===null?g||d.tail===null?d.tail=null:d.tail.sibling=null:O.sibling=null}}function Do(d){var g=d.alternate!==null&&d.alternate.child===d.child,M=0,O=0;if(g)for(var q=d.child;q!==null;)M|=q.lanes|q.childLanes,O|=q.subtreeFlags&14680064,O|=q.flags&14680064,q.return=d,q=q.sibling;else for(q=d.child;q!==null;)M|=q.lanes|q.childLanes,O|=q.subtreeFlags,O|=q.flags,q.return=d,q=q.sibling;return d.subtreeFlags|=O,d.childLanes=M,g}function t5(d,g,M){var O=g.pendingProps;switch(f2(g),g.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Do(g),null;case 1:return Sa(g.type)&&D1(),Do(g),null;case 3:return O=g.stateNode,Zl(),ts(qo),ts(No),S2(),O.pendingContext&&(O.context=O.pendingContext,O.pendingContext=null),(d===null||d.child===null)&&(F1(g)?g.flags|=4:d===null||d.memoizedState.isDehydrated&&(g.flags&256)===0||(g.flags|=1024,il!==null&&(Z2(il),il=null))),J4(d,g),Do(g),null;case 5:N4(g);var q=qu(zf.current);if(M=g.type,d!==null&&g.stateNode!=null)e5(d,g,M,O,q),d.ref!==g.ref&&(g.flags|=512,g.flags|=2097152);else{if(!O){if(g.stateNode===null)throw Error(t(166));return Do(g),null}if(d=qu(Kl.current),F1(g)){O=g.stateNode,M=g.type;var ee=g.memoizedProps;switch(O[gi]=g,O[Vu]=ee,d=(g.mode&1)!==0,M){case"dialog":Ji("cancel",O),Ji("close",O);break;case"iframe":case"object":case"embed":Ji("load",O);break;case"video":case"audio":for(q=0;q<Yh.length;q++)Ji(Yh[q],O);break;case"source":Ji("error",O);break;case"img":case"image":case"link":Ji("error",O),Ji("load",O);break;case"details":Ji("toggle",O);break;case"input":Ls(O,ee),Ji("invalid",O);break;case"select":O._wrapperState={wasMultiple:!!ee.multiple},Ji("invalid",O);break;case"textarea":Oe(O,ee),Ji("invalid",O)}gr(M,ee),q=null;for(var ge in ee)if(ee.hasOwnProperty(ge)){var Fe=ee[ge];ge==="children"?typeof Fe=="string"?O.textContent!==Fe&&(ee.suppressHydrationWarning!==!0&&k1(O.textContent,Fe,d),q=["children",Fe]):typeof Fe=="number"&&O.textContent!==""+Fe&&(ee.suppressHydrationWarning!==!0&&k1(O.textContent,Fe,d),q=["children",""+Fe]):r.hasOwnProperty(ge)&&Fe!=null&&ge==="onScroll"&&Ji("scroll",O)}switch(M){case"input":ni(O),Ln(O,ee,!0);break;case"textarea":ni(O),Ct(O);break;case"select":case"option":break;default:typeof ee.onClick=="function"&&(O.onclick=I1)}O=q,g.updateQueue=O,O!==null&&(g.flags|=4)}else{ge=q.nodeType===9?q:q.ownerDocument,d==="http://www.w3.org/1999/xhtml"&&(d=Kt(M)),d==="http://www.w3.org/1999/xhtml"?M==="script"?(d=ge.createElement("div"),d.innerHTML="<script><\/script>",d=d.removeChild(d.firstChild)):typeof O.is=="string"?d=ge.createElement(M,{is:O.is}):(d=ge.createElement(M),M==="select"&&(ge=d,O.multiple?ge.multiple=!0:O.size&&(ge.size=O.size))):d=ge.createElementNS(d,M),d[gi]=g,d[Vu]=O,oy(d,g,!1,!1),g.stateNode=d;e:{switch(ge=Pn(M,O),M){case"dialog":Ji("cancel",d),Ji("close",d),q=O;break;case"iframe":case"object":case"embed":Ji("load",d),q=O;break;case"video":case"audio":for(q=0;q<Yh.length;q++)Ji(Yh[q],d);q=O;break;case"source":Ji("error",d),q=O;break;case"img":case"image":case"link":Ji("error",d),Ji("load",d),q=O;break;case"details":Ji("toggle",d),q=O;break;case"input":Ls(d,O),q=$e(d,O),Ji("invalid",d);break;case"option":q=O;break;case"select":d._wrapperState={wasMultiple:!!O.multiple},q=pt({},O,{value:void 0}),Ji("invalid",d);break;case"textarea":Oe(d,O),q=mi(d,O),Ji("invalid",d);break;default:q=O}gr(M,q),Fe=q;for(ee in Fe)if(Fe.hasOwnProperty(ee)){var Xe=Fe[ee];ee==="style"?jn(d,Xe):ee==="dangerouslySetInnerHTML"?(Xe=Xe?Xe.__html:void 0,Xe!=null&&or(d,Xe)):ee==="children"?typeof Xe=="string"?(M!=="textarea"||Xe!=="")&&An(d,Xe):typeof Xe=="number"&&An(d,""+Xe):ee!=="suppressContentEditableWarning"&&ee!=="suppressHydrationWarning"&&ee!=="autoFocus"&&(r.hasOwnProperty(ee)?Xe!=null&&ee==="onScroll"&&Ji("scroll",d):Xe!=null&&Z(d,ee,Xe,ge))}switch(M){case"input":ni(d),Ln(d,O,!1);break;case"textarea":ni(d),Ct(d);break;case"option":O.value!=null&&d.setAttribute("value",""+wn(O.value));break;case"select":d.multiple=!!O.multiple,ee=O.value,ee!=null?dr(d,!!O.multiple,ee,!1):O.defaultValue!=null&&dr(d,!!O.multiple,O.defaultValue,!0);break;default:typeof q.onClick=="function"&&(d.onclick=I1)}switch(M){case"button":case"input":case"select":case"textarea":O=!!O.autoFocus;break e;case"img":O=!0;break e;default:O=!1}}O&&(g.flags|=4)}g.ref!==null&&(g.flags|=512,g.flags|=2097152)}return Do(g),null;case 6:if(d&&g.stateNode!=null)ay(d,g,d.memoizedProps,O);else{if(typeof O!="string"&&g.stateNode===null)throw Error(t(166));if(M=qu(zf.current),qu(Kl.current),F1(g)){if(O=g.stateNode,M=g.memoizedProps,O[gi]=g,(ee=O.nodeValue!==M)&&(d=Ea,d!==null))switch(d.tag){case 3:k1(O.nodeValue,M,(d.mode&1)!==0);break;case 5:d.memoizedProps.suppressHydrationWarning!==!0&&k1(O.nodeValue,M,(d.mode&1)!==0)}ee&&(g.flags|=4)}else O=(M.nodeType===9?M:M.ownerDocument).createTextNode(O),O[gi]=g,g.stateNode=O}return Do(g),null;case 13:if(ts(fs),O=g.memoizedState,d===null||d.memoizedState!==null&&d.memoizedState.dehydrated!==null){if(ds&&Ta!==null&&(g.mode&1)!==0&&(g.flags&128)===0)A4(),Ff(),g.flags|=98560,ee=!1;else if(ee=F1(g),O!==null&&O.dehydrated!==null){if(d===null){if(!ee)throw Error(t(318));if(ee=g.memoizedState,ee=ee!==null?ee.dehydrated:null,!ee)throw Error(t(317));ee[gi]=g}else Ff(),(g.flags&128)===0&&(g.memoizedState=null),g.flags|=4;Do(g),ee=!1}else il!==null&&(Z2(il),il=null),ee=!0;if(!ee)return g.flags&65536?g:null}return(g.flags&128)!==0?(g.lanes=M,g):(O=O!==null,O!==(d!==null&&d.memoizedState!==null)&&O&&(g.child.flags|=8192,(g.mode&1)!==0&&(d===null||(fs.current&1)!==0?Br===0&&(Br=3):cm())),g.updateQueue!==null&&(g.flags|=4),Do(g),null);case 4:return Zl(),J4(d,g),d===null&&Nf(g.stateNode.containerInfo),Do(g),null;case 10:return R4(g.type._context),Do(g),null;case 17:return Sa(g.type)&&D1(),Do(g),null;case 19:if(ts(fs),ee=g.memoizedState,ee===null)return Do(g),null;if(O=(g.flags&128)!==0,ge=ee.rendering,ge===null)if(O)qf(ee,!1);else{if(Br!==0||d!==null&&(d.flags&128)!==0)for(d=g.child;d!==null;){if(ge=b2(d),ge!==null){for(g.flags|=128,qf(ee,!1),O=ge.updateQueue,O!==null&&(g.updateQueue=O,g.flags|=4),g.subtreeFlags=0,O=M,M=g.child;M!==null;)ee=M,d=O,ee.flags&=14680066,ge=ee.alternate,ge===null?(ee.childLanes=0,ee.lanes=d,ee.child=null,ee.subtreeFlags=0,ee.memoizedProps=null,ee.memoizedState=null,ee.updateQueue=null,ee.dependencies=null,ee.stateNode=null):(ee.childLanes=ge.childLanes,ee.lanes=ge.lanes,ee.child=ge.child,ee.subtreeFlags=0,ee.deletions=null,ee.memoizedProps=ge.memoizedProps,ee.memoizedState=ge.memoizedState,ee.updateQueue=ge.updateQueue,ee.type=ge.type,d=ge.dependencies,ee.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext}),M=M.sibling;return ns(fs,fs.current&1|2),g.child}d=d.sibling}ee.tail!==null&&bt()>Qf&&(g.flags|=128,O=!0,qf(ee,!1),g.lanes=4194304)}else{if(!O)if(d=b2(ge),d!==null){if(g.flags|=128,O=!0,M=d.updateQueue,M!==null&&(g.updateQueue=M,g.flags|=4),qf(ee,!0),ee.tail===null&&ee.tailMode==="hidden"&&!ge.alternate&&!ds)return Do(g),null}else 2*bt()-ee.renderingStartTime>Qf&&M!==1073741824&&(g.flags|=128,O=!0,qf(ee,!1),g.lanes=4194304);ee.isBackwards?(ge.sibling=g.child,g.child=ge):(M=ee.last,M!==null?M.sibling=ge:g.child=ge,ee.last=ge)}return ee.tail!==null?(g=ee.tail,ee.rendering=g,ee.tail=g.sibling,ee.renderingStartTime=bt(),g.sibling=null,M=fs.current,ns(fs,O?M&1|2:M&1),g):(Do(g),null);case 22:case 23:return J2(),O=g.memoizedState!==null,d!==null&&d.memoizedState!==null!==O&&(g.flags|=8192),O&&(g.mode&1)!==0?(Ha&1073741824)!==0&&(Do(g),g.subtreeFlags&6&&(g.flags|=8192)):Do(g),null;case 24:return null;case 25:return null}throw Error(t(156,g.tag))}function ly(d,g){switch(f2(g),g.tag){case 1:return Sa(g.type)&&D1(),d=g.flags,d&65536?(g.flags=d&-65537|128,g):null;case 3:return Zl(),ts(qo),ts(No),S2(),d=g.flags,(d&65536)!==0&&(d&128)===0?(g.flags=d&-65537|128,g):null;case 5:return N4(g),null;case 13:if(ts(fs),d=g.memoizedState,d!==null&&d.dehydrated!==null){if(g.alternate===null)throw Error(t(340));Ff()}return d=g.flags,d&65536?(g.flags=d&-65537|128,g):null;case 19:return ts(fs),null;case 4:return Zl(),null;case 10:return R4(g.type._context),null;case 22:case 23:return J2(),null;case 24:return null;default:return null}}var tm=!1,Oo=!1,dx=typeof WeakSet=="function"?WeakSet:Set,Kn=null;function Xf(d,g){var M=d.ref;if(M!==null)if(typeof M=="function")try{M(null)}catch(O){Ps(d,g,O)}else M.current=null}function n5(d,g,M){try{M()}catch(O){Ps(d,g,O)}}var z2=!1;function cy(d,g){if(s2=Ua,d=u4(),h4(d)){if("selectionStart"in d)var M={start:d.selectionStart,end:d.selectionEnd};else e:{M=(M=d.ownerDocument)&&M.defaultView||window;var O=M.getSelection&&M.getSelection();if(O&&O.rangeCount!==0){M=O.anchorNode;var q=O.anchorOffset,ee=O.focusNode;O=O.focusOffset;try{M.nodeType,ee.nodeType}catch{M=null;break e}var ge=0,Fe=-1,Xe=-1,Ot=0,on=0,vn=d,an=null;t:for(;;){for(var Wn;vn!==M||q!==0&&vn.nodeType!==3||(Fe=ge+q),vn!==ee||O!==0&&vn.nodeType!==3||(Xe=ge+O),vn.nodeType===3&&(ge+=vn.nodeValue.length),(Wn=vn.firstChild)!==null;)an=vn,vn=Wn;for(;;){if(vn===d)break t;if(an===M&&++Ot===q&&(Fe=ge),an===ee&&++on===O&&(Xe=ge),(Wn=vn.nextSibling)!==null)break;vn=an,an=vn.parentNode}vn=Wn}M=Fe===-1||Xe===-1?null:{start:Fe,end:Xe}}else M=null}M=M||{start:0,end:0}}else M=null;for(o2={focusedElem:d,selectionRange:M},Ua=!1,Kn=g;Kn!==null;)if(g=Kn,d=g.child,(g.subtreeFlags&1028)!==0&&d!==null)d.return=g,Kn=d;else for(;Kn!==null;){g=Kn;try{var $n=g.alternate;if((g.flags&1024)!==0)switch(g.tag){case 0:case 11:case 15:break;case 1:if($n!==null){var Zn=$n.memoizedProps,Hs=$n.memoizedState,xt=g.stateNode,tt=xt.getSnapshotBeforeUpdate(g.elementType===g.type?Zn:ol(g.type,Zn),Hs);xt.__reactInternalSnapshotBeforeUpdate=tt}break;case 3:var At=g.stateNode.containerInfo;At.nodeType===1?At.textContent="":At.nodeType===9&&At.documentElement&&At.removeChild(At.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(En){Ps(g,g.return,En)}if(d=g.sibling,d!==null){d.return=g.return,Kn=d;break}Kn=g.return}return $n=z2,z2=!1,$n}function Yf(d,g,M){var O=g.updateQueue;if(O=O!==null?O.lastEffect:null,O!==null){var q=O=O.next;do{if((q.tag&d)===d){var ee=q.destroy;q.destroy=void 0,ee!==void 0&&n5(g,M,ee)}q=q.next}while(q!==O)}}function ud(d,g){if(g=g.updateQueue,g=g!==null?g.lastEffect:null,g!==null){var M=g=g.next;do{if((M.tag&d)===d){var O=M.create;M.destroy=O()}M=M.next}while(M!==g)}}function r5(d){var g=d.ref;if(g!==null){var M=d.stateNode;switch(d.tag){case 5:d=M;break;default:d=M}typeof g=="function"?g(d):g.current=d}}function i5(d){var g=d.alternate;g!==null&&(d.alternate=null,i5(g)),d.child=null,d.deletions=null,d.sibling=null,d.tag===5&&(g=d.stateNode,g!==null&&(delete g[gi],delete g[Vu],delete g[N1],delete g[b4],delete g[u2])),d.stateNode=null,d.return=null,d.dependencies=null,d.memoizedProps=null,d.memoizedState=null,d.pendingProps=null,d.stateNode=null,d.updateQueue=null}function nm(d){return d.tag===5||d.tag===3||d.tag===4}function s5(d){e:for(;;){for(;d.sibling===null;){if(d.return===null||nm(d.return))return null;d=d.return}for(d.sibling.return=d.return,d=d.sibling;d.tag!==5&&d.tag!==6&&d.tag!==18;){if(d.flags&2||d.child===null||d.tag===4)continue e;d.child.return=d,d=d.child}if(!(d.flags&2))return d.stateNode}}function V2(d,g,M){var O=d.tag;if(O===5||O===6)d=d.stateNode,g?M.nodeType===8?M.parentNode.insertBefore(d,g):M.insertBefore(d,g):(M.nodeType===8?(g=M.parentNode,g.insertBefore(d,M)):(g=M,g.appendChild(d)),M=M._reactRootContainer,M!=null||g.onclick!==null||(g.onclick=I1));else if(O!==4&&(d=d.child,d!==null))for(V2(d,g,M),d=d.sibling;d!==null;)V2(d,g,M),d=d.sibling}function qc(d,g,M){var O=d.tag;if(O===5||O===6)d=d.stateNode,g?M.insertBefore(d,g):M.appendChild(d);else if(O!==4&&(d=d.child,d!==null))for(qc(d,g,M),d=d.sibling;d!==null;)qc(d,g,M),d=d.sibling}var So=null,Ga=!1;function ec(d,g,M){for(M=M.child;M!==null;)G2(d,g,M),M=M.sibling}function G2(d,g,M){if(Yn&&typeof Yn.onCommitFiberUnmount=="function")try{Yn.onCommitFiberUnmount(yr,M)}catch{}switch(M.tag){case 5:Oo||Xf(M,g);case 6:var O=So,q=Ga;So=null,ec(d,g,M),So=O,Ga=q,So!==null&&(Ga?(d=So,M=M.stateNode,d.nodeType===8?d.parentNode.removeChild(M):d.removeChild(M)):So.removeChild(M.stateNode));break;case 18:So!==null&&(Ga?(d=So,M=M.stateNode,d.nodeType===8?Of(d.parentNode,M):d.nodeType===1&&Of(d,M),Uh(d)):Of(So,M.stateNode));break;case 4:O=So,q=Ga,So=M.stateNode.containerInfo,Ga=!0,ec(d,g,M),So=O,Ga=q;break;case 0:case 11:case 14:case 15:if(!Oo&&(O=M.updateQueue,O!==null&&(O=O.lastEffect,O!==null))){q=O=O.next;do{var ee=q,ge=ee.destroy;ee=ee.tag,ge!==void 0&&((ee&2)!==0||(ee&4)!==0)&&n5(M,g,ge),q=q.next}while(q!==O)}ec(d,g,M);break;case 1:if(!Oo&&(Xf(M,g),O=M.stateNode,typeof O.componentWillUnmount=="function"))try{O.props=M.memoizedProps,O.state=M.memoizedState,O.componentWillUnmount()}catch(Fe){Ps(M,g,Fe)}ec(d,g,M);break;case 21:ec(d,g,M);break;case 22:M.mode&1?(Oo=(O=Oo)||M.memoizedState!==null,ec(d,g,M),Oo=O):ec(d,g,M);break;default:ec(d,g,M)}}function j2(d){var g=d.updateQueue;if(g!==null){d.updateQueue=null;var M=d.stateNode;M===null&&(M=d.stateNode=new dx),g.forEach(function(O){var q=Jf.bind(null,d,O);M.has(O)||(M.add(O),O.then(q,q))})}}function ja(d,g){var M=g.deletions;if(M!==null)for(var O=0;O<M.length;O++){var q=M[O];try{var ee=d,ge=g,Fe=ge;e:for(;Fe!==null;){switch(Fe.tag){case 5:So=Fe.stateNode,Ga=!1;break e;case 3:So=Fe.stateNode.containerInfo,Ga=!0;break e;case 4:So=Fe.stateNode.containerInfo,Ga=!0;break e}Fe=Fe.return}if(So===null)throw Error(t(160));G2(ee,ge,q),So=null,Ga=!1;var Xe=q.alternate;Xe!==null&&(Xe.return=null),q.return=null}catch(Ot){Ps(q,g,Ot)}}if(g.subtreeFlags&12854)for(g=g.child;g!==null;)rm(g,d),g=g.sibling}function rm(d,g){var M=d.alternate,O=d.flags;switch(d.tag){case 0:case 11:case 14:case 15:if(ja(g,d),al(d),O&4){try{Yf(3,d,d.return),ud(3,d)}catch(Zn){Ps(d,d.return,Zn)}try{Yf(5,d,d.return)}catch(Zn){Ps(d,d.return,Zn)}}break;case 1:ja(g,d),al(d),O&512&&M!==null&&Xf(M,M.return);break;case 5:if(ja(g,d),al(d),O&512&&M!==null&&Xf(M,M.return),d.flags&32){var q=d.stateNode;try{An(q,"")}catch(Zn){Ps(d,d.return,Zn)}}if(O&4&&(q=d.stateNode,q!=null)){var ee=d.memoizedProps,ge=M!==null?M.memoizedProps:ee,Fe=d.type,Xe=d.updateQueue;if(d.updateQueue=null,Xe!==null)try{Fe==="input"&&ee.type==="radio"&&ee.name!=null&&li(q,ee),Pn(Fe,ge);var Ot=Pn(Fe,ee);for(ge=0;ge<Xe.length;ge+=2){var on=Xe[ge],vn=Xe[ge+1];on==="style"?jn(q,vn):on==="dangerouslySetInnerHTML"?or(q,vn):on==="children"?An(q,vn):Z(q,on,vn,Ot)}switch(Fe){case"input":Ti(q,ee);break;case"textarea":_e(q,ee);break;case"select":var an=q._wrapperState.wasMultiple;q._wrapperState.wasMultiple=!!ee.multiple;var Wn=ee.value;Wn!=null?dr(q,!!ee.multiple,Wn,!1):an!==!!ee.multiple&&(ee.defaultValue!=null?dr(q,!!ee.multiple,ee.defaultValue,!0):dr(q,!!ee.multiple,ee.multiple?[]:"",!1))}q[Vu]=ee}catch(Zn){Ps(d,d.return,Zn)}}break;case 6:if(ja(g,d),al(d),O&4){if(d.stateNode===null)throw Error(t(162));q=d.stateNode,ee=d.memoizedProps;try{q.nodeValue=ee}catch(Zn){Ps(d,d.return,Zn)}}break;case 3:if(ja(g,d),al(d),O&4&&M!==null&&M.memoizedState.isDehydrated)try{Uh(g.containerInfo)}catch(Zn){Ps(d,d.return,Zn)}break;case 4:ja(g,d),al(d);break;case 13:ja(g,d),al(d),q=d.child,q.flags&8192&&(ee=q.memoizedState!==null,q.stateNode.isHidden=ee,!ee||q.alternate!==null&&q.alternate.memoizedState!==null||(u5=bt())),O&4&&j2(d);break;case 22:if(on=M!==null&&M.memoizedState!==null,d.mode&1?(Oo=(Ot=Oo)||on,ja(g,d),Oo=Ot):ja(g,d),al(d),O&8192){if(Ot=d.memoizedState!==null,(d.stateNode.isHidden=Ot)&&!on&&(d.mode&1)!==0)for(Kn=d,on=d.child;on!==null;){for(vn=Kn=on;Kn!==null;){switch(an=Kn,Wn=an.child,an.tag){case 0:case 11:case 14:case 15:Yf(4,an,an.return);break;case 1:Xf(an,an.return);var $n=an.stateNode;if(typeof $n.componentWillUnmount=="function"){O=an,M=an.return;try{g=O,$n.props=g.memoizedProps,$n.state=g.memoizedState,$n.componentWillUnmount()}catch(Zn){Ps(O,M,Zn)}}break;case 5:Xf(an,an.return);break;case 22:if(an.memoizedState!==null){l5(vn);continue}}Wn!==null?(Wn.return=an,Kn=Wn):l5(vn)}on=on.sibling}e:for(on=null,vn=d;;){if(vn.tag===5){if(on===null){on=vn;try{q=vn.stateNode,Ot?(ee=q.style,typeof ee.setProperty=="function"?ee.setProperty("display","none","important"):ee.display="none"):(Fe=vn.stateNode,Xe=vn.memoizedProps.style,ge=Xe!=null&&Xe.hasOwnProperty("display")?Xe.display:null,Fe.style.display=Qt("display",ge))}catch(Zn){Ps(d,d.return,Zn)}}}else if(vn.tag===6){if(on===null)try{vn.stateNode.nodeValue=Ot?"":vn.memoizedProps}catch(Zn){Ps(d,d.return,Zn)}}else if((vn.tag!==22&&vn.tag!==23||vn.memoizedState===null||vn===d)&&vn.child!==null){vn.child.return=vn,vn=vn.child;continue}if(vn===d)break e;for(;vn.sibling===null;){if(vn.return===null||vn.return===d)break e;on===vn&&(on=null),vn=vn.return}on===vn&&(on=null),vn.sibling.return=vn.return,vn=vn.sibling}}break;case 19:ja(g,d),al(d),O&4&&j2(d);break;case 21:break;default:ja(g,d),al(d)}}function al(d){var g=d.flags;if(g&2){try{e:{for(var M=d.return;M!==null;){if(nm(M)){var O=M;break e}M=M.return}throw Error(t(160))}switch(O.tag){case 5:var q=O.stateNode;O.flags&32&&(An(q,""),O.flags&=-33);var ee=s5(d);qc(d,ee,q);break;case 3:case 4:var ge=O.stateNode.containerInfo,Fe=s5(d);V2(d,Fe,ge);break;default:throw Error(t(161))}}catch(Xe){Ps(d,d.return,Xe)}d.flags&=-3}g&4096&&(d.flags&=-4097)}function uy(d,g,M){Kn=d,o5(d)}function o5(d,g,M){for(var O=(d.mode&1)!==0;Kn!==null;){var q=Kn,ee=q.child;if(q.tag===22&&O){var ge=q.memoizedState!==null||tm;if(!ge){var Fe=q.alternate,Xe=Fe!==null&&Fe.memoizedState!==null||Oo;Fe=tm;var Ot=Oo;if(tm=ge,(Oo=Xe)&&!Ot)for(Kn=q;Kn!==null;)ge=Kn,Xe=ge.child,ge.tag===22&&ge.memoizedState!==null?Xc(q):Xe!==null?(Xe.return=ge,Kn=Xe):Xc(q);for(;ee!==null;)Kn=ee,o5(ee),ee=ee.sibling;Kn=q,tm=Fe,Oo=Ot}a5(d)}else(q.subtreeFlags&8772)!==0&&ee!==null?(ee.return=q,Kn=ee):a5(d)}}function a5(d){for(;Kn!==null;){var g=Kn;if((g.flags&8772)!==0){var M=g.alternate;try{if((g.flags&8772)!==0)switch(g.tag){case 0:case 11:case 15:Oo||ud(5,g);break;case 1:var O=g.stateNode;if(g.flags&4&&!Oo)if(M===null)O.componentDidMount();else{var q=g.elementType===g.type?M.memoizedProps:ol(g.type,M.memoizedProps);O.componentDidUpdate(q,M.memoizedState,O.__reactInternalSnapshotBeforeUpdate)}var ee=g.updateQueue;ee!==null&&G6(g,ee,O);break;case 3:var ge=g.updateQueue;if(ge!==null){if(M=null,g.child!==null)switch(g.child.tag){case 5:M=g.child.stateNode;break;case 1:M=g.child.stateNode}G6(g,ge,M)}break;case 5:var Fe=g.stateNode;if(M===null&&g.flags&4){M=Fe;var Xe=g.memoizedProps;switch(g.type){case"button":case"input":case"select":case"textarea":Xe.autoFocus&&M.focus();break;case"img":Xe.src&&(M.src=Xe.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(g.memoizedState===null){var Ot=g.alternate;if(Ot!==null){var on=Ot.memoizedState;if(on!==null){var vn=on.dehydrated;vn!==null&&Uh(vn)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Oo||g.flags&512&&r5(g)}catch(an){Ps(g,g.return,an)}}if(g===d){Kn=null;break}if(M=g.sibling,M!==null){M.return=g.return,Kn=M;break}Kn=g.return}}function l5(d){for(;Kn!==null;){var g=Kn;if(g===d){Kn=null;break}var M=g.sibling;if(M!==null){M.return=g.return,Kn=M;break}Kn=g.return}}function Xc(d){for(;Kn!==null;){var g=Kn;try{switch(g.tag){case 0:case 11:case 15:var M=g.return;try{ud(4,g)}catch(Xe){Ps(g,M,Xe)}break;case 1:var O=g.stateNode;if(typeof O.componentDidMount=="function"){var q=g.return;try{O.componentDidMount()}catch(Xe){Ps(g,q,Xe)}}var ee=g.return;try{r5(g)}catch(Xe){Ps(g,ee,Xe)}break;case 5:var ge=g.return;try{r5(g)}catch(Xe){Ps(g,ge,Xe)}}}catch(Xe){Ps(g,g.return,Xe)}if(g===d){Kn=null;break}var Fe=g.sibling;if(Fe!==null){Fe.return=g.return,Kn=Fe;break}Kn=g.return}}var c5=Math.ceil,H2=k.ReactCurrentDispatcher,W2=k.ReactCurrentOwner,Ca=k.ReactCurrentBatchConfig,Mi=0,wo=null,js=null,Eo=0,Ha=0,Kf=Lc(0),Br=0,Qu=null,tc=0,Zf=0,$2=0,im=null,la=null,u5=0,Qf=1/0,ll=null,sm=!1,h5=null,b0=null,om=!1,nc=null,am=0,lm=0,q2=null,X2=-1,Y2=0;function To(){return(Mi&6)!==0?bt():X2!==-1?X2:X2=bt()}function cl(d){return(d.mode&1)===0?1:(Mi&2)!==0&&Eo!==0?Eo&-Eo:P4.transition!==null?(Y2===0&&(Y2=Ni()),Y2):(d=hi,d!==0||(d=window.event,d=d===void 0?16:d1(d.type)),d)}function ul(d,g,M,O){if(50<lm)throw lm=0,q2=null,Error(t(185));As(d,M,O),((Mi&2)===0||d!==wo)&&(d===wo&&((Mi&2)===0&&(Zf|=M),Br===4&&Yc(d,Eo)),ca(d,O),M===1&&Mi===0&&(g.mode&1)===0&&(Qf=bt()+500,ql&&nl()))}function ca(d,g){var M=d.callbackNode;ko(d,g);var O=Cs(d,d===wo?Eo:0);if(O===0)M!==null&&we(M),d.callbackNode=null,d.callbackPriority=0;else if(g=O&-O,d.callbackPriority!==g){if(M!=null&&we(M),g===1)d.tag===0?B6(f5.bind(null,d)):T4(f5.bind(null,d)),lx(function(){(Mi&6)===0&&nl()}),M=null;else{switch(eo(O)){case 1:M=yn;break;case 4:M=On;break;case 16:M=Un;break;case 536870912:M=lr;break;default:M=Un}M=r9(M,d5.bind(null,d))}d.callbackPriority=g,d.callbackNode=M}}function d5(d,g){if(X2=-1,Y2=0,(Mi&6)!==0)throw Error(t(327));var M=d.callbackNode;if(dd()&&d.callbackNode!==M)return null;var O=Cs(d,d===wo?Eo:0);if(O===0)return null;if((O&30)!==0||(O&d.expiredLanes)!==0||g)g=hd(d,O);else{g=O;var q=Mi;Mi|=2;var ee=m5();(wo!==d||Eo!==g)&&(ll=null,Qf=bt()+500,eh(d,g));do try{fy();break}catch(Fe){p5(d,Fe)}while(!0);_2(),H2.current=ee,Mi=q,js!==null?g=0:(wo=null,Eo=0,g=Br)}if(g!==0){if(g===2&&(q=d0(d),q!==0&&(O=q,g=K2(d,q))),g===1)throw M=Qu,eh(d,0),Yc(d,O),ca(d,bt()),M;if(g===6)Yc(d,O);else{if(q=d.current.alternate,(O&30)===0&&!hy(q)&&(g=hd(d,O),g===2&&(ee=d0(d),ee!==0&&(O=ee,g=K2(d,ee))),g===1))throw M=Qu,eh(d,0),Yc(d,O),ca(d,bt()),M;switch(d.finishedWork=q,d.finishedLanes=O,g){case 0:case 1:throw Error(t(345));case 2:th(d,la,ll);break;case 3:if(Yc(d,O),(O&130023424)===O&&(g=u5+500-bt(),10<g)){if(Cs(d,0)!==0)break;if(q=d.suspendedLanes,(q&O)!==O){To(),d.pingedLanes|=d.suspendedLanes&q;break}d.timeoutHandle=l2(th.bind(null,d,la,ll),g);break}th(d,la,ll);break;case 4:if(Yc(d,O),(O&4194240)===O)break;for(g=d.eventTimes,q=-1;0<O;){var ge=31-Lr(O);ee=1<<ge,ge=g[ge],ge>q&&(q=ge),O&=~ee}if(O=q,O=bt()-O,O=(120>O?120:480>O?480:1080>O?1080:1920>O?1920:3e3>O?3e3:4320>O?4320:1960*c5(O/1960))-O,10<O){d.timeoutHandle=l2(th.bind(null,d,la,ll),O);break}th(d,la,ll);break;case 5:th(d,la,ll);break;default:throw Error(t(329))}}}return ca(d,bt()),d.callbackNode===M?d5.bind(null,d):null}function K2(d,g){var M=im;return d.current.memoizedState.isDehydrated&&(eh(d,g).flags|=256),d=hd(d,g),d!==2&&(g=la,la=M,g!==null&&Z2(g)),d}function Z2(d){la===null?la=d:la.push.apply(la,d)}function hy(d){for(var g=d;;){if(g.flags&16384){var M=g.updateQueue;if(M!==null&&(M=M.stores,M!==null))for(var O=0;O<M.length;O++){var q=M[O],ee=q.getSnapshot;q=q.value;try{if(!Io(ee(),q))return!1}catch{return!1}}}if(M=g.child,g.subtreeFlags&16384&&M!==null)M.return=g,g=M;else{if(g===d)break;for(;g.sibling===null;){if(g.return===null||g.return===d)return!0;g=g.return}g.sibling.return=g.return,g=g.sibling}}return!0}function Yc(d,g){for(g&=~$2,g&=~Zf,d.suspendedLanes|=g,d.pingedLanes&=~g,d=d.expirationTimes;0<g;){var M=31-Lr(g),O=1<<M;d[M]=-1,g&=~O}}function f5(d){if((Mi&6)!==0)throw Error(t(327));dd();var g=Cs(d,0);if((g&1)===0)return ca(d,bt()),null;var M=hd(d,g);if(d.tag!==0&&M===2){var O=d0(d);O!==0&&(g=O,M=K2(d,O))}if(M===1)throw M=Qu,eh(d,0),Yc(d,g),ca(d,bt()),M;if(M===6)throw Error(t(345));return d.finishedWork=d.current.alternate,d.finishedLanes=g,th(d,la,ll),ca(d,bt()),null}function Q2(d,g){var M=Mi;Mi|=1;try{return d(g)}finally{Mi=M,Mi===0&&(Qf=bt()+500,ql&&nl())}}function Ju(d){nc!==null&&nc.tag===0&&(Mi&6)===0&&dd();var g=Mi;Mi|=1;var M=Ca.transition,O=hi;try{if(Ca.transition=null,hi=1,d)return d()}finally{hi=O,Ca.transition=M,Mi=g,(Mi&6)===0&&nl()}}function J2(){Ha=Kf.current,ts(Kf)}function eh(d,g){d.finishedWork=null,d.finishedLanes=0;var M=d.timeoutHandle;if(M!==-1&&(d.timeoutHandle=-1,es(M)),js!==null)for(M=js.return;M!==null;){var O=M;switch(f2(O),O.tag){case 1:O=O.type.childContextTypes,O!=null&&D1();break;case 3:Zl(),ts(qo),ts(No),S2();break;case 5:N4(O);break;case 4:Zl();break;case 13:ts(fs);break;case 19:ts(fs);break;case 10:R4(O.type._context);break;case 22:case 23:J2()}M=M.return}if(wo=d,js=d=rc(d.current,null),Eo=Ha=g,Br=0,Qu=null,$2=Zf=tc=0,la=im=null,$u!==null){for(g=0;g<$u.length;g++)if(M=$u[g],O=M.interleaved,O!==null){M.interleaved=null;var q=O.next,ee=M.pending;if(ee!==null){var ge=ee.next;ee.next=q,O.next=ge}M.pending=O}$u=null}return d}function p5(d,g){do{var M=js;try{if(_2(),w2.current=Y1,E2){for(var O=Gi.memoizedState;O!==null;){var q=O.queue;q!==null&&(q.pending=null),O=O.next}E2=!1}if(Xu=0,lo=bs=Gi=null,Ql=!1,Gc=0,W2.current=null,M===null||M.return===null){Br=1,Qu=g,js=null;break}e:{var ee=d,ge=M.return,Fe=M,Xe=g;if(g=Eo,Fe.flags|=32768,Xe!==null&&typeof Xe=="object"&&typeof Xe.then=="function"){var Ot=Xe,on=Fe,vn=on.tag;if((on.mode&1)===0&&(vn===0||vn===11||vn===15)){var an=on.alternate;an?(on.updateQueue=an.updateQueue,on.memoizedState=an.memoizedState,on.lanes=an.lanes):(on.updateQueue=null,on.memoizedState=null)}var Wn=K6(ge);if(Wn!==null){Wn.flags&=-257,q4(Wn,ge,Fe,ee,g),Wn.mode&1&&Y6(ee,Ot,g),g=Wn,Xe=Ot;var $n=g.updateQueue;if($n===null){var Zn=new Set;Zn.add(Xe),g.updateQueue=Zn}else $n.add(Xe);break e}else{if((g&1)===0){Y6(ee,Ot,g),cm();break e}Xe=Error(t(426))}}else if(ds&&Fe.mode&1){var Hs=K6(ge);if(Hs!==null){(Hs.flags&65536)===0&&(Hs.flags|=256),q4(Hs,ge,Fe,ee,g),Wu(Wc(Xe,Fe));break e}}ee=Xe=Wc(Xe,Fe),Br!==4&&(Br=2),im===null?im=[ee]:im.push(ee),ee=ge;do{switch(ee.tag){case 3:ee.flags|=65536,g&=-g,ee.lanes|=g;var xt=$4(ee,Xe,g);od(ee,xt);break e;case 1:Fe=Xe;var tt=ee.type,At=ee.stateNode;if((ee.flags&128)===0&&(typeof tt.getDerivedStateFromError=="function"||At!==null&&typeof At.componentDidCatch=="function"&&(b0===null||!b0.has(At)))){ee.flags|=65536,g&=-g,ee.lanes|=g;var En=Q1(ee,Fe,g);od(ee,En);break e}}ee=ee.return}while(ee!==null)}g5(M)}catch(cr){g=cr,js===M&&M!==null&&(js=M=M.return);continue}break}while(!0)}function m5(){var d=H2.current;return H2.current=Y1,d===null?Y1:d}function cm(){(Br===0||Br===3||Br===2)&&(Br=4),wo===null||(tc&268435455)===0&&(Zf&268435455)===0||Yc(wo,Eo)}function hd(d,g){var M=Mi;Mi|=2;var O=m5();(wo!==d||Eo!==g)&&(ll=null,eh(d,g));do try{dy();break}catch(q){p5(d,q)}while(!0);if(_2(),Mi=M,H2.current=O,js!==null)throw Error(t(261));return wo=null,Eo=0,Br}function dy(){for(;js!==null;)e9(js)}function fy(){for(;js!==null&&!st();)e9(js)}function e9(d){var g=ep(d.alternate,d,Ha);d.memoizedProps=d.pendingProps,g===null?g5(d):js=g,W2.current=null}function g5(d){var g=d;do{var M=g.alternate;if(d=g.return,(g.flags&32768)===0){if(M=t5(M,g,Ha),M!==null){js=M;return}}else{if(M=ly(M,g),M!==null){M.flags&=32767,js=M;return}if(d!==null)d.flags|=32768,d.subtreeFlags=0,d.deletions=null;else{Br=6,js=null;return}}if(g=g.sibling,g!==null){js=g;return}js=g=d}while(g!==null);Br===0&&(Br=5)}function th(d,g,M){var O=hi,q=Ca.transition;try{Ca.transition=null,hi=1,py(d,g,M,O)}finally{Ca.transition=q,hi=O}return null}function py(d,g,M,O){do dd();while(nc!==null);if((Mi&6)!==0)throw Error(t(327));M=d.finishedWork;var q=d.finishedLanes;if(M===null)return null;if(d.finishedWork=null,d.finishedLanes=0,M===d.current)throw Error(t(177));d.callbackNode=null,d.callbackPriority=0;var ee=M.lanes|M.childLanes;if(zs(d,ee),d===wo&&(js=wo=null,Eo=0),(M.subtreeFlags&2064)===0&&(M.flags&2064)===0||om||(om=!0,r9(Un,function(){return dd(),null})),ee=(M.flags&15990)!==0,(M.subtreeFlags&15990)!==0||ee){ee=Ca.transition,Ca.transition=null;var ge=hi;hi=1;var Fe=Mi;Mi|=4,W2.current=null,cy(d,M),rm(M,d),ox(o2),Ua=!!s2,o2=s2=null,d.current=M,uy(M),Pt(),Mi=Fe,hi=ge,Ca.transition=ee}else d.current=M;if(om&&(om=!1,nc=d,am=q),ee=d.pendingLanes,ee===0&&(b0=null),Fr(M.stateNode),ca(d,bt()),g!==null)for(O=d.onRecoverableError,M=0;M<g.length;M++)q=g[M],O(q.value,{componentStack:q.stack,digest:q.digest});if(sm)throw sm=!1,d=h5,h5=null,d;return(am&1)!==0&&d.tag!==0&&dd(),ee=d.pendingLanes,(ee&1)!==0?d===q2?lm++:(lm=0,q2=d):lm=0,nl(),null}function dd(){if(nc!==null){var d=eo(am),g=Ca.transition,M=hi;try{if(Ca.transition=null,hi=16>d?16:d,nc===null)var O=!1;else{if(d=nc,nc=null,am=0,(Mi&6)!==0)throw Error(t(331));var q=Mi;for(Mi|=4,Kn=d.current;Kn!==null;){var ee=Kn,ge=ee.child;if((Kn.flags&16)!==0){var Fe=ee.deletions;if(Fe!==null){for(var Xe=0;Xe<Fe.length;Xe++){var Ot=Fe[Xe];for(Kn=Ot;Kn!==null;){var on=Kn;switch(on.tag){case 0:case 11:case 15:Yf(8,on,ee)}var vn=on.child;if(vn!==null)vn.return=on,Kn=vn;else for(;Kn!==null;){on=Kn;var an=on.sibling,Wn=on.return;if(i5(on),on===Ot){Kn=null;break}if(an!==null){an.return=Wn,Kn=an;break}Kn=Wn}}}var $n=ee.alternate;if($n!==null){var Zn=$n.child;if(Zn!==null){$n.child=null;do{var Hs=Zn.sibling;Zn.sibling=null,Zn=Hs}while(Zn!==null)}}Kn=ee}}if((ee.subtreeFlags&2064)!==0&&ge!==null)ge.return=ee,Kn=ge;else e:for(;Kn!==null;){if(ee=Kn,(ee.flags&2048)!==0)switch(ee.tag){case 0:case 11:case 15:Yf(9,ee,ee.return)}var xt=ee.sibling;if(xt!==null){xt.return=ee.return,Kn=xt;break e}Kn=ee.return}}var tt=d.current;for(Kn=tt;Kn!==null;){ge=Kn;var At=ge.child;if((ge.subtreeFlags&2064)!==0&&At!==null)At.return=ge,Kn=At;else e:for(ge=tt;Kn!==null;){if(Fe=Kn,(Fe.flags&2048)!==0)try{switch(Fe.tag){case 0:case 11:case 15:ud(9,Fe)}}catch(cr){Ps(Fe,Fe.return,cr)}if(Fe===ge){Kn=null;break e}var En=Fe.sibling;if(En!==null){En.return=Fe.return,Kn=En;break e}Kn=Fe.return}}if(Mi=q,nl(),Yn&&typeof Yn.onPostCommitFiberRoot=="function")try{Yn.onPostCommitFiberRoot(yr,d)}catch{}O=!0}return O}finally{hi=M,Ca.transition=g}}return!1}function my(d,g,M){g=Wc(M,g),g=$4(d,g,1),d=sl(d,g,1),g=To(),d!==null&&(As(d,1,g),ca(d,g))}function Ps(d,g,M){if(d.tag===3)my(d,d,M);else for(;g!==null;){if(g.tag===3){my(g,d,M);break}else if(g.tag===1){var O=g.stateNode;if(typeof g.type.getDerivedStateFromError=="function"||typeof O.componentDidCatch=="function"&&(b0===null||!b0.has(O))){d=Wc(M,d),d=Q1(g,d,1),g=sl(g,d,1),d=To(),g!==null&&(As(g,1,d),ca(g,d));break}}g=g.return}}function gy(d,g,M){var O=d.pingCache;O!==null&&O.delete(g),g=To(),d.pingedLanes|=d.suspendedLanes&M,wo===d&&(Eo&M)===M&&(Br===4||Br===3&&(Eo&130023424)===Eo&&500>bt()-u5?eh(d,0):$2|=M),ca(d,g)}function t9(d,g){g===0&&((d.mode&1)===0?g=1:(g=Yi,Yi<<=1,(Yi&130023424)===0&&(Yi=4194304)));var M=To();d=Vc(d,g),d!==null&&(As(d,g,M),ca(d,M))}function n9(d){var g=d.memoizedState,M=0;g!==null&&(M=g.retryLane),t9(d,M)}function Jf(d,g){var M=0;switch(d.tag){case 13:var O=d.stateNode,q=d.memoizedState;q!==null&&(M=q.retryLane);break;case 19:O=d.stateNode;break;default:throw Error(t(314))}O!==null&&O.delete(g),t9(d,M)}var ep;ep=function(d,g,M){if(d!==null)if(d.memoizedProps!==g.pendingProps||qo.current)Ma=!0;else{if((d.lanes&M)===0&&(g.flags&128)===0)return Ma=!1,sy(d,g,M);Ma=(d.flags&131072)!==0}else Ma=!1,ds&&(g.flags&1048576)!==0&&U6(g,Uc,g.index);switch(g.lanes=0,g.tag){case 2:var O=g.type;em(d,g),d=g.pendingProps;var q=Qh(g,No.current);zc(g,M),q=Vf(null,g,O,d,q,M);var ee=H1();return g.flags|=1,typeof q=="object"&&q!==null&&typeof q.render=="function"&&q.$$typeof===void 0?(g.tag=1,g.memoizedState=null,g.updateQueue=null,Sa(O)?(ee=!0,d2(g)):ee=!1,g.memoizedState=q.state!==null&&q.state!==void 0?q.state:null,x2(g),q.updater=K1,g.stateNode=q,q._reactInternals=g,F2(g,O,d,M),g=Y4(null,g,O,!0,ee,M)):(g.tag=0,ds&&ee&&O1(g),ii(null,g,q,M),g=g.child),g;case 16:O=g.elementType;e:{switch(em(d,g),d=g.pendingProps,q=O._init,O=q(O._payload),g.type=O,q=g.tag=s9(O),d=ol(O,d),q){case 0:g=B2(null,g,O,d,M);break e;case 1:g=ey(null,g,O,d,M);break e;case 11:g=Wf(null,g,O,d,M);break e;case 14:g=Z6(null,g,O,ol(O.type,d),M);break e}throw Error(t(306,O,""))}return g;case 0:return O=g.type,q=g.pendingProps,q=g.elementType===O?q:ol(O,q),B2(d,g,O,q,M);case 1:return O=g.type,q=g.pendingProps,q=g.elementType===O?q:ol(O,q),ey(d,g,O,q,M);case 3:e:{if(K4(g),d===null)throw Error(t(387));O=g.pendingProps,ee=g.memoizedState,q=ee.element,sd(d,g),Bf(g,O,null,M);var ge=g.memoizedState;if(O=ge.element,ee.isDehydrated)if(ee={element:O,isDehydrated:!1,cache:ge.cache,pendingSuspenseBoundaries:ge.pendingSuspenseBoundaries,transitions:ge.transitions},g.updateQueue.baseState=ee,g.memoizedState=ee,g.flags&256){q=Wc(Error(t(423)),g),g=ty(d,g,O,M,q);break e}else if(O!==q){q=Wc(Error(t(424)),g),g=ty(d,g,O,M,q);break e}else for(Ta=Hl(g.stateNode.containerInfo.firstChild),Ea=g,ds=!0,il=null,M=nd(g,null,O,M),g.child=M;M;)M.flags=M.flags&-3|4096,M=M.sibling;else{if(Ff(),O===q){g=$c(d,g,M);break e}ii(d,g,O,M)}g=g.child}return g;case 5:return j1(g),d===null&&C4(g),O=g.type,q=g.pendingProps,ee=d!==null?d.memoizedProps:null,ge=q.children,a2(O,q)?ge=null:ee!==null&&a2(O,ee)&&(g.flags|=32),J6(d,g),ii(d,g,ge,M),g.child;case 6:return d===null&&C4(g),null;case 13:return ny(d,g,M);case 4:return I4(g,g.stateNode.containerInfo),O=g.pendingProps,d===null?g.child=Lf(g,null,O,M):ii(d,g,O,M),g.child;case 11:return O=g.type,q=g.pendingProps,q=g.elementType===O?q:ol(O,q),Wf(d,g,O,q,M);case 7:return ii(d,g,g.pendingProps,M),g.child;case 8:return ii(d,g,g.pendingProps.children,M),g.child;case 12:return ii(d,g,g.pendingProps.children,M),g.child;case 10:e:{if(O=g.type._context,q=g.pendingProps,ee=g.memoizedProps,ge=q.value,ns(rd,O._currentValue),O._currentValue=ge,ee!==null)if(Io(ee.value,ge)){if(ee.children===q.children&&!qo.current){g=$c(d,g,M);break e}}else for(ee=g.child,ee!==null&&(ee.return=g);ee!==null;){var Fe=ee.dependencies;if(Fe!==null){ge=ee.child;for(var Xe=Fe.firstContext;Xe!==null;){if(Xe.context===O){if(ee.tag===1){Xe=za(-1,M&-M),Xe.tag=2;var Ot=ee.updateQueue;if(Ot!==null){Ot=Ot.shared;var on=Ot.pending;on===null?Xe.next=Xe:(Xe.next=on.next,on.next=Xe),Ot.pending=Xe}}ee.lanes|=M,Xe=ee.alternate,Xe!==null&&(Xe.lanes|=M),U1(ee.return,M,g),Fe.lanes|=M;break}Xe=Xe.next}}else if(ee.tag===10)ge=ee.type===g.type?null:ee.child;else if(ee.tag===18){if(ge=ee.return,ge===null)throw Error(t(341));ge.lanes|=M,Fe=ge.alternate,Fe!==null&&(Fe.lanes|=M),U1(ge,M,g),ge=ee.sibling}else ge=ee.child;if(ge!==null)ge.return=ee;else for(ge=ee;ge!==null;){if(ge===g){ge=null;break}if(ee=ge.sibling,ee!==null){ee.return=ge.return,ge=ee;break}ge=ge.return}ee=ge}ii(d,g,q.children,M),g=g.child}return g;case 9:return q=g.type,O=g.pendingProps.children,zc(g,M),q=x0(q),O=O(q),g.flags|=1,ii(d,g,O,M),g.child;case 14:return O=g.type,q=ol(O,g.pendingProps),q=ol(O.type,q),Z6(d,g,O,q,M);case 15:return X4(d,g,g.type,g.pendingProps,M);case 17:return O=g.type,q=g.pendingProps,q=g.elementType===O?q:ol(O,q),em(d,g),g.tag=1,Sa(O)?(d=!0,d2(g)):d=!1,zc(g,M),Ku(g,O,q),F2(g,O,q,M),Y4(null,g,O,!0,d,M);case 19:return $f(d,g,M);case 22:return Q6(d,g,M)}throw Error(t(156,g.tag))};function r9(d,g){return Sf(d,g)}function y5(d,g,M,O){this.tag=d,this.key=M,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=g,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=O,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function S0(d,g,M,O){return new y5(d,g,M,O)}function i9(d){return d=d.prototype,!(!d||!d.isReactComponent)}function s9(d){if(typeof d=="function")return i9(d)?1:0;if(d!=null){if(d=d.$$typeof,d===Ue)return 11;if(d===at)return 14}return 2}function rc(d,g){var M=d.alternate;return M===null?(M=S0(d.tag,g,d.key,d.mode),M.elementType=d.elementType,M.type=d.type,M.stateNode=d.stateNode,M.alternate=d,d.alternate=M):(M.pendingProps=g,M.type=d.type,M.flags=0,M.subtreeFlags=0,M.deletions=null),M.flags=d.flags&14680064,M.childLanes=d.childLanes,M.lanes=d.lanes,M.child=d.child,M.memoizedProps=d.memoizedProps,M.memoizedState=d.memoizedState,M.updateQueue=d.updateQueue,g=d.dependencies,M.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext},M.sibling=d.sibling,M.index=d.index,M.ref=d.ref,M}function o9(d,g,M,O,q,ee){var ge=2;if(O=d,typeof d=="function")i9(d)&&(ge=1);else if(typeof d=="string")ge=5;else e:switch(d){case ce:return nh(M.children,q,ee,g);case Q:ge=8,q|=8;break;case ae:return d=S0(12,M,g,q|2),d.elementType=ae,d.lanes=ee,d;case je:return d=S0(13,M,g,q),d.elementType=je,d.lanes=ee,d;case rt:return d=S0(19,M,g,q),d.elementType=rt,d.lanes=ee,d;case gt:return um(M,q,ee,g);default:if(typeof d=="object"&&d!==null)switch(d.$$typeof){case le:ge=10;break e;case J:ge=9;break e;case Ue:ge=11;break e;case at:ge=14;break e;case Se:ge=16,O=null;break e}throw Error(t(130,d==null?d:typeof d,""))}return g=S0(ge,M,g,q),g.elementType=d,g.type=O,g.lanes=ee,g}function nh(d,g,M,O){return d=S0(7,d,O,g),d.lanes=M,d}function um(d,g,M,O){return d=S0(22,d,O,g),d.elementType=gt,d.lanes=M,d.stateNode={isHidden:!1},d}function a9(d,g,M){return d=S0(6,d,null,g),d.lanes=M,d}function v5(d,g,M){return g=S0(4,d.children!==null?d.children:[],d.key,g),g.lanes=M,g.stateNode={containerInfo:d.containerInfo,pendingChildren:null,implementation:d.implementation},g}function yy(d,g,M,O,q){this.tag=g,this.containerInfo=d,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=hs(0),this.expirationTimes=hs(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=hs(0),this.identifierPrefix=O,this.onRecoverableError=q,this.mutableSourceEagerHydrationData=null}function hm(d,g,M,O,q,ee,ge,Fe,Xe){return d=new yy(d,g,M,Fe,Xe),g===1?(g=1,ee===!0&&(g|=8)):g=0,ee=S0(3,null,null,g),d.current=ee,ee.stateNode=d,ee.memoizedState={element:O,isDehydrated:M,cache:null,transitions:null,pendingSuspenseBoundaries:null},x2(ee),d}function vy(d,g,M){var O=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ue,key:O==null?null:""+O,children:d,containerInfo:g,implementation:M}}function _y(d){if(!d)return $l;d=d._reactInternals;e:{if(oo(d)!==d||d.tag!==1)throw Error(t(170));var g=d;do{switch(g.tag){case 3:g=g.stateNode.context;break e;case 1:if(Sa(g.type)){g=g.stateNode.__reactInternalMemoizedMergedChildContext;break e}}g=g.return}while(g!==null);throw Error(t(171))}if(d.tag===1){var M=d.type;if(Sa(M))return w4(d,M,g)}return g}function l9(d,g,M,O,q,ee,ge,Fe,Xe){return d=hm(M,O,!0,d,q,ee,ge,Fe,Xe),d.context=_y(null),M=d.current,O=To(),q=cl(M),ee=za(O,q),ee.callback=g??null,sl(M,ee,q),d.current.lanes=q,As(d,q,O),ca(d,O),d}function c9(d,g,M,O){var q=g.current,ee=To(),ge=cl(q);return M=_y(M),g.context===null?g.context=M:g.pendingContext=M,g=za(ee,ge),g.payload={element:d},O=O===void 0?null:O,O!==null&&(g.callback=O),d=sl(q,g,ge),d!==null&&(ul(d,q,ge,ee),V1(d,q,ge)),ge}function u9(d){if(d=d.current,!d.child)return null;switch(d.child.tag){case 5:return d.child.stateNode;default:return d.child.stateNode}}function h9(d,g){if(d=d.memoizedState,d!==null&&d.dehydrated!==null){var M=d.retryLane;d.retryLane=M!==0&&M<g?M:g}}function d9(d,g){h9(d,g),(d=d.alternate)&&h9(d,g)}function fx(){return null}var _5=typeof reportError=="function"?reportError:function(d){console.error(d)};function x5(d){this._internalRoot=d}f9.prototype.render=x5.prototype.render=function(d){var g=this._internalRoot;if(g===null)throw Error(t(409));c9(d,g,null,null)},f9.prototype.unmount=x5.prototype.unmount=function(){var d=this._internalRoot;if(d!==null){this._internalRoot=null;var g=d.containerInfo;Ju(function(){c9(null,d,null,null)}),g[Wl]=null}};function f9(d){this._internalRoot=d}f9.prototype.unstable_scheduleHydration=function(d){if(d){var g=l1();d={blockedOn:null,target:d,priority:g};for(var M=0;M<X0.length&&g!==0&&g<X0[M].priority;M++);X0.splice(M,0,d),M===0&&Ul(d)}};function p9(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)}function m9(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11&&(d.nodeType!==8||d.nodeValue!==" react-mount-point-unstable "))}function xy(){}function by(d,g,M,O,q){if(q){if(typeof O=="function"){var ee=O;O=function(){var Ot=u9(ge);ee.call(Ot)}}var ge=l9(g,O,d,0,null,!1,!1,"",xy);return d._reactRootContainer=ge,d[Wl]=ge.current,Nf(d.nodeType===8?d.parentNode:d),Ju(),ge}for(;q=d.lastChild;)d.removeChild(q);if(typeof O=="function"){var Fe=O;O=function(){var Ot=u9(Xe);Fe.call(Ot)}}var Xe=hm(d,0,!1,null,null,!1,!1,"",xy);return d._reactRootContainer=Xe,d[Wl]=Xe.current,Nf(d.nodeType===8?d.parentNode:d),Ju(function(){c9(g,Xe,M,O)}),Xe}function g9(d,g,M,O,q){var ee=M._reactRootContainer;if(ee){var ge=ee;if(typeof q=="function"){var Fe=q;q=function(){var Xe=u9(ge);Fe.call(Xe)}}c9(g,ge,d,q)}else ge=by(M,g,d,q,O);return u9(ge)}Lh=function(d){switch(d.tag){case 3:var g=d.stateNode;if(g.current.memoizedState.isDehydrated){var M=Qr(g.pendingLanes);M!==0&&(xs(g,M|1),ca(g,bt()),(Mi&6)===0&&(Qf=bt()+500,nl()))}break;case 13:Ju(function(){var O=Vc(d,1);if(O!==null){var q=To();ul(O,d,1,q)}}),d9(d,1)}},a1=function(d){if(d.tag===13){var g=Vc(d,134217728);if(g!==null){var M=To();ul(g,d,134217728,M)}d9(d,134217728)}},Bl=function(d){if(d.tag===13){var g=cl(d),M=Vc(d,g);if(M!==null){var O=To();ul(M,d,g,O)}d9(d,g)}},l1=function(){return hi},Ug=function(d,g){var M=hi;try{return hi=d,g()}finally{hi=M}},Tn=function(d,g,M){switch(g){case"input":if(Ti(d,M),g=M.name,M.type==="radio"&&g!=null){for(M=d;M.parentNode;)M=M.parentNode;for(M=M.querySelectorAll("input[name="+JSON.stringify(""+g)+'][type="radio"]'),g=0;g<M.length;g++){var O=M[g];if(O!==d&&O.form===d.form){var q=h2(O);if(!q)throw Error(t(90));ai(O),Ti(O,q)}}}break;case"textarea":_e(d,M);break;case"select":g=M.value,g!=null&&dr(d,!!M.multiple,g,!1)}},Sr=Q2,_i=Ju;var Sy={usingClientEntryPoint:!1,Events:[Zh,Oc,h2,en,Xn,Q2]},tp={findFiberByHostInstance:y0,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},px={bundleType:tp.bundleType,version:tp.version,rendererPackageName:tp.rendererPackageName,rendererConfig:tp.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:k.ReactCurrentDispatcher,findHostInstanceByFiber:function(d){return d=Oh(d),d===null?null:d.stateNode},findFiberByHostInstance:tp.findFiberByHostInstance||fx,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var y9=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!y9.isDisabled&&y9.supportsFiber)try{yr=y9.inject(px),Yn=y9}catch{}}return mc.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Sy,mc.createPortal=function(d,g){var M=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p9(g))throw Error(t(200));return vy(d,g,null,M)},mc.createRoot=function(d,g){if(!p9(d))throw Error(t(299));var M=!1,O="",q=_5;return g!=null&&(g.unstable_strictMode===!0&&(M=!0),g.identifierPrefix!==void 0&&(O=g.identifierPrefix),g.onRecoverableError!==void 0&&(q=g.onRecoverableError)),g=hm(d,1,!1,null,null,M,!1,O,q),d[Wl]=g.current,Nf(d.nodeType===8?d.parentNode:d),new x5(g)},mc.findDOMNode=function(d){if(d==null)return null;if(d.nodeType===1)return d;var g=d._reactInternals;if(g===void 0)throw typeof d.render=="function"?Error(t(188)):(d=Object.keys(d).join(","),Error(t(268,d)));return d=Oh(g),d=d===null?null:d.stateNode,d},mc.flushSync=function(d){return Ju(d)},mc.hydrate=function(d,g,M){if(!m9(g))throw Error(t(200));return g9(null,d,g,!0,M)},mc.hydrateRoot=function(d,g,M){if(!p9(d))throw Error(t(405));var O=M!=null&&M.hydratedSources||null,q=!1,ee="",ge=_5;if(M!=null&&(M.unstable_strictMode===!0&&(q=!0),M.identifierPrefix!==void 0&&(ee=M.identifierPrefix),M.onRecoverableError!==void 0&&(ge=M.onRecoverableError)),g=l9(g,null,d,1,M??null,q,!1,ee,ge),d[Wl]=g.current,Nf(d),O)for(d=0;d<O.length;d++)M=O[d],q=M._getVersion,q=q(M._source),g.mutableSourceEagerHydrationData==null?g.mutableSourceEagerHydrationData=[M,q]:g.mutableSourceEagerHydrationData.push(M,q);return new f9(g)},mc.render=function(d,g,M){if(!m9(g))throw Error(t(200));return g9(null,d,g,!1,M)},mc.unmountComponentAtNode=function(d){if(!m9(d))throw Error(t(40));return d._reactRootContainer?(Ju(function(){g9(null,null,d,!1,function(){d._reactRootContainer=null,d[Wl]=null})}),!0):!1},mc.unstable_batchedUpdates=Q2,mc.unstable_renderSubtreeIntoContainer=function(d,g,M,O){if(!m9(M))throw Error(t(200));if(d==null||d._reactInternals===void 0)throw Error(t(38));return g9(d,g,M,!1,O)},mc.version="18.3.1-next-f1338f8080-20240426",mc}var Cpe;function jEe(){if(Cpe)return iz.exports;Cpe=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(e){console.error(e)}}return o(),iz.exports=GEe(),iz.exports}var Ape;function HEe(){if(Ape)return GP;Ape=1;var o=jEe();return GP.createRoot=o.createRoot,GP.hydrateRoot=o.hydrateRoot,GP}var WEe=HEe();const $Ee=H2e(WEe);function jP(o){throw new Error('Could not dynamically require "'+o+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Uw={exports:{}},az={},Ppe;function mn(){return Ppe||(Ppe=1,function(o){var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,c=(de,Pe,Ye)=>Pe in de?e(de,Pe,{enumerable:!0,configurable:!0,writable:!0,value:Ye}):de[Pe]=Ye,h=(de,Pe)=>{for(var Ye in Pe||(Pe={}))i.call(Pe,Ye)&&c(de,Ye,Pe[Ye]);if(r)for(var Ye of r(Pe))a.call(Pe,Ye)&&c(de,Ye,Pe[Ye]);return de},p=(de,Pe)=>t(de,n(Pe)),v=de=>e(de,"__esModule",{value:!0}),x=(de,Pe)=>{v(de);for(var Ye in Pe)e(de,Ye,{get:Pe[Ye],enumerable:!0})};x(o,{Atom:()=>S1,PointerProxy:()=>T1,Ticker:()=>$h,getPointerParts:()=>p0,isPointer:()=>K0,isPrism:()=>Gl,iterateAndCountTicks:()=>Bu,iterateOver:()=>E1,pointer:()=>Vh,pointerToPrism:()=>Wh,prism:()=>jl,val:()=>J0});var S=Array.isArray,C=S,I=typeof vo=="object"&&vo&&vo.Object===Object&&vo,L=I,U=typeof self=="object"&&self&&self.Object===Object&&self,R=L||U||Function("return this")(),$=R,Z=$.Symbol,k=Z,ie=Object.prototype,ue=ie.hasOwnProperty,ce=ie.toString,Q=k?k.toStringTag:void 0;function ae(de){var Pe=ue.call(de,Q),Ye=de[Q];try{de[Q]=void 0;var Ut=!0}catch{}var Ar=ce.call(de);return Ut&&(Pe?de[Q]=Ye:delete de[Q]),Ar}var le=ae,J=Object.prototype,Ue=J.toString;function je(de){return Ue.call(de)}var rt=je,at="[object Null]",Se="[object Undefined]",gt=k?k.toStringTag:void 0;function Ae(de){return de==null?de===void 0?Se:at:gt&&gt in Object(de)?le(de):rt(de)}var lt=Ae;function pt(de){return de!=null&&typeof de=="object"}var De=pt,_t="[object Symbol]";function Jt(de){return typeof de=="symbol"||De(de)&&lt(de)==_t}var dt=Jt,Dt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,gn=/^\w*$/;function qt(de,Pe){if(C(de))return!1;var Ye=typeof de;return Ye=="number"||Ye=="symbol"||Ye=="boolean"||de==null||dt(de)?!0:gn.test(de)||!Dt.test(de)||Pe!=null&&de in Object(Pe)}var wn=qt;function nr(de){var Pe=typeof de;return de!=null&&(Pe=="object"||Pe=="function")}var qn=nr,ni="[object AsyncFunction]",ai="[object Function]",qr="[object GeneratorFunction]",$e="[object Proxy]";function Ls(de){if(!qn(de))return!1;var Pe=lt(de);return Pe==ai||Pe==qr||Pe==ni||Pe==$e}var li=Ls,Ti=$["__core-js_shared__"],Ln=Ti,Pr=function(){var de=/[^.]+$/.exec(Ln&&Ln.keys&&Ln.keys.IE_PROTO||"");return de?"Symbol(src)_1."+de:""}();function sr(de){return!!Pr&&Pr in de}var dr=sr,mi=Function.prototype,Oe=mi.toString;function _e(de){if(de!=null){try{return Oe.call(de)}catch{}try{return de+""}catch{}}return""}var Ct=_e,Kt=/[\\^$.*+?()[\]{}|]/g,Zt=/^\[object .+?Constructor\]$/,jt=Function.prototype,or=Object.prototype,An=jt.toString,Gn=or.hasOwnProperty,ar=RegExp("^"+An.call(Gn).replace(Kt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Qt(de){if(!qn(de)||dr(de))return!1;var Pe=li(de)?ar:Zt;return Pe.test(Ct(de))}var jn=Qt;function Cr(de,Pe){return de==null?void 0:de[Pe]}var gr=Cr;function Pn(de,Pe){var Ye=gr(de,Pe);return jn(Ye)?Ye:void 0}var wr=Pn,Ze=wr(Object,"create"),Tn=Ze;function nn(){this.__data__=Tn?Tn(null):{},this.size=0}var Nn=nn;function ln(de){var Pe=this.has(de)&&delete this.__data__[de];return this.size-=Pe?1:0,Pe}var en=ln,Xn="__lodash_hash_undefined__",Sr=Object.prototype,_i=Sr.hasOwnProperty;function Zr(de){var Pe=this.__data__;if(Tn){var Ye=Pe[de];return Ye===Xn?void 0:Ye}return _i.call(Pe,de)?Pe[de]:void 0}var Bs=Zr,so=Object.prototype,Cc=so.hasOwnProperty;function Ms(de){var Pe=this.__data__;return Tn?Pe[de]!==void 0:Cc.call(Pe,de)}var Us=Ms,h0="__lodash_hash_undefined__";function Fl(de,Pe){var Ye=this.__data__;return this.size+=this.has(de)?0:1,Ye[de]=Tn&&Pe===void 0?h0:Pe,this}var $0=Fl;function Ro(de){var Pe=-1,Ye=de==null?0:de.length;for(this.clear();++Pe<Ye;){var Ut=de[Pe];this.set(Ut[0],Ut[1])}}Ro.prototype.clear=Nn,Ro.prototype.delete=en,Ro.prototype.get=Bs,Ro.prototype.has=Us,Ro.prototype.set=$0;var Tu=Ro;function Mu(){this.__data__=[],this.size=0}var bf=Mu;function oo(de,Pe){return de===Pe||de!==de&&Pe!==Pe}var Dh=oo;function Ll(de,Pe){for(var Ye=de.length;Ye--;)if(Dh(de[Ye][0],Pe))return Ye;return-1}var Cu=Ll,Oh=Array.prototype,Fh=Oh.splice;function Sf(de){var Pe=this.__data__,Ye=Cu(Pe,de);if(Ye<0)return!1;var Ut=Pe.length-1;return Ye==Ut?Pe.pop():Fh.call(Pe,Ye,1),--this.size,!0}var we=Sf;function st(de){var Pe=this.__data__,Ye=Cu(Pe,de);return Ye<0?void 0:Pe[Ye][1]}var Pt=st;function bt(de){return Cu(this.__data__,de)>-1}var ht=bt;function yn(de,Pe){var Ye=this.__data__,Ut=Cu(Ye,de);return Ut<0?(++this.size,Ye.push([de,Pe])):Ye[Ut][1]=Pe,this}var On=yn;function Un(de){var Pe=-1,Ye=de==null?0:de.length;for(this.clear();++Pe<Ye;){var Ut=de[Pe];this.set(Ut[0],Ut[1])}}Un.prototype.clear=bf,Un.prototype.delete=we,Un.prototype.get=Pt,Un.prototype.has=ht,Un.prototype.set=On;var Hn=Un,lr=wr($,"Map"),yr=lr;function Yn(){this.size=0,this.__data__={hash:new Tu,map:new(yr||Hn),string:new Tu}}var Fr=Yn;function Lr(de){var Pe=typeof de;return Pe=="string"||Pe=="number"||Pe=="symbol"||Pe=="boolean"?de!=="__proto__":de===null}var Ii=Lr;function Xi(de,Pe){var Ye=de.__data__;return Ii(Pe)?Ye[typeof Pe=="string"?"string":"hash"]:Ye.map}var ri=Xi;function Jn(de){var Pe=ri(this,de).delete(de);return this.size-=Pe?1:0,Pe}var Yi=Jn;function Qr(de){return ri(this,de).get(de)}var Cs=Qr;function Ba(de){return ri(this,de).has(de)}var ko=Ba;function d0(de,Pe){var Ye=ri(this,de),Ut=Ye.size;return Ye.set(de,Pe),this.size+=Ye.size==Ut?0:1,this}var Ni=d0;function hs(de){var Pe=-1,Ye=de==null?0:de.length;for(this.clear();++Pe<Ye;){var Ut=de[Pe];this.set(Ut[0],Ut[1])}}hs.prototype.clear=Fr,hs.prototype.delete=Yi,hs.prototype.get=Cs,hs.prototype.has=ko,hs.prototype.set=Ni;var As=hs,zs="Expected a function";function xs(de,Pe){if(typeof de!="function"||Pe!=null&&typeof Pe!="function")throw new TypeError(zs);var Ye=function(){var Ut=arguments,Ar=Pe?Pe.apply(this,Ut):Ut[0],di=Ye.cache;if(di.has(Ar))return di.get(Ar);var to=de.apply(this,Ut);return Ye.cache=di.set(Ar,to)||di,to};return Ye.cache=new(xs.Cache||As),Ye}xs.Cache=As;var hi=xs,eo=500;function Lh(de){var Pe=hi(de,function(Ut){return Ye.size===eo&&Ye.clear(),Ut}),Ye=Pe.cache;return Pe}var a1=Lh,Bl=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,l1=/\\(\\)?/g,Ug=a1(function(de){var Pe=[];return de.charCodeAt(0)===46&&Pe.push(""),de.replace(Bl,function(Ye,Ut,Ar,di){Pe.push(Ar?di.replace(l1,"$1"):Ut||Ye)}),Pe}),c1=Ug;function Bh(de,Pe){for(var Ye=-1,Ut=de==null?0:de.length,Ar=Array(Ut);++Ye<Ut;)Ar[Ye]=Pe(de[Ye],Ye,de);return Ar}var q0=Bh,Vs=k?k.prototype:void 0,f0=Vs?Vs.toString:void 0;function Au(de){if(typeof de=="string")return de;if(C(de))return q0(de,Au)+"";if(dt(de))return f0?f0.call(de):"";var Pe=de+"";return Pe=="0"&&1/de==-1/0?"-0":Pe}var Pu=Au;function X0(de){return de==null?"":Pu(de)}var zg=X0;function u1(de,Pe){return C(de)?de:wn(de,Pe)?[de]:c1(zg(de))}var Ru=u1;function Vg(de){if(typeof de=="string"||dt(de))return de;var Pe=de+"";return Pe=="0"&&1/de==-1/0?"-0":Pe}var Ul=Vg;function zl(de,Pe){Pe=Ru(Pe,de);for(var Ye=0,Ut=Pe.length;de!=null&&Ye<Ut;)de=de[Ul(Pe[Ye++])];return Ye&&Ye==Ut?de:void 0}var Gg=zl;function h1(de,Pe,Ye){var Ut=de==null?void 0:Gg(de,Pe);return Ut===void 0?Ye:Ut}var ku=h1;function Uh(de,Pe){return function(Ye){return de(Pe(Ye))}}var Iu=Uh,Ua=Iu(Object.getPrototypeOf,Object),Ac=Ua,jg="[object Object]",Nu=Function.prototype,wf=Object.prototype,Ef=Nu.toString,d1=wf.hasOwnProperty,Y0=Ef.call(Object);function Tf(de){if(!De(de)||lt(de)!=jg)return!1;var Pe=Ac(de);if(Pe===null)return!0;var Ye=d1.call(Pe,"constructor")&&Pe.constructor;return typeof Ye=="function"&&Ye instanceof Ye&&Ef.call(Ye)==Y0}var Du=Tf;function f1(de){var Pe=de==null?0:de.length;return Pe?de[Pe-1]:void 0}var Mf=f1,Vl=new WeakMap,p1=new WeakMap,ao=Symbol("pointerMeta"),Pc={get(de,Pe){if(Pe===ao)return Vl.get(de);let Ye=p1.get(de);Ye||(Ye=new Map,p1.set(de,Ye));const Ut=Ye.get(Pe);if(Ut!==void 0)return Ut;const Ar=Vl.get(de),di=zh({root:Ar.root,path:[...Ar.path,Pe]});return Ye.set(Pe,di),di}},ba=de=>de[ao],p0=de=>{const{root:Pe,path:Ye}=ba(de);return{root:Pe,path:Ye}};function zh(de){var Pe;const Ye={root:de.root,path:(Pe=de.path)!=null?Pe:[]},Ut={};return Vl.set(Ut,Ye),new Proxy(Ut,Pc)}var Vh=zh,K0=de=>de&&!!ba(de);function Rc(de,Pe,Ye){return Pe.length===0?Ye(de):Z0(de,Pe,Ye)}var Z0=(de,Pe,Ye)=>{if(Pe.length===0)return Ye(de);if(Array.isArray(de)){let[Ut,...Ar]=Pe;Ut=parseInt(String(Ut),10),isNaN(Ut)&&(Ut=0);const di=de[Ut],to=Z0(di,Ar,Ye);if(di===to)return de;const g0=[...de];return g0.splice(Ut,1,to),g0}else if(typeof de=="object"&&de!==null){const[Ut,...Ar]=Pe,di=de[Ut],to=Z0(di,Ar,Ye);return di===to?de:p(h({},de),{[Ut]:to})}else{const[Ut,...Ar]=Pe;return{[Ut]:Z0(void 0,Ar,Ye)}}},Gs=class{constructor(){this._head=void 0}peek(){return this._head&&this._head.data}pop(){const de=this._head;if(de)return this._head=de.next,de.data}push(de){const Pe={next:this._head,data:de};this._head=Pe}};function Gl(de){return!!(de&&de.isPrism&&de.isPrism===!0)}function Cf(){const de=()=>{},Pe=new Gs,Ye=de;return{type:"Dataverse_discoveryMechanism",startIgnoringDependencies:()=>{Pe.push(Ye)},stopIgnoringDependencies:()=>{Pe.peek()!==Ye||Pe.pop()},reportResolutionStart:Uu=>{const Io=Pe.peek();Io&&Io(Uu),Pe.push(Ye)},reportResolutionEnd:Uu=>{Pe.pop()},pushCollector:Uu=>{Pe.push(Uu)},popCollector:Uu=>{if(Pe.peek()!==Uu)throw new Error("Popped collector is not on top of the stack");Pe.pop()}}}function Hg(){const de="__dataverse_discoveryMechanism_sharedStack",Pe=typeof window<"u"?window:typeof vo<"u"?vo:{};if(Pe){const Ye=Pe[de];if(Ye&&typeof Ye=="object"&&Ye.type==="Dataverse_discoveryMechanism")return Ye;{const Ut=Cf();return Pe[de]=Ut,Ut}}else return Cf()}var{startIgnoringDependencies:m0,stopIgnoringDependencies:Gh,reportResolutionEnd:Wg,reportResolutionStart:$g,pushCollector:m1,popCollector:i4}=Hg(),Ou=()=>{},g1=class{constructor(de,Pe){this._fn=de,this._prismInstance=Pe,this._didMarkDependentsAsStale=!1,this._isFresh=!1,this._cacheOfDendencyValues=new Map,this._dependents=new Set,this._dependencies=new Set,this._possiblyStaleDeps=new Set,this._scope=new Xg(this),this._lastValue=void 0,this._forciblySetToStale=!1,this._reactToDependencyGoingStale=Ye=>{this._possiblyStaleDeps.add(Ye),this._markAsStale()};for(const Ye of this._dependencies)Ye._addDependent(this._reactToDependencyGoingStale);m0(),this.getValue(),Gh()}get hasDependents(){return this._dependents.size>0}removeDependent(de){this._dependents.delete(de)}addDependent(de){this._dependents.add(de)}destroy(){for(const de of this._dependencies)de._removeDependent(this._reactToDependencyGoingStale);Af(this._scope)}getValue(){if(!this._isFresh){const de=this._recalculate();this._lastValue=de,this._isFresh=!0,this._didMarkDependentsAsStale=!1,this._forciblySetToStale=!1}return this._lastValue}_recalculate(){let de;if(!this._forciblySetToStale&&this._possiblyStaleDeps.size>0){let Ut=!1;m0();for(const Ar of this._possiblyStaleDeps)if(this._cacheOfDendencyValues.get(Ar)!==Ar.getValue()){Ut=!0;break}if(Gh(),this._possiblyStaleDeps.clear(),!Ut)return this._lastValue}const Pe=new Set;this._cacheOfDendencyValues.clear();const Ye=Ut=>{Pe.add(Ut),this._addDependency(Ut)};m1(Ye),bo.push(this._scope);try{de=this._fn()}catch(Ut){console.error(Ut)}finally{bo.pop()!==this._scope&&console.warn("The Prism hook stack has slipped. This is a bug.")}i4(Ye);for(const Ut of this._dependencies)Pe.has(Ut)||this._removeDependency(Ut);this._dependencies=Pe,m0();for(const Ut of Pe)this._cacheOfDendencyValues.set(Ut,Ut.getValue());return Gh(),de}forceStale(){this._forciblySetToStale=!0,this._markAsStale()}_markAsStale(){if(!this._didMarkDependentsAsStale){this._didMarkDependentsAsStale=!0,this._isFresh=!1;for(const de of this._dependents)de(this._prismInstance)}}_addDependency(de){this._dependencies.has(de)||(this._dependencies.add(de),de._addDependent(this._reactToDependencyGoingStale))}_removeDependency(de){this._dependencies.has(de)&&(this._dependencies.delete(de),de._removeDependent(this._reactToDependencyGoingStale))}},y1={},qg=class{constructor(de){this._fn=de,this.isPrism=!0,this._state={hot:!1,handle:void 0}}get isHot(){return this._state.hot}onChange(de,Pe,Ye=!1){const Ut=()=>{de.onThisOrNextTick(di)};let Ar=y1;const di=()=>{const g0=this.getValue();g0!==Ar&&(Ar=g0,Pe(g0))};return this._addDependent(Ut),Ye&&(Ar=this.getValue(),Pe(Ar)),()=>{this._removeDependent(Ut),de.offThisOrNextTick(di),de.offNextTick(di)}}onStale(de){const Pe=()=>{this._removeDependent(Ye)},Ye=()=>de();return this._addDependent(Ye),Pe}keepHot(){return this.onStale(()=>{})}_addDependent(de){this._state.hot||this._goHot(),this._state.handle.addDependent(de)}_goHot(){const de=new g1(this._fn,this);this._state={hot:!0,handle:de}}_removeDependent(de){const Pe=this._state;if(!Pe.hot)return;const Ye=Pe.handle;Ye.removeDependent(de),Ye.hasDependents||(this._state={hot:!1,handle:void 0},Ye.destroy())}getValue(){$g(this);const de=this._state;let Pe;return de.hot?Pe=de.handle.getValue():Pe=Q0(this._fn),Wg(this),Pe}},Xg=class{constructor(de){this._hotHandle=de,this._refs=new Map,this.isPrismScope=!0,this.subs={},this.effects=new Map,this.memos=new Map}ref(de,Pe){let Ye=this._refs.get(de);if(Ye!==void 0)return Ye;{const Ut={current:Pe};return this._refs.set(de,Ut),Ut}}effect(de,Pe,Ye){let Ut=this.effects.get(de);Ut===void 0&&(Ut={cleanup:Ou,deps:void 0},this.effects.set(de,Ut)),v1(Ut.deps,Ye)&&(Ut.cleanup(),m0(),Ut.cleanup=jh(Pe,Ou).value,Gh(),Ut.deps=Ye)}memo(de,Pe,Ye){let Ut=this.memos.get(de);return Ut===void 0&&(Ut={cachedValue:null,deps:void 0},this.memos.set(de,Ut)),v1(Ut.deps,Ye)&&(m0(),Ut.cachedValue=jh(Pe,void 0).value,Gh(),Ut.deps=Ye),Ut.cachedValue}state(de,Pe){const{value:Ye,setValue:Ut}=this.memo("state/"+de,()=>{const Ar={current:Pe};return{value:Ar,setValue:to=>{Ar.current=to,this._hotHandle.forceStale()}}},[]);return[Ye.current,Ut]}sub(de){return this.subs[de]||(this.subs[de]=new Xg(this._hotHandle)),this.subs[de]}cleanupEffects(){for(const de of this.effects.values())jh(de.cleanup,void 0);this.effects.clear()}source(de,Pe){return this.effect("$$source/blah",()=>de(()=>{this._hotHandle.forceStale()}),[de]),Pe()}};function Af(de){for(const Pe of Object.values(de.subs))Af(Pe);de.cleanupEffects()}function jh(de,Pe){try{return{value:de(),ok:!0}}catch(Ye){return setTimeout(function(){throw Ye}),{value:Pe,ok:!1}}}var bo=new Gs;function s4(de,Pe){const Ye=bo.peek();if(!Ye)throw new Error("prism.ref() is called outside of a prism() call.");return Ye.ref(de,Pe)}function Fu(de,Pe,Ye){const Ut=bo.peek();if(!Ut)throw new Error("prism.effect() is called outside of a prism() call.");return Ut.effect(de,Pe,Ye)}function v1(de,Pe){if(de===void 0||Pe===void 0)return!0;const Ye=de.length;if(Ye!==Pe.length)return!0;for(let Ut=0;Ut<Ye;Ut++)if(de[Ut]!==Pe[Ut])return!0;return!1}function Yg(de,Pe,Ye){const Ut=bo.peek();if(!Ut)throw new Error("prism.memo() is called outside of a prism() call.");return Ut.memo(de,Pe,Ye)}function $o(de,Pe){const Ye=bo.peek();if(!Ye)throw new Error("prism.state() is called outside of a prism() call.");return Ye.state(de,Pe)}function o4(){if(!bo.peek())throw new Error("The parent function is called outside of a prism() call.")}function a4(de,Pe){const Ye=bo.peek();if(!Ye)throw new Error("prism.scope() is called outside of a prism() call.");const Ut=Ye.sub(de);bo.push(Ut);const Ar=jh(Pe,void 0).value;return bo.pop(),Ar}function Kg(de,Pe,Ye){return Yg(de,()=>Qi(Pe),Ye).getValue()}function _1(){return!!bo.peek()}function kc(de,Pe){const Ye=bo.peek();if(!Ye)throw new Error("prism.source() is called outside of a prism() call.");return Ye.source(de,Pe)}var Qi=de=>new qg(de),Hh=class{effect(de,Pe,Ye){console.warn("prism.effect() does not run in cold prisms")}memo(de,Pe,Ye){return Pe()}state(de,Pe){return[Pe,()=>{}]}ref(de,Pe){return{current:Pe}}sub(de){return new Hh}source(de,Pe){return Pe()}};function Q0(de){const Pe=new Hh;bo.push(Pe);let Ye;try{Ye=de()}catch(Ut){console.error(Ut)}finally{bo.pop()!==Pe&&console.warn("The Prism hook stack has slipped. This is a bug.")}return Ye}Qi.ref=s4,Qi.effect=Fu,Qi.memo=Yg,Qi.ensurePrism=o4,Qi.state=$o,Qi.scope=a4,Qi.sub=Kg,Qi.inPrism=_1,Qi.source=kc;var jl=Qi,x1;(function(de){de[de.Dict=0]="Dict",de[de.Array=1]="Array",de[de.Other=2]="Other"})(x1||(x1={}));var xi=de=>Array.isArray(de)?1:Du(de)?0:2,Ic=(de,Pe,Ye=xi(de))=>Ye===0&&typeof Pe=="string"||Ye===1&&Lu(Pe)?de[Pe]:void 0,Lu=de=>{const Pe=typeof de=="number"?de:parseInt(de,10);return!isNaN(Pe)&&Pe>=0&&Pe<1/0&&(Pe|0)===Pe},b1=class{constructor(de,Pe){this._parent=de,this._path=Pe,this.children=new Map,this.identityChangeListeners=new Set}addIdentityChangeListener(de){this.identityChangeListeners.add(de)}removeIdentityChangeListener(de){this.identityChangeListeners.delete(de),this._checkForGC()}removeChild(de){this.children.delete(de),this._checkForGC()}getChild(de){return this.children.get(de)}getOrCreateChild(de){let Pe=this.children.get(de);return Pe||(Pe=Pe=new b1(this,this._path.concat([de])),this.children.set(de,Pe)),Pe}_checkForGC(){this.identityChangeListeners.size>0||this.children.size>0||this._parent&&this._parent.removeChild(Mf(this._path))}},S1=class{constructor(de){this.$$isPointerToPrismProvider=!0,this.pointer=Vh({root:this,path:[]}),this.prism=this.pointerToPrism(this.pointer),this._onPointerValueChange=(Pe,Ye)=>{const{path:Ut}=p0(Pe),Ar=this._getOrCreateScopeForPath(Ut);return Ar.identityChangeListeners.add(Ye),()=>{Ar.identityChangeListeners.delete(Ye)}},this._currentState=de,this._rootScope=new b1(void 0,[])}set(de){const Pe=this._currentState;this._currentState=de,this._checkUpdates(this._rootScope,Pe,de)}get(){return this._currentState}getByPointer(de){const Pe=K0(de)?de:de(this.pointer),Ye=p0(Pe).path;return this._getIn(Ye)}_getIn(de){return de.length===0?this.get():ku(this.get(),de)}reduce(de){this.set(de(this.get()))}reduceByPointer(de,Pe){const Ye=K0(de)?de:de(this.pointer),Ut=p0(Ye).path,Ar=Rc(this.get(),Ut,Pe);this.set(Ar)}setByPointer(de,Pe){this.reduceByPointer(de,()=>Pe)}_checkUpdates(de,Pe,Ye){if(Pe===Ye)return;for(const di of de.identityChangeListeners)di(Ye);if(de.children.size===0)return;const Ut=xi(Pe),Ar=xi(Ye);if(!(Ut===2&&Ut===Ar))for(const[di,to]of de.children){const g0=Ic(Pe,di,Ut),Pf=Ic(Ye,di,Ar);this._checkUpdates(to,g0,Pf)}}_getOrCreateScopeForPath(de){let Pe=this._rootScope;for(const Ye of de)Pe=Pe.getOrCreateChild(Ye);return Pe}pointerToPrism(de){const{path:Pe}=p0(de),Ye=Ar=>this._onPointerValueChange(de,Ar),Ut=()=>this._getIn(Pe);return jl(()=>jl.source(Ye,Ut))}},w1=new WeakMap;function Zg(de){return typeof de=="object"&&de!==null&&de.$$isPointerToPrismProvider===!0}var Wh=de=>{const Pe=ba(de);let Ye=w1.get(Pe);if(!Ye){const Ut=Pe.root;if(!Zg(Ut))throw new Error("Cannot run pointerToPrism() on a pointer whose root is not an PointerToPrismProvider");Ye=Ut.pointerToPrism(de),w1.set(Pe,Ye)}return Ye},J0=de=>K0(de)?Wh(de).getValue():Gl(de)?de.getValue():de;function*Bu(de){let Pe;if(K0(de))Pe=Wh(de);else if(Gl(de))Pe=de;else throw new Error("Only pointers and prisms are supported");let Ye=0;const Ut=Pe.onStale(()=>{Ye++});try{for(;;){const Ar=Ye;Ye=0,yield{value:Pe.getValue(),ticks:Ar}}}finally{Ut()}}var l4=60*3,$h=class{constructor(de){this._conf=de,this._ticking=!1,this._dormant=!0,this._numberOfDormantTicks=0,this.__ticks=0,this._scheduledForThisOrNextTick=new Set,this._scheduledForNextTick=new Set,this._timeAtCurrentTick=0}get dormant(){return this._dormant}onThisOrNextTick(de){this._scheduledForThisOrNextTick.add(de),this._dormant&&this._goActive()}onNextTick(de){this._scheduledForNextTick.add(de),this._dormant&&this._goActive()}offThisOrNextTick(de){this._scheduledForThisOrNextTick.delete(de)}offNextTick(de){this._scheduledForNextTick.delete(de)}get time(){return this._ticking?this._timeAtCurrentTick:performance.now()}_goActive(){var de,Pe;this._dormant&&(this._dormant=!1,(Pe=(de=this._conf)==null?void 0:de.onActive)==null||Pe.call(de))}_goDormant(){var de,Pe;this._dormant||(this._dormant=!0,this._numberOfDormantTicks=0,(Pe=(de=this._conf)==null?void 0:de.onDormant)==null||Pe.call(de))}tick(de=performance.now()){if(this.__ticks++,!this._dormant&&this._scheduledForNextTick.size===0&&this._scheduledForThisOrNextTick.size===0&&(this._numberOfDormantTicks++,this._numberOfDormantTicks>=l4)){this._goDormant();return}this._ticking=!0,this._timeAtCurrentTick=de;for(const Pe of this._scheduledForNextTick)this._scheduledForThisOrNextTick.add(Pe);this._scheduledForNextTick.clear(),this._tick(0),this._ticking=!1}_tick(de){const Pe=this.time;if(de>10&&console.warn("_tick() recursing for 10 times"),de>100)throw new Error("Maximum recursion limit for _tick()");const Ye=this._scheduledForThisOrNextTick;this._scheduledForThisOrNextTick=new Set;for(const Ut of Ye)Ut(Pe);if(this._scheduledForThisOrNextTick.size>0)return this._tick(de+1)}};function*E1(de){let Pe;if(K0(de))Pe=Wh(de);else if(Gl(de))Pe=de;else throw new Error("Only pointers and prisms are supported");const Ye=new $h,Ut=Pe.onChange(Ye,Ar=>{});try{for(;;)Ye.tick(),yield Pe.getValue()}finally{Ut()}}var T1=class{constructor(de){this.$$isPointerToPrismProvider=!0,this._currentPointerBox=new S1(de),this.pointer=Vh({root:this,path:[]})}setPointer(de){this._currentPointerBox.set(de)}pointerToPrism(de){const{path:Pe}=ba(de);return jl(()=>{const Ye=this._currentPointerBox.prism.getValue(),Ut=Pe.reduce((Ar,di)=>Ar[di],Ye);return J0(Ut)})}}}(az)),az}Uw.exports;var Rpe;function qEe(){return Rpe||(Rpe=1,function(o,e){var t={},n=Object.create,r=Object.freeze,i=Object.defineProperty,a=Object.defineProperties,c=Object.getOwnPropertyDescriptor,h=Object.getOwnPropertyDescriptors,p=Object.getOwnPropertyNames,v=Object.getOwnPropertySymbols,x=Object.getPrototypeOf,S=Object.prototype.hasOwnProperty,C=Object.prototype.propertyIsEnumerable,I=(s,l)=>{if(l=Symbol[s])return l;throw Error("Symbol."+s+" is not defined")},L=Math.pow,U=(s,l,u)=>l in s?i(s,l,{enumerable:!0,configurable:!0,writable:!0,value:u}):s[l]=u,R=(s,l)=>{for(var u in l||(l={}))S.call(l,u)&&U(s,u,l[u]);if(v)for(var u of v(l))C.call(l,u)&&U(s,u,l[u]);return s},$=(s,l)=>a(s,h(l)),Z=(s,l)=>{var u={};for(var m in s)S.call(s,m)&&l.indexOf(m)<0&&(u[m]=s[m]);if(s!=null&&v)for(var m of v(s))l.indexOf(m)<0&&C.call(s,m)&&(u[m]=s[m]);return u},k=(s,l)=>()=>(s&&(l=s(s=0)),l),ie=(s,l)=>()=>(l||s((l={exports:{}}).exports,l),l.exports),ue=(s,l)=>{for(var u in l)i(s,u,{get:l[u],enumerable:!0})},ce=(s,l,u,m)=>{if(l&&typeof l=="object"||typeof l=="function")for(let _ of p(l))!S.call(s,_)&&_!==u&&i(s,_,{get:()=>l[_],enumerable:!(m=c(l,_))||m.enumerable});return s},Q=(s,l,u)=>(u=s!=null?n(x(s)):{},ce(l||!s||!s.__esModule?i(u,"default",{value:s,enumerable:!0}):u,s)),ae=s=>ce(i({},"__esModule",{value:!0}),s),le=(s,l,u)=>(U(s,typeof l!="symbol"?l+"":l,u),u),J=(s,l)=>r(i(s,"raw",{value:r(s.slice())})),Ue=(s,l,u)=>new Promise((m,_)=>{var b=P=>{try{T(u.next(P))}catch(N){_(N)}},E=P=>{try{T(u.throw(P))}catch(N){_(N)}},T=P=>P.done?m(P.value):Promise.resolve(P.value).then(b,E);T((u=u.apply(s,l)).next())}),je=function(s,l){this[0]=s,this[1]=l},rt=s=>{var l=s[I("asyncIterator")],u=!1,m,_={};return l==null?(l=s[I("iterator")](),m=b=>_[b]=E=>l[b](E)):(l=l.call(s),m=b=>_[b]=E=>{if(u){if(u=!1,b==="throw")throw E;return E}return u=!0,{done:!1,value:new je(new Promise(T=>{var P=l[b](E);if(!(P instanceof Object))throw TypeError("Object expected");T(P)}),1)}}),_[I("iterator")]=()=>_,m("next"),"throw"in l?m("throw"):_.throw=b=>{throw b},"return"in l&&m("return"),_};function at(s){gt=s}function Se(){return gt}var gt,Ae=k(()=>{});function lt(s,l,u=[]){if(typeof s=="object"&&s){if(pt(s)||De(s)){l(s,u);return}for(let[m,_]of Object.entries(s))lt(_,l,[...u,m])}else{if(s==null)return;l(s,u)}}var pt,De,_t=k(()=>{pt=s=>typeof s=="object"&&s!==null&&Object.hasOwnProperty.call(s,"type")&&s.type==="image"&&Object.hasOwnProperty.call(s,"id")&&typeof s.id=="string"&&s.id!=="",De=s=>typeof s=="object"&&s!==null&&Object.hasOwnProperty.call(s,"r")&&Object.hasOwnProperty.call(s,"g")&&Object.hasOwnProperty.call(s,"b")&&Object.hasOwnProperty.call(s,"a")&&typeof s.r=="number"&&typeof s.g=="number"&&typeof s.b=="number"&&typeof s.a=="number"});function Jt(s){return l=>typeof l=="object"&&!!l&&l.type===s}var dt,Dt,gn,qt,wn,nr,qn,ni,ai=k(()=>{dt=Jt("Theatre_Project"),Dt=Jt("Theatre_Sheet"),gn=Jt("Theatre_SheetTemplate"),qt=Jt("Theatre_SheetObject"),wn=Jt("Theatre_Sequence"),nr=Jt("Theatre_SheetObjectTemplate"),qn=Jt("Theatre_Sheet_PublicAPI"),ni=Jt("Theatre_SheetObject_PublicAPI")}),qr,$e,Ls=k(()=>{qr=typeof vo=="object"&&vo&&vo.Object===Object&&vo,$e=qr}),li,Ti,Ln,Pr=k(()=>{Ls(),li=typeof self=="object"&&self&&self.Object===Object&&self,Ti=$e||li||Function("return this")(),Ln=Ti}),sr,dr,mi=k(()=>{Pr(),sr=Ln.Symbol,dr=sr});function Oe(s){var l=Ct.call(s,Zt),u=s[Zt];try{s[Zt]=void 0;var m=!0}catch{}var _=Kt.call(s);return m&&(l?s[Zt]=u:delete s[Zt]),_}var _e,Ct,Kt,Zt,jt,or=k(()=>{mi(),_e=Object.prototype,Ct=_e.hasOwnProperty,Kt=_e.toString,Zt=dr?dr.toStringTag:void 0,jt=Oe});function An(s){return ar.call(s)}var Gn,ar,Qt,jn=k(()=>{Gn=Object.prototype,ar=Gn.toString,Qt=An});function Cr(s){return s==null?s===void 0?Pn:gr:wr&&wr in Object(s)?jt(s):Qt(s)}var gr,Pn,wr,Ze,Tn=k(()=>{mi(),or(),jn(),gr="[object Null]",Pn="[object Undefined]",wr=dr?dr.toStringTag:void 0,Ze=Cr});function nn(s){return s!=null&&typeof s=="object"}var Nn,ln=k(()=>{Nn=nn});function en(s){return typeof s=="symbol"||Nn(s)&&Ze(s)==Xn}var Xn,Sr,_i=k(()=>{Tn(),ln(),Xn="[object Symbol]",Sr=en});function Zr(s,l){for(var u=-1,m=s==null?0:s.length,_=Array(m);++u<m;)_[u]=l(s[u],u,s);return _}var Bs,so=k(()=>{Bs=Zr}),Cc,Ms,Us=k(()=>{Cc=Array.isArray,Ms=Cc});function h0(s){if(typeof s=="string")return s;if(Ms(s))return Bs(s,h0)+"";if(Sr(s))return Ro?Ro.call(s):"";var l=s+"";return l=="0"&&1/s==-Fl?"-0":l}var Fl,$0,Ro,Tu,Mu=k(()=>{mi(),so(),Us(),_i(),Fl=1/0,$0=dr?dr.prototype:void 0,Ro=$0?$0.toString:void 0,Tu=h0});function bf(s){for(var l=s.length;l--&&oo.test(s.charAt(l)););return l}var oo,Dh,Ll=k(()=>{oo=/\s/,Dh=bf});function Cu(s){return s&&s.slice(0,Dh(s)+1).replace(Oh,"")}var Oh,Fh,Sf=k(()=>{Ll(),Oh=/^\s+/,Fh=Cu});function we(s){var l=typeof s;return s!=null&&(l=="object"||l=="function")}var st,Pt=k(()=>{st=we});function bt(s){if(typeof s=="number")return s;if(Sr(s))return ht;if(st(s)){var l=typeof s.valueOf=="function"?s.valueOf():s;s=st(l)?l+"":l}if(typeof s!="string")return s===0?s:+s;s=Fh(s);var u=On.test(s);return u||Un.test(s)?Hn(s.slice(2),u?2:8):yn.test(s)?ht:+s}var ht,yn,On,Un,Hn,lr,yr=k(()=>{Sf(),Pt(),_i(),ht=NaN,yn=/^[-+]0x[0-9a-f]+$/i,On=/^0b[01]+$/i,Un=/^0o[0-7]+$/i,Hn=parseInt,lr=bt});function Yn(s){if(!s)return s===0?s:0;if(s=lr(s),s===Fr||s===-Fr){var l=s<0?-1:1;return l*Lr}return s===s?s:0}var Fr,Lr,Ii,Xi=k(()=>{yr(),Fr=1/0,Lr=17976931348623157e292,Ii=Yn});function ri(s){var l=Ii(s),u=l%1;return l===l?u?l-u:l:0}var Jn,Yi=k(()=>{Xi(),Jn=ri});function Qr(s){return s}var Cs,Ba=k(()=>{Cs=Qr});function ko(s){if(!st(s))return!1;var l=Ze(s);return l==Ni||l==hs||l==d0||l==As}var d0,Ni,hs,As,zs,xs=k(()=>{Tn(),Pt(),d0="[object AsyncFunction]",Ni="[object Function]",hs="[object GeneratorFunction]",As="[object Proxy]",zs=ko}),hi,eo,Lh=k(()=>{Pr(),hi=Ln["__core-js_shared__"],eo=hi});function a1(s){return!!Bl&&Bl in s}var Bl,l1,Ug=k(()=>{Lh(),Bl=function(){var s=/[^.]+$/.exec(eo&&eo.keys&&eo.keys.IE_PROTO||"");return s?"Symbol(src)_1."+s:""}(),l1=a1});function c1(s){if(s!=null){try{return q0.call(s)}catch{}try{return s+""}catch{}}return""}var Bh,q0,Vs,f0=k(()=>{Bh=Function.prototype,q0=Bh.toString,Vs=c1});function Au(s){if(!st(s)||l1(s))return!1;var l=zs(s)?Ul:X0;return l.test(Vs(s))}var Pu,X0,zg,u1,Ru,Vg,Ul,zl,Gg=k(()=>{xs(),Ug(),Pt(),f0(),Pu=/[\\^$.*+?()[\]{}|]/g,X0=/^\[object .+?Constructor\]$/,zg=Function.prototype,u1=Object.prototype,Ru=zg.toString,Vg=u1.hasOwnProperty,Ul=RegExp("^"+Ru.call(Vg).replace(Pu,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),zl=Au});function h1(s,l){return s==null?void 0:s[l]}var ku,Uh=k(()=>{ku=h1});function Iu(s,l){var u=ku(s,l);return zl(u)?u:void 0}var Ua,Ac=k(()=>{Gg(),Uh(),Ua=Iu}),jg,Nu,wf=k(()=>{Ac(),Pr(),jg=Ua(Ln,"WeakMap"),Nu=jg});function Ef(s,l,u){switch(u.length){case 0:return s.call(l);case 1:return s.call(l,u[0]);case 2:return s.call(l,u[0],u[1]);case 3:return s.call(l,u[0],u[1],u[2])}return s.apply(l,u)}var d1,Y0=k(()=>{d1=Ef});function Tf(){}var Du,f1=k(()=>{Du=Tf});function Mf(s,l){var u=-1,m=s.length;for(l||(l=Array(m));++u<m;)l[u]=s[u];return l}var Vl,p1=k(()=>{Vl=Mf});function ao(s){var l=0,u=0;return function(){var m=p0(),_=ba-(m-u);if(u=m,_>0){if(++l>=Pc)return arguments[0]}else l=0;return s.apply(void 0,arguments)}}var Pc,ba,p0,zh,Vh=k(()=>{Pc=800,ba=16,p0=Date.now,zh=ao});function K0(s){return function(){return s}}var Rc,Z0=k(()=>{Rc=K0}),Gs,Gl,Cf=k(()=>{Ac(),Gs=function(){try{var s=Ua(Object,"defineProperty");return s({},"",{}),s}catch{}}(),Gl=Gs}),Hg,m0,Gh=k(()=>{Z0(),Cf(),Ba(),Hg=Gl?function(s,l){return Gl(s,"toString",{configurable:!0,enumerable:!1,value:Rc(l),writable:!0})}:Cs,m0=Hg}),Wg,$g,m1=k(()=>{Gh(),Vh(),Wg=zh(m0),$g=Wg});function i4(s,l,u,m){for(var _=s.length,b=u+(m?1:-1);m?b--:++b<_;)if(l(s[b],b,s))return b;return-1}var Ou,g1=k(()=>{Ou=i4});function y1(s){return s!==s}var qg,Xg=k(()=>{qg=y1});function Af(s,l,u){for(var m=u-1,_=s.length;++m<_;)if(s[m]===l)return m;return-1}var jh,bo=k(()=>{jh=Af});function s4(s,l,u){return l===l?jh(s,l,u):Ou(s,qg,u)}var Fu,v1=k(()=>{g1(),Xg(),bo(),Fu=s4});function Yg(s,l){var u=s==null?0:s.length;return!!u&&Fu(s,l,0)>-1}var $o,o4=k(()=>{v1(),$o=Yg});function a4(s,l){var u=typeof s;return l=l??Kg,!!l&&(u=="number"||u!="symbol"&&_1.test(s))&&s>-1&&s%1==0&&s<l}var Kg,_1,kc,Qi=k(()=>{Kg=9007199254740991,_1=/^(?:0|[1-9]\d*)$/,kc=a4});function Hh(s,l,u){l=="__proto__"&&Gl?Gl(s,l,{configurable:!0,enumerable:!0,value:u,writable:!0}):s[l]=u}var Q0,jl=k(()=>{Cf(),Q0=Hh});function x1(s,l){return s===l||s!==s&&l!==l}var xi,Ic=k(()=>{xi=x1});function Lu(s,l,u){var m=s[l];(!(S1.call(s,l)&&xi(m,u))||u===void 0&&!(l in s))&&Q0(s,l,u)}var b1,S1,w1,Zg=k(()=>{jl(),Ic(),b1=Object.prototype,S1=b1.hasOwnProperty,w1=Lu});function Wh(s,l,u){return l=J0(l===void 0?s.length-1:l,0),function(){for(var m=arguments,_=-1,b=J0(m.length-l,0),E=Array(b);++_<b;)E[_]=m[l+_];_=-1;for(var T=Array(l+1);++_<l;)T[_]=m[_];return T[l]=u(E),d1(s,this,T)}}var J0,Bu,l4=k(()=>{Y0(),J0=Math.max,Bu=Wh});function $h(s,l){return $g(Bu(s,l,Cs),s+"")}var E1,T1=k(()=>{Ba(),l4(),m1(),E1=$h});function de(s){return typeof s=="number"&&s>-1&&s%1==0&&s<=Pe}var Pe,Ye,Ut=k(()=>{Pe=9007199254740991,Ye=de});function Ar(s){return s!=null&&Ye(s.length)&&!zs(s)}var di,to=k(()=>{xs(),Ut(),di=Ar});function g0(s,l,u){if(!st(u))return!1;var m=typeof l;return(m=="number"?di(u)&&kc(l,u.length):m=="string"&&l in u)?xi(u[l],s):!1}var Pf,Uu=k(()=>{Ic(),to(),Qi(),Pt(),Pf=g0});function Io(s){var l=s&&s.constructor,u=typeof l=="function"&&l.prototype||qh;return s===u}var qh,c4,R6=k(()=>{qh=Object.prototype,c4=Io});function k6(s,l){for(var u=-1,m=Array(s);++u<s;)m[u]=l(u);return m}var u4,h4=k(()=>{u4=k6});function ox(s){return Nn(s)&&Ze(s)==I6}var I6,el,d4=k(()=>{Tn(),ln(),I6="[object Arguments]",el=ox}),Xh,Rf,f4,kf,Nc,M1=k(()=>{d4(),ln(),Xh=Object.prototype,Rf=Xh.hasOwnProperty,f4=Xh.propertyIsEnumerable,kf=el(function(){return arguments}())?el:function(s){return Nn(s)&&Rf.call(s,"callee")&&!f4.call(s,"callee")},Nc=kf});function Qg(){return!1}var C1,N6=k(()=>{C1=Qg}),Jg,e2,t2,A1,p4,Dc,If,P1=k(()=>{Pr(),N6(),Jg=e&&!e.nodeType&&e,e2=Jg&&!0&&o&&!o.nodeType&&o,t2=e2&&e2.exports===Jg,A1=t2?Ln.Buffer:void 0,p4=A1?A1.isBuffer:void 0,Dc=p4||C1,If=Dc});function ax(s){return Nn(s)&&Ye(s.length)&&!!es[Ze(s)]}var D6,Yh,m4,g4,n2,Ji,r2,zu,Nf,y4,i2,Df,R1,Kh,v4,O6,F6,_4,k1,I1,s2,o2,a2,l2,es,x4,lx=k(()=>{Tn(),Ut(),ln(),D6="[object Arguments]",Yh="[object Array]",m4="[object Boolean]",g4="[object Date]",n2="[object Error]",Ji="[object Function]",r2="[object Map]",zu="[object Number]",Nf="[object Object]",y4="[object RegExp]",i2="[object Set]",Df="[object String]",R1="[object WeakMap]",Kh="[object ArrayBuffer]",v4="[object DataView]",O6="[object Float32Array]",F6="[object Float64Array]",_4="[object Int8Array]",k1="[object Int16Array]",I1="[object Int32Array]",s2="[object Uint8Array]",o2="[object Uint8ClampedArray]",a2="[object Uint16Array]",l2="[object Uint32Array]",es={},es[O6]=es[F6]=es[_4]=es[k1]=es[I1]=es[s2]=es[o2]=es[a2]=es[l2]=!0,es[D6]=es[Yh]=es[Kh]=es[m4]=es[v4]=es[g4]=es[n2]=es[Ji]=es[r2]=es[zu]=es[Nf]=es[y4]=es[i2]=es[Df]=es[R1]=!1,x4=ax});function cx(s){return function(l){return s(l)}}var Of,Hl=k(()=>{Of=cx}),c2,tl,gi,Vu,Wl,N1,b4=k(()=>{Ls(),c2=e&&!e.nodeType&&e,tl=c2&&!0&&o&&!o.nodeType&&o,gi=tl&&tl.exports===c2,Vu=gi&&$e.process,Wl=function(){try{var s=tl&&tl.require&&tl.require("util").types;return s||Vu&&Vu.binding&&Vu.binding("util")}catch{}}(),N1=Wl}),u2,y0,Zh,Oc=k(()=>{lx(),Hl(),b4(),u2=N1&&N1.isTypedArray,y0=u2?Of(u2):x4,Zh=y0});function h2(s,l){var u=Ms(s),m=!u&&Nc(s),_=!u&&!m&&If(s),b=!u&&!m&&!_&&Zh(s),E=u||m||_||b,T=E?u4(s.length,String):[],P=T.length;for(var N in s)(l||Gu.call(s,N))&&!(E&&(N=="length"||_&&(N=="offset"||N=="parent")||b&&(N=="buffer"||N=="byteLength"||N=="byteOffset")||kc(N,P)))&&T.push(N);return T}var Fc,Gu,Lc,ts=k(()=>{h4(),M1(),Us(),P1(),Qi(),Oc(),Fc=Object.prototype,Gu=Fc.hasOwnProperty,Lc=h2});function ns(s,l){return function(u){return s(l(u))}}var $l,No=k(()=>{$l=ns}),qo,ju,Qh=k(()=>{No(),qo=$l(Object.keys,Object),ju=qo});function Sa(s){if(!c4(s))return ju(s);var l=[];for(var u in Object(s))S4.call(s,u)&&u!="constructor"&&l.push(u);return l}var D1,S4,w4,d2=k(()=>{R6(),Qh(),D1=Object.prototype,S4=D1.hasOwnProperty,w4=Sa});function L6(s){return di(s)?Lc(s):w4(s)}var v0,ql=k(()=>{ts(),d2(),to(),v0=L6});function E4(s,l){if(Ms(s))return!1;var u=typeof s;return u=="number"||u=="symbol"||u=="boolean"||s==null||Sr(s)?!0:B6.test(s)||!T4.test(s)||l!=null&&s in Object(l)}var T4,B6,nl,Hu=k(()=>{Us(),_i(),T4=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,B6=/^\w*$/,nl=E4}),Jh,Bc,Uc=k(()=>{Ac(),Jh=Ua(Object,"create"),Bc=Jh});function _0(){this.__data__=Bc?Bc(null):{},this.size=0}var wa,ed=k(()=>{Uc(),wa=_0});function rl(s){var l=this.has(s)&&delete this.__data__[s];return this.size-=l?1:0,l}var Xl,td=k(()=>{Xl=rl});function U6(s){var l=this.__data__;if(Bc){var u=l[s];return u===O1?void 0:u}return Ea.call(l,s)?l[s]:void 0}var O1,f2,Ea,Ta,ds=k(()=>{Uc(),O1="__lodash_hash_undefined__",f2=Object.prototype,Ea=f2.hasOwnProperty,Ta=U6});function il(s){var l=this.__data__;return Bc?l[s]!==void 0:M4.call(l,s)}var p2,M4,m2,C4=k(()=>{Uc(),p2=Object.prototype,M4=p2.hasOwnProperty,m2=il});function z6(s,l){var u=this.__data__;return this.size+=this.has(s)?0:1,u[s]=Bc&&l===void 0?F1:l,this}var F1,A4,Ff=k(()=>{Uc(),F1="__lodash_hash_undefined__",A4=z6});function Wu(s){var l=-1,u=s==null?0:s.length;for(this.clear();++l<u;){var m=s[l];this.set(m[0],m[1])}}var P4,L1=k(()=>{ed(),td(),ds(),C4(),Ff(),Wu.prototype.clear=wa,Wu.prototype.delete=Xl,Wu.prototype.get=Ta,Wu.prototype.has=m2,Wu.prototype.set=A4,P4=Wu});function g2(){this.__data__=[],this.size=0}var B1,V6=k(()=>{B1=g2});function Lf(s,l){for(var u=s.length;u--;)if(xi(s[u][0],l))return u;return-1}var nd,rd=k(()=>{Ic(),nd=Lf});function y2(s){var l=this.__data__,u=nd(l,s);if(u<0)return!1;var m=l.length-1;return u==m?l.pop():v2.call(l,u,1),--this.size,!0}var id,v2,_2,R4=k(()=>{rd(),id=Array.prototype,v2=id.splice,_2=y2});function U1(s){var l=this.__data__,u=nd(l,s);return u<0?void 0:l[u][1]}var zc,x0=k(()=>{rd(),zc=U1});function $u(s){return nd(this.__data__,s)>-1}var z1,k4=k(()=>{rd(),z1=$u});function Vc(s,l){var u=this.__data__,m=nd(u,s);return m<0?(++this.size,u.push([s,l])):u[m][1]=l,this}var Yl,x2=k(()=>{rd(),Yl=Vc});function sd(s){var l=-1,u=s==null?0:s.length;for(this.clear();++l<u;){var m=s[l];this.set(m[0],m[1])}}var za,sl=k(()=>{V6(),R4(),x0(),k4(),x2(),sd.prototype.clear=B1,sd.prototype.delete=_2,sd.prototype.get=zc,sd.prototype.has=z1,sd.prototype.set=Yl,za=sd}),V1,od,Bf=k(()=>{Ac(),Pr(),V1=Ua(Ln,"Map"),od=V1});function G6(){this.size=0,this.__data__={hash:new P4,map:new(od||za),string:new P4}}var Uf,Kl=k(()=>{L1(),sl(),Bf(),Uf=G6});function G1(s){var l=typeof s;return l=="string"||l=="number"||l=="symbol"||l=="boolean"?s!=="__proto__":s===null}var zf,qu=k(()=>{zf=G1});function I4(s,l){var u=s.__data__;return zf(l)?u[typeof l=="string"?"string":"hash"]:u.map}var Zl,j1=k(()=>{qu(),Zl=I4});function N4(s){var l=Zl(this,s).delete(s);return this.size-=l?1:0,l}var fs,b2=k(()=>{j1(),fs=N4});function D4(s){return Zl(this,s).get(s)}var S2,w2=k(()=>{j1(),S2=D4});function O4(s){return Zl(this,s).has(s)}var Xu,Gi=k(()=>{j1(),Xu=O4});function bs(s,l){var u=Zl(this,s),m=u.size;return u.set(s,l),this.size+=u.size==m?0:1,this}var lo,E2=k(()=>{j1(),lo=bs});function Ql(s){var l=-1,u=s==null?0:s.length;for(this.clear();++l<u;){var m=s[l];this.set(m[0],m[1])}}var Gc,T2=k(()=>{Kl(),b2(),w2(),Gi(),E2(),Ql.prototype.clear=Uf,Ql.prototype.delete=fs,Ql.prototype.get=S2,Ql.prototype.has=Xu,Ql.prototype.set=lo,Gc=Ql});function co(s,l){if(typeof s!="function"||l!=null&&typeof l!="function")throw new TypeError(M2);var u=function(){var m=arguments,_=l?l.apply(this,m):m[0],b=u.cache;if(b.has(_))return b.get(_);var E=s.apply(this,m);return u.cache=b.set(_,E)||b,E};return u.cache=new(co.Cache||Gc),u}var M2,Vf,H1=k(()=>{T2(),M2="Expected a function",co.Cache=Gc,Vf=co});function Jl(s){var l=Vf(s,function(m){return u.size===Va&&u.clear(),m}),u=l.cache;return l}var Va,Gf,F4=k(()=>{H1(),Va=500,Gf=Jl}),C2,A2,L4,B4,U4=k(()=>{F4(),C2=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,A2=/\\(\\)?/g,L4=Gf(function(s){var l=[];return s.charCodeAt(0)===46&&l.push(""),s.replace(C2,function(u,m,_,b){l.push(_?b.replace(A2,"$1"):m||u)}),l}),B4=L4});function j6(s){return s==null?"":Tu(s)}var ad,z4=k(()=>{Mu(),ad=j6});function H6(s,l){return Ms(s)?s:nl(s,l)?[s]:B4(ad(s))}var Yu,P2=k(()=>{Us(),Hu(),U4(),z4(),Yu=H6});function W1(s){if(typeof s=="string"||Sr(s))return s;var l=s+"";return l=="0"&&1/s==-$1?"-0":l}var $1,ld,cd=k(()=>{_i(),$1=1/0,ld=W1});function V4(s,l){l=Yu(l,s);for(var u=0,m=l.length;s!=null&&u<m;)s=s[ld(l[u++])];return u&&u==m?s:void 0}var q1,jf=k(()=>{P2(),cd(),q1=V4});function W6(s,l,u){var m=s==null?void 0:q1(s,l);return m===void 0?u:m}var jc,Hf=k(()=>{jf(),jc=W6});function R2(s,l){for(var u=-1,m=l.length,_=s.length;++u<m;)s[_+u]=l[u];return s}var k2,I2=k(()=>{k2=R2});function $6(s){return Ms(s)||Nc(s)||!!(X1&&s&&s[X1])}var X1,G4,q6=k(()=>{mi(),M1(),Us(),X1=dr?dr.isConcatSpreadable:void 0,G4=$6});function N2(s,l,u,m,_){var b=-1,E=s.length;for(u||(u=G4),_||(_=[]);++b<E;){var T=s[b];l>0&&u(T)?l>1?N2(T,l-1,u,m,_):k2(_,T):m||(_[_.length]=T)}return _}var D2,Y1=k(()=>{I2(),q6(),D2=N2}),j4,X6,ux=k(()=>{No(),j4=$l(Object.getPrototypeOf,Object),X6=j4});function ol(s){if(!Nn(s)||Ze(s)!=O2)return!1;var l=X6(s);if(l===null)return!0;var u=H4.call(l,"constructor")&&l.constructor;return typeof u=="function"&&u instanceof u&&Ku.call(u)==F2}var O2,K1,Hc,Ku,H4,F2,Wc,L2=k(()=>{Tn(),ux(),ln(),O2="[object Object]",K1=Function.prototype,Hc=Object.prototype,Ku=K1.toString,H4=Hc.hasOwnProperty,F2=Ku.call(Object),Wc=ol});function W4(s){var l=Math[s];return function(u,m){if(u=lr(u),m=m==null?0:$4(Jn(m),292),m&&Z1(u)){var _=(ad(u)+"e").split("e"),b=l(_[0]+"e"+(+_[1]+m));return _=(ad(b)+"e").split("e"),+(_[0]+"e"+(+_[1]-m))}return l(u)}}var Z1,$4,Q1,Y6=k(()=>{Pr(),Yi(),yr(),z4(),Z1=Ln.isFinite,$4=Math.min,Q1=W4});function K6(s,l,u){return s===s&&(u!==void 0&&(s=s<=u?s:u),l!==void 0&&(s=s>=l?s:l)),s}var q4,hx=k(()=>{q4=K6});function Ma(s,l,u){return u===void 0&&(u=l,l=void 0),u!==void 0&&(u=lr(u),u=u===u?u:0),l!==void 0&&(l=lr(l),l=l===l?l:0),q4(lr(s),l,u)}var ii,Wf=k(()=>{hx(),yr(),ii=Ma});function Z6(){this.__data__=new za,this.size=0}var X4,Q6=k(()=>{sl(),X4=Z6});function J6(s){var l=this.__data__,u=l.delete(s);return this.size=l.size,u}var B2,ey=k(()=>{B2=J6});function Y4(s){return this.__data__.get(s)}var K4,ty=k(()=>{K4=Y4});function Z4(s){return this.__data__.has(s)}var U2,ny=k(()=>{U2=Z4});function Q4(s,l){var u=this.__data__;if(u instanceof za){var m=u.__data__;if(!od||m.length<J1-1)return m.push([s,l]),this.size=++u.size,this;u=this.__data__=new Gc(m)}return u.set(s,l),this.size=u.size,this}var J1,ry,iy=k(()=>{sl(),Bf(),T2(),J1=200,ry=Q4});function Zu(s){var l=this.__data__=new za(s);this.size=l.size}var $f,em=k(()=>{sl(),Q6(),ey(),ty(),ny(),iy(),Zu.prototype.clear=X4,Zu.prototype.delete=B2,Zu.prototype.get=K4,Zu.prototype.has=U2,Zu.prototype.set=ry,$f=Zu});function $c(s,l){for(var u=-1,m=s==null?0:s.length,_=0,b=[];++u<m;){var E=s[u];l(E,u,s)&&(b[_++]=E)}return b}var sy,oy=k(()=>{sy=$c});function J4(){return[]}var e5,ay=k(()=>{e5=J4}),qf,Do,t5,ly,tm,Oo=k(()=>{oy(),ay(),qf=Object.prototype,Do=qf.propertyIsEnumerable,t5=Object.getOwnPropertySymbols,ly=t5?function(s){return s==null?[]:(s=Object(s),sy(t5(s),function(l){return Do.call(s,l)}))}:e5,tm=ly});function dx(s,l,u){var m=l(s);return Ms(s)?m:k2(m,u(s))}var Kn,Xf=k(()=>{I2(),Us(),Kn=dx});function n5(s){return Kn(s,v0,tm)}var z2,cy=k(()=>{Xf(),Oo(),ql(),z2=n5}),Yf,ud,r5=k(()=>{Ac(),Pr(),Yf=Ua(Ln,"DataView"),ud=Yf}),i5,nm,s5=k(()=>{Ac(),Pr(),i5=Ua(Ln,"Promise"),nm=i5}),V2,qc,So=k(()=>{Ac(),Pr(),V2=Ua(Ln,"Set"),qc=V2}),Ga,ec,G2,j2,ja,rm,al,uy,o5,a5,l5,Xc,c5,H2=k(()=>{r5(),Bf(),s5(),So(),wf(),Tn(),f0(),Ga="[object Map]",ec="[object Object]",G2="[object Promise]",j2="[object Set]",ja="[object WeakMap]",rm="[object DataView]",al=Vs(ud),uy=Vs(od),o5=Vs(nm),a5=Vs(qc),l5=Vs(Nu),Xc=Ze,(ud&&Xc(new ud(new ArrayBuffer(1)))!=rm||od&&Xc(new od)!=Ga||nm&&Xc(nm.resolve())!=G2||qc&&Xc(new qc)!=j2||Nu&&Xc(new Nu)!=ja)&&(Xc=function(s){var l=Ze(s),u=l==ec?s.constructor:void 0,m=u?Vs(u):"";if(m)switch(m){case al:return rm;case uy:return Ga;case o5:return G2;case a5:return j2;case l5:return ja}return l}),c5=Xc}),W2,Ca,Mi=k(()=>{Pr(),W2=Ln.Uint8Array,Ca=W2});function wo(s){return this.__data__.set(s,js),this}var js,Eo,Ha=k(()=>{js="__lodash_hash_undefined__",Eo=wo});function Kf(s){return this.__data__.has(s)}var Br,Qu=k(()=>{Br=Kf});function tc(s){var l=-1,u=s==null?0:s.length;for(this.__data__=new Gc;++l<u;)this.add(s[l])}var Zf,$2=k(()=>{T2(),Ha(),Qu(),tc.prototype.add=tc.prototype.push=Eo,tc.prototype.has=Br,Zf=tc});function im(s,l){for(var u=-1,m=s==null?0:s.length;++u<m;)if(l(s[u],u,s))return!0;return!1}var la,u5=k(()=>{la=im});function Qf(s,l){return s.has(l)}var ll,sm=k(()=>{ll=Qf});function h5(s,l,u,m,_,b){var E=u&b0,T=s.length,P=l.length;if(T!=P&&!(E&&P>T))return!1;var N=b.get(s),z=b.get(l);if(N&&z)return N==l&&z==s;var G=-1,V=!0,B=u&om?new Zf:void 0;for(b.set(s,l),b.set(l,s);++G<T;){var H=s[G],j=l[G];if(m)var X=E?m(j,H,G,l,s,b):m(H,j,G,s,l,b);if(X!==void 0){if(X)continue;V=!1;break}if(B){if(!la(l,function(K,te){if(!ll(B,te)&&(H===K||_(H,K,u,m,b)))return B.push(te)})){V=!1;break}}else if(!(H===j||_(H,j,u,m,b))){V=!1;break}}return b.delete(s),b.delete(l),V}var b0,om,nc,am=k(()=>{$2(),u5(),sm(),b0=1,om=2,nc=h5});function lm(s){var l=-1,u=Array(s.size);return s.forEach(function(m,_){u[++l]=[_,m]}),u}var q2,X2=k(()=>{q2=lm});function Y2(s){var l=-1,u=Array(s.size);return s.forEach(function(m){u[++l]=m}),u}var To,cl=k(()=>{To=Y2});function ul(s,l,u,m,_,b,E){switch(u){case m5:if(s.byteLength!=l.byteLength||s.byteOffset!=l.byteOffset)return!1;s=s.buffer,l=l.buffer;case p5:return!(s.byteLength!=l.byteLength||!b(new Ca(s),new Ca(l)));case K2:case Z2:case f5:return xi(+s,+l);case hy:return s.name==l.name&&s.message==l.message;case Q2:case J2:return s==l+"";case Yc:var T=q2;case Ju:var P=m&ca;if(T||(T=To),s.size!=l.size&&!P)return!1;var N=E.get(s);if(N)return N==l;m|=d5,E.set(s,l);var z=nc(T(s),T(l),m,_,b,E);return E.delete(s),z;case eh:if(hd)return hd.call(s)==hd.call(l)}return!1}var ca,d5,K2,Z2,hy,Yc,f5,Q2,Ju,J2,eh,p5,m5,cm,hd,dy,fy=k(()=>{mi(),Mi(),Ic(),am(),X2(),cl(),ca=1,d5=2,K2="[object Boolean]",Z2="[object Date]",hy="[object Error]",Yc="[object Map]",f5="[object Number]",Q2="[object RegExp]",Ju="[object Set]",J2="[object String]",eh="[object Symbol]",p5="[object ArrayBuffer]",m5="[object DataView]",cm=dr?dr.prototype:void 0,hd=cm?cm.valueOf:void 0,dy=ul});function e9(s,l,u,m,_,b){var E=u&g5,T=z2(s),P=T.length,N=z2(l),z=N.length;if(P!=z&&!E)return!1;for(var G=P;G--;){var V=T[G];if(!(E?V in l:py.call(l,V)))return!1}var B=b.get(s),H=b.get(l);if(B&&H)return B==l&&H==s;var j=!0;b.set(s,l),b.set(l,s);for(var X=E;++G<P;){V=T[G];var K=s[V],te=l[V];if(m)var se=E?m(te,K,V,l,s,b):m(K,te,V,s,l,b);if(!(se===void 0?K===te||_(K,te,u,m,b):se)){j=!1;break}X||(X=V=="constructor")}if(j&&!X){var pe=s.constructor,fe=l.constructor;pe!=fe&&"constructor"in s&&"constructor"in l&&!(typeof pe=="function"&&pe instanceof pe&&typeof fe=="function"&&fe instanceof fe)&&(j=!1)}return b.delete(s),b.delete(l),j}var g5,th,py,dd,my=k(()=>{cy(),g5=1,th=Object.prototype,py=th.hasOwnProperty,dd=e9});function Ps(s,l,u,m,_,b){var E=Ms(s),T=Ms(l),P=E?n9:c5(s),N=T?n9:c5(l);P=P==t9?Jf:P,N=N==t9?Jf:N;var z=P==Jf,G=N==Jf,V=P==N;if(V&&If(s)){if(!If(l))return!1;E=!0,z=!1}if(V&&!z)return b||(b=new $f),E||Zh(s)?nc(s,l,u,m,_,b):dy(s,l,P,u,m,_,b);if(!(u&gy)){var B=z&&r9.call(s,"__wrapped__"),H=G&&r9.call(l,"__wrapped__");if(B||H){var j=B?s.value():s,X=H?l.value():l;return b||(b=new $f),_(j,X,u,m,b)}}return V?(b||(b=new $f),dd(s,l,u,m,_,b)):!1}var gy,t9,n9,Jf,ep,r9,y5,S0=k(()=>{em(),am(),fy(),my(),H2(),Us(),P1(),Oc(),gy=1,t9="[object Arguments]",n9="[object Array]",Jf="[object Object]",ep=Object.prototype,r9=ep.hasOwnProperty,y5=Ps});function i9(s,l,u,m,_){return s===l?!0:s==null||l==null||!Nn(s)&&!Nn(l)?s!==s&&l!==l:y5(s,l,u,m,i9,_)}var s9,rc=k(()=>{S0(),ln(),s9=i9});function o9(s,l,u,m){var _=u.length,b=_,E=!m;if(s==null)return!b;for(s=Object(s);_--;){var T=u[_];if(E&&T[2]?T[1]!==s[T[0]]:!(T[0]in s))return!1}for(;++_<b;){T=u[_];var P=T[0],N=s[P],z=T[1];if(E&&T[2]){if(N===void 0&&!(P in s))return!1}else{var G=new $f;if(m)var V=m(N,z,P,s,l,G);if(!(V===void 0?s9(z,N,nh|um,m,G):V))return!1}}return!0}var nh,um,a9,v5=k(()=>{em(),rc(),nh=1,um=2,a9=o9});function yy(s){return s===s&&!st(s)}var hm,vy=k(()=>{Pt(),hm=yy});function _y(s){for(var l=v0(s),u=l.length;u--;){var m=l[u],_=s[m];l[u]=[m,_,hm(_)]}return l}var l9,c9=k(()=>{vy(),ql(),l9=_y});function u9(s,l){return function(u){return u==null?!1:u[s]===l&&(l!==void 0||s in Object(u))}}var h9,d9=k(()=>{h9=u9});function fx(s){var l=l9(s);return l.length==1&&l[0][2]?h9(l[0][0],l[0][1]):function(u){return u===s||a9(u,s,l)}}var _5,x5=k(()=>{v5(),c9(),d9(),_5=fx});function f9(s,l){return s!=null&&l in Object(s)}var p9,m9=k(()=>{p9=f9});function xy(s,l,u){l=Yu(l,s);for(var m=-1,_=l.length,b=!1;++m<_;){var E=ld(l[m]);if(!(b=s!=null&&u(s,E)))break;s=s[E]}return b||++m!=_?b:(_=s==null?0:s.length,!!_&&Ye(_)&&kc(E,_)&&(Ms(s)||Nc(s)))}var by,g9=k(()=>{P2(),M1(),Us(),Qi(),Ut(),cd(),by=xy});function Sy(s,l){return s!=null&&by(s,l,p9)}var tp,px=k(()=>{m9(),g9(),tp=Sy});function y9(s,l){return nl(s)&&hm(l)?h9(ld(s),l):function(u){var m=jc(u,s);return m===void 0&&m===l?tp(u,s):s9(l,m,d|g)}}var d,g,M,O=k(()=>{rc(),Hf(),px(),Hu(),vy(),d9(),cd(),d=1,g=2,M=y9});function q(s){return function(l){return l==null?void 0:l[s]}}var ee,ge=k(()=>{ee=q});function Fe(s){return function(l){return q1(l,s)}}var Xe,Ot=k(()=>{jf(),Xe=Fe});function on(s){return nl(s)?ee(ld(s)):Xe(s)}var vn,an=k(()=>{ge(),Ot(),Hu(),cd(),vn=on});function Wn(s){return typeof s=="function"?s:s==null?Cs:typeof s=="object"?Ms(s)?M(s[0],s[1]):_5(s):vn(s)}var $n,Zn=k(()=>{x5(),O(),Ba(),Us(),an(),$n=Wn});function Hs(s,l,u,m){for(var _=-1,b=s==null?0:s.length;++_<b;){var E=s[_];l(m,E,u(E),s)}return m}var xt,tt=k(()=>{xt=Hs});function At(s){return function(l,u,m){for(var _=-1,b=Object(l),E=m(l),T=E.length;T--;){var P=E[s?T:++_];if(u(b[P],P,b)===!1)break}return l}}var En,cr=k(()=>{En=At}),Er,Tr,Dr=k(()=>{cr(),Er=En(),Tr=Er});function Mo(s,l){return s&&Tr(s,l,v0)}var bi,Kc=k(()=>{Dr(),ql(),bi=Mo});function mx(s,l){return function(u,m){if(u==null)return u;if(!di(u))return s(u,m);for(var _=u.length,b=l?_:-1,E=Object(u);(l?b--:++b<_)&&m(E[b],b,E)!==!1;);return u}}var gx,jI=k(()=>{to(),gx=mx}),zE,wy,VE=k(()=>{Kc(),jI(),zE=gx(bi),wy=zE});function HI(s,l,u,m){return wy(s,function(_,b,E){l(m,_,u(_),E)}),m}var GE,WI=k(()=>{VE(),GE=HI});function $I(s,l){return function(u,m){var _=Ms(u)?xt:GE,b=l?l():{};return _(u,s,$n(m,2),b)}}var jE,yx=k(()=>{tt(),WI(),Zn(),Us(),jE=$I}),Ey,Ty,HE=k(()=>{Pr(),Ey=function(){return Ln.Date.now()},Ty=Ey});function WE(s,l,u){var m,_,b,E,T,P,N=0,z=!1,G=!1,V=!0;if(typeof s!="function")throw new TypeError(vx);l=lr(l)||0,st(u)&&(z=!!u.leading,G="maxWait"in u,b=G?$E(lr(u.maxWait)||0,l):b,V="trailing"in u?!!u.trailing:V);function B(ve){var Ne=m,ze=_;return m=_=void 0,N=ve,E=s.apply(ze,Ne),E}function H(ve){return N=ve,T=setTimeout(K,l),z?B(ve):E}function j(ve){var Ne=ve-P,ze=ve-N,Me=l-Ne;return G?_x(Me,b-ze):Me}function X(ve){var Ne=ve-P,ze=ve-N;return P===void 0||Ne>=l||Ne<0||G&&ze>=b}function K(){var ve=Ty();if(X(ve))return te(ve);T=setTimeout(K,j(ve))}function te(ve){return T=void 0,V&&m?B(ve):(m=_=void 0,E)}function se(){T!==void 0&&clearTimeout(T),N=0,m=P=_=T=void 0}function pe(){return T===void 0?E:te(Ty())}function fe(){var ve=Ty(),Ne=X(ve);if(m=arguments,_=this,P=ve,Ne){if(T===void 0)return H(P);if(G)return clearTimeout(T),T=setTimeout(K,l),B(P)}return T===void 0&&(T=setTimeout(K,l)),E}return fe.cancel=se,fe.flush=pe,fe}var vx,$E,_x,My,qE=k(()=>{Pt(),HE(),yr(),vx="Expected a function",$E=Math.max,_x=Math.min,My=WE});function qI(s,l,u){for(var m=-1,_=s==null?0:s.length;++m<_;)if(u(l,s[m]))return!0;return!1}var XE,YE=k(()=>{XE=qI});function XI(s){var l=s==null?0:s.length;return l?s[l-1]:void 0}var dm,Cy=k(()=>{dm=XI});function KE(s,l,u){var m=s==null?0:s.length;if(!m)return-1;var _=u==null?0:Jn(u);return _<0&&(_=ZE(m+_,0)),Ou(s,$n(l,3),_)}var ZE,xx,YI=k(()=>{g1(),Zn(),Yi(),ZE=Math.max,xx=KE});function KI(s,l,u){var m=s==null?0:s.length;if(!m)return-1;var _=m-1;return u!==void 0&&(_=Jn(u),_=u<0?v9(m+_,0):QE(_,m-1)),Ou(s,$n(l,3),_,!0)}var v9,QE,bx,ZI=k(()=>{g1(),Zn(),Yi(),v9=Math.max,QE=Math.min,bx=KI});function QI(s,l){var u=-1,m=di(s)?Array(s.length):[];return wy(s,function(_,b,E){m[++u]=l(_,b,E)}),m}var JE,Ay=k(()=>{VE(),to(),JE=QI});function Sx(s,l,u){return s>=tT(l,u)&&s<eT(l,u)}var eT,tT,ls,hl=k(()=>{eT=Math.max,tT=Math.min,ls=Sx});function dl(s,l,u){return l=Ii(l),u===void 0?(u=l,l=0):u=Ii(u),s=lr(s),ls(s,l,u)}var fd,ps=k(()=>{hl(),Xi(),yr(),fd=dl});function pd(s){return typeof s=="number"&&s==Jn(s)}var Py,nT=k(()=>{Yi(),Py=pd}),rT,b5,JI=k(()=>{jl(),yx(),rT=jE(function(s,l,u){Q0(s,u,l)}),b5=rT});function eN(s,l){var u={};return l=$n(l,3),bi(s,function(m,_,b){Q0(u,_,l(m,_,b))}),u}var np,wx=k(()=>{jl(),Kc(),Zn(),np=eN});function Ry(s,l,u,m){if(!st(s))return s;l=Yu(l,s);for(var _=-1,b=l.length,E=b-1,T=s;T!=null&&++_<b;){var P=ld(l[_]),N=u;if(P==="__proto__"||P==="constructor"||P==="prototype")return s;if(_!=E){var z=T[P];N=m?m(z,P,T):void 0,N===void 0&&(N=st(z)?z:kc(l[_+1])?[]:{})}w1(T,P,N),T=T[P]}return s}var Ex,tN=k(()=>{Zg(),P2(),Qi(),Pt(),cd(),Ex=Ry});function iT(s,l){var u=s.length;for(s.sort(l);u--;)s[u]=s[u].value;return s}var Tx,sT=k(()=>{Tx=iT});function nN(s,l){if(s!==l){var u=s!==void 0,m=s===null,_=s===s,b=Sr(s),E=l!==void 0,T=l===null,P=l===l,N=Sr(l);if(!T&&!N&&!b&&s>l||b&&E&&P&&!T&&!N||m&&E&&P||!u&&P||!_)return 1;if(!m&&!b&&!N&&s<l||N&&u&&_&&!m&&!b||T&&u&&_||!E&&_||!P)return-1}return 0}var oT,aT=k(()=>{_i(),oT=nN});function rN(s,l,u){for(var m=-1,_=s.criteria,b=l.criteria,E=_.length,T=u.length;++m<E;){var P=oT(_[m],b[m]);if(P){if(m>=T)return P;var N=u[m];return P*(N=="desc"?-1:1)}}return s.index-l.index}var lT,S5=k(()=>{aT(),lT=rN});function cT(s,l,u){l.length?l=Bs(l,function(b){return Ms(b)?function(E){return q1(E,b.length===1?b[0]:b)}:b}):l=[Cs];var m=-1;l=Bs(l,Of($n));var _=JE(s,function(b,E,T){var P=Bs(l,function(N){return N(b)});return{criteria:P,index:++m,value:b}});return Tx(_,function(b,E){return lT(b,E,u)})}var uT,iN=k(()=>{so(),jf(),Zn(),Ay(),sT(),Hl(),S5(),Ba(),Us(),uT=cT});function Xo(s,l,u,m){for(var _=u-1,b=s.length;++_<b;)if(m(s[_],l))return _;return-1}var md,sN=k(()=>{md=Xo});function ky(s,l,u,m){var _=m?md:Fu,b=-1,E=l.length,T=s;for(s===l&&(l=Vl(l)),u&&(T=Bs(s,Of(u)));++b<E;)for(var P=0,N=l[b],z=u?u(N):N;(P=_(T,z,P,m))>-1;)T!==s&&Mx.call(T,P,1),Mx.call(s,P,1);return s}var hT,Mx,dT,oN=k(()=>{so(),v1(),sN(),Hl(),p1(),hT=Array.prototype,Mx=hT.splice,dT=ky});function Cx(s,l){return s&&s.length&&l&&l.length?dT(s,l):s}var fT,Iy=k(()=>{oN(),fT=Cx}),fm,pT,aN=k(()=>{T1(),Iy(),fm=E1(fT),pT=fm}),Ax,Ny,lN=k(()=>{Y6(),Ax=Q1("round"),Ny=Ax});function Dy(s,l,u){return s==null?s:Ex(s,l,u)}var pm,Oy=k(()=>{tN(),pm=Dy}),mT,gT,cN=k(()=>{Y1(),iN(),T1(),Uu(),mT=E1(function(s,l){if(s==null)return[];var u=l.length;return u>1&&Pf(s,l[0],l[1])?l=[]:u>2&&Pf(l[0],l[1],l[2])&&(l=[l[0]]),uT(s,D2(l,1),[])}),gT=mT}),yT,vT,_T,uN=k(()=>{So(),f1(),cl(),yT=1/0,vT=qc&&1/To(new qc([,-0]))[1]==yT?function(s){return new qc(s)}:Du,_T=vT});function mm(s,l,u){var m=-1,_=$o,b=s.length,E=!0,T=[],P=T;if(u)E=!1,_=XE;else if(b>=rp){var N=l?null:_T(s);if(N)return To(N);E=!1,_=ll,P=new Zf}else P=l?[]:T;e:for(;++m<b;){var z=s[m],G=l?l(z):z;if(z=u||z!==0?z:0,E&&G===G){for(var V=P.length;V--;)if(P[V]===G)continue e;l&&P.push(G),T.push(z)}else _(P,G,u)||(P!==T&&P.push(G),T.push(z))}return T}var rp,gm,Px=k(()=>{$2(),o4(),YE(),sm(),uN(),cl(),rp=200,gm=mm});function xT(s){return s&&s.length?gm(s):[]}var ip,bT=k(()=>{Px(),ip=xT}),Fo=k(()=>{Wf(),qE(),YI(),ps(),nT(),L2(),Cy(),wx(),H1(),lN(),bT()}),Rx=ie((s,l)=>{var u;l.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window<"u"?window:vo):m=>(u||(u=Promise.resolve())).then(m).catch(_=>setTimeout(()=>{throw _},0))}),hN=ie(s=>{var l=Symbol.for("react.element"),u=Symbol.for("react.portal"),m=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),b=Symbol.for("react.profiler"),E=Symbol.for("react.provider"),T=Symbol.for("react.context"),P=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),z=Symbol.for("react.memo"),G=Symbol.for("react.lazy"),V=Symbol.iterator;function B(be){return be===null||typeof be!="object"?null:(be=V&&be[V]||be["@@iterator"],typeof be=="function"?be:null)}var H={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},j=Object.assign,X={};function K(be,Ce,St){this.props=be,this.context=Ce,this.refs=X,this.updater=St||H}K.prototype.isReactComponent={},K.prototype.setState=function(be,Ce){if(typeof be!="object"&&typeof be!="function"&&be!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,be,Ce,"setState")},K.prototype.forceUpdate=function(be){this.updater.enqueueForceUpdate(this,be,"forceUpdate")};function te(){}te.prototype=K.prototype;function se(be,Ce,St){this.props=be,this.context=Ce,this.refs=X,this.updater=St||H}var pe=se.prototype=new te;pe.constructor=se,j(pe,K.prototype),pe.isPureReactComponent=!0;var fe=Array.isArray,ve=Object.prototype.hasOwnProperty,Ne={current:null},ze={key:!0,ref:!0,__self:!0,__source:!0};function Me(be,Ce,St){var Mt,kt={},ct=null,zn=null;if(Ce!=null)for(Mt in Ce.ref!==void 0&&(zn=Ce.ref),Ce.key!==void 0&&(ct=""+Ce.key),Ce)ve.call(Ce,Mt)&&!ze.hasOwnProperty(Mt)&&(kt[Mt]=Ce[Mt]);var Vt=arguments.length-2;if(Vt===1)kt.children=St;else if(1<Vt){for(var Dn=Array(Vt),ur=0;ur<Vt;ur++)Dn[ur]=arguments[ur+2];kt.children=Dn}if(be&&be.defaultProps)for(Mt in Vt=be.defaultProps,Vt)kt[Mt]===void 0&&(kt[Mt]=Vt[Mt]);return{$$typeof:l,type:be,key:ct,ref:zn,props:kt,_owner:Ne.current}}function He(be,Ce){return{$$typeof:l,type:be.type,key:Ce,ref:be.ref,props:be.props,_owner:be._owner}}function vt(be){return typeof be=="object"&&be!==null&&be.$$typeof===l}function xe(be){var Ce={"=":"=0",":":"=2"};return"$"+be.replace(/[=:]/g,function(St){return Ce[St]})}var We=/\/+/g;function oe(be,Ce){return typeof be=="object"&&be!==null&&be.key!=null?xe(""+be.key):Ce.toString(36)}function nt(be,Ce,St,Mt,kt){var ct=typeof be;(ct==="undefined"||ct==="boolean")&&(be=null);var zn=!1;if(be===null)zn=!0;else switch(ct){case"string":case"number":zn=!0;break;case"object":switch(be.$$typeof){case l:case u:zn=!0}}if(zn)return zn=be,kt=kt(zn),be=Mt===""?"."+oe(zn,0):Mt,fe(kt)?(St="",be!=null&&(St=be.replace(We,"$&/")+"/"),nt(kt,Ce,St,"",function(ur){return ur})):kt!=null&&(vt(kt)&&(kt=He(kt,St+(!kt.key||zn&&zn.key===kt.key?"":(""+kt.key).replace(We,"$&/")+"/")+be)),Ce.push(kt)),1;if(zn=0,Mt=Mt===""?".":Mt+":",fe(be))for(var Vt=0;Vt<be.length;Vt++){ct=be[Vt];var Dn=Mt+oe(ct,Vt);zn+=nt(ct,Ce,St,Dn,kt)}else if(Dn=B(be),typeof Dn=="function")for(be=Dn.call(be),Vt=0;!(ct=be.next()).done;)ct=ct.value,Dn=Mt+oe(ct,Vt++),zn+=nt(ct,Ce,St,Dn,kt);else if(ct==="object")throw Ce=String(be),Error("Objects are not valid as a React child (found: "+(Ce==="[object Object]"?"object with keys {"+Object.keys(be).join(", ")+"}":Ce)+"). If you meant to render a collection of children, use an array instead.");return zn}function dn(be,Ce,St){if(be==null)return be;var Mt=[],kt=0;return nt(be,Mt,"","",function(ct){return Ce.call(St,ct,kt++)}),Mt}function Ve(be){if(be._status===-1){var Ce=be._result;Ce=Ce(),Ce.then(function(St){(be._status===0||be._status===-1)&&(be._status=1,be._result=St)},function(St){(be._status===0||be._status===-1)&&(be._status=2,be._result=St)}),be._status===-1&&(be._status=0,be._result=Ce)}if(be._status===1)return be._result.default;throw be._result}var Be={current:null},ot={transition:null},Wt={ReactCurrentDispatcher:Be,ReactCurrentBatchConfig:ot,ReactCurrentOwner:Ne};s.Children={map:dn,forEach:function(be,Ce,St){dn(be,function(){Ce.apply(this,arguments)},St)},count:function(be){var Ce=0;return dn(be,function(){Ce++}),Ce},toArray:function(be){return dn(be,function(Ce){return Ce})||[]},only:function(be){if(!vt(be))throw Error("React.Children.only expected to receive a single React element child.");return be}},s.Component=K,s.Fragment=m,s.Profiler=b,s.PureComponent=se,s.StrictMode=_,s.Suspense=N,s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Wt,s.cloneElement=function(be,Ce,St){if(be==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+be+".");var Mt=j({},be.props),kt=be.key,ct=be.ref,zn=be._owner;if(Ce!=null){if(Ce.ref!==void 0&&(ct=Ce.ref,zn=Ne.current),Ce.key!==void 0&&(kt=""+Ce.key),be.type&&be.type.defaultProps)var Vt=be.type.defaultProps;for(Dn in Ce)ve.call(Ce,Dn)&&!ze.hasOwnProperty(Dn)&&(Mt[Dn]=Ce[Dn]===void 0&&Vt!==void 0?Vt[Dn]:Ce[Dn])}var Dn=arguments.length-2;if(Dn===1)Mt.children=St;else if(1<Dn){Vt=Array(Dn);for(var ur=0;ur<Dn;ur++)Vt[ur]=arguments[ur+2];Mt.children=Vt}return{$$typeof:l,type:be.type,key:kt,ref:ct,props:Mt,_owner:zn}},s.createContext=function(be){return be={$$typeof:T,_currentValue:be,_currentValue2:be,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},be.Provider={$$typeof:E,_context:be},be.Consumer=be},s.createElement=Me,s.createFactory=function(be){var Ce=Me.bind(null,be);return Ce.type=be,Ce},s.createRef=function(){return{current:null}},s.forwardRef=function(be){return{$$typeof:P,render:be}},s.isValidElement=vt,s.lazy=function(be){return{$$typeof:G,_payload:{_status:-1,_result:be},_init:Ve}},s.memo=function(be,Ce){return{$$typeof:z,type:be,compare:Ce===void 0?null:Ce}},s.startTransition=function(be){var Ce=ot.transition;ot.transition={};try{be()}finally{ot.transition=Ce}},s.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},s.useCallback=function(be,Ce){return Be.current.useCallback(be,Ce)},s.useContext=function(be){return Be.current.useContext(be)},s.useDebugValue=function(){},s.useDeferredValue=function(be){return Be.current.useDeferredValue(be)},s.useEffect=function(be,Ce){return Be.current.useEffect(be,Ce)},s.useId=function(){return Be.current.useId()},s.useImperativeHandle=function(be,Ce,St){return Be.current.useImperativeHandle(be,Ce,St)},s.useInsertionEffect=function(be,Ce){return Be.current.useInsertionEffect(be,Ce)},s.useLayoutEffect=function(be,Ce){return Be.current.useLayoutEffect(be,Ce)},s.useMemo=function(be,Ce){return Be.current.useMemo(be,Ce)},s.useReducer=function(be,Ce,St){return Be.current.useReducer(be,Ce,St)},s.useRef=function(be){return Be.current.useRef(be)},s.useState=function(be){return Be.current.useState(be)},s.useSyncExternalStore=function(be,Ce,St){return Be.current.useSyncExternalStore(be,Ce,St)},s.useTransition=function(){return Be.current.useTransition()},s.version="18.2.0"}),qe=ie((s,l)=>{l.exports=hN()}),ST=ie(s=>{function l(Be,ot){var Wt=Be.length;Be.push(ot);e:for(;0<Wt;){var be=Wt-1>>>1,Ce=Be[be];if(0<_(Ce,ot))Be[be]=ot,Be[Wt]=Ce,Wt=be;else break e}}function u(Be){return Be.length===0?null:Be[0]}function m(Be){if(Be.length===0)return null;var ot=Be[0],Wt=Be.pop();if(Wt!==ot){Be[0]=Wt;e:for(var be=0,Ce=Be.length,St=Ce>>>1;be<St;){var Mt=2*(be+1)-1,kt=Be[Mt],ct=Mt+1,zn=Be[ct];if(0>_(kt,Wt))ct<Ce&&0>_(zn,kt)?(Be[be]=zn,Be[ct]=Wt,be=ct):(Be[be]=kt,Be[Mt]=Wt,be=Mt);else if(ct<Ce&&0>_(zn,Wt))Be[be]=zn,Be[ct]=Wt,be=ct;else break e}}return ot}function _(Be,ot){var Wt=Be.sortIndex-ot.sortIndex;return Wt!==0?Wt:Be.id-ot.id}typeof performance=="object"&&typeof performance.now=="function"?(b=performance,s.unstable_now=function(){return b.now()}):(E=Date,T=E.now(),s.unstable_now=function(){return E.now()-T});var b,E,T,P=[],N=[],z=1,G=null,V=3,B=!1,H=!1,j=!1,X=typeof setTimeout=="function"?setTimeout:null,K=typeof clearTimeout=="function"?clearTimeout:null,te=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function se(Be){for(var ot=u(N);ot!==null;){if(ot.callback===null)m(N);else if(ot.startTime<=Be)m(N),ot.sortIndex=ot.expirationTime,l(P,ot);else break;ot=u(N)}}function pe(Be){if(j=!1,se(Be),!H)if(u(P)!==null)H=!0,dn(fe);else{var ot=u(N);ot!==null&&Ve(pe,ot.startTime-Be)}}function fe(Be,ot){H=!1,j&&(j=!1,K(ze),ze=-1),B=!0;var Wt=V;try{for(se(ot),G=u(P);G!==null&&(!(G.expirationTime>ot)||Be&&!vt());){var be=G.callback;if(typeof be=="function"){G.callback=null,V=G.priorityLevel;var Ce=be(G.expirationTime<=ot);ot=s.unstable_now(),typeof Ce=="function"?G.callback=Ce:G===u(P)&&m(P),se(ot)}else m(P);G=u(P)}if(G!==null)var St=!0;else{var Mt=u(N);Mt!==null&&Ve(pe,Mt.startTime-ot),St=!1}return St}finally{G=null,V=Wt,B=!1}}var ve=!1,Ne=null,ze=-1,Me=5,He=-1;function vt(){return!(s.unstable_now()-He<Me)}function xe(){if(Ne!==null){var Be=s.unstable_now();He=Be;var ot=!0;try{ot=Ne(!0,Be)}finally{ot?We():(ve=!1,Ne=null)}}else ve=!1}var We;typeof te=="function"?We=function(){te(xe)}:typeof MessageChannel<"u"?(oe=new MessageChannel,nt=oe.port2,oe.port1.onmessage=xe,We=function(){nt.postMessage(null)}):We=function(){X(xe,0)};var oe,nt;function dn(Be){Ne=Be,ve||(ve=!0,We())}function Ve(Be,ot){ze=X(function(){Be(s.unstable_now())},ot)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(Be){Be.callback=null},s.unstable_continueExecution=function(){H||B||(H=!0,dn(fe))},s.unstable_forceFrameRate=function(Be){0>Be||125<Be?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Me=0<Be?Math.floor(1e3/Be):5},s.unstable_getCurrentPriorityLevel=function(){return V},s.unstable_getFirstCallbackNode=function(){return u(P)},s.unstable_next=function(Be){switch(V){case 1:case 2:case 3:var ot=3;break;default:ot=V}var Wt=V;V=ot;try{return Be()}finally{V=Wt}},s.unstable_pauseExecution=function(){},s.unstable_requestPaint=function(){},s.unstable_runWithPriority=function(Be,ot){switch(Be){case 1:case 2:case 3:case 4:case 5:break;default:Be=3}var Wt=V;V=Be;try{return ot()}finally{V=Wt}},s.unstable_scheduleCallback=function(Be,ot,Wt){var be=s.unstable_now();switch(typeof Wt=="object"&&Wt!==null?(Wt=Wt.delay,Wt=typeof Wt=="number"&&0<Wt?be+Wt:be):Wt=be,Be){case 1:var Ce=-1;break;case 2:Ce=250;break;case 5:Ce=1073741823;break;case 4:Ce=1e4;break;default:Ce=5e3}return Ce=Wt+Ce,Be={id:z++,callback:ot,priorityLevel:Be,startTime:Wt,expirationTime:Ce,sortIndex:-1},Wt>be?(Be.sortIndex=Wt,l(N,Be),u(P)===null&&Be===u(N)&&(j?(K(ze),ze=-1):j=!0,Ve(pe,Wt-be))):(Be.sortIndex=Ce,l(P,Be),H||B||(H=!0,dn(fe))),Be},s.unstable_shouldYield=vt,s.unstable_wrapCallback=function(Be){var ot=V;return function(){var Wt=V;V=ot;try{return Be.apply(this,arguments)}finally{V=Wt}}}}),wT=ie((s,l)=>{l.exports=ST()}),dN=ie(s=>{var l=qe(),u=wT();function m(f){for(var y="https://reactjs.org/docs/error-decoder.html?invariant="+f,A=1;A<arguments.length;A++)y+="&args[]="+encodeURIComponent(arguments[A]);return"Minified React error #"+f+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var _=new Set,b={};function E(f,y){T(f,y),T(f+"Capture",y)}function T(f,y){for(b[f]=y,f=0;f<y.length;f++)_.add(y[f])}var P=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),N=Object.prototype.hasOwnProperty,z=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,G={},V={};function B(f){return N.call(V,f)?!0:N.call(G,f)?!1:z.test(f)?V[f]=!0:(G[f]=!0,!1)}function H(f,y,A,F){if(A!==null&&A.type===0)return!1;switch(typeof y){case"function":case"symbol":return!0;case"boolean":return F?!1:A!==null?!A.acceptsBooleans:(f=f.toLowerCase().slice(0,5),f!=="data-"&&f!=="aria-");default:return!1}}function j(f,y,A,F){if(y===null||typeof y>"u"||H(f,y,A,F))return!0;if(F)return!1;if(A!==null)switch(A.type){case 3:return!y;case 4:return y===!1;case 5:return isNaN(y);case 6:return isNaN(y)||1>y}return!1}function X(f,y,A,F,Y,ne,ye){this.acceptsBooleans=y===2||y===3||y===4,this.attributeName=F,this.attributeNamespace=Y,this.mustUseProperty=A,this.propertyName=f,this.type=y,this.sanitizeURL=ne,this.removeEmptyString=ye}var K={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(f){K[f]=new X(f,0,!1,f,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(f){var y=f[0];K[y]=new X(y,1,!1,f[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(f){K[f]=new X(f,2,!1,f.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(f){K[f]=new X(f,2,!1,f,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(f){K[f]=new X(f,3,!1,f.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(f){K[f]=new X(f,3,!0,f,null,!1,!1)}),["capture","download"].forEach(function(f){K[f]=new X(f,4,!1,f,null,!1,!1)}),["cols","rows","size","span"].forEach(function(f){K[f]=new X(f,6,!1,f,null,!1,!1)}),["rowSpan","start"].forEach(function(f){K[f]=new X(f,5,!1,f.toLowerCase(),null,!1,!1)});var te=/[\-:]([a-z])/g;function se(f){return f[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(f){var y=f.replace(te,se);K[y]=new X(y,1,!1,f,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(f){var y=f.replace(te,se);K[y]=new X(y,1,!1,f,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(f){var y=f.replace(te,se);K[y]=new X(y,1,!1,f,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(f){K[f]=new X(f,1,!1,f.toLowerCase(),null,!1,!1)}),K.xlinkHref=new X("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(f){K[f]=new X(f,1,!1,f.toLowerCase(),null,!0,!0)});function pe(f,y,A,F){var Y=K.hasOwnProperty(y)?K[y]:null;(Y!==null?Y.type!==0:F||!(2<y.length)||y[0]!=="o"&&y[0]!=="O"||y[1]!=="n"&&y[1]!=="N")&&(j(y,A,Y,F)&&(A=null),F||Y===null?B(y)&&(A===null?f.removeAttribute(y):f.setAttribute(y,""+A)):Y.mustUseProperty?f[Y.propertyName]=A===null?Y.type===3?!1:"":A:(y=Y.attributeName,F=Y.attributeNamespace,A===null?f.removeAttribute(y):(Y=Y.type,A=Y===3||Y===4&&A===!0?"":""+A,F?f.setAttributeNS(F,y,A):f.setAttribute(y,A))))}var fe=l.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ve=Symbol.for("react.element"),Ne=Symbol.for("react.portal"),ze=Symbol.for("react.fragment"),Me=Symbol.for("react.strict_mode"),He=Symbol.for("react.profiler"),vt=Symbol.for("react.provider"),xe=Symbol.for("react.context"),We=Symbol.for("react.forward_ref"),oe=Symbol.for("react.suspense"),nt=Symbol.for("react.suspense_list"),dn=Symbol.for("react.memo"),Ve=Symbol.for("react.lazy"),Be=Symbol.for("react.offscreen"),ot=Symbol.iterator;function Wt(f){return f===null||typeof f!="object"?null:(f=ot&&f[ot]||f["@@iterator"],typeof f=="function"?f:null)}var be=Object.assign,Ce;function St(f){if(Ce===void 0)try{throw Error()}catch(A){var y=A.stack.trim().match(/\n( *(at )?)/);Ce=y&&y[1]||""}return`
`+Ce+f}var Mt=!1;function kt(f,y){if(!f||Mt)return"";Mt=!0;var A=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(y)if(y=function(){throw Error()},Object.defineProperty(y.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(y,[])}catch(Bt){var F=Bt}Reflect.construct(f,[],y)}else{try{y.call()}catch(Bt){F=Bt}f.call(y.prototype)}else{try{throw Error()}catch(Bt){F=Bt}f()}}catch(Bt){if(Bt&&F&&typeof Bt.stack=="string"){for(var Y=Bt.stack.split(`
`),ne=F.stack.split(`
`),ye=Y.length-1,Le=ne.length-1;1<=ye&&0<=Le&&Y[ye]!==ne[Le];)Le--;for(;1<=ye&&0<=Le;ye--,Le--)if(Y[ye]!==ne[Le]){if(ye!==1||Le!==1)do if(ye--,Le--,0>Le||Y[ye]!==ne[Le]){var Qe=`
`+Y[ye].replace(" at new "," at ");return f.displayName&&Qe.includes("<anonymous>")&&(Qe=Qe.replace("<anonymous>",f.displayName)),Qe}while(1<=ye&&0<=Le);break}}}finally{Mt=!1,Error.prepareStackTrace=A}return(f=f?f.displayName||f.name:"")?St(f):""}function ct(f){switch(f.tag){case 5:return St(f.type);case 16:return St("Lazy");case 13:return St("Suspense");case 19:return St("SuspenseList");case 0:case 2:case 15:return f=kt(f.type,!1),f;case 11:return f=kt(f.type.render,!1),f;case 1:return f=kt(f.type,!0),f;default:return""}}function zn(f){if(f==null)return null;if(typeof f=="function")return f.displayName||f.name||null;if(typeof f=="string")return f;switch(f){case ze:return"Fragment";case Ne:return"Portal";case He:return"Profiler";case Me:return"StrictMode";case oe:return"Suspense";case nt:return"SuspenseList"}if(typeof f=="object")switch(f.$$typeof){case xe:return(f.displayName||"Context")+".Consumer";case vt:return(f._context.displayName||"Context")+".Provider";case We:var y=f.render;return f=f.displayName,f||(f=y.displayName||y.name||"",f=f!==""?"ForwardRef("+f+")":"ForwardRef"),f;case dn:return y=f.displayName||null,y!==null?y:zn(f.type)||"Memo";case Ve:y=f._payload,f=f._init;try{return zn(f(y))}catch{}}return null}function Vt(f){var y=f.type;switch(f.tag){case 24:return"Cache";case 9:return(y.displayName||"Context")+".Consumer";case 10:return(y._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return f=y.render,f=f.displayName||f.name||"",y.displayName||(f!==""?"ForwardRef("+f+")":"ForwardRef");case 7:return"Fragment";case 5:return y;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return zn(y);case 8:return y===Me?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof y=="function")return y.displayName||y.name||null;if(typeof y=="string")return y}return null}function Dn(f){switch(typeof f){case"boolean":case"number":case"string":case"undefined":return f;case"object":return f;default:return""}}function ur(f){var y=f.type;return(f=f.nodeName)&&f.toLowerCase()==="input"&&(y==="checkbox"||y==="radio")}function kr(f){var y=ur(f)?"checked":"value",A=Object.getOwnPropertyDescriptor(f.constructor.prototype,y),F=""+f[y];if(!f.hasOwnProperty(y)&&typeof A<"u"&&typeof A.get=="function"&&typeof A.set=="function"){var Y=A.get,ne=A.set;return Object.defineProperty(f,y,{configurable:!0,get:function(){return Y.call(this)},set:function(ye){F=""+ye,ne.call(this,ye)}}),Object.defineProperty(f,y,{enumerable:A.enumerable}),{getValue:function(){return F},setValue:function(ye){F=""+ye},stopTracking:function(){f._valueTracker=null,delete f[y]}}}}function Mr(f){f._valueTracker||(f._valueTracker=kr(f))}function ji(f){if(!f)return!1;var y=f._valueTracker;if(!y)return!0;var A=y.getValue(),F="";return f&&(F=ur(f)?f.checked?"true":"false":f.value),f=F,f!==A?(y.setValue(f),!0):!1}function he(f){if(f=f||(typeof document<"u"?document:void 0),typeof f>"u")return null;try{return f.activeElement||f.body}catch{return f.body}}function Lt(f,y){var A=y.checked;return be({},y,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:A??f._wrapperState.initialChecked})}function It(f,y){var A=y.defaultValue==null?"":y.defaultValue,F=y.checked!=null?y.checked:y.defaultChecked;A=Dn(y.value!=null?y.value:A),f._wrapperState={initialChecked:F,initialValue:A,controlled:y.type==="checkbox"||y.type==="radio"?y.checked!=null:y.value!=null}}function ke(f,y){y=y.checked,y!=null&&pe(f,"checked",y,!1)}function Re(f,y){ke(f,y);var A=Dn(y.value),F=y.type;if(A!=null)F==="number"?(A===0&&f.value===""||f.value!=A)&&(f.value=""+A):f.value!==""+A&&(f.value=""+A);else if(F==="submit"||F==="reset"){f.removeAttribute("value");return}y.hasOwnProperty("value")?Xt(f,y.type,A):y.hasOwnProperty("defaultValue")&&Xt(f,y.type,Dn(y.defaultValue)),y.checked==null&&y.defaultChecked!=null&&(f.defaultChecked=!!y.defaultChecked)}function ut(f,y,A){if(y.hasOwnProperty("value")||y.hasOwnProperty("defaultValue")){var F=y.type;if(!(F!=="submit"&&F!=="reset"||y.value!==void 0&&y.value!==null))return;y=""+f._wrapperState.initialValue,A||y===f.value||(f.value=y),f.defaultValue=y}A=f.name,A!==""&&(f.name=""),f.defaultChecked=!!f._wrapperState.initialChecked,A!==""&&(f.name=A)}function Xt(f,y,A){(y!=="number"||he(f.ownerDocument)!==f)&&(A==null?f.defaultValue=""+f._wrapperState.initialValue:f.defaultValue!==""+A&&(f.defaultValue=""+A))}var rn=Array.isArray;function wt(f,y,A,F){if(f=f.options,y){y={};for(var Y=0;Y<A.length;Y++)y["$"+A[Y]]=!0;for(A=0;A<f.length;A++)Y=y.hasOwnProperty("$"+f[A].value),f[A].selected!==Y&&(f[A].selected=Y),Y&&F&&(f[A].defaultSelected=!0)}else{for(A=""+Dn(A),y=null,Y=0;Y<f.length;Y++){if(f[Y].value===A){f[Y].selected=!0,F&&(f[Y].defaultSelected=!0);return}y!==null||f[Y].disabled||(y=f[Y])}y!==null&&(y.selected=!0)}}function fn(f,y){if(y.dangerouslySetInnerHTML!=null)throw Error(m(91));return be({},y,{value:void 0,defaultValue:void 0,children:""+f._wrapperState.initialValue})}function tn(f,y){var A=y.value;if(A==null){if(A=y.children,y=y.defaultValue,A!=null){if(y!=null)throw Error(m(92));if(rn(A)){if(1<A.length)throw Error(m(93));A=A[0]}y=A}y==null&&(y=""),A=y}f._wrapperState={initialValue:Dn(A)}}function sn(f,y){var A=Dn(y.value),F=Dn(y.defaultValue);A!=null&&(A=""+A,A!==f.value&&(f.value=A),y.defaultValue==null&&f.defaultValue!==A&&(f.defaultValue=A)),F!=null&&(f.defaultValue=""+F)}function xr(f){var y=f.textContent;y===f._wrapperState.initialValue&&y!==""&&y!==null&&(f.value=y)}function Bi(f){switch(f){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Hr(f,y){return f==null||f==="http://www.w3.org/1999/xhtml"?Bi(y):f==="http://www.w3.org/2000/svg"&&y==="foreignObject"?"http://www.w3.org/1999/xhtml":f}var r0,J9=function(f){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(y,A,F,Y){MSApp.execUnsafeLocalFunction(function(){return f(y,A,F,Y)})}:f}(function(f,y){if(f.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in f)f.innerHTML=y;else{for(r0=r0||document.createElement("div"),r0.innerHTML="<svg>"+y.valueOf().toString()+"</svg>",y=r0.firstChild;f.firstChild;)f.removeChild(f.firstChild);for(;y.firstChild;)f.appendChild(y.firstChild)}});function A0(f,y){if(y){var A=f.firstChild;if(A&&A===f.lastChild&&A.nodeType===3){A.nodeValue=y;return}}f.textContent=y}var Fd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fo=["Webkit","ms","Moz","O"];Object.keys(Fd).forEach(function(f){fo.forEach(function(y){y=y+f.charAt(0).toUpperCase()+f.substring(1),Fd[y]=Fd[f]})});function _8(f,y,A){return y==null||typeof y=="boolean"||y===""?"":A||typeof y!="number"||y===0||Fd.hasOwnProperty(f)&&Fd[f]?(""+y).trim():y+"px"}function qv(f,y){f=f.style;for(var A in y)if(y.hasOwnProperty(A)){var F=A.indexOf("--")===0,Y=_8(A,y[A],F);A==="float"&&(A="cssFloat"),F?f.setProperty(A,Y):f[A]=Y}}var Ld=be({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Xv(f,y){if(y){if(Ld[f]&&(y.children!=null||y.dangerouslySetInnerHTML!=null))throw Error(m(137,f));if(y.dangerouslySetInnerHTML!=null){if(y.children!=null)throw Error(m(60));if(typeof y.dangerouslySetInnerHTML!="object"||!("__html"in y.dangerouslySetInnerHTML))throw Error(m(61))}if(y.style!=null&&typeof y.style!="object")throw Error(m(62))}}function _S(f,y){if(f.indexOf("-")===-1)return typeof y.is=="string";switch(f){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xS=null;function bS(f){return f=f.target||f.srcElement||window,f.correspondingUseElement&&(f=f.correspondingUseElement),f.nodeType===3?f.parentNode:f}var Yv=null,hh=null,Bd=null;function Dhe(f){if(f=GS(f)){if(typeof Yv!="function")throw Error(m(280));var y=f.stateNode;y&&(y=iP(y),Yv(f.stateNode,f.type,y))}}function Ohe(f){hh?Bd?Bd.push(f):Bd=[f]:hh=f}function Fhe(){if(hh){var f=hh,y=Bd;if(Bd=hh=null,Dhe(f),y)for(f=0;f<y.length;f++)Dhe(y[f])}}function Lhe(f,y){return f(y)}function Bhe(){}var SB=!1;function Uhe(f,y,A){if(SB)return f(y,A);SB=!0;try{return Lhe(f,y,A)}finally{SB=!1,(hh!==null||Bd!==null)&&(Bhe(),Fhe())}}function SS(f,y){var A=f.stateNode;if(A===null)return null;var F=iP(A);if(F===null)return null;A=F[y];e:switch(y){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(F=!F.disabled)||(f=f.type,F=!(f==="button"||f==="input"||f==="select"||f==="textarea")),f=!F;break e;default:f=!1}if(f)return null;if(A&&typeof A!="function")throw Error(m(231,y,typeof A));return A}var wB=!1;if(P)try{Kv={},Object.defineProperty(Kv,"passive",{get:function(){wB=!0}}),window.addEventListener("test",Kv,Kv),window.removeEventListener("test",Kv,Kv)}catch{wB=!1}var Kv;function jSe(f,y,A,F,Y,ne,ye,Le,Qe){var Bt=Array.prototype.slice.call(arguments,3);try{y.apply(A,Bt)}catch(_n){this.onError(_n)}}var wS=!1,NA=null,DA=!1,EB=null,HSe={onError:function(f){wS=!0,NA=f}};function WSe(f,y,A,F,Y,ne,ye,Le,Qe){wS=!1,NA=null,jSe.apply(HSe,arguments)}function $Se(f,y,A,F,Y,ne,ye,Le,Qe){if(WSe.apply(this,arguments),wS){if(wS){var Bt=NA;wS=!1,NA=null}else throw Error(m(198));DA||(DA=!0,EB=Bt)}}function x8(f){var y=f,A=f;if(f.alternate)for(;y.return;)y=y.return;else{f=y;do y=f,y.flags&4098&&(A=y.return),f=y.return;while(f)}return y.tag===3?A:null}function zhe(f){if(f.tag===13){var y=f.memoizedState;if(y===null&&(f=f.alternate,f!==null&&(y=f.memoizedState)),y!==null)return y.dehydrated}return null}function Vhe(f){if(x8(f)!==f)throw Error(m(188))}function qSe(f){var y=f.alternate;if(!y){if(y=x8(f),y===null)throw Error(m(188));return y!==f?null:f}for(var A=f,F=y;;){var Y=A.return;if(Y===null)break;var ne=Y.alternate;if(ne===null){if(F=Y.return,F!==null){A=F;continue}break}if(Y.child===ne.child){for(ne=Y.child;ne;){if(ne===A)return Vhe(Y),f;if(ne===F)return Vhe(Y),y;ne=ne.sibling}throw Error(m(188))}if(A.return!==F.return)A=Y,F=ne;else{for(var ye=!1,Le=Y.child;Le;){if(Le===A){ye=!0,A=Y,F=ne;break}if(Le===F){ye=!0,F=Y,A=ne;break}Le=Le.sibling}if(!ye){for(Le=ne.child;Le;){if(Le===A){ye=!0,A=ne,F=Y;break}if(Le===F){ye=!0,F=ne,A=Y;break}Le=Le.sibling}if(!ye)throw Error(m(189))}}if(A.alternate!==F)throw Error(m(190))}if(A.tag!==3)throw Error(m(188));return A.stateNode.current===A?f:y}function Ghe(f){return f=qSe(f),f!==null?jhe(f):null}function jhe(f){if(f.tag===5||f.tag===6)return f;for(f=f.child;f!==null;){var y=jhe(f);if(y!==null)return y;f=f.sibling}return null}var Hhe=u.unstable_scheduleCallback,Whe=u.unstable_cancelCallback,XSe=u.unstable_shouldYield,YSe=u.unstable_requestPaint,Uo=u.unstable_now,KSe=u.unstable_getCurrentPriorityLevel,TB=u.unstable_ImmediatePriority,$he=u.unstable_UserBlockingPriority,OA=u.unstable_NormalPriority,ZSe=u.unstable_LowPriority,qhe=u.unstable_IdlePriority,FA=null,Op=null;function QSe(f){if(Op&&typeof Op.onCommitFiberRoot=="function")try{Op.onCommitFiberRoot(FA,f,void 0,(f.current.flags&128)===128)}catch{}}var Ud=Math.clz32?Math.clz32:twe,JSe=Math.log,ewe=Math.LN2;function twe(f){return f>>>=0,f===0?32:31-(JSe(f)/ewe|0)|0}var LA=64,BA=4194304;function ES(f){switch(f&-f){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return f&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return f}}function UA(f,y){var A=f.pendingLanes;if(A===0)return 0;var F=0,Y=f.suspendedLanes,ne=f.pingedLanes,ye=A&268435455;if(ye!==0){var Le=ye&~Y;Le!==0?F=ES(Le):(ne&=ye,ne!==0&&(F=ES(ne)))}else ye=A&~Y,ye!==0?F=ES(ye):ne!==0&&(F=ES(ne));if(F===0)return 0;if(y!==0&&y!==F&&!(y&Y)&&(Y=F&-F,ne=y&-y,Y>=ne||Y===16&&(ne&4194240)!==0))return y;if(F&4&&(F|=A&16),y=f.entangledLanes,y!==0)for(f=f.entanglements,y&=F;0<y;)A=31-Ud(y),Y=1<<A,F|=f[A],y&=~Y;return F}function nwe(f,y){switch(f){case 1:case 2:case 4:return y+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return y+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function rwe(f,y){for(var A=f.suspendedLanes,F=f.pingedLanes,Y=f.expirationTimes,ne=f.pendingLanes;0<ne;){var ye=31-Ud(ne),Le=1<<ye,Qe=Y[ye];Qe===-1?(!(Le&A)||Le&F)&&(Y[ye]=nwe(Le,y)):Qe<=y&&(f.expiredLanes|=Le),ne&=~Le}}function MB(f){return f=f.pendingLanes&-1073741825,f!==0?f:f&1073741824?1073741824:0}function Xhe(){var f=LA;return LA<<=1,!(LA&4194240)&&(LA=64),f}function CB(f){for(var y=[],A=0;31>A;A++)y.push(f);return y}function TS(f,y,A){f.pendingLanes|=y,y!==536870912&&(f.suspendedLanes=0,f.pingedLanes=0),f=f.eventTimes,y=31-Ud(y),f[y]=A}function iwe(f,y){var A=f.pendingLanes&~y;f.pendingLanes=y,f.suspendedLanes=0,f.pingedLanes=0,f.expiredLanes&=y,f.mutableReadLanes&=y,f.entangledLanes&=y,y=f.entanglements;var F=f.eventTimes;for(f=f.expirationTimes;0<A;){var Y=31-Ud(A),ne=1<<Y;y[Y]=0,F[Y]=-1,f[Y]=-1,A&=~ne}}function AB(f,y){var A=f.entangledLanes|=y;for(f=f.entanglements;A;){var F=31-Ud(A),Y=1<<F;Y&y|f[F]&y&&(f[F]|=y),A&=~Y}}var us=0;function Yhe(f){return f&=-f,1<f?4<f?f&268435455?16:536870912:4:1}var Khe,PB,Zhe,Qhe,Jhe,RB=!1,zA=[],e3=null,t3=null,n3=null,MS=new Map,CS=new Map,r3=[],swe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ede(f,y){switch(f){case"focusin":case"focusout":e3=null;break;case"dragenter":case"dragleave":t3=null;break;case"mouseover":case"mouseout":n3=null;break;case"pointerover":case"pointerout":MS.delete(y.pointerId);break;case"gotpointercapture":case"lostpointercapture":CS.delete(y.pointerId)}}function AS(f,y,A,F,Y,ne){return f===null||f.nativeEvent!==ne?(f={blockedOn:y,domEventName:A,eventSystemFlags:F,nativeEvent:ne,targetContainers:[Y]},y!==null&&(y=GS(y),y!==null&&PB(y)),f):(f.eventSystemFlags|=F,y=f.targetContainers,Y!==null&&y.indexOf(Y)===-1&&y.push(Y),f)}function owe(f,y,A,F,Y){switch(y){case"focusin":return e3=AS(e3,f,y,A,F,Y),!0;case"dragenter":return t3=AS(t3,f,y,A,F,Y),!0;case"mouseover":return n3=AS(n3,f,y,A,F,Y),!0;case"pointerover":var ne=Y.pointerId;return MS.set(ne,AS(MS.get(ne)||null,f,y,A,F,Y)),!0;case"gotpointercapture":return ne=Y.pointerId,CS.set(ne,AS(CS.get(ne)||null,f,y,A,F,Y)),!0}return!1}function tde(f){var y=b8(f.target);if(y!==null){var A=x8(y);if(A!==null){if(y=A.tag,y===13){if(y=zhe(A),y!==null){f.blockedOn=y,Jhe(f.priority,function(){Zhe(A)});return}}else if(y===3&&A.stateNode.current.memoizedState.isDehydrated){f.blockedOn=A.tag===3?A.stateNode.containerInfo:null;return}}}f.blockedOn=null}function VA(f){if(f.blockedOn!==null)return!1;for(var y=f.targetContainers;0<y.length;){var A=IB(f.domEventName,f.eventSystemFlags,y[0],f.nativeEvent);if(A===null){A=f.nativeEvent;var F=new A.constructor(A.type,A);xS=F,A.target.dispatchEvent(F),xS=null}else return y=GS(A),y!==null&&PB(y),f.blockedOn=A,!1;y.shift()}return!0}function nde(f,y,A){VA(f)&&A.delete(y)}function awe(){RB=!1,e3!==null&&VA(e3)&&(e3=null),t3!==null&&VA(t3)&&(t3=null),n3!==null&&VA(n3)&&(n3=null),MS.forEach(nde),CS.forEach(nde)}function PS(f,y){f.blockedOn===y&&(f.blockedOn=null,RB||(RB=!0,u.unstable_scheduleCallback(u.unstable_NormalPriority,awe)))}function RS(f){function y(Y){return PS(Y,f)}if(0<zA.length){PS(zA[0],f);for(var A=1;A<zA.length;A++){var F=zA[A];F.blockedOn===f&&(F.blockedOn=null)}}for(e3!==null&&PS(e3,f),t3!==null&&PS(t3,f),n3!==null&&PS(n3,f),MS.forEach(y),CS.forEach(y),A=0;A<r3.length;A++)F=r3[A],F.blockedOn===f&&(F.blockedOn=null);for(;0<r3.length&&(A=r3[0],A.blockedOn===null);)tde(A),A.blockedOn===null&&r3.shift()}var Zv=fe.ReactCurrentBatchConfig,GA=!0;function lwe(f,y,A,F){var Y=us,ne=Zv.transition;Zv.transition=null;try{us=1,kB(f,y,A,F)}finally{us=Y,Zv.transition=ne}}function cwe(f,y,A,F){var Y=us,ne=Zv.transition;Zv.transition=null;try{us=4,kB(f,y,A,F)}finally{us=Y,Zv.transition=ne}}function kB(f,y,A,F){if(GA){var Y=IB(f,y,A,F);if(Y===null)qB(f,y,F,jA,A),ede(f,F);else if(owe(Y,f,y,A,F))F.stopPropagation();else if(ede(f,F),y&4&&-1<swe.indexOf(f)){for(;Y!==null;){var ne=GS(Y);if(ne!==null&&Khe(ne),ne=IB(f,y,A,F),ne===null&&qB(f,y,F,jA,A),ne===Y)break;Y=ne}Y!==null&&F.stopPropagation()}else qB(f,y,F,null,A)}}var jA=null;function IB(f,y,A,F){if(jA=null,f=bS(F),f=b8(f),f!==null)if(y=x8(f),y===null)f=null;else if(A=y.tag,A===13){if(f=zhe(y),f!==null)return f;f=null}else if(A===3){if(y.stateNode.current.memoizedState.isDehydrated)return y.tag===3?y.stateNode.containerInfo:null;f=null}else y!==f&&(f=null);return jA=f,null}function rde(f){switch(f){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(KSe()){case TB:return 1;case $he:return 4;case OA:case ZSe:return 16;case qhe:return 536870912;default:return 16}default:return 16}}var i3=null,NB=null,HA=null;function ide(){if(HA)return HA;var f,y=NB,A=y.length,F,Y="value"in i3?i3.value:i3.textContent,ne=Y.length;for(f=0;f<A&&y[f]===Y[f];f++);var ye=A-f;for(F=1;F<=ye&&y[A-F]===Y[ne-F];F++);return HA=Y.slice(f,1<F?1-F:void 0)}function WA(f){var y=f.keyCode;return"charCode"in f?(f=f.charCode,f===0&&y===13&&(f=13)):f=y,f===10&&(f=13),32<=f||f===13?f:0}function $A(){return!0}function sde(){return!1}function lu(f){function y(A,F,Y,ne,ye){this._reactName=A,this._targetInst=Y,this.type=F,this.nativeEvent=ne,this.target=ye,this.currentTarget=null;for(var Le in f)f.hasOwnProperty(Le)&&(A=f[Le],this[Le]=A?A(ne):ne[Le]);return this.isDefaultPrevented=(ne.defaultPrevented!=null?ne.defaultPrevented:ne.returnValue===!1)?$A:sde,this.isPropagationStopped=sde,this}return be(y.prototype,{preventDefault:function(){this.defaultPrevented=!0;var A=this.nativeEvent;A&&(A.preventDefault?A.preventDefault():typeof A.returnValue!="unknown"&&(A.returnValue=!1),this.isDefaultPrevented=$A)},stopPropagation:function(){var A=this.nativeEvent;A&&(A.stopPropagation?A.stopPropagation():typeof A.cancelBubble!="unknown"&&(A.cancelBubble=!0),this.isPropagationStopped=$A)},persist:function(){},isPersistent:$A}),y}var Qv={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(f){return f.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},DB=lu(Qv),kS=be({},Qv,{view:0,detail:0}),uwe=lu(kS),OB,FB,IS,qA=be({},kS,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:BB,button:0,buttons:0,relatedTarget:function(f){return f.relatedTarget===void 0?f.fromElement===f.srcElement?f.toElement:f.fromElement:f.relatedTarget},movementX:function(f){return"movementX"in f?f.movementX:(f!==IS&&(IS&&f.type==="mousemove"?(OB=f.screenX-IS.screenX,FB=f.screenY-IS.screenY):FB=OB=0,IS=f),OB)},movementY:function(f){return"movementY"in f?f.movementY:FB}}),ode=lu(qA),hwe=be({},qA,{dataTransfer:0}),dwe=lu(hwe),fwe=be({},kS,{relatedTarget:0}),LB=lu(fwe),pwe=be({},Qv,{animationName:0,elapsedTime:0,pseudoElement:0}),mwe=lu(pwe),gwe=be({},Qv,{clipboardData:function(f){return"clipboardData"in f?f.clipboardData:window.clipboardData}}),ywe=lu(gwe),vwe=be({},Qv,{data:0}),ade=lu(vwe),_we={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xwe={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},bwe={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Swe(f){var y=this.nativeEvent;return y.getModifierState?y.getModifierState(f):(f=bwe[f])?!!y[f]:!1}function BB(){return Swe}var wwe=be({},kS,{key:function(f){if(f.key){var y=_we[f.key]||f.key;if(y!=="Unidentified")return y}return f.type==="keypress"?(f=WA(f),f===13?"Enter":String.fromCharCode(f)):f.type==="keydown"||f.type==="keyup"?xwe[f.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:BB,charCode:function(f){return f.type==="keypress"?WA(f):0},keyCode:function(f){return f.type==="keydown"||f.type==="keyup"?f.keyCode:0},which:function(f){return f.type==="keypress"?WA(f):f.type==="keydown"||f.type==="keyup"?f.keyCode:0}}),Ewe=lu(wwe),Twe=be({},qA,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),lde=lu(Twe),Mwe=be({},kS,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:BB}),Cwe=lu(Mwe),Awe=be({},Qv,{propertyName:0,elapsedTime:0,pseudoElement:0}),Pwe=lu(Awe),Rwe=be({},qA,{deltaX:function(f){return"deltaX"in f?f.deltaX:"wheelDeltaX"in f?-f.wheelDeltaX:0},deltaY:function(f){return"deltaY"in f?f.deltaY:"wheelDeltaY"in f?-f.wheelDeltaY:"wheelDelta"in f?-f.wheelDelta:0},deltaZ:0,deltaMode:0}),kwe=lu(Rwe),Iwe=[9,13,27,32],UB=P&&"CompositionEvent"in window,NS=null;P&&"documentMode"in document&&(NS=document.documentMode);var Nwe=P&&"TextEvent"in window&&!NS,cde=P&&(!UB||NS&&8<NS&&11>=NS),ude=" ",hde=!1;function dde(f,y){switch(f){case"keyup":return Iwe.indexOf(y.keyCode)!==-1;case"keydown":return y.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function fde(f){return f=f.detail,typeof f=="object"&&"data"in f?f.data:null}var Jv=!1;function Dwe(f,y){switch(f){case"compositionend":return fde(y);case"keypress":return y.which!==32?null:(hde=!0,ude);case"textInput":return f=y.data,f===ude&&hde?null:f;default:return null}}function Owe(f,y){if(Jv)return f==="compositionend"||!UB&&dde(f,y)?(f=ide(),HA=NB=i3=null,Jv=!1,f):null;switch(f){case"paste":return null;case"keypress":if(!(y.ctrlKey||y.altKey||y.metaKey)||y.ctrlKey&&y.altKey){if(y.char&&1<y.char.length)return y.char;if(y.which)return String.fromCharCode(y.which)}return null;case"compositionend":return cde&&y.locale!=="ko"?null:y.data;default:return null}}var Fwe={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function pde(f){var y=f&&f.nodeName&&f.nodeName.toLowerCase();return y==="input"?!!Fwe[f.type]:y==="textarea"}function mde(f,y,A,F){Ohe(F),y=tP(y,"onChange"),0<y.length&&(A=new DB("onChange","change",null,A,F),f.push({event:A,listeners:y}))}var DS=null,OS=null;function Lwe(f){Dde(f,0)}function XA(f){var y=i7(f);if(ji(y))return f}function Bwe(f,y){if(f==="change")return y}var gde=!1;P&&(P?(YA="oninput"in document,YA||(VB=document.createElement("div"),VB.setAttribute("oninput","return;"),YA=typeof VB.oninput=="function"),zB=YA):zB=!1,gde=zB&&(!document.documentMode||9<document.documentMode));var zB,YA,VB;function yde(){DS&&(DS.detachEvent("onpropertychange",vde),OS=DS=null)}function vde(f){if(f.propertyName==="value"&&XA(OS)){var y=[];mde(y,OS,f,bS(f)),Uhe(Lwe,y)}}function Uwe(f,y,A){f==="focusin"?(yde(),DS=y,OS=A,DS.attachEvent("onpropertychange",vde)):f==="focusout"&&yde()}function zwe(f){if(f==="selectionchange"||f==="keyup"||f==="keydown")return XA(OS)}function Vwe(f,y){if(f==="click")return XA(y)}function Gwe(f,y){if(f==="input"||f==="change")return XA(y)}function jwe(f,y){return f===y&&(f!==0||1/f===1/y)||f!==f&&y!==y}var zd=typeof Object.is=="function"?Object.is:jwe;function FS(f,y){if(zd(f,y))return!0;if(typeof f!="object"||f===null||typeof y!="object"||y===null)return!1;var A=Object.keys(f),F=Object.keys(y);if(A.length!==F.length)return!1;for(F=0;F<A.length;F++){var Y=A[F];if(!N.call(y,Y)||!zd(f[Y],y[Y]))return!1}return!0}function _de(f){for(;f&&f.firstChild;)f=f.firstChild;return f}function xde(f,y){var A=_de(f);f=0;for(var F;A;){if(A.nodeType===3){if(F=f+A.textContent.length,f<=y&&F>=y)return{node:A,offset:y-f};f=F}e:{for(;A;){if(A.nextSibling){A=A.nextSibling;break e}A=A.parentNode}A=void 0}A=_de(A)}}function bde(f,y){return f&&y?f===y?!0:f&&f.nodeType===3?!1:y&&y.nodeType===3?bde(f,y.parentNode):"contains"in f?f.contains(y):f.compareDocumentPosition?!!(f.compareDocumentPosition(y)&16):!1:!1}function Sde(){for(var f=window,y=he();y instanceof f.HTMLIFrameElement;){try{var A=typeof y.contentWindow.location.href=="string"}catch{A=!1}if(A)f=y.contentWindow;else break;y=he(f.document)}return y}function GB(f){var y=f&&f.nodeName&&f.nodeName.toLowerCase();return y&&(y==="input"&&(f.type==="text"||f.type==="search"||f.type==="tel"||f.type==="url"||f.type==="password")||y==="textarea"||f.contentEditable==="true")}function Hwe(f){var y=Sde(),A=f.focusedElem,F=f.selectionRange;if(y!==A&&A&&A.ownerDocument&&bde(A.ownerDocument.documentElement,A)){if(F!==null&&GB(A)){if(y=F.start,f=F.end,f===void 0&&(f=y),"selectionStart"in A)A.selectionStart=y,A.selectionEnd=Math.min(f,A.value.length);else if(f=(y=A.ownerDocument||document)&&y.defaultView||window,f.getSelection){f=f.getSelection();var Y=A.textContent.length,ne=Math.min(F.start,Y);F=F.end===void 0?ne:Math.min(F.end,Y),!f.extend&&ne>F&&(Y=F,F=ne,ne=Y),Y=xde(A,ne);var ye=xde(A,F);Y&&ye&&(f.rangeCount!==1||f.anchorNode!==Y.node||f.anchorOffset!==Y.offset||f.focusNode!==ye.node||f.focusOffset!==ye.offset)&&(y=y.createRange(),y.setStart(Y.node,Y.offset),f.removeAllRanges(),ne>F?(f.addRange(y),f.extend(ye.node,ye.offset)):(y.setEnd(ye.node,ye.offset),f.addRange(y)))}}for(y=[],f=A;f=f.parentNode;)f.nodeType===1&&y.push({element:f,left:f.scrollLeft,top:f.scrollTop});for(typeof A.focus=="function"&&A.focus(),A=0;A<y.length;A++)f=y[A],f.element.scrollLeft=f.left,f.element.scrollTop=f.top}}var Wwe=P&&"documentMode"in document&&11>=document.documentMode,e7=null,jB=null,LS=null,HB=!1;function wde(f,y,A){var F=A.window===A?A.document:A.nodeType===9?A:A.ownerDocument;HB||e7==null||e7!==he(F)||(F=e7,"selectionStart"in F&&GB(F)?F={start:F.selectionStart,end:F.selectionEnd}:(F=(F.ownerDocument&&F.ownerDocument.defaultView||window).getSelection(),F={anchorNode:F.anchorNode,anchorOffset:F.anchorOffset,focusNode:F.focusNode,focusOffset:F.focusOffset}),LS&&FS(LS,F)||(LS=F,F=tP(jB,"onSelect"),0<F.length&&(y=new DB("onSelect","select",null,y,A),f.push({event:y,listeners:F}),y.target=e7)))}function KA(f,y){var A={};return A[f.toLowerCase()]=y.toLowerCase(),A["Webkit"+f]="webkit"+y,A["Moz"+f]="moz"+y,A}var t7={animationend:KA("Animation","AnimationEnd"),animationiteration:KA("Animation","AnimationIteration"),animationstart:KA("Animation","AnimationStart"),transitionend:KA("Transition","TransitionEnd")},WB={},Ede={};P&&(Ede=document.createElement("div").style,"AnimationEvent"in window||(delete t7.animationend.animation,delete t7.animationiteration.animation,delete t7.animationstart.animation),"TransitionEvent"in window||delete t7.transitionend.transition);function ZA(f){if(WB[f])return WB[f];if(!t7[f])return f;var y=t7[f],A;for(A in y)if(y.hasOwnProperty(A)&&A in Ede)return WB[f]=y[A];return f}var Tde=ZA("animationend"),Mde=ZA("animationiteration"),Cde=ZA("animationstart"),Ade=ZA("transitionend"),Pde=new Map,Rde="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function s3(f,y){Pde.set(f,y),E(y,[f])}for(JA=0;JA<Rde.length;JA++)QA=Rde[JA],kde=QA.toLowerCase(),Ide=QA[0].toUpperCase()+QA.slice(1),s3(kde,"on"+Ide);var QA,kde,Ide,JA;s3(Tde,"onAnimationEnd"),s3(Mde,"onAnimationIteration"),s3(Cde,"onAnimationStart"),s3("dblclick","onDoubleClick"),s3("focusin","onFocus"),s3("focusout","onBlur"),s3(Ade,"onTransitionEnd"),T("onMouseEnter",["mouseout","mouseover"]),T("onMouseLeave",["mouseout","mouseover"]),T("onPointerEnter",["pointerout","pointerover"]),T("onPointerLeave",["pointerout","pointerover"]),E("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),E("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),E("onBeforeInput",["compositionend","keypress","textInput","paste"]),E("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),E("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),E("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var BS="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$we=new Set("cancel close invalid load scroll toggle".split(" ").concat(BS));function Nde(f,y,A){var F=f.type||"unknown-event";f.currentTarget=A,$Se(F,y,void 0,f),f.currentTarget=null}function Dde(f,y){y=(y&4)!==0;for(var A=0;A<f.length;A++){var F=f[A],Y=F.event;F=F.listeners;e:{var ne=void 0;if(y)for(var ye=F.length-1;0<=ye;ye--){var Le=F[ye],Qe=Le.instance,Bt=Le.currentTarget;if(Le=Le.listener,Qe!==ne&&Y.isPropagationStopped())break e;Nde(Y,Le,Bt),ne=Qe}else for(ye=0;ye<F.length;ye++){if(Le=F[ye],Qe=Le.instance,Bt=Le.currentTarget,Le=Le.listener,Qe!==ne&&Y.isPropagationStopped())break e;Nde(Y,Le,Bt),ne=Qe}}}if(DA)throw f=EB,DA=!1,EB=null,f}function Ys(f,y){var A=y[JB];A===void 0&&(A=y[JB]=new Set);var F=f+"__bubble";A.has(F)||(Ode(y,f,2,!1),A.add(F))}function $B(f,y,A){var F=0;y&&(F|=4),Ode(A,f,F,y)}var eP="_reactListening"+Math.random().toString(36).slice(2);function US(f){if(!f[eP]){f[eP]=!0,_.forEach(function(A){A!=="selectionchange"&&($we.has(A)||$B(A,!1,f),$B(A,!0,f))});var y=f.nodeType===9?f:f.ownerDocument;y===null||y[eP]||(y[eP]=!0,$B("selectionchange",!1,y))}}function Ode(f,y,A,F){switch(rde(y)){case 1:var Y=lwe;break;case 4:Y=cwe;break;default:Y=kB}A=Y.bind(null,y,A,f),Y=void 0,!wB||y!=="touchstart"&&y!=="touchmove"&&y!=="wheel"||(Y=!0),F?Y!==void 0?f.addEventListener(y,A,{capture:!0,passive:Y}):f.addEventListener(y,A,!0):Y!==void 0?f.addEventListener(y,A,{passive:Y}):f.addEventListener(y,A,!1)}function qB(f,y,A,F,Y){var ne=F;if(!(y&1)&&!(y&2)&&F!==null)e:for(;;){if(F===null)return;var ye=F.tag;if(ye===3||ye===4){var Le=F.stateNode.containerInfo;if(Le===Y||Le.nodeType===8&&Le.parentNode===Y)break;if(ye===4)for(ye=F.return;ye!==null;){var Qe=ye.tag;if((Qe===3||Qe===4)&&(Qe=ye.stateNode.containerInfo,Qe===Y||Qe.nodeType===8&&Qe.parentNode===Y))return;ye=ye.return}for(;Le!==null;){if(ye=b8(Le),ye===null)return;if(Qe=ye.tag,Qe===5||Qe===6){F=ne=ye;continue e}Le=Le.parentNode}}F=F.return}Uhe(function(){var Bt=ne,_n=bS(A),Sn=[];e:{var pn=Pde.get(f);if(pn!==void 0){var Qn=DB,hr=f;switch(f){case"keypress":if(WA(A)===0)break e;case"keydown":case"keyup":Qn=Ewe;break;case"focusin":hr="focus",Qn=LB;break;case"focusout":hr="blur",Qn=LB;break;case"beforeblur":case"afterblur":Qn=LB;break;case"click":if(A.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Qn=ode;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Qn=dwe;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Qn=Cwe;break;case Tde:case Mde:case Cde:Qn=mwe;break;case Ade:Qn=Pwe;break;case"scroll":Qn=uwe;break;case"wheel":Qn=kwe;break;case"copy":case"cut":case"paste":Qn=ywe;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Qn=lde}var pr=(y&4)!==0,zo=!pr&&f==="scroll",Et=pr?pn!==null?pn+"Capture":null:pn;pr=[];for(var it=Bt,Rt;it!==null;){Rt=it;var Cn=Rt.stateNode;if(Rt.tag===5&&Cn!==null&&(Rt=Cn,Et!==null&&(Cn=SS(it,Et),Cn!=null&&pr.push(zS(it,Cn,Rt)))),zo)break;it=it.return}0<pr.length&&(pn=new Qn(pn,hr,null,A,_n),Sn.push({event:pn,listeners:pr}))}}if(!(y&7)){e:{if(pn=f==="mouseover"||f==="pointerover",Qn=f==="mouseout"||f==="pointerout",pn&&A!==xS&&(hr=A.relatedTarget||A.fromElement)&&(b8(hr)||hr[qm]))break e;if((Qn||pn)&&(pn=_n.window===_n?_n:(pn=_n.ownerDocument)?pn.defaultView||pn.parentWindow:window,Qn?(hr=A.relatedTarget||A.toElement,Qn=Bt,hr=hr?b8(hr):null,hr!==null&&(zo=x8(hr),hr!==zo||hr.tag!==5&&hr.tag!==6)&&(hr=null)):(Qn=null,hr=Bt),Qn!==hr)){if(pr=ode,Cn="onMouseLeave",Et="onMouseEnter",it="mouse",(f==="pointerout"||f==="pointerover")&&(pr=lde,Cn="onPointerLeave",Et="onPointerEnter",it="pointer"),zo=Qn==null?pn:i7(Qn),Rt=hr==null?pn:i7(hr),pn=new pr(Cn,it+"leave",Qn,A,_n),pn.target=zo,pn.relatedTarget=Rt,Cn=null,b8(_n)===Bt&&(pr=new pr(Et,it+"enter",hr,A,_n),pr.target=Rt,pr.relatedTarget=zo,Cn=pr),zo=Cn,Qn&&hr)t:{for(pr=Qn,Et=hr,it=0,Rt=pr;Rt;Rt=n7(Rt))it++;for(Rt=0,Cn=Et;Cn;Cn=n7(Cn))Rt++;for(;0<it-Rt;)pr=n7(pr),it--;for(;0<Rt-it;)Et=n7(Et),Rt--;for(;it--;){if(pr===Et||Et!==null&&pr===Et.alternate)break t;pr=n7(pr),Et=n7(Et)}pr=null}else pr=null;Qn!==null&&Fde(Sn,pn,Qn,pr,!1),hr!==null&&zo!==null&&Fde(Sn,zo,hr,pr,!0)}}e:{if(pn=Bt?i7(Bt):window,Qn=pn.nodeName&&pn.nodeName.toLowerCase(),Qn==="select"||Qn==="input"&&pn.type==="file")var _r=Bwe;else if(pde(pn))if(gde)_r=Gwe;else{_r=zwe;var Ir=Uwe}else(Qn=pn.nodeName)&&Qn.toLowerCase()==="input"&&(pn.type==="checkbox"||pn.type==="radio")&&(_r=Vwe);if(_r&&(_r=_r(f,Bt))){mde(Sn,_r,A,_n);break e}Ir&&Ir(f,pn,Bt),f==="focusout"&&(Ir=pn._wrapperState)&&Ir.controlled&&pn.type==="number"&&Xt(pn,"number",pn.value)}switch(Ir=Bt?i7(Bt):window,f){case"focusin":(pde(Ir)||Ir.contentEditable==="true")&&(e7=Ir,jB=Bt,LS=null);break;case"focusout":LS=jB=e7=null;break;case"mousedown":HB=!0;break;case"contextmenu":case"mouseup":case"dragend":HB=!1,wde(Sn,A,_n);break;case"selectionchange":if(Wwe)break;case"keydown":case"keyup":wde(Sn,A,_n)}var Nr;if(UB)e:{switch(f){case"compositionstart":var Wr="onCompositionStart";break e;case"compositionend":Wr="onCompositionEnd";break e;case"compositionupdate":Wr="onCompositionUpdate";break e}Wr=void 0}else Jv?dde(f,A)&&(Wr="onCompositionEnd"):f==="keydown"&&A.keyCode===229&&(Wr="onCompositionStart");Wr&&(cde&&A.locale!=="ko"&&(Jv||Wr!=="onCompositionStart"?Wr==="onCompositionEnd"&&Jv&&(Nr=ide()):(i3=_n,NB="value"in i3?i3.value:i3.textContent,Jv=!0)),Ir=tP(Bt,Wr),0<Ir.length&&(Wr=new ade(Wr,f,null,A,_n),Sn.push({event:Wr,listeners:Ir}),Nr?Wr.data=Nr:(Nr=fde(A),Nr!==null&&(Wr.data=Nr)))),(Nr=Nwe?Dwe(f,A):Owe(f,A))&&(Bt=tP(Bt,"onBeforeInput"),0<Bt.length&&(_n=new ade("onBeforeInput","beforeinput",null,A,_n),Sn.push({event:_n,listeners:Bt}),_n.data=Nr))}Dde(Sn,y)})}function zS(f,y,A){return{instance:f,listener:y,currentTarget:A}}function tP(f,y){for(var A=y+"Capture",F=[];f!==null;){var Y=f,ne=Y.stateNode;Y.tag===5&&ne!==null&&(Y=ne,ne=SS(f,A),ne!=null&&F.unshift(zS(f,ne,Y)),ne=SS(f,y),ne!=null&&F.push(zS(f,ne,Y))),f=f.return}return F}function n7(f){if(f===null)return null;do f=f.return;while(f&&f.tag!==5);return f||null}function Fde(f,y,A,F,Y){for(var ne=y._reactName,ye=[];A!==null&&A!==F;){var Le=A,Qe=Le.alternate,Bt=Le.stateNode;if(Qe!==null&&Qe===F)break;Le.tag===5&&Bt!==null&&(Le=Bt,Y?(Qe=SS(A,ne),Qe!=null&&ye.unshift(zS(A,Qe,Le))):Y||(Qe=SS(A,ne),Qe!=null&&ye.push(zS(A,Qe,Le)))),A=A.return}ye.length!==0&&f.push({event:y,listeners:ye})}var qwe=/\r\n?/g,Xwe=/\u0000|\uFFFD/g;function Lde(f){return(typeof f=="string"?f:""+f).replace(qwe,`
`).replace(Xwe,"")}function nP(f,y,A){if(y=Lde(y),Lde(f)!==y&&A)throw Error(m(425))}function rP(){}var XB=null,YB=null;function KB(f,y){return f==="textarea"||f==="noscript"||typeof y.children=="string"||typeof y.children=="number"||typeof y.dangerouslySetInnerHTML=="object"&&y.dangerouslySetInnerHTML!==null&&y.dangerouslySetInnerHTML.__html!=null}var ZB=typeof setTimeout=="function"?setTimeout:void 0,Ywe=typeof clearTimeout=="function"?clearTimeout:void 0,Bde=typeof Promise=="function"?Promise:void 0,Kwe=typeof queueMicrotask=="function"?queueMicrotask:typeof Bde<"u"?function(f){return Bde.resolve(null).then(f).catch(Zwe)}:ZB;function Zwe(f){setTimeout(function(){throw f})}function QB(f,y){var A=y,F=0;do{var Y=A.nextSibling;if(f.removeChild(A),Y&&Y.nodeType===8)if(A=Y.data,A==="/$"){if(F===0){f.removeChild(Y),RS(y);return}F--}else A!=="$"&&A!=="$?"&&A!=="$!"||F++;A=Y}while(A);RS(y)}function o3(f){for(;f!=null;f=f.nextSibling){var y=f.nodeType;if(y===1||y===3)break;if(y===8){if(y=f.data,y==="$"||y==="$!"||y==="$?")break;if(y==="/$")return null}}return f}function Ude(f){f=f.previousSibling;for(var y=0;f;){if(f.nodeType===8){var A=f.data;if(A==="$"||A==="$!"||A==="$?"){if(y===0)return f;y--}else A==="/$"&&y++}f=f.previousSibling}return null}var r7=Math.random().toString(36).slice(2),Fp="__reactFiber$"+r7,VS="__reactProps$"+r7,qm="__reactContainer$"+r7,JB="__reactEvents$"+r7,Qwe="__reactListeners$"+r7,Jwe="__reactHandles$"+r7;function b8(f){var y=f[Fp];if(y)return y;for(var A=f.parentNode;A;){if(y=A[qm]||A[Fp]){if(A=y.alternate,y.child!==null||A!==null&&A.child!==null)for(f=Ude(f);f!==null;){if(A=f[Fp])return A;f=Ude(f)}return y}f=A,A=f.parentNode}return null}function GS(f){return f=f[Fp]||f[qm],!f||f.tag!==5&&f.tag!==6&&f.tag!==13&&f.tag!==3?null:f}function i7(f){if(f.tag===5||f.tag===6)return f.stateNode;throw Error(m(33))}function iP(f){return f[VS]||null}var eU=[],s7=-1;function a3(f){return{current:f}}function Ks(f){0>s7||(f.current=eU[s7],eU[s7]=null,s7--)}function Ns(f,y){s7++,eU[s7]=f.current,f.current=y}var l3={},P0=a3(l3),uc=a3(!1),S8=l3;function o7(f,y){var A=f.type.contextTypes;if(!A)return l3;var F=f.stateNode;if(F&&F.__reactInternalMemoizedUnmaskedChildContext===y)return F.__reactInternalMemoizedMaskedChildContext;var Y={},ne;for(ne in A)Y[ne]=y[ne];return F&&(f=f.stateNode,f.__reactInternalMemoizedUnmaskedChildContext=y,f.__reactInternalMemoizedMaskedChildContext=Y),Y}function hc(f){return f=f.childContextTypes,f!=null}function sP(){Ks(uc),Ks(P0)}function zde(f,y,A){if(P0.current!==l3)throw Error(m(168));Ns(P0,y),Ns(uc,A)}function Vde(f,y,A){var F=f.stateNode;if(y=y.childContextTypes,typeof F.getChildContext!="function")return A;F=F.getChildContext();for(var Y in F)if(!(Y in y))throw Error(m(108,Vt(f)||"Unknown",Y));return be({},A,F)}function oP(f){return f=(f=f.stateNode)&&f.__reactInternalMemoizedMergedChildContext||l3,S8=P0.current,Ns(P0,f),Ns(uc,uc.current),!0}function Gde(f,y,A){var F=f.stateNode;if(!F)throw Error(m(169));A?(f=Vde(f,y,S8),F.__reactInternalMemoizedMergedChildContext=f,Ks(uc),Ks(P0),Ns(P0,f)):Ks(uc),Ns(uc,A)}var Xm=null,aP=!1,tU=!1;function jde(f){Xm===null?Xm=[f]:Xm.push(f)}function eEe(f){aP=!0,jde(f)}function c3(){if(!tU&&Xm!==null){tU=!0;var f=0,y=us;try{var A=Xm;for(us=1;f<A.length;f++){var F=A[f];do F=F(!0);while(F!==null)}Xm=null,aP=!1}catch(Y){throw Xm!==null&&(Xm=Xm.slice(f+1)),Hhe(TB,c3),Y}finally{us=y,tU=!1}}return null}var a7=[],l7=0,lP=null,cP=0,dh=[],fh=0,w8=null,Ym=1,Km="";function E8(f,y){a7[l7++]=cP,a7[l7++]=lP,lP=f,cP=y}function Hde(f,y,A){dh[fh++]=Ym,dh[fh++]=Km,dh[fh++]=w8,w8=f;var F=Ym;f=Km;var Y=32-Ud(F)-1;F&=~(1<<Y),A+=1;var ne=32-Ud(y)+Y;if(30<ne){var ye=Y-Y%5;ne=(F&(1<<ye)-1).toString(32),F>>=ye,Y-=ye,Ym=1<<32-Ud(y)+Y|A<<Y|F,Km=ne+f}else Ym=1<<ne|A<<Y|F,Km=f}function nU(f){f.return!==null&&(E8(f,1),Hde(f,1,0))}function rU(f){for(;f===lP;)lP=a7[--l7],a7[l7]=null,cP=a7[--l7],a7[l7]=null;for(;f===w8;)w8=dh[--fh],dh[fh]=null,Km=dh[--fh],dh[fh]=null,Ym=dh[--fh],dh[fh]=null}var cu=null,uu=null,no=!1,Vd=null;function Wde(f,y){var A=yh(5,null,null,0);A.elementType="DELETED",A.stateNode=y,A.return=f,y=f.deletions,y===null?(f.deletions=[A],f.flags|=16):y.push(A)}function $de(f,y){switch(f.tag){case 5:var A=f.type;return y=y.nodeType!==1||A.toLowerCase()!==y.nodeName.toLowerCase()?null:y,y!==null?(f.stateNode=y,cu=f,uu=o3(y.firstChild),!0):!1;case 6:return y=f.pendingProps===""||y.nodeType!==3?null:y,y!==null?(f.stateNode=y,cu=f,uu=null,!0):!1;case 13:return y=y.nodeType!==8?null:y,y!==null?(A=w8!==null?{id:Ym,overflow:Km}:null,f.memoizedState={dehydrated:y,treeContext:A,retryLane:1073741824},A=yh(18,null,null,0),A.stateNode=y,A.return=f,f.child=A,cu=f,uu=null,!0):!1;default:return!1}}function iU(f){return(f.mode&1)!==0&&(f.flags&128)===0}function sU(f){if(no){var y=uu;if(y){var A=y;if(!$de(f,y)){if(iU(f))throw Error(m(418));y=o3(A.nextSibling);var F=cu;y&&$de(f,y)?Wde(F,A):(f.flags=f.flags&-4097|2,no=!1,cu=f)}}else{if(iU(f))throw Error(m(418));f.flags=f.flags&-4097|2,no=!1,cu=f}}}function qde(f){for(f=f.return;f!==null&&f.tag!==5&&f.tag!==3&&f.tag!==13;)f=f.return;cu=f}function uP(f){if(f!==cu)return!1;if(!no)return qde(f),no=!0,!1;var y;if((y=f.tag!==3)&&!(y=f.tag!==5)&&(y=f.type,y=y!=="head"&&y!=="body"&&!KB(f.type,f.memoizedProps)),y&&(y=uu)){if(iU(f))throw Xde(),Error(m(418));for(;y;)Wde(f,y),y=o3(y.nextSibling)}if(qde(f),f.tag===13){if(f=f.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(m(317));e:{for(f=f.nextSibling,y=0;f;){if(f.nodeType===8){var A=f.data;if(A==="/$"){if(y===0){uu=o3(f.nextSibling);break e}y--}else A!=="$"&&A!=="$!"&&A!=="$?"||y++}f=f.nextSibling}uu=null}}else uu=cu?o3(f.stateNode.nextSibling):null;return!0}function Xde(){for(var f=uu;f;)f=o3(f.nextSibling)}function c7(){uu=cu=null,no=!1}function oU(f){Vd===null?Vd=[f]:Vd.push(f)}var tEe=fe.ReactCurrentBatchConfig;function Gd(f,y){if(f&&f.defaultProps){y=be({},y),f=f.defaultProps;for(var A in f)y[A]===void 0&&(y[A]=f[A]);return y}return y}var hP=a3(null),dP=null,u7=null,aU=null;function lU(){aU=u7=dP=null}function cU(f){var y=hP.current;Ks(hP),f._currentValue=y}function uU(f,y,A){for(;f!==null;){var F=f.alternate;if((f.childLanes&y)!==y?(f.childLanes|=y,F!==null&&(F.childLanes|=y)):F!==null&&(F.childLanes&y)!==y&&(F.childLanes|=y),f===A)break;f=f.return}}function h7(f,y){dP=f,aU=u7=null,f=f.dependencies,f!==null&&f.firstContext!==null&&(f.lanes&y&&(dc=!0),f.firstContext=null)}function ph(f){var y=f._currentValue;if(aU!==f)if(f={context:f,memoizedValue:y,next:null},u7===null){if(dP===null)throw Error(m(308));u7=f,dP.dependencies={lanes:0,firstContext:f}}else u7=u7.next=f;return y}var T8=null;function hU(f){T8===null?T8=[f]:T8.push(f)}function Yde(f,y,A,F){var Y=y.interleaved;return Y===null?(A.next=A,hU(y)):(A.next=Y.next,Y.next=A),y.interleaved=A,Zm(f,F)}function Zm(f,y){f.lanes|=y;var A=f.alternate;for(A!==null&&(A.lanes|=y),A=f,f=f.return;f!==null;)f.childLanes|=y,A=f.alternate,A!==null&&(A.childLanes|=y),A=f,f=f.return;return A.tag===3?A.stateNode:null}var u3=!1;function dU(f){f.updateQueue={baseState:f.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Kde(f,y){f=f.updateQueue,y.updateQueue===f&&(y.updateQueue={baseState:f.baseState,firstBaseUpdate:f.firstBaseUpdate,lastBaseUpdate:f.lastBaseUpdate,shared:f.shared,effects:f.effects})}function Qm(f,y){return{eventTime:f,lane:y,tag:0,payload:null,callback:null,next:null}}function h3(f,y,A){var F=f.updateQueue;if(F===null)return null;if(F=F.shared,Ui&2){var Y=F.pending;return Y===null?y.next=y:(y.next=Y.next,Y.next=y),F.pending=y,Zm(f,A)}return Y=F.interleaved,Y===null?(y.next=y,hU(F)):(y.next=Y.next,Y.next=y),F.interleaved=y,Zm(f,A)}function fP(f,y,A){if(y=y.updateQueue,y!==null&&(y=y.shared,(A&4194240)!==0)){var F=y.lanes;F&=f.pendingLanes,A|=F,y.lanes=A,AB(f,A)}}function Zde(f,y){var A=f.updateQueue,F=f.alternate;if(F!==null&&(F=F.updateQueue,A===F)){var Y=null,ne=null;if(A=A.firstBaseUpdate,A!==null){do{var ye={eventTime:A.eventTime,lane:A.lane,tag:A.tag,payload:A.payload,callback:A.callback,next:null};ne===null?Y=ne=ye:ne=ne.next=ye,A=A.next}while(A!==null);ne===null?Y=ne=y:ne=ne.next=y}else Y=ne=y;A={baseState:F.baseState,firstBaseUpdate:Y,lastBaseUpdate:ne,shared:F.shared,effects:F.effects},f.updateQueue=A;return}f=A.lastBaseUpdate,f===null?A.firstBaseUpdate=y:f.next=y,A.lastBaseUpdate=y}function pP(f,y,A,F){var Y=f.updateQueue;u3=!1;var ne=Y.firstBaseUpdate,ye=Y.lastBaseUpdate,Le=Y.shared.pending;if(Le!==null){Y.shared.pending=null;var Qe=Le,Bt=Qe.next;Qe.next=null,ye===null?ne=Bt:ye.next=Bt,ye=Qe;var _n=f.alternate;_n!==null&&(_n=_n.updateQueue,Le=_n.lastBaseUpdate,Le!==ye&&(Le===null?_n.firstBaseUpdate=Bt:Le.next=Bt,_n.lastBaseUpdate=Qe))}if(ne!==null){var Sn=Y.baseState;ye=0,_n=Bt=Qe=null,Le=ne;do{var pn=Le.lane,Qn=Le.eventTime;if((F&pn)===pn){_n!==null&&(_n=_n.next={eventTime:Qn,lane:0,tag:Le.tag,payload:Le.payload,callback:Le.callback,next:null});e:{var hr=f,pr=Le;switch(pn=y,Qn=A,pr.tag){case 1:if(hr=pr.payload,typeof hr=="function"){Sn=hr.call(Qn,Sn,pn);break e}Sn=hr;break e;case 3:hr.flags=hr.flags&-65537|128;case 0:if(hr=pr.payload,pn=typeof hr=="function"?hr.call(Qn,Sn,pn):hr,pn==null)break e;Sn=be({},Sn,pn);break e;case 2:u3=!0}}Le.callback!==null&&Le.lane!==0&&(f.flags|=64,pn=Y.effects,pn===null?Y.effects=[Le]:pn.push(Le))}else Qn={eventTime:Qn,lane:pn,tag:Le.tag,payload:Le.payload,callback:Le.callback,next:null},_n===null?(Bt=_n=Qn,Qe=Sn):_n=_n.next=Qn,ye|=pn;if(Le=Le.next,Le===null){if(Le=Y.shared.pending,Le===null)break;pn=Le,Le=pn.next,pn.next=null,Y.lastBaseUpdate=pn,Y.shared.pending=null}}while(!0);if(_n===null&&(Qe=Sn),Y.baseState=Qe,Y.firstBaseUpdate=Bt,Y.lastBaseUpdate=_n,y=Y.shared.interleaved,y!==null){Y=y;do ye|=Y.lane,Y=Y.next;while(Y!==y)}else ne===null&&(Y.shared.lanes=0);A8|=ye,f.lanes=ye,f.memoizedState=Sn}}function Qde(f,y,A){if(f=y.effects,y.effects=null,f!==null)for(y=0;y<f.length;y++){var F=f[y],Y=F.callback;if(Y!==null){if(F.callback=null,F=A,typeof Y!="function")throw Error(m(191,Y));Y.call(F)}}}var Jde=new l.Component().refs;function fU(f,y,A,F){y=f.memoizedState,A=A(F,y),A=A==null?y:be({},y,A),f.memoizedState=A,f.lanes===0&&(f.updateQueue.baseState=A)}var mP={isMounted:function(f){return(f=f._reactInternals)?x8(f)===f:!1},enqueueSetState:function(f,y,A){f=f._reactInternals;var F=wl(),Y=m3(f),ne=Qm(F,Y);ne.payload=y,A!=null&&(ne.callback=A),y=h3(f,ne,Y),y!==null&&(Wd(y,f,Y,F),fP(y,f,Y))},enqueueReplaceState:function(f,y,A){f=f._reactInternals;var F=wl(),Y=m3(f),ne=Qm(F,Y);ne.tag=1,ne.payload=y,A!=null&&(ne.callback=A),y=h3(f,ne,Y),y!==null&&(Wd(y,f,Y,F),fP(y,f,Y))},enqueueForceUpdate:function(f,y){f=f._reactInternals;var A=wl(),F=m3(f),Y=Qm(A,F);Y.tag=2,y!=null&&(Y.callback=y),y=h3(f,Y,F),y!==null&&(Wd(y,f,F,A),fP(y,f,F))}};function efe(f,y,A,F,Y,ne,ye){return f=f.stateNode,typeof f.shouldComponentUpdate=="function"?f.shouldComponentUpdate(F,ne,ye):y.prototype&&y.prototype.isPureReactComponent?!FS(A,F)||!FS(Y,ne):!0}function tfe(f,y,A){var F=!1,Y=l3,ne=y.contextType;return typeof ne=="object"&&ne!==null?ne=ph(ne):(Y=hc(y)?S8:P0.current,F=y.contextTypes,ne=(F=F!=null)?o7(f,Y):l3),y=new y(A,ne),f.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=mP,f.stateNode=y,y._reactInternals=f,F&&(f=f.stateNode,f.__reactInternalMemoizedUnmaskedChildContext=Y,f.__reactInternalMemoizedMaskedChildContext=ne),y}function nfe(f,y,A,F){f=y.state,typeof y.componentWillReceiveProps=="function"&&y.componentWillReceiveProps(A,F),typeof y.UNSAFE_componentWillReceiveProps=="function"&&y.UNSAFE_componentWillReceiveProps(A,F),y.state!==f&&mP.enqueueReplaceState(y,y.state,null)}function pU(f,y,A,F){var Y=f.stateNode;Y.props=A,Y.state=f.memoizedState,Y.refs=Jde,dU(f);var ne=y.contextType;typeof ne=="object"&&ne!==null?Y.context=ph(ne):(ne=hc(y)?S8:P0.current,Y.context=o7(f,ne)),Y.state=f.memoizedState,ne=y.getDerivedStateFromProps,typeof ne=="function"&&(fU(f,y,ne,A),Y.state=f.memoizedState),typeof y.getDerivedStateFromProps=="function"||typeof Y.getSnapshotBeforeUpdate=="function"||typeof Y.UNSAFE_componentWillMount!="function"&&typeof Y.componentWillMount!="function"||(y=Y.state,typeof Y.componentWillMount=="function"&&Y.componentWillMount(),typeof Y.UNSAFE_componentWillMount=="function"&&Y.UNSAFE_componentWillMount(),y!==Y.state&&mP.enqueueReplaceState(Y,Y.state,null),pP(f,A,Y,F),Y.state=f.memoizedState),typeof Y.componentDidMount=="function"&&(f.flags|=4194308)}function jS(f,y,A){if(f=A.ref,f!==null&&typeof f!="function"&&typeof f!="object"){if(A._owner){if(A=A._owner,A){if(A.tag!==1)throw Error(m(309));var F=A.stateNode}if(!F)throw Error(m(147,f));var Y=F,ne=""+f;return y!==null&&y.ref!==null&&typeof y.ref=="function"&&y.ref._stringRef===ne?y.ref:(y=function(ye){var Le=Y.refs;Le===Jde&&(Le=Y.refs={}),ye===null?delete Le[ne]:Le[ne]=ye},y._stringRef=ne,y)}if(typeof f!="string")throw Error(m(284));if(!A._owner)throw Error(m(290,f))}return f}function gP(f,y){throw f=Object.prototype.toString.call(y),Error(m(31,f==="[object Object]"?"object with keys {"+Object.keys(y).join(", ")+"}":f))}function rfe(f){var y=f._init;return y(f._payload)}function ife(f){function y(Et,it){if(f){var Rt=Et.deletions;Rt===null?(Et.deletions=[it],Et.flags|=16):Rt.push(it)}}function A(Et,it){if(!f)return null;for(;it!==null;)y(Et,it),it=it.sibling;return null}function F(Et,it){for(Et=new Map;it!==null;)it.key!==null?Et.set(it.key,it):Et.set(it.index,it),it=it.sibling;return Et}function Y(Et,it){return Et=y3(Et,it),Et.index=0,Et.sibling=null,Et}function ne(Et,it,Rt){return Et.index=Rt,f?(Rt=Et.alternate,Rt!==null?(Rt=Rt.index,Rt<it?(Et.flags|=2,it):Rt):(Et.flags|=2,it)):(Et.flags|=1048576,it)}function ye(Et){return f&&Et.alternate===null&&(Et.flags|=2),Et}function Le(Et,it,Rt,Cn){return it===null||it.tag!==6?(it=KU(Rt,Et.mode,Cn),it.return=Et,it):(it=Y(it,Rt),it.return=Et,it)}function Qe(Et,it,Rt,Cn){var _r=Rt.type;return _r===ze?_n(Et,it,Rt.props.children,Cn,Rt.key):it!==null&&(it.elementType===_r||typeof _r=="object"&&_r!==null&&_r.$$typeof===Ve&&rfe(_r)===it.type)?(Cn=Y(it,Rt.props),Cn.ref=jS(Et,it,Rt),Cn.return=Et,Cn):(Cn=OP(Rt.type,Rt.key,Rt.props,null,Et.mode,Cn),Cn.ref=jS(Et,it,Rt),Cn.return=Et,Cn)}function Bt(Et,it,Rt,Cn){return it===null||it.tag!==4||it.stateNode.containerInfo!==Rt.containerInfo||it.stateNode.implementation!==Rt.implementation?(it=ZU(Rt,Et.mode,Cn),it.return=Et,it):(it=Y(it,Rt.children||[]),it.return=Et,it)}function _n(Et,it,Rt,Cn,_r){return it===null||it.tag!==7?(it=I8(Rt,Et.mode,Cn,_r),it.return=Et,it):(it=Y(it,Rt),it.return=Et,it)}function Sn(Et,it,Rt){if(typeof it=="string"&&it!==""||typeof it=="number")return it=KU(""+it,Et.mode,Rt),it.return=Et,it;if(typeof it=="object"&&it!==null){switch(it.$$typeof){case ve:return Rt=OP(it.type,it.key,it.props,null,Et.mode,Rt),Rt.ref=jS(Et,null,it),Rt.return=Et,Rt;case Ne:return it=ZU(it,Et.mode,Rt),it.return=Et,it;case Ve:var Cn=it._init;return Sn(Et,Cn(it._payload),Rt)}if(rn(it)||Wt(it))return it=I8(it,Et.mode,Rt,null),it.return=Et,it;gP(Et,it)}return null}function pn(Et,it,Rt,Cn){var _r=it!==null?it.key:null;if(typeof Rt=="string"&&Rt!==""||typeof Rt=="number")return _r!==null?null:Le(Et,it,""+Rt,Cn);if(typeof Rt=="object"&&Rt!==null){switch(Rt.$$typeof){case ve:return Rt.key===_r?Qe(Et,it,Rt,Cn):null;case Ne:return Rt.key===_r?Bt(Et,it,Rt,Cn):null;case Ve:return _r=Rt._init,pn(Et,it,_r(Rt._payload),Cn)}if(rn(Rt)||Wt(Rt))return _r!==null?null:_n(Et,it,Rt,Cn,null);gP(Et,Rt)}return null}function Qn(Et,it,Rt,Cn,_r){if(typeof Cn=="string"&&Cn!==""||typeof Cn=="number")return Et=Et.get(Rt)||null,Le(it,Et,""+Cn,_r);if(typeof Cn=="object"&&Cn!==null){switch(Cn.$$typeof){case ve:return Et=Et.get(Cn.key===null?Rt:Cn.key)||null,Qe(it,Et,Cn,_r);case Ne:return Et=Et.get(Cn.key===null?Rt:Cn.key)||null,Bt(it,Et,Cn,_r);case Ve:var Ir=Cn._init;return Qn(Et,it,Rt,Ir(Cn._payload),_r)}if(rn(Cn)||Wt(Cn))return Et=Et.get(Rt)||null,_n(it,Et,Cn,_r,null);gP(it,Cn)}return null}function hr(Et,it,Rt,Cn){for(var _r=null,Ir=null,Nr=it,Wr=it=0,Na=null;Nr!==null&&Wr<Rt.length;Wr++){Nr.index>Wr?(Na=Nr,Nr=null):Na=Nr.sibling;var Hi=pn(Et,Nr,Rt[Wr],Cn);if(Hi===null){Nr===null&&(Nr=Na);break}f&&Nr&&Hi.alternate===null&&y(Et,Nr),it=ne(Hi,it,Wr),Ir===null?_r=Hi:Ir.sibling=Hi,Ir=Hi,Nr=Na}if(Wr===Rt.length)return A(Et,Nr),no&&E8(Et,Wr),_r;if(Nr===null){for(;Wr<Rt.length;Wr++)Nr=Sn(Et,Rt[Wr],Cn),Nr!==null&&(it=ne(Nr,it,Wr),Ir===null?_r=Nr:Ir.sibling=Nr,Ir=Nr);return no&&E8(Et,Wr),_r}for(Nr=F(Et,Nr);Wr<Rt.length;Wr++)Na=Qn(Nr,Et,Wr,Rt[Wr],Cn),Na!==null&&(f&&Na.alternate!==null&&Nr.delete(Na.key===null?Wr:Na.key),it=ne(Na,it,Wr),Ir===null?_r=Na:Ir.sibling=Na,Ir=Na);return f&&Nr.forEach(function(v3){return y(Et,v3)}),no&&E8(Et,Wr),_r}function pr(Et,it,Rt,Cn){var _r=Wt(Rt);if(typeof _r!="function")throw Error(m(150));if(Rt=_r.call(Rt),Rt==null)throw Error(m(151));for(var Ir=_r=null,Nr=it,Wr=it=0,Na=null,Hi=Rt.next();Nr!==null&&!Hi.done;Wr++,Hi=Rt.next()){Nr.index>Wr?(Na=Nr,Nr=null):Na=Nr.sibling;var v3=pn(Et,Nr,Hi.value,Cn);if(v3===null){Nr===null&&(Nr=Na);break}f&&Nr&&v3.alternate===null&&y(Et,Nr),it=ne(v3,it,Wr),Ir===null?_r=v3:Ir.sibling=v3,Ir=v3,Nr=Na}if(Hi.done)return A(Et,Nr),no&&E8(Et,Wr),_r;if(Nr===null){for(;!Hi.done;Wr++,Hi=Rt.next())Hi=Sn(Et,Hi.value,Cn),Hi!==null&&(it=ne(Hi,it,Wr),Ir===null?_r=Hi:Ir.sibling=Hi,Ir=Hi);return no&&E8(Et,Wr),_r}for(Nr=F(Et,Nr);!Hi.done;Wr++,Hi=Rt.next())Hi=Qn(Nr,Et,Wr,Hi.value,Cn),Hi!==null&&(f&&Hi.alternate!==null&&Nr.delete(Hi.key===null?Wr:Hi.key),it=ne(Hi,it,Wr),Ir===null?_r=Hi:Ir.sibling=Hi,Ir=Hi);return f&&Nr.forEach(function(DEe){return y(Et,DEe)}),no&&E8(Et,Wr),_r}function zo(Et,it,Rt,Cn){if(typeof Rt=="object"&&Rt!==null&&Rt.type===ze&&Rt.key===null&&(Rt=Rt.props.children),typeof Rt=="object"&&Rt!==null){switch(Rt.$$typeof){case ve:e:{for(var _r=Rt.key,Ir=it;Ir!==null;){if(Ir.key===_r){if(_r=Rt.type,_r===ze){if(Ir.tag===7){A(Et,Ir.sibling),it=Y(Ir,Rt.props.children),it.return=Et,Et=it;break e}}else if(Ir.elementType===_r||typeof _r=="object"&&_r!==null&&_r.$$typeof===Ve&&rfe(_r)===Ir.type){A(Et,Ir.sibling),it=Y(Ir,Rt.props),it.ref=jS(Et,Ir,Rt),it.return=Et,Et=it;break e}A(Et,Ir);break}else y(Et,Ir);Ir=Ir.sibling}Rt.type===ze?(it=I8(Rt.props.children,Et.mode,Cn,Rt.key),it.return=Et,Et=it):(Cn=OP(Rt.type,Rt.key,Rt.props,null,Et.mode,Cn),Cn.ref=jS(Et,it,Rt),Cn.return=Et,Et=Cn)}return ye(Et);case Ne:e:{for(Ir=Rt.key;it!==null;){if(it.key===Ir)if(it.tag===4&&it.stateNode.containerInfo===Rt.containerInfo&&it.stateNode.implementation===Rt.implementation){A(Et,it.sibling),it=Y(it,Rt.children||[]),it.return=Et,Et=it;break e}else{A(Et,it);break}else y(Et,it);it=it.sibling}it=ZU(Rt,Et.mode,Cn),it.return=Et,Et=it}return ye(Et);case Ve:return Ir=Rt._init,zo(Et,it,Ir(Rt._payload),Cn)}if(rn(Rt))return hr(Et,it,Rt,Cn);if(Wt(Rt))return pr(Et,it,Rt,Cn);gP(Et,Rt)}return typeof Rt=="string"&&Rt!==""||typeof Rt=="number"?(Rt=""+Rt,it!==null&&it.tag===6?(A(Et,it.sibling),it=Y(it,Rt),it.return=Et,Et=it):(A(Et,it),it=KU(Rt,Et.mode,Cn),it.return=Et,Et=it),ye(Et)):A(Et,it)}return zo}var d7=ife(!0),sfe=ife(!1),HS={},Lp=a3(HS),WS=a3(HS),$S=a3(HS);function M8(f){if(f===HS)throw Error(m(174));return f}function mU(f,y){switch(Ns($S,y),Ns(WS,f),Ns(Lp,HS),f=y.nodeType,f){case 9:case 11:y=(y=y.documentElement)?y.namespaceURI:Hr(null,"");break;default:f=f===8?y.parentNode:y,y=f.namespaceURI||null,f=f.tagName,y=Hr(y,f)}Ks(Lp),Ns(Lp,y)}function f7(){Ks(Lp),Ks(WS),Ks($S)}function ofe(f){M8($S.current);var y=M8(Lp.current),A=Hr(y,f.type);y!==A&&(Ns(WS,f),Ns(Lp,A))}function gU(f){WS.current===f&&(Ks(Lp),Ks(WS))}var po=a3(0);function yP(f){for(var y=f;y!==null;){if(y.tag===13){var A=y.memoizedState;if(A!==null&&(A=A.dehydrated,A===null||A.data==="$?"||A.data==="$!"))return y}else if(y.tag===19&&y.memoizedProps.revealOrder!==void 0){if(y.flags&128)return y}else if(y.child!==null){y.child.return=y,y=y.child;continue}if(y===f)break;for(;y.sibling===null;){if(y.return===null||y.return===f)return null;y=y.return}y.sibling.return=y.return,y=y.sibling}return null}var yU=[];function vU(){for(var f=0;f<yU.length;f++)yU[f]._workInProgressVersionPrimary=null;yU.length=0}var vP=fe.ReactCurrentDispatcher,_U=fe.ReactCurrentBatchConfig,C8=0,mo=null,da=null,ka=null,_P=!1,qS=!1,XS=0,nEe=0;function R0(){throw Error(m(321))}function xU(f,y){if(y===null)return!1;for(var A=0;A<y.length&&A<f.length;A++)if(!zd(f[A],y[A]))return!1;return!0}function bU(f,y,A,F,Y,ne){if(C8=ne,mo=y,y.memoizedState=null,y.updateQueue=null,y.lanes=0,vP.current=f===null||f.memoizedState===null?oEe:aEe,f=A(F,Y),qS){ne=0;do{if(qS=!1,XS=0,25<=ne)throw Error(m(301));ne+=1,ka=da=null,y.updateQueue=null,vP.current=lEe,f=A(F,Y)}while(qS)}if(vP.current=SP,y=da!==null&&da.next!==null,C8=0,ka=da=mo=null,_P=!1,y)throw Error(m(300));return f}function SU(){var f=XS!==0;return XS=0,f}function Bp(){var f={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ka===null?mo.memoizedState=ka=f:ka=ka.next=f,ka}function mh(){if(da===null){var f=mo.alternate;f=f!==null?f.memoizedState:null}else f=da.next;var y=ka===null?mo.memoizedState:ka.next;if(y!==null)ka=y,da=f;else{if(f===null)throw Error(m(310));da=f,f={memoizedState:da.memoizedState,baseState:da.baseState,baseQueue:da.baseQueue,queue:da.queue,next:null},ka===null?mo.memoizedState=ka=f:ka=ka.next=f}return ka}function YS(f,y){return typeof y=="function"?y(f):y}function wU(f){var y=mh(),A=y.queue;if(A===null)throw Error(m(311));A.lastRenderedReducer=f;var F=da,Y=F.baseQueue,ne=A.pending;if(ne!==null){if(Y!==null){var ye=Y.next;Y.next=ne.next,ne.next=ye}F.baseQueue=Y=ne,A.pending=null}if(Y!==null){ne=Y.next,F=F.baseState;var Le=ye=null,Qe=null,Bt=ne;do{var _n=Bt.lane;if((C8&_n)===_n)Qe!==null&&(Qe=Qe.next={lane:0,action:Bt.action,hasEagerState:Bt.hasEagerState,eagerState:Bt.eagerState,next:null}),F=Bt.hasEagerState?Bt.eagerState:f(F,Bt.action);else{var Sn={lane:_n,action:Bt.action,hasEagerState:Bt.hasEagerState,eagerState:Bt.eagerState,next:null};Qe===null?(Le=Qe=Sn,ye=F):Qe=Qe.next=Sn,mo.lanes|=_n,A8|=_n}Bt=Bt.next}while(Bt!==null&&Bt!==ne);Qe===null?ye=F:Qe.next=Le,zd(F,y.memoizedState)||(dc=!0),y.memoizedState=F,y.baseState=ye,y.baseQueue=Qe,A.lastRenderedState=F}if(f=A.interleaved,f!==null){Y=f;do ne=Y.lane,mo.lanes|=ne,A8|=ne,Y=Y.next;while(Y!==f)}else Y===null&&(A.lanes=0);return[y.memoizedState,A.dispatch]}function EU(f){var y=mh(),A=y.queue;if(A===null)throw Error(m(311));A.lastRenderedReducer=f;var F=A.dispatch,Y=A.pending,ne=y.memoizedState;if(Y!==null){A.pending=null;var ye=Y=Y.next;do ne=f(ne,ye.action),ye=ye.next;while(ye!==Y);zd(ne,y.memoizedState)||(dc=!0),y.memoizedState=ne,y.baseQueue===null&&(y.baseState=ne),A.lastRenderedState=ne}return[ne,F]}function afe(){}function lfe(f,y){var A=mo,F=mh(),Y=y(),ne=!zd(F.memoizedState,Y);if(ne&&(F.memoizedState=Y,dc=!0),F=F.queue,TU(hfe.bind(null,A,F,f),[f]),F.getSnapshot!==y||ne||ka!==null&&ka.memoizedState.tag&1){if(A.flags|=2048,KS(9,ufe.bind(null,A,F,Y,y),void 0,null),Ia===null)throw Error(m(349));C8&30||cfe(A,y,Y)}return Y}function cfe(f,y,A){f.flags|=16384,f={getSnapshot:y,value:A},y=mo.updateQueue,y===null?(y={lastEffect:null,stores:null},mo.updateQueue=y,y.stores=[f]):(A=y.stores,A===null?y.stores=[f]:A.push(f))}function ufe(f,y,A,F){y.value=A,y.getSnapshot=F,dfe(y)&&ffe(f)}function hfe(f,y,A){return A(function(){dfe(y)&&ffe(f)})}function dfe(f){var y=f.getSnapshot;f=f.value;try{var A=y();return!zd(f,A)}catch{return!0}}function ffe(f){var y=Zm(f,1);y!==null&&Wd(y,f,1,-1)}function pfe(f){var y=Bp();return typeof f=="function"&&(f=f()),y.memoizedState=y.baseState=f,f={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:YS,lastRenderedState:f},y.queue=f,f=f.dispatch=sEe.bind(null,mo,f),[y.memoizedState,f]}function KS(f,y,A,F){return f={tag:f,create:y,destroy:A,deps:F,next:null},y=mo.updateQueue,y===null?(y={lastEffect:null,stores:null},mo.updateQueue=y,y.lastEffect=f.next=f):(A=y.lastEffect,A===null?y.lastEffect=f.next=f:(F=A.next,A.next=f,f.next=F,y.lastEffect=f)),f}function mfe(){return mh().memoizedState}function xP(f,y,A,F){var Y=Bp();mo.flags|=f,Y.memoizedState=KS(1|y,A,void 0,F===void 0?null:F)}function bP(f,y,A,F){var Y=mh();F=F===void 0?null:F;var ne=void 0;if(da!==null){var ye=da.memoizedState;if(ne=ye.destroy,F!==null&&xU(F,ye.deps)){Y.memoizedState=KS(y,A,ne,F);return}}mo.flags|=f,Y.memoizedState=KS(1|y,A,ne,F)}function gfe(f,y){return xP(8390656,8,f,y)}function TU(f,y){return bP(2048,8,f,y)}function yfe(f,y){return bP(4,2,f,y)}function vfe(f,y){return bP(4,4,f,y)}function _fe(f,y){if(typeof y=="function")return f=f(),y(f),function(){y(null)};if(y!=null)return f=f(),y.current=f,function(){y.current=null}}function xfe(f,y,A){return A=A!=null?A.concat([f]):null,bP(4,4,_fe.bind(null,y,f),A)}function MU(){}function bfe(f,y){var A=mh();y=y===void 0?null:y;var F=A.memoizedState;return F!==null&&y!==null&&xU(y,F[1])?F[0]:(A.memoizedState=[f,y],f)}function Sfe(f,y){var A=mh();y=y===void 0?null:y;var F=A.memoizedState;return F!==null&&y!==null&&xU(y,F[1])?F[0]:(f=f(),A.memoizedState=[f,y],f)}function wfe(f,y,A){return C8&21?(zd(A,y)||(A=Xhe(),mo.lanes|=A,A8|=A,f.baseState=!0),y):(f.baseState&&(f.baseState=!1,dc=!0),f.memoizedState=A)}function rEe(f,y){var A=us;us=A!==0&&4>A?A:4,f(!0);var F=_U.transition;_U.transition={};try{f(!1),y()}finally{us=A,_U.transition=F}}function Efe(){return mh().memoizedState}function iEe(f,y,A){var F=m3(f);if(A={lane:F,action:A,hasEagerState:!1,eagerState:null,next:null},Tfe(f))Mfe(y,A);else if(A=Yde(f,y,A,F),A!==null){var Y=wl();Wd(A,f,F,Y),Cfe(A,y,F)}}function sEe(f,y,A){var F=m3(f),Y={lane:F,action:A,hasEagerState:!1,eagerState:null,next:null};if(Tfe(f))Mfe(y,Y);else{var ne=f.alternate;if(f.lanes===0&&(ne===null||ne.lanes===0)&&(ne=y.lastRenderedReducer,ne!==null))try{var ye=y.lastRenderedState,Le=ne(ye,A);if(Y.hasEagerState=!0,Y.eagerState=Le,zd(Le,ye)){var Qe=y.interleaved;Qe===null?(Y.next=Y,hU(y)):(Y.next=Qe.next,Qe.next=Y),y.interleaved=Y;return}}catch{}finally{}A=Yde(f,y,Y,F),A!==null&&(Y=wl(),Wd(A,f,F,Y),Cfe(A,y,F))}}function Tfe(f){var y=f.alternate;return f===mo||y!==null&&y===mo}function Mfe(f,y){qS=_P=!0;var A=f.pending;A===null?y.next=y:(y.next=A.next,A.next=y),f.pending=y}function Cfe(f,y,A){if(A&4194240){var F=y.lanes;F&=f.pendingLanes,A|=F,y.lanes=A,AB(f,A)}}var SP={readContext:ph,useCallback:R0,useContext:R0,useEffect:R0,useImperativeHandle:R0,useInsertionEffect:R0,useLayoutEffect:R0,useMemo:R0,useReducer:R0,useRef:R0,useState:R0,useDebugValue:R0,useDeferredValue:R0,useTransition:R0,useMutableSource:R0,useSyncExternalStore:R0,useId:R0,unstable_isNewReconciler:!1},oEe={readContext:ph,useCallback:function(f,y){return Bp().memoizedState=[f,y===void 0?null:y],f},useContext:ph,useEffect:gfe,useImperativeHandle:function(f,y,A){return A=A!=null?A.concat([f]):null,xP(4194308,4,_fe.bind(null,y,f),A)},useLayoutEffect:function(f,y){return xP(4194308,4,f,y)},useInsertionEffect:function(f,y){return xP(4,2,f,y)},useMemo:function(f,y){var A=Bp();return y=y===void 0?null:y,f=f(),A.memoizedState=[f,y],f},useReducer:function(f,y,A){var F=Bp();return y=A!==void 0?A(y):y,F.memoizedState=F.baseState=y,f={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:f,lastRenderedState:y},F.queue=f,f=f.dispatch=iEe.bind(null,mo,f),[F.memoizedState,f]},useRef:function(f){var y=Bp();return f={current:f},y.memoizedState=f},useState:pfe,useDebugValue:MU,useDeferredValue:function(f){return Bp().memoizedState=f},useTransition:function(){var f=pfe(!1),y=f[0];return f=rEe.bind(null,f[1]),Bp().memoizedState=f,[y,f]},useMutableSource:function(){},useSyncExternalStore:function(f,y,A){var F=mo,Y=Bp();if(no){if(A===void 0)throw Error(m(407));A=A()}else{if(A=y(),Ia===null)throw Error(m(349));C8&30||cfe(F,y,A)}Y.memoizedState=A;var ne={value:A,getSnapshot:y};return Y.queue=ne,gfe(hfe.bind(null,F,ne,f),[f]),F.flags|=2048,KS(9,ufe.bind(null,F,ne,A,y),void 0,null),A},useId:function(){var f=Bp(),y=Ia.identifierPrefix;if(no){var A=Km,F=Ym;A=(F&~(1<<32-Ud(F)-1)).toString(32)+A,y=":"+y+"R"+A,A=XS++,0<A&&(y+="H"+A.toString(32)),y+=":"}else A=nEe++,y=":"+y+"r"+A.toString(32)+":";return f.memoizedState=y},unstable_isNewReconciler:!1},aEe={readContext:ph,useCallback:bfe,useContext:ph,useEffect:TU,useImperativeHandle:xfe,useInsertionEffect:yfe,useLayoutEffect:vfe,useMemo:Sfe,useReducer:wU,useRef:mfe,useState:function(){return wU(YS)},useDebugValue:MU,useDeferredValue:function(f){var y=mh();return wfe(y,da.memoizedState,f)},useTransition:function(){var f=wU(YS)[0],y=mh().memoizedState;return[f,y]},useMutableSource:afe,useSyncExternalStore:lfe,useId:Efe,unstable_isNewReconciler:!1},lEe={readContext:ph,useCallback:bfe,useContext:ph,useEffect:TU,useImperativeHandle:xfe,useInsertionEffect:yfe,useLayoutEffect:vfe,useMemo:Sfe,useReducer:EU,useRef:mfe,useState:function(){return EU(YS)},useDebugValue:MU,useDeferredValue:function(f){var y=mh();return da===null?y.memoizedState=f:wfe(y,da.memoizedState,f)},useTransition:function(){var f=EU(YS)[0],y=mh().memoizedState;return[f,y]},useMutableSource:afe,useSyncExternalStore:lfe,useId:Efe,unstable_isNewReconciler:!1};function p7(f,y){try{var A="",F=y;do A+=ct(F),F=F.return;while(F);var Y=A}catch(ne){Y=`
Error generating stack: `+ne.message+`
`+ne.stack}return{value:f,source:y,stack:Y,digest:null}}function CU(f,y,A){return{value:f,source:null,stack:A??null,digest:y??null}}function AU(f,y){try{console.error(y.value)}catch(A){setTimeout(function(){throw A})}}var cEe=typeof WeakMap=="function"?WeakMap:Map;function Afe(f,y,A){A=Qm(-1,A),A.tag=3,A.payload={element:null};var F=y.value;return A.callback=function(){PP||(PP=!0,GU=F),AU(f,y)},A}function Pfe(f,y,A){A=Qm(-1,A),A.tag=3;var F=f.type.getDerivedStateFromError;if(typeof F=="function"){var Y=y.value;A.payload=function(){return F(Y)},A.callback=function(){AU(f,y)}}var ne=f.stateNode;return ne!==null&&typeof ne.componentDidCatch=="function"&&(A.callback=function(){AU(f,y),typeof F!="function"&&(f3===null?f3=new Set([this]):f3.add(this));var ye=y.stack;this.componentDidCatch(y.value,{componentStack:ye!==null?ye:""})}),A}function Rfe(f,y,A){var F=f.pingCache;if(F===null){F=f.pingCache=new cEe;var Y=new Set;F.set(y,Y)}else Y=F.get(y),Y===void 0&&(Y=new Set,F.set(y,Y));Y.has(A)||(Y.add(A),f=wEe.bind(null,f,y,A),y.then(f,f))}function kfe(f){do{var y;if((y=f.tag===13)&&(y=f.memoizedState,y=y!==null?y.dehydrated!==null:!0),y)return f;f=f.return}while(f!==null);return null}function Ife(f,y,A,F,Y){return f.mode&1?(f.flags|=65536,f.lanes=Y,f):(f===y?f.flags|=65536:(f.flags|=128,A.flags|=131072,A.flags&=-52805,A.tag===1&&(A.alternate===null?A.tag=17:(y=Qm(-1,1),y.tag=2,h3(A,y,1))),A.lanes|=1),f)}var uEe=fe.ReactCurrentOwner,dc=!1;function Sl(f,y,A,F){y.child=f===null?sfe(y,null,A,F):d7(y,f.child,A,F)}function Nfe(f,y,A,F,Y){A=A.render;var ne=y.ref;return h7(y,Y),F=bU(f,y,A,F,ne,Y),A=SU(),f!==null&&!dc?(y.updateQueue=f.updateQueue,y.flags&=-2053,f.lanes&=~Y,Jm(f,y,Y)):(no&&A&&nU(y),y.flags|=1,Sl(f,y,F,Y),y.child)}function Dfe(f,y,A,F,Y){if(f===null){var ne=A.type;return typeof ne=="function"&&!YU(ne)&&ne.defaultProps===void 0&&A.compare===null&&A.defaultProps===void 0?(y.tag=15,y.type=ne,Ofe(f,y,ne,F,Y)):(f=OP(A.type,null,F,y,y.mode,Y),f.ref=y.ref,f.return=y,y.child=f)}if(ne=f.child,!(f.lanes&Y)){var ye=ne.memoizedProps;if(A=A.compare,A=A!==null?A:FS,A(ye,F)&&f.ref===y.ref)return Jm(f,y,Y)}return y.flags|=1,f=y3(ne,F),f.ref=y.ref,f.return=y,y.child=f}function Ofe(f,y,A,F,Y){if(f!==null){var ne=f.memoizedProps;if(FS(ne,F)&&f.ref===y.ref)if(dc=!1,y.pendingProps=F=ne,(f.lanes&Y)!==0)f.flags&131072&&(dc=!0);else return y.lanes=f.lanes,Jm(f,y,Y)}return PU(f,y,A,F,Y)}function Ffe(f,y,A){var F=y.pendingProps,Y=F.children,ne=f!==null?f.memoizedState:null;if(F.mode==="hidden")if(!(y.mode&1))y.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ns(g7,hu),hu|=A;else{if(!(A&1073741824))return f=ne!==null?ne.baseLanes|A:A,y.lanes=y.childLanes=1073741824,y.memoizedState={baseLanes:f,cachePool:null,transitions:null},y.updateQueue=null,Ns(g7,hu),hu|=f,null;y.memoizedState={baseLanes:0,cachePool:null,transitions:null},F=ne!==null?ne.baseLanes:A,Ns(g7,hu),hu|=F}else ne!==null?(F=ne.baseLanes|A,y.memoizedState=null):F=A,Ns(g7,hu),hu|=F;return Sl(f,y,Y,A),y.child}function Lfe(f,y){var A=y.ref;(f===null&&A!==null||f!==null&&f.ref!==A)&&(y.flags|=512,y.flags|=2097152)}function PU(f,y,A,F,Y){var ne=hc(A)?S8:P0.current;return ne=o7(y,ne),h7(y,Y),A=bU(f,y,A,F,ne,Y),F=SU(),f!==null&&!dc?(y.updateQueue=f.updateQueue,y.flags&=-2053,f.lanes&=~Y,Jm(f,y,Y)):(no&&F&&nU(y),y.flags|=1,Sl(f,y,A,Y),y.child)}function Bfe(f,y,A,F,Y){if(hc(A)){var ne=!0;oP(y)}else ne=!1;if(h7(y,Y),y.stateNode===null)EP(f,y),tfe(y,A,F),pU(y,A,F,Y),F=!0;else if(f===null){var ye=y.stateNode,Le=y.memoizedProps;ye.props=Le;var Qe=ye.context,Bt=A.contextType;typeof Bt=="object"&&Bt!==null?Bt=ph(Bt):(Bt=hc(A)?S8:P0.current,Bt=o7(y,Bt));var _n=A.getDerivedStateFromProps,Sn=typeof _n=="function"||typeof ye.getSnapshotBeforeUpdate=="function";Sn||typeof ye.UNSAFE_componentWillReceiveProps!="function"&&typeof ye.componentWillReceiveProps!="function"||(Le!==F||Qe!==Bt)&&nfe(y,ye,F,Bt),u3=!1;var pn=y.memoizedState;ye.state=pn,pP(y,F,ye,Y),Qe=y.memoizedState,Le!==F||pn!==Qe||uc.current||u3?(typeof _n=="function"&&(fU(y,A,_n,F),Qe=y.memoizedState),(Le=u3||efe(y,A,Le,F,pn,Qe,Bt))?(Sn||typeof ye.UNSAFE_componentWillMount!="function"&&typeof ye.componentWillMount!="function"||(typeof ye.componentWillMount=="function"&&ye.componentWillMount(),typeof ye.UNSAFE_componentWillMount=="function"&&ye.UNSAFE_componentWillMount()),typeof ye.componentDidMount=="function"&&(y.flags|=4194308)):(typeof ye.componentDidMount=="function"&&(y.flags|=4194308),y.memoizedProps=F,y.memoizedState=Qe),ye.props=F,ye.state=Qe,ye.context=Bt,F=Le):(typeof ye.componentDidMount=="function"&&(y.flags|=4194308),F=!1)}else{ye=y.stateNode,Kde(f,y),Le=y.memoizedProps,Bt=y.type===y.elementType?Le:Gd(y.type,Le),ye.props=Bt,Sn=y.pendingProps,pn=ye.context,Qe=A.contextType,typeof Qe=="object"&&Qe!==null?Qe=ph(Qe):(Qe=hc(A)?S8:P0.current,Qe=o7(y,Qe));var Qn=A.getDerivedStateFromProps;(_n=typeof Qn=="function"||typeof ye.getSnapshotBeforeUpdate=="function")||typeof ye.UNSAFE_componentWillReceiveProps!="function"&&typeof ye.componentWillReceiveProps!="function"||(Le!==Sn||pn!==Qe)&&nfe(y,ye,F,Qe),u3=!1,pn=y.memoizedState,ye.state=pn,pP(y,F,ye,Y);var hr=y.memoizedState;Le!==Sn||pn!==hr||uc.current||u3?(typeof Qn=="function"&&(fU(y,A,Qn,F),hr=y.memoizedState),(Bt=u3||efe(y,A,Bt,F,pn,hr,Qe)||!1)?(_n||typeof ye.UNSAFE_componentWillUpdate!="function"&&typeof ye.componentWillUpdate!="function"||(typeof ye.componentWillUpdate=="function"&&ye.componentWillUpdate(F,hr,Qe),typeof ye.UNSAFE_componentWillUpdate=="function"&&ye.UNSAFE_componentWillUpdate(F,hr,Qe)),typeof ye.componentDidUpdate=="function"&&(y.flags|=4),typeof ye.getSnapshotBeforeUpdate=="function"&&(y.flags|=1024)):(typeof ye.componentDidUpdate!="function"||Le===f.memoizedProps&&pn===f.memoizedState||(y.flags|=4),typeof ye.getSnapshotBeforeUpdate!="function"||Le===f.memoizedProps&&pn===f.memoizedState||(y.flags|=1024),y.memoizedProps=F,y.memoizedState=hr),ye.props=F,ye.state=hr,ye.context=Qe,F=Bt):(typeof ye.componentDidUpdate!="function"||Le===f.memoizedProps&&pn===f.memoizedState||(y.flags|=4),typeof ye.getSnapshotBeforeUpdate!="function"||Le===f.memoizedProps&&pn===f.memoizedState||(y.flags|=1024),F=!1)}return RU(f,y,A,F,ne,Y)}function RU(f,y,A,F,Y,ne){Lfe(f,y);var ye=(y.flags&128)!==0;if(!F&&!ye)return Y&&Gde(y,A,!1),Jm(f,y,ne);F=y.stateNode,uEe.current=y;var Le=ye&&typeof A.getDerivedStateFromError!="function"?null:F.render();return y.flags|=1,f!==null&&ye?(y.child=d7(y,f.child,null,ne),y.child=d7(y,null,Le,ne)):Sl(f,y,Le,ne),y.memoizedState=F.state,Y&&Gde(y,A,!0),y.child}function Ufe(f){var y=f.stateNode;y.pendingContext?zde(f,y.pendingContext,y.pendingContext!==y.context):y.context&&zde(f,y.context,!1),mU(f,y.containerInfo)}function zfe(f,y,A,F,Y){return c7(),oU(Y),y.flags|=256,Sl(f,y,A,F),y.child}var kU={dehydrated:null,treeContext:null,retryLane:0};function IU(f){return{baseLanes:f,cachePool:null,transitions:null}}function Vfe(f,y,A){var F=y.pendingProps,Y=po.current,ne=!1,ye=(y.flags&128)!==0,Le;if((Le=ye)||(Le=f!==null&&f.memoizedState===null?!1:(Y&2)!==0),Le?(ne=!0,y.flags&=-129):(f===null||f.memoizedState!==null)&&(Y|=1),Ns(po,Y&1),f===null)return sU(y),f=y.memoizedState,f!==null&&(f=f.dehydrated,f!==null)?(y.mode&1?f.data==="$!"?y.lanes=8:y.lanes=1073741824:y.lanes=1,null):(ye=F.children,f=F.fallback,ne?(F=y.mode,ne=y.child,ye={mode:"hidden",children:ye},!(F&1)&&ne!==null?(ne.childLanes=0,ne.pendingProps=ye):ne=FP(ye,F,0,null),f=I8(f,F,A,null),ne.return=y,f.return=y,ne.sibling=f,y.child=ne,y.child.memoizedState=IU(A),y.memoizedState=kU,f):NU(y,ye));if(Y=f.memoizedState,Y!==null&&(Le=Y.dehydrated,Le!==null))return hEe(f,y,ye,F,Le,Y,A);if(ne){ne=F.fallback,ye=y.mode,Y=f.child,Le=Y.sibling;var Qe={mode:"hidden",children:F.children};return!(ye&1)&&y.child!==Y?(F=y.child,F.childLanes=0,F.pendingProps=Qe,y.deletions=null):(F=y3(Y,Qe),F.subtreeFlags=Y.subtreeFlags&14680064),Le!==null?ne=y3(Le,ne):(ne=I8(ne,ye,A,null),ne.flags|=2),ne.return=y,F.return=y,F.sibling=ne,y.child=F,F=ne,ne=y.child,ye=f.child.memoizedState,ye=ye===null?IU(A):{baseLanes:ye.baseLanes|A,cachePool:null,transitions:ye.transitions},ne.memoizedState=ye,ne.childLanes=f.childLanes&~A,y.memoizedState=kU,F}return ne=f.child,f=ne.sibling,F=y3(ne,{mode:"visible",children:F.children}),!(y.mode&1)&&(F.lanes=A),F.return=y,F.sibling=null,f!==null&&(A=y.deletions,A===null?(y.deletions=[f],y.flags|=16):A.push(f)),y.child=F,y.memoizedState=null,F}function NU(f,y){return y=FP({mode:"visible",children:y},f.mode,0,null),y.return=f,f.child=y}function wP(f,y,A,F){return F!==null&&oU(F),d7(y,f.child,null,A),f=NU(y,y.pendingProps.children),f.flags|=2,y.memoizedState=null,f}function hEe(f,y,A,F,Y,ne,ye){if(A)return y.flags&256?(y.flags&=-257,F=CU(Error(m(422))),wP(f,y,ye,F)):y.memoizedState!==null?(y.child=f.child,y.flags|=128,null):(ne=F.fallback,Y=y.mode,F=FP({mode:"visible",children:F.children},Y,0,null),ne=I8(ne,Y,ye,null),ne.flags|=2,F.return=y,ne.return=y,F.sibling=ne,y.child=F,y.mode&1&&d7(y,f.child,null,ye),y.child.memoizedState=IU(ye),y.memoizedState=kU,ne);if(!(y.mode&1))return wP(f,y,ye,null);if(Y.data==="$!"){if(F=Y.nextSibling&&Y.nextSibling.dataset,F)var Le=F.dgst;return F=Le,ne=Error(m(419)),F=CU(ne,F,void 0),wP(f,y,ye,F)}if(Le=(ye&f.childLanes)!==0,dc||Le){if(F=Ia,F!==null){switch(ye&-ye){case 4:Y=2;break;case 16:Y=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:Y=32;break;case 536870912:Y=268435456;break;default:Y=0}Y=Y&(F.suspendedLanes|ye)?0:Y,Y!==0&&Y!==ne.retryLane&&(ne.retryLane=Y,Zm(f,Y),Wd(F,f,Y,-1))}return XU(),F=CU(Error(m(421))),wP(f,y,ye,F)}return Y.data==="$?"?(y.flags|=128,y.child=f.child,y=EEe.bind(null,f),Y._reactRetry=y,null):(f=ne.treeContext,uu=o3(Y.nextSibling),cu=y,no=!0,Vd=null,f!==null&&(dh[fh++]=Ym,dh[fh++]=Km,dh[fh++]=w8,Ym=f.id,Km=f.overflow,w8=y),y=NU(y,F.children),y.flags|=4096,y)}function Gfe(f,y,A){f.lanes|=y;var F=f.alternate;F!==null&&(F.lanes|=y),uU(f.return,y,A)}function DU(f,y,A,F,Y){var ne=f.memoizedState;ne===null?f.memoizedState={isBackwards:y,rendering:null,renderingStartTime:0,last:F,tail:A,tailMode:Y}:(ne.isBackwards=y,ne.rendering=null,ne.renderingStartTime=0,ne.last=F,ne.tail=A,ne.tailMode=Y)}function jfe(f,y,A){var F=y.pendingProps,Y=F.revealOrder,ne=F.tail;if(Sl(f,y,F.children,A),F=po.current,F&2)F=F&1|2,y.flags|=128;else{if(f!==null&&f.flags&128)e:for(f=y.child;f!==null;){if(f.tag===13)f.memoizedState!==null&&Gfe(f,A,y);else if(f.tag===19)Gfe(f,A,y);else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===y)break e;for(;f.sibling===null;){if(f.return===null||f.return===y)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}F&=1}if(Ns(po,F),!(y.mode&1))y.memoizedState=null;else switch(Y){case"forwards":for(A=y.child,Y=null;A!==null;)f=A.alternate,f!==null&&yP(f)===null&&(Y=A),A=A.sibling;A=Y,A===null?(Y=y.child,y.child=null):(Y=A.sibling,A.sibling=null),DU(y,!1,Y,A,ne);break;case"backwards":for(A=null,Y=y.child,y.child=null;Y!==null;){if(f=Y.alternate,f!==null&&yP(f)===null){y.child=Y;break}f=Y.sibling,Y.sibling=A,A=Y,Y=f}DU(y,!0,A,null,ne);break;case"together":DU(y,!1,null,null,void 0);break;default:y.memoizedState=null}return y.child}function EP(f,y){!(y.mode&1)&&f!==null&&(f.alternate=null,y.alternate=null,y.flags|=2)}function Jm(f,y,A){if(f!==null&&(y.dependencies=f.dependencies),A8|=y.lanes,!(A&y.childLanes))return null;if(f!==null&&y.child!==f.child)throw Error(m(153));if(y.child!==null){for(f=y.child,A=y3(f,f.pendingProps),y.child=A,A.return=y;f.sibling!==null;)f=f.sibling,A=A.sibling=y3(f,f.pendingProps),A.return=y;A.sibling=null}return y.child}function dEe(f,y,A){switch(y.tag){case 3:Ufe(y),c7();break;case 5:ofe(y);break;case 1:hc(y.type)&&oP(y);break;case 4:mU(y,y.stateNode.containerInfo);break;case 10:var F=y.type._context,Y=y.memoizedProps.value;Ns(hP,F._currentValue),F._currentValue=Y;break;case 13:if(F=y.memoizedState,F!==null)return F.dehydrated!==null?(Ns(po,po.current&1),y.flags|=128,null):A&y.child.childLanes?Vfe(f,y,A):(Ns(po,po.current&1),f=Jm(f,y,A),f!==null?f.sibling:null);Ns(po,po.current&1);break;case 19:if(F=(A&y.childLanes)!==0,f.flags&128){if(F)return jfe(f,y,A);y.flags|=128}if(Y=y.memoizedState,Y!==null&&(Y.rendering=null,Y.tail=null,Y.lastEffect=null),Ns(po,po.current),F)break;return null;case 22:case 23:return y.lanes=0,Ffe(f,y,A)}return Jm(f,y,A)}var Hfe,OU,Wfe,$fe;Hfe=function(f,y){for(var A=y.child;A!==null;){if(A.tag===5||A.tag===6)f.appendChild(A.stateNode);else if(A.tag!==4&&A.child!==null){A.child.return=A,A=A.child;continue}if(A===y)break;for(;A.sibling===null;){if(A.return===null||A.return===y)return;A=A.return}A.sibling.return=A.return,A=A.sibling}},OU=function(){},Wfe=function(f,y,A,F){var Y=f.memoizedProps;if(Y!==F){f=y.stateNode,M8(Lp.current);var ne=null;switch(A){case"input":Y=Lt(f,Y),F=Lt(f,F),ne=[];break;case"select":Y=be({},Y,{value:void 0}),F=be({},F,{value:void 0}),ne=[];break;case"textarea":Y=fn(f,Y),F=fn(f,F),ne=[];break;default:typeof Y.onClick!="function"&&typeof F.onClick=="function"&&(f.onclick=rP)}Xv(A,F);var ye;A=null;for(Bt in Y)if(!F.hasOwnProperty(Bt)&&Y.hasOwnProperty(Bt)&&Y[Bt]!=null)if(Bt==="style"){var Le=Y[Bt];for(ye in Le)Le.hasOwnProperty(ye)&&(A||(A={}),A[ye]="")}else Bt!=="dangerouslySetInnerHTML"&&Bt!=="children"&&Bt!=="suppressContentEditableWarning"&&Bt!=="suppressHydrationWarning"&&Bt!=="autoFocus"&&(b.hasOwnProperty(Bt)?ne||(ne=[]):(ne=ne||[]).push(Bt,null));for(Bt in F){var Qe=F[Bt];if(Le=Y!=null?Y[Bt]:void 0,F.hasOwnProperty(Bt)&&Qe!==Le&&(Qe!=null||Le!=null))if(Bt==="style")if(Le){for(ye in Le)!Le.hasOwnProperty(ye)||Qe&&Qe.hasOwnProperty(ye)||(A||(A={}),A[ye]="");for(ye in Qe)Qe.hasOwnProperty(ye)&&Le[ye]!==Qe[ye]&&(A||(A={}),A[ye]=Qe[ye])}else A||(ne||(ne=[]),ne.push(Bt,A)),A=Qe;else Bt==="dangerouslySetInnerHTML"?(Qe=Qe?Qe.__html:void 0,Le=Le?Le.__html:void 0,Qe!=null&&Le!==Qe&&(ne=ne||[]).push(Bt,Qe)):Bt==="children"?typeof Qe!="string"&&typeof Qe!="number"||(ne=ne||[]).push(Bt,""+Qe):Bt!=="suppressContentEditableWarning"&&Bt!=="suppressHydrationWarning"&&(b.hasOwnProperty(Bt)?(Qe!=null&&Bt==="onScroll"&&Ys("scroll",f),ne||Le===Qe||(ne=[])):(ne=ne||[]).push(Bt,Qe))}A&&(ne=ne||[]).push("style",A);var Bt=ne;(y.updateQueue=Bt)&&(y.flags|=4)}},$fe=function(f,y,A,F){A!==F&&(y.flags|=4)};function ZS(f,y){if(!no)switch(f.tailMode){case"hidden":y=f.tail;for(var A=null;y!==null;)y.alternate!==null&&(A=y),y=y.sibling;A===null?f.tail=null:A.sibling=null;break;case"collapsed":A=f.tail;for(var F=null;A!==null;)A.alternate!==null&&(F=A),A=A.sibling;F===null?y||f.tail===null?f.tail=null:f.tail.sibling=null:F.sibling=null}}function k0(f){var y=f.alternate!==null&&f.alternate.child===f.child,A=0,F=0;if(y)for(var Y=f.child;Y!==null;)A|=Y.lanes|Y.childLanes,F|=Y.subtreeFlags&14680064,F|=Y.flags&14680064,Y.return=f,Y=Y.sibling;else for(Y=f.child;Y!==null;)A|=Y.lanes|Y.childLanes,F|=Y.subtreeFlags,F|=Y.flags,Y.return=f,Y=Y.sibling;return f.subtreeFlags|=F,f.childLanes=A,y}function fEe(f,y,A){var F=y.pendingProps;switch(rU(y),y.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return k0(y),null;case 1:return hc(y.type)&&sP(),k0(y),null;case 3:return F=y.stateNode,f7(),Ks(uc),Ks(P0),vU(),F.pendingContext&&(F.context=F.pendingContext,F.pendingContext=null),(f===null||f.child===null)&&(uP(y)?y.flags|=4:f===null||f.memoizedState.isDehydrated&&!(y.flags&256)||(y.flags|=1024,Vd!==null&&(WU(Vd),Vd=null))),OU(f,y),k0(y),null;case 5:gU(y);var Y=M8($S.current);if(A=y.type,f!==null&&y.stateNode!=null)Wfe(f,y,A,F,Y),f.ref!==y.ref&&(y.flags|=512,y.flags|=2097152);else{if(!F){if(y.stateNode===null)throw Error(m(166));return k0(y),null}if(f=M8(Lp.current),uP(y)){F=y.stateNode,A=y.type;var ne=y.memoizedProps;switch(F[Fp]=y,F[VS]=ne,f=(y.mode&1)!==0,A){case"dialog":Ys("cancel",F),Ys("close",F);break;case"iframe":case"object":case"embed":Ys("load",F);break;case"video":case"audio":for(Y=0;Y<BS.length;Y++)Ys(BS[Y],F);break;case"source":Ys("error",F);break;case"img":case"image":case"link":Ys("error",F),Ys("load",F);break;case"details":Ys("toggle",F);break;case"input":It(F,ne),Ys("invalid",F);break;case"select":F._wrapperState={wasMultiple:!!ne.multiple},Ys("invalid",F);break;case"textarea":tn(F,ne),Ys("invalid",F)}Xv(A,ne),Y=null;for(var ye in ne)if(ne.hasOwnProperty(ye)){var Le=ne[ye];ye==="children"?typeof Le=="string"?F.textContent!==Le&&(ne.suppressHydrationWarning!==!0&&nP(F.textContent,Le,f),Y=["children",Le]):typeof Le=="number"&&F.textContent!==""+Le&&(ne.suppressHydrationWarning!==!0&&nP(F.textContent,Le,f),Y=["children",""+Le]):b.hasOwnProperty(ye)&&Le!=null&&ye==="onScroll"&&Ys("scroll",F)}switch(A){case"input":Mr(F),ut(F,ne,!0);break;case"textarea":Mr(F),xr(F);break;case"select":case"option":break;default:typeof ne.onClick=="function"&&(F.onclick=rP)}F=Y,y.updateQueue=F,F!==null&&(y.flags|=4)}else{ye=Y.nodeType===9?Y:Y.ownerDocument,f==="http://www.w3.org/1999/xhtml"&&(f=Bi(A)),f==="http://www.w3.org/1999/xhtml"?A==="script"?(f=ye.createElement("div"),f.innerHTML="<script><\/script>",f=f.removeChild(f.firstChild)):typeof F.is=="string"?f=ye.createElement(A,{is:F.is}):(f=ye.createElement(A),A==="select"&&(ye=f,F.multiple?ye.multiple=!0:F.size&&(ye.size=F.size))):f=ye.createElementNS(f,A),f[Fp]=y,f[VS]=F,Hfe(f,y,!1,!1),y.stateNode=f;e:{switch(ye=_S(A,F),A){case"dialog":Ys("cancel",f),Ys("close",f),Y=F;break;case"iframe":case"object":case"embed":Ys("load",f),Y=F;break;case"video":case"audio":for(Y=0;Y<BS.length;Y++)Ys(BS[Y],f);Y=F;break;case"source":Ys("error",f),Y=F;break;case"img":case"image":case"link":Ys("error",f),Ys("load",f),Y=F;break;case"details":Ys("toggle",f),Y=F;break;case"input":It(f,F),Y=Lt(f,F),Ys("invalid",f);break;case"option":Y=F;break;case"select":f._wrapperState={wasMultiple:!!F.multiple},Y=be({},F,{value:void 0}),Ys("invalid",f);break;case"textarea":tn(f,F),Y=fn(f,F),Ys("invalid",f);break;default:Y=F}Xv(A,Y),Le=Y;for(ne in Le)if(Le.hasOwnProperty(ne)){var Qe=Le[ne];ne==="style"?qv(f,Qe):ne==="dangerouslySetInnerHTML"?(Qe=Qe?Qe.__html:void 0,Qe!=null&&J9(f,Qe)):ne==="children"?typeof Qe=="string"?(A!=="textarea"||Qe!=="")&&A0(f,Qe):typeof Qe=="number"&&A0(f,""+Qe):ne!=="suppressContentEditableWarning"&&ne!=="suppressHydrationWarning"&&ne!=="autoFocus"&&(b.hasOwnProperty(ne)?Qe!=null&&ne==="onScroll"&&Ys("scroll",f):Qe!=null&&pe(f,ne,Qe,ye))}switch(A){case"input":Mr(f),ut(f,F,!1);break;case"textarea":Mr(f),xr(f);break;case"option":F.value!=null&&f.setAttribute("value",""+Dn(F.value));break;case"select":f.multiple=!!F.multiple,ne=F.value,ne!=null?wt(f,!!F.multiple,ne,!1):F.defaultValue!=null&&wt(f,!!F.multiple,F.defaultValue,!0);break;default:typeof Y.onClick=="function"&&(f.onclick=rP)}switch(A){case"button":case"input":case"select":case"textarea":F=!!F.autoFocus;break e;case"img":F=!0;break e;default:F=!1}}F&&(y.flags|=4)}y.ref!==null&&(y.flags|=512,y.flags|=2097152)}return k0(y),null;case 6:if(f&&y.stateNode!=null)$fe(f,y,f.memoizedProps,F);else{if(typeof F!="string"&&y.stateNode===null)throw Error(m(166));if(A=M8($S.current),M8(Lp.current),uP(y)){if(F=y.stateNode,A=y.memoizedProps,F[Fp]=y,(ne=F.nodeValue!==A)&&(f=cu,f!==null))switch(f.tag){case 3:nP(F.nodeValue,A,(f.mode&1)!==0);break;case 5:f.memoizedProps.suppressHydrationWarning!==!0&&nP(F.nodeValue,A,(f.mode&1)!==0)}ne&&(y.flags|=4)}else F=(A.nodeType===9?A:A.ownerDocument).createTextNode(F),F[Fp]=y,y.stateNode=F}return k0(y),null;case 13:if(Ks(po),F=y.memoizedState,f===null||f.memoizedState!==null&&f.memoizedState.dehydrated!==null){if(no&&uu!==null&&y.mode&1&&!(y.flags&128))Xde(),c7(),y.flags|=98560,ne=!1;else if(ne=uP(y),F!==null&&F.dehydrated!==null){if(f===null){if(!ne)throw Error(m(318));if(ne=y.memoizedState,ne=ne!==null?ne.dehydrated:null,!ne)throw Error(m(317));ne[Fp]=y}else c7(),!(y.flags&128)&&(y.memoizedState=null),y.flags|=4;k0(y),ne=!1}else Vd!==null&&(WU(Vd),Vd=null),ne=!0;if(!ne)return y.flags&65536?y:null}return y.flags&128?(y.lanes=A,y):(F=F!==null,F!==(f!==null&&f.memoizedState!==null)&&F&&(y.child.flags|=8192,y.mode&1&&(f===null||po.current&1?fa===0&&(fa=3):XU())),y.updateQueue!==null&&(y.flags|=4),k0(y),null);case 4:return f7(),OU(f,y),f===null&&US(y.stateNode.containerInfo),k0(y),null;case 10:return cU(y.type._context),k0(y),null;case 17:return hc(y.type)&&sP(),k0(y),null;case 19:if(Ks(po),ne=y.memoizedState,ne===null)return k0(y),null;if(F=(y.flags&128)!==0,ye=ne.rendering,ye===null)if(F)ZS(ne,!1);else{if(fa!==0||f!==null&&f.flags&128)for(f=y.child;f!==null;){if(ye=yP(f),ye!==null){for(y.flags|=128,ZS(ne,!1),F=ye.updateQueue,F!==null&&(y.updateQueue=F,y.flags|=4),y.subtreeFlags=0,F=A,A=y.child;A!==null;)ne=A,f=F,ne.flags&=14680066,ye=ne.alternate,ye===null?(ne.childLanes=0,ne.lanes=f,ne.child=null,ne.subtreeFlags=0,ne.memoizedProps=null,ne.memoizedState=null,ne.updateQueue=null,ne.dependencies=null,ne.stateNode=null):(ne.childLanes=ye.childLanes,ne.lanes=ye.lanes,ne.child=ye.child,ne.subtreeFlags=0,ne.deletions=null,ne.memoizedProps=ye.memoizedProps,ne.memoizedState=ye.memoizedState,ne.updateQueue=ye.updateQueue,ne.type=ye.type,f=ye.dependencies,ne.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext}),A=A.sibling;return Ns(po,po.current&1|2),y.child}f=f.sibling}ne.tail!==null&&Uo()>y7&&(y.flags|=128,F=!0,ZS(ne,!1),y.lanes=4194304)}else{if(!F)if(f=yP(ye),f!==null){if(y.flags|=128,F=!0,A=f.updateQueue,A!==null&&(y.updateQueue=A,y.flags|=4),ZS(ne,!0),ne.tail===null&&ne.tailMode==="hidden"&&!ye.alternate&&!no)return k0(y),null}else 2*Uo()-ne.renderingStartTime>y7&&A!==1073741824&&(y.flags|=128,F=!0,ZS(ne,!1),y.lanes=4194304);ne.isBackwards?(ye.sibling=y.child,y.child=ye):(A=ne.last,A!==null?A.sibling=ye:y.child=ye,ne.last=ye)}return ne.tail!==null?(y=ne.tail,ne.rendering=y,ne.tail=y.sibling,ne.renderingStartTime=Uo(),y.sibling=null,A=po.current,Ns(po,F?A&1|2:A&1),y):(k0(y),null);case 22:case 23:return qU(),F=y.memoizedState!==null,f!==null&&f.memoizedState!==null!==F&&(y.flags|=8192),F&&y.mode&1?hu&1073741824&&(k0(y),y.subtreeFlags&6&&(y.flags|=8192)):k0(y),null;case 24:return null;case 25:return null}throw Error(m(156,y.tag))}function pEe(f,y){switch(rU(y),y.tag){case 1:return hc(y.type)&&sP(),f=y.flags,f&65536?(y.flags=f&-65537|128,y):null;case 3:return f7(),Ks(uc),Ks(P0),vU(),f=y.flags,f&65536&&!(f&128)?(y.flags=f&-65537|128,y):null;case 5:return gU(y),null;case 13:if(Ks(po),f=y.memoizedState,f!==null&&f.dehydrated!==null){if(y.alternate===null)throw Error(m(340));c7()}return f=y.flags,f&65536?(y.flags=f&-65537|128,y):null;case 19:return Ks(po),null;case 4:return f7(),null;case 10:return cU(y.type._context),null;case 22:case 23:return qU(),null;case 24:return null;default:return null}}var TP=!1,I0=!1,mEe=typeof WeakSet=="function"?WeakSet:Set,ir=null;function m7(f,y){var A=f.ref;if(A!==null)if(typeof A=="function")try{A(null)}catch(F){Ao(f,y,F)}else A.current=null}function qfe(f,y,A){try{A()}catch(F){Ao(f,y,F)}}var Xfe=!1;function gEe(f,y){if(XB=GA,f=Sde(),GB(f)){if("selectionStart"in f)var A={start:f.selectionStart,end:f.selectionEnd};else e:{A=(A=f.ownerDocument)&&A.defaultView||window;var F=A.getSelection&&A.getSelection();if(F&&F.rangeCount!==0){A=F.anchorNode;var Y=F.anchorOffset,ne=F.focusNode;F=F.focusOffset;try{A.nodeType,ne.nodeType}catch{A=null;break e}var ye=0,Le=-1,Qe=-1,Bt=0,_n=0,Sn=f,pn=null;t:for(;;){for(var Qn;Sn!==A||Y!==0&&Sn.nodeType!==3||(Le=ye+Y),Sn!==ne||F!==0&&Sn.nodeType!==3||(Qe=ye+F),Sn.nodeType===3&&(ye+=Sn.nodeValue.length),(Qn=Sn.firstChild)!==null;)pn=Sn,Sn=Qn;for(;;){if(Sn===f)break t;if(pn===A&&++Bt===Y&&(Le=ye),pn===ne&&++_n===F&&(Qe=ye),(Qn=Sn.nextSibling)!==null)break;Sn=pn,pn=Sn.parentNode}Sn=Qn}A=Le===-1||Qe===-1?null:{start:Le,end:Qe}}else A=null}A=A||{start:0,end:0}}else A=null;for(YB={focusedElem:f,selectionRange:A},GA=!1,ir=y;ir!==null;)if(y=ir,f=y.child,(y.subtreeFlags&1028)!==0&&f!==null)f.return=y,ir=f;else for(;ir!==null;){y=ir;try{var hr=y.alternate;if(y.flags&1024)switch(y.tag){case 0:case 11:case 15:break;case 1:if(hr!==null){var pr=hr.memoizedProps,zo=hr.memoizedState,Et=y.stateNode,it=Et.getSnapshotBeforeUpdate(y.elementType===y.type?pr:Gd(y.type,pr),zo);Et.__reactInternalSnapshotBeforeUpdate=it}break;case 3:var Rt=y.stateNode.containerInfo;Rt.nodeType===1?Rt.textContent="":Rt.nodeType===9&&Rt.documentElement&&Rt.removeChild(Rt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(m(163))}}catch(Cn){Ao(y,y.return,Cn)}if(f=y.sibling,f!==null){f.return=y.return,ir=f;break}ir=y.return}return hr=Xfe,Xfe=!1,hr}function QS(f,y,A){var F=y.updateQueue;if(F=F!==null?F.lastEffect:null,F!==null){var Y=F=F.next;do{if((Y.tag&f)===f){var ne=Y.destroy;Y.destroy=void 0,ne!==void 0&&qfe(y,A,ne)}Y=Y.next}while(Y!==F)}}function MP(f,y){if(y=y.updateQueue,y=y!==null?y.lastEffect:null,y!==null){var A=y=y.next;do{if((A.tag&f)===f){var F=A.create;A.destroy=F()}A=A.next}while(A!==y)}}function FU(f){var y=f.ref;if(y!==null){var A=f.stateNode;switch(f.tag){case 5:f=A;break;default:f=A}typeof y=="function"?y(f):y.current=f}}function Yfe(f){var y=f.alternate;y!==null&&(f.alternate=null,Yfe(y)),f.child=null,f.deletions=null,f.sibling=null,f.tag===5&&(y=f.stateNode,y!==null&&(delete y[Fp],delete y[VS],delete y[JB],delete y[Qwe],delete y[Jwe])),f.stateNode=null,f.return=null,f.dependencies=null,f.memoizedProps=null,f.memoizedState=null,f.pendingProps=null,f.stateNode=null,f.updateQueue=null}function Kfe(f){return f.tag===5||f.tag===3||f.tag===4}function Zfe(f){e:for(;;){for(;f.sibling===null;){if(f.return===null||Kfe(f.return))return null;f=f.return}for(f.sibling.return=f.return,f=f.sibling;f.tag!==5&&f.tag!==6&&f.tag!==18;){if(f.flags&2||f.child===null||f.tag===4)continue e;f.child.return=f,f=f.child}if(!(f.flags&2))return f.stateNode}}function LU(f,y,A){var F=f.tag;if(F===5||F===6)f=f.stateNode,y?A.nodeType===8?A.parentNode.insertBefore(f,y):A.insertBefore(f,y):(A.nodeType===8?(y=A.parentNode,y.insertBefore(f,A)):(y=A,y.appendChild(f)),A=A._reactRootContainer,A!=null||y.onclick!==null||(y.onclick=rP));else if(F!==4&&(f=f.child,f!==null))for(LU(f,y,A),f=f.sibling;f!==null;)LU(f,y,A),f=f.sibling}function BU(f,y,A){var F=f.tag;if(F===5||F===6)f=f.stateNode,y?A.insertBefore(f,y):A.appendChild(f);else if(F!==4&&(f=f.child,f!==null))for(BU(f,y,A),f=f.sibling;f!==null;)BU(f,y,A),f=f.sibling}var i0=null,jd=!1;function d3(f,y,A){for(A=A.child;A!==null;)Qfe(f,y,A),A=A.sibling}function Qfe(f,y,A){if(Op&&typeof Op.onCommitFiberUnmount=="function")try{Op.onCommitFiberUnmount(FA,A)}catch{}switch(A.tag){case 5:I0||m7(A,y);case 6:var F=i0,Y=jd;i0=null,d3(f,y,A),i0=F,jd=Y,i0!==null&&(jd?(f=i0,A=A.stateNode,f.nodeType===8?f.parentNode.removeChild(A):f.removeChild(A)):i0.removeChild(A.stateNode));break;case 18:i0!==null&&(jd?(f=i0,A=A.stateNode,f.nodeType===8?QB(f.parentNode,A):f.nodeType===1&&QB(f,A),RS(f)):QB(i0,A.stateNode));break;case 4:F=i0,Y=jd,i0=A.stateNode.containerInfo,jd=!0,d3(f,y,A),i0=F,jd=Y;break;case 0:case 11:case 14:case 15:if(!I0&&(F=A.updateQueue,F!==null&&(F=F.lastEffect,F!==null))){Y=F=F.next;do{var ne=Y,ye=ne.destroy;ne=ne.tag,ye!==void 0&&(ne&2||ne&4)&&qfe(A,y,ye),Y=Y.next}while(Y!==F)}d3(f,y,A);break;case 1:if(!I0&&(m7(A,y),F=A.stateNode,typeof F.componentWillUnmount=="function"))try{F.props=A.memoizedProps,F.state=A.memoizedState,F.componentWillUnmount()}catch(Le){Ao(A,y,Le)}d3(f,y,A);break;case 21:d3(f,y,A);break;case 22:A.mode&1?(I0=(F=I0)||A.memoizedState!==null,d3(f,y,A),I0=F):d3(f,y,A);break;default:d3(f,y,A)}}function Jfe(f){var y=f.updateQueue;if(y!==null){f.updateQueue=null;var A=f.stateNode;A===null&&(A=f.stateNode=new mEe),y.forEach(function(F){var Y=TEe.bind(null,f,F);A.has(F)||(A.add(F),F.then(Y,Y))})}}function Hd(f,y){var A=y.deletions;if(A!==null)for(var F=0;F<A.length;F++){var Y=A[F];try{var ne=f,ye=y,Le=ye;e:for(;Le!==null;){switch(Le.tag){case 5:i0=Le.stateNode,jd=!1;break e;case 3:i0=Le.stateNode.containerInfo,jd=!0;break e;case 4:i0=Le.stateNode.containerInfo,jd=!0;break e}Le=Le.return}if(i0===null)throw Error(m(160));Qfe(ne,ye,Y),i0=null,jd=!1;var Qe=Y.alternate;Qe!==null&&(Qe.return=null),Y.return=null}catch(Bt){Ao(Y,y,Bt)}}if(y.subtreeFlags&12854)for(y=y.child;y!==null;)epe(y,f),y=y.sibling}function epe(f,y){var A=f.alternate,F=f.flags;switch(f.tag){case 0:case 11:case 14:case 15:if(Hd(y,f),Up(f),F&4){try{QS(3,f,f.return),MP(3,f)}catch(pr){Ao(f,f.return,pr)}try{QS(5,f,f.return)}catch(pr){Ao(f,f.return,pr)}}break;case 1:Hd(y,f),Up(f),F&512&&A!==null&&m7(A,A.return);break;case 5:if(Hd(y,f),Up(f),F&512&&A!==null&&m7(A,A.return),f.flags&32){var Y=f.stateNode;try{A0(Y,"")}catch(pr){Ao(f,f.return,pr)}}if(F&4&&(Y=f.stateNode,Y!=null)){var ne=f.memoizedProps,ye=A!==null?A.memoizedProps:ne,Le=f.type,Qe=f.updateQueue;if(f.updateQueue=null,Qe!==null)try{Le==="input"&&ne.type==="radio"&&ne.name!=null&&ke(Y,ne),_S(Le,ye);var Bt=_S(Le,ne);for(ye=0;ye<Qe.length;ye+=2){var _n=Qe[ye],Sn=Qe[ye+1];_n==="style"?qv(Y,Sn):_n==="dangerouslySetInnerHTML"?J9(Y,Sn):_n==="children"?A0(Y,Sn):pe(Y,_n,Sn,Bt)}switch(Le){case"input":Re(Y,ne);break;case"textarea":sn(Y,ne);break;case"select":var pn=Y._wrapperState.wasMultiple;Y._wrapperState.wasMultiple=!!ne.multiple;var Qn=ne.value;Qn!=null?wt(Y,!!ne.multiple,Qn,!1):pn!==!!ne.multiple&&(ne.defaultValue!=null?wt(Y,!!ne.multiple,ne.defaultValue,!0):wt(Y,!!ne.multiple,ne.multiple?[]:"",!1))}Y[VS]=ne}catch(pr){Ao(f,f.return,pr)}}break;case 6:if(Hd(y,f),Up(f),F&4){if(f.stateNode===null)throw Error(m(162));Y=f.stateNode,ne=f.memoizedProps;try{Y.nodeValue=ne}catch(pr){Ao(f,f.return,pr)}}break;case 3:if(Hd(y,f),Up(f),F&4&&A!==null&&A.memoizedState.isDehydrated)try{RS(y.containerInfo)}catch(pr){Ao(f,f.return,pr)}break;case 4:Hd(y,f),Up(f);break;case 13:Hd(y,f),Up(f),Y=f.child,Y.flags&8192&&(ne=Y.memoizedState!==null,Y.stateNode.isHidden=ne,!ne||Y.alternate!==null&&Y.alternate.memoizedState!==null||(VU=Uo())),F&4&&Jfe(f);break;case 22:if(_n=A!==null&&A.memoizedState!==null,f.mode&1?(I0=(Bt=I0)||_n,Hd(y,f),I0=Bt):Hd(y,f),Up(f),F&8192){if(Bt=f.memoizedState!==null,(f.stateNode.isHidden=Bt)&&!_n&&f.mode&1)for(ir=f,_n=f.child;_n!==null;){for(Sn=ir=_n;ir!==null;){switch(pn=ir,Qn=pn.child,pn.tag){case 0:case 11:case 14:case 15:QS(4,pn,pn.return);break;case 1:m7(pn,pn.return);var hr=pn.stateNode;if(typeof hr.componentWillUnmount=="function"){F=pn,A=pn.return;try{y=F,hr.props=y.memoizedProps,hr.state=y.memoizedState,hr.componentWillUnmount()}catch(pr){Ao(F,A,pr)}}break;case 5:m7(pn,pn.return);break;case 22:if(pn.memoizedState!==null){rpe(Sn);continue}}Qn!==null?(Qn.return=pn,ir=Qn):rpe(Sn)}_n=_n.sibling}e:for(_n=null,Sn=f;;){if(Sn.tag===5){if(_n===null){_n=Sn;try{Y=Sn.stateNode,Bt?(ne=Y.style,typeof ne.setProperty=="function"?ne.setProperty("display","none","important"):ne.display="none"):(Le=Sn.stateNode,Qe=Sn.memoizedProps.style,ye=Qe!=null&&Qe.hasOwnProperty("display")?Qe.display:null,Le.style.display=_8("display",ye))}catch(pr){Ao(f,f.return,pr)}}}else if(Sn.tag===6){if(_n===null)try{Sn.stateNode.nodeValue=Bt?"":Sn.memoizedProps}catch(pr){Ao(f,f.return,pr)}}else if((Sn.tag!==22&&Sn.tag!==23||Sn.memoizedState===null||Sn===f)&&Sn.child!==null){Sn.child.return=Sn,Sn=Sn.child;continue}if(Sn===f)break e;for(;Sn.sibling===null;){if(Sn.return===null||Sn.return===f)break e;_n===Sn&&(_n=null),Sn=Sn.return}_n===Sn&&(_n=null),Sn.sibling.return=Sn.return,Sn=Sn.sibling}}break;case 19:Hd(y,f),Up(f),F&4&&Jfe(f);break;case 21:break;default:Hd(y,f),Up(f)}}function Up(f){var y=f.flags;if(y&2){try{e:{for(var A=f.return;A!==null;){if(Kfe(A)){var F=A;break e}A=A.return}throw Error(m(160))}switch(F.tag){case 5:var Y=F.stateNode;F.flags&32&&(A0(Y,""),F.flags&=-33);var ne=Zfe(f);BU(f,ne,Y);break;case 3:case 4:var ye=F.stateNode.containerInfo,Le=Zfe(f);LU(f,Le,ye);break;default:throw Error(m(161))}}catch(Qe){Ao(f,f.return,Qe)}f.flags&=-3}y&4096&&(f.flags&=-4097)}function yEe(f,y,A){ir=f,tpe(f)}function tpe(f,y,A){for(var F=(f.mode&1)!==0;ir!==null;){var Y=ir,ne=Y.child;if(Y.tag===22&&F){var ye=Y.memoizedState!==null||TP;if(!ye){var Le=Y.alternate,Qe=Le!==null&&Le.memoizedState!==null||I0;Le=TP;var Bt=I0;if(TP=ye,(I0=Qe)&&!Bt)for(ir=Y;ir!==null;)ye=ir,Qe=ye.child,ye.tag===22&&ye.memoizedState!==null?ipe(Y):Qe!==null?(Qe.return=ye,ir=Qe):ipe(Y);for(;ne!==null;)ir=ne,tpe(ne),ne=ne.sibling;ir=Y,TP=Le,I0=Bt}npe(f)}else Y.subtreeFlags&8772&&ne!==null?(ne.return=Y,ir=ne):npe(f)}}function npe(f){for(;ir!==null;){var y=ir;if(y.flags&8772){var A=y.alternate;try{if(y.flags&8772)switch(y.tag){case 0:case 11:case 15:I0||MP(5,y);break;case 1:var F=y.stateNode;if(y.flags&4&&!I0)if(A===null)F.componentDidMount();else{var Y=y.elementType===y.type?A.memoizedProps:Gd(y.type,A.memoizedProps);F.componentDidUpdate(Y,A.memoizedState,F.__reactInternalSnapshotBeforeUpdate)}var ne=y.updateQueue;ne!==null&&Qde(y,ne,F);break;case 3:var ye=y.updateQueue;if(ye!==null){if(A=null,y.child!==null)switch(y.child.tag){case 5:A=y.child.stateNode;break;case 1:A=y.child.stateNode}Qde(y,ye,A)}break;case 5:var Le=y.stateNode;if(A===null&&y.flags&4){A=Le;var Qe=y.memoizedProps;switch(y.type){case"button":case"input":case"select":case"textarea":Qe.autoFocus&&A.focus();break;case"img":Qe.src&&(A.src=Qe.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(y.memoizedState===null){var Bt=y.alternate;if(Bt!==null){var _n=Bt.memoizedState;if(_n!==null){var Sn=_n.dehydrated;Sn!==null&&RS(Sn)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(m(163))}I0||y.flags&512&&FU(y)}catch(pn){Ao(y,y.return,pn)}}if(y===f){ir=null;break}if(A=y.sibling,A!==null){A.return=y.return,ir=A;break}ir=y.return}}function rpe(f){for(;ir!==null;){var y=ir;if(y===f){ir=null;break}var A=y.sibling;if(A!==null){A.return=y.return,ir=A;break}ir=y.return}}function ipe(f){for(;ir!==null;){var y=ir;try{switch(y.tag){case 0:case 11:case 15:var A=y.return;try{MP(4,y)}catch(Qe){Ao(y,A,Qe)}break;case 1:var F=y.stateNode;if(typeof F.componentDidMount=="function"){var Y=y.return;try{F.componentDidMount()}catch(Qe){Ao(y,Y,Qe)}}var ne=y.return;try{FU(y)}catch(Qe){Ao(y,ne,Qe)}break;case 5:var ye=y.return;try{FU(y)}catch(Qe){Ao(y,ye,Qe)}}}catch(Qe){Ao(y,y.return,Qe)}if(y===f){ir=null;break}var Le=y.sibling;if(Le!==null){Le.return=y.return,ir=Le;break}ir=y.return}}var vEe=Math.ceil,CP=fe.ReactCurrentDispatcher,UU=fe.ReactCurrentOwner,gh=fe.ReactCurrentBatchConfig,Ui=0,Ia=null,Qo=null,s0=0,hu=0,g7=a3(0),fa=0,JS=null,A8=0,AP=0,zU=0,ew=null,fc=null,VU=0,y7=1/0,eg=null,PP=!1,GU=null,f3=null,RP=!1,p3=null,kP=0,tw=0,jU=null,IP=-1,NP=0;function wl(){return Ui&6?Uo():IP!==-1?IP:IP=Uo()}function m3(f){return f.mode&1?Ui&2&&s0!==0?s0&-s0:tEe.transition!==null?(NP===0&&(NP=Xhe()),NP):(f=us,f!==0||(f=window.event,f=f===void 0?16:rde(f.type)),f):1}function Wd(f,y,A,F){if(50<tw)throw tw=0,jU=null,Error(m(185));TS(f,A,F),(!(Ui&2)||f!==Ia)&&(f===Ia&&(!(Ui&2)&&(AP|=A),fa===4&&g3(f,s0)),pc(f,F),A===1&&Ui===0&&!(y.mode&1)&&(y7=Uo()+500,aP&&c3()))}function pc(f,y){var A=f.callbackNode;rwe(f,y);var F=UA(f,f===Ia?s0:0);if(F===0)A!==null&&Whe(A),f.callbackNode=null,f.callbackPriority=0;else if(y=F&-F,f.callbackPriority!==y){if(A!=null&&Whe(A),y===1)f.tag===0?eEe(ope.bind(null,f)):jde(ope.bind(null,f)),Kwe(function(){!(Ui&6)&&c3()}),A=null;else{switch(Yhe(F)){case 1:A=TB;break;case 4:A=$he;break;case 16:A=OA;break;case 536870912:A=qhe;break;default:A=OA}A=ppe(A,spe.bind(null,f))}f.callbackPriority=y,f.callbackNode=A}}function spe(f,y){if(IP=-1,NP=0,Ui&6)throw Error(m(327));var A=f.callbackNode;if(v7()&&f.callbackNode!==A)return null;var F=UA(f,f===Ia?s0:0);if(F===0)return null;if(F&30||F&f.expiredLanes||y)y=DP(f,F);else{y=F;var Y=Ui;Ui|=2;var ne=lpe();(Ia!==f||s0!==y)&&(eg=null,y7=Uo()+500,R8(f,y));do try{bEe();break}catch(Le){ape(f,Le)}while(!0);lU(),CP.current=ne,Ui=Y,Qo!==null?y=0:(Ia=null,s0=0,y=fa)}if(y!==0){if(y===2&&(Y=MB(f),Y!==0&&(F=Y,y=HU(f,Y))),y===1)throw A=JS,R8(f,0),g3(f,F),pc(f,Uo()),A;if(y===6)g3(f,F);else{if(Y=f.current.alternate,!(F&30)&&!_Ee(Y)&&(y=DP(f,F),y===2&&(ne=MB(f),ne!==0&&(F=ne,y=HU(f,ne))),y===1))throw A=JS,R8(f,0),g3(f,F),pc(f,Uo()),A;switch(f.finishedWork=Y,f.finishedLanes=F,y){case 0:case 1:throw Error(m(345));case 2:k8(f,fc,eg);break;case 3:if(g3(f,F),(F&130023424)===F&&(y=VU+500-Uo(),10<y)){if(UA(f,0)!==0)break;if(Y=f.suspendedLanes,(Y&F)!==F){wl(),f.pingedLanes|=f.suspendedLanes&Y;break}f.timeoutHandle=ZB(k8.bind(null,f,fc,eg),y);break}k8(f,fc,eg);break;case 4:if(g3(f,F),(F&4194240)===F)break;for(y=f.eventTimes,Y=-1;0<F;){var ye=31-Ud(F);ne=1<<ye,ye=y[ye],ye>Y&&(Y=ye),F&=~ne}if(F=Y,F=Uo()-F,F=(120>F?120:480>F?480:1080>F?1080:1920>F?1920:3e3>F?3e3:4320>F?4320:1960*vEe(F/1960))-F,10<F){f.timeoutHandle=ZB(k8.bind(null,f,fc,eg),F);break}k8(f,fc,eg);break;case 5:k8(f,fc,eg);break;default:throw Error(m(329))}}}return pc(f,Uo()),f.callbackNode===A?spe.bind(null,f):null}function HU(f,y){var A=ew;return f.current.memoizedState.isDehydrated&&(R8(f,y).flags|=256),f=DP(f,y),f!==2&&(y=fc,fc=A,y!==null&&WU(y)),f}function WU(f){fc===null?fc=f:fc.push.apply(fc,f)}function _Ee(f){for(var y=f;;){if(y.flags&16384){var A=y.updateQueue;if(A!==null&&(A=A.stores,A!==null))for(var F=0;F<A.length;F++){var Y=A[F],ne=Y.getSnapshot;Y=Y.value;try{if(!zd(ne(),Y))return!1}catch{return!1}}}if(A=y.child,y.subtreeFlags&16384&&A!==null)A.return=y,y=A;else{if(y===f)break;for(;y.sibling===null;){if(y.return===null||y.return===f)return!0;y=y.return}y.sibling.return=y.return,y=y.sibling}}return!0}function g3(f,y){for(y&=~zU,y&=~AP,f.suspendedLanes|=y,f.pingedLanes&=~y,f=f.expirationTimes;0<y;){var A=31-Ud(y),F=1<<A;f[A]=-1,y&=~F}}function ope(f){if(Ui&6)throw Error(m(327));v7();var y=UA(f,0);if(!(y&1))return pc(f,Uo()),null;var A=DP(f,y);if(f.tag!==0&&A===2){var F=MB(f);F!==0&&(y=F,A=HU(f,F))}if(A===1)throw A=JS,R8(f,0),g3(f,y),pc(f,Uo()),A;if(A===6)throw Error(m(345));return f.finishedWork=f.current.alternate,f.finishedLanes=y,k8(f,fc,eg),pc(f,Uo()),null}function $U(f,y){var A=Ui;Ui|=1;try{return f(y)}finally{Ui=A,Ui===0&&(y7=Uo()+500,aP&&c3())}}function P8(f){p3!==null&&p3.tag===0&&!(Ui&6)&&v7();var y=Ui;Ui|=1;var A=gh.transition,F=us;try{if(gh.transition=null,us=1,f)return f()}finally{us=F,gh.transition=A,Ui=y,!(Ui&6)&&c3()}}function qU(){hu=g7.current,Ks(g7)}function R8(f,y){f.finishedWork=null,f.finishedLanes=0;var A=f.timeoutHandle;if(A!==-1&&(f.timeoutHandle=-1,Ywe(A)),Qo!==null)for(A=Qo.return;A!==null;){var F=A;switch(rU(F),F.tag){case 1:F=F.type.childContextTypes,F!=null&&sP();break;case 3:f7(),Ks(uc),Ks(P0),vU();break;case 5:gU(F);break;case 4:f7();break;case 13:Ks(po);break;case 19:Ks(po);break;case 10:cU(F.type._context);break;case 22:case 23:qU()}A=A.return}if(Ia=f,Qo=f=y3(f.current,null),s0=hu=y,fa=0,JS=null,zU=AP=A8=0,fc=ew=null,T8!==null){for(y=0;y<T8.length;y++)if(A=T8[y],F=A.interleaved,F!==null){A.interleaved=null;var Y=F.next,ne=A.pending;if(ne!==null){var ye=ne.next;ne.next=Y,F.next=ye}A.pending=F}T8=null}return f}function ape(f,y){do{var A=Qo;try{if(lU(),vP.current=SP,_P){for(var F=mo.memoizedState;F!==null;){var Y=F.queue;Y!==null&&(Y.pending=null),F=F.next}_P=!1}if(C8=0,ka=da=mo=null,qS=!1,XS=0,UU.current=null,A===null||A.return===null){fa=1,JS=y,Qo=null;break}e:{var ne=f,ye=A.return,Le=A,Qe=y;if(y=s0,Le.flags|=32768,Qe!==null&&typeof Qe=="object"&&typeof Qe.then=="function"){var Bt=Qe,_n=Le,Sn=_n.tag;if(!(_n.mode&1)&&(Sn===0||Sn===11||Sn===15)){var pn=_n.alternate;pn?(_n.updateQueue=pn.updateQueue,_n.memoizedState=pn.memoizedState,_n.lanes=pn.lanes):(_n.updateQueue=null,_n.memoizedState=null)}var Qn=kfe(ye);if(Qn!==null){Qn.flags&=-257,Ife(Qn,ye,Le,ne,y),Qn.mode&1&&Rfe(ne,Bt,y),y=Qn,Qe=Bt;var hr=y.updateQueue;if(hr===null){var pr=new Set;pr.add(Qe),y.updateQueue=pr}else hr.add(Qe);break e}else{if(!(y&1)){Rfe(ne,Bt,y),XU();break e}Qe=Error(m(426))}}else if(no&&Le.mode&1){var zo=kfe(ye);if(zo!==null){!(zo.flags&65536)&&(zo.flags|=256),Ife(zo,ye,Le,ne,y),oU(p7(Qe,Le));break e}}ne=Qe=p7(Qe,Le),fa!==4&&(fa=2),ew===null?ew=[ne]:ew.push(ne),ne=ye;do{switch(ne.tag){case 3:ne.flags|=65536,y&=-y,ne.lanes|=y;var Et=Afe(ne,Qe,y);Zde(ne,Et);break e;case 1:Le=Qe;var it=ne.type,Rt=ne.stateNode;if(!(ne.flags&128)&&(typeof it.getDerivedStateFromError=="function"||Rt!==null&&typeof Rt.componentDidCatch=="function"&&(f3===null||!f3.has(Rt)))){ne.flags|=65536,y&=-y,ne.lanes|=y;var Cn=Pfe(ne,Le,y);Zde(ne,Cn);break e}}ne=ne.return}while(ne!==null)}upe(A)}catch(_r){y=_r,Qo===A&&A!==null&&(Qo=A=A.return);continue}break}while(!0)}function lpe(){var f=CP.current;return CP.current=SP,f===null?SP:f}function XU(){(fa===0||fa===3||fa===2)&&(fa=4),Ia===null||!(A8&268435455)&&!(AP&268435455)||g3(Ia,s0)}function DP(f,y){var A=Ui;Ui|=2;var F=lpe();(Ia!==f||s0!==y)&&(eg=null,R8(f,y));do try{xEe();break}catch(Y){ape(f,Y)}while(!0);if(lU(),Ui=A,CP.current=F,Qo!==null)throw Error(m(261));return Ia=null,s0=0,fa}function xEe(){for(;Qo!==null;)cpe(Qo)}function bEe(){for(;Qo!==null&&!XSe();)cpe(Qo)}function cpe(f){var y=fpe(f.alternate,f,hu);f.memoizedProps=f.pendingProps,y===null?upe(f):Qo=y,UU.current=null}function upe(f){var y=f;do{var A=y.alternate;if(f=y.return,y.flags&32768){if(A=pEe(A,y),A!==null){A.flags&=32767,Qo=A;return}if(f!==null)f.flags|=32768,f.subtreeFlags=0,f.deletions=null;else{fa=6,Qo=null;return}}else if(A=fEe(A,y,hu),A!==null){Qo=A;return}if(y=y.sibling,y!==null){Qo=y;return}Qo=y=f}while(y!==null);fa===0&&(fa=5)}function k8(f,y,A){var F=us,Y=gh.transition;try{gh.transition=null,us=1,SEe(f,y,A,F)}finally{gh.transition=Y,us=F}return null}function SEe(f,y,A,F){do v7();while(p3!==null);if(Ui&6)throw Error(m(327));A=f.finishedWork;var Y=f.finishedLanes;if(A===null)return null;if(f.finishedWork=null,f.finishedLanes=0,A===f.current)throw Error(m(177));f.callbackNode=null,f.callbackPriority=0;var ne=A.lanes|A.childLanes;if(iwe(f,ne),f===Ia&&(Qo=Ia=null,s0=0),!(A.subtreeFlags&2064)&&!(A.flags&2064)||RP||(RP=!0,ppe(OA,function(){return v7(),null})),ne=(A.flags&15990)!==0,A.subtreeFlags&15990||ne){ne=gh.transition,gh.transition=null;var ye=us;us=1;var Le=Ui;Ui|=4,UU.current=null,gEe(f,A),epe(A,f),Hwe(YB),GA=!!XB,YB=XB=null,f.current=A,yEe(A),YSe(),Ui=Le,us=ye,gh.transition=ne}else f.current=A;if(RP&&(RP=!1,p3=f,kP=Y),ne=f.pendingLanes,ne===0&&(f3=null),QSe(A.stateNode),pc(f,Uo()),y!==null)for(F=f.onRecoverableError,A=0;A<y.length;A++)Y=y[A],F(Y.value,{componentStack:Y.stack,digest:Y.digest});if(PP)throw PP=!1,f=GU,GU=null,f;return kP&1&&f.tag!==0&&v7(),ne=f.pendingLanes,ne&1?f===jU?tw++:(tw=0,jU=f):tw=0,c3(),null}function v7(){if(p3!==null){var f=Yhe(kP),y=gh.transition,A=us;try{if(gh.transition=null,us=16>f?16:f,p3===null)var F=!1;else{if(f=p3,p3=null,kP=0,Ui&6)throw Error(m(331));var Y=Ui;for(Ui|=4,ir=f.current;ir!==null;){var ne=ir,ye=ne.child;if(ir.flags&16){var Le=ne.deletions;if(Le!==null){for(var Qe=0;Qe<Le.length;Qe++){var Bt=Le[Qe];for(ir=Bt;ir!==null;){var _n=ir;switch(_n.tag){case 0:case 11:case 15:QS(8,_n,ne)}var Sn=_n.child;if(Sn!==null)Sn.return=_n,ir=Sn;else for(;ir!==null;){_n=ir;var pn=_n.sibling,Qn=_n.return;if(Yfe(_n),_n===Bt){ir=null;break}if(pn!==null){pn.return=Qn,ir=pn;break}ir=Qn}}}var hr=ne.alternate;if(hr!==null){var pr=hr.child;if(pr!==null){hr.child=null;do{var zo=pr.sibling;pr.sibling=null,pr=zo}while(pr!==null)}}ir=ne}}if(ne.subtreeFlags&2064&&ye!==null)ye.return=ne,ir=ye;else e:for(;ir!==null;){if(ne=ir,ne.flags&2048)switch(ne.tag){case 0:case 11:case 15:QS(9,ne,ne.return)}var Et=ne.sibling;if(Et!==null){Et.return=ne.return,ir=Et;break e}ir=ne.return}}var it=f.current;for(ir=it;ir!==null;){ye=ir;var Rt=ye.child;if(ye.subtreeFlags&2064&&Rt!==null)Rt.return=ye,ir=Rt;else e:for(ye=it;ir!==null;){if(Le=ir,Le.flags&2048)try{switch(Le.tag){case 0:case 11:case 15:MP(9,Le)}}catch(_r){Ao(Le,Le.return,_r)}if(Le===ye){ir=null;break e}var Cn=Le.sibling;if(Cn!==null){Cn.return=Le.return,ir=Cn;break e}ir=Le.return}}if(Ui=Y,c3(),Op&&typeof Op.onPostCommitFiberRoot=="function")try{Op.onPostCommitFiberRoot(FA,f)}catch{}F=!0}return F}finally{us=A,gh.transition=y}}return!1}function hpe(f,y,A){y=p7(A,y),y=Afe(f,y,1),f=h3(f,y,1),y=wl(),f!==null&&(TS(f,1,y),pc(f,y))}function Ao(f,y,A){if(f.tag===3)hpe(f,f,A);else for(;y!==null;){if(y.tag===3){hpe(y,f,A);break}else if(y.tag===1){var F=y.stateNode;if(typeof y.type.getDerivedStateFromError=="function"||typeof F.componentDidCatch=="function"&&(f3===null||!f3.has(F))){f=p7(A,f),f=Pfe(y,f,1),y=h3(y,f,1),f=wl(),y!==null&&(TS(y,1,f),pc(y,f));break}}y=y.return}}function wEe(f,y,A){var F=f.pingCache;F!==null&&F.delete(y),y=wl(),f.pingedLanes|=f.suspendedLanes&A,Ia===f&&(s0&A)===A&&(fa===4||fa===3&&(s0&130023424)===s0&&500>Uo()-VU?R8(f,0):zU|=A),pc(f,y)}function dpe(f,y){y===0&&(f.mode&1?(y=BA,BA<<=1,!(BA&130023424)&&(BA=4194304)):y=1);var A=wl();f=Zm(f,y),f!==null&&(TS(f,y,A),pc(f,A))}function EEe(f){var y=f.memoizedState,A=0;y!==null&&(A=y.retryLane),dpe(f,A)}function TEe(f,y){var A=0;switch(f.tag){case 13:var F=f.stateNode,Y=f.memoizedState;Y!==null&&(A=Y.retryLane);break;case 19:F=f.stateNode;break;default:throw Error(m(314))}F!==null&&F.delete(y),dpe(f,A)}var fpe;fpe=function(f,y,A){if(f!==null)if(f.memoizedProps!==y.pendingProps||uc.current)dc=!0;else{if(!(f.lanes&A)&&!(y.flags&128))return dc=!1,dEe(f,y,A);dc=!!(f.flags&131072)}else dc=!1,no&&y.flags&1048576&&Hde(y,cP,y.index);switch(y.lanes=0,y.tag){case 2:var F=y.type;EP(f,y),f=y.pendingProps;var Y=o7(y,P0.current);h7(y,A),Y=bU(null,y,F,f,Y,A);var ne=SU();return y.flags|=1,typeof Y=="object"&&Y!==null&&typeof Y.render=="function"&&Y.$$typeof===void 0?(y.tag=1,y.memoizedState=null,y.updateQueue=null,hc(F)?(ne=!0,oP(y)):ne=!1,y.memoizedState=Y.state!==null&&Y.state!==void 0?Y.state:null,dU(y),Y.updater=mP,y.stateNode=Y,Y._reactInternals=y,pU(y,F,f,A),y=RU(null,y,F,!0,ne,A)):(y.tag=0,no&&ne&&nU(y),Sl(null,y,Y,A),y=y.child),y;case 16:F=y.elementType;e:{switch(EP(f,y),f=y.pendingProps,Y=F._init,F=Y(F._payload),y.type=F,Y=y.tag=CEe(F),f=Gd(F,f),Y){case 0:y=PU(null,y,F,f,A);break e;case 1:y=Bfe(null,y,F,f,A);break e;case 11:y=Nfe(null,y,F,f,A);break e;case 14:y=Dfe(null,y,F,Gd(F.type,f),A);break e}throw Error(m(306,F,""))}return y;case 0:return F=y.type,Y=y.pendingProps,Y=y.elementType===F?Y:Gd(F,Y),PU(f,y,F,Y,A);case 1:return F=y.type,Y=y.pendingProps,Y=y.elementType===F?Y:Gd(F,Y),Bfe(f,y,F,Y,A);case 3:e:{if(Ufe(y),f===null)throw Error(m(387));F=y.pendingProps,ne=y.memoizedState,Y=ne.element,Kde(f,y),pP(y,F,null,A);var ye=y.memoizedState;if(F=ye.element,ne.isDehydrated)if(ne={element:F,isDehydrated:!1,cache:ye.cache,pendingSuspenseBoundaries:ye.pendingSuspenseBoundaries,transitions:ye.transitions},y.updateQueue.baseState=ne,y.memoizedState=ne,y.flags&256){Y=p7(Error(m(423)),y),y=zfe(f,y,F,A,Y);break e}else if(F!==Y){Y=p7(Error(m(424)),y),y=zfe(f,y,F,A,Y);break e}else for(uu=o3(y.stateNode.containerInfo.firstChild),cu=y,no=!0,Vd=null,A=sfe(y,null,F,A),y.child=A;A;)A.flags=A.flags&-3|4096,A=A.sibling;else{if(c7(),F===Y){y=Jm(f,y,A);break e}Sl(f,y,F,A)}y=y.child}return y;case 5:return ofe(y),f===null&&sU(y),F=y.type,Y=y.pendingProps,ne=f!==null?f.memoizedProps:null,ye=Y.children,KB(F,Y)?ye=null:ne!==null&&KB(F,ne)&&(y.flags|=32),Lfe(f,y),Sl(f,y,ye,A),y.child;case 6:return f===null&&sU(y),null;case 13:return Vfe(f,y,A);case 4:return mU(y,y.stateNode.containerInfo),F=y.pendingProps,f===null?y.child=d7(y,null,F,A):Sl(f,y,F,A),y.child;case 11:return F=y.type,Y=y.pendingProps,Y=y.elementType===F?Y:Gd(F,Y),Nfe(f,y,F,Y,A);case 7:return Sl(f,y,y.pendingProps,A),y.child;case 8:return Sl(f,y,y.pendingProps.children,A),y.child;case 12:return Sl(f,y,y.pendingProps.children,A),y.child;case 10:e:{if(F=y.type._context,Y=y.pendingProps,ne=y.memoizedProps,ye=Y.value,Ns(hP,F._currentValue),F._currentValue=ye,ne!==null)if(zd(ne.value,ye)){if(ne.children===Y.children&&!uc.current){y=Jm(f,y,A);break e}}else for(ne=y.child,ne!==null&&(ne.return=y);ne!==null;){var Le=ne.dependencies;if(Le!==null){ye=ne.child;for(var Qe=Le.firstContext;Qe!==null;){if(Qe.context===F){if(ne.tag===1){Qe=Qm(-1,A&-A),Qe.tag=2;var Bt=ne.updateQueue;if(Bt!==null){Bt=Bt.shared;var _n=Bt.pending;_n===null?Qe.next=Qe:(Qe.next=_n.next,_n.next=Qe),Bt.pending=Qe}}ne.lanes|=A,Qe=ne.alternate,Qe!==null&&(Qe.lanes|=A),uU(ne.return,A,y),Le.lanes|=A;break}Qe=Qe.next}}else if(ne.tag===10)ye=ne.type===y.type?null:ne.child;else if(ne.tag===18){if(ye=ne.return,ye===null)throw Error(m(341));ye.lanes|=A,Le=ye.alternate,Le!==null&&(Le.lanes|=A),uU(ye,A,y),ye=ne.sibling}else ye=ne.child;if(ye!==null)ye.return=ne;else for(ye=ne;ye!==null;){if(ye===y){ye=null;break}if(ne=ye.sibling,ne!==null){ne.return=ye.return,ye=ne;break}ye=ye.return}ne=ye}Sl(f,y,Y.children,A),y=y.child}return y;case 9:return Y=y.type,F=y.pendingProps.children,h7(y,A),Y=ph(Y),F=F(Y),y.flags|=1,Sl(f,y,F,A),y.child;case 14:return F=y.type,Y=Gd(F,y.pendingProps),Y=Gd(F.type,Y),Dfe(f,y,F,Y,A);case 15:return Ofe(f,y,y.type,y.pendingProps,A);case 17:return F=y.type,Y=y.pendingProps,Y=y.elementType===F?Y:Gd(F,Y),EP(f,y),y.tag=1,hc(F)?(f=!0,oP(y)):f=!1,h7(y,A),tfe(y,F,Y),pU(y,F,Y,A),RU(null,y,F,!0,f,A);case 19:return jfe(f,y,A);case 22:return Ffe(f,y,A)}throw Error(m(156,y.tag))};function ppe(f,y){return Hhe(f,y)}function MEe(f,y,A,F){this.tag=f,this.key=A,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=y,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=F,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function yh(f,y,A,F){return new MEe(f,y,A,F)}function YU(f){return f=f.prototype,!(!f||!f.isReactComponent)}function CEe(f){if(typeof f=="function")return YU(f)?1:0;if(f!=null){if(f=f.$$typeof,f===We)return 11;if(f===dn)return 14}return 2}function y3(f,y){var A=f.alternate;return A===null?(A=yh(f.tag,y,f.key,f.mode),A.elementType=f.elementType,A.type=f.type,A.stateNode=f.stateNode,A.alternate=f,f.alternate=A):(A.pendingProps=y,A.type=f.type,A.flags=0,A.subtreeFlags=0,A.deletions=null),A.flags=f.flags&14680064,A.childLanes=f.childLanes,A.lanes=f.lanes,A.child=f.child,A.memoizedProps=f.memoizedProps,A.memoizedState=f.memoizedState,A.updateQueue=f.updateQueue,y=f.dependencies,A.dependencies=y===null?null:{lanes:y.lanes,firstContext:y.firstContext},A.sibling=f.sibling,A.index=f.index,A.ref=f.ref,A}function OP(f,y,A,F,Y,ne){var ye=2;if(F=f,typeof f=="function")YU(f)&&(ye=1);else if(typeof f=="string")ye=5;else e:switch(f){case ze:return I8(A.children,Y,ne,y);case Me:ye=8,Y|=8;break;case He:return f=yh(12,A,y,Y|2),f.elementType=He,f.lanes=ne,f;case oe:return f=yh(13,A,y,Y),f.elementType=oe,f.lanes=ne,f;case nt:return f=yh(19,A,y,Y),f.elementType=nt,f.lanes=ne,f;case Be:return FP(A,Y,ne,y);default:if(typeof f=="object"&&f!==null)switch(f.$$typeof){case vt:ye=10;break e;case xe:ye=9;break e;case We:ye=11;break e;case dn:ye=14;break e;case Ve:ye=16,F=null;break e}throw Error(m(130,f==null?f:typeof f,""))}return y=yh(ye,A,y,Y),y.elementType=f,y.type=F,y.lanes=ne,y}function I8(f,y,A,F){return f=yh(7,f,F,y),f.lanes=A,f}function FP(f,y,A,F){return f=yh(22,f,F,y),f.elementType=Be,f.lanes=A,f.stateNode={isHidden:!1},f}function KU(f,y,A){return f=yh(6,f,null,y),f.lanes=A,f}function ZU(f,y,A){return y=yh(4,f.children!==null?f.children:[],f.key,y),y.lanes=A,y.stateNode={containerInfo:f.containerInfo,pendingChildren:null,implementation:f.implementation},y}function AEe(f,y,A,F,Y){this.tag=y,this.containerInfo=f,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=CB(0),this.expirationTimes=CB(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=CB(0),this.identifierPrefix=F,this.onRecoverableError=Y,this.mutableSourceEagerHydrationData=null}function QU(f,y,A,F,Y,ne,ye,Le,Qe){return f=new AEe(f,y,A,Le,Qe),y===1?(y=1,ne===!0&&(y|=8)):y=0,ne=yh(3,null,null,y),f.current=ne,ne.stateNode=f,ne.memoizedState={element:F,isDehydrated:A,cache:null,transitions:null,pendingSuspenseBoundaries:null},dU(ne),f}function PEe(f,y,A){var F=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ne,key:F==null?null:""+F,children:f,containerInfo:y,implementation:A}}function mpe(f){if(!f)return l3;f=f._reactInternals;e:{if(x8(f)!==f||f.tag!==1)throw Error(m(170));var y=f;do{switch(y.tag){case 3:y=y.stateNode.context;break e;case 1:if(hc(y.type)){y=y.stateNode.__reactInternalMemoizedMergedChildContext;break e}}y=y.return}while(y!==null);throw Error(m(171))}if(f.tag===1){var A=f.type;if(hc(A))return Vde(f,A,y)}return y}function gpe(f,y,A,F,Y,ne,ye,Le,Qe){return f=QU(A,F,!0,f,Y,ne,ye,Le,Qe),f.context=mpe(null),A=f.current,F=wl(),Y=m3(A),ne=Qm(F,Y),ne.callback=y??null,h3(A,ne,Y),f.current.lanes=Y,TS(f,Y,F),pc(f,F),f}function LP(f,y,A,F){var Y=y.current,ne=wl(),ye=m3(Y);return A=mpe(A),y.context===null?y.context=A:y.pendingContext=A,y=Qm(ne,ye),y.payload={element:f},F=F===void 0?null:F,F!==null&&(y.callback=F),f=h3(Y,y,ye),f!==null&&(Wd(f,Y,ye,ne),fP(f,Y,ye)),ye}function BP(f){if(f=f.current,!f.child)return null;switch(f.child.tag){case 5:return f.child.stateNode;default:return f.child.stateNode}}function ype(f,y){if(f=f.memoizedState,f!==null&&f.dehydrated!==null){var A=f.retryLane;f.retryLane=A!==0&&A<y?A:y}}function JU(f,y){ype(f,y),(f=f.alternate)&&ype(f,y)}function REe(){return null}var vpe=typeof reportError=="function"?reportError:function(f){console.error(f)};function ez(f){this._internalRoot=f}UP.prototype.render=ez.prototype.render=function(f){var y=this._internalRoot;if(y===null)throw Error(m(409));LP(f,y,null,null)},UP.prototype.unmount=ez.prototype.unmount=function(){var f=this._internalRoot;if(f!==null){this._internalRoot=null;var y=f.containerInfo;P8(function(){LP(null,f,null,null)}),y[qm]=null}};function UP(f){this._internalRoot=f}UP.prototype.unstable_scheduleHydration=function(f){if(f){var y=Qhe();f={blockedOn:null,target:f,priority:y};for(var A=0;A<r3.length&&y!==0&&y<r3[A].priority;A++);r3.splice(A,0,f),A===0&&tde(f)}};function tz(f){return!(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)}function zP(f){return!(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11&&(f.nodeType!==8||f.nodeValue!==" react-mount-point-unstable "))}function _pe(){}function kEe(f,y,A,F,Y){if(Y){if(typeof F=="function"){var ne=F;F=function(){var Bt=BP(ye);ne.call(Bt)}}var ye=gpe(y,F,f,0,null,!1,!1,"",_pe);return f._reactRootContainer=ye,f[qm]=ye.current,US(f.nodeType===8?f.parentNode:f),P8(),ye}for(;Y=f.lastChild;)f.removeChild(Y);if(typeof F=="function"){var Le=F;F=function(){var Bt=BP(Qe);Le.call(Bt)}}var Qe=QU(f,0,!1,null,null,!1,!1,"",_pe);return f._reactRootContainer=Qe,f[qm]=Qe.current,US(f.nodeType===8?f.parentNode:f),P8(function(){LP(y,Qe,A,F)}),Qe}function VP(f,y,A,F,Y){var ne=A._reactRootContainer;if(ne){var ye=ne;if(typeof Y=="function"){var Le=Y;Y=function(){var Qe=BP(ye);Le.call(Qe)}}LP(y,ye,f,Y)}else ye=kEe(A,y,f,Y,F);return BP(ye)}Khe=function(f){switch(f.tag){case 3:var y=f.stateNode;if(y.current.memoizedState.isDehydrated){var A=ES(y.pendingLanes);A!==0&&(AB(y,A|1),pc(y,Uo()),!(Ui&6)&&(y7=Uo()+500,c3()))}break;case 13:P8(function(){var F=Zm(f,1);if(F!==null){var Y=wl();Wd(F,f,1,Y)}}),JU(f,1)}},PB=function(f){if(f.tag===13){var y=Zm(f,134217728);if(y!==null){var A=wl();Wd(y,f,134217728,A)}JU(f,134217728)}},Zhe=function(f){if(f.tag===13){var y=m3(f),A=Zm(f,y);if(A!==null){var F=wl();Wd(A,f,y,F)}JU(f,y)}},Qhe=function(){return us},Jhe=function(f,y){var A=us;try{return us=f,y()}finally{us=A}},Yv=function(f,y,A){switch(y){case"input":if(Re(f,A),y=A.name,A.type==="radio"&&y!=null){for(A=f;A.parentNode;)A=A.parentNode;for(A=A.querySelectorAll("input[name="+JSON.stringify(""+y)+'][type="radio"]'),y=0;y<A.length;y++){var F=A[y];if(F!==f&&F.form===f.form){var Y=iP(F);if(!Y)throw Error(m(90));ji(F),Re(F,Y)}}}break;case"textarea":sn(f,A);break;case"select":y=A.value,y!=null&&wt(f,!!A.multiple,y,!1)}},Lhe=$U,Bhe=P8;var IEe={usingClientEntryPoint:!1,Events:[GS,i7,iP,Ohe,Fhe,$U]},nw={findFiberByHostInstance:b8,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},NEe={bundleType:nw.bundleType,version:nw.version,rendererPackageName:nw.rendererPackageName,rendererConfig:nw.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:fe.ReactCurrentDispatcher,findHostInstanceByFiber:function(f){return f=Ghe(f),f===null?null:f.stateNode},findFiberByHostInstance:nw.findFiberByHostInstance||REe,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&(rw=__REACT_DEVTOOLS_GLOBAL_HOOK__,!rw.isDisabled&&rw.supportsFiber))try{FA=rw.inject(NEe),Op=rw}catch{}var rw;s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=IEe,s.createPortal=function(f,y){var A=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!tz(y))throw Error(m(200));return PEe(f,y,null,A)},s.createRoot=function(f,y){if(!tz(f))throw Error(m(299));var A=!1,F="",Y=vpe;return y!=null&&(y.unstable_strictMode===!0&&(A=!0),y.identifierPrefix!==void 0&&(F=y.identifierPrefix),y.onRecoverableError!==void 0&&(Y=y.onRecoverableError)),y=QU(f,1,!1,null,null,A,!1,F,Y),f[qm]=y.current,US(f.nodeType===8?f.parentNode:f),new ez(y)},s.findDOMNode=function(f){if(f==null)return null;if(f.nodeType===1)return f;var y=f._reactInternals;if(y===void 0)throw typeof f.render=="function"?Error(m(188)):(f=Object.keys(f).join(","),Error(m(268,f)));return f=Ghe(y),f=f===null?null:f.stateNode,f},s.flushSync=function(f){return P8(f)},s.hydrate=function(f,y,A){if(!zP(y))throw Error(m(200));return VP(null,f,y,!0,A)},s.hydrateRoot=function(f,y,A){if(!tz(f))throw Error(m(405));var F=A!=null&&A.hydratedSources||null,Y=!1,ne="",ye=vpe;if(A!=null&&(A.unstable_strictMode===!0&&(Y=!0),A.identifierPrefix!==void 0&&(ne=A.identifierPrefix),A.onRecoverableError!==void 0&&(ye=A.onRecoverableError)),y=gpe(y,null,f,1,A??null,Y,!1,ne,ye),f[qm]=y.current,US(f),F)for(f=0;f<F.length;f++)A=F[f],Y=A._getVersion,Y=Y(A._source),y.mutableSourceEagerHydrationData==null?y.mutableSourceEagerHydrationData=[A,Y]:y.mutableSourceEagerHydrationData.push(A,Y);return new UP(y)},s.render=function(f,y,A){if(!zP(y))throw Error(m(200));return VP(null,f,y,!1,A)},s.unmountComponentAtNode=function(f){if(!zP(f))throw Error(m(40));return f._reactRootContainer?(P8(function(){VP(null,null,f,!1,function(){f._reactRootContainer=null,f[qm]=null})}),!0):!1},s.unstable_batchedUpdates=$U,s.unstable_renderSubtreeIntoContainer=function(f,y,A,F){if(!zP(A))throw Error(m(200));if(f==null||f._reactInternals===void 0)throw Error(m(38));return VP(f,y,A,!1,F)},s.version="18.2.0-next-9e3b772b8-20220608"}),ua=ie((s,l)=>{function u(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(u)}catch(m){console.error(m)}}u(),l.exports=dN()});function ET(s){let[,l]=(0,sp.useState)(0);return(0,sp.useCallback)(()=>{l(u=>u+1)},[])}function jr(s,l,u){let m=(0,sp.useCallback)(s,l),_=(0,sp.useRef)(null);_.current?_.current.set(m):_.current=new Fy.Atom(m);let b=(0,sp.useRef)(null);return b.current||(b.current=(0,Fy.prism)(()=>_.current.prism.getValue()())),w5(b.current,u)}function fN(){Ly||(Ly=!0,(0,TT.default)(()=>{(0,MT.unstable_batchedUpdates)(function(){for(var s,l;Zc.length>0;){let u=Zc.shift();_9.delete(u);let m;op&&((s=u.debug)==null||s.history.push("queue reached"));try{m=u.der.getValue()}catch(_){op&&((l=u.debug)==null||l.history.push("queue: der.getValue() errored")),console.error("A `der.getValue()` in `usePrismInstance(der)` threw an error. This may be a zombie child issue, so we're gonna try to get its value again in a normal react render phase.If you see the same error again, then you either have an error in your prism code, or the deps array in `usePrism(fn, deps)` is missing a dependency and causing the prism to read stale values."),console.error(_),u.runUpdate();continue}m!==u.lastValue&&(u.lastValue=m,u.runUpdate())}Ly=!1},1)}))}function w5(s,l){var u;let m=ET(),_=(0,sp.useRef)(void 0);_.current||(kx++,_.current={order:kx,runUpdate:()=>{_.current.unmounted||m()},der:s,lastValue:void 0,unmounted:!1,queueUpdate:()=>{var E;op&&((E=_.current.debug)==null||E.history.push("queueUpdate()")),CT(_.current)},untap:s.onStale(()=>{op&&_.current.debug.history.push("onStale(cb)"),_.current.queueUpdate()})},op&&(_.current.debug={label:l,traceOfFirstTimeRender:new Error,history:[]})),(0,sp.useLayoutEffect)(()=>function(){_.current.unmounted=!0,_.current.untap(),Nx(_.current)},[]),Nx(_.current);let b=_.current.der.getValue();return _.current.lastValue=b,op&&((u=_.current.debug)==null||u.history.push("rendered")),b}var Fy,TT,sp,MT,op,Xr,kx,Zc,_9,Ly,CT,Ix,Nx,er=k(()=>{Fy=mn(),Fo(),TT=Q(Rx()),sp=Q(qe()),MT=Q(ua()),op=!1,Xr=(s,l)=>jr(()=>(0,Fy.val)(s),[s],l),kx=0,Zc=[],_9=new Set,Ly=!1,CT=s=>{Ix(s),fN()},Ix=s=>{if(!_9.has(s))if(_9.add(s),Zc.length===0)Zc.push(s);else{let l=xx(Zc,u=>u.order>=s.order);l===-1?Zc.push(s):Zc[l].order>s.order&&Zc.splice(l,0,s)}},Nx=s=>{if(!_9.has(s))return;_9.delete(s);let l=xx(Zc,u=>u===s);Zc.splice(l,1)}}),AT=ie(s=>{var l=60103,u=60106,m=60107,_=60108,b=60114,E=60109,T=60110,P=60112,N=60113,z=60120,G=60115,V=60116,B=60121,H=60122,j=60117,X=60129,K=60131;typeof Symbol=="function"&&Symbol.for&&(te=Symbol.for,l=te("react.element"),u=te("react.portal"),m=te("react.fragment"),_=te("react.strict_mode"),b=te("react.profiler"),E=te("react.provider"),T=te("react.context"),P=te("react.forward_ref"),N=te("react.suspense"),z=te("react.suspense_list"),G=te("react.memo"),V=te("react.lazy"),B=te("react.block"),H=te("react.server.block"),j=te("react.fundamental"),X=te("react.debug_trace_mode"),K=te("react.legacy_hidden"));var te;function se(oe){if(typeof oe=="object"&&oe!==null){var nt=oe.$$typeof;switch(nt){case l:switch(oe=oe.type,oe){case m:case b:case _:case N:case z:return oe;default:switch(oe=oe&&oe.$$typeof,oe){case T:case P:case V:case G:case E:return oe;default:return nt}}case u:return nt}}}var pe=E,fe=l,ve=P,Ne=m,ze=V,Me=G,He=u,vt=b,xe=_,We=N;s.ContextConsumer=T,s.ContextProvider=pe,s.Element=fe,s.ForwardRef=ve,s.Fragment=Ne,s.Lazy=ze,s.Memo=Me,s.Portal=He,s.Profiler=vt,s.StrictMode=xe,s.Suspense=We,s.isAsyncMode=function(){return!1},s.isConcurrentMode=function(){return!1},s.isContextConsumer=function(oe){return se(oe)===T},s.isContextProvider=function(oe){return se(oe)===E},s.isElement=function(oe){return typeof oe=="object"&&oe!==null&&oe.$$typeof===l},s.isForwardRef=function(oe){return se(oe)===P},s.isFragment=function(oe){return se(oe)===m},s.isLazy=function(oe){return se(oe)===V},s.isMemo=function(oe){return se(oe)===G},s.isPortal=function(oe){return se(oe)===u},s.isProfiler=function(oe){return se(oe)===b},s.isStrictMode=function(oe){return se(oe)===_},s.isSuspense=function(oe){return se(oe)===N},s.isValidElementType=function(oe){return typeof oe=="string"||typeof oe=="function"||oe===m||oe===b||oe===X||oe===_||oe===N||oe===z||oe===K||typeof oe=="object"&&oe!==null&&(oe.$$typeof===V||oe.$$typeof===G||oe.$$typeof===E||oe.$$typeof===T||oe.$$typeof===P||oe.$$typeof===j||oe.$$typeof===B||oe[0]===H)},s.typeOf=se}),pN=ie((s,l)=>{l.exports=AT()}),PT=ie((s,l)=>{l.exports=function(u,m,_,b){var E=_?_.call(b,u,m):void 0;if(E!==void 0)return!!E;if(u===m)return!0;if(typeof u!="object"||!u||typeof m!="object"||!m)return!1;var T=Object.keys(u),P=Object.keys(m);if(T.length!==P.length)return!1;for(var N=Object.prototype.hasOwnProperty.bind(m),z=0;z<T.length;z++){var G=T[z];if(!N(G))return!1;var V=u[G],B=m[G];if(E=_?_.call(b,V,B,G):void 0,E===!1||E===void 0&&V!==B)return!1}return!0}});function mN(s){function l(Ce,St,Mt,kt,ct){for(var zn=0,Vt=0,Dn=0,ur=0,kr,Mr,ji=0,he=0,Lt,It=Lt=kr=0,ke=0,Re=0,ut=0,Xt=0,rn=Mt.length,wt=rn-1,fn,tn="",sn="",xr="",Bi="",Hr;ke<rn;){if(Mr=Mt.charCodeAt(ke),ke===wt&&Vt+ur+Dn+zn!==0&&(Vt!==0&&(Mr=Vt===47?10:47),ur=Dn=zn=0,rn++,wt++),Vt+ur+Dn+zn===0){if(ke===wt&&(0<Re&&(tn=tn.replace(V,"")),0<tn.trim().length)){switch(Mr){case 32:case 9:case 59:case 13:case 10:break;default:tn+=Mt.charAt(ke)}Mr=59}switch(Mr){case 123:for(tn=tn.trim(),kr=tn.charCodeAt(0),Lt=1,Xt=++ke;ke<rn;){switch(Mr=Mt.charCodeAt(ke)){case 123:Lt++;break;case 125:Lt--;break;case 47:switch(Mr=Mt.charCodeAt(ke+1)){case 42:case 47:e:{for(It=ke+1;It<wt;++It)switch(Mt.charCodeAt(It)){case 47:if(Mr===42&&Mt.charCodeAt(It-1)===42&&ke+2!==It){ke=It+1;break e}break;case 10:if(Mr===47){ke=It+1;break e}}ke=It}}break;case 91:Mr++;case 40:Mr++;case 34:case 39:for(;ke++<wt&&Mt.charCodeAt(ke)!==Mr;);}if(Lt===0)break;ke++}switch(Lt=Mt.substring(Xt,ke),kr===0&&(kr=(tn=tn.replace(G,"").trim()).charCodeAt(0)),kr){case 64:switch(0<Re&&(tn=tn.replace(V,"")),Mr=tn.charCodeAt(1),Mr){case 100:case 109:case 115:case 45:Re=St;break;default:Re=dn}if(Lt=l(St,Re,Lt,Mr,ct+1),Xt=Lt.length,0<Be&&(Re=u(dn,tn,ut),Hr=T(3,Lt,Re,St,We,xe,Xt,Mr,ct,kt),tn=Re.join(""),Hr!==void 0&&(Xt=(Lt=Hr.trim()).length)===0&&(Mr=0,Lt="")),0<Xt)switch(Mr){case 115:tn=tn.replace(ve,E);case 100:case 109:case 45:Lt=tn+"{"+Lt+"}";break;case 107:tn=tn.replace(te,"$1 $2"),Lt=tn+"{"+Lt+"}",Lt=nt===1||nt===2&&b("@"+Lt,3)?"@-webkit-"+Lt+"@"+Lt:"@"+Lt;break;default:Lt=tn+Lt,kt===112&&(Lt=(sn+=Lt,""))}else Lt="";break;default:Lt=l(St,u(St,tn,ut),Lt,kt,ct+1)}xr+=Lt,Lt=ut=Re=It=kr=0,tn="",Mr=Mt.charCodeAt(++ke);break;case 125:case 59:if(tn=(0<Re?tn.replace(V,""):tn).trim(),1<(Xt=tn.length))switch(It===0&&(kr=tn.charCodeAt(0),kr===45||96<kr&&123>kr)&&(Xt=(tn=tn.replace(" ",":")).length),0<Be&&(Hr=T(1,tn,St,Ce,We,xe,sn.length,kt,ct,kt))!==void 0&&(Xt=(tn=Hr.trim()).length)===0&&(tn="\0\0"),kr=tn.charCodeAt(0),Mr=tn.charCodeAt(1),kr){case 0:break;case 64:if(Mr===105||Mr===99){Bi+=tn+Mt.charAt(ke);break}default:tn.charCodeAt(Xt-1)!==58&&(sn+=_(tn,kr,Mr,tn.charCodeAt(2)))}ut=Re=It=kr=0,tn="",Mr=Mt.charCodeAt(++ke)}}switch(Mr){case 13:case 10:Vt===47?Vt=0:1+kr===0&&kt!==107&&0<tn.length&&(Re=1,tn+="\0"),0<Be*Wt&&T(0,tn,St,Ce,We,xe,sn.length,kt,ct,kt),xe=1,We++;break;case 59:case 125:if(Vt+ur+Dn+zn===0){xe++;break}default:switch(xe++,fn=Mt.charAt(ke),Mr){case 9:case 32:if(ur+zn+Vt===0)switch(ji){case 44:case 58:case 9:case 32:fn="";break;default:Mr!==32&&(fn=" ")}break;case 0:fn="\\0";break;case 12:fn="\\f";break;case 11:fn="\\v";break;case 38:ur+Vt+zn===0&&(Re=ut=1,fn="\f"+fn);break;case 108:if(ur+Vt+zn+oe===0&&0<It)switch(ke-It){case 2:ji===112&&Mt.charCodeAt(ke-3)===58&&(oe=ji);case 8:he===111&&(oe=he)}break;case 58:ur+Vt+zn===0&&(It=ke);break;case 44:Vt+Dn+ur+zn===0&&(Re=1,fn+="\r");break;case 34:case 39:Vt===0&&(ur=ur===Mr?0:ur===0?Mr:ur);break;case 91:ur+Vt+Dn===0&&zn++;break;case 93:ur+Vt+Dn===0&&zn--;break;case 41:ur+Vt+zn===0&&Dn--;break;case 40:if(ur+Vt+zn===0){if(kr===0)switch(2*ji+3*he){case 533:break;default:kr=1}Dn++}break;case 64:Vt+Dn+ur+zn+It+Lt===0&&(Lt=1);break;case 42:case 47:if(!(0<ur+zn+Dn))switch(Vt){case 0:switch(2*Mr+3*Mt.charCodeAt(ke+1)){case 235:Vt=47;break;case 220:Xt=ke,Vt=42}break;case 42:Mr===47&&ji===42&&Xt+2!==ke&&(Mt.charCodeAt(Xt+2)===33&&(sn+=Mt.substring(Xt,ke+1)),fn="",Vt=0)}}Vt===0&&(tn+=fn)}he=ji,ji=Mr,ke++}if(Xt=sn.length,0<Xt){if(Re=St,0<Be&&(Hr=T(2,sn,Re,Ce,We,xe,Xt,kt,ct,kt),Hr!==void 0&&(sn=Hr).length===0))return Bi+sn+xr;if(sn=Re.join(",")+"{"+sn+"}",nt*oe!==0){switch(nt!==2||b(sn,2)||(oe=0),oe){case 111:sn=sn.replace(pe,":-moz-$1")+sn;break;case 112:sn=sn.replace(se,"::-webkit-input-$1")+sn.replace(se,"::-moz-$1")+sn.replace(se,":-ms-input-$1")+sn}oe=0}}return Bi+sn+xr}function u(Ce,St,Mt){var kt=St.trim().split(X);St=kt;var ct=kt.length,zn=Ce.length;switch(zn){case 0:case 1:var Vt=0;for(Ce=zn===0?"":Ce[0]+" ";Vt<ct;++Vt)St[Vt]=m(Ce,St[Vt],Mt).trim();break;default:var Dn=Vt=0;for(St=[];Vt<ct;++Vt)for(var ur=0;ur<zn;++ur)St[Dn++]=m(Ce[ur]+" ",kt[Vt],Mt).trim()}return St}function m(Ce,St,Mt){var kt=St.charCodeAt(0);switch(33>kt&&(kt=(St=St.trim()).charCodeAt(0)),kt){case 38:return St.replace(K,"$1"+Ce.trim());case 58:return Ce.trim()+St.replace(K,"$1"+Ce.trim());default:if(0<1*Mt&&0<St.indexOf("\f"))return St.replace(K,(Ce.charCodeAt(0)===58?"":"$1")+Ce.trim())}return Ce+St}function _(Ce,St,Mt,kt){var ct=Ce+";",zn=2*St+3*Mt+4*kt;if(zn===944){Ce=ct.indexOf(":",9)+1;var Vt=ct.substring(Ce,ct.length-1).trim();return Vt=ct.substring(0,Ce).trim()+Vt+";",nt===1||nt===2&&b(Vt,1)?"-webkit-"+Vt+Vt:Vt}if(nt===0||nt===2&&!b(ct,1))return ct;switch(zn){case 1015:return ct.charCodeAt(10)===97?"-webkit-"+ct+ct:ct;case 951:return ct.charCodeAt(3)===116?"-webkit-"+ct+ct:ct;case 963:return ct.charCodeAt(5)===110?"-webkit-"+ct+ct:ct;case 1009:if(ct.charCodeAt(4)!==100)break;case 969:case 942:return"-webkit-"+ct+ct;case 978:return"-webkit-"+ct+"-moz-"+ct+ct;case 1019:case 983:return"-webkit-"+ct+"-moz-"+ct+"-ms-"+ct+ct;case 883:if(ct.charCodeAt(8)===45)return"-webkit-"+ct+ct;if(0<ct.indexOf("image-set(",11))return ct.replace(vt,"$1-webkit-$2")+ct;break;case 932:if(ct.charCodeAt(4)===45)switch(ct.charCodeAt(5)){case 103:return"-webkit-box-"+ct.replace("-grow","")+"-webkit-"+ct+"-ms-"+ct.replace("grow","positive")+ct;case 115:return"-webkit-"+ct+"-ms-"+ct.replace("shrink","negative")+ct;case 98:return"-webkit-"+ct+"-ms-"+ct.replace("basis","preferred-size")+ct}return"-webkit-"+ct+"-ms-"+ct+ct;case 964:return"-webkit-"+ct+"-ms-flex-"+ct+ct;case 1023:if(ct.charCodeAt(8)!==99)break;return Vt=ct.substring(ct.indexOf(":",15)).replace("flex-","").replace("space-between","justify"),"-webkit-box-pack"+Vt+"-webkit-"+ct+"-ms-flex-pack"+Vt+ct;case 1005:return H.test(ct)?ct.replace(B,":-webkit-")+ct.replace(B,":-moz-")+ct:ct;case 1e3:switch(Vt=ct.substring(13).trim(),St=Vt.indexOf("-")+1,Vt.charCodeAt(0)+Vt.charCodeAt(St)){case 226:Vt=ct.replace(fe,"tb");break;case 232:Vt=ct.replace(fe,"tb-rl");break;case 220:Vt=ct.replace(fe,"lr");break;default:return ct}return"-webkit-"+ct+"-ms-"+Vt+ct;case 1017:if(ct.indexOf("sticky",9)===-1)break;case 975:switch(St=(ct=Ce).length-10,Vt=(ct.charCodeAt(St)===33?ct.substring(0,St):ct).substring(Ce.indexOf(":",7)+1).trim(),zn=Vt.charCodeAt(0)+(Vt.charCodeAt(7)|0)){case 203:if(111>Vt.charCodeAt(8))break;case 115:ct=ct.replace(Vt,"-webkit-"+Vt)+";"+ct;break;case 207:case 102:ct=ct.replace(Vt,"-webkit-"+(102<zn?"inline-":"")+"box")+";"+ct.replace(Vt,"-webkit-"+Vt)+";"+ct.replace(Vt,"-ms-"+Vt+"box")+";"+ct}return ct+";";case 938:if(ct.charCodeAt(5)===45)switch(ct.charCodeAt(6)){case 105:return Vt=ct.replace("-items",""),"-webkit-"+ct+"-webkit-box-"+Vt+"-ms-flex-"+Vt+ct;case 115:return"-webkit-"+ct+"-ms-flex-item-"+ct.replace(ze,"")+ct;default:return"-webkit-"+ct+"-ms-flex-line-pack"+ct.replace("align-content","").replace(ze,"")+ct}break;case 973:case 989:if(ct.charCodeAt(3)!==45||ct.charCodeAt(4)===122)break;case 931:case 953:if(He.test(Ce)===!0)return(Vt=Ce.substring(Ce.indexOf(":")+1)).charCodeAt(0)===115?_(Ce.replace("stretch","fill-available"),St,Mt,kt).replace(":fill-available",":stretch"):ct.replace(Vt,"-webkit-"+Vt)+ct.replace(Vt,"-moz-"+Vt.replace("fill-",""))+ct;break;case 962:if(ct="-webkit-"+ct+(ct.charCodeAt(5)===102?"-ms-"+ct:"")+ct,Mt+kt===211&&ct.charCodeAt(13)===105&&0<ct.indexOf("transform",10))return ct.substring(0,ct.indexOf(";",27)+1).replace(j,"$1-webkit-$2")+ct}return ct}function b(Ce,St){var Mt=Ce.indexOf(St===1?":":"{"),kt=Ce.substring(0,St!==3?Mt:10);return Mt=Ce.substring(Mt+1,Ce.length-1),ot(St!==2?kt:kt.replace(Me,"$1"),Mt,St)}function E(Ce,St){var Mt=_(St,St.charCodeAt(0),St.charCodeAt(1),St.charCodeAt(2));return Mt!==St+";"?Mt.replace(Ne," or ($1)").substring(4):"("+St+")"}function T(Ce,St,Mt,kt,ct,zn,Vt,Dn,ur,kr){for(var Mr=0,ji=St,he;Mr<Be;++Mr)switch(he=Ve[Mr].call(z,Ce,ji,Mt,kt,ct,zn,Vt,Dn,ur,kr)){case void 0:case!1:case!0:case null:break;default:ji=he}if(ji!==St)return ji}function P(Ce){switch(Ce){case void 0:case null:Be=Ve.length=0;break;default:if(typeof Ce=="function")Ve[Be++]=Ce;else if(typeof Ce=="object")for(var St=0,Mt=Ce.length;St<Mt;++St)P(Ce[St]);else Wt=!!Ce|0}return P}function N(Ce){return Ce=Ce.prefix,Ce!==void 0&&(ot=null,Ce?typeof Ce!="function"?nt=1:(nt=2,ot=Ce):nt=0),N}function z(Ce,St){var Mt=Ce;if(33>Mt.charCodeAt(0)&&(Mt=Mt.trim()),be=Mt,Mt=[be],0<Be){var kt=T(-1,St,Mt,Mt,We,xe,0,0,0,0);kt!==void 0&&typeof kt=="string"&&(St=kt)}var ct=l(dn,Mt,St,0,0);return 0<Be&&(kt=T(-2,ct,Mt,Mt,We,xe,ct.length,0,0,0),kt!==void 0&&(ct=kt)),be="",oe=0,xe=We=1,ct}var G=/^\0+/g,V=/[\0\r\f]/g,B=/: */g,H=/zoo|gra/,j=/([,: ])(transform)/g,X=/,\r+?/g,K=/([\t\r\n ])*\f?&/g,te=/@(k\w+)\s*(\S*)\s*/,se=/::(place)/g,pe=/:(read-only)/g,fe=/[svh]\w+-[tblr]{2}/,ve=/\(\s*(.*)\s*\)/g,Ne=/([\s\S]*?);/g,ze=/-self|flex-/g,Me=/[^]*?(:[rp][el]a[\w-]+)[^]*/,He=/stretch|:\s*\w+\-(?:conte|avail)/,vt=/([^-])(image-set\()/,xe=1,We=1,oe=0,nt=1,dn=[],Ve=[],Be=0,ot=null,Wt=0,be="";return z.use=P,z.set=N,s!==void 0&&N(s),z}var RT,By=k(()=>{RT=mN}),kT,x9,gN=k(()=>{kT={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},x9=kT});function yN(s){var l=Object.create(null);return function(u){return l[u]===void 0&&(l[u]=s(u)),l[u]}}var IT,vN=k(()=>{IT=yN}),Uy,Dx,Ox,_N=k(()=>{vN(),Uy=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,Dx=IT(function(s){return Uy.test(s)||s.charCodeAt(0)===111&&s.charCodeAt(1)===110&&s.charCodeAt(2)<91}),Ox=Dx}),ic=ie(s=>{var l=typeof Symbol=="function"&&Symbol.for,u=l?Symbol.for("react.element"):60103,m=l?Symbol.for("react.portal"):60106,_=l?Symbol.for("react.fragment"):60107,b=l?Symbol.for("react.strict_mode"):60108,E=l?Symbol.for("react.profiler"):60114,T=l?Symbol.for("react.provider"):60109,P=l?Symbol.for("react.context"):60110,N=l?Symbol.for("react.async_mode"):60111,z=l?Symbol.for("react.concurrent_mode"):60111,G=l?Symbol.for("react.forward_ref"):60112,V=l?Symbol.for("react.suspense"):60113,B=l?Symbol.for("react.suspense_list"):60120,H=l?Symbol.for("react.memo"):60115,j=l?Symbol.for("react.lazy"):60116,X=l?Symbol.for("react.block"):60121,K=l?Symbol.for("react.fundamental"):60117,te=l?Symbol.for("react.responder"):60118,se=l?Symbol.for("react.scope"):60119;function pe(ve){if(typeof ve=="object"&&ve!==null){var Ne=ve.$$typeof;switch(Ne){case u:switch(ve=ve.type,ve){case N:case z:case _:case E:case b:case V:return ve;default:switch(ve=ve&&ve.$$typeof,ve){case P:case G:case j:case H:case T:return ve;default:return Ne}}case m:return Ne}}}function fe(ve){return pe(ve)===z}s.AsyncMode=N,s.ConcurrentMode=z,s.ContextConsumer=P,s.ContextProvider=T,s.Element=u,s.ForwardRef=G,s.Fragment=_,s.Lazy=j,s.Memo=H,s.Portal=m,s.Profiler=E,s.StrictMode=b,s.Suspense=V,s.isAsyncMode=function(ve){return fe(ve)||pe(ve)===N},s.isConcurrentMode=fe,s.isContextConsumer=function(ve){return pe(ve)===P},s.isContextProvider=function(ve){return pe(ve)===T},s.isElement=function(ve){return typeof ve=="object"&&ve!==null&&ve.$$typeof===u},s.isForwardRef=function(ve){return pe(ve)===G},s.isFragment=function(ve){return pe(ve)===_},s.isLazy=function(ve){return pe(ve)===j},s.isMemo=function(ve){return pe(ve)===H},s.isPortal=function(ve){return pe(ve)===m},s.isProfiler=function(ve){return pe(ve)===E},s.isStrictMode=function(ve){return pe(ve)===b},s.isSuspense=function(ve){return pe(ve)===V},s.isValidElementType=function(ve){return typeof ve=="string"||typeof ve=="function"||ve===_||ve===z||ve===E||ve===b||ve===V||ve===B||typeof ve=="object"&&ve!==null&&(ve.$$typeof===j||ve.$$typeof===H||ve.$$typeof===T||ve.$$typeof===P||ve.$$typeof===G||ve.$$typeof===K||ve.$$typeof===te||ve.$$typeof===se||ve.$$typeof===X)},s.typeOf=pe}),ym=ie((s,l)=>{l.exports=ic()}),vm=ie((s,l)=>{var u=ym(),m={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},_={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},b={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},E={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},T={};T[u.ForwardRef]=b,T[u.Memo]=E;function P(X){return u.isMemo(X)?E:T[X.$$typeof]||m}var N=Object.defineProperty,z=Object.getOwnPropertyNames,G=Object.getOwnPropertySymbols,V=Object.getOwnPropertyDescriptor,B=Object.getPrototypeOf,H=Object.prototype;function j(X,K,te){if(typeof K!="string"){if(H){var se=B(K);se&&se!==H&&j(X,se,te)}var pe=z(K);G&&(pe=pe.concat(G(K)));for(var fe=P(X),ve=P(K),Ne=0;Ne<pe.length;++Ne){var ze=pe[Ne];if(!_[ze]&&!(te&&te[ze])&&!(ve&&ve[ze])&&!(fe&&fe[ze])){var Me=V(K,ze);try{N(X,ze,Me)}catch{}}}}return X}l.exports=j});function Qc(){return(Qc=Object.assign||function(s){for(var l=1;l<arguments.length;l++){var u=arguments[l];for(var m in u)Object.prototype.hasOwnProperty.call(u,m)&&(s[m]=u[m])}return s}).apply(this,arguments)}function gd(s){return typeof s=="function"}function _m(s){return s.displayName||s.name||"Component"}function E5(s){return s&&typeof s.styledComponentId=="string"}function yd(s){for(var l=arguments.length,u=new Array(l>1?l-1:0),m=1;m<l;m++)u[m-1]=arguments[m];throw new Error("An error occurred. See https://git.io/JUIaE#"+s+" for more information."+(u.length>0?" Args: "+u.join(", "):""))}function zy(s){var l,u="";for(l=Math.abs(s);l>52;l=l/52|0)u=qy(l%52)+u;return(qy(l%52)+u).replace(BT,"$1-$2")}function NT(s){for(var l=0;l<s.length;l+=1){var u=s[l];if(gd(u)&&!E5(u))return!1}return!0}function Vy(s){var l,u,m,_,b=s===void 0?eu:s,E=b.options,T=E===void 0?eu:E,P=b.plugins,N=P===void 0?w9:P,z=new RT(T),G=[],V=function(j){function X(K){if(K)try{j(K+"}")}catch{}}return function(K,te,se,pe,fe,ve,Ne,ze,Me,He){switch(K){case 1:if(Me===0&&te.charCodeAt(0)===64)return j(te+";"),"";break;case 2:if(ze===0)return te+"/*|*/";break;case 3:switch(ze){case 102:case 112:return j(se[0]+te),"";default:return te+(He===0?"/*|*/":"")}case-2:te.split("/*|*/}").forEach(X)}}}(function(j){G.push(j)}),B=function(j,X,K){return X===0&&Xx.indexOf(K[u.length])!==-1||K.match(_)?j:"."+l};function H(j,X,K,te){te===void 0&&(te="&");var se=j.replace(Xy,""),pe=X&&K?K+" "+X+" { "+se+" }":se;return l=te,u=X,m=new RegExp("\\"+u+"\\b","g"),_=new RegExp("(\\"+u+"\\b){2,}"),z(K||!X?"":X,pe)}return z.use([].concat(N,[function(j,X,K){j===2&&K.length&&K[0].lastIndexOf(u)>0&&(K[0]=K[0].replace(m,B))},V,function(j){if(j===-2){var X=G;return G=[],X}}])),H.hash=N.length?N.reduce(function(j,X){return X.name||yd(15),cp(j,X.name)},5381).toString():"",H}function T5(){return(0,Ws.useContext)(Yy)||Zy}function ap(){return(0,Ws.useContext)(Ky)||I5}function Gy(s){var l=(0,Ws.useState)(s.stylisPlugins),u=l[0],m=l[1],_=T5(),b=(0,Ws.useMemo)(function(){var T=_;return s.sheet?T=s.sheet:s.target&&(T=T.reconstructWithOptions({target:s.target},!1)),s.disableCSSOMInjection&&(T=T.reconstructWithOptions({useCSSOMInjection:!1})),T},[s.disableCSSOMInjection,s.sheet,s.target]),E=(0,Ws.useMemo)(function(){return Vy({options:{prefix:!s.disableVendorPrefixes},plugins:u})},[s.disableVendorPrefixes,u]);return(0,Ws.useEffect)(function(){(0,A5.default)(u,s.stylisPlugins)||m(s.stylisPlugins)},[s.stylisPlugins]),Ws.default.createElement(Yy.Provider,{value:b},Ws.default.createElement(Ky.Provider,{value:E},s.children))}function jy(s){return VT.test(s)?s.replace(w,W).replace(D,"-ms-"):s}function xm(s,l,u,m){if(Array.isArray(s)){for(var _,b=[],E=0,T=s.length;E<T;E+=1)(_=xm(s[E],l,u,m))!==""&&(Array.isArray(_)?b.push.apply(b,_):b.push(_));return b}if(re(s))return"";if(E5(s))return"."+s.styledComponentId;if(gd(s)){if(typeof(N=s)!="function"||N.prototype&&N.prototype.isReactComponent||!l)return s;var P=s(l);return xm(P,l,u,m)}var N;return s instanceof zT?u?(s.inject(u,m),s.getName(m)):s:S9(s)?function z(G,V){var B,H,j=[];for(var X in G)G.hasOwnProperty(X)&&!re(G[X])&&(Array.isArray(G[X])&&G[X].isCss||gd(G[X])?j.push(jy(X)+":",G[X],";"):S9(G[X])?j.push.apply(j,z(G[X],X)):j.push(jy(X)+": "+(B=X,(H=G[X])==null||typeof H=="boolean"||H===""?"":typeof H!="number"||H===0||B in x9||B.startsWith("--")?String(H).trim():H+"px")+";"));return V?[V+" {"].concat(j,["}"]):j}(s):s.toString()}function Wa(s){for(var l=arguments.length,u=new Array(l>1?l-1:0),m=1;m<l;m++)u[m-1]=arguments[m];return gd(s)||S9(s)?me(xm(b9(w9,[s].concat(u)))):u.length===0&&s.length===1&&typeof s[0]=="string"?s:me(xm(b9(s,u)))}function Jc(s){return s.replace(Ge,"-").replace(ft,"")}function M5(s){return typeof s=="string"&&!0}function Fx(s,l,u){var m=s[u];zt(l)&&zt(m)?C5(m,l):s[u]=l}function C5(s){for(var l=arguments.length,u=new Array(l>1?l-1:0),m=1;m<l;m++)u[m-1]=arguments[m];for(var _=0,b=u;_<b.length;_++){var E=b[_];if(zt(E))for(var T in E)xn(T)&&Fx(s,E[T],T)}return s}function Hy(s,l,u){var m=E5(s),_=!M5(s),b=l.attrs,E=b===void 0?w9:b,T=l.componentId,P=T===void 0?function(te,se){var pe=typeof te!="string"?"sc":Jc(te);Fn[pe]=(Fn[pe]||0)+1;var fe=pe+"-"+Tt("5.3.11"+pe+Fn[pe]);return se?se+"-"+fe:fe}(l.displayName,l.parentComponentId):T,N=l.displayName,z=N===void 0?function(te){return M5(te)?"styled."+te:"Styled("+_m(te)+")"}(s):N,G=l.displayName&&l.componentId?Jc(l.displayName)+"-"+l.componentId:l.componentId||P,V=m&&s.attrs?Array.prototype.concat(s.attrs,E).filter(Boolean):E,B=l.shouldForwardProp;m&&s.shouldForwardProp&&(B=l.shouldForwardProp?function(te,se,pe){return s.shouldForwardProp(te,se,pe)&&l.shouldForwardProp(te,se,pe)}:s.shouldForwardProp);var H,j=new qx(u,G,m?s.componentStyle:void 0),X=j.isStatic&&E.length===0,K=function(te,se){return function(pe,fe,ve,Ne){var ze=pe.attrs,Me=pe.componentStyle,He=pe.defaultProps,vt=pe.foldedComponentIds,xe=pe.shouldForwardProp,We=pe.styledComponentId,oe=pe.target,nt=function(kt,ct,zn){kt===void 0&&(kt=eu);var Vt=Qc({},ct,{theme:kt}),Dn={};return zn.forEach(function(ur){var kr,Mr,ji,he=ur;for(kr in gd(he)&&(he=he(Vt)),he)Vt[kr]=Dn[kr]=kr==="className"?(Mr=Dn[kr],ji=he[kr],Mr&&ji?Mr+" "+ji:Mr||ji):he[kr]}),[Vt,Dn]}(Ee(fe,(0,Ws.useContext)(bn),He)||eu,fe,ze),dn=nt[0],Ve=nt[1],Be=function(kt,ct,zn,Vt){var Dn=T5(),ur=ap(),kr=ct?kt.generateAndInjectStyles(eu,Dn,ur):kt.generateAndInjectStyles(zn,Dn,ur);return kr}(Me,Ne,dn),ot=ve,Wt=Ve.$as||fe.$as||Ve.as||fe.as||oe,be=M5(Wt),Ce=Ve!==fe?Qc({},fe,{},Ve):fe,St={};for(var Mt in Ce)Mt[0]!=="$"&&Mt!=="as"&&(Mt==="forwardedAs"?St.as=Ce[Mt]:(xe?xe(Mt,Ox,Wt):!be||Ox(Mt))&&(St[Mt]=Ce[Mt]));return fe.style&&Ve.style!==fe.style&&(St.style=Qc({},fe.style,{},Ve.style)),St.className=Array.prototype.concat(vt,We,Be!==We?Be:null,fe.className,Ve.className).filter(Boolean).join(" "),St.ref=ot,(0,Ws.createElement)(Wt,St)}(H,te,se,X)};return K.displayName=z,(H=Ws.default.forwardRef(K)).attrs=V,H.componentStyle=j,H.displayName=z,H.shouldForwardProp=B,H.foldedComponentIds=m?Array.prototype.concat(s.foldedComponentIds,s.styledComponentId):w9,H.styledComponentId=G,H.target=m?s.target:s,H.withComponent=function(te){var se=l.componentId,pe=function(ve,Ne){if(ve==null)return{};var ze,Me,He={},vt=Object.keys(ve);for(Me=0;Me<vt.length;Me++)ze=vt[Me],Ne.indexOf(ze)>=0||(He[ze]=ve[ze]);return He}(l,["componentId"]),fe=se&&se+"-"+(M5(te)?te:Jc(_m(te)));return Hy(te,Qc({},pe,{attrs:V,componentId:fe}),u)},Object.defineProperty(H,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(te){this._foldedDefaultProps=m?C5({},s.defaultProps,te):te}}),Object.defineProperty(H,"toString",{value:function(){return"."+H.styledComponentId}}),_&&(0,Ux.default)(H,s,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0,withComponent:!0}),H}function Lx(s){for(var l=arguments.length,u=new Array(l>1?l-1:0),m=1;m<l;m++)u[m-1]=arguments[m];var _=Wa.apply(void 0,[s].concat(u)),b="sc-global-"+Tt(JSON.stringify(_)),E=new rr(_,b);function T(N){var z=T5(),G=ap(),V=(0,Ws.useContext)(bn),B=(0,Ws.useRef)(z.allocateGSInstance(b)).current;return z.server&&P(B,N,z,V,G),(0,Ws.useLayoutEffect)(function(){if(!z.server)return P(B,N,z,V,G),function(){return E.removeStyles(B,z)}},[B,N,z,V,G]),null}function P(N,z,G,V,B){if(E.isStatic)E.renderStyles(N,zx,G,B);else{var H=Qc({},z,{theme:Ee(z,V,T.defaultProps)});E.renderStyles(N,H,G,B)}}return Ws.default.memo(T)}var Bx,Ws,A5,Ux,b9,S9,w9,eu,tu,E9,DT,zx,Vx,vd,bm,T9,P5,Gx,jx,Hx,$a,OT,Wy,$y,Wx,R5,k5,FT,qa,LT,lp,BT,qy,cp,$x,UT,qx,Xy,Xx,Yy,Ky,Zy,I5,zT,VT,w,D,W,re,me,Ee,Ge,ft,Tt,zt,xn,bn,Fn,fr,rr,Te,Ft=k(()=>{Bx=Q(pN()),Ws=Q(qe()),A5=Q(PT()),By(),gN(),_N(),Ux=Q(vm()),b9=function(s,l){for(var u=[s[0]],m=0,_=l.length;m<_;m+=1)u.push(l[m],s[m+1]);return u},S9=function(s){return s!==null&&typeof s=="object"&&(s.toString?s.toString():Object.prototype.toString.call(s))==="[object Object]"&&!(0,Bx.typeOf)(s)},w9=Object.freeze([]),eu=Object.freeze({}),tu=typeof process<"u"&&t!==void 0&&(t.REACT_APP_SC_ATTR||t.SC_ATTR)||"data-styled",E9=typeof window<"u"&&"HTMLElement"in window,DT=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&t!==void 0&&(t.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&t.REACT_APP_SC_DISABLE_SPEEDY!==""?t.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&t.REACT_APP_SC_DISABLE_SPEEDY:t.SC_DISABLE_SPEEDY!==void 0&&t.SC_DISABLE_SPEEDY!==""&&t.SC_DISABLE_SPEEDY!=="false"&&t.SC_DISABLE_SPEEDY)),zx={},Vx=function(){function s(u){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=u}var l=s.prototype;return l.indexOfGroup=function(u){for(var m=0,_=0;_<u;_++)m+=this.groupSizes[_];return m},l.insertRules=function(u,m){if(u>=this.groupSizes.length){for(var _=this.groupSizes,b=_.length,E=b;u>=E;)(E<<=1)<0&&yd(16,""+u);this.groupSizes=new Uint32Array(E),this.groupSizes.set(_),this.length=E;for(var T=b;T<E;T++)this.groupSizes[T]=0}for(var P=this.indexOfGroup(u+1),N=0,z=m.length;N<z;N++)this.tag.insertRule(P,m[N])&&(this.groupSizes[u]++,P++)},l.clearGroup=function(u){if(u<this.length){var m=this.groupSizes[u],_=this.indexOfGroup(u),b=_+m;this.groupSizes[u]=0;for(var E=_;E<b;E++)this.tag.deleteRule(_)}},l.getGroup=function(u){var m="";if(u>=this.length||this.groupSizes[u]===0)return m;for(var _=this.groupSizes[u],b=this.indexOfGroup(u),E=b+_,T=b;T<E;T++)m+=this.tag.getRule(T)+`/*!sc*/
`;return m},s}(),vd=new Map,bm=new Map,T9=1,P5=function(s){if(vd.has(s))return vd.get(s);for(;bm.has(T9);)T9++;var l=T9++;return vd.set(s,l),bm.set(l,s),l},Gx=function(s){return bm.get(s)},jx=function(s,l){l>=T9&&(T9=l+1),vd.set(s,l),bm.set(l,s)},Hx="style["+tu+'][data-styled-version="5.3.11"]',$a=new RegExp("^"+tu+'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)'),OT=function(s,l,u){for(var m,_=u.split(","),b=0,E=_.length;b<E;b++)(m=_[b])&&s.registerName(l,m)},Wy=function(s,l){for(var u=(l.textContent||"").split(`/*!sc*/
`),m=[],_=0,b=u.length;_<b;_++){var E=u[_].trim();if(E){var T=E.match($a);if(T){var P=0|parseInt(T[1],10),N=T[2];P!==0&&(jx(N,P),OT(s,N,T[3]),s.getTag().insertRules(P,m)),m.length=0}else m.push(E)}}},$y=function(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null},Wx=function(s){var l=document.head,u=s||l,m=document.createElement("style"),_=function(T){for(var P=T.childNodes,N=P.length;N>=0;N--){var z=P[N];if(z&&z.nodeType===1&&z.hasAttribute(tu))return z}}(u),b=_!==void 0?_.nextSibling:null;m.setAttribute(tu,"active"),m.setAttribute("data-styled-version","5.3.11");var E=$y();return E&&m.setAttribute("nonce",E),u.insertBefore(m,b),m},R5=function(){function s(u){var m=this.element=Wx(u);m.appendChild(document.createTextNode("")),this.sheet=function(_){if(_.sheet)return _.sheet;for(var b=document.styleSheets,E=0,T=b.length;E<T;E++){var P=b[E];if(P.ownerNode===_)return P}yd(17)}(m),this.length=0}var l=s.prototype;return l.insertRule=function(u,m){try{return this.sheet.insertRule(m,u),this.length++,!0}catch{return!1}},l.deleteRule=function(u){this.sheet.deleteRule(u),this.length--},l.getRule=function(u){var m=this.sheet.cssRules[u];return m!==void 0&&typeof m.cssText=="string"?m.cssText:""},s}(),k5=function(){function s(u){var m=this.element=Wx(u);this.nodes=m.childNodes,this.length=0}var l=s.prototype;return l.insertRule=function(u,m){if(u<=this.length&&u>=0){var _=document.createTextNode(m),b=this.nodes[u];return this.element.insertBefore(_,b||null),this.length++,!0}return!1},l.deleteRule=function(u){this.element.removeChild(this.nodes[u]),this.length--},l.getRule=function(u){return u<this.length?this.nodes[u].textContent:""},s}(),FT=function(){function s(u){this.rules=[],this.length=0}var l=s.prototype;return l.insertRule=function(u,m){return u<=this.length&&(this.rules.splice(u,0,m),this.length++,!0)},l.deleteRule=function(u){this.rules.splice(u,1),this.length--},l.getRule=function(u){return u<this.length?this.rules[u]:""},s}(),qa=E9,LT={isServer:!E9,useCSSOMInjection:!DT},lp=function(){function s(u,m,_){u===void 0&&(u=eu),m===void 0&&(m={}),this.options=Qc({},LT,{},u),this.gs=m,this.names=new Map(_),this.server=!!u.isServer,!this.server&&E9&&qa&&(qa=!1,function(b){for(var E=document.querySelectorAll(Hx),T=0,P=E.length;T<P;T++){var N=E[T];N&&N.getAttribute(tu)!=="active"&&(Wy(b,N),N.parentNode&&N.parentNode.removeChild(N))}}(this))}s.registerId=function(u){return P5(u)};var l=s.prototype;return l.reconstructWithOptions=function(u,m){return m===void 0&&(m=!0),new s(Qc({},this.options,{},u),this.gs,m&&this.names||void 0)},l.allocateGSInstance=function(u){return this.gs[u]=(this.gs[u]||0)+1},l.getTag=function(){return this.tag||(this.tag=(_=(m=this.options).isServer,b=m.useCSSOMInjection,E=m.target,u=_?new FT(E):b?new R5(E):new k5(E),new Vx(u)));var u,m,_,b,E},l.hasNameForId=function(u,m){return this.names.has(u)&&this.names.get(u).has(m)},l.registerName=function(u,m){if(P5(u),this.names.has(u))this.names.get(u).add(m);else{var _=new Set;_.add(m),this.names.set(u,_)}},l.insertRules=function(u,m,_){this.registerName(u,m),this.getTag().insertRules(P5(u),_)},l.clearNames=function(u){this.names.has(u)&&this.names.get(u).clear()},l.clearRules=function(u){this.getTag().clearGroup(P5(u)),this.clearNames(u)},l.clearTag=function(){this.tag=void 0},l.toString=function(){return function(u){for(var m=u.getTag(),_=m.length,b="",E=0;E<_;E++){var T=Gx(E);if(T!==void 0){var P=u.names.get(T),N=m.getGroup(E);if(P&&N&&P.size){var z=tu+".g"+E+'[id="'+T+'"]',G="";P!==void 0&&P.forEach(function(V){V.length>0&&(G+=V+",")}),b+=""+N+z+'{content:"'+G+`"}/*!sc*/
`}}}return b}(this)},s}(),BT=/(a)(d)/gi,qy=function(s){return String.fromCharCode(s+(s>25?39:97))},cp=function(s,l){for(var u=l.length;u;)s=33*s^l.charCodeAt(--u);return s},$x=function(s){return cp(5381,s)},UT=$x("5.3.11"),qx=function(){function s(l,u,m){this.rules=l,this.staticRulesId="",this.isStatic=(m===void 0||m.isStatic)&&NT(l),this.componentId=u,this.baseHash=cp(UT,u),this.baseStyle=m,lp.registerId(u)}return s.prototype.generateAndInjectStyles=function(l,u,m){var _=this.componentId,b=[];if(this.baseStyle&&b.push(this.baseStyle.generateAndInjectStyles(l,u,m)),this.isStatic&&!m.hash)if(this.staticRulesId&&u.hasNameForId(_,this.staticRulesId))b.push(this.staticRulesId);else{var E=xm(this.rules,l,u,m).join(""),T=zy(cp(this.baseHash,E)>>>0);if(!u.hasNameForId(_,T)){var P=m(E,"."+T,void 0,_);u.insertRules(_,T,P)}b.push(T),this.staticRulesId=T}else{for(var N=this.rules.length,z=cp(this.baseHash,m.hash),G="",V=0;V<N;V++){var B=this.rules[V];if(typeof B=="string")G+=B;else if(B){var H=xm(B,l,u,m),j=Array.isArray(H)?H.join(""):H;z=cp(z,j+V),G+=j}}if(G){var X=zy(z>>>0);if(!u.hasNameForId(_,X)){var K=m(G,"."+X,void 0,_);u.insertRules(_,X,K)}b.push(X)}}return b.join(" ")},s}(),Xy=/^\s*\/\/.*$/gm,Xx=[":","[",".","#"],Yy=Ws.default.createContext(),Yy.Consumer,Ky=Ws.default.createContext(),Zy=(Ky.Consumer,new lp),I5=Vy(),zT=function(){function s(l,u){var m=this;this.inject=function(_,b){b===void 0&&(b=I5);var E=m.name+b.hash;_.hasNameForId(m.id,E)||_.insertRules(m.id,E,b(m.rules,E,"@keyframes"))},this.toString=function(){return yd(12,String(m.name))},this.name=l,this.id="sc-keyframes-"+l,this.rules=u}return s.prototype.getName=function(l){return l===void 0&&(l=I5),this.name+l.hash},s}(),VT=/([A-Z])/,w=/([A-Z])/g,D=/^ms-/,W=function(s){return"-"+s.toLowerCase()},re=function(s){return s==null||s===!1||s===""},me=function(s){return Array.isArray(s)&&(s.isCss=!0),s},Ee=function(s,l,u){return u===void 0&&(u=eu),s.theme!==u.theme&&s.theme||l||u.theme},Ge=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,ft=/(^-|-$)/g,Tt=function(s){return zy($x(s)>>>0)},zt=function(s){return typeof s=="function"||typeof s=="object"&&s!==null&&!Array.isArray(s)},xn=function(s){return s!=="__proto__"&&s!=="constructor"&&s!=="prototype"},bn=Ws.default.createContext(),bn.Consumer,Fn={},fr=function(s){return function l(u,m,_){if(_===void 0&&(_=eu),!(0,Bx.isValidElementType)(m))return yd(1,String(m));var b=function(){return u(m,_,Wa.apply(void 0,arguments))};return b.withConfig=function(E){return l(u,m,Qc({},_,{},E))},b.attrs=function(E){return l(u,m,Qc({},_,{attrs:Array.prototype.concat(_.attrs,E).filter(Boolean)}))},b}(Hy,s)},["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","textPath","tspan"].forEach(function(s){fr[s]=fr(s)}),rr=function(){function s(u,m){this.rules=u,this.componentId=m,this.isStatic=NT(u),lp.registerId(this.componentId+1)}var l=s.prototype;return l.createStyles=function(u,m,_,b){var E=b(xm(this.rules,m,_,b).join(""),""),T=this.componentId+u;_.insertRules(T,T,E)},l.removeStyles=function(u,m){m.clearRules(this.componentId+u)},l.renderStyles=function(u,m,_,b){u>2&&lp.registerId(this.componentId+u),this.removeStyles(u,_),this.createStyles(u,m,_,b)},s}(),function(){function s(){var u=this;this._emitSheetCSS=function(){var m=u.instance.toString();if(!m)return"";var _=$y();return"<style "+[_&&'nonce="'+_+'"',tu+'="true"','data-styled-version="5.3.11"'].filter(Boolean).join(" ")+">"+m+"</style>"},this.getStyleTags=function(){return u.sealed?yd(2):u._emitSheetCSS()},this.getStyleElement=function(){var m;if(u.sealed)return yd(2);var _=((m={})[tu]="",m["data-styled-version"]="5.3.11",m.dangerouslySetInnerHTML={__html:u.instance.toString()},m),b=$y();return b&&(_.nonce=b),[Ws.default.createElement("style",Qc({},_,{key:"sc-0-0"}))]},this.seal=function(){u.sealed=!0},this.instance=new lp({isServer:!0}),this.sealed=!1}var l=s.prototype;return l.collectStyles=function(u){return this.sealed?yd(2):Ws.default.createElement(Gy,{sheet:this.instance},u)},l.interleaveWithNodeStream=function(u){return yd(3)},s}(),Te=fr});function Or(){return Or=Object.assign||function(s){for(var l=1;l<arguments.length;l++){var u=arguments[l];for(var m in u)Object.prototype.hasOwnProperty.call(u,m)&&(s[m]=u[m])}return s},Or.apply(this,arguments)}var Oi=k(()=>{});function Aa(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}var w0=k(()=>{});function Co(s,l){return Co=Object.setPrototypeOf||function(u,m){return u.__proto__=m,u},Co(s,l)}var Ki=k(()=>{});function Pa(s,l){s.prototype=Object.create(l.prototype),s.prototype.constructor=s,Co(s,l)}var fl=k(()=>{Ki()});function sc(s){return sc=Object.setPrototypeOf?Object.getPrototypeOf:function(l){return l.__proto__||Object.getPrototypeOf(l)},sc(s)}var Sm=k(()=>{});function wm(s){return Function.toString.call(s).indexOf("[native code]")!==-1}var Em=k(()=>{});function Tm(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Mm=k(()=>{});function $s(s,l,u){return Tm()?$s=Reflect.construct:$s=function(m,_,b){var E=[null];E.push.apply(E,_);var T=Function.bind.apply(m,E),P=new T;return b&&Co(P,b.prototype),P},$s.apply(null,arguments)}var pl=k(()=>{Ki(),Mm()});function rs(s){var l=typeof Map=="function"?new Map:void 0;return rs=function(u){if(u===null||!wm(u))return u;if(typeof u!="function")throw new TypeError("Super expression must either be null or a function");if(typeof l<"u"){if(l.has(u))return l.get(u);l.set(u,m)}function m(){return $s(u,arguments,sc(this).constructor)}return m.prototype=Object.create(u.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),Co(m,u)},rs(s)}var _d=k(()=>{Sm(),Ki(),Em(),pl()}),xd=k(()=>{});function t8e(s){return s.charAt(0).toUpperCase()+s.slice(1)}function n8e(s,l){if(!s)return l.toLowerCase();var u=s.split("-");if(u.length>1)return u.splice(1,0,l),u.reduce(function(_,b){return""+_+t8e(b)});var m=s.replace(/([a-z])([A-Z])/g,"$1"+l+"$2");return s===m?""+s+l:m}function r8e(s,l){for(var u={},m=0;m<l.length;m+=1)(l[m]||l[m]===0)&&(u[n8e(s,r$[m])]=l[m]);return u}function ZW(s){for(var l=arguments.length,u=new Array(l>1?l-1:0),m=1;m<l;m++)u[m-1]=arguments[m];var _=u[0],b=u[1],E=b===void 0?_:b,T=u[2],P=T===void 0?_:T,N=u[3],z=N===void 0?E:N,G=[_,E,P,z];return r8e(s,G)}function xN(s){return Math.round(s*255)}function i8e(s,l,u){return xN(s)+","+xN(l)+","+xN(u)}function GT(s,l,u,m){if(m===void 0&&(m=i8e),l===0)return m(u,u,u);var _=(s%360+360)%360/60,b=(1-Math.abs(2*u-1))*l,E=b*(1-Math.abs(_%2-1)),T=0,P=0,N=0;_>=0&&_<1?(T=b,P=E):_>=1&&_<2?(T=E,P=b):_>=2&&_<3?(P=b,N=E):_>=3&&_<4?(P=E,N=b):_>=4&&_<5?(T=E,N=b):_>=5&&_<6&&(T=b,N=E);var z=u-b/2,G=T+z,V=P+z,B=N+z;return m(G,V,B)}function s8e(s){if(typeof s!="string")return s;var l=s.toLowerCase();return TN[l]?"#"+TN[l]:s}function QW(s){if(typeof s!="string")throw new bd(3);var l=s8e(s);if(l.match(i$))return{red:parseInt(""+l[1]+l[2],16),green:parseInt(""+l[3]+l[4],16),blue:parseInt(""+l[5]+l[6],16)};if(l.match(s$)){var u=parseFloat((parseInt(""+l[7]+l[8],16)/255).toFixed(2));return{red:parseInt(""+l[1]+l[2],16),green:parseInt(""+l[3]+l[4],16),blue:parseInt(""+l[5]+l[6],16),alpha:u}}if(l.match(o$))return{red:parseInt(""+l[1]+l[1],16),green:parseInt(""+l[2]+l[2],16),blue:parseInt(""+l[3]+l[3],16)};if(l.match(a$)){var m=parseFloat((parseInt(""+l[4]+l[4],16)/255).toFixed(2));return{red:parseInt(""+l[1]+l[1],16),green:parseInt(""+l[2]+l[2],16),blue:parseInt(""+l[3]+l[3],16),alpha:m}}var _=WT.exec(l);if(_)return{red:parseInt(""+_[1],10),green:parseInt(""+_[2],10),blue:parseInt(""+_[3],10)};var b=l$.exec(l.substring(0,50));if(b)return{red:parseInt(""+b[1],10),green:parseInt(""+b[2],10),blue:parseInt(""+b[3],10),alpha:parseFloat(""+b[4])};var E=c$.exec(l);if(E){var T=parseInt(""+E[1],10),P=parseInt(""+E[2],10)/100,N=parseInt(""+E[3],10)/100,z="rgb("+GT(T,P,N)+")",G=WT.exec(z);if(!G)throw new bd(4,l,z);return{red:parseInt(""+G[1],10),green:parseInt(""+G[2],10),blue:parseInt(""+G[3],10)}}var V=u$.exec(l.substring(0,50));if(V){var B=parseInt(""+V[1],10),H=parseInt(""+V[2],10)/100,j=parseInt(""+V[3],10)/100,X="rgb("+GT(B,H,j)+")",K=WT.exec(X);if(!K)throw new bd(4,l,X);return{red:parseInt(""+K[1],10),green:parseInt(""+K[2],10),blue:parseInt(""+K[3],10),alpha:parseFloat(""+V[4])}}throw new bd(5)}function o8e(s){var l=s.red/255,u=s.green/255,m=s.blue/255,_=Math.max(l,u,m),b=Math.min(l,u,m),E=(_+b)/2;if(_===b)return s.alpha!==void 0?{hue:0,saturation:0,lightness:E,alpha:s.alpha}:{hue:0,saturation:0,lightness:E};var T,P=_-b,N=E>.5?P/(2-_-b):P/(_+b);switch(_){case l:T=(u-m)/P+(u<m?6:0);break;case u:T=(m-l)/P+2;break;default:T=(l-u)/P+4;break}return T*=60,s.alpha!==void 0?{hue:T,saturation:N,lightness:E,alpha:s.alpha}:{hue:T,saturation:N,lightness:E}}function bN(s){return o8e(QW(s))}function N5(s){var l=s.toString(16);return l.length===1?"0"+l:l}function SN(s){return N5(Math.round(s*255))}function a8e(s,l,u){return $T("#"+SN(s)+SN(l)+SN(u))}function JW(s,l,u){return GT(s,l,u,a8e)}function l8e(s,l,u){if(typeof s=="object"&&l===void 0&&u===void 0)return JW(s.hue,s.saturation,s.lightness);throw new bd(1)}function c8e(s,l,u,m){if(typeof s=="object"&&l===void 0&&u===void 0&&m===void 0)return s.alpha>=1?JW(s.hue,s.saturation,s.lightness):"rgba("+GT(s.hue,s.saturation,s.lightness)+","+s.alpha+")";throw new bd(2)}function e$(s,l,u){if(typeof s=="number"&&typeof l=="number"&&typeof u=="number")return $T("#"+N5(s)+N5(l)+N5(u));if(typeof s=="object"&&l===void 0&&u===void 0)return $T("#"+N5(s.red)+N5(s.green)+N5(s.blue));throw new bd(6)}function t$(s,l,u,m){if(typeof s=="object"&&l===void 0&&u===void 0&&m===void 0)return s.alpha>=1?e$(s.red,s.green,s.blue):"rgba("+s.red+","+s.green+","+s.blue+","+s.alpha+")";throw new bd(7)}function wN(s){if(typeof s!="object")throw new bd(8);if(d$(s))return t$(s);if(h$(s))return e$(s);if(p$(s))return c8e(s);if(f$(s))return l8e(s);throw new bd(8)}function n$(s,l,u){return function(){var m=u.concat(Array.prototype.slice.call(arguments));return m.length>=l?s.apply(this,m):n$(s,l,m)}}function jT(s){return n$(s,s.length,[])}function HT(s,l,u){return Math.max(s,Math.min(l,u))}function u8e(s,l){if(l==="transparent")return l;var u=bN(l);return wN(Or({},u,{lightness:HT(0,1,u.lightness-parseFloat(s))}))}function h8e(s,l){if(l==="transparent")return l;var u=bN(l);return wN(Or({},u,{lightness:HT(0,1,u.lightness+parseFloat(s))}))}function d8e(s,l){if(l==="transparent")return l;var u=bN(l);return wN(Or({},u,{saturation:HT(0,1,u.saturation+parseFloat(s))}))}function f8e(s,l){if(l==="transparent")return l;var u=QW(l),m=typeof u.alpha=="number"?u.alpha:1,_=Or({},u,{alpha:HT(0,1,+(m*100-parseFloat(s)*100).toFixed(2)/100)});return t$(_)}function EN(s){for(var l=arguments.length,u=new Array(l>1?l-1:0),m=1;m<l;m++)u[m-1]=arguments[m];return m$.indexOf(s)>=0&&s?Or({},ZW.apply(void 0,[""].concat(u)),{position:s}):ZW.apply(void 0,["",s].concat(u))}var bd,r$,TN,i$,s$,o$,a$,WT,l$,c$,u$,$T,h$,d$,f$,p$,Yx,Qy,qT,Sd,m$,nu=k(()=>{Oi(),w0(),fl(),_d(),xd(),bd=function(s){Pa(l,s);function l(u){var m;return m=s.call(this,"An error occurred. See https://github.com/styled-components/polished/blob/main/src/internalHelpers/errors.md#"+u+" for more information.")||this,Aa(m)}return l}(rs(Error)),r$=["Top","Right","Bottom","Left"],TN={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"639",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},i$=/^#[a-fA-F0-9]{6}$/,s$=/^#[a-fA-F0-9]{8}$/,o$=/^#[a-fA-F0-9]{3}$/,a$=/^#[a-fA-F0-9]{4}$/,WT=/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/i,l$=/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*([-+]?[0-9]*[.]?[0-9]+)\s*\)$/i,c$=/^hsl\(\s*(\d{0,3}[.]?[0-9]+)\s*,\s*(\d{1,3}[.]?[0-9]?)%\s*,\s*(\d{1,3}[.]?[0-9]?)%\s*\)$/i,u$=/^hsla\(\s*(\d{0,3}[.]?[0-9]+)\s*,\s*(\d{1,3}[.]?[0-9]?)%\s*,\s*(\d{1,3}[.]?[0-9]?)%\s*,\s*([-+]?[0-9]*[.]?[0-9]+)\s*\)$/i,$T=function(s){return s.length===7&&s[1]===s[2]&&s[3]===s[4]&&s[5]===s[6]?"#"+s[1]+s[3]+s[5]:s},h$=function(s){return typeof s.red=="number"&&typeof s.green=="number"&&typeof s.blue=="number"&&(typeof s.alpha!="number"||typeof s.alpha>"u")},d$=function(s){return typeof s.red=="number"&&typeof s.green=="number"&&typeof s.blue=="number"&&typeof s.alpha=="number"},f$=function(s){return typeof s.hue=="number"&&typeof s.saturation=="number"&&typeof s.lightness=="number"&&(typeof s.alpha!="number"||typeof s.alpha>"u")},p$=function(s){return typeof s.hue=="number"&&typeof s.saturation=="number"&&typeof s.lightness=="number"&&typeof s.alpha=="number"},Yx=jT(u8e),Qy=jT(h8e),qT=jT(d8e),Sd=jT(f8e),m$=["absolute","fixed","relative","static","sticky"]});function p8e(s,l,u){return l in s?Object.defineProperty(s,l,{value:u,enumerable:!0,configurable:!0,writable:!0}):s[l]=u,s}function g$(s,l){var u=Object.keys(s);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(s);l&&(m=m.filter(function(_){return Object.getOwnPropertyDescriptor(s,_).enumerable})),u.push.apply(u,m)}return u}function D5(s){for(var l=1;l<arguments.length;l++){var u=arguments[l]!=null?arguments[l]:{};l%2?g$(Object(u),!0).forEach(function(m){p8e(s,m,u[m])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(u)):g$(Object(u)).forEach(function(m){Object.defineProperty(s,m,Object.getOwnPropertyDescriptor(u,m))})}return s}function Jy(s,l){if(s==null)return{};var u={},m=Object.keys(s),_,b;for(b=0;b<m.length;b++)_=m[b],!(l.indexOf(_)>=0)&&(u[_]=s[_]);return u}var Kx=k(()=>{}),y$,MN,v$=k(()=>{y$=Q(qe()),MN=(0,y$.createContext)({})});function m8e(s,l,u){return l in s?Object.defineProperty(s,l,{value:u,enumerable:!0,configurable:!0,writable:!0}):s[l]=u,s}function _$(s,l){var u=Object.keys(s);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(s);l&&(m=m.filter(function(_){return Object.getOwnPropertyDescriptor(s,_).enumerable})),u.push.apply(u,m)}return u}function ev(s){for(var l=1;l<arguments.length;l++){var u=arguments[l]!=null?arguments[l]:{};l%2?_$(Object(u),!0).forEach(function(m){m8e(s,m,u[m])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(u)):_$(Object(u)).forEach(function(m){Object.defineProperty(s,m,Object.getOwnPropertyDescriptor(u,m))})}return s}function CN(s,l){if(s==null)return{};var u={},m=Object.keys(s),_,b;for(b=0;b<m.length;b++)_=m[b],!(l.indexOf(_)>=0)&&(u[_]=s[_]);return u}function g8e(s,l){if(s){if(typeof s=="string")return x$(s,l);var u=Object.prototype.toString.call(s).slice(8,-1);if(u==="Object"&&s.constructor&&(u=s.constructor.name),u==="Map"||u==="Set")return Array.from(s);if(u==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(u))return x$(s,l)}}function x$(s,l){(l==null||l>s.length)&&(l=s.length);for(var u=0,m=new Array(l);u<l;u++)m[u]=s[u];return m}function b$(s,l){var u;if(typeof Symbol>"u"||s[Symbol.iterator]==null){if(Array.isArray(s)||(u=g8e(s))||l){u&&(s=u);var m=0;return function(){return m>=s.length?{done:!0}:{done:!1,value:s[m++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}return u=s[Symbol.iterator](),u.next.bind(u)}var XT=k(()=>{});function y8e(s){return typeof s=="function"}var AN,S$,v8e=k(()=>{AN=Q(qe()),v$(),XT(),S$=function(s,l,u){u===void 0&&(u=l.children);var m=(0,AN.useContext)(MN);if(m.useCreateElement)return m.useCreateElement(s,l,u);if(typeof s=="string"&&y8e(u)){l.children;var _=CN(l,["children"]);return u(_)}return(0,AN.createElement)(s,l,u)}});function _8e(s,l,u){return l in s?Object.defineProperty(s,l,{value:u,enumerable:!0,configurable:!0,writable:!0}):s[l]=u,s}function w$(s,l){var u=Object.keys(s);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(s);l&&(m=m.filter(function(_){return Object.getOwnPropertyDescriptor(s,_).enumerable})),u.push.apply(u,m)}return u}function tv(s){for(var l=1;l<arguments.length;l++){var u=arguments[l]!=null?arguments[l]:{};l%2?w$(Object(u),!0).forEach(function(m){_8e(s,m,u[m])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(u)):w$(Object(u)).forEach(function(m){Object.defineProperty(s,m,Object.getOwnPropertyDescriptor(u,m))})}return s}function x8e(s,l){if(s==null)return{};var u={},m=Object.keys(s),_,b;for(b=0;b<m.length;b++)_=m[b],!(l.indexOf(_)>=0)&&(u[_]=s[_]);return u}var E$=k(()=>{});function b8e(s){return typeof s=="object"&&s!=null}var S8e=k(()=>{});function PN(s){var l;if(!b8e(s))return!1;var u=Object.getPrototypeOf(s);return u==null?!0:((l=u.constructor)===null||l===void 0?void 0:l.toString())===Object.toString()}var T$=k(()=>{S8e()});function M$(s,l){for(var u=Object.keys(s),m={},_={},b=0,E=u;b<E.length;b++){var T=E[b];l.indexOf(T)>=0?m[T]=s[T]:_[T]=s[T]}return[m,_]}function C$(s,l){if(l===void 0&&(l=[]),!PN(s.state))return M$(s,l);var u=M$(s,[].concat(l,["state"])),m=u[0],_=u[1],b=m.state,E=x8e(m,["state"]);return[tv(tv({},b),E),_]}var w8e=k(()=>{E$(),T$()});function YT(s,l){if(s===l)return!0;if(!s||!l||typeof s!="object"||typeof l!="object")return!1;var u=Object.keys(s),m=Object.keys(l),_=u.length;if(m.length!==_)return!1;for(var b=0,E=u;b<E.length;b++){var T=E[b];if(s[T]!==l[T])return!1}return!0}var RN=k(()=>{});function A$(s){return s.name==="normalizePropsAreEqualInner"?s:function(l,u){return!PN(l.state)||!PN(u.state)?s(l,u):s(tv(tv({},l.state),l),tv(tv({},u.state),u))}}var E8e=k(()=>{E$(),T$()});function T8e(s){return(0,kN.forwardRef)(s)}function M8e(s,l){return(0,kN.memo)(s,l)}function Zx(s){var l=s.as,u=s.useHook,m=s.memo,_=s.propsAreEqual,b=_===void 0?u==null?void 0:u.unstable_propsAreEqual:_,E=s.keys,T=E===void 0?(u==null?void 0:u.__keys)||[]:E,P=s.useCreateElement,N=P===void 0?S$:P,z=function(G,V){var B=G.as,H=B===void 0?l:B,j=CN(G,["as"]);if(u){var X,K=C$(j,T),te=K[0],se=K[1],pe=u(te,ev({ref:V},se)),fe=pe.wrapElement,ve=CN(pe,["wrapElement"]),Ne=((X=H.render)===null||X===void 0?void 0:X.__keys)||H.__keys,ze=Ne&&C$(j,Ne)[0],Me=ze?ev(ev({},ve),ze):ve,He=N(H,Me);return fe?fe(He):He}return N(H,ev({ref:V},j))};return z=T8e(z),m&&(z=M8e(z,b&&A$(b))),z.__keys=T,z.unstable_propsAreEqual=A$(b||YT),z}var kN,Qx=k(()=>{kN=Q(qe()),XT(),v8e(),w8e(),RN(),E8e()});function P$(s,l){(0,IN.useDebugValue)(s);var u=(0,IN.useContext)(MN);return u[s]!=null?u[s]:l}var IN,R$=k(()=>{IN=Q(qe()),v$()});function C8e(s,l,u){l===void 0&&(l={}),u===void 0&&(u={});var m="use"+s+"Props";(0,k$.useDebugValue)(m);var _=P$(m);return _?_(l,u):u}var k$,A8e=k(()=>{k$=Q(qe()),R$()});function P8e(s,l,u){l===void 0&&(l={}),u===void 0&&(u={});var m="use"+s+"Options";(0,I$.useDebugValue)(m);var _=P$(m);return _?ev(ev({},l),_(l,u)):l}var I$,R8e=k(()=>{I$=Q(qe()),R$(),XT()});function k8e(s){return Array.isArray(s)?s:typeof s<"u"?[s]:[]}var I8e=k(()=>{});function Jx(s){var l,u,m=k8e(s.compose),_=function(T,P){if(s.useOptions&&(T=s.useOptions(T,P)),s.name&&(T=P8e(s.name,T,P)),s.compose)for(var N=b$(m),z;!(z=N()).done;){var G=z.value;T=G.__useOptions(T,P)}return T},b=function(T,P,N){if(T===void 0&&(T={}),P===void 0&&(P={}),N===void 0&&(N=!1),N||(T=_(T,P)),s.useProps&&(P=s.useProps(T,P)),s.name&&(P=C8e(s.name,T,P)),s.compose)if(s.useComposeOptions&&(T=s.useComposeOptions(T,P)),s.useComposeProps)P=s.useComposeProps(T,P);else for(var z=b$(m),G;!(G=z()).done;){var V=G.value;P=V(T,P,!0)}var B={},H=P||{};for(var j in H)H[j]!==void 0&&(B[j]=H[j]);return B};b.__useOptions=_;var E=m.reduce(function(T,P){return T.push.apply(T,P.__keys||[]),T},[]);return b.__keys=[].concat(E,((l=s.useState)===null||l===void 0?void 0:l.__keys)||[],s.keys||[]),b.unstable_propsAreEqual=s.propsAreEqual||((u=m[0])===null||u===void 0?void 0:u.unstable_propsAreEqual)||YT,b}var eb=k(()=>{Q(qe()),A8e(),XT(),R8e(),RN(),I8e()});function N$(s,l){l===void 0&&(l=null),s&&(typeof s=="function"?s(l):s.current=l)}function D$(s,l){return(0,O$.useMemo)(function(){return s==null&&l==null?null:function(u){N$(s,u),N$(l,u)}},[s,l])}var O$,F$=k(()=>{O$=Q(qe())});function NN(s){if(s.tagName==="BUTTON")return!0;if(s.tagName==="INPUT"){var l=s;return L$.indexOf(l.type)!==-1}return!1}var L$,DN=k(()=>{L$=["button","color","file","image","reset","submit"]}),ON=k(()=>{}),N8e=k(()=>{ON(),Q(qe())}),KT=k(()=>{ON(),Q(qe()),N8e()});function D8e(s){return s?s.ownerDocument||s:document}var B$=k(()=>{});function O8e(s){return U$}var U$,F8e=k(()=>{B$();try{U$=window}catch{}});function L8e(){var s=O8e();return!!(typeof s<"u"&&s.document&&s.document.createElement)}var ZT,FN=k(()=>{F8e(),ZT=L8e()}),LN,BN,UN=k(()=>{LN=Q(qe()),FN(),BN=ZT?LN.useLayoutEffect:LN.useEffect});function nv(s){var l=(0,z$.useRef)(s);return BN(function(){l.current=s}),l}var z$,V$=k(()=>{z$=Q(qe()),UN()});function B8e(s){return s.target===s.currentTarget}var U8e=k(()=>{});function z8e(s){var l=D8e(s),u=l.activeElement;return u!=null&&u.nodeName?u:null}var V8e=k(()=>{B$()});function G$(s,l){return s===l||s.contains(l)}var j$=k(()=>{});function G8e(s){var l=z8e(s);if(!l)return!1;if(G$(s,l))return!0;var u=l.getAttribute("aria-activedescendant");return u?u===s.id?!0:!!s.querySelector("#"+u):!1}var j8e=k(()=>{V8e(),j$()});function H8e(s){return!G$(s.currentTarget,s.target)}var W8e=k(()=>{j$()});function QT(s){return ZT?window.navigator.userAgent.indexOf(s)!==-1:!1}var $8e=k(()=>{FN()});function q8e(s,l){return"matches"in s?s.matches(l):"msMatchesSelector"in s?s.msMatchesSelector(l):s.webkitMatchesSelector(l)}var X8e=k(()=>{});function Y8e(s){var l=s;return l.offsetWidth>0||l.offsetHeight>0||s.getClientRects().length>0}function K8e(s){return q8e(s,H$)&&Y8e(s)}var H$,Z8e=k(()=>{X8e(),H$="input:not([type='hidden']):not([disabled]), select:not([disabled]), textarea:not([disabled]), a[href], button:not([disabled]), [tabindex], iframe, object, embed, area[href], audio[controls], video[controls], [contenteditable]:not([contenteditable='false'])"}),W$,JT,$$=k(()=>{Kx(),Qx(),eb(),RN(),W$=["unstable_system"],JT=Jx({name:"Role",keys:W$,propsAreEqual:function(s,l){var u=s.unstable_system,m=Jy(s,["unstable_system"]),_=l.unstable_system,b=Jy(l,["unstable_system"]);return u!==_&&!YT(u,_)?!1:YT(m,b)}}),Zx({as:"div",useHook:JT})});function q$(s){!G8e(s)&&K8e(s)&&s.focus()}function Q8e(s){return s.tagName==="BUTTON"||s.tagName==="INPUT"||s.tagName==="SELECT"||s.tagName==="TEXTAREA"||s.tagName==="A"}function J8e(s){return s.tagName==="BUTTON"||s.tagName==="INPUT"||s.tagName==="SELECT"||s.tagName==="TEXTAREA"}function e6e(s,l,u,m){return s?l&&!u?-1:void 0:l?m:m||0}function zN(s,l){return(0,rv.useCallback)(function(u){var m;(m=s.current)===null||m===void 0||m.call(s,u),!u.defaultPrevented&&l&&(u.stopPropagation(),u.preventDefault())},[s,l])}var rv,X$,Y$,VN,t6e=k(()=>{Kx(),Qx(),eb(),rv=Q(qe()),F$(),DN(),KT(),V$(),UN(),j8e(),W8e(),$8e(),Z8e(),$$(),X$=["disabled","focusable"],Y$=QT("Mac")&&!QT("Chrome")&&(QT("Safari")||QT("Firefox")),VN=Jx({name:"Tabbable",compose:JT,keys:X$,useOptions:function(s,l){var u=l.disabled;return D5({disabled:u},s)},useProps:function(s,l){var u=l.ref,m=l.tabIndex,_=l.onClickCapture,b=l.onMouseDownCapture,E=l.onMouseDown,T=l.onKeyPressCapture,P=l.style,N=Jy(l,["ref","tabIndex","onClickCapture","onMouseDownCapture","onMouseDown","onKeyPressCapture","style"]),z=(0,rv.useRef)(null),G=nv(_),V=nv(b),B=nv(E),H=nv(T),j=!!s.disabled&&!s.focusable,X=(0,rv.useState)(!0),K=X[0],te=X[1],se=(0,rv.useState)(!0),pe=se[0],fe=se[1],ve=s.disabled?D5({pointerEvents:"none"},P):P;BN(function(){var vt=z.current;vt&&(Q8e(vt)||te(!1),J8e(vt)||fe(!1))},[]);var Ne=zN(G,s.disabled),ze=zN(V,s.disabled),Me=zN(H,s.disabled),He=(0,rv.useCallback)(function(vt){var xe;(xe=B.current)===null||xe===void 0||xe.call(B,vt);var We=vt.currentTarget;if(!vt.defaultPrevented&&Y$&&!H8e(vt)&&NN(We)){var oe=requestAnimationFrame(function(){We.removeEventListener("mouseup",nt,!0),q$(We)}),nt=function(){cancelAnimationFrame(oe),q$(We)};We.addEventListener("mouseup",nt,{once:!0,capture:!0})}},[]);return D5({ref:D$(z,u),style:ve,tabIndex:e6e(j,K,pe,m),disabled:j&&pe?!0:void 0,"aria-disabled":s.disabled?!0:void 0,onClickCapture:Ne,onMouseDownCapture:ze,onMouseDown:He,onKeyPressCapture:Me},N)}}),Zx({as:"div",useHook:VN})});function n6e(s){var l=s.currentTarget;return s.isTrusted?NN(l)||l.tagName==="INPUT"||l.tagName==="TEXTAREA"||l.tagName==="A"||l.tagName==="SELECT":!1}var eM,K$,GN,r6e=k(()=>{Kx(),Qx(),eb(),eM=Q(qe()),DN(),KT(),V$(),U8e(),t6e(),K$=["unstable_clickOnEnter","unstable_clickOnSpace"],GN=Jx({name:"Clickable",compose:VN,keys:K$,useOptions:function(s){var l=s.unstable_clickOnEnter,u=l===void 0?!0:l,m=s.unstable_clickOnSpace,_=m===void 0?!0:m,b=Jy(s,["unstable_clickOnEnter","unstable_clickOnSpace"]);return D5({unstable_clickOnEnter:u,unstable_clickOnSpace:_},b)},useProps:function(s,l){var u=l.onKeyDown,m=l.onKeyUp,_=Jy(l,["onKeyDown","onKeyUp"]),b=(0,eM.useState)(!1),E=b[0],T=b[1],P=nv(u),N=nv(m),z=(0,eM.useCallback)(function(V){var B;if((B=P.current)===null||B===void 0||B.call(P,V),!V.defaultPrevented&&!s.disabled&&!V.metaKey&&B8e(V)){var H=s.unstable_clickOnEnter&&V.key==="Enter",j=s.unstable_clickOnSpace&&V.key===" ";if(H||j){if(n6e(V))return;V.preventDefault(),H?V.currentTarget.click():j&&T(!0)}}},[s.disabled,s.unstable_clickOnEnter,s.unstable_clickOnSpace]),G=(0,eM.useCallback)(function(V){var B;if((B=N.current)===null||B===void 0||B.call(N,V),!V.defaultPrevented&&!s.disabled&&!V.metaKey){var H=s.unstable_clickOnSpace&&V.key===" ";E&&H&&(T(!1),V.currentTarget.click())}},[s.disabled,s.unstable_clickOnSpace,E]);return D5({"data-active":E||void 0,onKeyDown:z,onKeyUp:G},_)}}),Zx({as:"button",memo:!0,useHook:GN})}),tb,Z$,Q$,J$,i6e=k(()=>{Kx(),Qx(),eb(),tb=Q(qe()),F$(),DN(),KT(),r6e(),Z$=[],Q$=Jx({name:"Button",compose:GN,keys:Z$,useProps:function(s,l){var u=l.ref,m=Jy(l,["ref"]),_=(0,tb.useRef)(null),b=(0,tb.useState)(void 0),E=b[0],T=b[1],P=(0,tb.useState)("button"),N=P[0],z=P[1];return(0,tb.useEffect)(function(){var G=_.current;G&&(NN(G)||(G.tagName!=="A"&&T("button"),z(void 0)))},[]),D5({ref:D$(_,u),role:E,type:N},m)}}),J$=Zx({as:"button",memo:!0,useHook:Q$})}),eq,tq,nq,s6e=k(()=>{Kx(),Qx(),eb(),$$(),eq=[],tq=Jx({name:"Group",compose:JT,keys:eq,useProps:function(s,l){return D5({role:"group"},l)}}),nq=Zx({as:"div",useHook:tq})});function o6e(){return ZT?document.body:null}var rq,iv,a6e=k(()=>{rq=Q(qe()),UN(),FN(),Q(ua()),iv=(0,rq.createContext)(o6e())}),jN,l6e=k(()=>{typeof window<"u"&&(jN={get passive(){}},window.addEventListener("testPassive",null,jN),window.removeEventListener("testPassive",null,jN))}),O5=k(()=>{Q(qe()),KT(),i6e(),s6e(),Q(ua()),a6e(),l6e(),ON()});function Ai(s){let l=(0,HN.useMemo)(()=>{let _=s;return{get current(){return _},set current(b){_=b,m(b)}}},[]),[u,m]=(0,HN.useState)(()=>s);return[l,u]}var HN,Fi=k(()=>{HN=Q(qe())});function c6e(s){return l=>E0.default.createElement(cq,null,E0.default.createElement(s,R({},l)))}var E0,iq,sq,Di,sv,oq,aq,lq,WN,$N,cq,Li=k(()=>{nu(),Ft(),Ft(),E0=Q(qe()),iq=Q(ua()),O5(),Fi(),Di=Wa(sq||(sq=J([`
  #pointer-root & {
    pointer-events: none;
  }
  #pointer-root.normal & {
    pointer-events: auto;
  }
`]))),sv={panel:{bg:"#282b2f",head:{title:{color:"#bbb"},punctuation:{color:"#808080"}},body:{compoudThing:{label:{get color(){return Qy(.6,sv.panel.bg)}}}}}},aq=typeof window<"u"?Lx(oq||(oq=J([`
  :host {
    all: initial;
    color: white;
    font: 11px -apple-system, BlinkMacSystemFont, Segoe WPC, Segoe Editor,
      HelveticaNeue-Light, Ubuntu, Droid Sans, sans-serif;
  }

  * {
    padding: 0;
    margin: 0;
    font-size: 100%;
    font: inherit;
    vertical-align: baseline;
    list-style: none;
  }
`]))):{},WN=Te.div(lq||(lq=J([`
  z-index: 51;
  position: fixed;
  top: 0px;
  right: 0px;
  bottom: 0px;
  left: 0px;
  pointer-events: none;
`]))),$N=s=>E0.default.createElement(Gy,{disableVendorPrefixes:!0,target:s.target},E0.default.createElement(E0.default.Fragment,null,E0.default.createElement(aq,null),s.children)),cq=s=>{let[l,u]=(0,E0.useState)(null),[m,_]=(0,E0.useState)(null);(0,E0.useLayoutEffect)(()=>{if(!l)return;let{parentNode:T}=l;if(!T)return;let P=T.shadowRoot?parent.shadowRoot:T.attachShadow({mode:"open"});_(P)},[l]);let[b,E]=Ai(void 0);return m?iq.default.createPortal(E0.default.createElement($N,{target:m},E0.default.createElement(E0.default.Fragment,null,E0.default.createElement(WN,{ref:b}),E0.default.createElement(iv.Provider,{value:E},s.children))),m):E0.default.createElement("template",{ref:u,"shadow-root":"open"},s.children)}}),ov,uq,hq,M9,dq,nb,fq,pq,tM,mq,qN,up,Cm=k(()=>{Li(),Ft(),ov={get outlinePanel(){return 1},get propsPanel(){return ov.outlinePanel},get sequenceEditorPanel(){return this.outlinePanel-1},get toolbar(){return this.outlinePanel+1},get pluginPanes(){return this.sequenceEditorPanel-1}},uq=sv.panel.bg,M9=Te.span(hq||(hq=J([`
  white-space: nowrap;
`]))),nb=Te.span(dq||(dq=J([`
  white-space: nowrap;
  color: `,`;
`])),sv.panel.head.punctuation.color),pq=Te.div(fq||(fq=J([`
  background: `,`;
  flex-grow: 1;
  overflow-y: scroll;
  padding: 0;
`])),uq),tM=18,qN=Te.div(mq||(mq=J([`
  height: `,`px;
  box-sizing: border-box;
  display: flex;
  align-items: center;
  padding: 0 10px;
  position: relative;
  color: #adadadb3;
  border-bottom: 1px solid rgb(0 0 0 / 13%);
  background-color: #25272b;
  font-size: 10px;
  font-weight: 500;
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
`])),tM),up=100}),gq,wd,av=k(()=>{gq=()=>{},wd=gq});function u6e(s){return XN.createElement("svg",R({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s),XN.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1.775 2.781a.5.5 0 01.5.5v1.7H4.67c.108-.957.92-1.7 1.905-1.7h6.608a1.917 1.917 0 110 3.834H6.574c-.78 0-1.452-.466-1.751-1.135H2.275v5.03h2.39a2.032 2.032 0 012.023-1.854h6.38a2.031 2.031 0 110 4.063h-6.38c-.83 0-1.543-.497-1.858-1.21H1.775a.5.5 0 01-.5-.5V3.281a.5.5 0 01.5-.5zm4.799 1.5h6.608a.917.917 0 110 1.834H6.574a.917.917 0 110-1.834zm.114 5.875h6.38a1.031 1.031 0 110 2.063h-6.38a1.032 1.032 0 110-2.063z",fill:"currentColor"}))}var XN,YN,h6e=k(()=>{XN=Q(qe()),YN=u6e});function d6e(s){return KN.createElement("svg",R({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s),KN.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 10.5L4 6.654 5.2 5.5 8 8.385 10.8 5.5 12 6.654 8 10.5z",fill:"currentColor"}))}var KN,yq,f6e=k(()=>{KN=Q(qe()),yq=d6e});function p6e(s){return ZN.createElement("svg",R({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s),ZN.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.5 3c-1.072 0-1.969.904-1.969 1.969 0 1 .929 1.968 1.969 1.968h9A1.969 1.969 0 1012.5 3h-9zm9 1H5.531v1.938H12.5A.969.969 0 0012.5 4zM3.5 9.14a1.969 1.969 0 000 3.938h9a1.969 1.969 0 100-3.937h-9zm9 1H8.406v1.938H12.5a.969.969 0 100-1.937z",fill:"currentColor"}))}var ZN,vq,m6e=k(()=>{ZN=Q(qe()),vq=p6e});function g6e(s){return QN.createElement("svg",R({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s),QN.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M.166 7.994a2.26 2.26 0 114.518 0 2.26 2.26 0 01-4.518 0zM2.425 6.91a1.085 1.085 0 100 2.17 1.085 1.085 0 000-2.17zM5.74 7.994a2.26 2.26 0 114.519 0 2.26 2.26 0 01-4.519 0zM8 6.91a1.085 1.085 0 100 2.17 1.085 1.085 0 000-2.17zM13.575 5.735a2.26 2.26 0 100 4.519 2.26 2.26 0 000-4.52zm-1.086 2.26a1.085 1.085 0 112.171 0 1.085 1.085 0 01-2.17 0z",fill:"currentColor"}))}var QN,_q,y6e=k(()=>{QN=Q(qe()),_q=g6e});function v6e(s){return JN.createElement("svg",R({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s),JN.createElement("path",{d:"M8.339 4.5l-2.055.644 4.451 1.393v2.748l-2.966.928-2.504-.783V6.738l2.42.758 2.055-.644-4.458-1.395L4 5.858v4.463L7.768 11.5 12 10.175V5.646L8.339 4.5z",fill:"currentColor"}))}var JN,eD,_6e=k(()=>{JN=Q(qe()),eD=v6e});function x6e(s){return tD.createElement("svg",R({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s),tD.createElement("path",{d:"M8 1.57c-.416 0-.752.36-.752.804v.482c-1.715.372-3.006 1.994-3.006 3.938v.473c0 1.18-.407 2.32-1.14 3.205l-.173.208a.85.85 0 00-.125.864.75.75 0 00.686.475h9.019a.752.752 0 00.686-.475.845.845 0 00-.125-.864l-.174-.208a5.026 5.026 0 01-1.139-3.205v-.473c0-1.944-1.291-3.566-3.006-3.938v-.482c0-.445-.336-.804-.752-.804zm1.063 12.39c.282-.301.44-.71.44-1.138H6.496c0 .428.158.837.44 1.138.281.302.664.47 1.063.47.4 0 .783-.168 1.064-.47z",fill:"currentColor"}))}var tD,nM,b6e=k(()=>{tD=Q(qe()),nM=x6e});function S6e(s){return nD.createElement("svg",R({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s),nD.createElement("path",{d:"M6.8 11.6a.6.6 0 00.6-.6V7.4a.6.6 0 00-1.2 0V11a.6.6 0 00.6.6zm6-7.2h-2.4v-.6A1.8 1.8 0 008.6 2H7.4a1.8 1.8 0 00-1.8 1.8v.6H3.2a.6.6 0 100 1.2h.6v6.6A1.8 1.8 0 005.6 14h4.8a1.8 1.8 0 001.8-1.8V5.6h.6a.6.6 0 100-1.2zm-6-.6a.6.6 0 01.6-.6h1.2a.6.6 0 01.6.6v.6H6.8v-.6zm4.2 8.4a.6.6 0 01-.6.6H5.6a.6.6 0 01-.6-.6V5.6h6v6.6zm-1.8-.6a.6.6 0 00.6-.6V7.4a.6.6 0 00-1.2 0V11a.6.6 0 00.6.6z",fill:"currentColor"}))}var nD,rD,w6e=k(()=>{nD=Q(qe()),rD=S6e}),rb=k(()=>{h6e(),f6e(),m6e(),y6e(),_6e(),b6e(),w6e()}),hp,xq,rM,bq,Sq,wq,Eq,Tq,Mq,Cq,Aq,Pq,Rq,kq,Iq,Nq,Dq,Oq,ib,iM=k(()=>{hp=Q(qe()),Ft(),av(),Li(),rb(),rM=Te.li(xq||(xq=J([`
  margin: 0;
  padding: 0;
  list-style: none;
  display: flex;
  justify-content: flex-start;
  flex-direction: column;
  align-items: flex-start;
`]))),Sq=Te.div(bq||(bq=J([""]))),Eq=Te(Sq)(wq||(wq=J([`
  position: relative;
  margin-top: 2px;
  margin-bottom: 2px;
  margin-left: calc(4px + var(--depth) * 16px);
  padding-left: 4px;
  padding-right: 8px;
  gap: 4px;
  height: 21px;
  line-height: 0;
  box-sizing: border-box;
  display: flex;
  flex-wrap: nowrap;
  align-items: center;
  pointer-events: none;
  white-space: nowrap;

  border-radius: 2px;
  box-shadow: 0 3px 4px -1px rgba(0, 0, 0, 0.48);

  color: rgba(255, 255, 255, 0.9);
  background: rgba(40, 43, 47, 0.65);
  backdrop-filter: blur(14px);
  border-bottom: 1px solid rgba(255, 255, 255, 0.08);

  &.descendant-is-selected {
    background: rgba(29, 53, 59, 0.7);
  }

  `,`;
  &:not(.not-selectable):not(.selected):hover {
    background: rgba(59, 63, 69, 0.9);

    border-bottom: 1px solid rgba(255, 255, 255, 0.24);
  }

  &:not(.not-selectable):not(.selected):active {
    background: rgba(82, 88, 96, 0.9);
    border-bottom: 1px solid rgba(255, 255, 255, 0.24);
  }

  &.selected {
    background: rgba(30, 88, 102, 0.7);
    border-bottom: 1px solid rgba(255, 255, 255, 0.08);
  }

  @supports not (backdrop-filter: blur()) {
    background: rgba(40, 43, 47, 0.95);
  }
`])),Di),Mq=Wa(Tq||(Tq=J([`
  font-weight: 500;
  font-size: 11px;
  & {
  }
`]))),Aq=Te.span(Cq||(Cq=J([`
  `,`;

  `,`;
  position: relative;
  // Compensate for border bottom
  top: 0.5px;
  display: flex;
  height: 20px;
  align-items: center;
  box-sizing: border-box;
`])),Mq,Di),Rq=Te.div(Pq||(Pq=J([`
  font-weight: 500;
  display: flex;
  justify-content: center;
  align-items: center;
  position: relative;
  opacity: 0.99;
`]))),Iq=Te.span(kq||(kq=J([`
  font-size: 9px;
  position: relative;
  display: block;
  transition: transform 0.1s ease-out;

  &:hover {
    transform: rotate(-20deg);
  }

  `,`.collapsed & {
    transform: rotate(-90deg);

    &:hover {
      transform: rotate(-70deg);
    }
  }
`])),rM),Dq=Te.ul(Nq||(Nq=J([`
  margin: 0;
  padding: 0;
  list-style: none;

  `,`.collapsed & {
    display: none;
  }
`])),rM),Oq=({label:s,children:l,depth:u,select:m,selectionStatus:_,labelDecoration:b,collapsed:E=!1,setIsCollapsed:T})=>{let P=l!==void 0;return hp.default.createElement(rM,{style:{"--depth":u},className:E?"collapsed":""},hp.default.createElement(Eq,{className:_,onClick:m??wd,"data-header":!0},hp.default.createElement(Rq,null,P?hp.default.createElement(Iq,{onClick:N=>{N.stopPropagation(),N.preventDefault(),T==null||T(!E)}},hp.default.createElement(yq,null)):hp.default.createElement(eD,null)),hp.default.createElement(Aq,null,hp.default.createElement("span",null,s)),b),P&&hp.default.createElement(Dq,null,l))},ib=Oq});function E6e(s){return Object.keys(s)}function T6e(s){return Object.keys((0,dp.val)(s.sheetTemplatesP))}function M6e(){let s=ip(C9().filter(l=>Dt(l)||qt(l)).map(l=>qt(l)?l.sheet:l))[0];if(s)return s.getSequence()}var dp,C9,Fq,A9=k(()=>{dp=mn(),ai(),Fo(),Ae(),C9=()=>{var s;let l=(0,dp.val)(Se().projectsP),u=((s=(0,dp.val)(Se().atomP.historic.panels.outlinePanel.selection))!=null?s:[]).map(m=>{let _=l[m.projectId];if(!_)return;if(m.type==="Project")return _;if(!(0,dp.val)(_.sheetTemplatesP[m.sheetId]))return;let b=Fq(_,m.sheetId);if(!b)return;if(m.type==="Sheet")return b;let E=(0,dp.val)(b.objectsP[m.objectKey]);if(E)return E});return ip(u.filter(m=>typeof m<"u"))},Fq=(s,l)=>{let u=Se().atomP.historic.projects.stateByProjectId[s.address.projectId],m=(0,dp.val)(u.stateBySheetId[l].selectedInstanceId),_=(0,dp.val)(s.sheetTemplatesP[l]);if(_){if(m)return(0,dp.val)(_.instancesP[m]);{let b=(0,dp.val)(_.instancesP);return b[E6e(b)[0]]}}}}),Lq,Bq,C6e=k(()=>{Ae(),Lq=Q(qe()),iM(),er(),A9(),Bq=({sheetObject:s,depth:l,overrideLabel:u})=>{let m=()=>{Se().transaction(({stateEditors:b})=>{b.studio.historic.panels.outline.selection.set([s])})},_=jr(()=>C9(),[]);return Lq.default.createElement(ib,{select:m,label:u??s.address.objectKey,depth:l,selectionStatus:_.includes(s)?"selected":"not-selected"})}});function iD(s){var l;let u=s.type==="namespace"?"namespace:".concat(s.sheet.address.sheetId,":").concat(s.path.join("/")):s.type==="Theatre_Project"?"project":s.type==="Theatre_Sheet"?"sheetInstance:".concat(s.address.sheetId,":").concat(s.address.sheetInstanceId):"unknown",m=s.type==="namespace"?s.sheet.address.projectId:s.address.projectId,_=(l=Xr(Se().atomP.ahistoric.projects.stateByProjectId[m].collapsedItemsInOutline[u]))!=null?l:!1,b=(0,Uq.useCallback)(E=>{Se().transaction(({stateEditors:T})=>{T.studio.ahistoric.projects.stateByProjectId.collapsedItemsInOutline.set({projectId:m,isCollapsed:E,itemKey:u})})},[u]);return{collapsed:_,setCollapsed:b}}var Uq,sD=k(()=>{Uq=Q(qe()),Ae(),er()});function zq(s){return fp.default.createElement(fp.default.Fragment,null,[...s.namespace.entries()].map(([l,{object:u,nested:m}])=>fp.default.createElement(A6e,{key:l,label:l,object:u,nested:m,visualIndentation:s.visualIndentation,path:s.path,sheet:s.sheet})))}function A6e(s){let{nested:l,label:u,object:m,sheet:_}=s,{collapsed:b,setCollapsed:E}=iD({type:"namespace",sheet:_,path:[...s.path,u]}),T=l&&fp.default.createElement(zq,{namespace:l,path:[...s.path,u],key:"namespaceTree("+u+")",visualIndentation:s.visualIndentation+1,sheet:_}),P=m&&fp.default.createElement(Bq,{depth:s.visualIndentation,key:"objectPath("+m.address.objectKey+")",sheetObject:m,overrideLabel:u});return fp.default.createElement(fp.default.Fragment,{key:"".concat(u," - ").concat(s.visualIndentation)},P,T&&fp.default.createElement(ib,{selectionStatus:"not-selectable",label:u,key:"baseItem(".concat(u,")"),depth:s.visualIndentation,children:T,collapsed:b,setIsCollapsed:E}))}function Vq(s,l,u=P6e(l)){let[m,..._]=u,b=s.get(m);b||(b={nested:void 0,object:void 0,path:[...u]},s.set(m,b)),_.length===0?(console.assert(!b.object,"expect not to have existing object with same name",{existing:b,object:l}),b.object=l):(b.nested||(b.nested=new Map),Vq(b.nested,l,_))}function P6e(s){let l=oD.get(s);return l||(l=s.address.objectKey.split($q),console.assert(l.length>0,"expected not empty"),oD.set(s,l)),l}var Gq,fp,jq,Hq,Wq,$q,oD,R6e=k(()=>{er(),Gq=mn(),fp=Q(qe()),Ft(),C6e(),iM(),sD(),Te.li(jq||(jq=J([`
  color: `,`;
`])),s=>s.isSelected?"white":"hsl(1, 1%, 80%)"),Hq=({sheet:s,depth:l})=>jr(()=>{let u=(0,Gq.val)(s.objectsP),m=Object.values(u).filter(b=>b!=null),_=new Map;return m.forEach(b=>{Vq(_,b)}),fp.default.createElement(zq,{namespace:_,visualIndentation:l,path:[],sheet:s})},[s,l]),Wq=Hq,$q=/\s*\/\s*/g,oD=new WeakMap}),lv,qq,Xq,Yq,Kq,Zq,Qq,k6e=k(()=>{Ae(),A9(),er(),lv=Q(qe()),Ft(),R6e(),iM(),sD(),Xq=Te.div(qq||(qq=J([`
  display: flex;
`]))),Te.li(Yq||(Yq=J([`
  color: `,`;
`])),s=>s.isSelected?"white":"hsl(1, 1%, 80%)"),Zq=Te.div(Kq||(Kq=J([""]))),Qq=({sheet:s,depth:l})=>{let{collapsed:u,setCollapsed:m}=iD(s),_=(0,lv.useCallback)(()=>{Se().transaction(({stateEditors:b})=>{b.studio.historic.panels.outline.selection.set([s])})},[s]);return jr(()=>{let b=C9();return lv.default.createElement(ib,{depth:l,select:_,setIsCollapsed:m,collapsed:u,selectionStatus:b.some(E=>E===s)?"selected":b.some(E=>E.type==="Theatre_SheetObject"&&E.sheet===s)?"descendant-is-selected":"not-selected",label:lv.default.createElement(Xq,null,s.address.sheetId,": ",s.address.sheetInstanceId)},lv.default.createElement(Zq,null,lv.default.createElement(Wq,{depth:l+1,sheet:s,key:"objectList"+s.address.sheetInstanceId})))},[l,u])}}),aD,cv,Jq,eX,tX,nX,I6e=k(()=>{er(),aD=mn(),cv=Q(qe()),Ft(),k6e(),Te.div(Jq||(Jq=J([`
  display: flex;
`]))),Te.li(eX||(eX=J([`
  color: `,`;
`])),s=>s.isSelected?"white":"hsl(1, 1%, 80%)"),Te.div(tX||(tX=J([""]))),nX=({sheetId:s,depth:l,project:u})=>jr(()=>{let m=(0,aD.val)(u.sheetTemplatesP[s]);if(!m)return cv.default.createElement(cv.default.Fragment,null);let _=(0,aD.val)(m.instancesP);return cv.default.createElement(cv.default.Fragment,null,Object.entries(_).map(([b,E])=>cv.default.createElement(Qq,{key:E.address.sheetInstanceId,sheet:E,depth:l})))},[l,s,u])}),sM,rX,iX,N6e=k(()=>{A9(),er(),sM=Q(qe()),I6e(),rX=({project:s,depth:l})=>jr(()=>{if(!s)return null;let u=T6e(s);return sM.default.createElement(sM.default.Fragment,null,u.map(m=>sM.default.createElement(nX,{depth:l,sheetId:m,key:"sheet-".concat(m),project:s})))},[s,l]),iX=rX}),sb,sX,oX,aX,lX,cX,D6e=k(()=>{sb=Q(qe()),iM(),N6e(),Ae(),er(),A9(),sX=mn(),Ft(),sD(),aX=Te.div(oX||(oX=J([`
  color: #ff6363;
  margin-left: 11px;
  background: #4c282d;
  padding: 2px 8px;
  border-radius: 2px;
  font-size: 10px;
  box-shadow: 0 2px 8px -4px black;
`]))),lX=({depth:s,project:l})=>{let u=jr(()=>C9(),[]),m=jr(()=>{let T=l.address.projectId,P=(0,sX.val)(Se().atomP.ephemeral.coreByProject[T].loadingState);return(P==null?void 0:P.type)==="browserStateIsNotBasedOnDiskState"},[l]),_=(0,sb.useCallback)(()=>{Se().transaction(({stateEditors:T})=>{T.studio.historic.panels.outline.selection.set([l])})},[l]),{collapsed:b,setCollapsed:E}=iD(l);return sb.default.createElement(ib,{depth:s,label:l.address.projectId,setIsCollapsed:E,collapsed:b,labelDecoration:m?sb.default.createElement(aX,null,"Has Conflicts"):null,children:sb.default.createElement(iX,{project:l,depth:s+1}),selectionStatus:u.includes(l)?"selected":u.some(T=>T.address.projectId===l.address.projectId)?"descendant-is-selected":"not-selected",select:_})},cX=lX}),uX,lD,hX,dX,fX,pX,O6e=k(()=>{uX=mn(),er(),Ae(),lD=Q(qe()),Ft(),D6e(),dX=Te.ul(hX||(hX=J([`
  list-style: none;
  margin: 0;
  padding: 0;
  padding-right: 4px;
`]))),fX=s=>jr(()=>{let l=(0,uX.val)(Se().projectsP);return lD.default.createElement(dX,null,Object.keys(l).map(u=>{let m=l[u];return lD.default.createElement(cX,{depth:0,project:m,key:"projectListItem-".concat(u)})}))},[]),pX=fX});function mX(s){let[l,u]=(0,cD.useState)(!1);return(0,cD.useEffect)(()=>{let m=b=>{let E=l?200:50,T=56,P=s==="left"?b.x<E:b.x>window.innerWidth-E;P&&(P=b.y>T),u(!!P)};document.addEventListener("mousemove",m);let _=()=>{u(!1)};return document.addEventListener("mouseleave",_),()=>{document.removeEventListener("mousemove",m),document.removeEventListener("mouseleave",_)}},[l]),l}var cD,gX=k(()=>{cD=Q(qe())}),ob,uv,uD,yX,vX,_X,xX,oM,ab,bX,F6e=k(()=>{ob=Q(qe()),Ft(),Cm(),O6e(),er(),Ae(),gX(),uv=mn(),Li(),uD="44px",vX=Te.div(yX||(yX=J([`
  `,`;
  background-color: transparent;
  position: absolute;
  left: 8px;
  z-index: `,`;

  top: calc(`,` + 8px);
  height: fit-content;
  max-height: calc(100% - `,`);
  overflow-y: scroll;
  overflow-x: hidden;
  padding: 0;
  user-select: none;

  &::-webkit-scrollbar {
    display: none;
  }

  scrollbar-width: none;

  display: `,`;

  &:hover {
    display: block;
  }

  // Create a small buffer on the bottom to aid selecting the bottom item in a long, scrolling list
  &::after {
    content: '';
    display: block;
    height: 20px;
  }
`])),Di,ov.outlinePanel,uD,uD,({pin:s})=>s?"block":"none"),_X=()=>{var s;let l=(s=Xr(Se().atomP.ahistoric.pinOutline))!=null?s:!0,u=Xr(bX),m=mX("left");return(0,ob.useLayoutEffect)(()=>{oM.set(m)},[m]),(0,ob.useEffect)(()=>()=>{ab.set(!1),oM.set(!1)},[]),ob.default.createElement(vX,{pin:l||u,onMouseEnter:()=>{ab.set(!0)},onMouseLeave:()=>{ab.set(!1)}},ob.default.createElement(pX,null))},xX=_X,oM=new uv.Atom(!1),ab=new uv.Atom(!1),bX=(0,uv.prism)(()=>{let s=(0,uv.val)(ab.prism),l=(0,uv.val)(oM.prism);return s||l})}),SX,wX,EX,L6e=k(()=>{Ft(),wX=Te.input.attrs({type:"checkbox"})(SX||(SX=J([`
  outline: none;
`]))),EX=wX});function B6e({propConfig:s,editingTools:l,value:u,autoFocus:m}){let _=(0,hD.useCallback)(b=>{l.permanentlySetValue(!!b.target.checked)},[s,l]);return hD.default.createElement(MX,{checked:u,onChange:_,autoFocus:m})}var hD,TX,MX,CX,U6e=k(()=>{hD=Q(qe()),Ft(),L6e(),MX=Te(EX)(TX||(TX=J([`
  margin-left: 6px;

  :focus {
    outline: 1px solid #555;
  }
`]))),CX=B6e});function aM(s){return l=>{s.forEach(u=>{typeof u=="function"?u(l):u!=null&&(u.current=l)})}}var lM=k(()=>{});function dD(s,l,u){(0,AX.useEffect)(()=>{if(!s||u===!1)return;let m=Array.isArray(s)?s.filter(b=>b):[s],_=b=>{m.every(E=>!b.composedPath().includes(E))&&l(b)};return window.addEventListener("mousedown",_,{capture:!0,passive:!1}),()=>{window.removeEventListener("mousedown",_,{capture:!0,passive:!1})}},[s,u])}var AX,fD=k(()=>{AX=Q(qe())}),Am,PX,Pm,RX,kX,IX,NX,pD,DX,rh,OX,ru=k(()=>{Am=Q(qe()),Ft(),PX="pointer-root",Pm="--lockedCursor",kX=Te.div(RX||(RX=J([`
  pointer-events: auto;
  &.normal {
    pointer-events: none;
  }
`]))),NX=Te.div(IX||(IX=J([`
  position: absolute;
  inset: 0;
  pointer-events: none;

  #pointer-root:not(.normal) > & {
    pointer-events: auto;
  }
`]))),pD=(0,Am.createContext)({}),DX=s=>{var l,u,m,_;let[b,E]=(0,Am.useState)([]),T=(0,Am.useMemo)(()=>({getLock:(N,z)=>{let G={className:N,cursor:z};return E(V=>[...V,G]),()=>{E(V=>V.filter(B=>B!==G))}}}),[]),P=(u=(l=b[0])==null?void 0:l.cursor)!=null?u:"";return Am.default.createElement(pD.Provider,{value:T},Am.default.createElement(kX,{id:PX,className:((_=(m=b[0])==null?void 0:m.className)!=null?_:"normal")+" "+s.className},Am.default.createElement(NX,{style:{cursor:P,[Pm]:P}},s.children)))},rh=(s,l,u)=>{let m=(0,Am.useContext)(pD);(0,Am.useLayoutEffect)(()=>{if(s)return m.getLock(l,u)},[s,l,u])},OX=DX});function FX(s){return lb.default.createElement(mD.Provider,{value:s.logger},s.children)}function P9(s,l){let u=(0,lb.useContext)(mD);return(0,lb.useMemo)(()=>s?u.named(s,l):u,[u,s,l])}var lb,mD,R9=k(()=>{lb=Q(qe()),mD=lb.default.createContext(null)});function z6e(){let s=P9("PointerCapturing"),l=Ed.default.useRef(null),u=()=>l.current!=null;return m=>{let _,b=E=>(_=E,l.current=E,E);return{capturing:{capturePointer(E){if(s._debug("Capturing pointer",{forDebugName:m,reason:E}),l.current!=null)throw new Error('"'.concat(m,'" attempted capturing pointer for "').concat(E,'" while already captured by "').concat(l.current.debugOwnerName,'" for "').concat(l.current.debugReason,'"'));let T=b({debugOwnerName:m,debugReason:E});return{isCapturing(){return T===l.current},release(){return T===l.current?(s._debug("Releasing pointer",{forDebugName:m,reason:E}),b(null),!0):!1}}},isPointerBeingCaptured:u},forceRelease(){_&&l.current===_&&(s._debug("Force releasing pointer",{localCapture:_}),b(null))}}}}function V6e(s){let l=z6e();return Ed.default.createElement(gD.Provider,{value:l},Ed.default.createElement(BX,{children:s.children}))}function LX(s){let l=(0,Ed.useContext)(gD),u=(0,Ed.useMemo)(()=>l(s),[s,l]);return(0,Ed.useEffect)(()=>()=>{u.forceRelease()},[u]),u.capturing}var Ed,gD,BX,yD=k(()=>{Ed=Q(qe()),R9(),gD=Ed.default.createContext(null),BX=Ed.default.memo(({children:s})=>Ed.default.createElement(Ed.default.Fragment,null,s))}),vD,G6e=k(()=>{vD=typeof window<"u"&&/^((?!chrome|android).)*safari/i.test(navigator.userAgent)});function uo(s,l){let u=(0,hv.useRef)(l);u.current=l;let m=l.shouldPointerLock&&!vD,_=(0,hv.useRef)({domDragStarted:!1}),{capturePointer:b}=LX("useDrag for ".concat(l.debugName)),E=(0,hv.useRef)({onDrag:wd,onDragEnd:wd,onClick:wd}),T=(0,hv.useRef)(),[P,N]=Ai(!1);return(0,hv.useLayoutEffect)(()=>{if(!s)return;let z=()=>{let te=_.current.domDragStarted&&_.current.detection.detected;P.current!==te&&(P.current=te)},G=te=>{if(!_.current.domDragStarted)return;let se=_.current;if(!j6e(te,se)&&(se.detection.detected||(se.detection.totalDistanceMoved+=Math.abs(te.movementY)+Math.abs(te.movementX),se.detection.totalDistanceMoved>UX&&(m&&s.requestPointerLock(),se.detection={detected:!0,dragMovement:{x:0,y:0},dragEventCount:0},z())),se.detection.detected)){se.detection.dragEventCount+=1;let{dragMovement:pe}=se.detection;if(m)pe.x+=te.movementX,pe.y+=te.movementY;else{let{startPos:fe}=se;pe.x=te.screenX-fe.x,pe.y=te.screenY-fe.y}E.current.onDrag(pe.x,pe.y,te,te.movementX,te.movementY)}},V=te=>{if(H(),!_.current.domDragStarted)return;let se=_.current.detection.detected;_.current={domDragStarted:!1},l.shouldPointerLock&&!vD&&document.exitPointerLock(),E.current.onDragEnd(se),window.focus(),se||E.current.onClick(te),z()},B=()=>{document.addEventListener("mousemove",G),document.addEventListener("mouseup",V)},H=()=>{var te;(te=T.current)==null||te.release(),document.removeEventListener("mousemove",G),document.removeEventListener("mouseup",V)},j=te=>{u.current.disabled||_.current.domDragStarted&&_.current.detection.detected&&(u.current.dontBlockMouseDown||(te.stopPropagation(),te.preventDefault()),_.current.detection={detected:!1,totalDistanceMoved:0},z())},X=te=>{var se,pe,fe,ve;(se=T.current)==null||se.release();let Ne=u.current;if(Ne.disabled===!0||!((pe=Ne.buttons)!=null?pe:[0]).includes(te.button))return;let ze=Ne.onDragStart(te);ze!==!1&&(E.current.onDrag=ze.onDrag,E.current.onDragEnd=(fe=ze.onDragEnd)!=null?fe:wd,E.current.onClick=(ve=ze.onClick)!=null?ve:wd,T.current=b("Drag start"),Ne.dontBlockMouseDown||(te.stopPropagation(),te.preventDefault()),_.current={domDragStarted:!0,startPos:{x:te.screenX,y:te.screenY},detection:{detected:!1,totalDistanceMoved:0}},z(),B())},K=te=>{X(te)};return s.addEventListener("mousedown",K),s.addEventListener("click",j),()=>{var te,se;H(),s.removeEventListener("mousedown",K),s.removeEventListener("click",j),_.current.domDragStarted&&((se=(te=E.current).onDragEnd)==null||se.call(te,_.current.detection.detected)),_.current={domDragStarted:!1},z()}},[s]),rh(N&&!!l.lockCSSCursorTo,"dragging",l.lockCSSCursorTo),[N]}function j6e(s,l){return(!l.detection.detected||l.detection.detected&&l.detection.dragEventCount<3)&&(Math.abs(s.movementX)>_D||Math.abs(s.movementY)>_D)}var hv,UX,_D,Yo=k(()=>{hv=Q(qe()),ru(),yD(),av(),G6e(),Fi(),UX=3,_D=100});function H6e(s){return isNaN(s)?"NaN":Py(s)?s.toFixed(0):Ny(s,3).toString()}var zX,VX,Rm,GX,cM,jX,HX,WX,$X,qX,XX,YX,KX,uM,xD=k(()=>{Fo(),zX=Q(qe()),VX=Q(qe()),Rm=Q(qe()),Ft(),lM(),Fi(),fD(),Yo(),cM=Te.div(GX||(GX=J([`
  height: 100%;
  width: 100%;
  position: relative;
  z-index: 0;
  box-sizing: border-box;
  display: flex;
  align-items: center;

  &:after {
    position: absolute;
    inset: 1px 0 2px;
    display: block;
    content: ' ';
    background-color: transparent;
    border: 1px solid transparent;
    z-index: -2;
    box-sizing: border-box;
    border-radius: 1px;
  }

  &:hover,
  &.dragging,
  &.editingViaKeyboard {
    &:after {
      background-color: #10101042;
      border-color: #00000059;
    }
  }
`]))),HX=Te.input(jX||(jX=J([`
  background: transparent;
  border: 1px solid transparent;
  color: rgba(255, 255, 255, 0.9);
  padding: 1px 6px;
  font: inherit;
  outline: none;
  cursor: ew-resize;
  text-align: left;
  width: 100%;
  height: calc(100% - 4px);
  border-radius: 2px;

  &:focus {
    cursor: text;
  }
`]))),$X=Te.div(WX||(WX=J([`
  position: absolute;
  inset: 3px 2px 4px;
  transform: scale(var(--percentage), 1);
  transform-origin: top left;
  background-color: #2d5561;
  z-index: -1;
  border-radius: 2px;
  pointer-events: none;

  `,".dragging &, ",`.noFocus:hover & {
    background-color: #338198;
  }
`])),cM,cM),XX=Te.div(qX||(qX=J([`
  display: contents;
`]))),YX=s=>!0,KX=s=>{var l;let[u]=Ai({mode:"noFocus"}),m=(l=s.isValid)!=null?l:YX,_=(0,Rm.useRef)(s);_.current=s;let b=(0,Rm.useRef)(null);dD(b.current,()=>{b.current.blur()},u.current.mode==="editingViaKeyboard");let E=(0,Rm.useRef)(null),T=(0,Rm.useMemo)(()=>{let X=ze=>{let Me=ze.target,{value:He}=Me,vt=u.current;u.current=$(R({},vt),{currentEditedValueInString:He});let xe=parseFloat(He);!isFinite(xe)||!m(xe)||_.current.temporarilySetValue(xe)},K=()=>{u.current.mode==="editingViaKeyboard"&&(te(),u.current={mode:"noFocus"}),s.onBlur&&s.onBlur()},te=()=>{let ze=u.current,Me=parseFloat(ze.currentEditedValueInString);!isFinite(Me)||!m(Me)||ze.valueBeforeEditing===Me?_.current.discardTemporaryValue():_.current.permanentlySetValue(Me)},se=ze=>{ze.key==="Escape"?(_.current.discardTemporaryValue(),u.current={mode:"noFocus"},b.current.blur()):(ze.key==="Enter"||ze.key==="Tab")&&(te(),b.current.blur())},pe=ze=>{u.current.mode==="noFocus"&&(b.current.focus(),ze.preventDefault()),ze.stopPropagation()},fe=()=>{u.current.mode==="noFocus"?ve():u.current.mode},ve=()=>{let ze=_.current.value;u.current={mode:"editingViaKeyboard",currentEditedValueInString:String(ze),valueBeforeEditing:ze},setTimeout(()=>{b.current.focus(),b.current.setSelectionRange(0,100)})},Ne;return{inputChange:X,onBlur:K,transitionToDraggingMode:()=>{var ze;let Me=_.current.value;Ne=(ze=b.current)==null?void 0:ze.getBoundingClientRect().width,u.current={mode:"dragging"};let He=Me,vt=Me;return E.current=document.body.style.cursor,{onDrag(xe,We,oe,nt){let dn=oe.altKey?nt/10:nt,Ve=vt+s.nudge({deltaX:dn,deltaFraction:dn/Ne,magnitude:1});vt=s.range?ii(Ve,s.range[0],s.range[1]):Ve,_.current.temporarilySetValue(vt)},onDragEnd(xe){xe?(He===vt?_.current.discardTemporaryValue():_.current.permanentlySetValue(vt),u.current={mode:"noFocus"}):(_.current.discardTemporaryValue(),u.current={mode:"noFocus"})},onClick(){b.current.focus(),b.current.setSelectionRange(0,100)}}},onInputKeyDown:se,onClick:pe,onFocus:fe}},[]);(0,zX.useEffect)(()=>()=>{T.onBlur()},[]);let P=u.current.mode!=="editingViaKeyboard"?H6e(s.value):u.current.currentEditedValueInString;typeof P=="number"&&isNaN(P)&&(P="NaN");let N=[b];s.inputRef&&N.push(s.inputRef);let z=Rm.default.createElement(HX,{key:"input",type:"text",onChange:T.inputChange,value:P,onBlur:T.onBlur,onKeyDown:T.onInputKeyDown,onClick:T.onClick,onFocus:T.onFocus,ref:aM(N),onMouseDown:X=>{X.stopPropagation()},onDoubleClick:X=>{X.preventDefault(),X.stopPropagation()},autoFocus:s.autoFocus}),{range:G}=s,V=parseFloat(P),B=G?Rm.default.createElement($X,{style:{"--percentage":ii((V-G[0])/(G[1]-G[0]),0,1)}}):null,[H,j]=(0,VX.useState)(null);return uo(H,{debugName:"form/BasicNumberInput",onDragStart:T.transitionToDraggingMode,lockCSSCursorTo:"ew-resize",shouldPointerLock:!0,disabled:u.current.mode==="editingViaKeyboard"}),Rm.default.createElement(cM,{className:s.className+" "+u.current.mode},Rm.default.createElement(XX,{ref:j},z),B)},uM=KX});function W6e({propConfig:s,editingTools:l,value:u,autoFocus:m}){let _=(0,bD.useCallback)(b=>s.nudgeFn($(R({},b),{config:s})),[s]);return bD.default.createElement(uM,{value:u,temporarilySetValue:l.temporarilySetValue,discardTemporaryValue:l.discardTemporaryValue,permanentlySetValue:l.permanentlySetValue,range:s.range,nudge:_,autoFocus:m})}var bD,SD,ZX=k(()=>{xD(),bD=Q(qe()),SD=W6e});function $6e({value:s,onChange:l,options:u,autoFocus:m}){let _=(0,cb.useCallback)(b=>{l(String(b.target.value))},[l]);return cb.default.createElement(wD,{role:"radiogroup"},Object.keys(u).map((b,E)=>cb.default.createElement(eY,{key:"label-"+E,"data-checked":s===b},u[b],cb.default.createElement(nY,{type:"radio",checked:s===b,value:b,onChange:_,name:"switchbox",autoFocus:m}))))}var cb,QX,wD,JX,eY,tY,nY,rY,q6e=k(()=>{nu(),cb=Q(qe()),Ft(),wD=Te.form(QX||(QX=J([`
  display: flex;
  flex-direction: row;
  align-items: stretch;
  vertical-align: middle;
  justify-content: stretch;
  height: 24px;
  width: 100%;
`]))),eY=Te.label(JX||(JX=J([`
  padding: 0 0.5em;
  background: transparent;
  /* background: #373748; */
  display: flex;
  align-items: center;
  justify-content: center;
  flex-grow: 1;
  color: #a7a7a7;
  border: 1px solid transparent;
  box-sizing: border-box;
  border-right-width: 0px;

  & + &:last-child {
    border-right-width: 1px;
  }

  `,`:hover > & {
    border-color: #1c2123;
    /* background-color: #373748; */
    /* color: `,`; */
  }

  &&:hover {
    background-color: #464654;
  }

  &&[data-checked='true'] {
    color: white;
    background: #3f3f4c;
  }
`])),wD,Yx(.1,"white")),nY=Te.input(tY||(tY=J([`
  position: absolute;
  opacity: 0;
  pointer-events: none;
  width: 0;
  height: 0;
`]))),rY=$6e}),X6e=k(()=>{}),ED,TD,MD,iY=k(()=>{ED=Q(qe()),TD={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},MD=ED.default.createContext&&ED.default.createContext(TD)});function sY(s){return s&&s.map(function(l,u){return fv.default.createElement(l.tag,km({key:u},l.attr),sY(l.child))})}function dv(s){return function(l){return fv.default.createElement(Y6e,km({attr:km({},s.attr)},l),sY(s.child))}}function Y6e(s){var l=function(u){var m=s.attr,_=s.size,b=s.title,E=oY(s,["attr","size","title"]),T=_||u.size||"1em",P;return u.className&&(P=u.className),s.className&&(P=(P?P+" ":"")+s.className),fv.default.createElement("svg",km({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},u.attr,m,E,{className:P,style:km(km({color:s.color||u.color},u.style),s.style),height:T,width:T,xmlns:"http://www.w3.org/2000/svg"}),b&&fv.default.createElement("title",null,b),s.children)};return MD!==void 0?fv.default.createElement(MD.Consumer,null,function(u){return l(u)}):l(TD)}var fv,km,oY,K6e=k(()=>{fv=Q(qe()),iY(),km=function(){return km=Object.assign||function(s){for(var l,u=1,m=arguments.length;u<m;u++){l=arguments[u];for(var _ in l)Object.prototype.hasOwnProperty.call(l,_)&&(s[_]=l[_])}return s},km.apply(this,arguments)},oY=function(s,l){var u={};for(var m in s)Object.prototype.hasOwnProperty.call(s,m)&&l.indexOf(m)<0&&(u[m]=s[m]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var _=0,m=Object.getOwnPropertySymbols(s);_<m.length;_++)l.indexOf(m[_])<0&&Object.prototype.propertyIsEnumerable.call(s,m[_])&&(u[m[_]]=s[m[_]]);return u}}),Lo=k(()=>{X6e(),K6e(),iY()}),Z6e=k(()=>{Lo()}),Q6e=k(()=>{Lo()});function J6e(s){return dv({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"}}]})(s)}var eye=k(()=>{Lo()}),tye=k(()=>{Lo()}),nye=k(()=>{Lo()});function rye(s){return dv({attr:{viewBox:"0 0 8 16"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M5.5 3L7 4.5 3.25 8 7 11.5 5.5 13l-5-5 5-5z"}}]})(s)}function iye(s){return dv({attr:{viewBox:"0 0 8 16"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M7.5 8l-5 5L1 11.5 4.75 8 1 4.5 2.5 3l5 5z"}}]})(s)}var sye=k(()=>{Lo()}),oye=k(()=>{Lo()}),aye=k(()=>{Lo()}),lye=k(()=>{Lo()}),cye=k(()=>{Lo()}),uye=k(()=>{Lo()}),hye=k(()=>{Lo()}),dye=k(()=>{Lo()}),fye=k(()=>{Lo()}),pye=k(()=>{Lo()});function aY(s){return dv({attr:{fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"}}]})(s)}var mye=k(()=>{Lo()}),gye=k(()=>{Lo()}),yye=k(()=>{Lo()}),vye=k(()=>{Lo()});function _ye(s){return dv({attr:{viewBox:"0 0 24 24",fill:"none"},child:[{tag:"path",attr:{d:"M6 9.65685L7.41421 11.0711L11.6569 6.82843L15.8995 11.0711L17.3137 9.65685L11.6569 4L6 9.65685Z",fill:"currentColor"}},{tag:"path",attr:{d:"M6 14.4433L7.41421 13.0291L11.6569 17.2717L15.8995 13.0291L17.3137 14.4433L11.6569 20.1001L6 14.4433Z",fill:"currentColor"}}]})(s)}var xye=k(()=>{Lo()});function bye(s){return dv({attr:{viewBox:"0 0 16 16",fill:"currentColor"},child:[{tag:"path",attr:{d:"M14 10.44l-.413.56H2.393L2 10.46 7.627 5h.827L14 10.44z"}}]})(s)}var Sye=k(()=>{Lo()}),pv=k(()=>{Z6e(),Q6e(),eye(),tye(),nye(),sye(),oye(),aye(),lye(),cye(),uye(),hye(),dye(),fye(),pye(),mye(),gye(),yye(),vye(),xye(),Sye()});function wye({value:s,onChange:l,options:u,className:m,autoFocus:_}){let b=(0,F5.useCallback)(E=>{l(String(E.target.value))},[l]);return F5.default.createElement(cY,null,F5.default.createElement(fY,{className:m,value:s,onChange:b,autoFocus:_},Object.keys(u).map((E,T)=>F5.default.createElement("option",{key:"option-"+T,value:E},u[E]))),F5.default.createElement(hY,null,F5.default.createElement(_ye,null)))}var F5,lY,cY,uY,hY,dY,fY,pY,Eye=k(()=>{F5=Q(qe()),Ft(),pv(),cY=Te.div(lY||(lY=J([`
  width: 100%;
  position: relative;
`]))),hY=Te.div(uY||(uY=J([`
  position: absolute;
  right: 0px;
  top: 0;
  bottom: 0;
  width: 1.5em;
  font-size: 14px;
  display: flex;
  align-items: center;
  color: #6b7280;
  pointer-events: none;
`]))),fY=Te.select(dY||(dY=J([`
  appearance: none;
  background-color: transparent;
  box-sizing: border-box;
  border: 1px solid transparent;
  color: rgba(255, 255, 255, 0.85);
  padding: 1px 6px;
  font: inherit;
  outline: none;
  text-align: left;
  width: 100%;
  border-radius: 2px;
  /*
  looks like putting percentages in the height of a select box doesn't work in Firefox. Not sure why.
  So we're hard-coding the height to 26px, unlike all other inputs that use a relative height.
  */
  height: 26px /* calc(100% - 4px); */;

  @supports (-moz-appearance: none) {
    /* Ugly hack to remove the extra left padding that shows up only in Firefox */
    text-indent: -2px;
  }

  &:hover,
  &:focus {
    background-color: #10101042;
    border-color: #00000059;
  }
`]))),pY=wye});function Tye({propConfig:s,editingTools:l,value:u,autoFocus:m}){let _=(0,hM.useCallback)(b=>{l.permanentlySetValue(b)},[s,l]);return s.as==="menu"?hM.default.createElement(pY,{value:u,onChange:_,options:s.valuesAndLabels,autoFocus:m}):hM.default.createElement(rY,{value:u,onChange:_,options:s.valuesAndLabels,autoFocus:m})}var hM,mY,Mye=k(()=>{hM=Q(qe()),q6e(),Eye(),mY=Tye}),gY,ub,yY,vY,_Y,xY,dM,CD=k(()=>{Ft(),gY=Q(qe()),ub=Q(qe()),lM(),Fi(),fD(),vY=Te.input.attrs({type:"text"})(yY||(yY=J([`
  background: transparent;
  border: 1px solid transparent;
  color: rgba(255, 255, 255, 0.9);
  padding: 1px 6px;
  font: inherit;
  outline: none;
  cursor: text;
  text-align: left;
  width: 100%;
  height: calc(100% - 4px);
  border-radius: 2px;
  border: 1px solid transparent;
  box-sizing: border-box;

  &:hover {
    background-color: #10101042;
    border-color: #00000059;
  }

  &:hover,
  &:focus {
    cursor: text;
    background-color: #10101042;
    border-color: #00000059;
  }

  &.invalid {
    border-color: red;
  }
`]))),_Y=s=>!0,xY=s=>{var l,u;let[m]=Ai({mode:"noFocus"}),_=(l=s.isValid)!=null?l:_Y,b=(0,ub.useRef)(s);b.current=s;let E=(0,ub.useRef)(null);dD(E.current,()=>{E.current.blur()},m.current.mode==="editingViaKeyboard");let T=(0,ub.useMemo)(()=>{let z=K=>{let te=K.target,{value:se}=te,pe=m.current;m.current=$(R({},pe),{currentEditedValueInString:se}),_(se)&&b.current.temporarilySetValue(se)},G=()=>{var K,te;m.current.mode==="editingViaKeyboard"&&(V(),m.current={mode:"noFocus"}),(te=(K=b.current).onBlur)==null||te.call(K)},V=()=>{let K=m.current,te=K.currentEditedValueInString;_(te)?K.valueBeforeEditing===te?b.current.discardTemporaryValue():b.current.permanentlySetValue(te):b.current.discardTemporaryValue()},B=K=>{K.key==="Escape"?(b.current.discardTemporaryValue(),m.current={mode:"noFocus"},E.current.blur()):(K.key==="Enter"||K.key==="Tab")&&(V(),E.current.blur())},H=K=>{m.current.mode==="noFocus"&&(E.current.focus(),K.preventDefault()),K.stopPropagation()},j=()=>{m.current.mode==="noFocus"?X():m.current.mode},X=()=>{let K=b.current.value;m.current={mode:"editingViaKeyboard",currentEditedValueInString:String(K),valueBeforeEditing:K},setTimeout(()=>{E.current.focus()})};return{inputChange:z,onBlur:G,onInputKeyDown:B,onClick:H,onFocus:j}},[]);(0,gY.useEffect)(()=>()=>{T.onBlur()},[]);let P=m.current.mode!=="editingViaKeyboard"?s.value:m.current.currentEditedValueInString,N=[E];return s.inputRef&&N.push(s.inputRef),ub.default.createElement(vY,{key:"input",type:"text",className:"".concat((u=s.className)!=null?u:""," ").concat(_(P)?"":"invalid"),onChange:T.inputChange,value:P,onBlur:T.onBlur,onKeyDown:T.onInputKeyDown,onClick:T.onClick,onFocus:T.onFocus,ref:aM(N),onMouseDown:z=>{z.stopPropagation()},onDoubleClick:z=>{z.preventDefault(),z.stopPropagation()},autoFocus:s.autoFocus})},dM=xY});function Cye({editingTools:s,value:l,autoFocus:u}){return bY.default.createElement(dM,{value:l,temporarilySetValue:s.temporarilySetValue,discardTemporaryValue:s.discardTemporaryValue,permanentlySetValue:s.permanentlySetValue,autoFocus:u})}var bY,SY,Aye=k(()=>{bY=Q(qe()),CD(),SY=Cye});function Pye(s){s=s.trim().toLowerCase();let l=s.match(RD);if(!l)return{r:0,g:0,b:0,a:1};let u=Rye(l[1]);return{r:parseInt(u.substr(0,2),16)/255,g:parseInt(u.substr(2,2),16)/255,b:parseInt(u.substr(4,2),16)/255,a:parseInt(u.substr(6,2),16)/255}}function AD(s,{removeAlphaIfOpaque:l=!1}={}){let u=(s.a*255|256).toString(16).slice(1),m=(s.r*255|256).toString(16).slice(1)+(s.g*255|256).toString(16).slice(1)+(s.b*255|256).toString(16).slice(1)+(l&&u==="ff"?"":u);return"#".concat(m)}function PD(s){return $(R({},s),{toString(){return AD(this,{removeAlphaIfOpaque:!0})}})}function Rye(s){switch(s.length){case 3:return"".concat(s.repeat(2),"ff");case 4:let l=s.substr(0,3),u=s[3];return"".concat(l.repeat(2)).concat(u.repeat(2));case 6:return"".concat(s,"ff")}return s}var RD,wY=k(()=>{RD=/^#*([0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/i});function fM(s){let l=(0,kD.useRef)(s),u=(0,kD.useRef)(m=>{l.current&&l.current(m)});return l.current=s,u.current}var kD,EY=k(()=>{kD=Q(qe())}),L5,pM=k(()=>{L5=(s,l=0,u=1)=>s>u?u:s<l?l:s}),hb,ID,TY,ND,DD=k(()=>{hb=Q(qe()),ID=(0,hb.createContext)(void 0),TY=({children:s})=>{let[l,u]=(0,hb.useState)(!1);return hb.default.createElement(ID.Provider,{value:{editing:l,setEditing:u}},s)},ND=()=>(0,hb.useContext)(ID)}),k9,mv,MY,mM,OD,FD,CY,AY,PY,RY,db,gM=k(()=>{k9=Q(qe()),EY(),pM(),Ft(),DD(),mv=s=>"touches"in s,MY=(s,l)=>{for(let u=0;u<s.length;u++)if(s[u].identifier===l)return s[u];return s[0]},mM=s=>s&&s.ownerDocument.defaultView||self,OD=(s,l,u)=>{let m=s.getBoundingClientRect(),_=mv(l)?MY(l.touches,u):l;return{left:L5((_.pageX-(m.left+mM(s).pageXOffset))/m.width),top:L5((_.pageY-(m.top+mM(s).pageYOffset))/m.height)}},FD=s=>{!mv(s)&&s.preventDefault()},CY=(s,l)=>l&&!mv(s),PY=Te.div(AY||(AY=J([`
  position: absolute;
  left: 0;
  top: 0;
  right: 0;
  bottom: 0;
  border-radius: inherit;
  outline: none;
  /* Don't trigger the default scrolling behavior when the event is originating from this element */
  touch-action: none;
`]))),RY=s=>{var l=s,{onMove:u,onKey:m}=l,_=Z(l,["onMove","onKey"]);let b=(0,k9.useRef)(null),E=fM(u),T=fM(m),P=(0,k9.useRef)(null),N=(0,k9.useRef)(!1),{setEditing:z}=ND(),[G,V,B]=(0,k9.useMemo)(()=>{let H=({nativeEvent:se})=>{let pe=b.current;if(pe&&(FD(se),!(CY(se,N.current)||!pe))){if(mv(se)){N.current=!0;let fe=se.changedTouches||[];fe.length&&(P.current=fe[0].identifier)}pe.focus(),z(!0),E(OD(pe,se,P.current)),te(!0)}},j=se=>{FD(se),(mv(se)?se.touches.length>0:se.buttons>0)&&b.current?E(OD(b.current,se,P.current)):(z(!1),te(!1))},X=se=>{z(!1),te(!1)},K=se=>{let pe=se.which||se.keyCode;pe<37||pe>40||(se.preventDefault(),T({left:pe===39?.05:pe===37?-.05:0,top:pe===40?.05:pe===38?-.05:0}))};function te(se){let pe=N.current,fe=b.current,ve=mM(fe),Ne=se?ve.addEventListener:ve.removeEventListener;Ne(pe?"touchmove":"mousemove",j),Ne(pe?"touchend":"mouseup",X)}return[H,K,te]},[T,E]);return(0,k9.useEffect)(()=>B,[B]),k9.default.createElement(PY,$(R({},_),{onTouchStart:G,onMouseDown:G,ref:b,onKeyDown:V,tabIndex:0,role:"slider"}))},db=k9.default.memo(RY)}),LD,kY,IY,NY,DY,OY,FY,yM,BD=k(()=>{LD=Q(qe()),Ft(),gM(),IY=Te(db)(kY||(kY=J([""]))),DY=Te.div(NY||(NY=J([`
  position: absolute;
  z-index: 1;
  box-sizing: border-box;
  width: 16px;
  height: 16px;
  transform: translate(-50%, -50%);
  background-color: #fff;
  border: 1px solid #ffffff00;
  border-radius: 2px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);

  `,`:focus & {
    transform: translate(-50%, -50%) scale(1.1);
  }
`])),IY),FY=Te.div(OY||(OY=J([`
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  right: 0;
  bottom: 0;
  pointer-events: none;
  border-radius: inherit;
`]))),yM=({className:s,color:l,left:u,top:m=.5})=>{let _={top:"".concat(m*100,"%"),left:"".concat(u*100,"%")};return LD.default.createElement(DY,{style:_,className:s},LD.default.createElement(FY,{style:{backgroundColor:l}}))}}),T0,vM=k(()=>{T0=(s,l=0,u=Math.pow(10,l))=>Math.round(u*s)/u}),UD,_M,xM,LY,BY,bM=k(()=>{vM(),UD=({h:s,s:l,v:u,a:m})=>{let _=(200-l)*u/100;return{h:T0(s),s:T0(_>0&&_<200?l*u/100/(_<=100?_:200-_)*100:0),l:T0(_/2),a:T0(m,2)}},_M=s=>{let{h:l,s:u,l:m}=UD(s);return"hsl(".concat(l,", ").concat(u,"%, ").concat(m,"%)")},xM=s=>{let{h:l,s:u,l:m,a:_}=UD(s);return"hsla(".concat(l,", ").concat(u,"%, ").concat(m,"%, ").concat(_,")")},LY=({h:s,s:l,v:u,a:m})=>{s=s/360*6,l=l/100,u=u/100;let _=Math.floor(s),b=u*(1-l),E=u*(1-(s-_)*l),T=u*(1-(1-s+_)*l),P=_%6;return{r:T0([u,E,b,b,T,u][P]*255),g:T0([T,u,u,E,b,b][P]*255),b:T0([b,b,T,u,u,E][P]*255),a:T0(m,2)}},BY=({r:s,g:l,b:u,a:m})=>{let _=Math.max(s,l,u),b=_-Math.min(s,l,u),E=b?_===s?(l-u)/b:_===l?2+(u-s)/b:4+(s-l)/b:0;return{h:T0(60*(E<0?E+6:E)),s:T0(_?b/_*100:0),v:T0(_/255*100),a:m}}}),fb,UY,zY,VY,GY,jY,HY,kye=k(()=>{fb=Q(qe()),gM(),BD(),bM(),pM(),vM(),Ft(),zY=Te.div(UY||(UY=J([`
  position: relative;
  height: 16px;
  border-radius: 2px;

  background: linear-gradient(
    to right,
    #f00 0%,
    #ff0 17%,
    #0f0 33%,
    #0ff 50%,
    #00f 67%,
    #f0f 83%,
    #f00 100%
  );
`]))),GY=Te(yM)(VY||(VY=J([`
  z-index: 2;
`]))),jY=({className:s,hue:l,onChange:u})=>fb.default.createElement(zY,{className:s},fb.default.createElement(db,{onMove:m=>{u({h:360*m.left})},onKey:m=>{u({h:L5(l+m.left*360,0,360)})},"aria-label":"Hue","aria-valuetext":T0(l)},fb.default.createElement(GY,{left:l/360,color:_M({h:l,s:100,v:100,a:1})}))),HY=fb.default.memo(jY)}),pb,WY,$Y,qY,XY,YY,KY,Iye=k(()=>{pb=Q(qe()),gM(),BD(),bM(),pM(),vM(),Ft(),$Y=Te.div(WY||(WY=J([`
  position: relative;
  flex-grow: 1;
  border-color: transparent; /* Fixes https://github.com/omgovich/react-colorful/issues/139 */
  border-bottom: 12px solid #000;
  border-radius: 2px;
  background-image: linear-gradient(to top, #000, rgba(0, 0, 0, 0)),
    linear-gradient(to right, #fff, rgba(255, 255, 255, 0));

  // Improve elements rendering on light backgrounds
  box-shadow: inset 0 0 0 1px rgba(0, 0, 0, 0.05);
`]))),XY=Te(yM)(qY||(qY=J([`
  z-index: 3;
`]))),YY=({hsva:s,onChange:l})=>{let u=b=>{l({s:b.left*100,v:100-b.top*100})},m=b=>{l({s:L5(s.s+b.left*100,0,100),v:L5(s.v-b.top*100,0,100)})},_={backgroundColor:_M({h:s.h,s:100,v:100,a:1})};return pb.default.createElement($Y,{style:_},pb.default.createElement(db,{onMove:u,onKey:m,"aria-label":"Color","aria-valuetext":"Saturation ".concat(T0(s.s),"%, Brightness ").concat(T0(s.v),"%")},pb.default.createElement(XY,{top:1-s.v/100,left:s.s/100,color:_M(s)})))},KY=pb.default.memo(YY)}),mb,ZY,QY,JY,eK,tK,nK,rK,Nye=k(()=>{mb=Q(qe()),gM(),BD(),bM(),pM(),vM(),Ft(),QY=Te.div(ZY||(ZY=J([`
  position: relative;
  height: 16px;
  border-radius: 2px;
  // Checkerboard
  background-color: #fff;
  background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><rect x="8" width="8" height="8"/><rect y="8" width="8" height="8"/></svg>');
`]))),eK=Te.div.attrs(({colorFrom:s,colorTo:l})=>({style:{backgroundImage:"linear-gradient(90deg, ".concat(s,", ").concat(l,")")}}))(JY||(JY=J([`
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  right: 0;
  bottom: 0;
  pointer-events: none;
  border-radius: inherit;

  // Improve rendering on light backgrounds
  box-shadow: inset 0 0 0 1px rgba(0, 0, 0, 0.05);
`]))),nK=Te(yM)(tK||(tK=J([`
  // Checkerboard
  background-color: #fff;
  background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><rect x="8" width="8" height="8"/><rect y="8" width="8" height="8"/></svg>');
`]))),rK=({className:s,hsva:l,onChange:u})=>{let m=T=>{u({a:T.left})},_=T=>{u({a:L5(l.a+T.left)})},b=xM(Object.assign({},l,{a:0})),E=xM(Object.assign({},l,{a:1}));return mb.default.createElement(QY,{className:s},mb.default.createElement(eK,{colorFrom:b,colorTo:E}),mb.default.createElement(db,{onMove:m,onKey:_,"aria-label":"Alpha","aria-valuetext":"".concat(T0(l.a*100),"%")},mb.default.createElement(nK,{left:l.a,color:xM(l)})))}}),SM,iK=k(()=>{SM=(s,l)=>{if(s===l)return!0;for(let u in s)if(s[u]!==l[u])return!1;return!0}});function Dye(s,l,u,m){let{editing:_}=ND(),[b,E]=(0,Im.useState)(l),T=fM(u),P=fM(m),N=_?b:l,[z,G]=(0,Im.useState)(()=>s.toHsva(N)),V=(0,Im.useRef)({color:N,hsva:z}),B=(0,Im.useRef)({color:N,hsva:z});(0,Im.useEffect)(()=>{_&&E(V.current.color)},[_]),(0,Im.useEffect)(()=>{let j=s.fromHsva(z);_?!SM(z,V.current.hsva)&&!s.equal(j,V.current.color)&&(V.current={hsva:z,color:j},E(j),T(j)):!SM(z,B.current.hsva)&&!s.equal(j,B.current.color)&&(B.current={hsva:z,color:j},V.current={hsva:z,color:j},P(j))},[_,z,s,T,P]),(0,Im.useEffect)(()=>{if(!_&&!s.equal(N,B.current.color)){let j=s.toHsva(N);B.current={hsva:j,color:N},G(j)}},[_,N,s]);let H=(0,Im.useCallback)(j=>{G(X=>Object.assign({},X,j))},[]);return[z,H]}var Im,Oye=k(()=>{Im=Q(qe()),iK(),EY(),DD()}),gv,sK,oK,aK,Fye=k(()=>{gv=Q(qe()),kye(),Iye(),Nye(),Oye(),Ft(),oK=Te.div(sK||(sK=J([`
  position: relative;
  display: flex;
  gap: 4px;
  flex-direction: column;
  width: 200px;
  height: 200px;
  user-select: none;
  cursor: default;
`]))),aK=s=>{var l=s,{className:u,colorModel:m,color:_=m.defaultColor,temporarilySetValue:b,permanentlySetValue:E,discardTemporaryValue:T}=l,P=Z(l,["className","colorModel","color","temporarilySetValue","permanentlySetValue","discardTemporaryValue"]);let[N,z]=Dye(m,_,b,E);return(0,gv.useEffect)(()=>()=>{T()},[]),gv.default.createElement(oK,R({},P),gv.default.createElement(KY,{hsva:N,onChange:z}),gv.default.createElement(HY,{hue:N.h,onChange:z}),gv.default.createElement(rK,{hsva:N,onChange:z}))}}),zD,lK,cK,uK,hK,Lye=k(()=>{zD=Q(qe()),Fye(),iK(),bM(),DD(),lK=s=>({r:s.r/255,g:s.g/255,b:s.b/255,a:s.a}),cK=s=>({r:s.r*255,g:s.g*255,b:s.b*255,a:s.a}),uK={defaultColor:{r:0,g:0,b:0,a:1},toHsva:s=>BY(cK(s)),fromHsva:s=>lK(LY(s)),equal:SM},hK=s=>zD.default.createElement(TY,null,zD.default.createElement(aK,$(R({},s),{permanentlySetValue:l=>{s.permanentlySetValue(l)},colorModel:uK})))}),Bye=k(()=>{Lye()}),dK,fK,pK,Uye=k(()=>{dK=Q(qe()),fK=function(s){(0,dK.useEffect)(s,[])},pK=fK}),mK,gK,yK,zye=k(()=>{mK=Q(qe()),Uye(),gK=function(s){var l=(0,mK.useRef)(s);l.current=s,pK(function(){return function(){return l.current()}})},yK=gK}),wM,vK,_K,Vye=k(()=>{wM=Q(qe()),zye(),vK=function(s){var l=(0,wM.useRef)(0),u=(0,wM.useState)(s),m=u[0],_=u[1],b=(0,wM.useCallback)(function(E){cancelAnimationFrame(l.current),l.current=requestAnimationFrame(function(){_(E)})},[]);return yK(function(){cancelAnimationFrame(l.current)}),[m,b]},_K=vK});function Gye(s){for(var l=[],u=1;u<arguments.length;u++)l[u-1]=arguments[u];s&&s.addEventListener&&s.addEventListener.apply(s,l)}function jye(s){for(var l=[],u=1;u<arguments.length;u++)l[u-1]=arguments[u];s&&s.removeEventListener&&s.removeEventListener.apply(s,l)}var EM,Hye=k(()=>{EM=typeof window<"u"}),xK,bK,TM,VD=k(()=>{xK=Q(qe()),Vye(),Hye(),bK=function(s,l){s===void 0&&(s=1/0),l===void 0&&(l=1/0);var u=_K({width:EM?window.innerWidth:s,height:EM?window.innerHeight:l}),m=u[0],_=u[1];return(0,xK.useEffect)(function(){if(EM){var b=function(){_({width:window.innerWidth,height:window.innerHeight})};return Gye(window,"resize",b),function(){jye(window,"resize",b)}}},[]),m},TM=bK});function GD(s){let[l,u]=(0,jD.useState)(null);return(0,jD.useLayoutEffect)(()=>(s&&u(s.getBoundingClientRect()),()=>{u(null)}),[s]),l}var jD,SK=k(()=>{jD=Q(qe())}),wK,EK,HD,TK=k(()=>{wK=Q(qe()),EK=(0,wK.createContext)({}),HD=EK});function Wye(s,l,u){let m=s.getBoundingClientRect(),_=b=>{(b.clientX<m.left-l||b.clientX>m.left+m.width+l||b.clientY<m.top-l||b.clientY>m.top+m.height+l)&&u(b)};return window.addEventListener("mousemove",_),()=>{window.removeEventListener("mousemove",_)}}var $ye=k(()=>{}),MK,MM,WD,CK,$D,AK=k(()=>{MK=Q(qe()),MM=Q(qe()),VD(),SK(),TK(),Fi(),fD(),$ye(),av(),Fo(),WD=8,CK=s=>{var l,u;let m=s.children(),[_,b]=Ai(null),E=m.props.style?R({},m.props.style):{};E.position="absolute";let T=GD(b),P=GD(s.target),N=TM(),[z,G]=(0,MM.useState)({});return(0,MM.useLayoutEffect)(()=>{var V,B,H;if(!T||!b||!P)return;let j=(V=s.verticalGap)!=null?V:8,X={},K=(B=s.verticalPlacement)!=null?B:"bottom",te=0,se=0;K==="bottom"?P.bottom+T.height+j<N.height?(K="bottom",te=P.bottom+j,X.top="0px"):P.top>T.height+j?(K="top",te=P.top-(T.height+j),X.bottom="0px",X.transform="rotateZ(180deg)"):K="overlay":K==="top"&&(P.top>T.height+j?(K="top",te=P.top-(T.height+j),X.bottom="0px",X.transform="rotateZ(180deg)"):P.bottom+T.height+j<N.height?(K="bottom",te=P.bottom+j,X.top="0px"):K="overlay");let pe=0;if(K!=="overlay"){let He=P.left+P.width/2;He<T.width/2?(se=j,pe=Math.max(He-j,WD)):He+T.width/2>N.width?(se=N.width-(j+T.width),pe=Math.min(He-se,T.width-WD)):(se=He-T.width/2,pe=T.width/2),X.left=pe+"px"}let{minX:fe=-1/0,maxX:ve=1/0,minY:Ne=-1/0,maxY:ze=1/0}=(H=s.constraints)!=null?H:{},Me={left:ii(se,fe,ve-T.width),top:ii(te,Ne,ze+T.height)};if(b.style.left=Me.left+"px",b.style.top=Me.top+"px",G(X),s.onPointerOutside)return Wye(b,s.onPointerOutside.threshold,s.onPointerOutside.callback)},[T,b,s.target,P,N,s.onPointerOutside]),dD([b,(l=s.target)!=null?l:null],(u=s.onClickOutside)!=null?u:wd),MK.default.createElement(HD.Provider,{value:z},(0,MM.cloneElement)(m,{ref:_,style:E}))},$D=CK});function pp(s,l){let{isPointerBeingCaptured:u}=LX("usePopover"),[m,_]=Ai({isOpen:!1}),b=(0,M0.useRef)(s),E=(0,M0.useCallback)(V=>{m.current={isOpen:!1}},[]),T=(0,M0.useCallback)((V,B)=>{var H;let j=typeof b.current=="function"?b.current():b.current;function X(){N.childHasFocusRef.current||j.closeOnClickOutside!==!1&&E("clicked outside popover")}m.current={isOpen:!0,clickPoint:{clientX:V.clientX,clientY:V.clientY},target:B,opts:j,onClickOutside:X,onPointerOutside:j.closeWhenPointerIsDistant===!1?void 0:{threshold:(H=j.pointerDistanceThreshold)!=null?H:100,callback:()=>{N.childHasFocusRef.current||u()||E("pointer outside")}}}},[]),P=(0,M0.useCallback)((...V)=>{m.current.isOpen?E("toggled"):T(...V)},[]),N=qye({state:_}),[,z]=(0,M0.useContext)(Vb);(0,M0.useEffect)(()=>{let V;return _.isOpen&&(V=z()),()=>V==null?void 0:V()},[_.isOpen]);let G=(0,M0.useContext)(iv);return{node:_.isOpen?(0,PK.createPortal)(M0.default.createElement(qD.Provider,{value:N.childPopoverLock},M0.default.createElement($D,{children:l,target:_.target,onClickOutside:_.onClickOutside,onPointerOutside:_.onPointerOutside,constraints:_.opts.constraints,verticalGap:_.opts.verticalGap})),G):M0.default.createElement(M0.default.Fragment,null),open:T,close:E,toggle:P,isOpen:_.isOpen}}function qye(s){let l=(0,M0.useContext)(qD);(0,M0.useEffect)(()=>{if(s.state.isOpen){let m=l.takeFocus();return()=>{m.releaseFocus()}}},[s.state.isOpen]);let u=(0,M0.useRef)(!1);return{childHasFocusRef:u,childPopoverLock:{takeFocus(){return u.current=!0,{releaseFocus(){u.current=!1}}}}}}var M0,PK,qD,mp=k(()=>{yD(),Fi(),M0=Q(qe()),PK=Q(ua()),O5(),AK(),OO(),qD=M0.default.createContext({takeFocus(){return{releaseFocus(){}}}})}),Nm,RK,kK,IK,NK,DK,OK,FK,LK,BK,UK,zK,VK,Xye=k(()=>{Nm=Q(qe()),Ft(),TK(),kK=Te.div(RK||(RK=J([`
  position: absolute;
  width: 0;
  height: 0;
  color: var(--popover-arrow-color);
  pointer-events: none;
`]))),NK=Te.div(IK||(IK=J([`
  width: 12px;
  height: 8px;
  position: absolute;
  left: -7px;
  top: -8px;
  text-align: center;
  line-height: 0;
`]))),OK=Te.path(DK||(DK=J([`
  fill: var(--popover-bg);
`]))),LK=Te.path(FK||(FK=J([`
  fill: var(--popover-inner-stroke);
`]))),UK=Te.path(BK||(BK=J([`
  fill: var(--popover-outer-stroke);
`]))),zK=(0,Nm.forwardRef)(({className:s},l)=>{let u=(0,Nm.useContext)(HD);return Nm.default.createElement(kK,{className:s,ref:l,style:R({},u)},Nm.default.createElement(NK,null,Nm.default.createElement("svg",{width:"12",height:"8",viewBox:"0 0 12 8",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Nm.default.createElement(UK,{d:"M6 0L0 6H12L6 0Z"}),Nm.default.createElement(LK,{d:"M6 1.5L0 7.5H12L6 1.5Z"}),Nm.default.createElement(OK,{d:"M6 3L0 9H12L6 3Z"}))))}),VK=zK}),CM,XD,GK,jK,HK,gp,yp=k(()=>{Li(),nu(),CM=Q(qe()),Ft(),Xye(),XD=Sd(.05,"#2a2a31"),jK=Te.div(GK||(GK=J([`
  position: absolute;
  --popover-bg: `,`;
  --popover-inner-stroke: #505159;
  --popover-outer-stroke: #111;

  background: var(--popover-bg);

  color: white;
  padding: 0;
  margin: 0;
  cursor: default;
  `,`;
  border-radius: 3px;
  z-index: 10000;
  border: 1px solid var(--popover-inner-stroke);
  box-shadow: 0 0 0 1px var(--popover-outer-stroke), 0 6px 8px -4px black;
  backdrop-filter: blur(8px);

  & a {
    color: inherit;
  }
`])),XD,Di),HK=CM.default.forwardRef(({children:s,className:l,showPopoverEdgeTriangle:u=!0},m)=>CM.default.createElement(jK,{className:l,ref:m},u?CM.default.createElement(VK,null):void 0,s)),gp=HK});function Yye({editingTools:s,value:l,autoFocus:u}){let m=(0,vp.useRef)(null),_=(0,vp.useCallback)(E=>{let T=PD(Pye(E));s.permanentlySetValue(T)},[s]),b=pp({debugName:"RgbaPropEditor"},()=>vp.default.createElement(QK,null,vp.default.createElement(hK,{color:{r:l.r,g:l.g,b:l.b,a:l.a},temporarilySetValue:E=>{let T=PD(E);s.temporarilySetValue(T)},permanentlySetValue:E=>{let T=PD(E);s.permanentlySetValue(T)},discardTemporaryValue:s.discardTemporaryValue})));return vp.default.createElement(vp.default.Fragment,null,vp.default.createElement($K,null,vp.default.createElement(XK,{rgbaColor:l,ref:m,onClick:E=>{b.toggle(E,m.current)}}),vp.default.createElement(KK,{value:AD(l,{removeAlphaIfOpaque:!0}),temporarilySetValue:YD,discardTemporaryValue:YD,permanentlySetValue:_,isValid:E=>!!E.match(RD),autoFocus:u})),b.node)}var vp,WK,$K,qK,XK,YK,KK,YD,ZK,QK,JK,Kye=k(()=>{wY(),wY(),vp=Q(qe()),Bye(),Ft(),mp(),CD(),yp(),$K=Te.div(WK||(WK=J([`
  display: flex;
  align-items: center;
  height: 100%;
  gap: 4px;
`]))),XK=Te.div.attrs(s=>({style:{background:AD(s.rgbaColor)}}))(qK||(qK=J([`
  height: 18px;
  aspect-ratio: 1;
  border-radius: 99999px;
`]))),KK=Te(dM)(YK||(YK=J([`
  flex: 1;
`]))),YD=()=>{},QK=Te.div(ZK||(ZK=J([`
  position: absolute;
  background-color: `,`;
  color: white;
  margin: 0;
  cursor: default;
  border-radius: 3px;
  z-index: 10000;
  backdrop-filter: blur(8px);

  padding: 4px;
  pointer-events: all;

  border: none;
  box-shadow: none;
`])),XD),JK=Yye});function Zye({propConfig:s,editingTools:l,value:u,autoFocus:m}){let[_,b]=Td.default.useState();(0,Td.useEffect)(()=>{b(u?l.getAssetUrl(u):void 0)},[u]);let E=(0,Td.useCallback)(P=>Ue(this,null,function*(){let N=P.target.files[0];l.permanentlySetValue({type:"image",id:void 0});let z=yield l.createAsset(N);z?l.permanentlySetValue({type:"image",id:z}):l.permanentlySetValue(u),P.target.value=null}),[l,u]),T=!(u!=null&&u.id);return Td.default.createElement(KD,{empty:T},Td.default.createElement(oZ,{empty:T,title:T?"Upload image":'"'.concat(u.id,'" (Click to upload new image)')},Td.default.createElement(lZ,{type:"file",onChange:E,accept:"image/*,.hdr",autoFocus:m}),_?Td.default.createElement(uZ,{src:_}):Td.default.createElement(nZ,null)),!T&&Td.default.createElement(dZ,{title:"Delete image",onClick:()=>{l.permanentlySetValue({type:"image",id:void 0})}},Td.default.createElement(rD,null)))}var Td,eZ,KD,tZ,nZ,rZ,iZ,sZ,oZ,aZ,lZ,cZ,uZ,hZ,dZ,fZ,Qye=k(()=>{rb(),Td=Q(qe()),Ft(),KD=Te.div(eZ||(eZ=J([`
  display: flex;
  align-items: center;
  height: 100%;
  gap: 4px;
`]))),nZ=Te.div(tZ||(tZ=J([`
  position: absolute;
  inset: -5px;
  // rotate 45deg
  transform: rotate(45deg);
  --checker-color: #ededed36;
  &:hover {
    --checker-color: #ededed77;
  }
  // checkerboard background with 4px squares
  background-image: linear-gradient(
      45deg,
      var(--checker-color) 25%,
      transparent 25%
    ),
    linear-gradient(-45deg, var(--checker-color) 25%, transparent 25%),
    linear-gradient(45deg, transparent 75%, var(--checker-color) 75%),
    linear-gradient(-45deg, transparent 75%, var(--checker-color) 75%);
  background-size: 5px 5px;
`]))),oZ=Te.label(sZ||(sZ=J([`
  position: relative;
  cursor: default;
  box-sizing: border-box;

  height: 18px;
  aspect-ratio: 1;
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: 16px;

  overflow: hidden;
  color: #ccc;
  &:hover {
    color: white;
  }

  border-radius: 99999px;
  border: 1px solid hwb(220deg 40% 52%);
  &:hover {
    border-color: hwb(220deg 45% 52%);
  }

  `,`
`])),s=>s.empty?Wa(rZ||(rZ=J([""]))):Wa(iZ||(iZ=J([""])))),lZ=Te.input.attrs({type:"file"})(aZ||(aZ=J([`
  display: none;
`]))),uZ=Te.img(cZ||(cZ=J([`
  position: absolute;
  inset: 0;
  height: 100%;
  aspect-ratio: 1;

  object-fit: cover;
`]))),dZ=Te.button(hZ||(hZ=J([`
  display: flex;
  align-items: center;
  justify-content: center;
  outline: none;
  background: transparent;
  color: #a8a8a9;

  border: none;
  height: 100%;
  aspect-ratio: 1/1;

  opacity: 0;

  `,`:hover & {
    opacity: 0.8;
  }

  &:hover {
    opacity: 1;
    color: white;
  }
`])),KD),fZ=Zye});function Jye({propConfig:s,editingTools:l,value:u,autoFocus:m}){let[_,b]=Md.default.useState();(0,Md.useEffect)(()=>{b(u?l.getAssetUrl(u):void 0)},[u]);let E=(0,Md.useCallback)(P=>Ue(this,null,function*(){let N=P.target.files[0];l.permanentlySetValue({type:"file",id:void 0});let z=yield l.createAsset(N);z?l.permanentlySetValue({type:"file",id:z}):l.permanentlySetValue(u),P.target.value=null}),[l,u]),T=!(u!=null&&u.id);return Md.default.createElement(ZD,{empty:T},Md.default.createElement(xZ,{empty:T,title:T?"Upload file":'"'.concat(u.id,'" (Click to upload new file)')},Md.default.createElement(SZ,{type:"file",onChange:E,autoFocus:m}),_?Md.default.createElement(eD,null):Md.default.createElement(gZ,null)),!T&&Md.default.createElement(EZ,{title:"Delete file",onClick:()=>{l.permanentlySetValue({type:"file",id:void 0})}},Md.default.createElement(rD,null)))}var Md,pZ,ZD,mZ,gZ,yZ,vZ,_Z,xZ,bZ,SZ,wZ,EZ,TZ,eve=k(()=>{rb(),Md=Q(qe()),Ft(),ZD=Te.div(pZ||(pZ=J([`
  display: flex;
  align-items: center;
  height: 100%;
  gap: 4px;
`]))),gZ=Te.div(mZ||(mZ=J([`
  position: absolute;
  inset: -5px;
  // rotate 45deg
  transform: rotate(45deg);
  --checker-color: #ededed36;
  &:hover {
    --checker-color: #ededed77;
  }
  // checkerboard background with 4px squares
  background-image: linear-gradient(
      45deg,
      var(--checker-color) 25%,
      transparent 25%
    ),
    linear-gradient(-45deg, var(--checker-color) 25%, transparent 25%),
    linear-gradient(45deg, transparent 75%, var(--checker-color) 75%),
    linear-gradient(-45deg, transparent 75%, var(--checker-color) 75%);
  background-size: 5px 5px;
`]))),xZ=Te.label(_Z||(_Z=J([`
  position: relative;
  cursor: default;
  box-sizing: border-box;

  height: 18px;
  aspect-ratio: 1;
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: 16px;

  overflow: hidden;
  color: #ccc;
  &:hover {
    color: white;
  }

  border-radius: 99999px;
  border: 1px solid hwb(220deg 40% 52%);
  &:hover {
    border-color: hwb(220deg 45% 52%);
  }

  `,`
`])),s=>s.empty?Wa(yZ||(yZ=J([""]))):Wa(vZ||(vZ=J([""])))),SZ=Te.input.attrs({type:"file"})(bZ||(bZ=J([`
  display: none;
`]))),EZ=Te.button(wZ||(wZ=J([`
  display: flex;
  align-items: center;
  justify-content: center;
  outline: none;
  background: transparent;
  color: #a8a8a9;

  border: none;
  height: 100%;
  aspect-ratio: 1/1;

  opacity: 0;

  `,`:hover & {
    opacity: 0.8;
  }

  &:hover {
    opacity: 1;
    color: white;
  }
`])),ZD),TZ=Jye}),QD,MZ=k(()=>{U6e(),ZX(),Mye(),Aye(),Kye(),Qye(),eve(),QD={number:SD,string:SY,boolean:CX,stringLiteral:mY,rgba:JK,image:fZ,file:TZ}});function gb(s){let l=new WeakMap;return u=>(l.has(u)||l.set(u,s(u)),l.get(u))}var AM=k(()=>{});function _p(s){return s.type==="compound"||s.type==="enum"}function PM(s,l){if(!s)return;let[u,...m]=l;if(u===void 0)return s;if(!_p(s))return;let _=s.type==="enum"?s.cases[u]:s.props[u];return PM(_,m)}function RM(s,l){let u=l.deserializeAndSanitize(s);return u===void 0?l.default:u}function tve(s){return!_p(s)}function*yb(s,l){if(s.type==="compound")for(let u in s.props)yield*rt(yb(s.props[u],[...l,u]));else{if(s.type==="enum")throw new Error("Not implemented yet");return yield{path:l,conf:s}}}var JD,I9=k(()=>{AM(),JD=gb(s=>{if(s.type==="enum")throw new Error("Not implemented yet for enums");for(let l in s.props){let u=s.props[l];if(_p(u)){if(JD(u))return!0}else return!0}return!1})}),eO,CZ=k(()=>{eO="calc(var(--left-pad) + var(--depth) * var(--step))"}),AZ,N9,B5=k(()=>{Ft(),N9=Wa(AZ||(AZ=J([`
  font-weight: 300;
  font-size: 11px;
  color: `,`;
  text-shadow: 0.5px 0.5px 2px rgba(0, 0, 0, 0.3);
`])),s=>s.isHighlighted==="self"?"#CCC":"#919191")}),vb,kM,PZ,RZ,kZ,IZ,NZ,DZ,OZ=k(()=>{av(),vb=Q(qe()),Ft(),kM=26,RZ=Te.li(PZ||(PZ=J([`
  height: `,`px;
  padding: 0 12px;
  margin: 0;
  display: flex;
  align-items: center;
  font-size: 11px;
  font-weight: 400;
  position: relative;
  color: `,`;
  cursor: `,`;

  &:after {
    position: absolute;
    inset: 2px 1px;
    display: block;
    content: ' ';
    pointer-events: none;
    z-index: -1;
    border-radius: 3px;
  }

  &:hover:after {
    background-color: `,`;
  }
`])),kM,s=>s.enabled?"white":"#8f8f8f",s=>s.enabled?"normal":"not-allowed",s=>s.enabled?"rgba(63, 174, 191, 0.75)":"initial"),IZ=Te.span(kZ||(kZ=J([""]))),NZ=s=>vb.default.createElement(RZ,{onClick:s.enabled?s.onClick:wd,enabled:s.enabled,title:s.enabled?void 0:"Disabled"},vb.default.createElement(IZ,null,vb.default.createElement(vb.default.Fragment,null,s.label))),DZ=NZ});function nve(s){let l=(0,tO.useRef)(s);l.current=s,(0,tO.useEffect)(()=>{let u=m=>l.current(m);return window.addEventListener("keydown",u),()=>{window.removeEventListener("keydown",u)}},[])}var tO,rve=k(()=>{tO=Q(qe())}),_b,FZ,LZ,BZ,UZ,zZ,VZ,GZ,nO,jZ=k(()=>{_b=Q(qe()),OZ(),Ft(),nu(),Li(),FZ=190,LZ=!0,UZ=Te.ul(BZ||(BZ=J([`
  position: absolute;
  min-width: `,`px;
  z-index: 10000;
  background: `,`;
  backdrop-filter: blur(2px);
  color: white;
  list-style-type: none;
  padding: 2px 0;
  margin: 0;
  border-radius: 1px;
  cursor: default;
  `,`;
  border-radius: 3px;
`])),FZ,Sd(.2,"#111"),Di),VZ=Te.div(zZ||(zZ=J([`
  padding: 4px 10px;
  border-bottom: 1px solid #6262626d;
  color: #adadadb3;
  font-size: 11px;
  font-weight: 500;
`]))),GZ=_b.default.forwardRef((s,l)=>_b.default.createElement(UZ,{ref:l},LZ&&s.displayName?_b.default.createElement(VZ,null,s.displayName):null,s.items.map((u,m)=>_b.default.createElement(DZ,{key:"item-".concat(m),label:u.label,enabled:u.enabled!==!1,onClick:_=>{u.callback&&u.callback(_),s.onRequestClose()}})))),nO=GZ}),HZ,WZ,IM,$Z,xb,qZ,XZ,ive=k(()=>{SK(),HZ=Q(qe()),WZ=Q(qe()),IM=Q(qe()),$Z=Q(ua()),VD(),OZ(),O5(),rve(),jZ(),xb=20,qZ=s=>{let[l,u]=(0,IM.useState)(null),m=GD(l),_=TM();(0,IM.useLayoutEffect)(()=>{if(!m||!l)return;let T={left:m.width/2,top:kM/2+(s.displayName?kM:0)},P={left:s.clickPoint.clientX-T.left,top:s.clickPoint.clientY-T.top};P.left<0?P.left=0:P.left+m.width>_.width&&(P.left=_.width-m.width),P.top<0?P.top=0:P.top+m.height>_.height&&(P.top=_.height-m.height),l.style.left=P.left+"px",l.style.top=P.top+"px";let N=z=>{(z.clientX<P.left-xb||z.clientX>P.left+m.width+xb||z.clientY<P.top-xb||z.clientY>P.top+m.height+xb)&&s.onRequestClose()};return window.addEventListener("mousemove",N),()=>{window.removeEventListener("mousemove",N)}},[m,l,s.clickPoint,_,s.onRequestClose]);let b=(0,WZ.useContext)(iv);nve(T=>{T.key==="Escape"&&s.onRequestClose()});let E=(0,HZ.useMemo)(()=>{let T=Array.isArray(s.items)?s.items:s.items();return T.length>0?T:[{label:s.displayName?"No actions for ".concat(s.displayName):"No actions found",enabled:!1}]},[s.items]);return(0,$Z.createPortal)(IM.default.createElement(nO,{items:E,onRequestClose:s.onRequestClose,displayName:s.displayName,ref:u}),b)},XZ=qZ}),NM,YZ,KZ,sve=k(()=>{NM=Q(qe()),YZ=(s,l)=>{let[u,m]=(0,NM.useState)({isOpen:!1}),_=(0,NM.useCallback)(()=>m({isOpen:!1}),[]);return(0,NM.useEffect)(()=>{if(!s||l.disabled===!0){m({isOpen:!1});return}let b=E=>{m({isOpen:!0,event:E}),E.preventDefault(),E.stopPropagation()};return s.addEventListener("contextmenu",b),()=>{s.removeEventListener("contextmenu",b)}},[s,l.disabled]),[u,_]},KZ=YZ});function ml(s,l){let[u,m]=KZ(s,l),[,_]=(0,yv.useContext)(Vb);return(0,yv.useEffect)(()=>{var b;let E;return u.isOpen&&((b=l.onOpen)==null||b.call(l),E=_()),()=>E==null?void 0:E()},[u.isOpen,l.onOpen]),[u.isOpen?yv.default.createElement(XZ,{items:l.menuItems,displayName:l.displayName,clickPoint:u.event,onRequestClose:m}):ZZ,m,u.isOpen]}var yv,ZZ,gl=k(()=>{yv=Q(qe()),ive(),sve(),OO(),ZZ=yv.default.createElement(yv.default.Fragment,null)});function D9(s,l){return l.length===0?s:jc(s,l)}var DM=k(()=>{Hf()});function QZ(s,l){return s==null?null:s instanceof Element&&s.matches(l)?s:QZ(s.parentElement,l)}var ove=k(()=>{});function bb(s,l){let u=s;for(let m of l)u=u[m];return u}var OM=k(()=>{});function ave(s){let l=new LM.Atom(void 0),u=new LM.Atom({}),m=new LM.Atom({}),_=0;return{addRelatedFlags(b,E){let T=String(++_),P=E.map(N=>{let z={flag:N.flag},G=[N.affects,b,T];return m.setByPointer(V=>bb(V,G),z),G});return()=>{for(let N of P)m.setByPointer(z=>bb(z,N),void 0)}},usePresenceFlag(b){},setUserHover(b){let E=l.get();E!==b&&(E&&u.setByPointer(T=>T[E],!1),l.set(b),b&&u.setByPointer(T=>T[b],!0))}}}function U5(s){let l=FM.default.useContext(iO),u=l.usePresenceFlag(s);return{attrs:{[BM]:s},flag:u,useRelations(m,_){(0,rO.useEffect)(()=>s&&l.addRelatedFlags(s,m()),[s,..._])}}}function JZ(s){let l=FM.default.useContext(iO),u=P9("PresenceListeners");(0,rO.useEffect)(()=>{let m;if(!s)return;let _=b=>{if(b.target instanceof Node){let E=QZ(b.target,"[".concat(BM,"]"));if(E){let T=E.getAttribute(BM);m!==T&&(m=T,l.setUserHover(T||void 0),u._debug("Updated current hover",{itemKey:T}));return}m!=null&&(m=null,l.setUserHover(void 0),u._debug("Cleared current hover"))}};return s.addEventListener("mouseover",_),()=>{s.removeEventListener("mouseover",_),m!=null&&(m=null,u._debug("Cleared current hover as part of cleanup"))}},[s,l])}var FM,rO,eQ,LM,tQ,iO,BM,z5=k(()=>{FM=Q(qe()),rO=Q(qe()),R9(),eQ=mn(),LM=mn(),er(),ove(),OM(),tQ=(0,eQ.prism)(()=>{}),tQ.keepHot(),iO=FM.default.createContext(ave()),BM="data-pi-key"}),Xa,nQ,Sb,rQ,sO,O9,iQ,oO,sQ,oQ,aQ,UM,lQ,cQ,uQ,hQ,dQ,fQ,wb,pQ,aO,zM=k(()=>{Li(),nu(),Xa=Q(qe()),Ft(),z5(),Sb=Te.div(nQ||(nQ=J([`
  display: flex;
  justify-content: center;
  align-items: center;
  width: 16px;
  margin: 0 0px 0 2px;
  position: relative;
  z-index: 0;
  opacity: 0.7;

  &:after {
    position: absolute;
    left: -14px;
    right: -14px;
    top: -2px;
    bottom: -2px;
    content: ' ';
    display: none;
    z-index: -1;
    background: `,`;
  }

  &:hover {
    opacity: 1;
    &:after {
      display: block;
    }
  }
`])),Sd(.2,"black")),sO=Te.div(rQ||(rQ=J([`
  background: none;
  position: relative;
  border: 0;
  transition: transform 0.1s ease-out;
  z-index: 0;
  outline: none;
  cursor: pointer;

  &:after {
    display: none;
    `,`:hover & {
      display: block;
    }
    position: absolute;
    left: -4px;
    right: -4px;
    top: -4px;
    bottom: -4px;
    content: ' ';
    z-index: -1;
  }
`])),Sb),O9={offColor:"#555",onColor:"#e0c917"},oO=Te(sO)(iQ||(iQ=J([`
  &:hover {
    color: #e0c917;
  }

  color: `,`;
`])),s=>s.presence===2?"white":s.isOn?O9.onColor:O9.offColor),oQ=Wa(sQ||(sQ=J([`
  pointer-events: none !important;
`]))),UM=Te(sO)(aQ||(aQ=J([`
  color: `,`;

  `,`;
`])),s=>s.flag===2?"white":s.available?O9.onColor:O9.offColor,s=>s.available?Di:oQ),cQ=Te(UM)(lQ||(lQ=J([`
  transform: translateX(2px);
  `,`:hover & {
    transform: translateX(-7px);
  }
`])),Sb),hQ=Te(UM)(uQ||(uQ=J([`
  transform: translateX(-2px);
  `,`:hover & {
    transform: translateX(7px);
  }
`])),Sb),(s=>{let l=Te.g(dQ||(dQ=J([`
    stroke-width: 1;
    `,`:hover & path {
      stroke-width: 3;
    }
  `])),UM);s.Prev=()=>Xa.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Xa.default.createElement(l,{transform:"translate(6 3)"},Xa.default.createElement("path",{d:"M4 1L1 4L4 7",stroke:"currentColor"}))),s.Next=()=>Xa.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Xa.default.createElement(l,{transform:"translate(1 3)"},Xa.default.createElement("path",{d:"M1 1L4 4L1 7",stroke:"currentColor"})));let u=Te.g(fQ||(fQ=J([`
    stroke-width: 0;
    `,`:hover & path {
      stroke: currentColor;
      stroke-width: 2;
    }
  `])),oO);s.Cur=()=>Xa.default.createElement("svg",{width:"8",height:"12",viewBox:"0 0 8 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Xa.default.createElement(u,{transform:"translate(1 4)"},Xa.default.createElement("path",{d:"M3 0L6 3L3 6L0 3L3 0Z",fill:"currentColor"})))})(wb||(wb={})),pQ=s=>{var l,u,m,_,b;let E=U5((l=s.prev)==null?void 0:l.itemKey),T=U5(((u=s.cur)==null?void 0:u.type)==="on"?s.cur.itemKey:void 0),P=U5((m=s.next)==null?void 0:m.itemKey);return Xa.default.createElement(Sb,null,Xa.default.createElement(cQ,R({available:!!s.prev,onClick:(_=s.prev)==null?void 0:_.jump,flag:E.flag},E.attrs),Xa.default.createElement(wb.Prev,null)),Xa.default.createElement(oO,R({isOn:s.cur.type==="on",onClick:s.cur.toggle,presence:T.flag},T.attrs),Xa.default.createElement(wb.Cur,null)),Xa.default.createElement(hQ,R({available:!!s.next,onClick:(b=s.next)==null?void 0:b.jump,flag:P.flag},P.attrs),Xa.default.createElement(wb.Next,null)))},aO=pQ}),VM,Eb,mQ,gQ,yQ,vQ,_Q,xQ,bQ,Tb,SQ=k(()=>{nu(),VM=Q(qe()),Ft(),Ae(),zM(),I9(),Eb={defaultState:{color:Sd(.95,"#C4C4C4"),hoverColor:Sd(.15,O9.onColor)},withStaticOverride:{color:Sd(.85,"#C4C4C4"),hoverColor:Sd(.15,O9.onColor)}},gQ=Te.div(mQ||(mQ=J([`
  width: 16px;
  margin: 0 0px 0 2px;
  display: flex;
  justify-content: center;
  align-items: center;
  cursor: pointer;

  color: `,`;

  &:hover {
    color: `,`;
  }
`])),s=>s.hasStaticOverride?Eb.withStaticOverride.color:Eb.defaultState.color,s=>s.hasStaticOverride?Eb.withStaticOverride.hoverColor:Eb.defaultState.hoverColor),vQ=Te.div(yQ||(yQ=J([`
  width: 5px;
  height: 5px;
  border-radius: 1px;
  transform: rotate(45deg);
  /* border: 1px solid currentColor; */
  background-color: currentColor;
`]))),xQ=Te.div(_Q||(_Q=J([`
  width: 5px;
  height: 5px;
  background-color: currentColor;
  border-radius: 1px;
  transform: rotate(45deg);
`]))),bQ=s=>{let{hasStaticOverride:l,obj:u,propConfig:m,pathToProp:_}=s;return VM.default.createElement(gQ,{hasStaticOverride:l,onClick:()=>{Se().transaction(({stateEditors:b})=>{for(let{path:E,conf:T}of yb(m,_)){if(_p(T))continue;let P=$(R({},u.address),{pathToProp:E});b.coreByProject.historic.sheetsById.sequence.setPrimitivePropAsSequenced(P,m)}})},title:"Sequence this prop"},l?VM.default.createElement(xQ,{title:"The default value is overridden"}):VM.default.createElement(vQ,{title:"This is the default value for this prop"}))},Tb=bQ});function Mb(s){return JSON.stringify(lO(s))}function lO(s){return Wc(s)?Object.keys(s).sort().reduce((l,u)=>(l[u]=lO(s[u]),l),{}):Array.isArray(s)?s.map(lO):s}var lve=k(()=>{Fo()}),wQ,Cb,EQ=k(()=>{wQ="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",Cb=(s=21)=>{let l="",u=s;for(;u--;)l+=wQ[Math.random()*64|0];return l}});function TQ(){return Cb(10)}function cve(){return Cb(10)}function uve(){return Cb(10)}var ha,Dm=k(()=>{lve(),EQ(),ha={forSheet(){return"sheet"},forSheetObject(s){return Mb({o:s.address.objectKey})},forSheetObjectProp(s,l){return Mb({o:s.address.objectKey,p:l})},forTrackKeyframe(s,l,u){return Mb({o:s.address.objectKey,t:l,k:u})},forSheetObjectAggregateKeyframe(s,l){return ha.forCompoundPropAggregateKeyframe(s,[],l)},forSheetAggregateKeyframe(s,l){return Mb({o:s.address.sheetId,pos:l})},forCompoundPropAggregateKeyframe(s,l,u){return Mb({o:s.address.objectKey,p:l,pos:u})}}});function MQ(s,l,u){if(!l||l.data.keyframes.length===0)return CQ;let m=cO.get(l.data);if(m&&m[0]===u)return m[1];function _(E){if(!l)return;let T=l.data.keyframes[E];return T&&{kf:T,track:l,itemKey:ha.forTrackKeyframe(s,l.id,T.id)}}let b=(()=>{let E=l.data.keyframes.findIndex(P=>P.position>=u);if(E===-1)return{prev:_(l.data.keyframes.length-1)};let T=_(E);return T.kf.position===u?{prev:_(E-1),cur:T,next:_(E+1)}:{next:T,prev:_(E-1)}})();return cO.set(l.data,[u,b]),b}var cO,CQ,AQ=k(()=>{Dm(),cO=new WeakMap,CQ={}}),uO,PQ=k(()=>{uO={}});function hve(s,l,u){let m=(0,ih.getPointerParts)(s).path;return jr(()=>{if(!JD(u))return{type:"AllStatic",beingScrubbed:!1,contextMenuItems:[],controlIndicators:V5.default.createElement(Tb,{hasStaticOverride:!1,obj:l,pathToProp:m,propConfig:u})};let _=!!(0,ih.val)(jc(Se().atomP.ephemeral.projects.stateByProjectId[l.address.projectId].stateBySheetId[l.address.sheetId].stateByObjectKey[l.address.objectKey].valuesBeingScrubbed,(0,ih.getPointerParts)(s).path)),b=[],E={beingScrubbed:_,contextMenuItems:b,controlIndicators:V5.default.createElement(V5.default.Fragment,null)},T=(0,ih.val)(l.template.getMapOfValidSequenceTracks_forStudio()),P=D9(T,m),N=P!==void 0&&Object.keys(P).length!==0,z=[],G=(0,ih.val)(l.template.getStaticButNotSequencedOverrides()),V=D9(G??uO,m)!==void 0;if(N)for(let B of yb(u,[])){if(_p(B.conf))continue;let H=D9(P,B.path);typeof H!="string"?V=!0:z.push(H)}if((V||N)&&b.push({label:"Reset all to default",callback:()=>{Se().transaction(({unset:B})=>{B(s)})}}),N&&b.push({label:"Make all static",callback:()=>{Se().transaction(({stateEditors:B})=>{for(let{path:H,conf:j}of yb(u,[])){if(_p(j))continue;let X=$(R({},l.address),{pathToProp:[...m,...H]}),K=bb(s,H);B.coreByProject.historic.sheetsById.sequence.setPrimitivePropAsStatic($(R({},X),{value:l.getValueByPointer(K)}))}})}}),(!N||N&&V)&&b.push({label:"Sequence all",callback:()=>{Se().transaction(({stateEditors:B})=>{for(let{path:H,conf:j}of yb(u,m)){if(_p(j))continue;let X=$(R({},l.address),{pathToProp:H});B.coreByProject.historic.sheetsById.sequence.setPrimitivePropAsSequenced(X,u)}})}}),N){let B=ih.prism.memo("controlIndicators",()=>V5.default.createElement(dve,{pointerToProp:s,obj:l,possibleSequenceTrackIds:P,listOfDescendantTrackIds:z}),[P,z]);return $(R({},E),{type:"HasSequences",controlIndicators:B})}else return $(R({},E),{type:"AllStatic",controlIndicators:V5.default.createElement(Tb,{hasStaticOverride:V,obj:l,pathToProp:m,propConfig:u})})},[])}function dve({pointerToProp:s,obj:l,possibleSequenceTrackIds:u,listOfDescendantTrackIds:m}){return jr(()=>{let _=(0,ih.getPointerParts)(s).path,b=(0,ih.val)(l.sheet.getSequence().positionPrism),E=m.map(B=>({trackId:B,track:(0,ih.val)(l.template.project.pointers.historic.sheetsById[l.address.sheetId].sequence.tracksByObject[l.address.objectKey].trackData[B])})).filter(({track:B})=>!!B).map(B=>$(R({},B),{nearbies:MQ(l,{id:B.trackId,data:B.track,sheetObject:l},b)})),T=E.find(({nearbies:B})=>!!B.cur),P=E.every(({nearbies:B})=>!!B.cur),N=E.reduce((B,H)=>H.nearbies.prev&&(B===void 0||H.nearbies.prev.kf.position>B.kf.position)?H.nearbies.prev:B,void 0),z=E.reduce((B,H)=>H.nearbies.next&&(B===void 0||H.nearbies.next.kf.position<B.kf.position)?H.nearbies.next:B,void 0),G=()=>{P?Se().transaction(B=>{B.unset(s)}):T?Se().transaction(B=>{B.set(s,(0,ih.val)(s))}):Se().transaction(B=>{B.set(s,(0,ih.val)(s))})},V={cur:T?{type:"on",itemKey:ha.forCompoundPropAggregateKeyframe(l,_,b),toggle:G}:{toggle:G,type:"off"},prev:N!==void 0?{position:N.kf.position,itemKey:ha.forCompoundPropAggregateKeyframe(l,_,N.kf.position),jump:()=>{l.sheet.getSequence().position=N.kf.position}}:void 0,next:z!==void 0?{position:z.kf.position,itemKey:ha.forCompoundPropAggregateKeyframe(l,_,z.kf.position),jump:()=>{l.sheet.getSequence().position=z.kf.position}}:void 0};return V5.default.createElement(aO,R({},V))},[s,l,u,m])}var ih,V5,fve=k(()=>{Ae(),DM(),er(),ih=mn(),Hf(),V5=Q(qe()),SQ(),I9(),Dm(),OM(),zM(),AQ(),PQ()});function pve(){let s=0,l=new IQ.Atom({hasLock:!1});return{replaceLock(u,m){let _=s++,b=l.get();return b.hasLock&&b.cleanup(),l.set({hasLock:!0,lockId:_,cleanup:m,deepPath:mve(RQ(u))}),function(){let E=l.get();E.hasLock&&E.lockId===_&&(E.cleanup(),l.set({hasLock:!1}))}},getIsPropHighlightedD(u){let m=bb(l.pointer.deepPath,RQ(u));return(0,NQ.prism)(()=>{let _=(0,kQ.val)(m);return _===!0?"self":_?"descendent":null})}}}function RQ(s){return[s.projectId,s.sheetId,s.objectKey,...s.pathToProp]}function mve(s){let l={};return pm(l,s,!0),l}var kQ,IQ,NQ,GM,hO=k(()=>{kQ=mn(),IQ=mn(),NQ=mn(),OM(),Oy(),GM=pve()});function gve(s,l){return JSON.stringify(s,l,2).replace(/^([\{\[])\n (\s+)/,"$1$2").replace(/(\n[ ]+[\{\[])\n\s+/g,"$1 ").replace(/\n\s*([\]\}])/g," $1")}var yve=k(()=>{});function DQ(s,l=!0){try{return typeof s=="string"?s:typeof s=="function"||s instanceof Error?s.toString():l?gve(s):JSON.stringify(s)}catch{return(s==null?void 0:s.name)||String(s)}}var vve=k(()=>{yve()});function _ve(s,l,u){s||(arguments.length>2?OQ(l,u):OQ(l))}function OQ(s,l){let u=arguments.length>1,m=DQ(s),_=u?`
Instead found: `.concat(DQ(l)):"";throw new zQ("Invariant: ".concat(m).concat(_),l)}var FQ,LQ,BQ,UQ,zQ,xve=k(()=>{vve(),FQ=/^\s*at.+node:internal.+/gm,LQ=/^\s*(at|[^@]+@) (?:Object\.)?invariant.+/gm,BQ=/^\s*(at|[^@]+@).+test\-helpers.+/gm,UQ=/^\s*(at|[^@]+@).+(debounce|invariant|iif)\.[tj]s.*/gm,zQ=class extends Error{constructor(s,l){var u;super(s),le(this,"found"),l!==void 0&&(this.found=l),this.stack=(u=this.stack)==null?void 0:u.replace(LQ,"").replace(UQ,"").replace(BQ,"").replace(FQ,"")}}});function bve(s){return(0,jM.prism)(()=>{if(Array.isArray(s)){let l=new Array(s.length);for(let u=0;u<s.length;u++)l[u]=s[u].getValue();return l}else{let l={};for(let u in s)l[u]=(0,jM.val)(s[u]);return l}})}function dO(s){let l=vv.default.memo(vv.default.forwardRef(function(u,m){let _=[],b={},E={ref:m};for(let z in u){let G=u[z];(0,jM.isPrism)(G)?(_.push(G),b[z]=G):E[z]=G}let T=(0,vv.useRef)(_.length);_ve(T.current===_.length,"expect same number of observable props on every invocation of deriver wrapped component.",{initial:T.current,count:_.length});let P=(0,vv.useMemo)(()=>bve(b),_),N=w5(P);return N&&vv.default.createElement(s,R(R({},E),N))}));return l.displayName="deriver(".concat(s.displayName,")"),l}var jM,vv,VQ=k(()=>{jM=mn(),er(),vv=Q(qe()),xve()});function Sve(s,l,u){return(0,Cd.prism)(()=>{var m;let _=(0,Cd.getPointerParts)(s).path,b=l.getValueByPointer(s),E=Cd.prism.memo("editPropValue",()=>{let H=null;return{temporarilySetValue(j){H||(H=Se().scrub()),H.capture(X=>{X.set(s,j)})},discardTemporaryValue(){H&&(H.discard(),H=null)},permanentlySetValue(j){H?(H.capture(X=>{X.set(s,j)}),H.commit(),H=null):Se().transaction(X=>{X.set(s,j)})}}},[]),T={createAsset:H=>l.sheet.project.assetStorage.createAsset(H),getAssetUrl:H=>H.id?l.sheet.project.assetStorage.getAssetUrl(H.id):void 0},P=(0,Cd.val)(jc(Se().atomP.ephemeral.projects.stateByProjectId[l.address.projectId].stateBySheetId[l.address.sheetId].stateByObjectKey[l.address.objectKey].valuesBeingScrubbed,(0,Cd.getPointerParts)(s).path))===!0,N=[],z=$(R(R({},E),T),{value:b,beingScrubbed:P,contextMenuItems:N,controlIndicators:_v.default.createElement(_v.default.Fragment,null)}),G=tve(u);if(G){let H=(0,Cd.val)(l.template.getMapOfValidSequenceTracks_forStudio()),j=D9(H,_);if(typeof j=="string"){N.push({label:"Make static",callback:()=>{Se().transaction(({stateEditors:ve})=>{let Ne=$(R({},l.address),{pathToProp:_});ve.coreByProject.historic.sheetsById.sequence.setPrimitivePropAsStatic($(R({},Ne),{value:l.getValueByPointer(s)}))})}});let X=j,K=Cd.prism.sub("lcr",()=>{let ve=(0,Cd.val)(l.template.project.pointers.historic.sheetsById[l.address.sheetId].sequence.tracksByObject[l.address.objectKey].trackData[X]),Ne=(0,Cd.val)(l.sheet.getSequence().positionPrism);return MQ(l,ve&&{data:ve,id:X,sheetObject:l},Ne)},[X]),te;z.beingScrubbed?te="Sequenced_OnKeyframe_BeingScrubbed":K.cur?te="Sequenced_OnKeyframe":((m=K.prev)==null?void 0:m.kf.connectedRight)===!0?te="Sequenced_BeingInterpolated":te="Sequened_NotBeingInterpolated";let se=()=>{K.cur?Se().transaction(ve=>{ve.unset(s)}):Se().transaction(ve=>{ve.set(s,z.value)})},pe={cur:K.cur?{type:"on",itemKey:K.cur.itemKey,toggle:se}:{type:"off",toggle:se},prev:K.prev!==void 0?{itemKey:K.prev.itemKey,position:K.prev.kf.position,jump:()=>{l.sheet.getSequence().position=K.prev.kf.position}}:void 0,next:K.next!==void 0?{itemKey:K.next.itemKey,position:K.next.kf.position,jump:()=>{l.sheet.getSequence().position=K.next.kf.position}}:void 0},fe=_v.default.createElement(aO,R({},pe));return $(R({},z),{type:"Sequenced",shade:te,nearbyKeyframes:K,controlIndicators:fe})}}let V=(0,Cd.val)(l.template.getStaticValues()),B=D9(V,_);return typeof B<"u"&&N.push({label:"Reset to default",callback:()=>{Se().transaction(({unset:H})=>{H(s)})}}),G&&N.push({label:"Sequence",callback:()=>{Se().transaction(({stateEditors:H})=>{let j=$(R({},l.address),{pathToProp:_});H.coreByProject.historic.sheetsById.sequence.setPrimitivePropAsSequenced(j,u)})}}),typeof B<"u"?$(R({},z),{type:"Static",shade:z.beingScrubbed?"Static_BeingScrubbed":"Static",controlIndicators:_v.default.createElement(Tb,{hasStaticOverride:!0,obj:l,pathToProp:_,propConfig:u})}):$(R({},z),{type:"Default",shade:"Default",controlIndicators:_v.default.createElement(Tb,{hasStaticOverride:!0,obj:l,pathToProp:_,propConfig:u})})})}function wve(s,l,u){if(HM.has(s))return HM.get(s);{let m=Sve(s,l,u);return HM.set(s,m),m}}function fO(s,l,u){let m=wve(s,l,u);return w5(m)}var _v,Cd,HM,pO=k(()=>{Hf(),_v=Q(qe()),Cd=mn(),Ae(),DM(),er(),I9(),SQ(),AQ(),zM(),HM=new WeakMap});function Eve({propConfig:s,pointerToProp:l,obj:u,SimpleEditorComponent:m}){let _=fO(l,u,s);return Ya.default.createElement(SD,{editingTools:_,propConfig:s,value:_.value})}function Tve({pointerToProp:s,obj:l,propConfig:u,visualIndentation:m}){var _;let b=(_=u.label)!=null?_:dm((0,Ab.getPointerParts)(s).path),E=Object.entries(u.props),T=E.filter(([se,pe])=>_p(pe)),P=E.filter(([se,pe])=>!_p(pe)),[N,z]=Ai(null),G=hve(s,l,u),[V]=ml(z,{menuItems:G.contextMenuItems}),B=T.length>0,H=(0,Ya.useMemo)(()=>GM.getIsPropHighlightedD($(R({},l.address),{pathToProp:(0,Ab.getPointerParts)(s).path})),[s]),j="".concat(l.address.projectId,",").concat(l.address.sheetId,",").concat(l.address.sheetInstanceId,",").concat(l.address.objectKey,",").concat((0,Ab.getPointerParts)(s).path.join()),X=rJ(u);(0,Ya.useLayoutEffect)(()=>{WM.has(j)||WM.set(j,new Ab.Atom(X))},[j,u]);let K=WM.get(j),te=jr(()=>K?(0,GQ.val)(K.pointer):X,[K]);return Ya.default.createElement(HQ,null,V,Ya.default.createElement(mO,{style:{"--depth":m-1}},Ya.default.createElement(qQ,{isVectorProp:X},Ya.default.createElement(YQ,null,G.controlIndicators),Ya.default.createElement(ZQ,{isHighlighted:H,ref:N},Ya.default.createElement("span",null,b||"Props")),Ya.default.createElement(JQ,{isCollapsed:te,isVector:X,onClick:()=>{K==null||K.set(!K.get())}},Ya.default.createElement(aY,null))),X&&te&&Ya.default.createElement(sJ,null,[...E].map(([se,pe])=>Ya.default.createElement(Eve,{key:"prop-"+se,propConfig:pe,pointerToProp:s[se],obj:l})))),!te&&Ya.default.createElement(nJ,{style:{"--depth":m},depth:m,lastSubIsComposite:B},[...P,...T].map(([se,pe])=>Ya.default.createElement(yO,{key:"prop-"+se,propConfig:pe,pointerToProp:s[se],obj:l,visualIndentation:m+1}))))}var Ab,Ya,GQ,jQ,HQ,WQ,mO,$Q,qQ,XQ,YQ,KQ,ZQ,QQ,JQ,eJ,tJ,nJ,rJ,iJ,sJ,oJ,WM,Mve=k(()=>{I9(),Ab=mn(),Cy(),nu(),Ya=Q(qe()),Ft(),CZ(),B5(),Li(),Fi(),xJ(),gl(),fve(),hO(),VQ(),ZX(),pO(),er(),GQ=mn(),pv(),AM(),HQ=Te.div(jQ||(jQ=J([`
  --step: 15px;
  --left-pad: 15px;
  `,`;
  --right-width: 60%;
`])),Di),mO=Te.div(WQ||(WQ=J([`
  height: 30px;
  display: flex;
  align-items: stretch;
  position: relative;
`]))),qQ=Te.div($Q||($Q=J([`
  padding-left: `,`;
  display: flex;
  align-items: center;
  overflow: hidden;
  `,`;
`])),eO,({isVectorProp:s})=>s?"width: calc(100% - var(--right-width))":""),YQ=Te.div(XQ||(XQ=J([`
  flexshrink: 0;
`]))),ZQ=dO(Te.div(KQ||(KQ=J([`
  margin-left: 4px;
  cursor: default;
  height: 100%;
  display: flex;
  align-items: center;
  gap: 4px;
  user-select: none;
  &:hover {
    color: white;
  }
  overflow: hidden;

  `,`;
`])),()=>N9)),JQ=Te.span(QQ||(QQ=J([`
  width: 28px;
  height: 28px;
  font-size: 9px;
  display: flex;
  align-items: center;
  justify-content: center;

  transition: transform 0.05s ease-out, color 0.1s ease-out;
  transform: rotateZ(`,`deg);
  color: #66686a;

  visibility: `,`;

  `,`:hover & {
    visibility: visible;
  }

  &:hover {
    transform: rotateZ(`,`deg);
    color: #c0c4c9;
  }
`])),s=>s.isCollapsed?0:90,s=>!s.isVector&&s.isCollapsed||s.isVector&&!s.isCollapsed?"visible":"hidden",mO,s=>s.isCollapsed?15:75),eJ=Sd(.05,"#282b2f"),nJ=Te.div(tJ||(tJ=J([`
  /* background: `,`; */
  /* padding: `,` 0; */
`])),({depth:s})=>Yx(s*.03,eJ),s=>s.lastSubIsComposite?0:"4px"),rJ=gb(s=>{let l=Object.entries(s.props);return l.length<=3&&l.every(([u,m])=>m.type==="number"&&["x","y","z"].includes(u))}),sJ=Te.div(iJ||(iJ=J([`
  display: flex;
  align-items: center;
  justify-content: stretch;
  padding: 0 8px 0 2px;
  box-sizing: border-box;
  height: 100%;
  width: var(--right-width);
  flex-shrink: 0;
  flex-grow: 0;
`]))),oJ=Ya.default.memo(Tve),WM=new Map});function Cve({isHighlighted:s}){return s==="self"?"#1857a4":s==="descendent"?"#0a2f5c":"initial"}var Ave=k(()=>{});function Pve({propConfig:s,pointerToProp:l,editingTools:u,children:m,isPropHighlightedD:_}){var b;let E=(b=s.label)!=null?b:dm((0,gO.getPointerParts)(l).path),[T,P]=Ai(null),[N]=ml(P,{menuItems:u.contextMenuItems});return xv.default.createElement(lJ,{isHighlighted:_},N,xv.default.createElement(uJ,null,xv.default.createElement(pJ,null,u.controlIndicators),xv.default.createElement(dJ,{isHighlighted:_,ref:T,title:["obj","props",...(0,gO.getPointerParts)(l).path].join(".")},E)),xv.default.createElement(gJ,null,m))}var gO,xv,aJ,lJ,cJ,uJ,hJ,dJ,fJ,pJ,mJ,gJ,Rve=k(()=>{gO=mn(),gl(),Fi(),Fo(),xv=Q(qe()),Ft(),Li(),B5(),VQ(),CZ(),Ave(),lJ=dO(Te.div(aJ||(aJ=J([`
  display: flex;
  height: 30px;
  justify-content: flex-start;
  align-items: stretch;
  // We cannot calculate both the container (details panel) width and the descendant
  // (this) width dynamically. This leads to the container width being calculated
  // without this percentage being taken into consideration leads to horizontal
  // clipping/scrolling--the same way as if we explicitly fixed either the container
  // width, or the descendant width.
  // The correct solution for tabulated UIs with dynamic container widths is to use
  // CSS grid. For now I fixed this issue by just giving a great enough width
  // to the details panel so most things don't break.
  --right-width: 60%;
  position: relative;
  `,`;

  /* background-color: `,`; */
`])),Di,Cve)),uJ=Te.div(cJ||(cJ=J([`
  box-sizing: border-box;
  padding-left: `,`;
  padding-right: 4px;
  display: flex;
  flex-direction: row;
  justify-content: flex-start;
  align-items: stretch;
  gap: 4px;
  flex-grow: 0;
  flex-shrink: 0;
  width: calc(100% - var(--right-width));
`])),eO),dJ=dO(Te.div(hJ||(hJ=J([`
  text-align: left;
  flex: 1 0;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  display: flex;
  align-items: center;
  user-select: none;
  cursor: default;

  `,`;
  &:hover {
    color: white;
  }
`])),N9)),pJ=Te.div(fJ||(fJ=J([`
  flex-basis: 8px;
  flex: 0 0;
  display: flex;
  align-items: center;
`]))),gJ=Te.div(mJ||(mJ=J([`
  display: flex;
  align-items: center;
  justify-content: stretch;
  padding: 0 8px 0 2px;
  box-sizing: border-box;
  height: 100%;
  width: var(--right-width);
  flex-shrink: 0;
  flex-grow: 0;
`])))});function kve({propConfig:s,pointerToProp:l,obj:u,SimpleEditorComponent:m}){let _=fO(l,u,s),b=(0,Pb.useMemo)(()=>GM.getIsPropHighlightedD($(R({},u.address),{pathToProp:(0,yJ.getPointerParts)(l).path})),[l]);return Pb.default.createElement(Pve,{editingTools:_,propConfig:s,pointerToProp:l,isPropHighlightedD:b},Pb.default.createElement(m,{editingTools:_,propConfig:s,value:_.value}))}var Pb,yJ,vJ,Ive=k(()=>{Pb=Q(qe()),pO(),Rve(),yJ=mn(),hO(),vJ=Pb.default.memo(kve)}),Rb,_J,yO,xJ=k(()=>{Rb=Q(qe()),MZ(),Mve(),Ive(),_J=({propConfig:s,visualIndentation:l,pointerToProp:u,obj:m})=>{if(s.type==="compound")return Rb.default.createElement(oJ,{obj:m,visualIndentation:l,pointerToProp:u,propConfig:s});if(s.type==="enum")return Rb.default.createElement(Rb.default.Fragment,null);{let _=QD[s.type];return Rb.default.createElement(vJ,{SimpleEditorComponent:_,obj:m,visualIndentation:l,pointerToProp:u,propConfig:s})}},yO=_J});function bJ(s){return $M.has(s)||$M.set(s,(SJ++).toString()),$M.get(s)}var $M,SJ,wJ=k(()=>{$M=new WeakMap,SJ=0}),bv,EJ,TJ,MJ,CJ,AJ,PJ,Nve=k(()=>{bv=Q(qe()),xJ(),er(),wJ(),Ft(),TJ=Te.div(EJ||(EJ=J([`
  display: flex;
  flex-direction: column;
  gap: 4px;
  padding: 8px;
`]))),CJ=Te.button(MJ||(MJ=J([`
  display: flex;
  align-items: center;
  justify-content: center;
  outline: none;
  border-radius: 2px;

  color: #a8a8a9;
  background: rgba(255, 255, 255, 0.1);

  border: none;
  height: 28px;

  &:hover {
    background: rgba(255, 255, 255, 0.15);
  }

  &:active {
    background: rgba(255, 255, 255, 0.2);
  }
`]))),AJ=({objects:s})=>{let l=s[0],u=Xr(l.template.configPointer),m=Xr(l.template._temp_actionsPointer);return bv.default.createElement(bv.default.Fragment,null,bv.default.createElement(yO,{key:bJ(l),obj:l,pointerToProp:l.propsP,propConfig:u,visualIndentation:1}),bv.default.createElement(TJ,null,m&&Object.entries(m).map(([_,b])=>bv.default.createElement(CJ,{key:_,onClick:()=>{b(l.publicApi)}},_))))},PJ=AJ}),RJ,kJ,qM,IJ=k(()=>{Ft(),kJ=Te.button(RJ||(RJ=J([`
  text-align: center;
  padding: 8px;
  border-radius: 2px;
  border: 1px solid #627b7b87;
  background-color: #4b787d3d;
  color: #eaeaea;
  font-weight: 400;
  display: block;
  appearance: none;
  flex-grow: 1;
  cursor: `,`;
  opacity: `,`;

  &:hover {
    background-color: #7dc1c878;
    border-color: #9ebcbf;
  }
`])),s=>s.disabled?"none":"pointer",s=>s.disabled?.4:1),qM=kJ}),Dve=k(()=>{}),NJ,Ove=k(()=>{Dve(),NJ=(s=21)=>{let l="",u=crypto.getRandomValues(new Uint8Array(s));for(;s--;){let m=u[s]&63;m<36?l+=m.toString(36):m<62?l+=(m-26).toString(36).toUpperCase():m<63?l+="_":l+="-"}return l}});function DJ(){return NJ(16)}var OJ=k(()=>{Ove()}),FJ,Om,vO,LJ,BJ,UJ,zJ,VJ=k(()=>{FJ=mn(),Fi(),Om=Q(qe()),vO=(0,Om.createContext)(null),LJ=0,BJ=()=>{let s=(0,Om.useMemo)(()=>LJ++,[]),{cur:l,set:u}=(0,Om.useContext)(vO),[m,_]=Ai(!1),b=(0,Om.useCallback)((E,T)=>{u(E?s:-1,T)},[]);return(0,Om.useEffect)(()=>l.onStale(()=>{let E=l.getValue()===s;m.current!==E&&(m.current=E)}),[l,s]),[_,b]},UJ=({children:s})=>{let l=(0,Om.useMemo)(()=>new FJ.Atom(-1),[]),u=l.prism,m=(0,Om.useMemo)(()=>{let _;return(b,E)=>{let T=_!==void 0;_!==void 0&&(clearTimeout(_),_=void 0),E===0||T?l.set(b):_=setTimeout(()=>{l.set(b),_=void 0},E)}},[]);return Om.default.createElement(vO.Provider,{value:{cur:u,set:m}},s)},zJ=UJ});function Sv(s,l){let u=s.enabled!==!1,[m,_]=BJ(),[b,E]=Ai(null);(0,jJ.useEffect)(()=>{if(!u)return;let P=b.current;if(!P)return;let N=()=>{var G;return _(!0,(G=s.enterDelay)!=null?G:400)},z=()=>{var G;return _(!1,(G=s.exitDelay)!=null?G:200)};return P.addEventListener("mouseenter",N),P.addEventListener("mouseleave",z),()=>{P.removeEventListener("mouseenter",N),P.removeEventListener("mouseleave",z)}},[b,u,s.enterDelay,s.exitDelay]);let T=(0,GJ.useContext)(iv);return[u&&m&&E?(0,HJ.createPortal)(XM.default.createElement($D,{children:l,target:E,onClickOutside:wd,verticalPlacement:s.verticalPlacement,verticalGap:s.verticalGap}),T):XM.default.createElement(XM.default.Fragment,null),b,m]}var GJ,jJ,XM,HJ,kb=k(()=>{Fi(),GJ=Q(qe()),jJ=Q(qe()),XM=Q(qe()),AK(),HJ=Q(ua()),VJ(),O5(),av()}),WJ,$J,wv,YM=k(()=>{Ft(),yp(),$J=Te(gp)(WJ||(WJ=J([`
  padding: 1em;
  max-width: 240px;
  pointer-events: none !important;
  --popover-outer-stroke: transparent;
  --popover-inner-stroke: #45464d;
`]))),wv=$J}),xp,qJ,XJ,YJ,KJ,ZJ,QJ,JJ,eee,tee,Fve=k(()=>{er(),Ae(),xp=Q(qe()),Ft(),OJ(),kb(),YM(),IJ(),XJ=Te.div(qJ||(qJ=J([`
  padding: 8px 10px;
  position: relative;
  background-color: #6d232352;
  &:before {
    position: absolute;
    content: ' ';
    display: block;
    left: 0;
    top: 0;
    bottom: 0;
    width: 2px;
    background-color: #ff000070;
  }
`]))),KJ=Te.div(YJ||(YJ=J([`
  margin-bottom: 1em;
  & a {
    color: inherit;
  }
`]))),QJ=Te.div(ZJ||(ZJ=J([`
  display: flex;
  gap: 8px;
`]))),JJ=({projectId:s})=>{let l=Xr(Se().atomP.ephemeral.coreByProject[s].loadingState);return l&&l.type==="browserStateIsNotBasedOnDiskState"?xp.default.createElement(eee,{loadingState:l,projectId:s}):null},eee=({projectId:s,loadingState:l})=>{let u=()=>{Se().transaction(({drafts:P,stateEditors:N})=>{N.coreByProject.historic.revisionHistory.add({projectId:s,revision:l.onDiskState.revisionHistory[0]}),N.coreByProject.historic.revisionHistory.add({projectId:s,revision:DJ()}),P.ephemeral.coreByProject[s].loadingState={type:"loaded"}})},m=()=>{Se().transaction(({drafts:P})=>{P.historic.coreByProject[s]=l.onDiskState,P.ephemeral.coreByProject[s].loadingState={type:"loaded"}})},[_,b]=Sv({},()=>xp.default.createElement(wv,null,"The browser's state will override the disk state.")),[E,T]=Sv({},()=>xp.default.createElement(wv,null,"The disk's state will override the browser's state."));return xp.default.createElement(XJ,null,xp.default.createElement(KJ,null,"Browser state is not based on disk state."," ",xp.default.createElement("a",{href:"https://www.theatrejs.com/docs/latest/manual/projects#state",target:"_blank"},"Learn more.")),xp.default.createElement(QJ,null,_,xp.default.createElement(qM,{onClick:u,ref:b},"Use browser's state"),E,xp.default.createElement(qM,{onClick:m,ref:T},"Use disk state")))},tee=JJ}),Lve=ie((s,l)=>{(function(u){typeof s=="object"&&typeof l<"u"?l.exports=u():(typeof window<"u"?window:typeof vo<"u"?vo:typeof self<"u"?self:this).JSZip=u()})(function(){return function u(m,_,b){function E(N,z){if(!_[N]){if(!m[N]){var G=typeof jP=="function"&&jP;if(!z&&G)return G(N,!0);if(T)return T(N,!0);var V=new Error("Cannot find module '"+N+"'");throw V.code="MODULE_NOT_FOUND",V}var B=_[N]={exports:{}};m[N][0].call(B.exports,function(H){var j=m[N][1][H];return E(j||H)},B,B.exports,u,m,_,b)}return _[N].exports}for(var T=typeof jP=="function"&&jP,P=0;P<b.length;P++)E(b[P]);return E}({1:[function(u,m,_){var b=u("./utils"),E=u("./support"),T="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";_.encode=function(P){for(var N,z,G,V,B,H,j,X=[],K=0,te=P.length,se=te,pe=b.getTypeOf(P)!=="string";K<P.length;)se=te-K,G=pe?(N=P[K++],z=K<te?P[K++]:0,K<te?P[K++]:0):(N=P.charCodeAt(K++),z=K<te?P.charCodeAt(K++):0,K<te?P.charCodeAt(K++):0),V=N>>2,B=(3&N)<<4|z>>4,H=1<se?(15&z)<<2|G>>6:64,j=2<se?63&G:64,X.push(T.charAt(V)+T.charAt(B)+T.charAt(H)+T.charAt(j));return X.join("")},_.decode=function(P){var N,z,G,V,B,H,j=0,X=0,K="data:";if(P.substr(0,K.length)===K)throw new Error("Invalid base64 input, it looks like a data url.");var te,se=3*(P=P.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(P.charAt(P.length-1)===T.charAt(64)&&se--,P.charAt(P.length-2)===T.charAt(64)&&se--,se%1!=0)throw new Error("Invalid base64 input, bad content length.");for(te=E.uint8array?new Uint8Array(0|se):new Array(0|se);j<P.length;)N=T.indexOf(P.charAt(j++))<<2|(V=T.indexOf(P.charAt(j++)))>>4,z=(15&V)<<4|(B=T.indexOf(P.charAt(j++)))>>2,G=(3&B)<<6|(H=T.indexOf(P.charAt(j++))),te[X++]=N,B!==64&&(te[X++]=z),H!==64&&(te[X++]=G);return te}},{"./support":30,"./utils":32}],2:[function(u,m,_){var b=u("./external"),E=u("./stream/DataWorker"),T=u("./stream/Crc32Probe"),P=u("./stream/DataLengthProbe");function N(z,G,V,B,H){this.compressedSize=z,this.uncompressedSize=G,this.crc32=V,this.compression=B,this.compressedContent=H}N.prototype={getContentWorker:function(){var z=new E(b.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new P("data_length")),G=this;return z.on("end",function(){if(this.streamInfo.data_length!==G.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),z},getCompressedWorker:function(){return new E(b.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},N.createWorkerFrom=function(z,G,V){return z.pipe(new T).pipe(new P("uncompressedSize")).pipe(G.compressWorker(V)).pipe(new P("compressedSize")).withStreamInfo("compression",G)},m.exports=N},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(u,m,_){var b=u("./stream/GenericWorker");_.STORE={magic:"\0\0",compressWorker:function(){return new b("STORE compression")},uncompressWorker:function(){return new b("STORE decompression")}},_.DEFLATE=u("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(u,m,_){var b=u("./utils"),E=function(){for(var T,P=[],N=0;N<256;N++){T=N;for(var z=0;z<8;z++)T=1&T?3988292384^T>>>1:T>>>1;P[N]=T}return P}();m.exports=function(T,P){return T!==void 0&&T.length?b.getTypeOf(T)!=="string"?function(N,z,G,V){var B=E,H=V+G;N^=-1;for(var j=V;j<H;j++)N=N>>>8^B[255&(N^z[j])];return-1^N}(0|P,T,T.length,0):function(N,z,G,V){var B=E,H=V+G;N^=-1;for(var j=V;j<H;j++)N=N>>>8^B[255&(N^z.charCodeAt(j))];return-1^N}(0|P,T,T.length,0):0}},{"./utils":32}],5:[function(u,m,_){_.base64=!1,_.binary=!1,_.dir=!1,_.createFolders=!0,_.date=null,_.compression=null,_.compressionOptions=null,_.comment=null,_.unixPermissions=null,_.dosPermissions=null},{}],6:[function(u,m,_){var b=null;b=typeof Promise<"u"?Promise:u("lie"),m.exports={Promise:b}},{lie:37}],7:[function(u,m,_){var b=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",E=u("pako"),T=u("./utils"),P=u("./stream/GenericWorker"),N=b?"uint8array":"array";function z(G,V){P.call(this,"FlateWorker/"+G),this._pako=null,this._pakoAction=G,this._pakoOptions=V,this.meta={}}_.magic="\b\0",T.inherits(z,P),z.prototype.processChunk=function(G){this.meta=G.meta,this._pako===null&&this._createPako(),this._pako.push(T.transformTo(N,G.data),!1)},z.prototype.flush=function(){P.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},z.prototype.cleanUp=function(){P.prototype.cleanUp.call(this),this._pako=null},z.prototype._createPako=function(){this._pako=new E[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var G=this;this._pako.onData=function(V){G.push({data:V,meta:G.meta})}},_.compressWorker=function(G){return new z("Deflate",G)},_.uncompressWorker=function(){return new z("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(u,m,_){function b(B,H){var j,X="";for(j=0;j<H;j++)X+=String.fromCharCode(255&B),B>>>=8;return X}function E(B,H,j,X,K,te){var se,pe,fe=B.file,ve=B.compression,Ne=te!==N.utf8encode,ze=T.transformTo("string",te(fe.name)),Me=T.transformTo("string",N.utf8encode(fe.name)),He=fe.comment,vt=T.transformTo("string",te(He)),xe=T.transformTo("string",N.utf8encode(He)),We=Me.length!==fe.name.length,oe=xe.length!==He.length,nt="",dn="",Ve="",Be=fe.dir,ot=fe.date,Wt={crc32:0,compressedSize:0,uncompressedSize:0};H&&!j||(Wt.crc32=B.crc32,Wt.compressedSize=B.compressedSize,Wt.uncompressedSize=B.uncompressedSize);var be=0;H&&(be|=8),Ne||!We&&!oe||(be|=2048);var Ce=0,St=0;Be&&(Ce|=16),K==="UNIX"?(St=798,Ce|=function(kt,ct){var zn=kt;return kt||(zn=ct?16893:33204),(65535&zn)<<16}(fe.unixPermissions,Be)):(St=20,Ce|=function(kt){return 63&(kt||0)}(fe.dosPermissions)),se=ot.getUTCHours(),se<<=6,se|=ot.getUTCMinutes(),se<<=5,se|=ot.getUTCSeconds()/2,pe=ot.getUTCFullYear()-1980,pe<<=4,pe|=ot.getUTCMonth()+1,pe<<=5,pe|=ot.getUTCDate(),We&&(dn=b(1,1)+b(z(ze),4)+Me,nt+="up"+b(dn.length,2)+dn),oe&&(Ve=b(1,1)+b(z(vt),4)+xe,nt+="uc"+b(Ve.length,2)+Ve);var Mt="";return Mt+=`
\0`,Mt+=b(be,2),Mt+=ve.magic,Mt+=b(se,2),Mt+=b(pe,2),Mt+=b(Wt.crc32,4),Mt+=b(Wt.compressedSize,4),Mt+=b(Wt.uncompressedSize,4),Mt+=b(ze.length,2),Mt+=b(nt.length,2),{fileRecord:G.LOCAL_FILE_HEADER+Mt+ze+nt,dirRecord:G.CENTRAL_FILE_HEADER+b(St,2)+Mt+b(vt.length,2)+"\0\0\0\0"+b(Ce,4)+b(X,4)+ze+nt+vt}}var T=u("../utils"),P=u("../stream/GenericWorker"),N=u("../utf8"),z=u("../crc32"),G=u("../signature");function V(B,H,j,X){P.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=H,this.zipPlatform=j,this.encodeFileName=X,this.streamFiles=B,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}T.inherits(V,P),V.prototype.push=function(B){var H=B.meta.percent||0,j=this.entriesCount,X=this._sources.length;this.accumulate?this.contentBuffer.push(B):(this.bytesWritten+=B.data.length,P.prototype.push.call(this,{data:B.data,meta:{currentFile:this.currentFile,percent:j?(H+100*(j-X-1))/j:100}}))},V.prototype.openedSource=function(B){this.currentSourceOffset=this.bytesWritten,this.currentFile=B.file.name;var H=this.streamFiles&&!B.file.dir;if(H){var j=E(B,H,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:j.fileRecord,meta:{percent:0}})}else this.accumulate=!0},V.prototype.closedSource=function(B){this.accumulate=!1;var H=this.streamFiles&&!B.file.dir,j=E(B,H,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(j.dirRecord),H)this.push({data:function(X){return G.DATA_DESCRIPTOR+b(X.crc32,4)+b(X.compressedSize,4)+b(X.uncompressedSize,4)}(B),meta:{percent:100}});else for(this.push({data:j.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},V.prototype.flush=function(){for(var B=this.bytesWritten,H=0;H<this.dirRecords.length;H++)this.push({data:this.dirRecords[H],meta:{percent:100}});var j=this.bytesWritten-B,X=function(K,te,se,pe,fe){var ve=T.transformTo("string",fe(pe));return G.CENTRAL_DIRECTORY_END+"\0\0\0\0"+b(K,2)+b(K,2)+b(te,4)+b(se,4)+b(ve.length,2)+ve}(this.dirRecords.length,j,B,this.zipComment,this.encodeFileName);this.push({data:X,meta:{percent:100}})},V.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},V.prototype.registerPrevious=function(B){this._sources.push(B);var H=this;return B.on("data",function(j){H.processChunk(j)}),B.on("end",function(){H.closedSource(H.previous.streamInfo),H._sources.length?H.prepareNextSource():H.end()}),B.on("error",function(j){H.error(j)}),this},V.prototype.resume=function(){return!!P.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},V.prototype.error=function(B){var H=this._sources;if(!P.prototype.error.call(this,B))return!1;for(var j=0;j<H.length;j++)try{H[j].error(B)}catch{}return!0},V.prototype.lock=function(){P.prototype.lock.call(this);for(var B=this._sources,H=0;H<B.length;H++)B[H].lock()},m.exports=V},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(u,m,_){var b=u("../compressions"),E=u("./ZipFileWorker");_.generateWorker=function(T,P,N){var z=new E(P.streamFiles,N,P.platform,P.encodeFileName),G=0;try{T.forEach(function(V,B){G++;var H=function(te,se){var pe=te||se,fe=b[pe];if(!fe)throw new Error(pe+" is not a valid compression method !");return fe}(B.options.compression,P.compression),j=B.options.compressionOptions||P.compressionOptions||{},X=B.dir,K=B.date;B._compressWorker(H,j).withStreamInfo("file",{name:V,dir:X,date:K,comment:B.comment||"",unixPermissions:B.unixPermissions,dosPermissions:B.dosPermissions}).pipe(z)}),z.entriesCount=G}catch(V){z.error(V)}return z}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(u,m,_){function b(){if(!(this instanceof b))return new b;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var E=new b;for(var T in this)typeof this[T]!="function"&&(E[T]=this[T]);return E}}(b.prototype=u("./object")).loadAsync=u("./load"),b.support=u("./support"),b.defaults=u("./defaults"),b.version="3.10.1",b.loadAsync=function(E,T){return new b().loadAsync(E,T)},b.external=u("./external"),m.exports=b},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(u,m,_){var b=u("./utils"),E=u("./external"),T=u("./utf8"),P=u("./zipEntries"),N=u("./stream/Crc32Probe"),z=u("./nodejsUtils");function G(V){return new E.Promise(function(B,H){var j=V.decompressed.getContentWorker().pipe(new N);j.on("error",function(X){H(X)}).on("end",function(){j.streamInfo.crc32!==V.decompressed.crc32?H(new Error("Corrupted zip : CRC32 mismatch")):B()}).resume()})}m.exports=function(V,B){var H=this;return B=b.extend(B||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:T.utf8decode}),z.isNode&&z.isStream(V)?E.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):b.prepareContent("the loaded zip file",V,!0,B.optimizedBinaryString,B.base64).then(function(j){var X=new P(B);return X.load(j),X}).then(function(j){var X=[E.Promise.resolve(j)],K=j.files;if(B.checkCRC32)for(var te=0;te<K.length;te++)X.push(G(K[te]));return E.Promise.all(X)}).then(function(j){for(var X=j.shift(),K=X.files,te=0;te<K.length;te++){var se=K[te],pe=se.fileNameStr,fe=b.resolve(se.fileNameStr);H.file(fe,se.decompressed,{binary:!0,optimizedBinaryString:!0,date:se.date,dir:se.dir,comment:se.fileCommentStr.length?se.fileCommentStr:null,unixPermissions:se.unixPermissions,dosPermissions:se.dosPermissions,createFolders:B.createFolders}),se.dir||(H.file(fe).unsafeOriginalName=pe)}return X.zipComment.length&&(H.comment=X.zipComment),H})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(u,m,_){var b=u("../utils"),E=u("../stream/GenericWorker");function T(P,N){E.call(this,"Nodejs stream input adapter for "+P),this._upstreamEnded=!1,this._bindStream(N)}b.inherits(T,E),T.prototype._bindStream=function(P){var N=this;(this._stream=P).pause(),P.on("data",function(z){N.push({data:z,meta:{percent:0}})}).on("error",function(z){N.isPaused?this.generatedError=z:N.error(z)}).on("end",function(){N.isPaused?N._upstreamEnded=!0:N.end()})},T.prototype.pause=function(){return!!E.prototype.pause.call(this)&&(this._stream.pause(),!0)},T.prototype.resume=function(){return!!E.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},m.exports=T},{"../stream/GenericWorker":28,"../utils":32}],13:[function(u,m,_){var b=u("readable-stream").Readable;function E(T,P,N){b.call(this,P),this._helper=T;var z=this;T.on("data",function(G,V){z.push(G)||z._helper.pause(),N&&N(V)}).on("error",function(G){z.emit("error",G)}).on("end",function(){z.push(null)})}u("../utils").inherits(E,b),E.prototype._read=function(){this._helper.resume()},m.exports=E},{"../utils":32,"readable-stream":16}],14:[function(u,m,_){m.exports={isNode:typeof Buffer<"u",newBufferFrom:function(b,E){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(b,E);if(typeof b=="number")throw new Error('The "data" argument must not be a number');return new Buffer(b,E)},allocBuffer:function(b){if(Buffer.alloc)return Buffer.alloc(b);var E=new Buffer(b);return E.fill(0),E},isBuffer:function(b){return Buffer.isBuffer(b)},isStream:function(b){return b&&typeof b.on=="function"&&typeof b.pause=="function"&&typeof b.resume=="function"}}},{}],15:[function(u,m,_){function b(fe,ve,Ne){var ze,Me=T.getTypeOf(ve),He=T.extend(Ne||{},z);He.date=He.date||new Date,He.compression!==null&&(He.compression=He.compression.toUpperCase()),typeof He.unixPermissions=="string"&&(He.unixPermissions=parseInt(He.unixPermissions,8)),He.unixPermissions&&16384&He.unixPermissions&&(He.dir=!0),He.dosPermissions&&16&He.dosPermissions&&(He.dir=!0),He.dir&&(fe=K(fe)),He.createFolders&&(ze=X(fe))&&te.call(this,ze,!0);var vt=Me==="string"&&He.binary===!1&&He.base64===!1;Ne&&Ne.binary!==void 0||(He.binary=!vt),(ve instanceof G&&ve.uncompressedSize===0||He.dir||!ve||ve.length===0)&&(He.base64=!1,He.binary=!0,ve="",He.compression="STORE",Me="string");var xe=null;xe=ve instanceof G||ve instanceof P?ve:H.isNode&&H.isStream(ve)?new j(fe,ve):T.prepareContent(fe,ve,He.binary,He.optimizedBinaryString,He.base64);var We=new V(fe,xe,He);this.files[fe]=We}var E=u("./utf8"),T=u("./utils"),P=u("./stream/GenericWorker"),N=u("./stream/StreamHelper"),z=u("./defaults"),G=u("./compressedObject"),V=u("./zipObject"),B=u("./generate"),H=u("./nodejsUtils"),j=u("./nodejs/NodejsStreamInputAdapter"),X=function(fe){fe.slice(-1)==="/"&&(fe=fe.substring(0,fe.length-1));var ve=fe.lastIndexOf("/");return 0<ve?fe.substring(0,ve):""},K=function(fe){return fe.slice(-1)!=="/"&&(fe+="/"),fe},te=function(fe,ve){return ve=ve!==void 0?ve:z.createFolders,fe=K(fe),this.files[fe]||b.call(this,fe,null,{dir:!0,createFolders:ve}),this.files[fe]};function se(fe){return Object.prototype.toString.call(fe)==="[object RegExp]"}var pe={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(fe){var ve,Ne,ze;for(ve in this.files)ze=this.files[ve],(Ne=ve.slice(this.root.length,ve.length))&&ve.slice(0,this.root.length)===this.root&&fe(Ne,ze)},filter:function(fe){var ve=[];return this.forEach(function(Ne,ze){fe(Ne,ze)&&ve.push(ze)}),ve},file:function(fe,ve,Ne){if(arguments.length!==1)return fe=this.root+fe,b.call(this,fe,ve,Ne),this;if(se(fe)){var ze=fe;return this.filter(function(He,vt){return!vt.dir&&ze.test(He)})}var Me=this.files[this.root+fe];return Me&&!Me.dir?Me:null},folder:function(fe){if(!fe)return this;if(se(fe))return this.filter(function(Me,He){return He.dir&&fe.test(Me)});var ve=this.root+fe,Ne=te.call(this,ve),ze=this.clone();return ze.root=Ne.name,ze},remove:function(fe){fe=this.root+fe;var ve=this.files[fe];if(ve||(fe.slice(-1)!=="/"&&(fe+="/"),ve=this.files[fe]),ve&&!ve.dir)delete this.files[fe];else for(var Ne=this.filter(function(Me,He){return He.name.slice(0,fe.length)===fe}),ze=0;ze<Ne.length;ze++)delete this.files[Ne[ze].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(fe){var ve,Ne={};try{if((Ne=T.extend(fe||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:E.utf8encode})).type=Ne.type.toLowerCase(),Ne.compression=Ne.compression.toUpperCase(),Ne.type==="binarystring"&&(Ne.type="string"),!Ne.type)throw new Error("No output type specified.");T.checkSupport(Ne.type),Ne.platform!=="darwin"&&Ne.platform!=="freebsd"&&Ne.platform!=="linux"&&Ne.platform!=="sunos"||(Ne.platform="UNIX"),Ne.platform==="win32"&&(Ne.platform="DOS");var ze=Ne.comment||this.comment||"";ve=B.generateWorker(this,Ne,ze)}catch(Me){(ve=new P("error")).error(Me)}return new N(ve,Ne.type||"string",Ne.mimeType)},generateAsync:function(fe,ve){return this.generateInternalStream(fe).accumulate(ve)},generateNodeStream:function(fe,ve){return(fe=fe||{}).type||(fe.type="nodebuffer"),this.generateInternalStream(fe).toNodejsStream(ve)}};m.exports=pe},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(u,m,_){m.exports=u("stream")},{stream:void 0}],17:[function(u,m,_){var b=u("./DataReader");function E(T){b.call(this,T);for(var P=0;P<this.data.length;P++)T[P]=255&T[P]}u("../utils").inherits(E,b),E.prototype.byteAt=function(T){return this.data[this.zero+T]},E.prototype.lastIndexOfSignature=function(T){for(var P=T.charCodeAt(0),N=T.charCodeAt(1),z=T.charCodeAt(2),G=T.charCodeAt(3),V=this.length-4;0<=V;--V)if(this.data[V]===P&&this.data[V+1]===N&&this.data[V+2]===z&&this.data[V+3]===G)return V-this.zero;return-1},E.prototype.readAndCheckSignature=function(T){var P=T.charCodeAt(0),N=T.charCodeAt(1),z=T.charCodeAt(2),G=T.charCodeAt(3),V=this.readData(4);return P===V[0]&&N===V[1]&&z===V[2]&&G===V[3]},E.prototype.readData=function(T){if(this.checkOffset(T),T===0)return[];var P=this.data.slice(this.zero+this.index,this.zero+this.index+T);return this.index+=T,P},m.exports=E},{"../utils":32,"./DataReader":18}],18:[function(u,m,_){var b=u("../utils");function E(T){this.data=T,this.length=T.length,this.index=0,this.zero=0}E.prototype={checkOffset:function(T){this.checkIndex(this.index+T)},checkIndex:function(T){if(this.length<this.zero+T||T<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+T+"). Corrupted zip ?")},setIndex:function(T){this.checkIndex(T),this.index=T},skip:function(T){this.setIndex(this.index+T)},byteAt:function(){},readInt:function(T){var P,N=0;for(this.checkOffset(T),P=this.index+T-1;P>=this.index;P--)N=(N<<8)+this.byteAt(P);return this.index+=T,N},readString:function(T){return b.transformTo("string",this.readData(T))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var T=this.readInt(4);return new Date(Date.UTC(1980+(T>>25&127),(T>>21&15)-1,T>>16&31,T>>11&31,T>>5&63,(31&T)<<1))}},m.exports=E},{"../utils":32}],19:[function(u,m,_){var b=u("./Uint8ArrayReader");function E(T){b.call(this,T)}u("../utils").inherits(E,b),E.prototype.readData=function(T){this.checkOffset(T);var P=this.data.slice(this.zero+this.index,this.zero+this.index+T);return this.index+=T,P},m.exports=E},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(u,m,_){var b=u("./DataReader");function E(T){b.call(this,T)}u("../utils").inherits(E,b),E.prototype.byteAt=function(T){return this.data.charCodeAt(this.zero+T)},E.prototype.lastIndexOfSignature=function(T){return this.data.lastIndexOf(T)-this.zero},E.prototype.readAndCheckSignature=function(T){return T===this.readData(4)},E.prototype.readData=function(T){this.checkOffset(T);var P=this.data.slice(this.zero+this.index,this.zero+this.index+T);return this.index+=T,P},m.exports=E},{"../utils":32,"./DataReader":18}],21:[function(u,m,_){var b=u("./ArrayReader");function E(T){b.call(this,T)}u("../utils").inherits(E,b),E.prototype.readData=function(T){if(this.checkOffset(T),T===0)return new Uint8Array(0);var P=this.data.subarray(this.zero+this.index,this.zero+this.index+T);return this.index+=T,P},m.exports=E},{"../utils":32,"./ArrayReader":17}],22:[function(u,m,_){var b=u("../utils"),E=u("../support"),T=u("./ArrayReader"),P=u("./StringReader"),N=u("./NodeBufferReader"),z=u("./Uint8ArrayReader");m.exports=function(G){var V=b.getTypeOf(G);return b.checkSupport(V),V!=="string"||E.uint8array?V==="nodebuffer"?new N(G):E.uint8array?new z(b.transformTo("uint8array",G)):new T(b.transformTo("array",G)):new P(G)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(u,m,_){_.LOCAL_FILE_HEADER="PK",_.CENTRAL_FILE_HEADER="PK",_.CENTRAL_DIRECTORY_END="PK",_.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",_.ZIP64_CENTRAL_DIRECTORY_END="PK",_.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(u,m,_){var b=u("./GenericWorker"),E=u("../utils");function T(P){b.call(this,"ConvertWorker to "+P),this.destType=P}E.inherits(T,b),T.prototype.processChunk=function(P){this.push({data:E.transformTo(this.destType,P.data),meta:P.meta})},m.exports=T},{"../utils":32,"./GenericWorker":28}],25:[function(u,m,_){var b=u("./GenericWorker"),E=u("../crc32");function T(){b.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}u("../utils").inherits(T,b),T.prototype.processChunk=function(P){this.streamInfo.crc32=E(P.data,this.streamInfo.crc32||0),this.push(P)},m.exports=T},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(u,m,_){var b=u("../utils"),E=u("./GenericWorker");function T(P){E.call(this,"DataLengthProbe for "+P),this.propName=P,this.withStreamInfo(P,0)}b.inherits(T,E),T.prototype.processChunk=function(P){if(P){var N=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=N+P.data.length}E.prototype.processChunk.call(this,P)},m.exports=T},{"../utils":32,"./GenericWorker":28}],27:[function(u,m,_){var b=u("../utils"),E=u("./GenericWorker");function T(P){E.call(this,"DataWorker");var N=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,P.then(function(z){N.dataIsReady=!0,N.data=z,N.max=z&&z.length||0,N.type=b.getTypeOf(z),N.isPaused||N._tickAndRepeat()},function(z){N.error(z)})}b.inherits(T,E),T.prototype.cleanUp=function(){E.prototype.cleanUp.call(this),this.data=null},T.prototype.resume=function(){return!!E.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,b.delay(this._tickAndRepeat,[],this)),!0)},T.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(b.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},T.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var P=null,N=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":P=this.data.substring(this.index,N);break;case"uint8array":P=this.data.subarray(this.index,N);break;case"array":case"nodebuffer":P=this.data.slice(this.index,N)}return this.index=N,this.push({data:P,meta:{percent:this.max?this.index/this.max*100:0}})},m.exports=T},{"../utils":32,"./GenericWorker":28}],28:[function(u,m,_){function b(E){this.name=E||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}b.prototype={push:function(E){this.emit("data",E)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(E){this.emit("error",E)}return!0},error:function(E){return!this.isFinished&&(this.isPaused?this.generatedError=E:(this.isFinished=!0,this.emit("error",E),this.previous&&this.previous.error(E),this.cleanUp()),!0)},on:function(E,T){return this._listeners[E].push(T),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(E,T){if(this._listeners[E])for(var P=0;P<this._listeners[E].length;P++)this._listeners[E][P].call(this,T)},pipe:function(E){return E.registerPrevious(this)},registerPrevious:function(E){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=E.streamInfo,this.mergeStreamInfo(),this.previous=E;var T=this;return E.on("data",function(P){T.processChunk(P)}),E.on("end",function(){T.end()}),E.on("error",function(P){T.error(P)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var E=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),E=!0),this.previous&&this.previous.resume(),!E},flush:function(){},processChunk:function(E){this.push(E)},withStreamInfo:function(E,T){return this.extraStreamInfo[E]=T,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var E in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,E)&&(this.streamInfo[E]=this.extraStreamInfo[E])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var E="Worker "+this.name;return this.previous?this.previous+" -> "+E:E}},m.exports=b},{}],29:[function(u,m,_){var b=u("../utils"),E=u("./ConvertWorker"),T=u("./GenericWorker"),P=u("../base64"),N=u("../support"),z=u("../external"),G=null;if(N.nodestream)try{G=u("../nodejs/NodejsStreamOutputAdapter")}catch{}function V(H,j){return new z.Promise(function(X,K){var te=[],se=H._internalType,pe=H._outputType,fe=H._mimeType;H.on("data",function(ve,Ne){te.push(ve),j&&j(Ne)}).on("error",function(ve){te=[],K(ve)}).on("end",function(){try{var ve=function(Ne,ze,Me){switch(Ne){case"blob":return b.newBlob(b.transformTo("arraybuffer",ze),Me);case"base64":return P.encode(ze);default:return b.transformTo(Ne,ze)}}(pe,function(Ne,ze){var Me,He=0,vt=null,xe=0;for(Me=0;Me<ze.length;Me++)xe+=ze[Me].length;switch(Ne){case"string":return ze.join("");case"array":return Array.prototype.concat.apply([],ze);case"uint8array":for(vt=new Uint8Array(xe),Me=0;Me<ze.length;Me++)vt.set(ze[Me],He),He+=ze[Me].length;return vt;case"nodebuffer":return Buffer.concat(ze);default:throw new Error("concat : unsupported type '"+Ne+"'")}}(se,te),fe);X(ve)}catch(Ne){K(Ne)}te=[]}).resume()})}function B(H,j,X){var K=j;switch(j){case"blob":case"arraybuffer":K="uint8array";break;case"base64":K="string"}try{this._internalType=K,this._outputType=j,this._mimeType=X,b.checkSupport(K),this._worker=H.pipe(new E(K)),H.lock()}catch(te){this._worker=new T("error"),this._worker.error(te)}}B.prototype={accumulate:function(H){return V(this,H)},on:function(H,j){var X=this;return H==="data"?this._worker.on(H,function(K){j.call(X,K.data,K.meta)}):this._worker.on(H,function(){b.delay(j,arguments,X)}),this},resume:function(){return b.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(H){if(b.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new G(this,{objectMode:this._outputType!=="nodebuffer"},H)}},m.exports=B},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(u,m,_){if(_.base64=!0,_.array=!0,_.string=!0,_.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",_.nodebuffer=typeof Buffer<"u",_.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")_.blob=!1;else{var b=new ArrayBuffer(0);try{_.blob=new Blob([b],{type:"application/zip"}).size===0}catch{try{var E=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);E.append(b),_.blob=E.getBlob("application/zip").size===0}catch{_.blob=!1}}}try{_.nodestream=!!u("readable-stream").Readable}catch{_.nodestream=!1}},{"readable-stream":16}],31:[function(u,m,_){for(var b=u("./utils"),E=u("./support"),T=u("./nodejsUtils"),P=u("./stream/GenericWorker"),N=new Array(256),z=0;z<256;z++)N[z]=252<=z?6:248<=z?5:240<=z?4:224<=z?3:192<=z?2:1;N[254]=N[254]=1;function G(){P.call(this,"utf-8 decode"),this.leftOver=null}function V(){P.call(this,"utf-8 encode")}_.utf8encode=function(B){return E.nodebuffer?T.newBufferFrom(B,"utf-8"):function(H){var j,X,K,te,se,pe=H.length,fe=0;for(te=0;te<pe;te++)(64512&(X=H.charCodeAt(te)))==55296&&te+1<pe&&(64512&(K=H.charCodeAt(te+1)))==56320&&(X=65536+(X-55296<<10)+(K-56320),te++),fe+=X<128?1:X<2048?2:X<65536?3:4;for(j=E.uint8array?new Uint8Array(fe):new Array(fe),te=se=0;se<fe;te++)(64512&(X=H.charCodeAt(te)))==55296&&te+1<pe&&(64512&(K=H.charCodeAt(te+1)))==56320&&(X=65536+(X-55296<<10)+(K-56320),te++),X<128?j[se++]=X:(X<2048?j[se++]=192|X>>>6:(X<65536?j[se++]=224|X>>>12:(j[se++]=240|X>>>18,j[se++]=128|X>>>12&63),j[se++]=128|X>>>6&63),j[se++]=128|63&X);return j}(B)},_.utf8decode=function(B){return E.nodebuffer?b.transformTo("nodebuffer",B).toString("utf-8"):function(H){var j,X,K,te,se=H.length,pe=new Array(2*se);for(j=X=0;j<se;)if((K=H[j++])<128)pe[X++]=K;else if(4<(te=N[K]))pe[X++]=65533,j+=te-1;else{for(K&=te===2?31:te===3?15:7;1<te&&j<se;)K=K<<6|63&H[j++],te--;1<te?pe[X++]=65533:K<65536?pe[X++]=K:(K-=65536,pe[X++]=55296|K>>10&1023,pe[X++]=56320|1023&K)}return pe.length!==X&&(pe.subarray?pe=pe.subarray(0,X):pe.length=X),b.applyFromCharCode(pe)}(B=b.transformTo(E.uint8array?"uint8array":"array",B))},b.inherits(G,P),G.prototype.processChunk=function(B){var H=b.transformTo(E.uint8array?"uint8array":"array",B.data);if(this.leftOver&&this.leftOver.length){if(E.uint8array){var j=H;(H=new Uint8Array(j.length+this.leftOver.length)).set(this.leftOver,0),H.set(j,this.leftOver.length)}else H=this.leftOver.concat(H);this.leftOver=null}var X=function(te,se){var pe;for((se=se||te.length)>te.length&&(se=te.length),pe=se-1;0<=pe&&(192&te[pe])==128;)pe--;return pe<0||pe===0?se:pe+N[te[pe]]>se?pe:se}(H),K=H;X!==H.length&&(E.uint8array?(K=H.subarray(0,X),this.leftOver=H.subarray(X,H.length)):(K=H.slice(0,X),this.leftOver=H.slice(X,H.length))),this.push({data:_.utf8decode(K),meta:B.meta})},G.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:_.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},_.Utf8DecodeWorker=G,b.inherits(V,P),V.prototype.processChunk=function(B){this.push({data:_.utf8encode(B.data),meta:B.meta})},_.Utf8EncodeWorker=V},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(u,m,_){var b=u("./support"),E=u("./base64"),T=u("./nodejsUtils"),P=u("./external");function N(j){return j}function z(j,X){for(var K=0;K<j.length;++K)X[K]=255&j.charCodeAt(K);return X}u("setimmediate"),_.newBlob=function(j,X){_.checkSupport("blob");try{return new Blob([j],{type:X})}catch{try{var K=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return K.append(j),K.getBlob(X)}catch{throw new Error("Bug : can't construct the Blob.")}}};var G={stringifyByChunk:function(j,X,K){var te=[],se=0,pe=j.length;if(pe<=K)return String.fromCharCode.apply(null,j);for(;se<pe;)X==="array"||X==="nodebuffer"?te.push(String.fromCharCode.apply(null,j.slice(se,Math.min(se+K,pe)))):te.push(String.fromCharCode.apply(null,j.subarray(se,Math.min(se+K,pe)))),se+=K;return te.join("")},stringifyByChar:function(j){for(var X="",K=0;K<j.length;K++)X+=String.fromCharCode(j[K]);return X},applyCanBeUsed:{uint8array:function(){try{return b.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return b.nodebuffer&&String.fromCharCode.apply(null,T.allocBuffer(1)).length===1}catch{return!1}}()}};function V(j){var X=65536,K=_.getTypeOf(j),te=!0;if(K==="uint8array"?te=G.applyCanBeUsed.uint8array:K==="nodebuffer"&&(te=G.applyCanBeUsed.nodebuffer),te)for(;1<X;)try{return G.stringifyByChunk(j,K,X)}catch{X=Math.floor(X/2)}return G.stringifyByChar(j)}function B(j,X){for(var K=0;K<j.length;K++)X[K]=j[K];return X}_.applyFromCharCode=V;var H={};H.string={string:N,array:function(j){return z(j,new Array(j.length))},arraybuffer:function(j){return H.string.uint8array(j).buffer},uint8array:function(j){return z(j,new Uint8Array(j.length))},nodebuffer:function(j){return z(j,T.allocBuffer(j.length))}},H.array={string:V,array:N,arraybuffer:function(j){return new Uint8Array(j).buffer},uint8array:function(j){return new Uint8Array(j)},nodebuffer:function(j){return T.newBufferFrom(j)}},H.arraybuffer={string:function(j){return V(new Uint8Array(j))},array:function(j){return B(new Uint8Array(j),new Array(j.byteLength))},arraybuffer:N,uint8array:function(j){return new Uint8Array(j)},nodebuffer:function(j){return T.newBufferFrom(new Uint8Array(j))}},H.uint8array={string:V,array:function(j){return B(j,new Array(j.length))},arraybuffer:function(j){return j.buffer},uint8array:N,nodebuffer:function(j){return T.newBufferFrom(j)}},H.nodebuffer={string:V,array:function(j){return B(j,new Array(j.length))},arraybuffer:function(j){return H.nodebuffer.uint8array(j).buffer},uint8array:function(j){return B(j,new Uint8Array(j.length))},nodebuffer:N},_.transformTo=function(j,X){if(X=X||"",!j)return X;_.checkSupport(j);var K=_.getTypeOf(X);return H[K][j](X)},_.resolve=function(j){for(var X=j.split("/"),K=[],te=0;te<X.length;te++){var se=X[te];se==="."||se===""&&te!==0&&te!==X.length-1||(se===".."?K.pop():K.push(se))}return K.join("/")},_.getTypeOf=function(j){return typeof j=="string"?"string":Object.prototype.toString.call(j)==="[object Array]"?"array":b.nodebuffer&&T.isBuffer(j)?"nodebuffer":b.uint8array&&j instanceof Uint8Array?"uint8array":b.arraybuffer&&j instanceof ArrayBuffer?"arraybuffer":void 0},_.checkSupport=function(j){if(!b[j.toLowerCase()])throw new Error(j+" is not supported by this platform")},_.MAX_VALUE_16BITS=65535,_.MAX_VALUE_32BITS=-1,_.pretty=function(j){var X,K,te="";for(K=0;K<(j||"").length;K++)te+="\\x"+((X=j.charCodeAt(K))<16?"0":"")+X.toString(16).toUpperCase();return te},_.delay=function(j,X,K){setImmediate(function(){j.apply(K||null,X||[])})},_.inherits=function(j,X){function K(){}K.prototype=X.prototype,j.prototype=new K},_.extend=function(){var j,X,K={};for(j=0;j<arguments.length;j++)for(X in arguments[j])Object.prototype.hasOwnProperty.call(arguments[j],X)&&K[X]===void 0&&(K[X]=arguments[j][X]);return K},_.prepareContent=function(j,X,K,te,se){return P.Promise.resolve(X).then(function(pe){return b.blob&&(pe instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(pe))!==-1)&&typeof FileReader<"u"?new P.Promise(function(fe,ve){var Ne=new FileReader;Ne.onload=function(ze){fe(ze.target.result)},Ne.onerror=function(ze){ve(ze.target.error)},Ne.readAsArrayBuffer(pe)}):pe}).then(function(pe){var fe=_.getTypeOf(pe);return fe?(fe==="arraybuffer"?pe=_.transformTo("uint8array",pe):fe==="string"&&(se?pe=E.decode(pe):K&&te!==!0&&(pe=function(ve){return z(ve,b.uint8array?new Uint8Array(ve.length):new Array(ve.length))}(pe))),pe):P.Promise.reject(new Error("Can't read the data of '"+j+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(u,m,_){var b=u("./reader/readerFor"),E=u("./utils"),T=u("./signature"),P=u("./zipEntry"),N=u("./support");function z(G){this.files=[],this.loadOptions=G}z.prototype={checkSignature:function(G){if(!this.reader.readAndCheckSignature(G)){this.reader.index-=4;var V=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+E.pretty(V)+", expected "+E.pretty(G)+")")}},isSignature:function(G,V){var B=this.reader.index;this.reader.setIndex(G);var H=this.reader.readString(4)===V;return this.reader.setIndex(B),H},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var G=this.reader.readData(this.zipCommentLength),V=N.uint8array?"uint8array":"array",B=E.transformTo(V,G);this.zipComment=this.loadOptions.decodeFileName(B)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var G,V,B,H=this.zip64EndOfCentralSize-44;0<H;)G=this.reader.readInt(2),V=this.reader.readInt(4),B=this.reader.readData(V),this.zip64ExtensibleData[G]={id:G,length:V,value:B}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var G,V;for(G=0;G<this.files.length;G++)V=this.files[G],this.reader.setIndex(V.localHeaderOffset),this.checkSignature(T.LOCAL_FILE_HEADER),V.readLocalPart(this.reader),V.handleUTF8(),V.processAttributes()},readCentralDir:function(){var G;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(T.CENTRAL_FILE_HEADER);)(G=new P({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(G);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var G=this.reader.lastIndexOfSignature(T.CENTRAL_DIRECTORY_END);if(G<0)throw this.isSignature(0,T.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(G);var V=G;if(this.checkSignature(T.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===E.MAX_VALUE_16BITS||this.diskWithCentralDirStart===E.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===E.MAX_VALUE_16BITS||this.centralDirRecords===E.MAX_VALUE_16BITS||this.centralDirSize===E.MAX_VALUE_32BITS||this.centralDirOffset===E.MAX_VALUE_32BITS){if(this.zip64=!0,(G=this.reader.lastIndexOfSignature(T.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(G),this.checkSignature(T.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,T.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(T.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(T.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var B=this.centralDirOffset+this.centralDirSize;this.zip64&&(B+=20,B+=12+this.zip64EndOfCentralSize);var H=V-B;if(0<H)this.isSignature(V,T.CENTRAL_FILE_HEADER)||(this.reader.zero=H);else if(H<0)throw new Error("Corrupted zip: missing "+Math.abs(H)+" bytes.")},prepareReader:function(G){this.reader=b(G)},load:function(G){this.prepareReader(G),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},m.exports=z},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(u,m,_){var b=u("./reader/readerFor"),E=u("./utils"),T=u("./compressedObject"),P=u("./crc32"),N=u("./utf8"),z=u("./compressions"),G=u("./support");function V(B,H){this.options=B,this.loadOptions=H}V.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(B){var H,j;if(B.skip(22),this.fileNameLength=B.readInt(2),j=B.readInt(2),this.fileName=B.readData(this.fileNameLength),B.skip(j),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((H=function(X){for(var K in z)if(Object.prototype.hasOwnProperty.call(z,K)&&z[K].magic===X)return z[K];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+E.pretty(this.compressionMethod)+" unknown (inner file : "+E.transformTo("string",this.fileName)+")");this.decompressed=new T(this.compressedSize,this.uncompressedSize,this.crc32,H,B.readData(this.compressedSize))},readCentralPart:function(B){this.versionMadeBy=B.readInt(2),B.skip(2),this.bitFlag=B.readInt(2),this.compressionMethod=B.readString(2),this.date=B.readDate(),this.crc32=B.readInt(4),this.compressedSize=B.readInt(4),this.uncompressedSize=B.readInt(4);var H=B.readInt(2);if(this.extraFieldsLength=B.readInt(2),this.fileCommentLength=B.readInt(2),this.diskNumberStart=B.readInt(2),this.internalFileAttributes=B.readInt(2),this.externalFileAttributes=B.readInt(4),this.localHeaderOffset=B.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");B.skip(H),this.readExtraFields(B),this.parseZIP64ExtraField(B),this.fileComment=B.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var B=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),B==0&&(this.dosPermissions=63&this.externalFileAttributes),B==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var B=b(this.extraFields[1].value);this.uncompressedSize===E.MAX_VALUE_32BITS&&(this.uncompressedSize=B.readInt(8)),this.compressedSize===E.MAX_VALUE_32BITS&&(this.compressedSize=B.readInt(8)),this.localHeaderOffset===E.MAX_VALUE_32BITS&&(this.localHeaderOffset=B.readInt(8)),this.diskNumberStart===E.MAX_VALUE_32BITS&&(this.diskNumberStart=B.readInt(4))}},readExtraFields:function(B){var H,j,X,K=B.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});B.index+4<K;)H=B.readInt(2),j=B.readInt(2),X=B.readData(j),this.extraFields[H]={id:H,length:j,value:X};B.setIndex(K)},handleUTF8:function(){var B=G.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=N.utf8decode(this.fileName),this.fileCommentStr=N.utf8decode(this.fileComment);else{var H=this.findExtraFieldUnicodePath();if(H!==null)this.fileNameStr=H;else{var j=E.transformTo(B,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(j)}var X=this.findExtraFieldUnicodeComment();if(X!==null)this.fileCommentStr=X;else{var K=E.transformTo(B,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(K)}}},findExtraFieldUnicodePath:function(){var B=this.extraFields[28789];if(B){var H=b(B.value);return H.readInt(1)!==1||P(this.fileName)!==H.readInt(4)?null:N.utf8decode(H.readData(B.length-5))}return null},findExtraFieldUnicodeComment:function(){var B=this.extraFields[25461];if(B){var H=b(B.value);return H.readInt(1)!==1||P(this.fileComment)!==H.readInt(4)?null:N.utf8decode(H.readData(B.length-5))}return null}},m.exports=V},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(u,m,_){function b(H,j,X){this.name=H,this.dir=X.dir,this.date=X.date,this.comment=X.comment,this.unixPermissions=X.unixPermissions,this.dosPermissions=X.dosPermissions,this._data=j,this._dataBinary=X.binary,this.options={compression:X.compression,compressionOptions:X.compressionOptions}}var E=u("./stream/StreamHelper"),T=u("./stream/DataWorker"),P=u("./utf8"),N=u("./compressedObject"),z=u("./stream/GenericWorker");b.prototype={internalStream:function(H){var j=null,X="string";try{if(!H)throw new Error("No output type specified.");var K=(X=H.toLowerCase())==="string"||X==="text";X!=="binarystring"&&X!=="text"||(X="string"),j=this._decompressWorker();var te=!this._dataBinary;te&&!K&&(j=j.pipe(new P.Utf8EncodeWorker)),!te&&K&&(j=j.pipe(new P.Utf8DecodeWorker))}catch(se){(j=new z("error")).error(se)}return new E(j,X,"")},async:function(H,j){return this.internalStream(H).accumulate(j)},nodeStream:function(H,j){return this.internalStream(H||"nodebuffer").toNodejsStream(j)},_compressWorker:function(H,j){if(this._data instanceof N&&this._data.compression.magic===H.magic)return this._data.getCompressedWorker();var X=this._decompressWorker();return this._dataBinary||(X=X.pipe(new P.Utf8EncodeWorker)),N.createWorkerFrom(X,H,j)},_decompressWorker:function(){return this._data instanceof N?this._data.getContentWorker():this._data instanceof z?this._data:new T(this._data)}};for(var G=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],V=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},B=0;B<G.length;B++)b.prototype[G[B]]=V;m.exports=b},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(u,m,_){(function(b){var E,T,P=b.MutationObserver||b.WebKitMutationObserver;if(P){var N=0,z=new P(H),G=b.document.createTextNode("");z.observe(G,{characterData:!0}),E=function(){G.data=N=++N%2}}else if(b.setImmediate||b.MessageChannel===void 0)E="document"in b&&"onreadystatechange"in b.document.createElement("script")?function(){var j=b.document.createElement("script");j.onreadystatechange=function(){H(),j.onreadystatechange=null,j.parentNode.removeChild(j),j=null},b.document.documentElement.appendChild(j)}:function(){setTimeout(H,0)};else{var V=new b.MessageChannel;V.port1.onmessage=H,E=function(){V.port2.postMessage(0)}}var B=[];function H(){var j,X;T=!0;for(var K=B.length;K;){for(X=B,B=[],j=-1;++j<K;)X[j]();K=B.length}T=!1}m.exports=function(j){B.push(j)!==1||T||E()}}).call(this,typeof vo<"u"?vo:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(u,m,_){var b=u("immediate");function E(){}var T={},P=["REJECTED"],N=["FULFILLED"],z=["PENDING"];function G(K){if(typeof K!="function")throw new TypeError("resolver must be a function");this.state=z,this.queue=[],this.outcome=void 0,K!==E&&j(this,K)}function V(K,te,se){this.promise=K,typeof te=="function"&&(this.onFulfilled=te,this.callFulfilled=this.otherCallFulfilled),typeof se=="function"&&(this.onRejected=se,this.callRejected=this.otherCallRejected)}function B(K,te,se){b(function(){var pe;try{pe=te(se)}catch(fe){return T.reject(K,fe)}pe===K?T.reject(K,new TypeError("Cannot resolve promise with itself")):T.resolve(K,pe)})}function H(K){var te=K&&K.then;if(K&&(typeof K=="object"||typeof K=="function")&&typeof te=="function")return function(){te.apply(K,arguments)}}function j(K,te){var se=!1;function pe(Ne){se||(se=!0,T.reject(K,Ne))}function fe(Ne){se||(se=!0,T.resolve(K,Ne))}var ve=X(function(){te(fe,pe)});ve.status==="error"&&pe(ve.value)}function X(K,te){var se={};try{se.value=K(te),se.status="success"}catch(pe){se.status="error",se.value=pe}return se}(m.exports=G).prototype.finally=function(K){if(typeof K!="function")return this;var te=this.constructor;return this.then(function(se){return te.resolve(K()).then(function(){return se})},function(se){return te.resolve(K()).then(function(){throw se})})},G.prototype.catch=function(K){return this.then(null,K)},G.prototype.then=function(K,te){if(typeof K!="function"&&this.state===N||typeof te!="function"&&this.state===P)return this;var se=new this.constructor(E);return this.state!==z?B(se,this.state===N?K:te,this.outcome):this.queue.push(new V(se,K,te)),se},V.prototype.callFulfilled=function(K){T.resolve(this.promise,K)},V.prototype.otherCallFulfilled=function(K){B(this.promise,this.onFulfilled,K)},V.prototype.callRejected=function(K){T.reject(this.promise,K)},V.prototype.otherCallRejected=function(K){B(this.promise,this.onRejected,K)},T.resolve=function(K,te){var se=X(H,te);if(se.status==="error")return T.reject(K,se.value);var pe=se.value;if(pe)j(K,pe);else{K.state=N,K.outcome=te;for(var fe=-1,ve=K.queue.length;++fe<ve;)K.queue[fe].callFulfilled(te)}return K},T.reject=function(K,te){K.state=P,K.outcome=te;for(var se=-1,pe=K.queue.length;++se<pe;)K.queue[se].callRejected(te);return K},G.resolve=function(K){return K instanceof this?K:T.resolve(new this(E),K)},G.reject=function(K){var te=new this(E);return T.reject(te,K)},G.all=function(K){var te=this;if(Object.prototype.toString.call(K)!=="[object Array]")return this.reject(new TypeError("must be an array"));var se=K.length,pe=!1;if(!se)return this.resolve([]);for(var fe=new Array(se),ve=0,Ne=-1,ze=new this(E);++Ne<se;)Me(K[Ne],Ne);return ze;function Me(He,vt){te.resolve(He).then(function(xe){fe[vt]=xe,++ve!==se||pe||(pe=!0,T.resolve(ze,fe))},function(xe){pe||(pe=!0,T.reject(ze,xe))})}},G.race=function(K){var te=this;if(Object.prototype.toString.call(K)!=="[object Array]")return this.reject(new TypeError("must be an array"));var se=K.length,pe=!1;if(!se)return this.resolve([]);for(var fe=-1,ve=new this(E);++fe<se;)Ne=K[fe],te.resolve(Ne).then(function(ze){pe||(pe=!0,T.resolve(ve,ze))},function(ze){pe||(pe=!0,T.reject(ve,ze))});var Ne;return ve}},{immediate:36}],38:[function(u,m,_){var b={};(0,u("./lib/utils/common").assign)(b,u("./lib/deflate"),u("./lib/inflate"),u("./lib/zlib/constants")),m.exports=b},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(u,m,_){var b=u("./zlib/deflate"),E=u("./utils/common"),T=u("./utils/strings"),P=u("./zlib/messages"),N=u("./zlib/zstream"),z=Object.prototype.toString,G=0,V=-1,B=0,H=8;function j(K){if(!(this instanceof j))return new j(K);this.options=E.assign({level:V,method:H,chunkSize:16384,windowBits:15,memLevel:8,strategy:B,to:""},K||{});var te=this.options;te.raw&&0<te.windowBits?te.windowBits=-te.windowBits:te.gzip&&0<te.windowBits&&te.windowBits<16&&(te.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new N,this.strm.avail_out=0;var se=b.deflateInit2(this.strm,te.level,te.method,te.windowBits,te.memLevel,te.strategy);if(se!==G)throw new Error(P[se]);if(te.header&&b.deflateSetHeader(this.strm,te.header),te.dictionary){var pe;if(pe=typeof te.dictionary=="string"?T.string2buf(te.dictionary):z.call(te.dictionary)==="[object ArrayBuffer]"?new Uint8Array(te.dictionary):te.dictionary,(se=b.deflateSetDictionary(this.strm,pe))!==G)throw new Error(P[se]);this._dict_set=!0}}function X(K,te){var se=new j(te);if(se.push(K,!0),se.err)throw se.msg||P[se.err];return se.result}j.prototype.push=function(K,te){var se,pe,fe=this.strm,ve=this.options.chunkSize;if(this.ended)return!1;pe=te===~~te?te:te===!0?4:0,typeof K=="string"?fe.input=T.string2buf(K):z.call(K)==="[object ArrayBuffer]"?fe.input=new Uint8Array(K):fe.input=K,fe.next_in=0,fe.avail_in=fe.input.length;do{if(fe.avail_out===0&&(fe.output=new E.Buf8(ve),fe.next_out=0,fe.avail_out=ve),(se=b.deflate(fe,pe))!==1&&se!==G)return this.onEnd(se),!(this.ended=!0);fe.avail_out!==0&&(fe.avail_in!==0||pe!==4&&pe!==2)||(this.options.to==="string"?this.onData(T.buf2binstring(E.shrinkBuf(fe.output,fe.next_out))):this.onData(E.shrinkBuf(fe.output,fe.next_out)))}while((0<fe.avail_in||fe.avail_out===0)&&se!==1);return pe===4?(se=b.deflateEnd(this.strm),this.onEnd(se),this.ended=!0,se===G):pe!==2||(this.onEnd(G),!(fe.avail_out=0))},j.prototype.onData=function(K){this.chunks.push(K)},j.prototype.onEnd=function(K){K===G&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=E.flattenChunks(this.chunks)),this.chunks=[],this.err=K,this.msg=this.strm.msg},_.Deflate=j,_.deflate=X,_.deflateRaw=function(K,te){return(te=te||{}).raw=!0,X(K,te)},_.gzip=function(K,te){return(te=te||{}).gzip=!0,X(K,te)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(u,m,_){var b=u("./zlib/inflate"),E=u("./utils/common"),T=u("./utils/strings"),P=u("./zlib/constants"),N=u("./zlib/messages"),z=u("./zlib/zstream"),G=u("./zlib/gzheader"),V=Object.prototype.toString;function B(j){if(!(this instanceof B))return new B(j);this.options=E.assign({chunkSize:16384,windowBits:0,to:""},j||{});var X=this.options;X.raw&&0<=X.windowBits&&X.windowBits<16&&(X.windowBits=-X.windowBits,X.windowBits===0&&(X.windowBits=-15)),!(0<=X.windowBits&&X.windowBits<16)||j&&j.windowBits||(X.windowBits+=32),15<X.windowBits&&X.windowBits<48&&!(15&X.windowBits)&&(X.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new z,this.strm.avail_out=0;var K=b.inflateInit2(this.strm,X.windowBits);if(K!==P.Z_OK)throw new Error(N[K]);this.header=new G,b.inflateGetHeader(this.strm,this.header)}function H(j,X){var K=new B(X);if(K.push(j,!0),K.err)throw K.msg||N[K.err];return K.result}B.prototype.push=function(j,X){var K,te,se,pe,fe,ve,Ne=this.strm,ze=this.options.chunkSize,Me=this.options.dictionary,He=!1;if(this.ended)return!1;te=X===~~X?X:X===!0?P.Z_FINISH:P.Z_NO_FLUSH,typeof j=="string"?Ne.input=T.binstring2buf(j):V.call(j)==="[object ArrayBuffer]"?Ne.input=new Uint8Array(j):Ne.input=j,Ne.next_in=0,Ne.avail_in=Ne.input.length;do{if(Ne.avail_out===0&&(Ne.output=new E.Buf8(ze),Ne.next_out=0,Ne.avail_out=ze),(K=b.inflate(Ne,P.Z_NO_FLUSH))===P.Z_NEED_DICT&&Me&&(ve=typeof Me=="string"?T.string2buf(Me):V.call(Me)==="[object ArrayBuffer]"?new Uint8Array(Me):Me,K=b.inflateSetDictionary(this.strm,ve)),K===P.Z_BUF_ERROR&&He===!0&&(K=P.Z_OK,He=!1),K!==P.Z_STREAM_END&&K!==P.Z_OK)return this.onEnd(K),!(this.ended=!0);Ne.next_out&&(Ne.avail_out!==0&&K!==P.Z_STREAM_END&&(Ne.avail_in!==0||te!==P.Z_FINISH&&te!==P.Z_SYNC_FLUSH)||(this.options.to==="string"?(se=T.utf8border(Ne.output,Ne.next_out),pe=Ne.next_out-se,fe=T.buf2string(Ne.output,se),Ne.next_out=pe,Ne.avail_out=ze-pe,pe&&E.arraySet(Ne.output,Ne.output,se,pe,0),this.onData(fe)):this.onData(E.shrinkBuf(Ne.output,Ne.next_out)))),Ne.avail_in===0&&Ne.avail_out===0&&(He=!0)}while((0<Ne.avail_in||Ne.avail_out===0)&&K!==P.Z_STREAM_END);return K===P.Z_STREAM_END&&(te=P.Z_FINISH),te===P.Z_FINISH?(K=b.inflateEnd(this.strm),this.onEnd(K),this.ended=!0,K===P.Z_OK):te!==P.Z_SYNC_FLUSH||(this.onEnd(P.Z_OK),!(Ne.avail_out=0))},B.prototype.onData=function(j){this.chunks.push(j)},B.prototype.onEnd=function(j){j===P.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=E.flattenChunks(this.chunks)),this.chunks=[],this.err=j,this.msg=this.strm.msg},_.Inflate=B,_.inflate=H,_.inflateRaw=function(j,X){return(X=X||{}).raw=!0,H(j,X)},_.ungzip=H},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(u,m,_){var b=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";_.assign=function(P){for(var N=Array.prototype.slice.call(arguments,1);N.length;){var z=N.shift();if(z){if(typeof z!="object")throw new TypeError(z+"must be non-object");for(var G in z)z.hasOwnProperty(G)&&(P[G]=z[G])}}return P},_.shrinkBuf=function(P,N){return P.length===N?P:P.subarray?P.subarray(0,N):(P.length=N,P)};var E={arraySet:function(P,N,z,G,V){if(N.subarray&&P.subarray)P.set(N.subarray(z,z+G),V);else for(var B=0;B<G;B++)P[V+B]=N[z+B]},flattenChunks:function(P){var N,z,G,V,B,H;for(N=G=0,z=P.length;N<z;N++)G+=P[N].length;for(H=new Uint8Array(G),N=V=0,z=P.length;N<z;N++)B=P[N],H.set(B,V),V+=B.length;return H}},T={arraySet:function(P,N,z,G,V){for(var B=0;B<G;B++)P[V+B]=N[z+B]},flattenChunks:function(P){return[].concat.apply([],P)}};_.setTyped=function(P){P?(_.Buf8=Uint8Array,_.Buf16=Uint16Array,_.Buf32=Int32Array,_.assign(_,E)):(_.Buf8=Array,_.Buf16=Array,_.Buf32=Array,_.assign(_,T))},_.setTyped(b)},{}],42:[function(u,m,_){var b=u("./common"),E=!0,T=!0;try{String.fromCharCode.apply(null,[0])}catch{E=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{T=!1}for(var P=new b.Buf8(256),N=0;N<256;N++)P[N]=252<=N?6:248<=N?5:240<=N?4:224<=N?3:192<=N?2:1;function z(G,V){if(V<65537&&(G.subarray&&T||!G.subarray&&E))return String.fromCharCode.apply(null,b.shrinkBuf(G,V));for(var B="",H=0;H<V;H++)B+=String.fromCharCode(G[H]);return B}P[254]=P[254]=1,_.string2buf=function(G){var V,B,H,j,X,K=G.length,te=0;for(j=0;j<K;j++)(64512&(B=G.charCodeAt(j)))==55296&&j+1<K&&(64512&(H=G.charCodeAt(j+1)))==56320&&(B=65536+(B-55296<<10)+(H-56320),j++),te+=B<128?1:B<2048?2:B<65536?3:4;for(V=new b.Buf8(te),j=X=0;X<te;j++)(64512&(B=G.charCodeAt(j)))==55296&&j+1<K&&(64512&(H=G.charCodeAt(j+1)))==56320&&(B=65536+(B-55296<<10)+(H-56320),j++),B<128?V[X++]=B:(B<2048?V[X++]=192|B>>>6:(B<65536?V[X++]=224|B>>>12:(V[X++]=240|B>>>18,V[X++]=128|B>>>12&63),V[X++]=128|B>>>6&63),V[X++]=128|63&B);return V},_.buf2binstring=function(G){return z(G,G.length)},_.binstring2buf=function(G){for(var V=new b.Buf8(G.length),B=0,H=V.length;B<H;B++)V[B]=G.charCodeAt(B);return V},_.buf2string=function(G,V){var B,H,j,X,K=V||G.length,te=new Array(2*K);for(B=H=0;B<K;)if((j=G[B++])<128)te[H++]=j;else if(4<(X=P[j]))te[H++]=65533,B+=X-1;else{for(j&=X===2?31:X===3?15:7;1<X&&B<K;)j=j<<6|63&G[B++],X--;1<X?te[H++]=65533:j<65536?te[H++]=j:(j-=65536,te[H++]=55296|j>>10&1023,te[H++]=56320|1023&j)}return z(te,H)},_.utf8border=function(G,V){var B;for((V=V||G.length)>G.length&&(V=G.length),B=V-1;0<=B&&(192&G[B])==128;)B--;return B<0||B===0?V:B+P[G[B]]>V?B:V}},{"./common":41}],43:[function(u,m,_){m.exports=function(b,E,T,P){for(var N=65535&b|0,z=b>>>16&65535|0,G=0;T!==0;){for(T-=G=2e3<T?2e3:T;z=z+(N=N+E[P++]|0)|0,--G;);N%=65521,z%=65521}return N|z<<16|0}},{}],44:[function(u,m,_){m.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(u,m,_){var b=function(){for(var E,T=[],P=0;P<256;P++){E=P;for(var N=0;N<8;N++)E=1&E?3988292384^E>>>1:E>>>1;T[P]=E}return T}();m.exports=function(E,T,P,N){var z=b,G=N+P;E^=-1;for(var V=N;V<G;V++)E=E>>>8^z[255&(E^T[V])];return-1^E}},{}],46:[function(u,m,_){var b,E=u("../utils/common"),T=u("./trees"),P=u("./adler32"),N=u("./crc32"),z=u("./messages"),G=0,V=4,B=0,H=-2,j=-1,X=4,K=2,te=8,se=9,pe=286,fe=30,ve=19,Ne=2*pe+1,ze=15,Me=3,He=258,vt=He+Me+1,xe=42,We=113,oe=1,nt=2,dn=3,Ve=4;function Be(he,Lt){return he.msg=z[Lt],Lt}function ot(he){return(he<<1)-(4<he?9:0)}function Wt(he){for(var Lt=he.length;0<=--Lt;)he[Lt]=0}function be(he){var Lt=he.state,It=Lt.pending;It>he.avail_out&&(It=he.avail_out),It!==0&&(E.arraySet(he.output,Lt.pending_buf,Lt.pending_out,It,he.next_out),he.next_out+=It,Lt.pending_out+=It,he.total_out+=It,he.avail_out-=It,Lt.pending-=It,Lt.pending===0&&(Lt.pending_out=0))}function Ce(he,Lt){T._tr_flush_block(he,0<=he.block_start?he.block_start:-1,he.strstart-he.block_start,Lt),he.block_start=he.strstart,be(he.strm)}function St(he,Lt){he.pending_buf[he.pending++]=Lt}function Mt(he,Lt){he.pending_buf[he.pending++]=Lt>>>8&255,he.pending_buf[he.pending++]=255&Lt}function kt(he,Lt){var It,ke,Re=he.max_chain_length,ut=he.strstart,Xt=he.prev_length,rn=he.nice_match,wt=he.strstart>he.w_size-vt?he.strstart-(he.w_size-vt):0,fn=he.window,tn=he.w_mask,sn=he.prev,xr=he.strstart+He,Bi=fn[ut+Xt-1],Hr=fn[ut+Xt];he.prev_length>=he.good_match&&(Re>>=2),rn>he.lookahead&&(rn=he.lookahead);do if(fn[(It=Lt)+Xt]===Hr&&fn[It+Xt-1]===Bi&&fn[It]===fn[ut]&&fn[++It]===fn[ut+1]){ut+=2,It++;do;while(fn[++ut]===fn[++It]&&fn[++ut]===fn[++It]&&fn[++ut]===fn[++It]&&fn[++ut]===fn[++It]&&fn[++ut]===fn[++It]&&fn[++ut]===fn[++It]&&fn[++ut]===fn[++It]&&fn[++ut]===fn[++It]&&ut<xr);if(ke=He-(xr-ut),ut=xr-He,Xt<ke){if(he.match_start=Lt,rn<=(Xt=ke))break;Bi=fn[ut+Xt-1],Hr=fn[ut+Xt]}}while((Lt=sn[Lt&tn])>wt&&--Re!=0);return Xt<=he.lookahead?Xt:he.lookahead}function ct(he){var Lt,It,ke,Re,ut,Xt,rn,wt,fn,tn,sn=he.w_size;do{if(Re=he.window_size-he.lookahead-he.strstart,he.strstart>=sn+(sn-vt)){for(E.arraySet(he.window,he.window,sn,sn,0),he.match_start-=sn,he.strstart-=sn,he.block_start-=sn,Lt=It=he.hash_size;ke=he.head[--Lt],he.head[Lt]=sn<=ke?ke-sn:0,--It;);for(Lt=It=sn;ke=he.prev[--Lt],he.prev[Lt]=sn<=ke?ke-sn:0,--It;);Re+=sn}if(he.strm.avail_in===0)break;if(Xt=he.strm,rn=he.window,wt=he.strstart+he.lookahead,fn=Re,tn=void 0,tn=Xt.avail_in,fn<tn&&(tn=fn),It=tn===0?0:(Xt.avail_in-=tn,E.arraySet(rn,Xt.input,Xt.next_in,tn,wt),Xt.state.wrap===1?Xt.adler=P(Xt.adler,rn,tn,wt):Xt.state.wrap===2&&(Xt.adler=N(Xt.adler,rn,tn,wt)),Xt.next_in+=tn,Xt.total_in+=tn,tn),he.lookahead+=It,he.lookahead+he.insert>=Me)for(ut=he.strstart-he.insert,he.ins_h=he.window[ut],he.ins_h=(he.ins_h<<he.hash_shift^he.window[ut+1])&he.hash_mask;he.insert&&(he.ins_h=(he.ins_h<<he.hash_shift^he.window[ut+Me-1])&he.hash_mask,he.prev[ut&he.w_mask]=he.head[he.ins_h],he.head[he.ins_h]=ut,ut++,he.insert--,!(he.lookahead+he.insert<Me)););}while(he.lookahead<vt&&he.strm.avail_in!==0)}function zn(he,Lt){for(var It,ke;;){if(he.lookahead<vt){if(ct(he),he.lookahead<vt&&Lt===G)return oe;if(he.lookahead===0)break}if(It=0,he.lookahead>=Me&&(he.ins_h=(he.ins_h<<he.hash_shift^he.window[he.strstart+Me-1])&he.hash_mask,It=he.prev[he.strstart&he.w_mask]=he.head[he.ins_h],he.head[he.ins_h]=he.strstart),It!==0&&he.strstart-It<=he.w_size-vt&&(he.match_length=kt(he,It)),he.match_length>=Me)if(ke=T._tr_tally(he,he.strstart-he.match_start,he.match_length-Me),he.lookahead-=he.match_length,he.match_length<=he.max_lazy_match&&he.lookahead>=Me){for(he.match_length--;he.strstart++,he.ins_h=(he.ins_h<<he.hash_shift^he.window[he.strstart+Me-1])&he.hash_mask,It=he.prev[he.strstart&he.w_mask]=he.head[he.ins_h],he.head[he.ins_h]=he.strstart,--he.match_length!=0;);he.strstart++}else he.strstart+=he.match_length,he.match_length=0,he.ins_h=he.window[he.strstart],he.ins_h=(he.ins_h<<he.hash_shift^he.window[he.strstart+1])&he.hash_mask;else ke=T._tr_tally(he,0,he.window[he.strstart]),he.lookahead--,he.strstart++;if(ke&&(Ce(he,!1),he.strm.avail_out===0))return oe}return he.insert=he.strstart<Me-1?he.strstart:Me-1,Lt===V?(Ce(he,!0),he.strm.avail_out===0?dn:Ve):he.last_lit&&(Ce(he,!1),he.strm.avail_out===0)?oe:nt}function Vt(he,Lt){for(var It,ke,Re;;){if(he.lookahead<vt){if(ct(he),he.lookahead<vt&&Lt===G)return oe;if(he.lookahead===0)break}if(It=0,he.lookahead>=Me&&(he.ins_h=(he.ins_h<<he.hash_shift^he.window[he.strstart+Me-1])&he.hash_mask,It=he.prev[he.strstart&he.w_mask]=he.head[he.ins_h],he.head[he.ins_h]=he.strstart),he.prev_length=he.match_length,he.prev_match=he.match_start,he.match_length=Me-1,It!==0&&he.prev_length<he.max_lazy_match&&he.strstart-It<=he.w_size-vt&&(he.match_length=kt(he,It),he.match_length<=5&&(he.strategy===1||he.match_length===Me&&4096<he.strstart-he.match_start)&&(he.match_length=Me-1)),he.prev_length>=Me&&he.match_length<=he.prev_length){for(Re=he.strstart+he.lookahead-Me,ke=T._tr_tally(he,he.strstart-1-he.prev_match,he.prev_length-Me),he.lookahead-=he.prev_length-1,he.prev_length-=2;++he.strstart<=Re&&(he.ins_h=(he.ins_h<<he.hash_shift^he.window[he.strstart+Me-1])&he.hash_mask,It=he.prev[he.strstart&he.w_mask]=he.head[he.ins_h],he.head[he.ins_h]=he.strstart),--he.prev_length!=0;);if(he.match_available=0,he.match_length=Me-1,he.strstart++,ke&&(Ce(he,!1),he.strm.avail_out===0))return oe}else if(he.match_available){if((ke=T._tr_tally(he,0,he.window[he.strstart-1]))&&Ce(he,!1),he.strstart++,he.lookahead--,he.strm.avail_out===0)return oe}else he.match_available=1,he.strstart++,he.lookahead--}return he.match_available&&(ke=T._tr_tally(he,0,he.window[he.strstart-1]),he.match_available=0),he.insert=he.strstart<Me-1?he.strstart:Me-1,Lt===V?(Ce(he,!0),he.strm.avail_out===0?dn:Ve):he.last_lit&&(Ce(he,!1),he.strm.avail_out===0)?oe:nt}function Dn(he,Lt,It,ke,Re){this.good_length=he,this.max_lazy=Lt,this.nice_length=It,this.max_chain=ke,this.func=Re}function ur(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=te,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new E.Buf16(2*Ne),this.dyn_dtree=new E.Buf16(2*(2*fe+1)),this.bl_tree=new E.Buf16(2*(2*ve+1)),Wt(this.dyn_ltree),Wt(this.dyn_dtree),Wt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new E.Buf16(ze+1),this.heap=new E.Buf16(2*pe+1),Wt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new E.Buf16(2*pe+1),Wt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function kr(he){var Lt;return he&&he.state?(he.total_in=he.total_out=0,he.data_type=K,(Lt=he.state).pending=0,Lt.pending_out=0,Lt.wrap<0&&(Lt.wrap=-Lt.wrap),Lt.status=Lt.wrap?xe:We,he.adler=Lt.wrap===2?0:1,Lt.last_flush=G,T._tr_init(Lt),B):Be(he,H)}function Mr(he){var Lt=kr(he);return Lt===B&&function(It){It.window_size=2*It.w_size,Wt(It.head),It.max_lazy_match=b[It.level].max_lazy,It.good_match=b[It.level].good_length,It.nice_match=b[It.level].nice_length,It.max_chain_length=b[It.level].max_chain,It.strstart=0,It.block_start=0,It.lookahead=0,It.insert=0,It.match_length=It.prev_length=Me-1,It.match_available=0,It.ins_h=0}(he.state),Lt}function ji(he,Lt,It,ke,Re,ut){if(!he)return H;var Xt=1;if(Lt===j&&(Lt=6),ke<0?(Xt=0,ke=-ke):15<ke&&(Xt=2,ke-=16),Re<1||se<Re||It!==te||ke<8||15<ke||Lt<0||9<Lt||ut<0||X<ut)return Be(he,H);ke===8&&(ke=9);var rn=new ur;return(he.state=rn).strm=he,rn.wrap=Xt,rn.gzhead=null,rn.w_bits=ke,rn.w_size=1<<rn.w_bits,rn.w_mask=rn.w_size-1,rn.hash_bits=Re+7,rn.hash_size=1<<rn.hash_bits,rn.hash_mask=rn.hash_size-1,rn.hash_shift=~~((rn.hash_bits+Me-1)/Me),rn.window=new E.Buf8(2*rn.w_size),rn.head=new E.Buf16(rn.hash_size),rn.prev=new E.Buf16(rn.w_size),rn.lit_bufsize=1<<Re+6,rn.pending_buf_size=4*rn.lit_bufsize,rn.pending_buf=new E.Buf8(rn.pending_buf_size),rn.d_buf=1*rn.lit_bufsize,rn.l_buf=3*rn.lit_bufsize,rn.level=Lt,rn.strategy=ut,rn.method=It,Mr(he)}b=[new Dn(0,0,0,0,function(he,Lt){var It=65535;for(It>he.pending_buf_size-5&&(It=he.pending_buf_size-5);;){if(he.lookahead<=1){if(ct(he),he.lookahead===0&&Lt===G)return oe;if(he.lookahead===0)break}he.strstart+=he.lookahead,he.lookahead=0;var ke=he.block_start+It;if((he.strstart===0||he.strstart>=ke)&&(he.lookahead=he.strstart-ke,he.strstart=ke,Ce(he,!1),he.strm.avail_out===0)||he.strstart-he.block_start>=he.w_size-vt&&(Ce(he,!1),he.strm.avail_out===0))return oe}return he.insert=0,Lt===V?(Ce(he,!0),he.strm.avail_out===0?dn:Ve):(he.strstart>he.block_start&&(Ce(he,!1),he.strm.avail_out),oe)}),new Dn(4,4,8,4,zn),new Dn(4,5,16,8,zn),new Dn(4,6,32,32,zn),new Dn(4,4,16,16,Vt),new Dn(8,16,32,32,Vt),new Dn(8,16,128,128,Vt),new Dn(8,32,128,256,Vt),new Dn(32,128,258,1024,Vt),new Dn(32,258,258,4096,Vt)],_.deflateInit=function(he,Lt){return ji(he,Lt,te,15,8,0)},_.deflateInit2=ji,_.deflateReset=Mr,_.deflateResetKeep=kr,_.deflateSetHeader=function(he,Lt){return he&&he.state?he.state.wrap!==2?H:(he.state.gzhead=Lt,B):H},_.deflate=function(he,Lt){var It,ke,Re,ut;if(!he||!he.state||5<Lt||Lt<0)return he?Be(he,H):H;if(ke=he.state,!he.output||!he.input&&he.avail_in!==0||ke.status===666&&Lt!==V)return Be(he,he.avail_out===0?-5:H);if(ke.strm=he,It=ke.last_flush,ke.last_flush=Lt,ke.status===xe)if(ke.wrap===2)he.adler=0,St(ke,31),St(ke,139),St(ke,8),ke.gzhead?(St(ke,(ke.gzhead.text?1:0)+(ke.gzhead.hcrc?2:0)+(ke.gzhead.extra?4:0)+(ke.gzhead.name?8:0)+(ke.gzhead.comment?16:0)),St(ke,255&ke.gzhead.time),St(ke,ke.gzhead.time>>8&255),St(ke,ke.gzhead.time>>16&255),St(ke,ke.gzhead.time>>24&255),St(ke,ke.level===9?2:2<=ke.strategy||ke.level<2?4:0),St(ke,255&ke.gzhead.os),ke.gzhead.extra&&ke.gzhead.extra.length&&(St(ke,255&ke.gzhead.extra.length),St(ke,ke.gzhead.extra.length>>8&255)),ke.gzhead.hcrc&&(he.adler=N(he.adler,ke.pending_buf,ke.pending,0)),ke.gzindex=0,ke.status=69):(St(ke,0),St(ke,0),St(ke,0),St(ke,0),St(ke,0),St(ke,ke.level===9?2:2<=ke.strategy||ke.level<2?4:0),St(ke,3),ke.status=We);else{var Xt=te+(ke.w_bits-8<<4)<<8;Xt|=(2<=ke.strategy||ke.level<2?0:ke.level<6?1:ke.level===6?2:3)<<6,ke.strstart!==0&&(Xt|=32),Xt+=31-Xt%31,ke.status=We,Mt(ke,Xt),ke.strstart!==0&&(Mt(ke,he.adler>>>16),Mt(ke,65535&he.adler)),he.adler=1}if(ke.status===69)if(ke.gzhead.extra){for(Re=ke.pending;ke.gzindex<(65535&ke.gzhead.extra.length)&&(ke.pending!==ke.pending_buf_size||(ke.gzhead.hcrc&&ke.pending>Re&&(he.adler=N(he.adler,ke.pending_buf,ke.pending-Re,Re)),be(he),Re=ke.pending,ke.pending!==ke.pending_buf_size));)St(ke,255&ke.gzhead.extra[ke.gzindex]),ke.gzindex++;ke.gzhead.hcrc&&ke.pending>Re&&(he.adler=N(he.adler,ke.pending_buf,ke.pending-Re,Re)),ke.gzindex===ke.gzhead.extra.length&&(ke.gzindex=0,ke.status=73)}else ke.status=73;if(ke.status===73)if(ke.gzhead.name){Re=ke.pending;do{if(ke.pending===ke.pending_buf_size&&(ke.gzhead.hcrc&&ke.pending>Re&&(he.adler=N(he.adler,ke.pending_buf,ke.pending-Re,Re)),be(he),Re=ke.pending,ke.pending===ke.pending_buf_size)){ut=1;break}ut=ke.gzindex<ke.gzhead.name.length?255&ke.gzhead.name.charCodeAt(ke.gzindex++):0,St(ke,ut)}while(ut!==0);ke.gzhead.hcrc&&ke.pending>Re&&(he.adler=N(he.adler,ke.pending_buf,ke.pending-Re,Re)),ut===0&&(ke.gzindex=0,ke.status=91)}else ke.status=91;if(ke.status===91)if(ke.gzhead.comment){Re=ke.pending;do{if(ke.pending===ke.pending_buf_size&&(ke.gzhead.hcrc&&ke.pending>Re&&(he.adler=N(he.adler,ke.pending_buf,ke.pending-Re,Re)),be(he),Re=ke.pending,ke.pending===ke.pending_buf_size)){ut=1;break}ut=ke.gzindex<ke.gzhead.comment.length?255&ke.gzhead.comment.charCodeAt(ke.gzindex++):0,St(ke,ut)}while(ut!==0);ke.gzhead.hcrc&&ke.pending>Re&&(he.adler=N(he.adler,ke.pending_buf,ke.pending-Re,Re)),ut===0&&(ke.status=103)}else ke.status=103;if(ke.status===103&&(ke.gzhead.hcrc?(ke.pending+2>ke.pending_buf_size&&be(he),ke.pending+2<=ke.pending_buf_size&&(St(ke,255&he.adler),St(ke,he.adler>>8&255),he.adler=0,ke.status=We)):ke.status=We),ke.pending!==0){if(be(he),he.avail_out===0)return ke.last_flush=-1,B}else if(he.avail_in===0&&ot(Lt)<=ot(It)&&Lt!==V)return Be(he,-5);if(ke.status===666&&he.avail_in!==0)return Be(he,-5);if(he.avail_in!==0||ke.lookahead!==0||Lt!==G&&ke.status!==666){var rn=ke.strategy===2?function(wt,fn){for(var tn;;){if(wt.lookahead===0&&(ct(wt),wt.lookahead===0)){if(fn===G)return oe;break}if(wt.match_length=0,tn=T._tr_tally(wt,0,wt.window[wt.strstart]),wt.lookahead--,wt.strstart++,tn&&(Ce(wt,!1),wt.strm.avail_out===0))return oe}return wt.insert=0,fn===V?(Ce(wt,!0),wt.strm.avail_out===0?dn:Ve):wt.last_lit&&(Ce(wt,!1),wt.strm.avail_out===0)?oe:nt}(ke,Lt):ke.strategy===3?function(wt,fn){for(var tn,sn,xr,Bi,Hr=wt.window;;){if(wt.lookahead<=He){if(ct(wt),wt.lookahead<=He&&fn===G)return oe;if(wt.lookahead===0)break}if(wt.match_length=0,wt.lookahead>=Me&&0<wt.strstart&&(sn=Hr[xr=wt.strstart-1])===Hr[++xr]&&sn===Hr[++xr]&&sn===Hr[++xr]){Bi=wt.strstart+He;do;while(sn===Hr[++xr]&&sn===Hr[++xr]&&sn===Hr[++xr]&&sn===Hr[++xr]&&sn===Hr[++xr]&&sn===Hr[++xr]&&sn===Hr[++xr]&&sn===Hr[++xr]&&xr<Bi);wt.match_length=He-(Bi-xr),wt.match_length>wt.lookahead&&(wt.match_length=wt.lookahead)}if(wt.match_length>=Me?(tn=T._tr_tally(wt,1,wt.match_length-Me),wt.lookahead-=wt.match_length,wt.strstart+=wt.match_length,wt.match_length=0):(tn=T._tr_tally(wt,0,wt.window[wt.strstart]),wt.lookahead--,wt.strstart++),tn&&(Ce(wt,!1),wt.strm.avail_out===0))return oe}return wt.insert=0,fn===V?(Ce(wt,!0),wt.strm.avail_out===0?dn:Ve):wt.last_lit&&(Ce(wt,!1),wt.strm.avail_out===0)?oe:nt}(ke,Lt):b[ke.level].func(ke,Lt);if(rn!==dn&&rn!==Ve||(ke.status=666),rn===oe||rn===dn)return he.avail_out===0&&(ke.last_flush=-1),B;if(rn===nt&&(Lt===1?T._tr_align(ke):Lt!==5&&(T._tr_stored_block(ke,0,0,!1),Lt===3&&(Wt(ke.head),ke.lookahead===0&&(ke.strstart=0,ke.block_start=0,ke.insert=0))),be(he),he.avail_out===0))return ke.last_flush=-1,B}return Lt!==V?B:ke.wrap<=0?1:(ke.wrap===2?(St(ke,255&he.adler),St(ke,he.adler>>8&255),St(ke,he.adler>>16&255),St(ke,he.adler>>24&255),St(ke,255&he.total_in),St(ke,he.total_in>>8&255),St(ke,he.total_in>>16&255),St(ke,he.total_in>>24&255)):(Mt(ke,he.adler>>>16),Mt(ke,65535&he.adler)),be(he),0<ke.wrap&&(ke.wrap=-ke.wrap),ke.pending!==0?B:1)},_.deflateEnd=function(he){var Lt;return he&&he.state?(Lt=he.state.status)!==xe&&Lt!==69&&Lt!==73&&Lt!==91&&Lt!==103&&Lt!==We&&Lt!==666?Be(he,H):(he.state=null,Lt===We?Be(he,-3):B):H},_.deflateSetDictionary=function(he,Lt){var It,ke,Re,ut,Xt,rn,wt,fn,tn=Lt.length;if(!he||!he.state||(ut=(It=he.state).wrap)===2||ut===1&&It.status!==xe||It.lookahead)return H;for(ut===1&&(he.adler=P(he.adler,Lt,tn,0)),It.wrap=0,tn>=It.w_size&&(ut===0&&(Wt(It.head),It.strstart=0,It.block_start=0,It.insert=0),fn=new E.Buf8(It.w_size),E.arraySet(fn,Lt,tn-It.w_size,It.w_size,0),Lt=fn,tn=It.w_size),Xt=he.avail_in,rn=he.next_in,wt=he.input,he.avail_in=tn,he.next_in=0,he.input=Lt,ct(It);It.lookahead>=Me;){for(ke=It.strstart,Re=It.lookahead-(Me-1);It.ins_h=(It.ins_h<<It.hash_shift^It.window[ke+Me-1])&It.hash_mask,It.prev[ke&It.w_mask]=It.head[It.ins_h],It.head[It.ins_h]=ke,ke++,--Re;);It.strstart=ke,It.lookahead=Me-1,ct(It)}return It.strstart+=It.lookahead,It.block_start=It.strstart,It.insert=It.lookahead,It.lookahead=0,It.match_length=It.prev_length=Me-1,It.match_available=0,he.next_in=rn,he.input=wt,he.avail_in=Xt,It.wrap=ut,B},_.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(u,m,_){m.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(u,m,_){m.exports=function(b,E){var T,P,N,z,G,V,B,H,j,X,K,te,se,pe,fe,ve,Ne,ze,Me,He,vt,xe,We,oe,nt;T=b.state,P=b.next_in,oe=b.input,N=P+(b.avail_in-5),z=b.next_out,nt=b.output,G=z-(E-b.avail_out),V=z+(b.avail_out-257),B=T.dmax,H=T.wsize,j=T.whave,X=T.wnext,K=T.window,te=T.hold,se=T.bits,pe=T.lencode,fe=T.distcode,ve=(1<<T.lenbits)-1,Ne=(1<<T.distbits)-1;e:do{se<15&&(te+=oe[P++]<<se,se+=8,te+=oe[P++]<<se,se+=8),ze=pe[te&ve];t:for(;;){if(te>>>=Me=ze>>>24,se-=Me,(Me=ze>>>16&255)===0)nt[z++]=65535&ze;else{if(!(16&Me)){if(!(64&Me)){ze=pe[(65535&ze)+(te&(1<<Me)-1)];continue t}if(32&Me){T.mode=12;break e}b.msg="invalid literal/length code",T.mode=30;break e}He=65535&ze,(Me&=15)&&(se<Me&&(te+=oe[P++]<<se,se+=8),He+=te&(1<<Me)-1,te>>>=Me,se-=Me),se<15&&(te+=oe[P++]<<se,se+=8,te+=oe[P++]<<se,se+=8),ze=fe[te&Ne];n:for(;;){if(te>>>=Me=ze>>>24,se-=Me,!(16&(Me=ze>>>16&255))){if(!(64&Me)){ze=fe[(65535&ze)+(te&(1<<Me)-1)];continue n}b.msg="invalid distance code",T.mode=30;break e}if(vt=65535&ze,se<(Me&=15)&&(te+=oe[P++]<<se,(se+=8)<Me&&(te+=oe[P++]<<se,se+=8)),B<(vt+=te&(1<<Me)-1)){b.msg="invalid distance too far back",T.mode=30;break e}if(te>>>=Me,se-=Me,(Me=z-G)<vt){if(j<(Me=vt-Me)&&T.sane){b.msg="invalid distance too far back",T.mode=30;break e}if(We=K,(xe=0)===X){if(xe+=H-Me,Me<He){for(He-=Me;nt[z++]=K[xe++],--Me;);xe=z-vt,We=nt}}else if(X<Me){if(xe+=H+X-Me,(Me-=X)<He){for(He-=Me;nt[z++]=K[xe++],--Me;);if(xe=0,X<He){for(He-=Me=X;nt[z++]=K[xe++],--Me;);xe=z-vt,We=nt}}}else if(xe+=X-Me,Me<He){for(He-=Me;nt[z++]=K[xe++],--Me;);xe=z-vt,We=nt}for(;2<He;)nt[z++]=We[xe++],nt[z++]=We[xe++],nt[z++]=We[xe++],He-=3;He&&(nt[z++]=We[xe++],1<He&&(nt[z++]=We[xe++]))}else{for(xe=z-vt;nt[z++]=nt[xe++],nt[z++]=nt[xe++],nt[z++]=nt[xe++],2<(He-=3););He&&(nt[z++]=nt[xe++],1<He&&(nt[z++]=nt[xe++]))}break}}break}}while(P<N&&z<V);P-=He=se>>3,te&=(1<<(se-=He<<3))-1,b.next_in=P,b.next_out=z,b.avail_in=P<N?N-P+5:5-(P-N),b.avail_out=z<V?V-z+257:257-(z-V),T.hold=te,T.bits=se}},{}],49:[function(u,m,_){var b=u("../utils/common"),E=u("./adler32"),T=u("./crc32"),P=u("./inffast"),N=u("./inftrees"),z=1,G=2,V=0,B=-2,H=1,j=852,X=592;function K(xe){return(xe>>>24&255)+(xe>>>8&65280)+((65280&xe)<<8)+((255&xe)<<24)}function te(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new b.Buf16(320),this.work=new b.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function se(xe){var We;return xe&&xe.state?(We=xe.state,xe.total_in=xe.total_out=We.total=0,xe.msg="",We.wrap&&(xe.adler=1&We.wrap),We.mode=H,We.last=0,We.havedict=0,We.dmax=32768,We.head=null,We.hold=0,We.bits=0,We.lencode=We.lendyn=new b.Buf32(j),We.distcode=We.distdyn=new b.Buf32(X),We.sane=1,We.back=-1,V):B}function pe(xe){var We;return xe&&xe.state?((We=xe.state).wsize=0,We.whave=0,We.wnext=0,se(xe)):B}function fe(xe,We){var oe,nt;return xe&&xe.state?(nt=xe.state,We<0?(oe=0,We=-We):(oe=1+(We>>4),We<48&&(We&=15)),We&&(We<8||15<We)?B:(nt.window!==null&&nt.wbits!==We&&(nt.window=null),nt.wrap=oe,nt.wbits=We,pe(xe))):B}function ve(xe,We){var oe,nt;return xe?(nt=new te,(xe.state=nt).window=null,(oe=fe(xe,We))!==V&&(xe.state=null),oe):B}var Ne,ze,Me=!0;function He(xe){if(Me){var We;for(Ne=new b.Buf32(512),ze=new b.Buf32(32),We=0;We<144;)xe.lens[We++]=8;for(;We<256;)xe.lens[We++]=9;for(;We<280;)xe.lens[We++]=7;for(;We<288;)xe.lens[We++]=8;for(N(z,xe.lens,0,288,Ne,0,xe.work,{bits:9}),We=0;We<32;)xe.lens[We++]=5;N(G,xe.lens,0,32,ze,0,xe.work,{bits:5}),Me=!1}xe.lencode=Ne,xe.lenbits=9,xe.distcode=ze,xe.distbits=5}function vt(xe,We,oe,nt){var dn,Ve=xe.state;return Ve.window===null&&(Ve.wsize=1<<Ve.wbits,Ve.wnext=0,Ve.whave=0,Ve.window=new b.Buf8(Ve.wsize)),nt>=Ve.wsize?(b.arraySet(Ve.window,We,oe-Ve.wsize,Ve.wsize,0),Ve.wnext=0,Ve.whave=Ve.wsize):(nt<(dn=Ve.wsize-Ve.wnext)&&(dn=nt),b.arraySet(Ve.window,We,oe-nt,dn,Ve.wnext),(nt-=dn)?(b.arraySet(Ve.window,We,oe-nt,nt,0),Ve.wnext=nt,Ve.whave=Ve.wsize):(Ve.wnext+=dn,Ve.wnext===Ve.wsize&&(Ve.wnext=0),Ve.whave<Ve.wsize&&(Ve.whave+=dn))),0}_.inflateReset=pe,_.inflateReset2=fe,_.inflateResetKeep=se,_.inflateInit=function(xe){return ve(xe,15)},_.inflateInit2=ve,_.inflate=function(xe,We){var oe,nt,dn,Ve,Be,ot,Wt,be,Ce,St,Mt,kt,ct,zn,Vt,Dn,ur,kr,Mr,ji,he,Lt,It,ke,Re=0,ut=new b.Buf8(4),Xt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!xe||!xe.state||!xe.output||!xe.input&&xe.avail_in!==0)return B;(oe=xe.state).mode===12&&(oe.mode=13),Be=xe.next_out,dn=xe.output,Wt=xe.avail_out,Ve=xe.next_in,nt=xe.input,ot=xe.avail_in,be=oe.hold,Ce=oe.bits,St=ot,Mt=Wt,Lt=V;e:for(;;)switch(oe.mode){case H:if(oe.wrap===0){oe.mode=13;break}for(;Ce<16;){if(ot===0)break e;ot--,be+=nt[Ve++]<<Ce,Ce+=8}if(2&oe.wrap&&be===35615){ut[oe.check=0]=255&be,ut[1]=be>>>8&255,oe.check=T(oe.check,ut,2,0),Ce=be=0,oe.mode=2;break}if(oe.flags=0,oe.head&&(oe.head.done=!1),!(1&oe.wrap)||(((255&be)<<8)+(be>>8))%31){xe.msg="incorrect header check",oe.mode=30;break}if((15&be)!=8){xe.msg="unknown compression method",oe.mode=30;break}if(Ce-=4,he=8+(15&(be>>>=4)),oe.wbits===0)oe.wbits=he;else if(he>oe.wbits){xe.msg="invalid window size",oe.mode=30;break}oe.dmax=1<<he,xe.adler=oe.check=1,oe.mode=512&be?10:12,Ce=be=0;break;case 2:for(;Ce<16;){if(ot===0)break e;ot--,be+=nt[Ve++]<<Ce,Ce+=8}if(oe.flags=be,(255&oe.flags)!=8){xe.msg="unknown compression method",oe.mode=30;break}if(57344&oe.flags){xe.msg="unknown header flags set",oe.mode=30;break}oe.head&&(oe.head.text=be>>8&1),512&oe.flags&&(ut[0]=255&be,ut[1]=be>>>8&255,oe.check=T(oe.check,ut,2,0)),Ce=be=0,oe.mode=3;case 3:for(;Ce<32;){if(ot===0)break e;ot--,be+=nt[Ve++]<<Ce,Ce+=8}oe.head&&(oe.head.time=be),512&oe.flags&&(ut[0]=255&be,ut[1]=be>>>8&255,ut[2]=be>>>16&255,ut[3]=be>>>24&255,oe.check=T(oe.check,ut,4,0)),Ce=be=0,oe.mode=4;case 4:for(;Ce<16;){if(ot===0)break e;ot--,be+=nt[Ve++]<<Ce,Ce+=8}oe.head&&(oe.head.xflags=255&be,oe.head.os=be>>8),512&oe.flags&&(ut[0]=255&be,ut[1]=be>>>8&255,oe.check=T(oe.check,ut,2,0)),Ce=be=0,oe.mode=5;case 5:if(1024&oe.flags){for(;Ce<16;){if(ot===0)break e;ot--,be+=nt[Ve++]<<Ce,Ce+=8}oe.length=be,oe.head&&(oe.head.extra_len=be),512&oe.flags&&(ut[0]=255&be,ut[1]=be>>>8&255,oe.check=T(oe.check,ut,2,0)),Ce=be=0}else oe.head&&(oe.head.extra=null);oe.mode=6;case 6:if(1024&oe.flags&&(ot<(kt=oe.length)&&(kt=ot),kt&&(oe.head&&(he=oe.head.extra_len-oe.length,oe.head.extra||(oe.head.extra=new Array(oe.head.extra_len)),b.arraySet(oe.head.extra,nt,Ve,kt,he)),512&oe.flags&&(oe.check=T(oe.check,nt,kt,Ve)),ot-=kt,Ve+=kt,oe.length-=kt),oe.length))break e;oe.length=0,oe.mode=7;case 7:if(2048&oe.flags){if(ot===0)break e;for(kt=0;he=nt[Ve+kt++],oe.head&&he&&oe.length<65536&&(oe.head.name+=String.fromCharCode(he)),he&&kt<ot;);if(512&oe.flags&&(oe.check=T(oe.check,nt,kt,Ve)),ot-=kt,Ve+=kt,he)break e}else oe.head&&(oe.head.name=null);oe.length=0,oe.mode=8;case 8:if(4096&oe.flags){if(ot===0)break e;for(kt=0;he=nt[Ve+kt++],oe.head&&he&&oe.length<65536&&(oe.head.comment+=String.fromCharCode(he)),he&&kt<ot;);if(512&oe.flags&&(oe.check=T(oe.check,nt,kt,Ve)),ot-=kt,Ve+=kt,he)break e}else oe.head&&(oe.head.comment=null);oe.mode=9;case 9:if(512&oe.flags){for(;Ce<16;){if(ot===0)break e;ot--,be+=nt[Ve++]<<Ce,Ce+=8}if(be!==(65535&oe.check)){xe.msg="header crc mismatch",oe.mode=30;break}Ce=be=0}oe.head&&(oe.head.hcrc=oe.flags>>9&1,oe.head.done=!0),xe.adler=oe.check=0,oe.mode=12;break;case 10:for(;Ce<32;){if(ot===0)break e;ot--,be+=nt[Ve++]<<Ce,Ce+=8}xe.adler=oe.check=K(be),Ce=be=0,oe.mode=11;case 11:if(oe.havedict===0)return xe.next_out=Be,xe.avail_out=Wt,xe.next_in=Ve,xe.avail_in=ot,oe.hold=be,oe.bits=Ce,2;xe.adler=oe.check=1,oe.mode=12;case 12:if(We===5||We===6)break e;case 13:if(oe.last){be>>>=7&Ce,Ce-=7&Ce,oe.mode=27;break}for(;Ce<3;){if(ot===0)break e;ot--,be+=nt[Ve++]<<Ce,Ce+=8}switch(oe.last=1&be,Ce-=1,3&(be>>>=1)){case 0:oe.mode=14;break;case 1:if(He(oe),oe.mode=20,We!==6)break;be>>>=2,Ce-=2;break e;case 2:oe.mode=17;break;case 3:xe.msg="invalid block type",oe.mode=30}be>>>=2,Ce-=2;break;case 14:for(be>>>=7&Ce,Ce-=7&Ce;Ce<32;){if(ot===0)break e;ot--,be+=nt[Ve++]<<Ce,Ce+=8}if((65535&be)!=(be>>>16^65535)){xe.msg="invalid stored block lengths",oe.mode=30;break}if(oe.length=65535&be,Ce=be=0,oe.mode=15,We===6)break e;case 15:oe.mode=16;case 16:if(kt=oe.length){if(ot<kt&&(kt=ot),Wt<kt&&(kt=Wt),kt===0)break e;b.arraySet(dn,nt,Ve,kt,Be),ot-=kt,Ve+=kt,Wt-=kt,Be+=kt,oe.length-=kt;break}oe.mode=12;break;case 17:for(;Ce<14;){if(ot===0)break e;ot--,be+=nt[Ve++]<<Ce,Ce+=8}if(oe.nlen=257+(31&be),be>>>=5,Ce-=5,oe.ndist=1+(31&be),be>>>=5,Ce-=5,oe.ncode=4+(15&be),be>>>=4,Ce-=4,286<oe.nlen||30<oe.ndist){xe.msg="too many length or distance symbols",oe.mode=30;break}oe.have=0,oe.mode=18;case 18:for(;oe.have<oe.ncode;){for(;Ce<3;){if(ot===0)break e;ot--,be+=nt[Ve++]<<Ce,Ce+=8}oe.lens[Xt[oe.have++]]=7&be,be>>>=3,Ce-=3}for(;oe.have<19;)oe.lens[Xt[oe.have++]]=0;if(oe.lencode=oe.lendyn,oe.lenbits=7,It={bits:oe.lenbits},Lt=N(0,oe.lens,0,19,oe.lencode,0,oe.work,It),oe.lenbits=It.bits,Lt){xe.msg="invalid code lengths set",oe.mode=30;break}oe.have=0,oe.mode=19;case 19:for(;oe.have<oe.nlen+oe.ndist;){for(;Dn=(Re=oe.lencode[be&(1<<oe.lenbits)-1])>>>16&255,ur=65535&Re,!((Vt=Re>>>24)<=Ce);){if(ot===0)break e;ot--,be+=nt[Ve++]<<Ce,Ce+=8}if(ur<16)be>>>=Vt,Ce-=Vt,oe.lens[oe.have++]=ur;else{if(ur===16){for(ke=Vt+2;Ce<ke;){if(ot===0)break e;ot--,be+=nt[Ve++]<<Ce,Ce+=8}if(be>>>=Vt,Ce-=Vt,oe.have===0){xe.msg="invalid bit length repeat",oe.mode=30;break}he=oe.lens[oe.have-1],kt=3+(3&be),be>>>=2,Ce-=2}else if(ur===17){for(ke=Vt+3;Ce<ke;){if(ot===0)break e;ot--,be+=nt[Ve++]<<Ce,Ce+=8}Ce-=Vt,he=0,kt=3+(7&(be>>>=Vt)),be>>>=3,Ce-=3}else{for(ke=Vt+7;Ce<ke;){if(ot===0)break e;ot--,be+=nt[Ve++]<<Ce,Ce+=8}Ce-=Vt,he=0,kt=11+(127&(be>>>=Vt)),be>>>=7,Ce-=7}if(oe.have+kt>oe.nlen+oe.ndist){xe.msg="invalid bit length repeat",oe.mode=30;break}for(;kt--;)oe.lens[oe.have++]=he}}if(oe.mode===30)break;if(oe.lens[256]===0){xe.msg="invalid code -- missing end-of-block",oe.mode=30;break}if(oe.lenbits=9,It={bits:oe.lenbits},Lt=N(z,oe.lens,0,oe.nlen,oe.lencode,0,oe.work,It),oe.lenbits=It.bits,Lt){xe.msg="invalid literal/lengths set",oe.mode=30;break}if(oe.distbits=6,oe.distcode=oe.distdyn,It={bits:oe.distbits},Lt=N(G,oe.lens,oe.nlen,oe.ndist,oe.distcode,0,oe.work,It),oe.distbits=It.bits,Lt){xe.msg="invalid distances set",oe.mode=30;break}if(oe.mode=20,We===6)break e;case 20:oe.mode=21;case 21:if(6<=ot&&258<=Wt){xe.next_out=Be,xe.avail_out=Wt,xe.next_in=Ve,xe.avail_in=ot,oe.hold=be,oe.bits=Ce,P(xe,Mt),Be=xe.next_out,dn=xe.output,Wt=xe.avail_out,Ve=xe.next_in,nt=xe.input,ot=xe.avail_in,be=oe.hold,Ce=oe.bits,oe.mode===12&&(oe.back=-1);break}for(oe.back=0;Dn=(Re=oe.lencode[be&(1<<oe.lenbits)-1])>>>16&255,ur=65535&Re,!((Vt=Re>>>24)<=Ce);){if(ot===0)break e;ot--,be+=nt[Ve++]<<Ce,Ce+=8}if(Dn&&!(240&Dn)){for(kr=Vt,Mr=Dn,ji=ur;Dn=(Re=oe.lencode[ji+((be&(1<<kr+Mr)-1)>>kr)])>>>16&255,ur=65535&Re,!(kr+(Vt=Re>>>24)<=Ce);){if(ot===0)break e;ot--,be+=nt[Ve++]<<Ce,Ce+=8}be>>>=kr,Ce-=kr,oe.back+=kr}if(be>>>=Vt,Ce-=Vt,oe.back+=Vt,oe.length=ur,Dn===0){oe.mode=26;break}if(32&Dn){oe.back=-1,oe.mode=12;break}if(64&Dn){xe.msg="invalid literal/length code",oe.mode=30;break}oe.extra=15&Dn,oe.mode=22;case 22:if(oe.extra){for(ke=oe.extra;Ce<ke;){if(ot===0)break e;ot--,be+=nt[Ve++]<<Ce,Ce+=8}oe.length+=be&(1<<oe.extra)-1,be>>>=oe.extra,Ce-=oe.extra,oe.back+=oe.extra}oe.was=oe.length,oe.mode=23;case 23:for(;Dn=(Re=oe.distcode[be&(1<<oe.distbits)-1])>>>16&255,ur=65535&Re,!((Vt=Re>>>24)<=Ce);){if(ot===0)break e;ot--,be+=nt[Ve++]<<Ce,Ce+=8}if(!(240&Dn)){for(kr=Vt,Mr=Dn,ji=ur;Dn=(Re=oe.distcode[ji+((be&(1<<kr+Mr)-1)>>kr)])>>>16&255,ur=65535&Re,!(kr+(Vt=Re>>>24)<=Ce);){if(ot===0)break e;ot--,be+=nt[Ve++]<<Ce,Ce+=8}be>>>=kr,Ce-=kr,oe.back+=kr}if(be>>>=Vt,Ce-=Vt,oe.back+=Vt,64&Dn){xe.msg="invalid distance code",oe.mode=30;break}oe.offset=ur,oe.extra=15&Dn,oe.mode=24;case 24:if(oe.extra){for(ke=oe.extra;Ce<ke;){if(ot===0)break e;ot--,be+=nt[Ve++]<<Ce,Ce+=8}oe.offset+=be&(1<<oe.extra)-1,be>>>=oe.extra,Ce-=oe.extra,oe.back+=oe.extra}if(oe.offset>oe.dmax){xe.msg="invalid distance too far back",oe.mode=30;break}oe.mode=25;case 25:if(Wt===0)break e;if(kt=Mt-Wt,oe.offset>kt){if((kt=oe.offset-kt)>oe.whave&&oe.sane){xe.msg="invalid distance too far back",oe.mode=30;break}ct=kt>oe.wnext?(kt-=oe.wnext,oe.wsize-kt):oe.wnext-kt,kt>oe.length&&(kt=oe.length),zn=oe.window}else zn=dn,ct=Be-oe.offset,kt=oe.length;for(Wt<kt&&(kt=Wt),Wt-=kt,oe.length-=kt;dn[Be++]=zn[ct++],--kt;);oe.length===0&&(oe.mode=21);break;case 26:if(Wt===0)break e;dn[Be++]=oe.length,Wt--,oe.mode=21;break;case 27:if(oe.wrap){for(;Ce<32;){if(ot===0)break e;ot--,be|=nt[Ve++]<<Ce,Ce+=8}if(Mt-=Wt,xe.total_out+=Mt,oe.total+=Mt,Mt&&(xe.adler=oe.check=oe.flags?T(oe.check,dn,Mt,Be-Mt):E(oe.check,dn,Mt,Be-Mt)),Mt=Wt,(oe.flags?be:K(be))!==oe.check){xe.msg="incorrect data check",oe.mode=30;break}Ce=be=0}oe.mode=28;case 28:if(oe.wrap&&oe.flags){for(;Ce<32;){if(ot===0)break e;ot--,be+=nt[Ve++]<<Ce,Ce+=8}if(be!==(4294967295&oe.total)){xe.msg="incorrect length check",oe.mode=30;break}Ce=be=0}oe.mode=29;case 29:Lt=1;break e;case 30:Lt=-3;break e;case 31:return-4;case 32:default:return B}return xe.next_out=Be,xe.avail_out=Wt,xe.next_in=Ve,xe.avail_in=ot,oe.hold=be,oe.bits=Ce,(oe.wsize||Mt!==xe.avail_out&&oe.mode<30&&(oe.mode<27||We!==4))&&vt(xe,xe.output,xe.next_out,Mt-xe.avail_out)?(oe.mode=31,-4):(St-=xe.avail_in,Mt-=xe.avail_out,xe.total_in+=St,xe.total_out+=Mt,oe.total+=Mt,oe.wrap&&Mt&&(xe.adler=oe.check=oe.flags?T(oe.check,dn,Mt,xe.next_out-Mt):E(oe.check,dn,Mt,xe.next_out-Mt)),xe.data_type=oe.bits+(oe.last?64:0)+(oe.mode===12?128:0)+(oe.mode===20||oe.mode===15?256:0),(St==0&&Mt===0||We===4)&&Lt===V&&(Lt=-5),Lt)},_.inflateEnd=function(xe){if(!xe||!xe.state)return B;var We=xe.state;return We.window&&(We.window=null),xe.state=null,V},_.inflateGetHeader=function(xe,We){var oe;return xe&&xe.state&&2&(oe=xe.state).wrap?((oe.head=We).done=!1,V):B},_.inflateSetDictionary=function(xe,We){var oe,nt=We.length;return xe&&xe.state?(oe=xe.state).wrap!==0&&oe.mode!==11?B:oe.mode===11&&E(1,We,nt,0)!==oe.check?-3:vt(xe,We,nt,nt)?(oe.mode=31,-4):(oe.havedict=1,V):B},_.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(u,m,_){var b=u("../utils/common"),E=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],T=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],P=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],N=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];m.exports=function(z,G,V,B,H,j,X,K){var te,se,pe,fe,ve,Ne,ze,Me,He,vt=K.bits,xe=0,We=0,oe=0,nt=0,dn=0,Ve=0,Be=0,ot=0,Wt=0,be=0,Ce=null,St=0,Mt=new b.Buf16(16),kt=new b.Buf16(16),ct=null,zn=0;for(xe=0;xe<=15;xe++)Mt[xe]=0;for(We=0;We<B;We++)Mt[G[V+We]]++;for(dn=vt,nt=15;1<=nt&&Mt[nt]===0;nt--);if(nt<dn&&(dn=nt),nt===0)return H[j++]=20971520,H[j++]=20971520,K.bits=1,0;for(oe=1;oe<nt&&Mt[oe]===0;oe++);for(dn<oe&&(dn=oe),xe=ot=1;xe<=15;xe++)if(ot<<=1,(ot-=Mt[xe])<0)return-1;if(0<ot&&(z===0||nt!==1))return-1;for(kt[1]=0,xe=1;xe<15;xe++)kt[xe+1]=kt[xe]+Mt[xe];for(We=0;We<B;We++)G[V+We]!==0&&(X[kt[G[V+We]]++]=We);if(Ne=z===0?(Ce=ct=X,19):z===1?(Ce=E,St-=257,ct=T,zn-=257,256):(Ce=P,ct=N,-1),xe=oe,ve=j,Be=We=be=0,pe=-1,fe=(Wt=1<<(Ve=dn))-1,z===1&&852<Wt||z===2&&592<Wt)return 1;for(;;){for(ze=xe-Be,He=X[We]<Ne?(Me=0,X[We]):X[We]>Ne?(Me=ct[zn+X[We]],Ce[St+X[We]]):(Me=96,0),te=1<<xe-Be,oe=se=1<<Ve;H[ve+(be>>Be)+(se-=te)]=ze<<24|Me<<16|He|0,se!==0;);for(te=1<<xe-1;be&te;)te>>=1;if(te!==0?(be&=te-1,be+=te):be=0,We++,--Mt[xe]==0){if(xe===nt)break;xe=G[V+X[We]]}if(dn<xe&&(be&fe)!==pe){for(Be===0&&(Be=dn),ve+=oe,ot=1<<(Ve=xe-Be);Ve+Be<nt&&!((ot-=Mt[Ve+Be])<=0);)Ve++,ot<<=1;if(Wt+=1<<Ve,z===1&&852<Wt||z===2&&592<Wt)return 1;H[pe=be&fe]=dn<<24|Ve<<16|ve-j|0}}return be!==0&&(H[ve+be]=xe-Be<<24|64<<16|0),K.bits=dn,0}},{"../utils/common":41}],51:[function(u,m,_){m.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(u,m,_){var b=u("../utils/common"),E=0,T=1;function P(Re){for(var ut=Re.length;0<=--ut;)Re[ut]=0}var N=0,z=29,G=256,V=G+1+z,B=30,H=19,j=2*V+1,X=15,K=16,te=7,se=256,pe=16,fe=17,ve=18,Ne=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],ze=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Me=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],He=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],vt=new Array(2*(V+2));P(vt);var xe=new Array(2*B);P(xe);var We=new Array(512);P(We);var oe=new Array(256);P(oe);var nt=new Array(z);P(nt);var dn,Ve,Be,ot=new Array(B);function Wt(Re,ut,Xt,rn,wt){this.static_tree=Re,this.extra_bits=ut,this.extra_base=Xt,this.elems=rn,this.max_length=wt,this.has_stree=Re&&Re.length}function be(Re,ut){this.dyn_tree=Re,this.max_code=0,this.stat_desc=ut}function Ce(Re){return Re<256?We[Re]:We[256+(Re>>>7)]}function St(Re,ut){Re.pending_buf[Re.pending++]=255&ut,Re.pending_buf[Re.pending++]=ut>>>8&255}function Mt(Re,ut,Xt){Re.bi_valid>K-Xt?(Re.bi_buf|=ut<<Re.bi_valid&65535,St(Re,Re.bi_buf),Re.bi_buf=ut>>K-Re.bi_valid,Re.bi_valid+=Xt-K):(Re.bi_buf|=ut<<Re.bi_valid&65535,Re.bi_valid+=Xt)}function kt(Re,ut,Xt){Mt(Re,Xt[2*ut],Xt[2*ut+1])}function ct(Re,ut){for(var Xt=0;Xt|=1&Re,Re>>>=1,Xt<<=1,0<--ut;);return Xt>>>1}function zn(Re,ut,Xt){var rn,wt,fn=new Array(X+1),tn=0;for(rn=1;rn<=X;rn++)fn[rn]=tn=tn+Xt[rn-1]<<1;for(wt=0;wt<=ut;wt++){var sn=Re[2*wt+1];sn!==0&&(Re[2*wt]=ct(fn[sn]++,sn))}}function Vt(Re){var ut;for(ut=0;ut<V;ut++)Re.dyn_ltree[2*ut]=0;for(ut=0;ut<B;ut++)Re.dyn_dtree[2*ut]=0;for(ut=0;ut<H;ut++)Re.bl_tree[2*ut]=0;Re.dyn_ltree[2*se]=1,Re.opt_len=Re.static_len=0,Re.last_lit=Re.matches=0}function Dn(Re){8<Re.bi_valid?St(Re,Re.bi_buf):0<Re.bi_valid&&(Re.pending_buf[Re.pending++]=Re.bi_buf),Re.bi_buf=0,Re.bi_valid=0}function ur(Re,ut,Xt,rn){var wt=2*ut,fn=2*Xt;return Re[wt]<Re[fn]||Re[wt]===Re[fn]&&rn[ut]<=rn[Xt]}function kr(Re,ut,Xt){for(var rn=Re.heap[Xt],wt=Xt<<1;wt<=Re.heap_len&&(wt<Re.heap_len&&ur(ut,Re.heap[wt+1],Re.heap[wt],Re.depth)&&wt++,!ur(ut,rn,Re.heap[wt],Re.depth));)Re.heap[Xt]=Re.heap[wt],Xt=wt,wt<<=1;Re.heap[Xt]=rn}function Mr(Re,ut,Xt){var rn,wt,fn,tn,sn=0;if(Re.last_lit!==0)for(;rn=Re.pending_buf[Re.d_buf+2*sn]<<8|Re.pending_buf[Re.d_buf+2*sn+1],wt=Re.pending_buf[Re.l_buf+sn],sn++,rn===0?kt(Re,wt,ut):(kt(Re,(fn=oe[wt])+G+1,ut),(tn=Ne[fn])!==0&&Mt(Re,wt-=nt[fn],tn),kt(Re,fn=Ce(--rn),Xt),(tn=ze[fn])!==0&&Mt(Re,rn-=ot[fn],tn)),sn<Re.last_lit;);kt(Re,se,ut)}function ji(Re,ut){var Xt,rn,wt,fn=ut.dyn_tree,tn=ut.stat_desc.static_tree,sn=ut.stat_desc.has_stree,xr=ut.stat_desc.elems,Bi=-1;for(Re.heap_len=0,Re.heap_max=j,Xt=0;Xt<xr;Xt++)fn[2*Xt]!==0?(Re.heap[++Re.heap_len]=Bi=Xt,Re.depth[Xt]=0):fn[2*Xt+1]=0;for(;Re.heap_len<2;)fn[2*(wt=Re.heap[++Re.heap_len]=Bi<2?++Bi:0)]=1,Re.depth[wt]=0,Re.opt_len--,sn&&(Re.static_len-=tn[2*wt+1]);for(ut.max_code=Bi,Xt=Re.heap_len>>1;1<=Xt;Xt--)kr(Re,fn,Xt);for(wt=xr;Xt=Re.heap[1],Re.heap[1]=Re.heap[Re.heap_len--],kr(Re,fn,1),rn=Re.heap[1],Re.heap[--Re.heap_max]=Xt,Re.heap[--Re.heap_max]=rn,fn[2*wt]=fn[2*Xt]+fn[2*rn],Re.depth[wt]=(Re.depth[Xt]>=Re.depth[rn]?Re.depth[Xt]:Re.depth[rn])+1,fn[2*Xt+1]=fn[2*rn+1]=wt,Re.heap[1]=wt++,kr(Re,fn,1),2<=Re.heap_len;);Re.heap[--Re.heap_max]=Re.heap[1],function(Hr,r0){var J9,A0,Fd,fo,_8,qv,Ld=r0.dyn_tree,Xv=r0.max_code,_S=r0.stat_desc.static_tree,xS=r0.stat_desc.has_stree,bS=r0.stat_desc.extra_bits,Yv=r0.stat_desc.extra_base,hh=r0.stat_desc.max_length,Bd=0;for(fo=0;fo<=X;fo++)Hr.bl_count[fo]=0;for(Ld[2*Hr.heap[Hr.heap_max]+1]=0,J9=Hr.heap_max+1;J9<j;J9++)hh<(fo=Ld[2*Ld[2*(A0=Hr.heap[J9])+1]+1]+1)&&(fo=hh,Bd++),Ld[2*A0+1]=fo,Xv<A0||(Hr.bl_count[fo]++,_8=0,Yv<=A0&&(_8=bS[A0-Yv]),qv=Ld[2*A0],Hr.opt_len+=qv*(fo+_8),xS&&(Hr.static_len+=qv*(_S[2*A0+1]+_8)));if(Bd!==0){do{for(fo=hh-1;Hr.bl_count[fo]===0;)fo--;Hr.bl_count[fo]--,Hr.bl_count[fo+1]+=2,Hr.bl_count[hh]--,Bd-=2}while(0<Bd);for(fo=hh;fo!==0;fo--)for(A0=Hr.bl_count[fo];A0!==0;)Xv<(Fd=Hr.heap[--J9])||(Ld[2*Fd+1]!==fo&&(Hr.opt_len+=(fo-Ld[2*Fd+1])*Ld[2*Fd],Ld[2*Fd+1]=fo),A0--)}}(Re,ut),zn(fn,Bi,Re.bl_count)}function he(Re,ut,Xt){var rn,wt,fn=-1,tn=ut[1],sn=0,xr=7,Bi=4;for(tn===0&&(xr=138,Bi=3),ut[2*(Xt+1)+1]=65535,rn=0;rn<=Xt;rn++)wt=tn,tn=ut[2*(rn+1)+1],++sn<xr&&wt===tn||(sn<Bi?Re.bl_tree[2*wt]+=sn:wt!==0?(wt!==fn&&Re.bl_tree[2*wt]++,Re.bl_tree[2*pe]++):sn<=10?Re.bl_tree[2*fe]++:Re.bl_tree[2*ve]++,fn=wt,Bi=(sn=0)===tn?(xr=138,3):wt===tn?(xr=6,3):(xr=7,4))}function Lt(Re,ut,Xt){var rn,wt,fn=-1,tn=ut[1],sn=0,xr=7,Bi=4;for(tn===0&&(xr=138,Bi=3),rn=0;rn<=Xt;rn++)if(wt=tn,tn=ut[2*(rn+1)+1],!(++sn<xr&&wt===tn)){if(sn<Bi)for(;kt(Re,wt,Re.bl_tree),--sn!=0;);else wt!==0?(wt!==fn&&(kt(Re,wt,Re.bl_tree),sn--),kt(Re,pe,Re.bl_tree),Mt(Re,sn-3,2)):sn<=10?(kt(Re,fe,Re.bl_tree),Mt(Re,sn-3,3)):(kt(Re,ve,Re.bl_tree),Mt(Re,sn-11,7));fn=wt,Bi=(sn=0)===tn?(xr=138,3):wt===tn?(xr=6,3):(xr=7,4)}}P(ot);var It=!1;function ke(Re,ut,Xt,rn){Mt(Re,(N<<1)+(rn?1:0),3),function(wt,fn,tn,sn){Dn(wt),St(wt,tn),St(wt,~tn),b.arraySet(wt.pending_buf,wt.window,fn,tn,wt.pending),wt.pending+=tn}(Re,ut,Xt)}_._tr_init=function(Re){It||(function(){var ut,Xt,rn,wt,fn,tn=new Array(X+1);for(wt=rn=0;wt<z-1;wt++)for(nt[wt]=rn,ut=0;ut<1<<Ne[wt];ut++)oe[rn++]=wt;for(oe[rn-1]=wt,wt=fn=0;wt<16;wt++)for(ot[wt]=fn,ut=0;ut<1<<ze[wt];ut++)We[fn++]=wt;for(fn>>=7;wt<B;wt++)for(ot[wt]=fn<<7,ut=0;ut<1<<ze[wt]-7;ut++)We[256+fn++]=wt;for(Xt=0;Xt<=X;Xt++)tn[Xt]=0;for(ut=0;ut<=143;)vt[2*ut+1]=8,ut++,tn[8]++;for(;ut<=255;)vt[2*ut+1]=9,ut++,tn[9]++;for(;ut<=279;)vt[2*ut+1]=7,ut++,tn[7]++;for(;ut<=287;)vt[2*ut+1]=8,ut++,tn[8]++;for(zn(vt,V+1,tn),ut=0;ut<B;ut++)xe[2*ut+1]=5,xe[2*ut]=ct(ut,5);dn=new Wt(vt,Ne,G+1,V,X),Ve=new Wt(xe,ze,0,B,X),Be=new Wt(new Array(0),Me,0,H,te)}(),It=!0),Re.l_desc=new be(Re.dyn_ltree,dn),Re.d_desc=new be(Re.dyn_dtree,Ve),Re.bl_desc=new be(Re.bl_tree,Be),Re.bi_buf=0,Re.bi_valid=0,Vt(Re)},_._tr_stored_block=ke,_._tr_flush_block=function(Re,ut,Xt,rn){var wt,fn,tn=0;0<Re.level?(Re.strm.data_type===2&&(Re.strm.data_type=function(sn){var xr,Bi=4093624447;for(xr=0;xr<=31;xr++,Bi>>>=1)if(1&Bi&&sn.dyn_ltree[2*xr]!==0)return E;if(sn.dyn_ltree[18]!==0||sn.dyn_ltree[20]!==0||sn.dyn_ltree[26]!==0)return T;for(xr=32;xr<G;xr++)if(sn.dyn_ltree[2*xr]!==0)return T;return E}(Re)),ji(Re,Re.l_desc),ji(Re,Re.d_desc),tn=function(sn){var xr;for(he(sn,sn.dyn_ltree,sn.l_desc.max_code),he(sn,sn.dyn_dtree,sn.d_desc.max_code),ji(sn,sn.bl_desc),xr=H-1;3<=xr&&sn.bl_tree[2*He[xr]+1]===0;xr--);return sn.opt_len+=3*(xr+1)+5+5+4,xr}(Re),wt=Re.opt_len+3+7>>>3,(fn=Re.static_len+3+7>>>3)<=wt&&(wt=fn)):wt=fn=Xt+5,Xt+4<=wt&&ut!==-1?ke(Re,ut,Xt,rn):Re.strategy===4||fn===wt?(Mt(Re,2+(rn?1:0),3),Mr(Re,vt,xe)):(Mt(Re,4+(rn?1:0),3),function(sn,xr,Bi,Hr){var r0;for(Mt(sn,xr-257,5),Mt(sn,Bi-1,5),Mt(sn,Hr-4,4),r0=0;r0<Hr;r0++)Mt(sn,sn.bl_tree[2*He[r0]+1],3);Lt(sn,sn.dyn_ltree,xr-1),Lt(sn,sn.dyn_dtree,Bi-1)}(Re,Re.l_desc.max_code+1,Re.d_desc.max_code+1,tn+1),Mr(Re,Re.dyn_ltree,Re.dyn_dtree)),Vt(Re),rn&&Dn(Re)},_._tr_tally=function(Re,ut,Xt){return Re.pending_buf[Re.d_buf+2*Re.last_lit]=ut>>>8&255,Re.pending_buf[Re.d_buf+2*Re.last_lit+1]=255&ut,Re.pending_buf[Re.l_buf+Re.last_lit]=255&Xt,Re.last_lit++,ut===0?Re.dyn_ltree[2*Xt]++:(Re.matches++,ut--,Re.dyn_ltree[2*(oe[Xt]+G+1)]++,Re.dyn_dtree[2*Ce(ut)]++),Re.last_lit===Re.lit_bufsize-1},_._tr_align=function(Re){Mt(Re,2,3),kt(Re,se,vt),function(ut){ut.bi_valid===16?(St(ut,ut.bi_buf),ut.bi_buf=0,ut.bi_valid=0):8<=ut.bi_valid&&(ut.pending_buf[ut.pending++]=255&ut.bi_buf,ut.bi_buf>>=8,ut.bi_valid-=8)}(Re)}},{"../utils/common":41}],53:[function(u,m,_){m.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(u,m,_){(function(b){(function(E,T){if(!E.setImmediate){var P,N,z,G,V=1,B={},H=!1,j=E.document,X=Object.getPrototypeOf&&Object.getPrototypeOf(E);X=X&&X.setTimeout?X:E,P={}.toString.call(E.process)==="[object process]"?function(pe){process.nextTick(function(){te(pe)})}:function(){if(E.postMessage&&!E.importScripts){var pe=!0,fe=E.onmessage;return E.onmessage=function(){pe=!1},E.postMessage("","*"),E.onmessage=fe,pe}}()?(G="setImmediate$"+Math.random()+"$",E.addEventListener?E.addEventListener("message",se,!1):E.attachEvent("onmessage",se),function(pe){E.postMessage(G+pe,"*")}):E.MessageChannel?((z=new MessageChannel).port1.onmessage=function(pe){te(pe.data)},function(pe){z.port2.postMessage(pe)}):j&&"onreadystatechange"in j.createElement("script")?(N=j.documentElement,function(pe){var fe=j.createElement("script");fe.onreadystatechange=function(){te(pe),fe.onreadystatechange=null,N.removeChild(fe),fe=null},N.appendChild(fe)}):function(pe){setTimeout(te,0,pe)},X.setImmediate=function(pe){typeof pe!="function"&&(pe=new Function(""+pe));for(var fe=new Array(arguments.length-1),ve=0;ve<fe.length;ve++)fe[ve]=arguments[ve+1];var Ne={callback:pe,args:fe};return B[V]=Ne,P(V),V++},X.clearImmediate=K}function K(pe){delete B[pe]}function te(pe){if(H)setTimeout(te,0,pe);else{var fe=B[pe];if(fe){H=!0;try{(function(ve){var Ne=ve.callback,ze=ve.args;switch(ze.length){case 0:Ne();break;case 1:Ne(ze[0]);break;case 2:Ne(ze[0],ze[1]);break;case 3:Ne(ze[0],ze[1],ze[2]);break;default:Ne.apply(T,ze)}})(fe)}finally{K(pe),H=!1}}}}function se(pe){pe.source===E&&typeof pe.data=="string"&&pe.data.indexOf(G)===0&&te(+pe.data.slice(G.length))}})(typeof self>"u"?b===void 0?this:b:self)}).call(this,typeof vo<"u"?vo:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}),_O,KM,nee,xO,ree,iee,Ib,see,bO,oee,ZM,Nb,Db,F9,aee,lee,cee,Ev,oc,uee,hee,SO,QM,Bve=k(()=>{_O=Q(qe(),1),KM=Q(qe(),1),nee=s=>typeof s=="function",xO=(s,l)=>nee(s)?s(l):s,ree=(()=>{let s=0;return()=>(++s).toString()})(),iee=20,Ib=new Map,see=1e3,bO=s=>{if(Ib.has(s))return;let l=setTimeout(()=>{Ib.delete(s),F9({type:4,toastId:s})},see);Ib.set(s,l)},oee=s=>{let l=Ib.get(s);l&&clearTimeout(l)},ZM=(s,l)=>{switch(l.type){case 0:return $(R({},s),{toasts:[l.toast,...s.toasts].slice(0,iee)});case 1:return l.toast.id&&oee(l.toast.id),$(R({},s),{toasts:s.toasts.map(b=>b.id===l.toast.id?R(R({},b),l.toast):b)});case 2:let{toast:u}=l;return s.toasts.find(b=>b.id===u.id)?ZM(s,{type:1,toast:u}):ZM(s,{type:0,toast:u});case 3:let{toastId:m}=l;return m?bO(m):s.toasts.forEach(b=>{bO(b.id)}),$(R({},s),{toasts:s.toasts.map(b=>b.id===m||m===void 0?$(R({},b),{visible:!1}):b)});case 4:return l.toastId===void 0?$(R({},s),{toasts:[]}):$(R({},s),{toasts:s.toasts.filter(b=>b.id!==l.toastId)});case 5:return $(R({},s),{pausedAt:l.time});case 6:let _=l.time-(s.pausedAt||0);return $(R({},s),{pausedAt:void 0,toasts:s.toasts.map(b=>$(R({},b),{pauseDuration:b.pauseDuration+_}))})}},Nb=[],Db={toasts:[],pausedAt:void 0},F9=s=>{Db=ZM(Db,s),Nb.forEach(l=>{l(Db)})},aee={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},lee=(s={})=>{let[l,u]=(0,_O.useState)(Db);(0,_O.useEffect)(()=>(Nb.push(u),()=>{let _=Nb.indexOf(u);_>-1&&Nb.splice(_,1)}),[l]);let m=l.toasts.map(_=>{var b,E;return $(R(R(R({},s),s[_.type]),_),{duration:_.duration||((b=s[_.type])==null?void 0:b.duration)||(s==null?void 0:s.duration)||aee[_.type],style:R(R(R({},s.style),(E=s[_.type])==null?void 0:E.style),_.style)})});return $(R({},l),{toasts:m})},cee=(s,l="blank",u)=>$(R({createdAt:Date.now(),visible:!0,type:l,ariaProps:{role:"status","aria-live":"polite"},message:s,pauseDuration:0},u),{id:(u==null?void 0:u.id)||ree()}),Ev=s=>(l,u)=>{let m=cee(l,s,u);return F9({type:2,toast:m}),m.id},oc=(s,l)=>Ev("blank")(s,l),oc.error=Ev("error"),oc.success=Ev("success"),oc.loading=Ev("loading"),oc.custom=Ev("custom"),oc.dismiss=s=>{F9({type:3,toastId:s})},oc.remove=s=>F9({type:4,toastId:s}),oc.promise=(s,l,u)=>{let m=oc.loading(l.loading,R(R({},u),u==null?void 0:u.loading));return s.then(_=>(oc.success(xO(l.success,_),R(R({id:m},u),u==null?void 0:u.success)),_)).catch(_=>{oc.error(xO(l.error,_),R(R({id:m},u),u==null?void 0:u.error))}),s},uee=(s,l)=>{F9({type:1,toast:{id:s,height:l}})},hee=()=>{F9({type:5,time:Date.now()})},SO=s=>{let{toasts:l,pausedAt:u}=lee(s);(0,KM.useEffect)(()=>{if(u)return;let b=Date.now(),E=l.map(T=>{if(T.duration===1/0)return;let P=(T.duration||0)+T.pauseDuration-(b-T.createdAt);if(P<0){T.visible&&oc.dismiss(T.id);return}return setTimeout(()=>oc.dismiss(T.id),P)});return()=>{E.forEach(T=>T&&clearTimeout(T))}},[l,u]);let m=(0,KM.useCallback)(()=>{u&&F9({type:6,time:Date.now()})},[u]),_=(0,KM.useCallback)((b,E)=>{let{reverseOrder:T=!1,gutter:P=8,defaultPosition:N}=E||{},z=l.filter(B=>(B.position||N)===(b.position||N)&&B.height),G=z.findIndex(B=>B.id===b.id),V=z.filter((B,H)=>H<G&&B.visible).length;return z.filter(B=>B.visible).slice(...T?[V+1]:[0,V]).reduce((B,H)=>B+(H.height||0)+P,0)},[l]);return{toasts:l,handlers:{updateHeight:uee,startPause:hee,endPause:m,calculateOffset:_}}},QM=oc});function dee(){return{async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}function Uve(s){G5=s}function Ra(s,l){if(l){if(xee.test(s))return s.replace(bee,wO)}else if(See.test(s))return s.replace(wee,wO);return s}function fee(s){return s.replace(Tee,(l,u)=>(u=u.toLowerCase(),u==="colon"?":":u.charAt(0)==="#"?u.charAt(1)==="x"?String.fromCharCode(parseInt(u.substring(2),16)):String.fromCharCode(+u.substring(1)):""))}function Ss(s,l){s=typeof s=="string"?s:s.source,l=l||"";let u={replace:(m,_)=>(_=_.source||_,_=_.replace(Mee,"$1"),s=s.replace(m,_),u),getRegex:()=>new RegExp(s,l)};return u}function pee(s,l,u){if(s){let m;try{m=decodeURIComponent(fee(u)).replace(Cee,"").toLowerCase()}catch{return null}if(m.indexOf("javascript:")===0||m.indexOf("vbscript:")===0||m.indexOf("data:")===0)return null}l&&!Aee.test(u)&&(u=zve(l,u));try{u=encodeURI(u).replace(/%25/g,"%")}catch{return null}return u}function zve(s,l){Ob[" "+s]||(Pee.test(s)?Ob[" "+s]=s+"/":Ob[" "+s]=JM(s,"/",!0)),s=Ob[" "+s];let u=s.indexOf(":")===-1;return l.substring(0,2)==="//"?u?l:s.replace(Ree,"$1")+l:l.charAt(0)==="/"?u?l:s.replace(kee,"$1")+l:s+l}function Ad(s){let l=1,u,m;for(;l<arguments.length;l++){u=arguments[l];for(m in u)Object.prototype.hasOwnProperty.call(u,m)&&(s[m]=u[m])}return s}function mee(s,l){let u=s.replace(/\|/g,(b,E,T)=>{let P=!1,N=E;for(;--N>=0&&T[N]==="\\";)P=!P;return P?"|":" |"}),m=u.split(/ \|/),_=0;if(m[0].trim()||m.shift(),m.length>0&&!m[m.length-1].trim()&&m.pop(),m.length>l)m.splice(l);else for(;m.length<l;)m.push("");for(;_<m.length;_++)m[_]=m[_].trim().replace(/\\\|/g,"|");return m}function JM(s,l,u){let m=s.length;if(m===0)return"";let _=0;for(;_<m;){let b=s.charAt(m-_-1);if(b===l&&!u)_++;else if(b!==l&&u)_++;else break}return s.slice(0,m-_)}function Vve(s,l){if(s.indexOf(l[1])===-1)return-1;let u=s.length,m=0,_=0;for(;_<u;_++)if(s[_]==="\\")_++;else if(s[_]===l[0])m++;else if(s[_]===l[1]&&(m--,m<0))return _;return-1}function gee(s){s&&s.sanitize&&!s.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function yee(s,l){if(l<1)return"";let u="";for(;l>1;)l&1&&(u+=s),l>>=1,s+=s;return u+s}function vee(s,l,u,m){let _=l.href,b=l.title?Ra(l.title):null,E=s[1].replace(/\\([\[\]])/g,"$1");if(s[0].charAt(0)!=="!"){m.state.inLink=!0;let T={type:"link",raw:u,href:_,title:b,text:E,tokens:m.inlineTokens(E)};return m.state.inLink=!1,T}return{type:"image",raw:u,href:_,title:b,text:Ra(E)}}function Gve(s,l){let u=s.match(/^(\s+)(?:```)/);if(u===null)return l;let m=u[1];return l.split(`
`).map(_=>{let b=_.match(/^\s+/);if(b===null)return _;let[E]=b;return E.length>=m.length?_.slice(m.length):_}).join(`
`)}function jve(s){return s.replace(/---/g,"").replace(/--/g,"").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1").replace(/'/g,"").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1").replace(/"/g,"").replace(/\.{3}/g,"")}function _ee(s){let l="",u,m,_=s.length;for(u=0;u<_;u++)m=s.charCodeAt(u),Math.random()>.5&&(m="x"+m.toString(16)),l+="&#"+m+";";return l}function zr(s,l,u){if(typeof s>"u"||s===null)throw new Error("marked(): input parameter is undefined or null");if(typeof s!="string")throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(s)+", string expected");if(typeof l=="function"&&(u=l,l=null),l=Ad({},zr.defaults,l||{}),gee(l),u){let _=l.highlight,b;try{b=j5.lex(s,l)}catch(P){return u(P)}let E=function(P){let N;if(!P)try{l.walkTokens&&zr.walkTokens(b,l.walkTokens),N=L9.parse(b,l)}catch(z){P=z}return l.highlight=_,P?u(P):u(null,N)};if(!_||_.length<3||(delete l.highlight,!b.length))return E();let T=0;zr.walkTokens(b,function(P){P.type==="code"&&(T++,setTimeout(()=>{_(P.text,P.lang,function(N,z){if(N)return E(N);z!=null&&z!==P.text&&(P.text=z,P.escaped=!0),T--,T===0&&E()})},0))}),T===0&&E();return}function m(_){if(_.message+=`
Please report this to https://github.com/markedjs/marked.`,l.silent)return"<p>An error occurred:</p><pre>"+Ra(_.message+"",!0)+"</pre>";throw _}try{let _=j5.lex(s,l);if(l.walkTokens){if(l.async)return Promise.all(zr.walkTokens(_,l.walkTokens)).then(()=>L9.parse(_,l)).catch(m);zr.walkTokens(_,l.walkTokens)}return L9.parse(_,l)}catch(_){m(_)}}var G5,xee,bee,See,wee,Eee,wO,Tee,Mee,Cee,Aee,Ob,Pee,Ree,kee,Fb,eC,Rr,tr,j5,tC,EO,TO,L9,Hve=k(()=>{G5=dee(),xee=/[&<>"']/,bee=/[&<>"']/g,See=/[<>"']|&(?!#?\w+;)/,wee=/[<>"']|&(?!#?\w+;)/g,Eee={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},wO=s=>Eee[s],Tee=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,Mee=/(^|[^\[])\^/g,Cee=/[^\w:]/g,Aee=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i,Ob={},Pee=/^[^:]+:\/*[^/]*$/,Ree=/^([^:]+:)[\s\S]*$/,kee=/^([^:]+:\/*[^/]*)[\s\S]*$/,Fb={exec:function(){}},eC=class{constructor(s){this.options=s||G5}space(s){let l=this.rules.block.newline.exec(s);if(l&&l[0].length>0)return{type:"space",raw:l[0]}}code(s){let l=this.rules.block.code.exec(s);if(l){let u=l[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:l[0],codeBlockStyle:"indented",text:this.options.pedantic?u:JM(u,`
`)}}}fences(s){let l=this.rules.block.fences.exec(s);if(l){let u=l[0],m=Gve(u,l[3]||"");return{type:"code",raw:u,lang:l[2]?l[2].trim():l[2],text:m}}}heading(s){let l=this.rules.block.heading.exec(s);if(l){let u=l[2].trim();if(/#$/.test(u)){let m=JM(u,"#");(this.options.pedantic||!m||/ $/.test(m))&&(u=m.trim())}return{type:"heading",raw:l[0],depth:l[1].length,text:u,tokens:this.lexer.inline(u)}}}hr(s){let l=this.rules.block.hr.exec(s);if(l)return{type:"hr",raw:l[0]}}blockquote(s){let l=this.rules.block.blockquote.exec(s);if(l){let u=l[0].replace(/^ *>[ \t]?/gm,"");return{type:"blockquote",raw:l[0],tokens:this.lexer.blockTokens(u,[]),text:u}}}list(s){let l=this.rules.block.list.exec(s);if(l){let u,m,_,b,E,T,P,N,z,G,V,B,H=l[1].trim(),j=H.length>1,X={type:"list",raw:"",ordered:j,start:j?+H.slice(0,-1):"",loose:!1,items:[]};H=j?"\\d{1,9}\\".concat(H.slice(-1)):"\\".concat(H),this.options.pedantic&&(H=j?H:"[*+-]");let K=new RegExp("^( {0,3}".concat(H,")((?:[	 ][^\\n]*)?(?:\\n|$))"));for(;s&&(B=!1,!(!(l=K.exec(s))||this.rules.block.hr.test(s)));){if(u=l[0],s=s.substring(u.length),N=l[2].split(`
`,1)[0],z=s.split(`
`,1)[0],this.options.pedantic?(b=2,V=N.trimLeft()):(b=l[2].search(/[^ ]/),b=b>4?1:b,V=N.slice(b),b+=l[1].length),T=!1,!N&&/^ *$/.test(z)&&(u+=z+`
`,s=s.substring(z.length+1),B=!0),!B){let se=new RegExp("^ {0,".concat(Math.min(3,b-1),"}(?:[*+-]|\\d{1,9}[.)])((?: [^\\n]*)?(?:\\n|$))")),pe=new RegExp("^ {0,".concat(Math.min(3,b-1),"}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)")),fe=new RegExp("^ {0,".concat(Math.min(3,b-1),"}(?:```|~~~)")),ve=new RegExp("^ {0,".concat(Math.min(3,b-1),"}#"));for(;s&&(G=s.split(`
`,1)[0],N=G,this.options.pedantic&&(N=N.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!(fe.test(N)||ve.test(N)||se.test(N)||pe.test(s)));){if(N.search(/[^ ]/)>=b||!N.trim())V+=`
`+N.slice(b);else if(!T)V+=`
`+N;else break;!T&&!N.trim()&&(T=!0),u+=G+`
`,s=s.substring(G.length+1)}}X.loose||(P?X.loose=!0:/\n *\n *$/.test(u)&&(P=!0)),this.options.gfm&&(m=/^\[[ xX]\] /.exec(V),m&&(_=m[0]!=="[ ] ",V=V.replace(/^\[[ xX]\] +/,""))),X.items.push({type:"list_item",raw:u,task:!!m,checked:_,loose:!1,text:V}),X.raw+=u}X.items[X.items.length-1].raw=u.trimRight(),X.items[X.items.length-1].text=V.trimRight(),X.raw=X.raw.trimRight();let te=X.items.length;for(E=0;E<te;E++){this.lexer.state.top=!1,X.items[E].tokens=this.lexer.blockTokens(X.items[E].text,[]);let se=X.items[E].tokens.filter(fe=>fe.type==="space"),pe=se.every(fe=>{let ve=fe.raw.split(""),Ne=0;for(let ze of ve)if(ze===`
`&&(Ne+=1),Ne>1)return!0;return!1});!X.loose&&se.length&&pe&&(X.loose=!0,X.items[E].loose=!0)}return X}}html(s){let l=this.rules.block.html.exec(s);if(l){let u={type:"html",raw:l[0],pre:!this.options.sanitizer&&(l[1]==="pre"||l[1]==="script"||l[1]==="style"),text:l[0]};if(this.options.sanitize){let m=this.options.sanitizer?this.options.sanitizer(l[0]):Ra(l[0]);u.type="paragraph",u.text=m,u.tokens=this.lexer.inline(m)}return u}}def(s){let l=this.rules.block.def.exec(s);if(l)return l[3]&&(l[3]=l[3].substring(1,l[3].length-1)),{type:"def",tag:l[1].toLowerCase().replace(/\s+/g," "),raw:l[0],href:l[2],title:l[3]}}table(s){let l=this.rules.block.table.exec(s);if(l){let u={type:"table",header:mee(l[1]).map(m=>({text:m})),align:l[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:l[3]&&l[3].trim()?l[3].replace(/\n[ \t]*$/,"").split(`
`):[]};if(u.header.length===u.align.length){u.raw=l[0];let m=u.align.length,_,b,E,T;for(_=0;_<m;_++)/^ *-+: *$/.test(u.align[_])?u.align[_]="right":/^ *:-+: *$/.test(u.align[_])?u.align[_]="center":/^ *:-+ *$/.test(u.align[_])?u.align[_]="left":u.align[_]=null;for(m=u.rows.length,_=0;_<m;_++)u.rows[_]=mee(u.rows[_],u.header.length).map(P=>({text:P}));for(m=u.header.length,b=0;b<m;b++)u.header[b].tokens=this.lexer.inline(u.header[b].text);for(m=u.rows.length,b=0;b<m;b++)for(T=u.rows[b],E=0;E<T.length;E++)T[E].tokens=this.lexer.inline(T[E].text);return u}}}lheading(s){let l=this.rules.block.lheading.exec(s);if(l)return{type:"heading",raw:l[0],depth:l[2].charAt(0)==="="?1:2,text:l[1],tokens:this.lexer.inline(l[1])}}paragraph(s){let l=this.rules.block.paragraph.exec(s);if(l){let u=l[1].charAt(l[1].length-1)===`
`?l[1].slice(0,-1):l[1];return{type:"paragraph",raw:l[0],text:u,tokens:this.lexer.inline(u)}}}text(s){let l=this.rules.block.text.exec(s);if(l)return{type:"text",raw:l[0],text:l[0],tokens:this.lexer.inline(l[0])}}escape(s){let l=this.rules.inline.escape.exec(s);if(l)return{type:"escape",raw:l[0],text:Ra(l[1])}}tag(s){let l=this.rules.inline.tag.exec(s);if(l)return!this.lexer.state.inLink&&/^<a /i.test(l[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(l[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(l[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(l[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:l[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(l[0]):Ra(l[0]):l[0]}}link(s){let l=this.rules.inline.link.exec(s);if(l){let u=l[2].trim();if(!this.options.pedantic&&/^</.test(u)){if(!/>$/.test(u))return;let b=JM(u.slice(0,-1),"\\");if((u.length-b.length)%2===0)return}else{let b=Vve(l[2],"()");if(b>-1){let E=(l[0].indexOf("!")===0?5:4)+l[1].length+b;l[2]=l[2].substring(0,b),l[0]=l[0].substring(0,E).trim(),l[3]=""}}let m=l[2],_="";if(this.options.pedantic){let b=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(m);b&&(m=b[1],_=b[3])}else _=l[3]?l[3].slice(1,-1):"";return m=m.trim(),/^</.test(m)&&(this.options.pedantic&&!/>$/.test(u)?m=m.slice(1):m=m.slice(1,-1)),vee(l,{href:m&&m.replace(this.rules.inline._escapes,"$1"),title:_&&_.replace(this.rules.inline._escapes,"$1")},l[0],this.lexer)}}reflink(s,l){let u;if((u=this.rules.inline.reflink.exec(s))||(u=this.rules.inline.nolink.exec(s))){let m=(u[2]||u[1]).replace(/\s+/g," ");if(m=l[m.toLowerCase()],!m||!m.href){let _=u[0].charAt(0);return{type:"text",raw:_,text:_}}return vee(u,m,u[0],this.lexer)}}emStrong(s,l,u=""){let m=this.rules.inline.emStrong.lDelim.exec(s);if(!m||m[3]&&u.match(/[\p{L}\p{N}]/u))return;let _=m[1]||m[2]||"";if(!_||_&&(u===""||this.rules.inline.punctuation.exec(u))){let b=m[0].length-1,E,T,P=b,N=0,z=m[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(z.lastIndex=0,l=l.slice(-1*s.length+b);(m=z.exec(l))!=null;){if(E=m[1]||m[2]||m[3]||m[4]||m[5]||m[6],!E)continue;if(T=E.length,m[3]||m[4]){P+=T;continue}else if((m[5]||m[6])&&b%3&&!((b+T)%3)){N+=T;continue}if(P-=T,P>0)continue;if(T=Math.min(T,T+P+N),Math.min(b,T)%2){let V=s.slice(1,b+m.index+T);return{type:"em",raw:s.slice(0,b+m.index+T+1),text:V,tokens:this.lexer.inlineTokens(V)}}let G=s.slice(2,b+m.index+T-1);return{type:"strong",raw:s.slice(0,b+m.index+T+1),text:G,tokens:this.lexer.inlineTokens(G)}}}}codespan(s){let l=this.rules.inline.code.exec(s);if(l){let u=l[2].replace(/\n/g," "),m=/[^ ]/.test(u),_=/^ /.test(u)&&/ $/.test(u);return m&&_&&(u=u.substring(1,u.length-1)),u=Ra(u,!0),{type:"codespan",raw:l[0],text:u}}}br(s){let l=this.rules.inline.br.exec(s);if(l)return{type:"br",raw:l[0]}}del(s){let l=this.rules.inline.del.exec(s);if(l)return{type:"del",raw:l[0],text:l[2],tokens:this.lexer.inlineTokens(l[2])}}autolink(s,l){let u=this.rules.inline.autolink.exec(s);if(u){let m,_;return u[2]==="@"?(m=Ra(this.options.mangle?l(u[1]):u[1]),_="mailto:"+m):(m=Ra(u[1]),_=m),{type:"link",raw:u[0],text:m,href:_,tokens:[{type:"text",raw:m,text:m}]}}}url(s,l){let u;if(u=this.rules.inline.url.exec(s)){let m,_;if(u[2]==="@")m=Ra(this.options.mangle?l(u[0]):u[0]),_="mailto:"+m;else{let b;do b=u[0],u[0]=this.rules.inline._backpedal.exec(u[0])[0];while(b!==u[0]);m=Ra(u[0]),u[1]==="www."?_="http://"+m:_=m}return{type:"link",raw:u[0],text:m,href:_,tokens:[{type:"text",raw:m,text:m}]}}}inlineText(s,l){let u=this.rules.inline.text.exec(s);if(u){let m;return this.lexer.state.inRawBlock?m=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(u[0]):Ra(u[0]):u[0]:m=Ra(this.options.smartypants?l(u[0]):u[0]),{type:"text",raw:u[0],text:m}}}},Rr={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?<?([^\s>]+)>?(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:Fb,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/},Rr._label=/(?!\s*\])(?:\\.|[^\[\]\\])+/,Rr._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/,Rr.def=Ss(Rr.def).replace("label",Rr._label).replace("title",Rr._title).getRegex(),Rr.bullet=/(?:[*+-]|\d{1,9}[.)])/,Rr.listItemStart=Ss(/^( *)(bull) */).replace("bull",Rr.bullet).getRegex(),Rr.list=Ss(Rr.list).replace(/bull/g,Rr.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+Rr.def.source+")").getRegex(),Rr._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Rr._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,Rr.html=Ss(Rr.html,"i").replace("comment",Rr._comment).replace("tag",Rr._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Rr.paragraph=Ss(Rr._paragraph).replace("hr",Rr.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Rr._tag).getRegex(),Rr.blockquote=Ss(Rr.blockquote).replace("paragraph",Rr.paragraph).getRegex(),Rr.normal=Ad({},Rr),Rr.gfm=Ad({},Rr.normal,{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),Rr.gfm.table=Ss(Rr.gfm.table).replace("hr",Rr.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Rr._tag).getRegex(),Rr.gfm.paragraph=Ss(Rr._paragraph).replace("hr",Rr.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",Rr.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Rr._tag).getRegex(),Rr.pedantic=Ad({},Rr.normal,{html:Ss(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Rr._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Fb,paragraph:Ss(Rr.normal._paragraph).replace("hr",Rr.hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Rr.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()}),tr={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:Fb,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^[^_*]*?\_\_[^_*]*?\*[^_*]*?(?=\_\_)|[^*]+(?=[^*])|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/^[^_*]*?\*\*[^_*]*?\_[^_*]*?(?=\*\*)|[^_]+(?=[^_])|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:Fb,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/},tr._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~",tr.punctuation=Ss(tr.punctuation).replace(/punctuation/g,tr._punctuation).getRegex(),tr.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,tr.escapedEmSt=/\\\*|\\_/g,tr._comment=Ss(Rr._comment).replace("(?:-->|$)","-->").getRegex(),tr.emStrong.lDelim=Ss(tr.emStrong.lDelim).replace(/punct/g,tr._punctuation).getRegex(),tr.emStrong.rDelimAst=Ss(tr.emStrong.rDelimAst,"g").replace(/punct/g,tr._punctuation).getRegex(),tr.emStrong.rDelimUnd=Ss(tr.emStrong.rDelimUnd,"g").replace(/punct/g,tr._punctuation).getRegex(),tr._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,tr._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,tr._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,tr.autolink=Ss(tr.autolink).replace("scheme",tr._scheme).replace("email",tr._email).getRegex(),tr._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,tr.tag=Ss(tr.tag).replace("comment",tr._comment).replace("attribute",tr._attribute).getRegex(),tr._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,tr._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,tr._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,tr.link=Ss(tr.link).replace("label",tr._label).replace("href",tr._href).replace("title",tr._title).getRegex(),tr.reflink=Ss(tr.reflink).replace("label",tr._label).replace("ref",Rr._label).getRegex(),tr.nolink=Ss(tr.nolink).replace("ref",Rr._label).getRegex(),tr.reflinkSearch=Ss(tr.reflinkSearch,"g").replace("reflink",tr.reflink).replace("nolink",tr.nolink).getRegex(),tr.normal=Ad({},tr),tr.pedantic=Ad({},tr.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:Ss(/^!?\[(label)\]\((.*?)\)/).replace("label",tr._label).getRegex(),reflink:Ss(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",tr._label).getRegex()}),tr.gfm=Ad({},tr.normal,{escape:Ss(tr.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),tr.gfm.url=Ss(tr.gfm.url,"i").replace("email",tr.gfm._extended_email).getRegex(),tr.breaks=Ad({},tr.gfm,{br:Ss(tr.br).replace("{2,}","*").getRegex(),text:Ss(tr.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()}),j5=class SG{constructor(l){this.tokens=[],this.tokens.links=Object.create(null),this.options=l||G5,this.options.tokenizer=this.options.tokenizer||new eC,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let u={block:Rr.normal,inline:tr.normal};this.options.pedantic?(u.block=Rr.pedantic,u.inline=tr.pedantic):this.options.gfm&&(u.block=Rr.gfm,this.options.breaks?u.inline=tr.breaks:u.inline=tr.gfm),this.tokenizer.rules=u}static get rules(){return{block:Rr,inline:tr}}static lex(l,u){return new SG(u).lex(l)}static lexInline(l,u){return new SG(u).inlineTokens(l)}lex(l){l=l.replace(/\r\n|\r/g,`
`),this.blockTokens(l,this.tokens);let u;for(;u=this.inlineQueue.shift();)this.inlineTokens(u.src,u.tokens);return this.tokens}blockTokens(l,u=[]){this.options.pedantic?l=l.replace(/\t/g,"    ").replace(/^ +$/gm,""):l=l.replace(/^( *)(\t+)/gm,(T,P,N)=>P+"    ".repeat(N.length));let m,_,b,E;for(;l;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(T=>(m=T.call({lexer:this},l,u))?(l=l.substring(m.raw.length),u.push(m),!0):!1))){if(m=this.tokenizer.space(l)){l=l.substring(m.raw.length),m.raw.length===1&&u.length>0?u[u.length-1].raw+=`
`:u.push(m);continue}if(m=this.tokenizer.code(l)){l=l.substring(m.raw.length),_=u[u.length-1],_&&(_.type==="paragraph"||_.type==="text")?(_.raw+=`
`+m.raw,_.text+=`
`+m.text,this.inlineQueue[this.inlineQueue.length-1].src=_.text):u.push(m);continue}if(m=this.tokenizer.fences(l)){l=l.substring(m.raw.length),u.push(m);continue}if(m=this.tokenizer.heading(l)){l=l.substring(m.raw.length),u.push(m);continue}if(m=this.tokenizer.hr(l)){l=l.substring(m.raw.length),u.push(m);continue}if(m=this.tokenizer.blockquote(l)){l=l.substring(m.raw.length),u.push(m);continue}if(m=this.tokenizer.list(l)){l=l.substring(m.raw.length),u.push(m);continue}if(m=this.tokenizer.html(l)){l=l.substring(m.raw.length),u.push(m);continue}if(m=this.tokenizer.def(l)){l=l.substring(m.raw.length),_=u[u.length-1],_&&(_.type==="paragraph"||_.type==="text")?(_.raw+=`
`+m.raw,_.text+=`
`+m.raw,this.inlineQueue[this.inlineQueue.length-1].src=_.text):this.tokens.links[m.tag]||(this.tokens.links[m.tag]={href:m.href,title:m.title});continue}if(m=this.tokenizer.table(l)){l=l.substring(m.raw.length),u.push(m);continue}if(m=this.tokenizer.lheading(l)){l=l.substring(m.raw.length),u.push(m);continue}if(b=l,this.options.extensions&&this.options.extensions.startBlock){let T=1/0,P=l.slice(1),N;this.options.extensions.startBlock.forEach(function(z){N=z.call({lexer:this},P),typeof N=="number"&&N>=0&&(T=Math.min(T,N))}),T<1/0&&T>=0&&(b=l.substring(0,T+1))}if(this.state.top&&(m=this.tokenizer.paragraph(b))){_=u[u.length-1],E&&_.type==="paragraph"?(_.raw+=`
`+m.raw,_.text+=`
`+m.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=_.text):u.push(m),E=b.length!==l.length,l=l.substring(m.raw.length);continue}if(m=this.tokenizer.text(l)){l=l.substring(m.raw.length),_=u[u.length-1],_&&_.type==="text"?(_.raw+=`
`+m.raw,_.text+=`
`+m.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=_.text):u.push(m);continue}if(l){let T="Infinite loop on byte: "+l.charCodeAt(0);if(this.options.silent){console.error(T);break}else throw new Error(T)}}return this.state.top=!0,u}inline(l,u=[]){return this.inlineQueue.push({src:l,tokens:u}),u}inlineTokens(l,u=[]){let m,_,b,E=l,T,P,N;if(this.tokens.links){let z=Object.keys(this.tokens.links);if(z.length>0)for(;(T=this.tokenizer.rules.inline.reflinkSearch.exec(E))!=null;)z.includes(T[0].slice(T[0].lastIndexOf("[")+1,-1))&&(E=E.slice(0,T.index)+"["+yee("a",T[0].length-2)+"]"+E.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(T=this.tokenizer.rules.inline.blockSkip.exec(E))!=null;)E=E.slice(0,T.index)+"["+yee("a",T[0].length-2)+"]"+E.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(T=this.tokenizer.rules.inline.escapedEmSt.exec(E))!=null;)E=E.slice(0,T.index)+"++"+E.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;l;)if(P||(N=""),P=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(z=>(m=z.call({lexer:this},l,u))?(l=l.substring(m.raw.length),u.push(m),!0):!1))){if(m=this.tokenizer.escape(l)){l=l.substring(m.raw.length),u.push(m);continue}if(m=this.tokenizer.tag(l)){l=l.substring(m.raw.length),_=u[u.length-1],_&&m.type==="text"&&_.type==="text"?(_.raw+=m.raw,_.text+=m.text):u.push(m);continue}if(m=this.tokenizer.link(l)){l=l.substring(m.raw.length),u.push(m);continue}if(m=this.tokenizer.reflink(l,this.tokens.links)){l=l.substring(m.raw.length),_=u[u.length-1],_&&m.type==="text"&&_.type==="text"?(_.raw+=m.raw,_.text+=m.text):u.push(m);continue}if(m=this.tokenizer.emStrong(l,E,N)){l=l.substring(m.raw.length),u.push(m);continue}if(m=this.tokenizer.codespan(l)){l=l.substring(m.raw.length),u.push(m);continue}if(m=this.tokenizer.br(l)){l=l.substring(m.raw.length),u.push(m);continue}if(m=this.tokenizer.del(l)){l=l.substring(m.raw.length),u.push(m);continue}if(m=this.tokenizer.autolink(l,_ee)){l=l.substring(m.raw.length),u.push(m);continue}if(!this.state.inLink&&(m=this.tokenizer.url(l,_ee))){l=l.substring(m.raw.length),u.push(m);continue}if(b=l,this.options.extensions&&this.options.extensions.startInline){let z=1/0,G=l.slice(1),V;this.options.extensions.startInline.forEach(function(B){V=B.call({lexer:this},G),typeof V=="number"&&V>=0&&(z=Math.min(z,V))}),z<1/0&&z>=0&&(b=l.substring(0,z+1))}if(m=this.tokenizer.inlineText(b,jve)){l=l.substring(m.raw.length),m.raw.slice(-1)!=="_"&&(N=m.raw.slice(-1)),P=!0,_=u[u.length-1],_&&_.type==="text"?(_.raw+=m.raw,_.text+=m.text):u.push(m);continue}if(l){let z="Infinite loop on byte: "+l.charCodeAt(0);if(this.options.silent){console.error(z);break}else throw new Error(z)}}return u}},tC=class{constructor(s){this.options=s||G5}code(s,l,u){let m=(l||"").match(/\S*/)[0];if(this.options.highlight){let _=this.options.highlight(s,m);_!=null&&_!==s&&(u=!0,s=_)}return s=s.replace(/\n$/,"")+`
`,m?'<pre><code class="'+this.options.langPrefix+Ra(m,!0)+'">'+(u?s:Ra(s,!0))+`</code></pre>
`:"<pre><code>"+(u?s:Ra(s,!0))+`</code></pre>
`}blockquote(s){return`<blockquote>
`.concat(s,`</blockquote>
`)}html(s){return s}heading(s,l,u,m){if(this.options.headerIds){let _=this.options.headerPrefix+m.slug(u);return"<h".concat(l,' id="').concat(_,'">').concat(s,"</h").concat(l,`>
`)}return"<h".concat(l,">").concat(s,"</h").concat(l,`>
`)}hr(){return this.options.xhtml?`<hr/>
`:`<hr>
`}list(s,l,u){let m=l?"ol":"ul",_=l&&u!==1?' start="'+u+'"':"";return"<"+m+_+`>
`+s+"</"+m+`>
`}listitem(s){return"<li>".concat(s,`</li>
`)}checkbox(s){return"<input "+(s?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(s){return"<p>".concat(s,`</p>
`)}table(s,l){return l&&(l="<tbody>".concat(l,"</tbody>")),`<table>
<thead>
`+s+`</thead>
`+l+`</table>
`}tablerow(s){return`<tr>
`.concat(s,`</tr>
`)}tablecell(s,l){let u=l.header?"th":"td";return(l.align?"<".concat(u,' align="').concat(l.align,'">'):"<".concat(u,">"))+s+"</".concat(u,`>
`)}strong(s){return"<strong>".concat(s,"</strong>")}em(s){return"<em>".concat(s,"</em>")}codespan(s){return"<code>".concat(s,"</code>")}br(){return this.options.xhtml?"<br/>":"<br>"}del(s){return"<del>".concat(s,"</del>")}link(s,l,u){if(s=pee(this.options.sanitize,this.options.baseUrl,s),s===null)return u;let m='<a href="'+Ra(s)+'"';return l&&(m+=' title="'+l+'"'),m+=">"+u+"</a>",m}image(s,l,u){if(s=pee(this.options.sanitize,this.options.baseUrl,s),s===null)return u;let m='<img src="'.concat(s,'" alt="').concat(u,'"');return l&&(m+=' title="'.concat(l,'"')),m+=this.options.xhtml?"/>":">",m}text(s){return s}},EO=class{strong(s){return s}em(s){return s}codespan(s){return s}del(s){return s}html(s){return s}text(s){return s}link(s,l,u){return""+u}image(s,l,u){return""+u}br(){return""}},TO=class{constructor(){this.seen={}}serialize(s){return s.toLowerCase().trim().replace(/<[!\/a-z].*?>/ig,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(s,l){let u=s,m=0;if(this.seen.hasOwnProperty(u)){m=this.seen[s];do m++,u=s+"-"+m;while(this.seen.hasOwnProperty(u))}return l||(this.seen[s]=m,this.seen[u]=0),u}slug(s,l={}){let u=this.serialize(s);return this.getNextSafeSlug(u,l.dryrun)}},L9=class wG{constructor(l){this.options=l||G5,this.options.renderer=this.options.renderer||new tC,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new EO,this.slugger=new TO}static parse(l,u){return new wG(u).parse(l)}static parseInline(l,u){return new wG(u).parseInline(l)}parse(l,u=!0){let m="",_,b,E,T,P,N,z,G,V,B,H,j,X,K,te,se,pe,fe,ve,Ne=l.length;for(_=0;_<Ne;_++){if(B=l[_],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[B.type]&&(ve=this.options.extensions.renderers[B.type].call({parser:this},B),ve!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(B.type))){m+=ve||"";continue}switch(B.type){case"space":continue;case"hr":{m+=this.renderer.hr();continue}case"heading":{m+=this.renderer.heading(this.parseInline(B.tokens),B.depth,fee(this.parseInline(B.tokens,this.textRenderer)),this.slugger);continue}case"code":{m+=this.renderer.code(B.text,B.lang,B.escaped);continue}case"table":{for(G="",z="",T=B.header.length,b=0;b<T;b++)z+=this.renderer.tablecell(this.parseInline(B.header[b].tokens),{header:!0,align:B.align[b]});for(G+=this.renderer.tablerow(z),V="",T=B.rows.length,b=0;b<T;b++){for(N=B.rows[b],z="",P=N.length,E=0;E<P;E++)z+=this.renderer.tablecell(this.parseInline(N[E].tokens),{header:!1,align:B.align[E]});V+=this.renderer.tablerow(z)}m+=this.renderer.table(G,V);continue}case"blockquote":{V=this.parse(B.tokens),m+=this.renderer.blockquote(V);continue}case"list":{for(H=B.ordered,j=B.start,X=B.loose,T=B.items.length,V="",b=0;b<T;b++)te=B.items[b],se=te.checked,pe=te.task,K="",te.task&&(fe=this.renderer.checkbox(se),X?te.tokens.length>0&&te.tokens[0].type==="paragraph"?(te.tokens[0].text=fe+" "+te.tokens[0].text,te.tokens[0].tokens&&te.tokens[0].tokens.length>0&&te.tokens[0].tokens[0].type==="text"&&(te.tokens[0].tokens[0].text=fe+" "+te.tokens[0].tokens[0].text)):te.tokens.unshift({type:"text",text:fe}):K+=fe),K+=this.parse(te.tokens,X),V+=this.renderer.listitem(K,pe,se);m+=this.renderer.list(V,H,j);continue}case"html":{m+=this.renderer.html(B.text);continue}case"paragraph":{m+=this.renderer.paragraph(this.parseInline(B.tokens));continue}case"text":{for(V=B.tokens?this.parseInline(B.tokens):B.text;_+1<Ne&&l[_+1].type==="text";)B=l[++_],V+=`
`+(B.tokens?this.parseInline(B.tokens):B.text);m+=u?this.renderer.paragraph(V):V;continue}default:{let ze='Token with "'+B.type+'" type was not found.';if(this.options.silent){console.error(ze);return}else throw new Error(ze)}}}return m}parseInline(l,u){u=u||this.renderer;let m="",_,b,E,T=l.length;for(_=0;_<T;_++){if(b=l[_],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[b.type]&&(E=this.options.extensions.renderers[b.type].call({parser:this},b),E!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(b.type))){m+=E||"";continue}switch(b.type){case"escape":{m+=u.text(b.text);break}case"html":{m+=u.html(b.text);break}case"link":{m+=u.link(b.href,b.title,this.parseInline(b.tokens,u));break}case"image":{m+=u.image(b.href,b.title,b.text);break}case"strong":{m+=u.strong(this.parseInline(b.tokens,u));break}case"em":{m+=u.em(this.parseInline(b.tokens,u));break}case"codespan":{m+=u.codespan(b.text);break}case"br":{m+=u.br();break}case"del":{m+=u.del(this.parseInline(b.tokens,u));break}case"text":{m+=u.text(b.text);break}default:{let P='Token with "'+b.type+'" type was not found.';if(this.options.silent){console.error(P);return}else throw new Error(P)}}}return m}},zr.options=zr.setOptions=function(s){return Ad(zr.defaults,s),Uve(zr.defaults),zr},zr.getDefaults=dee,zr.defaults=G5,zr.use=function(...s){let l=Ad({},...s),u=zr.defaults.extensions||{renderers:{},childTokens:{}},m;s.forEach(_=>{if(_.extensions&&(m=!0,_.extensions.forEach(b=>{if(!b.name)throw new Error("extension name required");if(b.renderer){let E=u.renderers?u.renderers[b.name]:null;E?u.renderers[b.name]=function(...T){let P=b.renderer.apply(this,T);return P===!1&&(P=E.apply(this,T)),P}:u.renderers[b.name]=b.renderer}if(b.tokenizer){if(!b.level||b.level!=="block"&&b.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");u[b.level]?u[b.level].unshift(b.tokenizer):u[b.level]=[b.tokenizer],b.start&&(b.level==="block"?u.startBlock?u.startBlock.push(b.start):u.startBlock=[b.start]:b.level==="inline"&&(u.startInline?u.startInline.push(b.start):u.startInline=[b.start]))}b.childTokens&&(u.childTokens[b.name]=b.childTokens)})),_.renderer){let b=zr.defaults.renderer||new tC;for(let E in _.renderer){let T=b[E];b[E]=(...P)=>{let N=_.renderer[E].apply(b,P);return N===!1&&(N=T.apply(b,P)),N}}l.renderer=b}if(_.tokenizer){let b=zr.defaults.tokenizer||new eC;for(let E in _.tokenizer){let T=b[E];b[E]=(...P)=>{let N=_.tokenizer[E].apply(b,P);return N===!1&&(N=T.apply(b,P)),N}}l.tokenizer=b}if(_.walkTokens){let b=zr.defaults.walkTokens;l.walkTokens=function(E){let T=[];return T.push(_.walkTokens.call(this,E)),b&&(T=T.concat(b.call(this,E))),T}}m&&(l.extensions=u),zr.setOptions(l)})},zr.walkTokens=function(s,l){let u=[];for(let m of s)switch(u=u.concat(l.call(zr,m)),m.type){case"table":{for(let _ of m.header)u=u.concat(zr.walkTokens(_.tokens,l));for(let _ of m.rows)for(let b of _)u=u.concat(zr.walkTokens(b.tokens,l));break}case"list":{u=u.concat(zr.walkTokens(m.items,l));break}default:zr.defaults.extensions&&zr.defaults.extensions.childTokens&&zr.defaults.extensions.childTokens[m.type]?zr.defaults.extensions.childTokens[m.type].forEach(function(_){u=u.concat(zr.walkTokens(m[_],l))}):m.tokens&&(u=u.concat(zr.walkTokens(m.tokens,l)))}return u},zr.parseInline=function(s,l){if(typeof s>"u"||s===null)throw new Error("marked.parseInline(): input parameter is undefined or null");if(typeof s!="string")throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(s)+", string expected");l=Ad({},zr.defaults,l||{}),gee(l);try{let u=j5.lexInline(s,l);return l.walkTokens&&zr.walkTokens(u,l.walkTokens),L9.parseInline(u,l)}catch(u){if(u.message+=`
Please report this to https://github.com/markedjs/marked.`,l.silent)return"<p>An error occurred:</p><pre>"+Ra(u.message+"",!0)+"</pre>";throw u}},zr.Parser=L9,zr.parser=L9.parse,zr.Renderer=tC,zr.TextRenderer=EO,zr.Lexer=j5,zr.lexer=j5.lex,zr.Tokenizer=eC,zr.Slugger=TO,zr.parse=zr,zr.options,zr.setOptions,zr.use,zr.walkTokens,zr.parseInline,L9.parse,j5.lex}),Iee,Nee,MO,Dee=k(()=>{Ft(),YM(),Nee=Te(wv)(Iee||(Iee=J([`
  padding: 6px;
`]))),MO=Nee}),Bo,nC,Lb,rC,Oee,Fee,Lee,CO,Bee,Uee,zee,AO,Vee,Gee,jee,Hee,Wee,Bb,Ub,$ee,qee,Xee,Yee,Kee,Zee,Qee,Jee,ete,tte,nte,rte,PO,zb=k(()=>{Bo=Q(qe()),Bve(),Ft(),Li(),er(),Ae(),Hve(),kb(),Dee(),nC=({title:s,message:l})=>"".concat(s," ").concat(l),Lb=(()=>{let s=new Map;return{add:l=>{let u=nC(l);s.has(u)?s.set(u,s.get(u)+1):s.set(u,1)},delete:l=>{let u=nC(l);s.has(u)&&s.get(u)>1?s.set(u,s.get(u)-1):s.delete(u)},clear:()=>{s.clear()},check:l=>s.has(nC(l))}})(),rC=(()=>{let s=new Map;return{add:l=>{s.has(l)?s.set(l,s.get(l)+1):s.set(l,1)},delete:l=>{s.has(l)&&s.get(l)>1?s.set(l,s.get(l)-1):s.delete(l)},clear:()=>{s.clear()},check:l=>s.has(l),get types(){return Array.of(...s.keys())}}})(),Fee=Te.div(Oee||(Oee=J([`
  width: 100%;
  border-radius: 4px;
  display: flex;
  gap: 12px;
  `,`;
  background-color: rgba(40, 43, 47, 0.8);
  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.25), 0 2px 6px rgba(0, 0, 0, 0.15);
  backdrop-filter: blur(14px);

  @supports not (backdrop-filter: blur()) {
    background: rgba(40, 43, 47, 0.95);
  }
`])),Di),CO=Te.div(Lee||(Lee=J([`
  font-size: 14px;
  font-weight: bold;
  color: #fff;
`]))),Uee=Te.div(Bee||(Bee=J([`
  flex: 1;
  flex-direction: column;
  width: 0;
  display: flex;
  padding: 16px 0;
  gap: 12px;
`]))),AO=Te.div(zee||(zee=J([`
  color: #b4b4b4;
  font-size: 12px;
  line-height: 1.4;

  a {
    color: rgba(255, 255, 255, 0.9);
  }

  em {
    font-style: italic;
  }

  strong {
    font-weight: bold;
    color: #d5d5d5;
  }

  p {
    margin-bottom: 8px;
  }

  code {
    font-family: monospace;
    background: rgba(0, 0, 0, 0.3);
    padding: 1px 1px 2px;
    border-radius: 4px;
    border: 1px solid rgba(255, 255, 255, 0.08);
    white-space: pre-wrap;
  }

  pre > code {
    white-space: pre;
    display: block;
    overflow: auto;
    padding: 4px;
  }

  pre {
    white-space: pre-wrap;
    margin-bottom: 8px;
  }
`]))),Gee=Te.button(Vee||(Vee=J([`
  color: rgba(255, 255, 255, 0.9);
  font-weight: 500;
  display: flex;
  align-items: center;
  justify-content: center;
  background: none;
  border: none;
  padding-left: 12px;
  padding-right: 12px;
  border-left: 1px solid rgba(255, 255, 255, 0.05);

  &:hover {
    background: rgba(255, 255, 255, 0.05);
  }
`]))),jee={info:"#3b82f6",success:"#10b981",warning:"#f59e0b",error:"#ef4444"},Wee=Te.div(Hee||(Hee=J([`
  display: flex;
  justify-content: center;
  margin-left: 12px;
  padding-top: 21px;

  ::before {
    content: '';
    width: 8px;
    height: 8px;
    border-radius: 999999px;
    background-color: `,`;
  }
`])),({type:s})=>jee[s]),Bb=s=>(l,u,m=[],_=!1)=>{(_||!Lb.check({title:l,message:u}))&&(Lb.add({title:l,message:u}),rC.add(s),QM.custom(b=>Bo.default.createElement(Fee,null,Bo.default.createElement(Wee,{type:s}),Bo.default.createElement(Uee,null,Bo.default.createElement(CO,null,l),Bo.default.createElement(AO,{dangerouslySetInnerHTML:{__html:zr.parse(u)}}),m.length>0&&Bo.default.createElement(AO,null,Bo.default.createElement("span",null,"Docs:"," ",m.map((E,T)=>Bo.default.createElement(Bo.Fragment,{key:T},T>0&&", ",Bo.default.createElement("a",{target:"_blank",href:E.url},E.title)))))),Bo.default.createElement(Gee,{onClick:()=>{QM.remove(b.id),Lb.delete({title:l,message:u}),rC.delete(s)}},"Close")),{duration:1/0}))},Ub={warning:Bb("warning"),success:Bb("success"),info:Bb("info"),error:Bb("error")},qee=Te.div($ee||($ee=J([`
  display: flex;
  justify-content: `,`;
  gap: 12px;
`])),({align:s})=>s==="center"?"center":"flex-end"),Yee=Te.button(Xee||(Xee=J([`
  position: relative;
  border-radius: 4px;
  display: flex;
  align-items: center;
  gap: 12px;
  `,`;
  background-color: rgba(40, 43, 47, 0.8);
  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.25), 0 2px 6px rgba(0, 0, 0, 0.15);
  backdrop-filter: blur(14px);
  border: none;
  padding: 12px;
  color: #fff;
  overflow: hidden;

  ::before {
    content: '';
    position: absolute;
    inset: 0;
  }

  :hover::before {
    background: `,`;
  }

  @supports not (backdrop-filter: blur()) {
    background: rgba(40, 43, 47, 0.95);
  }
`])),Di,({danger:s})=>s?"rgba(255, 0, 0, 0.1)":"rgba(255, 255, 255, 0.1)"),Zee=Te.div(Kee||(Kee=J([`
  z-index: 10;
  display: flex;
  flex-direction: column;
  gap: 8px;
  position: fixed;
  right: 92px;
  top: 50px;
  width: 500px;
  height: 85vh;
  min-height: 400px;
`]))),Jee=Te.div(Qee||(Qee=J([`
  overflow: hidden;
  pointer-events: auto;
  border-radius: 4px;

  & > div {
    display: flex;
    flex-direction: column-reverse;
    gap: 8px;
    overflow: scroll;
    height: 100%;
  }
`]))),tte=Te.div(ete||(ete=J([`
  width: fit-content;
  padding: 8px;
  border-radius: 4px;
  display: flex;
  flex-direction: column;
  gap: 12px;
  color: #b4b4b4;
  font-size: 12px;
  line-height: 1.4;
`]))),nte=()=>{let{hasNotifications:s}=PO();return Sv({enabled:!s},()=>Bo.default.createElement(MO,null,Bo.default.createElement(tte,null,Bo.default.createElement(CO,null,"No notifications"),"Notifications will appear here when you get them.")))},rte=()=>{var s;let{toasts:l,handlers:u}=SO(),{startPause:m,endPause:_}=u,b=(s=Xr(Se().atomP.ahistoric.pinNotifications))!=null?s:!1;return Bo.default.createElement(Zee,null,b?l.length>0&&Bo.default.createElement(Jee,{onMouseEnter:m,onMouseLeave:_},Bo.default.createElement("div",null,l.map(E=>Bo.default.createElement("div",{key:E.id},E.message(E))))):null,Bo.default.createElement(qee,{align:"side"},b&&l.length>0&&Bo.default.createElement(Yee,{onClick:()=>{rC.clear(),Lb.clear(),QM.remove()},danger:!0},"Clear")))},PO=()=>{let{toasts:s}=SO();return{hasNotifications:s.length>0}}});function RO(s,l){var u;let m=Object.values((u=(0,ite.val)(s.pointers.historic.sheetsById))!=null?u:{}),_=m.flatMap(E=>{var T;return Object.values((T=E==null?void 0:E.staticOverrides.byObject)!=null?T:{})}).flatMap(E=>Object.values(E??{})),b=[...m.flatMap(E=>{var T,P;return Object.values((P=(T=E==null?void 0:E.sequence)==null?void 0:T.tracksByObject)!=null?P:{})}).flatMap(E=>{var T;return Object.values((T=E==null?void 0:E.trackData)!=null?T:{})}).flatMap(E=>E==null?void 0:E.keyframes).map(E=>E==null?void 0:E.value)];return _.forEach(E=>{lt(E,T=>{b.push(T)},[])}),b.filter(E=>(E==null?void 0:E.type)&&typeof(E==null?void 0:E.type)=="string").map(E=>E.id).filter((E,T,P)=>E!==null&&E!==""&&P.indexOf(E)===T)}var ite,ste=k(()=>{ite=mn(),_t()});function ote(s,l){let u=new File([s],l),m=URL.createObjectURL(u),_=Object.assign(document.createElement("a"),{href:m,target:"_blank",rel:"noopener"});_.setAttribute("download",l),_.click(),setTimeout(()=>{URL.revokeObjectURL(m)},4e4)}var iu,ate,lte,cte,ute,hte,dte,fte,pte,mte,Wve=k(()=>{Ae(),yp(),mp(),iu=Q(qe()),Ft(),IJ(),Fve(),ate=Q(Lve()),zb(),ste(),cte=Te.div(lte||(lte=J([""]))),hte=Te.div(ute||(ute=J([`
  padding: 8px 10px;
  display: flex;
  flex-direction: column;
  align-items: stretch;
`]))),fte=Te(gp)(dte||(dte=J([`
  display flex;
  flex-direction: column;
  gap: 1em;
  width: 280px;
  padding: 1em;
`]))),pte=({projects:s})=>{let l=s[0],u=l.address.projectId,m=u.replace(/[^\w\d'_\-]+/g," ").trim(),_="".concat(m,".theatre-project-state.json"),[b,E]=(0,iu.useState)(!1),T=(0,iu.useCallback)(()=>Ue(void 0,null,function*(){var N,z;let G=RO(l),V=new Map;try{yield Promise.all(G.map(H=>Ue(void 0,null,function*(){let j=l.assetStorage.getAssetUrl(H),X=yield fetch(j);X.ok&&V.set(H,yield X.blob())})))}catch{Ub.error("Failed to access assets","Export aborted. Failed to access assets at ".concat((z=(N=l.config.assets)==null?void 0:N.baseUrl)!=null?z:"/",". This is likely due to a CORS issue."));return}if(V.size>0){let H=new ate.default;for(let[X,K]of V)H.file(X,K);let j=yield H.generateAsync({type:"blob"});ote(j,"".concat(m,".assets.zip"))}let B=JSON.stringify(Se().createContentOfSaveFile(l.address.projectId),null,2);ote(B,_),E(!0),setTimeout(()=>{E(!1)},2e3)}),[l,_]),P=pp({debugName:"ProjectDetails",pointerDistanceThreshold:50},()=>iu.default.createElement(fte,null,iu.default.createElement("p",null,"This will create a JSON file with the state of your project. You can commit this file to your git repo and include it in your production bundle."),iu.default.createElement("p",null,"If your project uses assets, this will also create a zip file with all the assets that you can unpack in your public folder."),iu.default.createElement("a",{href:"https://www.theatrejs.com/docs/latest/manual/projects#state",target:"_blank"},"Here is a quick guide on how to export to production.")));return iu.default.createElement(iu.default.Fragment,null,P.node,iu.default.createElement(cte,null,iu.default.createElement(tee,{projectId:u}),iu.default.createElement(hte,null,iu.default.createElement(qM,{onMouseEnter:N=>P.open(N,N.target),onClick:b?void 0:T,disabled:b},b?"(Exported)":"Export ".concat(u," to JSON")))))},mte=pte}),B9,gte,yte,vte,_te,xte,bte,Ste,wte,Ete,Tte,$ve=k(()=>{B9=Q(qe()),Ft(),rb(),yte=Te.div(gte||(gte=J([`
  padding: 16px;
  display: flex;
  flex-direction: column;
  gap: 24px;
`]))),_te=Te.div(vte||(vte=J([`
  display: flex;
  flex-direction: column;
  gap: 11px;
  color: rgba(255, 255, 255, 0.9);
`]))),bte=Te.div(xte||(xte=J([`
  color: rgba(145, 145, 145, 0.8);
`]))),wte=Te.a(Ste||(Ste=J([`
  color: #919191;
  font-size: 10px;
  text-decoration-color: #40434a;
  text-underline-offset: 3px;
`]))),Ete=()=>B9.default.createElement(yte,null,B9.default.createElement(_te,null,B9.default.createElement(bte,null,B9.default.createElement(YN,null)),B9.default.createElement("div",null,"Please select an object from the ",B9.default.createElement("u",null,"Outline Menu")," to see its properties.")),B9.default.createElement(wte,{href:"https://www.theatrejs.com/docs/latest/manual/objects",target:"_blank"},"Learn more about Objects")),Tte=Ete});function Mte(){let[s,l]=(0,kO.useState)(!1),u=(0,kO.useMemo)(()=>{let m=new Set;return()=>{let _=()=>{m.delete(_),l(m.size>0)};return m.add(_),l(!0),_}},[]);return[s,u]}var kO,Cte=k(()=>{kO=Q(qe())}),Rs,Tv,Ate,Pte,iC,Rte,IO,kte,NO,Ite,DO,Vb,Nte,Dte,sC,H5,OO=k(()=>{A9(),er(),Rs=Q(qe()),Ft(),ai(),Cm(),Li(),Nve(),Wve(),Ae(),gX(),Tv=mn(),$ve(),Cte(),z5(),Ate="32px",iC=Te.div(Pte||(Pte=J([`
  `,`;
  background-color: rgba(40, 43, 47, 0.8);
  position: fixed;
  right: 8px;
  top: 50px;
  // Temporary, see comment about CSS grid in SingleRowPropEditor.
  width: 280px;
  height: fit-content;
  z-index: `,`;

  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.25), 0 2px 6px rgba(0, 0, 0, 0.15);
  backdrop-filter: blur(14px);
  border-radius: 2px;

  display: `,`;

  &:hover {
    display: block;
  }

  @supports not (backdrop-filter: blur()) {
    background: rgba(40, 43, 47, 0.95);
  }
`])),Di,ov.propsPanel,({pin:s})=>s?"block":"none"),IO=Te.div(Rte||(Rte=J([`
  margin: 0 10px;
  color: #919191;
  font-weight: 500;
  font-size: 10px;
  user-select: none;
  `,`;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
`])),Di),NO=Te.div(kte||(kte=J([`
  height: `,`;
  display: flex;
  align-items: center;
`])),Ate),DO=Te.div(Ite||(Ite=J([`
  `,`;
  max-height: calc(100vh - 100px);
  overflow-y: scroll;
  &::-webkit-scrollbar {
    display: none;
  }

  scrollbar-width: none;
  padding: 0;
  user-select: none;

  /* Set the font-size for input values in the detail panel */
  font-size: 12px;
`])),Di),Vb=(0,Rs.createContext)([!1,()=>()=>{}]),Nte=s=>{let l=Xr(Se().atomP.ahistoric.pinDetails)!==!1,u=mX("right");(0,Rs.useLayoutEffect)(()=>{sC.set(u)},[u]),(0,Rs.useEffect)(()=>()=>{H5.set(!1),sC.set(!1)},[]);let[m]=(0,Rs.useContext)(Vb),_=l||u||m,[b,E]=(0,Rs.useState)(null);return JZ(b),jr(()=>{let T=C9(),P=T.find(qt);if(P)return Rs.default.createElement(iC,{"data-testid":"DetailPanel-Object",pin:_,ref:E,onMouseEnter:()=>{H5.set(!0)},onMouseLeave:()=>{H5.set(!1)}},Rs.default.createElement(NO,null,Rs.default.createElement(IO,{title:"".concat(P.sheet.address.sheetId,": ").concat(P.sheet.address.sheetInstanceId," > ").concat(P.address.objectKey)},Rs.default.createElement(M9,null,P.sheet.address.sheetId," "),Rs.default.createElement(nb,null,":",""),Rs.default.createElement(M9,null,P.sheet.address.sheetInstanceId," "),Rs.default.createElement(nb,null,""),Rs.default.createElement(M9,null,P.address.objectKey))),Rs.default.createElement(DO,null,Rs.default.createElement(PJ,{objects:[P]})));let N=T.find(dt);return N?Rs.default.createElement(iC,{pin:_},Rs.default.createElement(NO,null,Rs.default.createElement(IO,{title:"".concat(N.address.projectId)},Rs.default.createElement(M9,null,N.address.projectId," "))),Rs.default.createElement(DO,null,Rs.default.createElement(mte,{projects:[N]}))):Rs.default.createElement(iC,{pin:_,onMouseEnter:()=>{H5.set(!0)},onMouseLeave:()=>{H5.set(!1)}},Rs.default.createElement(Tte,null))},[_])},Dte=()=>{let s=Mte();return Rs.default.createElement(Vb.Provider,{value:s},Rs.default.createElement(Nte,null))},sC=new Tv.Atom(!1),H5=new Tv.Atom(!1),(0,Tv.prism)(()=>{let s=(0,Tv.val)(H5.prism),l=(0,Tv.val)(sC.prism);return s||l})}),FO,oC,aC,LO,Mv,Ote,BO,Cv=k(()=>{FO=mn(),er(),Ae(),Cte(),oC=Q(qe()),VD(),aC=(s,l)=>{let u=s.left/l.width,m=(s.left+s.width)/l.width,_=s.top/l.height,b=(s.height+s.top)/l.height;return{edges:{left:u<=.5?{from:"screenLeft",distance:u}:{from:"screenRight",distance:1-u},right:m<=.5?{from:"screenLeft",distance:m}:{from:"screenRight",distance:1-m},top:_<=.5?{from:"screenTop",distance:_}:{from:"screenBottom",distance:1-_},bottom:b<=.5?{from:"screenTop",distance:b}:{from:"screenBottom",distance:1-b}}}},LO=oC.default.createContext(null),Mv=()=>(0,oC.useContext)(LO),Ote=({panelId:s,children:l,defaultPosition:u,minDims:m})=>{let _=TM(800,200),[b,E]=Mte(),{stuff:T}=jr(()=>{var P;let{edges:N}=(P=(0,FO.val)(Se().atomP.historic.panelPositions[s]))!=null?P:u,z=Math.floor(_.width*(N.left.from==="screenLeft"?N.left.distance:1-N.left.distance)),G=Math.floor(_.width*(N.right.from==="screenLeft"?N.right.distance:1-N.right.distance)),V=Math.floor(_.height*(N.top.from==="screenTop"?N.top.distance:1-N.top.distance)),B=Math.floor(_.height*(N.bottom.from==="screenTop"?N.bottom.distance:1-N.bottom.distance)),H=Math.max(G-z,m.width),j=Math.max(B-V,m.height);return{stuff:{dims:FO.prism.memo("dims",()=>({width:H,left:z,top:V,height:j}),[H,z,V,j]),panelId:s,minDims:m,boundsHighlighted:b,addBoundsHighlightLock:E}}},[s,_,b,E]);return oC.default.createElement(LO.Provider,{value:T},l)},BO=Ote}),Gb,Fte,Lte,Bte,UO,Ute=k(()=>{Fi(),Ae(),Yo(),Gb=Q(qe()),Ft(),Cv(),ru(),Fo(),Cm(),Lte=Te.div(Fte||(Fte=J([`
  cursor: move;
`]))),Bte=s=>{let l=Mv(),u=(0,Gb.useRef)(l);u.current=l;let[m,_]=Ai(null),b=(0,Gb.useMemo)(()=>({debugName:"PanelDragZone",lockCursorTo:"move",onDragStart(){let N=u.current,z,G=l.addBoundsHighlightLock();return{onDrag(V,B){let H=$(R({},N.dims),{top:ii(N.dims.top+B,0,window.innerHeight-up),left:ii(N.dims.left+V,-N.dims.width+up,window.innerWidth-up)}),j=aC(H,{width:window.innerWidth,height:window.innerHeight});z==null||z.discard(),z=Se().tempTransaction(({stateEditors:X})=>{X.studio.historic.panelPositions.setPanelPosition({position:j,panelId:N.panelId})})},onDragEnd(V){G(),V?z==null||z.commit():z==null||z.discard()}}}}),[]),[E]=uo(_,b);rh(E,"dragging","move");let[T,P]=(0,Gb.useMemo)(()=>{let N;return[function(){if(N){let z=N;N=void 0,z()}N=l.addBoundsHighlightLock()},function(){if(N){let z=N;N=void 0,z()}}]},[]);return Gb.default.createElement(Lte,$(R({},s),{ref:m,onMouseEnter:T,onMouseLeave:P}))},UO=Bte}),lC,zte,zO,Vte,VO,Gte,GO,jte,Hte,Wte,$te,qte,jO,Xte,Yte,Kte,Zte,Qte,jb,Jte,ene,tne,nne,rne,ine,sne,one,ane,HO,lne,Fm,qve=k(()=>{Fi(),Ae(),Yo(),nu(),lC=Q(qe()),Ft(),Cv(),Li(),Fo(),Cm(),zO=Te.div(zte||(zte=J([`
  position: absolute;
  `,`;
  &:after {
    position: absolute;
    inset: -5px;
    display: block;
    content: ' ';
  }

  opacity: 0;
  background-color: #478698;

  &.isHighlighted {
    opacity: 0.7;
  }

  &.isDragging {
    opacity: 1;
    /* background-color: `,`; */
  }

  &:hover {
    opacity: 1;
  }
`])),Di,Qy(.2,"#478698")),VO=Te(zO)(Vte||(Vte=J([`
  /**
  The horizintal/vertical resize handles have z-index:-1 and are offset 1px outside of the panel
  to make sure they don't occlude any element that pops out of the panel (like the Playhead in SequenceEditorPanel).

  This means that panels will always need an extra 1px margin for their resize handles to be visible, but that's not a problem
  that we have to deal with right now (if it is at all a problem).
  
   */
  z-index: -1;
`]))),GO=Te(VO)(Gte||(Gte=J([`
  left: 0px;
  right: 0px;
  height: 1px;
`]))),Hte=Te(GO)(jte||(jte=J([`
  top: -1px;
`]))),$te=Te(GO)(Wte||(Wte=J([`
  bottom: -1px;
`]))),jO=Te(VO)(qte||(qte=J([`
  z-index: -1;
  top: -1px;
  bottom: -1px;
  width: 1px;
`]))),Yte=Te(jO)(Xte||(Xte=J([`
  left: -1px;
`]))),Zte=Te(jO)(Kte||(Kte=J([`
  right: -1px;
`]))),jb=Te(zO)(Qte||(Qte=J([`
  // The angles have z-index: 10 to make sure they _do_ occlude other elements in the panel.
  z-index: 10;
  width: 8px;
  height: 8px;
`]))),ene=Te(jb)(Jte||(Jte=J([`
  top: 0;
  left: 0;
`]))),nne=Te(jb)(tne||(tne=J([`
  top: 0;
  right: 0;
`]))),ine=Te(jb)(rne||(rne=J([`
  bottom: 0;
  left: 0;
`]))),one=Te(jb)(sne||(sne=J([`
  bottom: 0;
  right: 0;
`]))),ane={Top:Hte,TopLeft:ene,TopRight:nne,Bottom:$te,BottomLeft:ine,BottomRight:one,Left:Yte,Right:Zte},HO={Top:"ns-resize",Bottom:"ns-resize",Left:"ew-resize",Right:"ew-resize",TopLeft:"nw-resize",TopRight:"ne-resize",BottomLeft:"sw-resize",BottomRight:"se-resize"},lne=({which:s})=>{let l=Mv(),u=(0,lC.useRef)(l);u.current=l;let[m,_]=Ai(null),b=(0,lC.useMemo)(()=>({debugName:"PanelResizeHandle",lockCursorTo:HO[s],onDragStart(){let N,z=u.current,G=l.addBoundsHighlightLock();return{onDrag(V,B){let H=R({},z.dims);if(s.startsWith("Bottom"))H.height=Math.max(H.height+B,z.minDims.height);else if(s.startsWith("Top")){let X=H.top+H.height,K=ii(H.top+B,0,Math.min(X-z.minDims.height,window.innerHeight-up)),te=X-K;H.height=te,H.top=K}if(s.endsWith("Left")){let X=H.left+H.width,K=Math.min(H.left+V,Math.min(X-z.minDims.width,window.innerWidth-up)),te=X-K;H.width=te,H.left=K}else s.endsWith("Right")&&(H.width=Math.max(H.width+V,Math.max(z.minDims.width,up-z.dims.left)));let j=aC(H,{width:window.innerWidth,height:window.innerHeight});N==null||N.discard(),N=Se().tempTransaction(({stateEditors:X})=>{X.studio.historic.panelPositions.setPanelPosition({position:j,panelId:z.panelId})})},onDragEnd(V){G(),V?N==null||N.commit():N==null||N.discard()}}}}),[s]),[E]=uo(_,b),T=ane[s],P=s.length<=6;return lC.default.createElement(T,{ref:m,className:[E?"isDragging":"",l.boundsHighlighted&&P?"isHighlighted":""].join(" "),style:{cursor:HO[s]}})},Fm=lne}),Pd,cne,une,Xve=k(()=>{Pd=Q(qe()),qve(),cne=s=>Pd.default.createElement(Pd.default.Fragment,null,Pd.default.createElement(Fm,{which:"Bottom"}),Pd.default.createElement(Fm,{which:"Top"}),Pd.default.createElement(Fm,{which:"Left"}),Pd.default.createElement(Fm,{which:"Right"}),Pd.default.createElement(Fm,{which:"TopLeft"}),Pd.default.createElement(Fm,{which:"TopRight"}),Pd.default.createElement(Fm,{which:"BottomLeft"}),Pd.default.createElement(Fm,{which:"BottomRight"})),une=cne}),cC,hne,dne,fne,WO,pne=k(()=>{Li(),cC=Q(qe()),Ft(),Cv(),Xve(),dne=Te.div(hne||(hne=J([`
  position: absolute;
  user-select: none;
  box-sizing: border-box;
  `,`;
  /* box-shadow: 1px 2px 10px -5px black; */

  z-index: 1000;
`])),Di),fne=cC.default.forwardRef((s,l)=>{let u=Mv(),m=s,{style:_,children:b}=m,E=Z(m,["style","children"]);return cC.default.createElement(dne,$(R({ref:l},E),{style:R({width:u.dims.width+"px",height:u.dims.height+"px",top:u.dims.top+"px",left:u.dims.left+"px"},_??{})}),cC.default.createElement(une,null),b)}),WO=fne}),Yve=ie((s,l)=>{(function(u,m){typeof s=="object"&&typeof l<"u"?m(s,qe()):(u=typeof globalThis<"u"?globalThis:u||self,m(u.ReactErrorBoundary={},u.React))})(s,function(u,m){function _(B){if(B&&B.__esModule)return B;var H=Object.create(null);return B&&Object.keys(B).forEach(function(j){if(j!=="default"){var X=Object.getOwnPropertyDescriptor(B,j);Object.defineProperty(H,j,X.get?X:{enumerable:!0,get:function(){return B[j]}})}}),H.default=B,Object.freeze(H)}var b=_(m);function E(B,H){return E=Object.setPrototypeOf||function(j,X){return j.__proto__=X,j},E(B,H)}function T(B,H){B.prototype=Object.create(H.prototype),B.prototype.constructor=B,E(B,H)}var P=function(B,H){return B===void 0&&(B=[]),H===void 0&&(H=[]),B.length!==H.length||B.some(function(j,X){return!Object.is(j,H[X])})},N={error:null},z=function(B){T(H,B);function H(){for(var X,K=arguments.length,te=new Array(K),se=0;se<K;se++)te[se]=arguments[se];return X=B.call.apply(B,[this].concat(te))||this,X.state=N,X.updatedWithError=!1,X.resetErrorBoundary=function(){for(var pe,fe=arguments.length,ve=new Array(fe),Ne=0;Ne<fe;Ne++)ve[Ne]=arguments[Ne];X.props.onReset==null||(pe=X.props).onReset.apply(pe,ve),X.reset()},X}H.getDerivedStateFromError=function(X){return{error:X}};var j=H.prototype;return j.reset=function(){this.updatedWithError=!1,this.setState(N)},j.componentDidCatch=function(X,K){var te,se;(te=(se=this.props).onError)==null||te.call(se,X,K)},j.componentDidMount=function(){var X=this.state.error;X!==null&&(this.updatedWithError=!0)},j.componentDidUpdate=function(X){var K=this.state.error,te=this.props.resetKeys;if(K!==null&&!this.updatedWithError){this.updatedWithError=!0;return}if(K!==null&&P(X.resetKeys,te)){var se,pe;(se=(pe=this.props).onResetKeysChange)==null||se.call(pe,X.resetKeys,te),this.reset()}},j.render=function(){var X=this.state.error,K=this.props,te=K.fallbackRender,se=K.FallbackComponent,pe=K.fallback;if(X!==null){var fe={error:X,resetErrorBoundary:this.resetErrorBoundary};if(b.isValidElement(pe))return pe;if(typeof te=="function")return te(fe);if(se)return b.createElement(se,fe);throw new Error("react-error-boundary requires either a fallback, fallbackRender, or FallbackComponent prop")}return this.props.children},H}(b.Component);function G(B,H){var j=function(K){return b.createElement(z,H,b.createElement(B,K))},X=B.displayName||B.name||"Unknown";return j.displayName="withErrorBoundary("+X+")",j}function V(B){var H=b.useState(null),j=H[0],X=H[1];if(B!=null)throw B;if(j!=null)throw j;return X}u.ErrorBoundary=z,u.useErrorHandler=V,u.withErrorBoundary=G,Object.defineProperty(u,"__esModule",{value:!0})})}),Ka,mne,gne,yne,vne,_ne,xne,bne,Sne,wne,Ene,Tne,Mne,Cne,Ane,Pne,Rne,kne,Ine,Nne,Kve=k(()=>{Ka=Q(qe()),Ft(),Cm(),Cv(),Ute(),pne(),mne=Q(Yve()),pv(),Ae(),Cm(),gne={edges:{left:{from:"screenLeft",distance:.3},right:{from:"screenRight",distance:.3},top:{from:"screenTop",distance:.3},bottom:{from:"screenBottom",distance:.3}}},yne={width:300,height:300},vne=({paneInstance:s})=>Ka.default.createElement(BO,{panelId:"pane-".concat(s.instanceId),defaultPosition:gne,minDims:yne},Ka.default.createElement(Ine,{paneInstance:s})),xne=Te(WO)(_ne||(_ne=J([`
  display: flex;
  flex-direction: column;

  box-shadow: 0px 5px 12px -4px rgb(0 0 0 / 22%);
  z-index: `,`;
`])),ov.pluginPanes),Sne=Te.div(bne||(bne=J([`
  width: 100%;
`]))),Ene=Te.div(wne||(wne=J([`
  display: flex;
  align-items: center;
  opacity: 1;
  position: absolute;
  right: 4px;
  top: 0;
  bottom: 0;
`]))),Mne=Te.button(Tne||(Tne=J([`
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 2px;
  font-size: 11px;
  height: 10px;
  width: 18px;
  color: #adadadb3;
  background: transparent;
  border: none;
  cursor: pointer;
  &:hover {
    color: white;
  }
`]))),Ane=Te(pq)(Cne||(Cne=J([`
  position: relative;
  overflow: hidden;

  &:after {
    z-index: 10;
    position: absolute;
    inset: 0;
    display: block;
    content: ' ';
    pointer-events: none;

    #pointer-root:not(.normal) & {
      pointer-events: auto;
    }
  }
`]))),Rne=Te.div(Pne||(Pne=J([`
  padding: 12px;

  & > pre {
    border: 1px solid #ff62624f;
    background-color: rgb(255 0 0 / 5%);
    margin: 8px 0;
    padding: 8px;
    font-family: monospace;
    overflow: scroll;
    color: #ff9896;
  }
`]))),kne=s=>Ka.default.createElement(Rne,null,"An Error occurred rendering this pane. Open the console for more info.",Ka.default.createElement("pre",null,JSON.stringify({message:s.error.message,stack:s.error.stack},null,2))),Ine=({paneInstance:s})=>{let[l,u]=(0,Ka.useState)(null),m=s.definition.mount;(0,Ka.useLayoutEffect)(()=>{if(!l)return;let b=m({paneId:s.instanceId,node:l});if(typeof b=="function")return b},[l,m,s.instanceId]);let _=(0,Ka.useCallback)(()=>{Se().paneManager.destroyPane(s.instanceId)},[s]);return Ka.default.createElement(xne,{"data-testid":"theatre-pane-wrapper-".concat(s.instanceId)},Ka.default.createElement(UO,null,Ka.default.createElement(qN,null,Ka.default.createElement(Ene,null,Ka.default.createElement(Mne,{onClick:_,title:"Close Pane"},Ka.default.createElement(J6e,null))),Ka.default.createElement(Sne,null,s.instanceId))),Ka.default.createElement(mne.ErrorBoundary,{FallbackComponent:kne},Ka.default.createElement(Ane,{"data-testid":"theatre-pane-content-".concat(s.instanceId),ref:u})))},Nne=vne}),$O,qO,Dne=k(()=>{$O=mn(),qO=(s,l)=>{let u=$O.prism.memo(s,()=>new $O.Atom(l),[]);return u.set(l),u}});function One(s,l){(0,Fne.useLayoutEffect)(()=>{if(!s||l.type!=="propWithChildren"&&l.type!=="primitiveProp"&&l.type!=="sheetObject")return;let u=null,m=$(R({},l.sheetObject.address),{pathToProp:l.type==="sheetObject"?[]:l.pathToProp});function _(){u=GM.replaceLock(m,()=>{})}function b(){u==null||u()}return s.addEventListener("mouseenter",_),s.addEventListener("mouseleave",b),()=>{u==null||u(),s.removeEventListener("mouseenter",_),s.removeEventListener("mouseleave",b)}},[s])}var Fne,Lne=k(()=>{Fne=Q(qe()),hO()}),U9,Bne,XO,Une,YO,zne,KO,Vne,Gne,jne,Hne,Wne,$ne,qne,uC,hC=k(()=>{Li(),U9=Q(qe()),pv(),Ft(),B5(),Lne(),XO=Te.li(Bne||(Bne=J([`
  --depth: `,`;
  margin: 0;
  padding: 0;
  list-style: none;
`])),s=>s.depth),YO=Te.div(Une||(Une=J([`
  border-bottom: 1px solid #7695b705;
`]))),KO=Te(YO)(zne||(zne=J([`
  padding-left: calc(8px + var(--depth) * 20px);

  display: flex;
  align-items: stretch;
  color: `,`;

  box-sizing: border-box;

  `,`;
`])),sv.panel.body.compoudThing.label.color,s=>s.isSelected&&"background: blue"),Gne=Te.span(Vne||(Vne=J([`
  `,`;
  overflow-x: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  padding-right: 4px;
  line-height: 26px;
  flex-wrap: nowrap;

  `,`:hover & {
    color: #ccc;
  }
`])),N9,KO),Hne=Te.span(jne||(jne=J([`
  width: 12px;
  padding: 8px;
  font-size: 9px;
  display: flex;
  align-items: center;

  transition: transform 0.05s ease-out, color 0.1s ease-out;
  transform: rotateZ(`,`deg);
  color: #66686a;

  &:hover {
    transform: rotateZ(`,`deg);
    color: #c0c4c9;
  }
`])),s=>s.isCollapsed?0:90,s=>s.isCollapsed?15:75),$ne=Te.ul(Wne||(Wne=J([`
  margin: 0;
  padding: 0;
  list-style: none;
`]))),qne=({leaf:s,label:l,children:u,isSelectable:m,isSelected:_,toggleSelect:b,toggleCollapsed:E,isCollapsed:T})=>{let P=Array.isArray(u)&&u.length>0,N=(0,U9.useRef)(null);return One(N.current,s),s.shouldRender?U9.default.createElement(XO,{depth:s.depth},U9.default.createElement(KO,{ref:N,style:{height:s.nodeHeight+"px"},isSelectable:m===!0,isSelected:_===!0,onClick:b,isEven:s.n%2===0},U9.default.createElement(Hne,{isCollapsed:T,onClick:E},U9.default.createElement(aY,null)),U9.default.createElement(Gne,null,l)),P&&U9.default.createElement($ne,null,u)):null},uC=qne});function Zve(s,l){return l.every((u,m)=>u===s[m])}function Qve(s,l){if(s.length!==l.length)return!1;for(let u=0;u<s.length;u++)if(s[u]!==l[u])return!1;return!0}function dC(s){var l;let u=[];for(;;){let m=u.length,_=(l=s[0])==null?void 0:l[m];if(_===void 0)return u;for(let b of s)if(_!==b[m])return u;u.push(_)}}var bp,fC,Sp=k(()=>{AM(),bp=gb(s=>JSON.stringify(s)),fC=s=>JSON.parse(s)});function Jve(s,l){let u=(0,ZO.useRef)({combo:s,listener:l});u.current={combo:s,listener:l},(0,ZO.useEffect)(()=>{function m(E){E.key===u.current.combo&&u.current.listener({down:!0,event:E})}function _(E){E.key===u.current.combo&&u.current.listener({down:!1,event:E})}function b(E){u.current.listener({down:!1,event:void 0})}return document.addEventListener("keydown",m),document.addEventListener("keyup",_),window.addEventListener("blur",b),()=>{document.removeEventListener("keydown",m),document.removeEventListener("keyup",_),window.removeEventListener("blur",b)}},[])}var ZO,e7e=k(()=>{ZO=Q(qe())});function Xne(s){let[l,u]=(0,Yne.useState)(!1);return Jve(s,({down:m})=>{u(m)}),l}var Yne,Kne=k(()=>{Yne=Q(qe()),e7e()});function t7e(s){let l=(0,QO.useMemo)(()=>new Zne.Atom(s),[]);return(0,QO.useLayoutEffect)(()=>{l.set(s)},[s]),l}var Zne,QO,n7e=k(()=>{Zne=mn(),QO=Q(qe())});function Qne(s,l,u){let m=(0,JO.pointer)({root:{},path:[]}),_=l(m);pm(s,(0,JO.getPointerParts)(_).path,u)}var JO,r7e=k(()=>{JO=mn(),Oy()}),pC,Jne,yl,Rd=k(()=>{pC="data-pos",Jne={checkIfMouseEventSnapToPos(s,l){let u=s.composedPath().find(m=>m instanceof Element&&m!==(l==null?void 0:l.ignore)&&m.hasAttribute(pC));if(u){let m=parseFloat(u.getAttribute(pC));if(isFinite(m))return m}return null},includePositionSnapAttrs(s){return{[pC]:s}}},yl=Jne});function mC(s){let l=s.type==="sheet"?s7e(s):eF(s);return{byPosition:i7e(l),tracks:l}}function i7e(s){let l=new Map;for(let u of s)for(let m of u.data.keyframes){let _=l.get(m.position);_||(_=[],l.set(m.position,_)),_.push({kf:m,track:u,itemKey:ha.forTrackKeyframe(u.sheetObject,u.id,m.id)})}return l}function s7e(s){return s.children.flatMap(eF)}function eF(s){return s.children.flatMap(l=>l.type==="propWithChildren"?eF(l):o7e(l))}function o7e(s){let l=s.sheetObject,u=l.address.projectId,m=Se().atomP.historic.coreByProject[u].sheetsById[l.address.sheetId].sequence.tracksByObject[l.address.objectKey],_=(0,gC.val)(m.trackIdByPropPath[bp(s.pathToProp)]);if(!_)return[];let b=(0,gC.val)(m.trackData[_]);return b?[{id:_,data:b,sheetObject:l}]:[]}function a7e(s,l){return ip(s.children.flatMap(u=>tF(u,l)))}function tF(s,l){return ip(s.children.flatMap(u=>u.type==="propWithChildren"?tF(u,l):l7e(u,l)))}function l7e(s,l){var u,m;let _=s.sheetObject,b=_.address.projectId,E=Se().atomP.historic.coreByProject[b].sheetsById[_.address.sheetId].sequence.tracksByObject[_.address.objectKey],T=(0,gC.val)(E.trackIdByPropPath[bp(s.pathToProp)]);return T?(m=(u=l[_.address.objectKey])==null?void 0:u[T])!=null?m:[]:[]}var gC,Av=k(()=>{Ae(),gC=mn(),Dm(),Sp(),Fo()});function c7e(s,l){let[u,m]=Ai(null),_=P9("useCaptureSelection");return uo(l,(0,Pv.useMemo)(()=>({debugName:"DopeSheetSelectionView/useCaptureSelection",dontBlockMouseDown:!0,lockCSSCursorTo:"cell",onDragStart(b){if(!b.shiftKey||b.target instanceof HTMLInputElement)return!1;let E=l.getBoundingClientRect(),T=b.clientX-E.left-(0,sh.val)(s.scaledSpace.leftPadding),P=(0,sh.val)(s.scaledSpace.toUnitSpace)(T);return u.current={h:[P,P],v:[b.clientY-E.top,b.clientY-E.top]},(0,sh.val)(s.selectionAtom).set({current:void 0}),{onDrag(N,z,G){let V=l.getBoundingClientRect(),B=G.clientX-V.left-(0,sh.val)(s.scaledSpace.leftPadding),H=(0,sh.val)(s.scaledSpace.toUnitSpace)(B);u.current={h:[u.current.h[0],H],v:[u.current.v[0],G.clientY-V.top]};let j=nF.boundsToSelection(_,(0,sh.val)(s),u.current);(0,sh.val)(s.selectionAtom).set({current:j})},onDragEnd(N){u.current=null}}}}),[s,l,u])),m}var sh,Pv,z9,ere,tre,nre,nF,rre,ire,rF,sre,ore,u7e=k(()=>{Ae(),Yo(),Kne(),n7e(),r7e(),Fi(),er(),sh=mn(),Pv=Q(qe()),Ft(),Rd(),Av(),R9(),z9=5,tre=Te.div(ere||(ere=J([`
  cursor: `,`;
`])),s=>s.isShiftDown?"cell":"default"),nre=({layoutP:s,children:l,height:u})=>{let[m,_]=Ai(null),b=Xne("Shift"),E=c7e(s,_),T=(0,Pv.useRef)(E);return T.current=E,Pv.default.createElement(tre,{style:{height:u+"px"},ref:m,isShiftDown:b,className:"selectionview"},E&&Pv.default.createElement(sre,{state:E,layoutP:s}),l)},(s=>{let l=(E,T,P,N,z)=>{let G=mC(P);if(P.top+P.nodeHeight/2+z9>N.v[0]&&P.top+P.nodeHeight/2-z9<N.v[1])for(let[V,B]of G.byPosition){let H=T.scaledSpace.toUnitSpace(z9);if(!(V+H<=N.h[0]||V-H>=N.h[1]))for(let j of B)Qne(z,X=>X[j.track.sheetObject.address.objectKey].byTrackId[j.track.id].byKeyframeId[j.kf.id],!0)}m(E,T,P,N,z)},u={sheet(E,T,P,N,z){l(E,T,P,N,z)},propWithChildren(E,T,P,N,z){l(E,T,P,N,z)},sheetObject(E,T,P,N,z){l(E,T,P,N,z)},primitiveProp(E,T,P,N,z){let{sheetObject:G,trackId:V}=P,B=(0,sh.val)(Se().atomP.historic.coreByProject[G.address.projectId].sheetsById[G.address.sheetId].sequence.tracksByObject[G.address.objectKey].trackData[V]);if(!(N.v[0]>P.top+P.heightIncludingChildren/2+z9||P.top+P.heightIncludingChildren/2-z9>N.v[1])){for(let H of B.keyframes)if(!(H.position+T.scaledSpace.toUnitSpace(z9)<=N.h[0])){if(H.position-T.scaledSpace.toUnitSpace(z9)>=N.h[1])break;Qne(z,j=>j[G.address.objectKey].byTrackId[V].byKeyframeId[H.id],!0)}}}},m=(E,T,P,N,z)=>{if("children"in P)for(let G of P.children)_(E,T,G,N,z)};function _(E,T,P,N,z){if(!P.shouldRender||N.v[0]>P.top+P.heightIncludingChildren||P.top>N.v[1])return;let G=u[P.type];G?G(E,T,P,N,z):m(E,T,P,N,z)}function b(E,T,P){let N={};P=rF(P);let z=T.tree;_(E.utilFor.internal(),T,z,P,N);let G=T.tree.sheet;return{type:"DopeSheetSelection",byObjectKey:N,getDragHandlers(V){return{debugName:"DopeSheetSelectionView/boundsToSelection",onDragStart(){let B,H=T.scaledSpace.toUnitSpace;return{onDrag(j,X,K){B&&(B.discard(),B=void 0);let te=yl.checkIfMouseEventSnapToPos(K,{ignore:V.domNode}),se=te!=null?te-V.positionAtStartOfDrag:H(j);B=Se().tempTransaction(({stateEditors:pe})=>{let fe=pe.coreByProject.historic.sheetsById.sequence.transformKeyframes;for(let ve of Object.keys(N)){let{byTrackId:Ne}=N[ve];for(let ze of Object.keys(Ne)){let{byKeyframeId:Me}=Ne[ze];fe({trackId:ze,keyframeIds:Object.keys(Me),translate:se,scale:1,origin:0,snappingFunction:G.getSequence().closestGridPosition,objectKey:ve,projectId:V.projectId,sheetId:V.sheetId})}}})},onDragEnd(j){j?B==null||B.commit():B==null||B.discard()}}}}},delete(){Se().transaction(({stateEditors:V})=>{let B=V.coreByProject.historic.sheetsById.sequence.deleteKeyframes;for(let H of Object.keys(N)){let{byTrackId:j}=N[H];for(let X of Object.keys(j)){let{byKeyframeId:K}=j[X];B($(R({},G.address),{objectKey:H,trackId:X,keyframeIds:Object.keys(K)}))}}})}}}s.boundsToSelection=b})(nF||(nF={})),ire=Te.div(rre||(rre=J([`
  position: absolute;
  background: rgba(255, 255, 255, 0.1);
  border: 1px dashed rgba(255, 255, 255, 0.4);
  box-sizing: border-box;
`]))),rF=s=>({h:[...s.h].sort((l,u)=>l-u),v:[...s.v].sort((l,u)=>l-u)}),sre=({state:s,layoutP:l})=>{let u=t7e(s);return jr(()=>{let m=(0,sh.val)(u.pointer),_=rF(m),b=(0,sh.val)(l.scaledSpace.fromUnitSpace),E=(0,sh.val)(l.scaledSpace.leftPadding),T=_.h.map(b).map(V=>V+E),P=_.v[0],N=_.v[1]-_.v[0],z=T[0],G=T[1]-T[0];return Pv.default.createElement(ire,{style:{top:P+"px",height:N+"px",left:z+"px",width:G+"px"}})},[l,u])},ore=nre}),W5,are,lre,iF,cre,ure,hre,dre=k(()=>{av(),W5=Q(qe()),Ft(),Hm(),lre=Te.div(are||(are=J([`
  position: absolute;
  top: 0;
  right: 0;
  left: 0;
  bottom: 0;
  overflow-x: hidden;
  overflow-y: scroll;
  z-index: `,`;

  &::-webkit-scrollbar {
    display: none;
  }

  scrollbar-width: none;
`])),()=>Ip.scrollableArea),iF=(0,W5.createContext)(wd),cre=()=>(0,W5.useContext)(iF),ure=s=>{let l=(0,W5.useRef)(null),u=(0,W5.useCallback)(m=>{l.current.scrollBy(0,m.deltaY)},[]);return W5.default.createElement(iF.Provider,{value:u},W5.default.createElement(lre,{ref:l},s.children))},hre=ure}),fre,h7e=k(()=>{fre='data:image/svg+xml,<svg width="34" height="34" viewBox="0 0 34 34" fill="none" xmlns="http://www.w3.org/2000/svg">%0A  <path d="M1 7V1H7" stroke="%2374FFDE" stroke-width="0.25" />%0A  <path d="M7 33H1L1 27" stroke="%2374FFDE" stroke-width="0.25" />%0A  <path d="M33 27V33H27" stroke="%2374FFDE" stroke-width="0.25" />%0A  <path d="M27 1L33 1V7" stroke="%2374FFDE" stroke-width="0.25" />%0A</svg>'}),oh,yC=k(()=>{oh=(s,l=s)=>`
  left: `.concat(s*-.5,`px;
  top: `).concat(l*-.5,`px;
  width: `).concat(s,`px;
  height: `).concat(l,`px;
`)}),vC,pre,mre,d7e=k(()=>{vC=mn(),pre=(0,vC.prism)(()=>{let[s,l]=vC.prism.state("pos",null);return vC.prism.effect("setupListeners",()=>{let u=m=>{l(m)};return document.addEventListener("mousemove",u),()=>{document.removeEventListener("mousemove",u)}},[]),s}),mre=pre}),Lm,vl,Hb,gre,yre,vre,_re,Bm,wp,_C,xre,bre,Za=k(()=>{Lm=mn(),d7e(),Fo(),vl=Q(qe()),Hb=(0,vl.createContext)(null),gre=0,yre=({children:s,layoutP:l})=>{let u=(0,vl.useMemo)(()=>new Lm.Atom([]),[]),m=(0,vl.useMemo)(()=>(0,Lm.prism)(()=>{let E=Lm.prism.memo("p",()=>xre(l),[l]).getValue(),T=(0,Lm.val)(u.pointer);return T.length>0?dm(T).position:E}),[l]),_=(0,vl.useCallback)(()=>{let E=gre++;return u.reduce(T=>[...T,{id:E,position:[-1,0]}]),{set:T=>{u.reduce(P=>{let N=P.findIndex(G=>G.id===E);if(N===-1)return console.warn("Lock is already freed. This is a bug."),P;let z=[...P];return z.splice(N,1,{id:E,position:[T,T===-1?0:1]}),z})},unlock:()=>{u.reduce(T=>T.filter(P=>P.id!==E))}}},[]),b={currentD:m,getLock:_};return vl.default.createElement(Hb.Provider,{value:b},s)},vre=()=>(0,vl.useContext)(Hb).currentD,_re=()=>{let{getLock:s}=(0,vl.useContext)(Hb),l=(0,vl.useRef)();return(0,vl.useLayoutEffect)(()=>()=>{var u;(u=l.current)==null||u.unlock()},[]),(0,vl.useMemo)(()=>{let u;return(m,_)=>{var b,E;(u==null?void 0:u.shouldLock)!==m&&(m?l.current=s():(b=l.current)==null||b.unlock()),(u==null?void 0:u.pos)!==_&&m&&((E=l.current)==null||E.set(_)),u={shouldLock:m,pos:_}}},[s])},Bm=(s,l)=>{let{getLock:u}=(0,vl.useContext)(Hb),m=(0,vl.useRef)();(0,vl.useLayoutEffect)(()=>{if(s)return m.current=u(),()=>{m.current.unlock()}},[s,u]),(0,vl.useLayoutEffect)(()=>{s&&m.current.set(l)},[l,s])},wp=s=>({[_C]:s==="hide"?s:s.toFixed(3)}),_C="data-theatre-lock-framestamp-to",xre=s=>(0,Lm.prism)(()=>{let l=(0,Lm.val)(s.rightDims),u=(0,Lm.val)(s.clippedSpace.toUnitSpace),m=(0,Lm.val)(mre);if(!m)return[-1,0];for(let z of m.composedPath()){if(!(z instanceof HTMLElement||z instanceof SVGElement))break;if(z.hasAttribute(_C)){let G=z.getAttribute(_C);if(typeof G!="string")continue;if(G==="hide")return[-1,0];let V=parseFloat(G);if(isFinite(V)&&V>=0)return[V,2]}}let{clientX:_,clientY:b}=m,{screenX:E,screenY:T,width:P,height:N}=l;if(fd(_,E,E+P)&&fd(b,T+16,T+N)){let z=_-E;return[u(z),3]}else return[-1,0]}),bre=yre}),Sre,Wb,sF,wre,Ere,Ep,Tre=k(()=>{Li(),ru(),Ft(),h7e(),yC(),Rd(),Za(),Sre=12,Wb=34,sF="beingDragged",Ep={BEING_DRAGGED_CLASS:sF,CSS:Wa(wre||(wre=J([`
    position: absolute;
    `,`;
    `,`;

    &.`,` {
      pointer-events: none !important;
    }
  `])),oh(Sre),Di,sF),CSS_WHEN_SOMETHING_DRAGGING:Wa(Ere||(Ere=J([`
    pointer-events: auto;
    cursor: var(`,`);

    //  thing
    // This box extends the hitzone so the user does not
    // accidentally leave the hitzone
    &:hover:after {
      position: absolute;
      top: calc(50% - `,`px);
      left: calc(50% - `,`px);
      width: `,`px;
      height: `,`px;
      display: block;
      content: ' ';
      background: url(`,`) no-repeat 100% 100%;
      // This icon might also fit: GiConvergenceTarget
    }
  `])),Pm,Wb/2,Wb/2,Wb,Wb,fre),reactProps(s){return $(R(R({},wp(s.position)),yl.includePositionSnapAttrs(s.position)),{className:s.isDragging?Ep.BEING_DRAGGED_CLASS:""})}}});function oF(){qb.set({mode:"snapToAll"})}function $5(){qb.set({mode:"snapToNone"})}function Mre(s){qb.set({mode:"snapToSome",positions:s})}function Cre(s,l){return Object.fromEntries(Object.entries(s).map(([u,m])=>[u,Object.fromEntries(Object.entries(m.trackData).map(([_,b])=>[_,b.keyframes.filter(E=>l(E,{trackId:_,trackData:b,objectKey:u})).map(E=>E.position)]))]))}var Are,Pre,aF,Rre,kre,Ire,Nre,Dre,$b,qb,lF,q5=k(()=>{Are=mn(),Pre=mn(),aF=Q(qe()),Ft(),Tre(),kre=Te.div(Rre||(Rre=J([`
  z-index: 1;
  cursor: ew-resize;

  `,`

  #pointer-root.draggingPositionInSequenceEditor & {
    `,`
  }
`])),Ep.CSS,Ep.CSS_WHEN_SOMETHING_DRAGGING),Nre=Te.div(Ire||(Ire=J([`
  position: absolute;
`]))),Dre=s=>aF.default.createElement(Nre,{style:{top:"".concat(s.leaf.nodeHeight/2,"px"),left:"calc(".concat((0,Pre.val)(s.layoutP.scaledSpace.leftPadding),"px + calc(var(--unitSpaceToScaledSpaceMultiplier) * ").concat(s.position,"px))")}},aF.default.createElement(kre,R({},Ep.reactProps({isDragging:!1,position:s.position})))),$b=Dre,qb=new Are.Atom({mode:"snapToNone"}),lF=qb.prism});function f7e(s,l){let u=(0,X5.useMemo)(()=>({debugName:"HorizontallyScrollableArea",onDragStart(_){if(_.target instanceof HTMLInputElement||_.shiftKey||_.altKey||_.ctrlKey||_.metaKey||_.composedPath().some(G=>G instanceof HTMLElement&&G.draggable===!0))return!1;let b=_.clientX-l.getBoundingClientRect().left,E=ii((0,ho.val)(s.clippedSpace.toUnitSpace)(b),0,1/0),T=(0,ho.val)(s.seeker.setIsSeeking),P=(0,ho.val)(s.sheet).getSequence();P.position=E;let N=E,z=(0,ho.val)(s.scaledSpace.toUnitSpace);return T(!0),oF(),{onDrag(G,V,B){let H=z(G),j=ii(N+H,0,P.length),X=yl.checkIfMouseEventSnapToPos(B,{});X!=null&&(j=X),P.position=j},onDragEnd(){T(!1),$5()}}}}),[s,l]),[m]=uo(l,u);rh(m,"draggingPositionInSequenceEditor","ew-resize")}function p7e(s,l){let u=cre();(0,X5.useLayoutEffect)(()=>{if(!l)return;let m=b=>{if(b.ctrlKey){b.preventDefault(),b.stopPropagation();let E=b.clientX-l.getBoundingClientRect().left,T=(0,ho.val)(s.clippedSpace.toUnitSpace)(E),P=(0,ho.val)(s.clippedSpace.range),N=1+cF(b.deltaY,[-50,50])*.03,z=np(P,B=>(B-T)*N+T),G=(0,ho.val)(s.sheet).getSequence().length,V=G+G*.25;(0,ho.val)(s.clippedSpace.setRange)(m7e(z,[0,V]));return}else if(b.shiftKey){b.preventDefault(),b.stopPropagation();let E=(0,ho.val)(s.sheet).getSequence().length,T=(0,ho.val)(s.clippedSpace.range),P=(T.end-T.start)/E,N=cF(b.deltaY||b.deltaX,[-50,50])*.05*P,z=np(T,G=>G+N);(0,ho.val)(s.clippedSpace.setRange)(z);return}else{u(b),b.preventDefault(),b.stopPropagation();let E=(0,ho.val)(s.scaledSpace.toUnitSpace)(b.deltaX*1),T=(0,ho.val)(s.clippedSpace.range),P=np(T,N=>N+E);(0,ho.val)(s.clippedSpace.setRange)(P);return}},_={capture:!0,passive:!1};return l.addEventListener("wheel",m,_),()=>{l.removeEventListener("wheel",m,_)}},[l,s]),uo(l,(0,X5.useMemo)(()=>({onDragStart(m){let _=(0,ho.val)(s.clippedSpace.range),b=(0,ho.val)(s.clippedSpace.setRange),E=(0,ho.val)(s.scaledSpace.toUnitSpace);return m.preventDefault(),m.stopPropagation(),{onDrag(T,P,N,z,G){u({deltaY:-G});let V=-E(T),B=np(_,H=>H+V);b(B)}}},debugName:"HorizontallyScrollableArea Middle Button Drag",buttons:[1],lockCSSCursorTo:"grabbing"}),[s]))}function cF(s,[l,u]){return Math.max(Math.min(s,u),l)}function m7e(s,l){return np(s,u=>cF(u,l))}function g7e(s,l){(0,X5.useLayoutEffect)(()=>{if(!l)return;let u=(0,ho.prism)(()=>{let E=(0,ho.val)(s.clippedSpace.range);return(0,ho.val)(s.scaledSpace.fromUnitSpace)(E.start)}),m=()=>{let E=u.getValue();l.scrollLeft=E},_=u.onStale(m);m();let b=setTimeout(m,100);return()=>{clearTimeout(b),_()}},[s,l])}var ho,X5,Ore,Fre,Lre,uF,Bre=k(()=>{Yo(),Fi(),er(),ho=mn(),Fo(),X5=Q(qe()),Ft(),dre(),Li(),ru(),Rd(),q5(),Fre=Te.div(Ore||(Ore=J([`
  position: absolute;

  right: 0;
  overflow-x: scroll;
  overflow-y: hidden;
  `,`;

  // hide the scrollbar on Gecko
  scrollbar-width: none;

  // hide the scrollbar on Webkit/Blink
  &::-webkit-scrollbar {
    display: none;
  }
`])),Di),Lre=X5.default.memo(({layoutP:s,children:l,height:u})=>{let{width:m,unitSpaceToScaledSpaceMultiplier:_}=jr(()=>({width:(0,ho.val)(s.rightDims.width),unitSpaceToScaledSpaceMultiplier:(0,ho.val)(s.scaledSpace.fromUnitSpace)(1)}),[s]),[b,E]=Ai(null);return p7e(s,E),f7e(s,E),g7e(s,E),X5.default.createElement(Fre,{ref:b,style:{width:m+"px",height:u+"px","--unitSpaceToScaledSpaceMultiplier":_}},l)}),uF=Lre}),xC,Ure,zre,Vre,Gre,jre,Hre,Wre,Rv,bC=k(()=>{xC=Q(qe()),Ft(),zre=Te.li(Ure||(Ure=J([`
  margin: 0;
  padding: 0;
  list-style: none;
  box-sizing: border-box;
  position: relative;
`]))),Gre=Te.div(Vre||(Vre=J([`
  box-sizing: border-box;
  width: 100%;
  position: relative;

  &:before {
    position: absolute;
    display: block;
    content: ' ';
    left: -40px;
    top: 0;
    bottom: 0;
    right: 0;
    box-sizing: border-box;
    border-bottom: 1px solid #252b3869;
    background: `,`;
  }
`])),s=>s.isEven?"transparent":"#6b8fb505"),Hre=Te.ul(jre||(jre=J([`
  margin: 0;
  padding: 0;
  list-style: none;
`]))),Wre=({leaf:s,children:l,node:u,isCollapsed:m})=>{let _=Array.isArray(l)&&l.length>0;return s.shouldRender?xC.default.createElement(zre,null,xC.default.createElement(Gre,{style:{height:s.nodeHeight+"px"},isEven:s.n%2===0},u),_&&xC.default.createElement(Hre,null,l)):null},Rv=Wre}),y7e=ie((s,l)=>{(function(){var u=this,m={};typeof s<"u"?l.exports=m:u.fuzzy=m,m.simpleFilter=function(_,b){return b.filter(function(E){return m.test(_,E)})},m.test=function(_,b){return m.match(_,b)!==null},m.match=function(_,b,E){E=E||{};var T=0,P=[],N=b.length,z=0,G=0,V=E.pre||"",B=E.post||"",H=E.caseSensitive&&b||b.toLowerCase(),j;_=E.caseSensitive&&_||_.toLowerCase();for(var X=0;X<N;X++)j=b[X],H[X]===_[T]?(j=V+j+B,T+=1,G+=1+G):G=0,z+=G,P[P.length]=j;return T===_.length?(z=H===_?1/0:z,{rendered:P.join(""),score:z}):null},m.filter=function(_,b,E){return!b||b.length===0?[]:typeof _!="string"?b:(E=E||{},b.reduce(function(T,P,N,z){var G=P;E.extract&&(G=E.extract(P));var V=m.match(_,G,E);return V!=null&&(T[T.length]={string:V.rendered,score:V.score,index:N,original:P}),T},[]).sort(function(T,P){var N=P.score-T.score;return N||T.index-P.index}))}})()});function v7e(s,l){let[u,m]=(0,SC.useState)(!1),_=(0,SC.useRef)(l);return u||(_.current=l),(0,SC.useMemo)(()=>s(m),_.current)}var SC,_7e=k(()=>{SC=Q(qe())}),hF,V9,wC=k(()=>{hF="rgba(26, 28, 30, 0.97);",V9="#272B2F"});function $re(s,l,u,m){let _=v7e(b=>({debugName:"CurveSegmentEditor/useKeyframeDrag",lockCSSCursorTo:"move",onDragStart(){return b(!0),{onDrag(E,T){s&&u.onCurveChange(m(E,T))},onDragEnd(E){b(!1),u.onCancelCurveChange()}}}}),[s,u.onCurveChange,u.onCancelCurveChange]);uo(l,_)}var ki,EC,Xb,kv,qre,Yb,Xre,TC,Yre,Kre,Zre,Iv,Qre,Y5,Jre,eie,dF,tie,MC,nie,fF,rie,iie,x7e=k(()=>{ki=Q(qe()),Yo(),Fi(),Wf(),Ft(),Li(),_7e(),wC(),EC=.12,Xb=1+EC*2,kv=.01,qre=8,Yb=(1-kv)/(qre-1),Xre="#3EAAA4",TC="#3EAAA4",Yre="#3EAAA4",Kre="#3EAAA4",Zre="#3EAAA4",Iv="#3EAAA4",Qre="#3EAAA4",Y5="#B3B3B3",Jre="#3eaaa4",eie="#67dfd8",dF=["goldenrod","cornflowerblue","dodgerblue","lawngreen"],MC=Te.circle(tie||(tie=J([`
  stroke-width: 0.1px;
  vector-effect: non-scaling-stroke;
  r: 0.04px;
  pointer-events: none;
  transition: r 0.15s;
  fill: `,`;
`])),Jre),fF=Te.circle(nie||(nie=J([`
  stroke-width: 0.1px;
  vector-effect: non-scaling-stroke;
  r: 0.09px;
  cursor: move;
  `,`;
  &:hover {
    opacity: 0.4;
  }
  &:hover + `,` {
    fill: `,`;
  }
`])),Di,MC,eie),rie=s=>{let{curveConnection:{left:l,right:u},backgroundConnections:m}=s,_=Math.min(0,1-u.handles[1],1-l.handles[3]),b=Math.max(1,1-u.handles[1],1-l.handles[3]),E=Math.max(1,b-_),T=K=>(K-_)/E,[P,N]=Ai(null),z=Xb/((N==null?void 0:N.clientWidth)||1),G=Xb/((N==null?void 0:N.clientHeight)||1),[V,B]=Ai(null);$re(N,B,s,(K,te)=>{let se=ii(l.handles[2]+K*z,0,1),pe=l.handles[3]-te*G;return[se,pe,u.handles[0],u.handles[1]]});let[H,j]=Ai(null);$re(N,j,s,(K,te)=>{let se=ii(u.handles[0]+K*z,0,1),pe=u.handles[1]-te*G;return[l.handles[2],l.handles[3],se,pe]});let X=K=>"M0 ".concat(T(1)," C").concat(K.left.handles[2]," ").concat(T(1-K.left.handles[3])," ").concat(K.right.handles[0]," ").concat(T(1-K.right.handles[1])," 1 ").concat(T(0));return ki.default.createElement("svg",{height:"100%",width:"100%",ref:P,viewBox:"".concat(-EC," ").concat(-EC," ").concat(Xb," ").concat(Xb),xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"none",fill:"none"},ki.default.createElement("linearGradient",{id:"myGradient",gradientTransform:"rotate(90)"},ki.default.createElement("stop",{offset:T(-1),stopColor:Qre}),ki.default.createElement("stop",{offset:T(0),stopColor:Iv}),ki.default.createElement("stop",{offset:T(.3),stopColor:Zre}),ki.default.createElement("stop",{offset:T(.5),stopColor:Kre}),ki.default.createElement("stop",{offset:T(.7),stopColor:Yre}),ki.default.createElement("stop",{offset:T(1),stopColor:TC}),ki.default.createElement("stop",{offset:T(2),stopColor:Xre})),ki.default.createElement("pattern",{id:"dot-background-pattern-1",width:Yb,height:Yb/E,y:-_/E},ki.default.createElement("rect",{width:kv,height:kv,fill:Y5,opacity:.3})),ki.default.createElement("rect",{x:0,y:0,width:"1",height:1,fill:"url(#dot-background-pattern-1)"}),ki.default.createElement("pattern",{id:"dot-background-pattern-2",width:Yb,height:Yb},ki.default.createElement("rect",{width:kv,height:kv,fill:Y5})),ki.default.createElement("rect",{x:0,y:T(0),width:"1",height:T(1)-T(0),fill:"url(#dot-background-pattern-2)"}),!l.type||l.type==="bezier"?ki.default.createElement(ki.default.Fragment,null,ki.default.createElement("line",{x1:0,y1:T(1),x2:l.handles[2],y2:T(1-l.handles[3]),stroke:Y5,strokeWidth:"0.01"}),ki.default.createElement("line",{x1:1,y1:T(0),x2:u.handles[0],y2:T(1-u.handles[1]),stroke:Y5,strokeWidth:"0.01"}),ki.default.createElement("path",{d:X(s.curveConnection),stroke:"none",fill:"url('#myGradient')",opacity:"0.1"}),m.map((K,te)=>ki.default.createElement("path",{key:K.objectKey+"/"+K.left.id,d:X(K),stroke:dF[te%dF.length],opacity:.6,strokeWidth:"0.01"})),ki.default.createElement("path",{d:X(s.curveConnection),stroke:"url('#myGradient')",strokeWidth:"0.02"}),ki.default.createElement("circle",{cx:0,cy:T(1),r:"0.025",stroke:TC,strokeWidth:"0.02",fill:V9}),ki.default.createElement("circle",{cx:1,cy:T(0),r:"0.025",stroke:Iv,strokeWidth:"0.02",fill:V9}),ki.default.createElement(fF,{ref:V,cx:l.handles[2],cy:T(1-l.handles[3]),fill:TC,opacity:.2}),ki.default.createElement(MC,{cx:l.handles[2],cy:T(1-l.handles[3])}),ki.default.createElement(fF,{ref:H,cx:u.handles[0],cy:T(1-u.handles[1]),fill:Iv,opacity:.2}),ki.default.createElement(MC,{cx:u.handles[0],cy:T(1-u.handles[1])})):ki.default.createElement(ki.default.Fragment,null,ki.default.createElement("line",{x1:0,y1:T(1),x2:1,y2:T(1),stroke:Y5,strokeWidth:"0.01"}),ki.default.createElement("line",{x1:1,y1:T(1),x2:1,y2:0,stroke:Y5,strokeWidth:"0.01"}),ki.default.createElement("circle",{cx:0,cy:1,r:"0.025",stroke:Iv,strokeWidth:"0.02",fill:V9}),ki.default.createElement("circle",{cx:1,cy:0,r:"0.025",stroke:Iv,strokeWidth:"0.02",fill:V9})))},iie=rie});function CC(s){return s.map(l=>l.toFixed(3)).join(", ")}function AC(s){if(!s||(s==null?void 0:s.length)>sie)return null;let l=s.split(",");if(l.length!==4)return null;let u=l.map(m=>Number(m.trim()));return!u.every(m=>isFinite(m))||u[0]<0||u[0]>1||u[2]<0||u[2]>1?null:u}function b7e(s,l,u={threshold:.02}){if(!s||!l)return!1;let m=0;for(let _=0;_<4;_++)m+=Math.abs(s[_]-l[_]);return m<u.threshold}var sie,PC,oie=k(()=>{sie=128,PC=[{label:"Quad Out",value:"0.250, 0.460, 0.450, 0.940"},{label:"Quad In Out",value:"0.455, 0.030, 0.515, 0.955"},{label:"Quad In",value:"0.550, 0.085, 0.680, 0.530"},{label:"Cubic Out",value:"0.215, 0.610, 0.355, 1.000"},{label:"Cubic In Out",value:"0.645, 0.045, 0.355, 1.000"},{label:"Cubic In",value:"0.550, 0.055, 0.675, 0.190"},{label:"Quart Out",value:"0.165, 0.840, 0.440, 1.000"},{label:"Quart In Out",value:"0.770, 0.000, 0.175, 1.000"},{label:"Quart In",value:"0.895, 0.030, 0.685, 0.220"},{label:"Quint Out",value:"0.230, 1.000, 0.320, 1.000"},{label:"Quint In Out",value:"0.860, 0.000, 0.070, 1.000"},{label:"Quint In",value:"0.755, 0.050, 0.855, 0.060"},{label:"Sine Out",value:"0.390, 0.575, 0.565, 1.000"},{label:"Sine In Out",value:"0.445, 0.050, 0.550, 0.950"},{label:"Sine In",value:"0.470, 0.000, 0.745, 0.715"},{label:"Expo Out",value:"0.190, 1.000, 0.220, 1.000"},{label:"Expo In Out",value:"1.000, 0.000, 0.000, 1.000"},{label:"Expo In",value:"0.780, 0.000, 0.810, 0.00"},{label:"Circ Out",value:"0.075, 0.820, 0.165, 1.000"},{label:"Circ In Out",value:"0.785, 0.135, 0.150, 0.860"},{label:"Circ In",value:"0.600, 0.040, 0.980, 0.335"},{label:"Back Out",value:"0.175, 0.885, 0.320, 1.275"},{label:"Back In Out",value:"0.680, -0.550, 0.265, 1.550"},{label:"Back In",value:"0.600, -0.280, 0.735, 0.045"},{label:"linear",value:"0.5, 0.5, 0.5, 0.5"},{label:"In Out",value:"0.42,0,0.58,1"},{label:"Hold",value:"0, 0, Infinity, Infinity"}]}),C0,RC,K5,pF,aie,lie,Kb,mF,gF,cie,uie,S7e=k(()=>{C0=Q(qe()),RC=.75,K5=.1,pF=1+RC*2,aie="#F5F5F5",lie="#888888",Kb="#4f4f4f",mF="rgba(255, 255, 255, 0.1)",gF=s=>1-s,cie=s=>{let{easing:l,isSelected:u}=s,m=u?aie:lie,_="".concat(-RC," ").concat(-RC," ").concat(pF," ").concat(pF);if(l){let b=[l[0],gF(l[1])],E=[l[2],gF(l[3])];return C0.default.createElement("svg",{height:"100%",width:"100%",viewBox:_,fill:"none",xmlns:"http://www.w3.org/2000/svg"},C0.default.createElement("line",{x1:"0",y1:"1",x2:b[0],y2:b[1],stroke:Kb,strokeWidth:"0.1"}),C0.default.createElement("line",{x1:"1",y1:"0",x2:E[0],y2:E[1],stroke:Kb,strokeWidth:"0.1"}),C0.default.createElement("circle",{cx:b[0],cy:b[1],r:.1,fill:mF}),C0.default.createElement("circle",{cx:E[0],cy:E[1],r:.1,fill:mF}),C0.default.createElement("circle",{cx:b[0],cy:b[1],r:K5,fill:Kb}),C0.default.createElement("circle",{cx:E[0],cy:E[1],r:K5,fill:Kb}),C0.default.createElement("path",{d:"M0 1 C".concat(b[0]," ").concat(b[1]," ").concat(E[0],` 
        `).concat(E[1]," 1 0"),stroke:m,strokeWidth:"0.08"}),C0.default.createElement("circle",{cx:0,cy:1,r:K5,fill:m}),C0.default.createElement("circle",{cx:1,cy:0,r:K5,fill:m}))}return C0.default.createElement("svg",{height:"100%",width:"100%",viewBox:_,fill:"none",xmlns:"http://www.w3.org/2000/svg"},C0.default.createElement("line",{x1:"0",y1:"1",x2:1,y2:1,stroke:m,strokeWidth:"0.08"}),C0.default.createElement("line",{x1:"1",y1:"0",x2:1,y2:1,stroke:m,strokeWidth:"0.08"}),C0.default.createElement("circle",{cx:0,cy:1,r:K5,fill:m}),C0.default.createElement("circle",{cx:1,cy:0,r:K5,fill:m}))},uie=cie}),Zb,hie,die,fie,pie,mie,gie,yie,w7e=k(()=>{kb(),Zb=Q(qe()),Ft(),oie(),S7e(),lM(),wC(),yp(),fie=Te.div(die||(die=J([`
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  aspect-ratio: 1;

  transition: background-color 0.15s;
  background-color: `,`;
  border-radius: 2px;
  cursor: pointer;
  outline: none;

  `,`

  &:hover {
    background-color: #31353a;
  }

  &:focus {
    background-color: #383d42;
  }
`])),V9,({isSelected:s})=>s&&Wa(hie||(hie=J([`
      background-color: #383d42;
    `])))),mie=Te(gp)(pie||(pie=J([`
  padding: 0.5em;
  color: white;
  max-width: 240px;
  pointer-events: none !important;
  --popover-bg: black;
  --popover-outer-stroke: transparent;
  --popover-inner-stroke: transparent;
  box-shadow: none;
`]))),gie=Zb.default.forwardRef((s,l)=>{let[u,m]=Sv({enabled:!0,verticalPlacement:s.tooltipPlacement,verticalGap:0},()=>Zb.default.createElement(mie,{showPopoverEdgeTriangle:!1},s.easing.label));return Zb.default.createElement(fie,R({ref:aM([m,l])},s),u,Zb.default.createElement(uie,{easing:AC(s.easing.value),isSelected:s.isSelected}))}),yie=gie});function E7e(s){var l;let[u,m]=(0,vie.useState)(null),_=E=>{if(u===null){s.items.length>0&&m(0);return}let T=u+E*s.uiColumns,P=T<0,N=T>s.items.length-1;if(P||N){if(s.canVerticleExit&&s.canVerticleExit(P?"top":"bottom")){m(null);return}return}m(T)},b=E=>{u===null?m(A7e(E,s.items.length)):u+E<0?m(null):m(Math.min(u+E,s.items.length-1))};return{focusFirstItem(){m(0)},onParentEltKeyDown:E=>{if(E.key==="ArrowRight")b(1);else if(E.key==="ArrowLeft")b(-1);else if(E.key==="ArrowUp")_(-1);else if(E.key==="ArrowDown")_(1);else return 0;return 1},gridItems:s.items.map((E,T)=>s.renderItem({isSelected:T===u,item:E,select(P){m(T),s.onSelectItem(E)===1&&(P==null||P.preventDefault(),P==null||P.stopPropagation())}})),currentSelection:(l=s.items[u??-1])!=null?l:null}}var vie,T7e=k(()=>{vie=Q(qe()),IC()});function _ie(s,l,u){var m;(m=s.current)==null||m.discard(),s.current=null;let _=AC(u);_===null?s.current=C7e(l):s.current=M7e(l,_)}function xie(s){var l;(l=s.current)==null||l.discard(),s.current=null}function M7e(s,l){return Se().tempTransaction(({stateEditors:u})=>{let{setHandlesForKeyframe:m,setKeyframeType:_}=u.coreByProject.historic.sheetsById.sequence;for(let{projectId:b,sheetId:E,objectKey:T,trackId:P,left:N,right:z}of s)m({projectId:b,sheetId:E,objectKey:T,trackId:P,keyframeId:N.id,start:[l[0],l[1]]}),m({projectId:b,sheetId:E,objectKey:T,trackId:P,keyframeId:z.id,end:[l[2],l[3]]}),_({projectId:b,sheetId:E,objectKey:T,trackId:P,keyframeId:N.id,keyframeType:"bezier"})})}function C7e(s){return Se().tempTransaction(({stateEditors:l})=>{let{setKeyframeType:u}=l.coreByProject.historic.sheetsById.sequence;for(let{projectId:m,sheetId:_,objectKey:b,trackId:E,left:T}of s)u({projectId:m,sheetId:_,objectKey:b,trackId:E,keyframeId:T.id,keyframeType:"hold"})})}function A7e(s,l){return(s%l+l)%l}function P7e(s,l){return()=>setTimeout(s,l)}function R7e({left:s,right:l}){return({left:u,right:m})=>s.handles[2]!==u.handles[2]||s.handles[3]!==u.handles[3]||l.handles[0]!==m.handles[0]||l.handles[1]!==m.handles[1]}var kC,qs,bie,yF,vF,Sie,wie,Eie,Tie,Mie,Cie,Aie,Pie,Rie,kie,Iie,Nie,_F,k7e,xF,Die,IC=k(()=>{kC=mn(),qs=Q(qe()),Ft(),bie=Q(y7e()),Ae(),x7e(),w7e(),oie(),wC(),Fi(),T7e(),yF=3,vF=53,Sie=25,Eie=Te.div(wie||(wie=J([`
  background: `,`;
  display: grid;
  grid-template-areas:
    'search  tween'
    'presets tween';
  grid-template-rows: 32px 1fr;
  grid-template-columns: `,`px 120px;
  gap: 1px;
  height: 120px;
`])),hF,yF*vF),Mie=Te.div(Tie||(Tie=J([`
  overflow: auto;
  grid-area: presets;

  display: grid;
  grid-template-columns: repeat(`,`, 1fr);
  grid-auto-rows: min-content;
  gap: 1px;

  overflow-y: scroll;
  scrollbar-width: none; /* Firefox */
  -ms-overflow-style: none; /* Internet Explorer 10+ */
  &::-webkit-scrollbar {
    /* WebKit */
    width: 0;
    height: 0;
  }
`])),yF),Aie=Te.input.attrs({type:"text"})(Cie||(Cie=J([`
  background-color: `,`;
  border: none;
  border-radius: 2px;
  color: rgba(255, 255, 255, 0.8);
  padding: 6px;
  font-size: 12px;
  outline: none;
  cursor: text;
  text-align: left;
  width: 100%;
  height: 100%;
  box-sizing: border-box;

  grid-area: search;

  &:hover {
    background-color: #212121;
  }

  &:focus {
    background-color: rgba(16, 16, 16, 0.26);
    outline: 1px solid rgba(0, 0, 0, 0.35);
  }
`])),V9),Rie=Te.div(Pie||(Pie=J([`
  grid-area: tween;
  background: `,`;
`])),V9),Iie=Te.div(kie||(kie=J([`
  grid-column: 1 / 4;
  padding: 6px;
  color: #888888;
`]))),Nie=s=>{let l=(0,qs.useMemo)(()=>[s.curveConnection,...s.additionalConnections],[s.curveConnection,...s.additionalConnections]),u=(0,qs.useRef)(null);(0,qs.useEffect)(()=>{let xe=Die(l);return()=>{var We;xe(),(We=u.current)==null||We.commit()}},[u]);let m=[s.curveConnection.left.handles[2],s.curveConnection.left.handles[3],s.curveConnection.right.handles[0],s.curveConnection.right.handles[1]],_=(0,qs.useRef)(null);(0,qs.useLayoutEffect)(()=>{var xe,We;(xe=_.current)==null||xe.select(),(We=_.current)==null||We.focus()},[_.current]);let[b,E]=(0,qs.useState)(CC(m)),T=xe=>{xe!==void 0&&(z(1),E(xe.target.value),AC(xe.target.value)&&V(xe.target.value))},P=xe=>{var We,oe;z(1),(xe.key==="ArrowDown"||xe.key==="ArrowUp")&&xe.preventDefault(),xe.key==="ArrowDown"?(vt.focusFirstItem(),(oe=(We=ve.current[K[0].label])==null?void 0:We.current)==null||oe.focus()):xe.key==="Escape"?(xie(u),s.onRequestClose("key Escape")):xe.key==="Enter"&&s.onRequestClose("key Enter")},[N,z]=(0,qs.useState)(0);(0,qs.useEffect)(()=>{N===2?E(CC(m)):N===3&&b!==""&&E("")},l);let[G,V]=(0,qs.useState)(CC(m)),[B,H]=(0,qs.useState)(null);(0,qs.useEffect)(()=>{var xe;N!==0&&N!==3&&_ie(u,l,(xe=B??G)!=null?xe:"")},[B,G,N]),l.some(R7e(s.curveConnection))&&N===0&&z(3);let j=xe=>{var We,oe;z(2);let nt=CC(xe);E(nt),V(nt),(We=_.current)==null||We.select(),(oe=_.current)==null||oe.focus()},X=()=>{},K=(0,qs.useMemo)(()=>/^[A-Za-z]/.test(b)?bie.default.filter(b,PC,{extract:xe=>xe.label}).map(xe=>xe.original):PC,[b]);(0,qs.useEffect)(()=>{N===1&&K[0]&&V(K[0].value)},[K]);let te=xe=>{xe.key==="Escape"?(xie(u),s.onRequestClose("key Escape"),xe.stopPropagation()):xe.key==="Enter"&&(s.onRequestClose("key Enter"),xe.stopPropagation())},se=xe=>{N===0&&z(2),H(xe.value)},pe=()=>H(null),fe=xe=>(_ie(u,l,xe.value),s.onRequestClose("selected easing option"),1),ve=(0,qs.useRef)(PC.reduce((xe,We)=>(xe[We.label]={current:null},xe),{})),[Ne,ze]=Ai(null),[Me,He]=(0,qs.useState)(0);(0,qs.useEffect)(()=>{let xe=()=>{var We;He((We=ze==null?void 0:ze.scrollTop)!=null?We:0)};return ze==null||ze.addEventListener("scroll",xe),()=>ze==null?void 0:ze.removeEventListener("scroll",xe)},[ze]);let vt=E7e({items:K,uiColumns:3,onSelectItem:fe,canVerticleExit(xe){var We,oe;return xe==="top"?((We=_.current)==null||We.select(),(oe=_.current)==null||oe.focus(),1):0},renderItem:({item:xe,select:We})=>{var oe,nt;return qs.default.createElement(yie,{key:xe.label,easing:xe,tabIndex:0,onKeyDown:te,ref:ve.current[xe.label],onMouseOver:()=>se(xe),onMouseOut:pe,onClick:We,tooltipPlacement:((nt=(oe=ve.current[xe.label].current)==null?void 0:oe.offsetTop)!=null?nt:0)-(Me??0)<vF+Sie?"bottom":"top",isSelected:b7e(m,AC(xe.value))})}});return(0,qs.useLayoutEffect)(()=>{var xe,We;if(vt.currentSelection!==null&&document.activeElement!==_.current){let oe=(We=(xe=ve.current)==null?void 0:xe[vt.currentSelection.label])==null?void 0:We.current;oe==null||oe.focus(),V(vt.currentSelection.value),/^[A-Za-z]/.test(b)||E(vt.currentSelection.value)}},[vt.currentSelection]),qs.default.createElement(Eie,null,qs.default.createElement(Aie,{value:b,placeholder:N===3?"Multiple easings selected":"Search presets...",onPaste:P7e(T),onChange:T,ref:_,onKeyDown:P}),qs.default.createElement(Mie,{ref:Ne,onKeyDown:xe=>vt.onParentEltKeyDown(xe)},vt.gridItems,vt.gridItems.length===0?qs.default.createElement(Iie,null,"No results found"):void 0),qs.default.createElement(Rie,{onClick:()=>{var xe;return(xe=_.current)==null?void 0:xe.focus()}},qs.default.createElement(iie,{curveConnection:s.curveConnection,backgroundConnections:s.additionalConnections,onCurveChange:j,onCancelCurveChange:X})))},_F=Nie,{isCurveEditorOpenD:k7e,isConnectionEditingInCurvePopover:xF,getLock:Die}=(()=>{let s=new kC.Atom([]);return{getLock(l){return s.set(l),function(){s.set([])}},isCurveEditorOpenD:(0,kC.prism)(()=>s.prism.getValue().length>0),isConnectionEditingInCurvePopover(l){return kC.prism.ensurePrism(),s.prism.getValue().some(({left:u,right:m})=>l.left.id===u.id&&l.right.id===m.id)}}})()});function I7e(s,l){for(let{keyframeId:u}of O7e(l))if(s.left.id===u)return!0;return!1}function Oie(s,l,u){return(0,DC.prism)(()=>{if(u===void 0)return[];let m=[];for(let{objectKey:_,trackId:b}of Fie(u)){let E=(0,DC.val)(Se().atomP.historic.coreByProject[s].sheetsById[l].sequence.tracksByObject[_].trackData[b]);E&&(m=m.concat(D7e(E.keyframes).filter(T=>I7e(T,u)).map(({left:T,right:P})=>({left:T,right:P,trackId:b,objectKey:_,sheetId:l,projectId:s}))))}return m})}function NC(s,l,u){var m;if(u===void 0)return[];let _=[];for(let{objectKey:E,trackId:T,keyframeIds:P}of Fie(u))_=_.concat((m=bF({projectId:s,sheetId:l,objectKey:E,trackId:T,keyframeIds:P}))!=null?m:[]);let b=dC(_.map(E=>E.pathToProp));return _.map(({keyframe:E,pathToProp:T})=>({keyframe:E,pathToProp:T.slice(b.length)}))}function bF({projectId:s,sheetId:l,objectKey:u,trackId:m,keyframeIds:_}){let b=(0,DC.val)(Se().atomP.historic.coreByProject[s].sheetsById[l].sequence.tracksByObject[u]),E=b==null?void 0:b.trackData[m];if(!E)return null;let T=N7e((b==null?void 0:b.trackIdByPropPath)||{})[m];if(!T)return null;let P=[u,...fC(T)];return _.map(N=>({keyframe:E.keyframes.find(z=>z.id===N),pathToProp:P})).filter(({keyframe:N})=>N!==void 0)}function N7e(s){let l={};for(let[u,m]of Object.entries(s))l[m]=u;return l}function D7e(s){return s.map((l,u)=>({left:l,right:s[u+1]})).slice(0,-1)}function O7e(s){var l,u,m;let _=[];for(let[b,E]of Object.entries((l=s==null?void 0:s.byObjectKey)!=null?l:{}))for(let[T,P]of Object.entries((u=E==null?void 0:E.byTrackId)!=null?u:{}))for(let N of Object.keys((m=P==null?void 0:P.byKeyframeId)!=null?m:{}))_.push({objectKey:b,trackId:T,keyframeId:N});return _}function Fie(s){var l,u,m;let _=[];for(let[b,E]of Object.entries((l=s==null?void 0:s.byObjectKey)!=null?l:{}))for(let[T,P]of Object.entries((u=E==null?void 0:E.byTrackId)!=null?u:{}))_.push({objectKey:b,trackId:T,keyframeIds:Object.keys((m=P==null?void 0:P.byKeyframeId)!=null?m:{})});return _}var DC,Nv=k(()=>{DC=mn(),Ae(),Sp()});function F7e(s,l){return(0,Lie.useMemo)(()=>L7e(s,l),[])}function L7e(s,l){let u=null,m=E=>Se().tempTransaction(T=>s(T,E));function _(){u==null||u.discard(),u=null}let b={createAsset:l.sheet.project.assetStorage.createAsset,getAssetUrl:E=>E.id?l.sheet.project.assetStorage.getAssetUrl(E.id):void 0};return R({temporarilySetValue(E){_(),u=m(E)},discardTemporaryValue:_,permanentlySetValue(E){_(),m(E).commit()}},b)}var Lie,B7e=k(()=>{Ae(),Lie=Q(qe())});function SF(s){var l;if(s.type==="sheetObject")return Qa.default.createElement(Qa.default.Fragment,null,Qa.default.createElement(OC,{style:{paddingLeft:"".concat(s.indent*FC,"px")}},s.sheetObject.address.objectKey),s.children.map((u,m)=>Qa.default.createElement(SF,$(R({key:m},u),{autoFocusInput:s.autoFocusInput&&m===0,indent:s.indent+1}))));if(s.type==="propWithChildren"){let u=(l=s.propConfig.label)!=null?l:dm(s.pathToProp);return Qa.default.createElement(Qa.default.Fragment,null,Qa.default.createElement(OC,{style:{paddingLeft:"".concat(s.indent*FC,"px")}},u),s.children.map((m,_)=>Qa.default.createElement(SF,$(R({key:_},m),{autoFocusInput:s.autoFocusInput&&_===0,indent:s.indent+1}))))}else return Qa.default.createElement(U7e,$(R({},s),{autoFocusInput:s.autoFocusInput,indent:s.indent}))}function U7e(s){var l;let u=(l=s.propConfig.label)!=null?l:dm(s.pathToProp),m=z7e(s);if(s.propConfig.type==="enum")return Qa.default.createElement(Qa.default.Fragment,null);{let _=QD[s.propConfig.type];return Qa.default.createElement(Uie,null,Qa.default.createElement(OC,null,Qa.default.createElement("span",{style:{paddingLeft:"".concat(s.indent*FC,"px")}},u)),Qa.default.createElement(Gie,null,Qa.default.createElement(_,{editingTools:m,propConfig:s.propConfig,value:RM(s.keyframe.value,s.propConfig),autoFocus:s.autoFocusInput})))}}function z7e(s){let l=s.sheetObject;return F7e(({stateEditors:u},m)=>{let _=$(R({},s.keyframe),{value:m});u.coreByProject.historic.sheetsById.sequence.replaceKeyframes($(R({},l.address),{trackId:s.trackId,keyframes:[_],snappingFunction:l.sheet.getSequence().closestGridPosition}))},l)}var Qa,Bie,Uie,zie,OC,FC,Vie,Gie,V7e=k(()=>{Qa=Q(qe()),Ft(),MZ(),Cy(),B7e(),I9(),Uie=Te.div(Bie||(Bie=J([`
  display: flex;
  align-items: stretch;
  min-width: 200px;

  select {
    min-width: 100px;
  }
`]))),OC=Te.div(zie||(zie=J([`
  font-style: normal;
  font-weight: 400;
  font-size: 11px;
  line-height: 13px;
  letter-spacing: 0.01em;
  padding: 6px 6px 6px 0;

  width: 40%;

  color: #919191;

  overflow: hidden;
`]))),FC=10,Gie=Te.div(Vie||(Vie=J([`
  display: flex;
  align-items: center;
  width: 60%;
`])))});function LC(s){return pp({debugName:"useKeyframeInlineEditorPopover"},()=>BC.default.createElement(gp,{showPopoverEdgeTriangle:!0},BC.default.createElement("div",{style:{margin:"1px 2px 1px 10px"}},Array.isArray(s)?s.map((l,u)=>BC.default.createElement(SF,$(R({key:u},l),{autoFocusInput:u===0,indent:0}))):void 0)))}var BC,UC=k(()=>{BC=Q(qe()),mp(),yp(),V7e()});function G7e(s,l,u){return ml(s,{displayName:"Keyframe",menuItems:()=>{let m=NC(u.leaf.sheetObject.address.projectId,u.leaf.sheetObject.address.sheetId,u.selection);return[{label:m.length>0?"Copy (selection)":"Copy",callback:()=>{m.length>0?Se().transaction(_=>{_.stateEditors.studio.ahistoric.setClipboardKeyframes(m)}):Se().transaction(_=>{_.stateEditors.studio.ahistoric.setClipboardKeyframes([{keyframe:u.keyframe,pathToProp:u.leaf.pathToProp}])})}},{label:u.selection!==void 0?"Delete (selection)":"Delete",callback:()=>{u.selection?u.selection.delete():Se().transaction(({stateEditors:_})=>{_.coreByProject.historic.sheetsById.sequence.deleteKeyframes($(R({},u.leaf.sheetObject.address),{keyframeIds:[u.keyframe.id],trackId:u.leaf.trackId}))})}}]},onOpen(){l._debug("Show keyframe",u)}})}function j7e(s,l,u){let m=(0,G9.useRef)(l);m.current=l;let{onClickFromDrag:_}=u,b=(0,G9.useMemo)(()=>({debugName:"KeyframeDot/useDragKeyframe",onDragStart(T){let P=m.current,N=(0,zC.val)(Se().atomP.historic.coreByProject[P.leaf.sheetObject.address.projectId].sheetsById[P.leaf.sheetObject.address.sheetId].sequence.tracksByObject),z=Cre(N,function(H,{trackId:j,objectKey:X}){var K,te;return H.id!==P.keyframe.id&&!(P.selection&&(te=(K=P.selection.byObjectKey[X])==null?void 0:K.byTrackId[j])!=null&&te.byKeyframeId[H.id])});if(Mre(z),P.selection){let{selection:H,leaf:j}=P,{sheetObject:X}=j,K=H.getDragHandlers($(R({},X.address),{domNode:s,positionAtStartOfDrag:P.track.data.keyframes[P.index].position})).onDragStart(T);return K&&$(R({},K),{onClick:_,onDragEnd:(...te)=>{var se;(se=K.onDragEnd)==null||se.call(K,...te),$5()}})}let G=P,V=(0,zC.val)(G.layoutP.scaledSpace.toUnitSpace),B;return{onDrag(H,j,X){var K;let te=G.track.data.keyframes[G.index],se=Math.max((K=yl.checkIfMouseEventSnapToPos(X,{ignore:s}))!=null?K:te.position+V(H),0);B==null||B.discard(),B=void 0,B=Se().tempTransaction(({stateEditors:pe})=>{pe.coreByProject.historic.sheetsById.sequence.replaceKeyframes($(R({},G.leaf.sheetObject.address),{trackId:G.leaf.trackId,keyframes:[$(R({},te),{position:se})],snappingFunction:(0,zC.val)(G.layoutP.sheet).getSequence().closestGridPosition}))})},onDragEnd(H){H?B==null||B.commit():B==null||B.discard(),$5()},onClick(H){_(H)}}}}),[_]),[E]=uo(s,b);return Bm(E,l.keyframe.position),rh(E,"draggingPositionInSequenceEditor","ew-resize"),[E]}var G9,zC,Qb,wF,Jb,EF,jie,VC,Hie,Wie,$ie,qie,Xie,Yie,Kie=k(()=>{G9=Q(qe()),Ft(),Ae(),gl(),Yo(),Fi(),zC=mn(),Za(),ru(),Rd(),yC(),R9(),Nv(),Li(),q5(),UC(),z5(),Qb=6,wF=Qb+2,Jb={normalColor:"#40AAA4",selectedColor:"#F2C95C",inlineEditorOpenColor:"#FCF3DC",selectedAndInlineEditorOpenColor:"#CBEBEA"},EF=({isSelected:s,isInlineEditorPopoverOpen:l})=>s&&l?Jb.inlineEditorOpenColor:s?Jb.selectedColor:l?Jb.selectedAndInlineEditorOpenColor:Jb.normalColor,VC=Te.div(jie||(jie=J([`
  position: absolute;
  `,`

  background: `,`;
  transform: rotateZ(45deg);

  `,`;

  z-index: 1;
  pointer-events: none;
`])),oh(Qb),s=>EF(s),s=>s.flag===2?"outline: 2px solid white;":""),Wie=Te.div(Hie||(Hie=J([`
  position: absolute;
  `,`

  background: `,`;

  `,`;

  z-index: 1;
  pointer-events: none;
`])),oh(Qb*1.5),s=>EF(s),s=>s.flag===2?"outline: 2px solid white;":""),qie=Te.div($ie||($ie=J([`
  z-index: 1;
  cursor: ew-resize;

  position: absolute;
  `,`;
  `,`;

  & + `,` {
    `,`
  }

  &:hover + `,` {
    `,`
  }
`])),oh(12),Di,VC,s=>s.isInlineEditorPopoverOpen?oh(wF):"",VC,oh(wF)),Xie=s=>{let l=P9("SingleKeyframeDot",s.keyframe.id),u=U5(s.itemKey),[m,_]=Ai(null),[b]=G7e(_,l,s),{node:E,toggle:T,isOpen:P}=LC([{type:"primitiveProp",keyframe:s.keyframe,pathToProp:s.leaf.pathToProp,propConfig:s.leaf.propConf,sheetObject:s.leaf.sheetObject,trackId:s.leaf.trackId}]);j7e(_,s,{onClickFromDrag(z){T(z,m.current)}});let N=!s.keyframe.type||s.keyframe.type==="bezier";return G9.default.createElement(G9.default.Fragment,null,G9.default.createElement(qie,R({ref:m,isInlineEditorPopoverOpen:P},u.attrs)),N?G9.default.createElement(VC,{isSelected:!!s.selection,isInlineEditorPopoverOpen:P,flag:u.flag}):G9.default.createElement(Wie,{isSelected:!!s.selection,isInlineEditorPopoverOpen:P,flag:u.flag}),E,b)},Yie=Xie}),TF,MF,CF,Z5,Zie,Qie,AF,Jie=k(()=>{nu(),TF=Q(qe()),Ft(),Kie(),MF=Qb/2+1,CF=1e3,Z5={normalColor:"#365b59",selectedColor:"#8A7842",barColor:s=>{let l=s.isSelected?Z5.selectedColor:Z5.normalColor;return s.isPopoverOpen?qT(.2,Qy(.2,l)):l},hoverColor:s=>{let l=s.isSelected?Z5.selectedColor:Z5.normalColor;return s.isPopoverOpen?qT(.2,Qy(.2,l)):qT(.1,Qy(.1,l))}},Qie=Te.div(Zie||(Zie=J([`
  position: absolute;
  background: `,`;
  height: `,`px;
  width: `,`px;

  left: 0;
  top: -`,`px;
  transform-origin: top left;
  z-index: 0;
  cursor: ew-resize;

  &:after {
    display: block;
    position: absolute;
    content: ' ';
    top: -4px;
    bottom: -4px;
    left: 0;
    right: 0;
  }

  &:hover {
    background: `,`;
  }
`])),Z5.barColor,MF,CF,MF/2,Z5.hoverColor),AF=TF.default.forwardRef((s,l)=>{let u={isPopoverOpen:s.isPopoverOpen,isSelected:s.isSelected};return TF.default.createElement(Qie,$(R({},u),{ref:l,style:{transform:"scaleX(calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(s.connectorLengthInUnitSpace/CF,"))")},onClick:m=>{var _;(_=s.openPopover)==null||_.call(s,m)}}),s.children)})});function H7e(s,l){let u=(0,PF.useRef)(l);u.current=l;let m=(0,PF.useMemo)(()=>({debugName:"useDragKeyframe",lockCSSCursorTo:"ew-resize",onDragStart(_){let b=u.current,E;if(b.selection){let{selection:z,leaf:G}=b,{sheetObject:V}=G;return z.getDragHandlers($(R({},V.address),{domNode:s,positionAtStartOfDrag:b.track.data.keyframes[b.index].position})).onDragStart(_)}let T=b,P=(0,GC.val)(T.layoutP.sheet).getSequence(),N=(0,GC.val)(T.layoutP.scaledSpace.toUnitSpace);return{onDrag(z,G,V){let B=N(z);E&&(E.discard(),E=void 0),E=Se().tempTransaction(({stateEditors:H})=>{H.coreByProject.historic.sheetsById.sequence.transformKeyframes($(R({},T.leaf.sheetObject.address),{trackId:T.leaf.trackId,keyframeIds:[T.keyframe.id,T.track.data.keyframes[T.index+1].id],translate:B,scale:1,origin:0,snappingFunction:P.closestGridPosition}))})},onDragEnd(z){z?E&&E.commit():E&&E.discard()}}}}),[]);uo(s,m)}function W7e(s,l,u,m){return ml(l,{displayName:"Tween",menuItems:()=>{let _=NC(s.leaf.sheetObject.address.projectId,s.leaf.sheetObject.address.sheetId,s.selection);return[{label:_.length>0?"Copy (selection)":"Copy",callback:()=>{_.length>0?Se().transaction(b=>{b.stateEditors.studio.ahistoric.setClipboardKeyframes(_)}):Se().transaction(b=>{b.stateEditors.studio.ahistoric.setClipboardKeyframes([{keyframe:u,pathToProp:s.leaf.pathToProp},{keyframe:m,pathToProp:s.leaf.pathToProp}])})}},{label:s.selection?"Delete (selection)":"Delete",callback:()=>{s.selection?s.selection.delete():Se().transaction(({stateEditors:b})=>{b.coreByProject.historic.sheetsById.sequence.deleteKeyframes($(R({},s.leaf.sheetObject.address),{keyframeIds:[u.id,m.id],trackId:s.leaf.trackId}))})}}]}})}var GC,j9,PF,RF,ese,tse,nse,rse,ise,$7e=k(()=>{Ae(),gl(),Yo(),Fi(),GC=mn(),j9=Q(qe()),PF=Q(qe()),mp(),yp(),IC(),Jie(),wC(),er(),Nv(),Nv(),Ft(),RF=5,tse=Te(gp)(ese||(ese=J([`
  --popover-outer-stroke: transparent;
  --popover-inner-stroke: `,`;
`])),hF),nse=s=>{let{index:l,track:u}=s,m=u.data.keyframes[l],_=u.data.keyframes[l+1],[b,E]=Ai(null),{node:T,toggle:P,close:N}=pp(()=>{let B=(0,GC.val)(s.layoutP.rightDims);return{debugName:"Connector",constraints:{minX:B.screenX+RF,maxX:B.screenX+B.width-RF}}},()=>j9.default.createElement(ise,$(R({},s),{closePopover:N}))),[z]=W7e(s,E,m,_);H7e(E,s);let G=_.position-m.position,V={isPopoverOpen:jr(()=>xF($(R({},s.leaf.sheetObject.address),{trackId:s.leaf.trackId,left:m,right:_})),[s.leaf.sheetObject.address,s.leaf.trackId,m,_]),isSelected:s.selection!==void 0};return j9.default.createElement(j9.default.Fragment,null,j9.default.createElement(AF,$(R({ref:b,connectorLengthInUnitSpace:G},V),{openPopover:B=>{E&&P(B,E)}}),T),z)},rse=nse,ise=j9.default.forwardRef((s,l)=>{let{index:u,track:{data:m},selection:_}=s,b=m.keyframes[u],E=m.keyframes[u+1],T=s.leaf.trackId,P=s.leaf.sheetObject.address,N=jr(()=>Oie(P.projectId,P.sheetId,_).getValue(),[P,_]),z=R({left:b,right:E,trackId:T},P);return j9.default.createElement(tse,{showPopoverEdgeTriangle:!1,ref:l},j9.default.createElement(_F,{curveConnection:z,additionalConnections:N,onRequestClose:s.closePopover}))})}),sse,Q5,ose,ase,lse,cse,use,q7e=k(()=>{sse=mn(),Q5=Q(qe()),Ft(),$7e(),Kie(),ase=Te.div(ose||(ose=J([`
  position: absolute;
`]))),lse=Q5.default.createElement(Q5.default.Fragment,null),cse=Q5.default.memo(s=>{let{index:l,track:{data:u}}=s,m=u.keyframes[l],_=u.keyframes[l+1],b=m.connectedRight&&!!_;return Q5.default.createElement(ase,{style:{top:"".concat(s.leaf.nodeHeight/2,"px"),left:"calc(".concat((0,sse.val)(s.layoutP.scaledSpace.leftPadding),"px + calc(var(--unitSpaceToScaledSpaceMultiplier) * ").concat(m.position,"px))")}},Q5.default.createElement(Yie,$(R({},s),{itemKey:s.itemKey})),b?Q5.default.createElement(rse,R({},s)):lse)}),use=cse});function X7e(s,l){return ml(s,{displayName:"Keyframe Track",menuItems:()=>{var u;let m=(u=(0,Dv.val)(Se().atomP.ahistoric.clipboard.keyframesWithRelativePaths))!=null?u:[];return[Y7e(l,m)]}})}function Y7e(s,l){return{label:"Paste Keyframes",enabled:l.length>0,callback:()=>{var u;let m=(0,Dv.val)(s.layoutP.sheet).getSequence(),_=(u=l[0])==null?void 0:u.pathToProp,b=l.filter(({keyframe:E,pathToProp:T})=>Qve(_,T)).map(({keyframe:E,pathToProp:T})=>E);Se().transaction(({stateEditors:E})=>{var T;m.position=m.closestGridPosition(m.position);let P=(T=K7e(b))==null?void 0:T.position;for(let N of b)E.coreByProject.historic.sheetsById.sequence.setKeyframeAtPosition($(R({},s.leaf.sheetObject.address),{trackId:s.leaf.trackId,position:m.position+N.position-P,handles:N.handles,value:N.value,snappingFunction:m.closestGridPosition,type:N.type}))})}}}function K7e(s){let l=null;for(let u of s)(l===null||u.position<l.position)&&(l=u);return l}var Dv,Um,hse,dse,kF,fse,Z7e=k(()=>{er(),Dv=mn(),Um=Q(qe()),Ft(),q7e(),gl(),Fi(),Ae(),Sp(),q5(),Dm(),dse=Te.div(hse||(hse=J([`
  position: relative;
  height: 100%;
  width: 100%;
`]))),kF=Um.default.memo(s=>{var l;let{layoutP:u,trackData:m,leaf:_}=s,[b,E]=Ai(null),{selectedKeyframeIds:T,selection:P}=jr(()=>{let se=(0,Dv.val)(u.selectionAtom),pe=(0,Dv.val)(se.pointer.current.byObjectKey[_.sheetObject.address.objectKey].byTrackId[_.trackId].byKeyframeId);return pe?{selectedKeyframeIds:pe,selection:(0,Dv.val)(se.pointer.current)}:{selectedKeyframeIds:{},selection:void 0}},[u,_.trackId]),[N,z,G]=X7e(E,s),V=Xr(lF),B=V.mode==="snapToSome"?(l=V.positions[_.sheetObject.address.objectKey])==null?void 0:l[_.trackId]:[],H=V.mode==="snapToAll",j=(0,Um.useMemo)(()=>({data:m,id:_.trackId,sheetObject:s.leaf.sheetObject}),[m,_.trackId]),X=m.keyframes.map((se,pe)=>Um.default.createElement(use,{key:"keyframe-"+se.id,itemKey:ha.forTrackKeyframe(_.sheetObject,_.trackId,se.id),keyframe:se,index:pe,track:j,layoutP:u,leaf:_,selection:T[se.id]===!0?P:void 0})),K=B.map(se=>Um.default.createElement($b,{key:"snap-target-"+se,layoutP:u,leaf:_,position:se})),te=H?m.keyframes.map(se=>Um.default.createElement($b,{key:"additionalSnapTarget-".concat(se.id),layoutP:u,leaf:_,position:se.position})):null;return Um.default.createElement(dse,{ref:b,style:{background:G?"#444850 ":"unset"}},X,K,Um.default.createElement(Um.default.Fragment,null,te),N)}),kF.displayName="BasicKeyframedTrack",fse=kF}),pse,eS,mse,gse,Q7e=k(()=>{Ae(),er(),pse=mn(),eS=Q(qe()),bC(),Z7e(),R9(),mse=({leaf:s,layoutP:l})=>{let u=P9("PrimitivePropRow",s.pathToProp.join());return jr(()=>{let{sheetObject:m}=s,{trackId:_}=s,b=(0,pse.val)(Se().atomP.historic.coreByProject[m.address.projectId].sheetsById[m.address.sheetId].sequence.tracksByObject[m.address.objectKey].trackData[_]);return(b==null?void 0:b.type)!=="BasicKeyframedTrack"?(u.errorDev("trackData type ".concat(b==null?void 0:b.type," is not yet supported on the sequence editor")),eS.default.createElement(Rv,{leaf:s,isCollapsed:!1,node:eS.default.createElement("div",null)})):eS.default.createElement(Rv,{leaf:s,isCollapsed:!1,node:eS.default.createElement(fse,{layoutP:l,trackData:b,leaf:s})})},[s,l])},gse=mse});function J7e(s){return s()}var e_e=k(()=>{});function yse(s){let{index:l,aggregateKeyframes:u,selection:m}=s;return jr(vse(s),[l,u,m,s.viewModel])}function vse(s){let{index:l,aggregateKeyframes:u,selection:m}=s,{projectId:_,sheetId:b}=s.viewModel.type==="sheet"?s.viewModel.sheet.address:s.viewModel.sheetObject.address;return()=>{let E=u[l],T=u[l+1],P=T&&E.keyframes.length===T.keyframes.length&&E.keyframes.every(({track:V},B)=>T.keyframes[B].track===V)?{length:T.position-E.position,selected:E.selected===0&&T.selected===0}:null,N=P?E.keyframes.map(({kf:V,track:B},H)=>$(R({},B.sheetObject.address),{trackId:B.id,left:V,right:T.keyframes[H].kf})):[],z=J7e(()=>{let V=IF.prism.memo("selectedConnections",()=>Oie(_,b,m),[_,b,m]).getValue();return[...N,...V]}),G=N.every(V=>xF(V));return{itemKey:IF.prism.memo("itemKey",()=>s.viewModel.type==="sheet"?ha.forSheetAggregateKeyframe(s.viewModel.sheet,E.position):s.viewModel.type==="sheetObject"?ha.forSheetObjectAggregateKeyframe(s.viewModel.sheetObject,E.position):ha.forCompoundPropAggregateKeyframe(s.viewModel.sheetObject,s.viewModel.pathToProp,E.position),[s.viewModel,E.position]),cur:E,connected:P,isAggregateEditingInCurvePopover:G,allConnections:z}}}var IF,NF=k(()=>{IF=mn(),Dm(),IC(),er(),Nv(),e_e()});function t_e(s,l){let u=(0,ah.useRef)(l);u.current=l;let m=(0,ah.useMemo)(()=>({debugName:"useDragKeyframe",lockCSSCursorTo:"ew-resize",onDragStart(_){let b=u.current,E,T=b.aggregateKeyframes[b.index].keyframes,{selection:P,viewModel:N}=b,z=N.type==="sheet"?N.sheet.address:N.sheetObject.address;if(P&&b.aggregateKeyframes[b.index].selected===0)return P.getDragHandlers($(R({},z),{domNode:s,positionAtStartOfDrag:b.aggregateKeyframes[b.index].position})).onDragStart(_);let G=b,V=(0,jC.val)(G.layoutP.sheet).getSequence(),B=(0,jC.val)(G.layoutP.scaledSpace.toUnitSpace);return{onDrag(H,j,X){let K=B(H);E&&(E.discard(),E=void 0),E=Se().tempTransaction(({stateEditors:te})=>{for(let se of T)te.coreByProject.historic.sheetsById.sequence.transformKeyframes($(R({},se.track.sheetObject.address),{trackId:se.track.id,keyframeIds:[se.kf.id,se.track.data.keyframes[se.track.data.keyframes.indexOf(se.kf)+1].id],translate:K,scale:1,origin:0,snappingFunction:V.closestGridPosition}))})},onDragEnd(H){H?E&&E.commit():E&&E.discard()}}}}),[]);return uo(s,m)}function n_e(s,l){return ml(l,{displayName:"Aggregate Tween",menuItems:()=>{let u=s.utils.allConnections.reduce((T,P)=>{var N;return T.concat((N=bF($(R({},P),{keyframeIds:[P.left.id,P.right.id]})))!=null?N:[])},[]),m=dC(u.map(T=>T.pathToProp)),_=u.map(({keyframe:T,pathToProp:P})=>({keyframe:T,pathToProp:P.slice(m.length)})),b=s.editorProps.viewModel,E=b.type==="sheet"?b.sheet.address:b.sheetObject.address;return[{label:"Copy",callback:()=>{if(s.editorProps.selection){let T=NC(E.projectId,E.sheetId,s.editorProps.selection);Se().transaction(P=>{P.stateEditors.studio.ahistoric.setClipboardKeyframes(T)})}else Se().transaction(T=>{T.stateEditors.studio.ahistoric.setClipboardKeyframes(_)})}},{label:"Delete",callback:()=>{s.editorProps.selection?s.editorProps.selection.delete():Se().transaction(({stateEditors:T})=>{for(let P of s.utils.allConnections)T.coreByProject.historic.sheetsById.sequence.deleteKeyframes($(R({},E),{objectKey:P.objectKey,keyframeIds:[P.left.id,P.right.id],trackId:P.trackId}))})}}]}})}var jC,ah,DF,_se,xse,bse,Sse,r_e=k(()=>{jC=mn(),ah=Q(qe()),Jie(),mp(),Fi(),Ae(),Yo(),IC(),NF(),Ft(),yp(),Nv(),gl(),Sp(),DF=5,xse=Te(gp)(_se||(_se=J([`
  --popover-outer-stroke: transparent;
  --popover-inner-stroke: rgba(26, 28, 30, 0.97);
`]))),bse=ah.default.forwardRef((s,l)=>{let{allConnections:u}=yse(s);return ah.default.createElement(xse,{showPopoverEdgeTriangle:!1,ref:l},ah.default.createElement(_F,{curveConnection:u[0],additionalConnections:u,onRequestClose:s.closePopover}))}),Sse=s=>{let[l,u]=Ai(null),{editorProps:m}=s,[_]=n_e(s,u),[b]=t_e(u,s.editorProps),{node:E,toggle:T,close:P}=pp(()=>{let G=(0,jC.val)(m.layoutP.rightDims);return{debugName:"Connector",constraints:{minX:G.screenX+DF,maxX:G.screenX+G.width-DF}}},()=>ah.default.createElement(bse,$(R({},m),{closePopover:P}))),{connected:N,isAggregateEditingInCurvePopover:z}=s.utils;return N||b?ah.default.createElement(ah.default.Fragment,null,ah.default.createElement(AF,{ref:l,connectorLengthInUnitSpace:N?N.length:0,isSelected:N?N.selected:!1,isPopoverOpen:z,openPopover:G=>{u&&T(G,u)}}),E,_):ah.default.createElement(ah.default.Fragment,null)}});function i_e(s){let l={isSelected:s.isSelected,flag:s.flag};return zm.default.createElement(HC,null,s.isAllHere?zm.default.createElement(Ase,R({},l)):zm.default.createElement(Pse,R({},l)))}var zm,OF,wse,Ese,HC,Tse,Mse,FF,LF,BF,UF,Cse,Ase,Pse,s_e=k(()=>{zm=Q(qe()),Ft(),yC(),Li(),OF=16,wse=OF+2,HC=Te.div(Ese||(Ese=J([`
  position: absolute;
  `,`
  z-index: 1;
`])),oh(OF)),Mse=Te.div(Tse||(Tse=J([`
  z-index: 2;
  cursor: ew-resize;

  position: absolute;
  `,`;
  `,`;

  &:hover
    + `,`,
    #pointer-root.draggingPositionInSequenceEditor
    &:hover
    + `,` {
    `,`
  }
`])),oh(12),Di,HC,HC,oh(wse)),FF="#F2C95C",LF="#40AAA4",BF="#45747C",UF=s=>s.isSelected===0?FF:s.isSelected===1?LF:BF,Cse=s=>s.isSelected===0?FF:s.isSelected===1?LF:BF,Ase=s=>zm.default.createElement("svg",{width:"100%",height:"100%",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},zm.default.createElement("rect",{x:"4.46443",y:"10.0078",width:"5",height:"5",transform:"rotate(-45 4.46443 10.0078)",fill:"#212327",stroke:Cse(s)}),zm.default.createElement("rect",{x:"3.75732",y:"6.01953",width:"6",height:"6",transform:"rotate(-45 3.75732 6.01953)",fill:UF(s),stroke:s.flag===2?"white":void 0,strokeWidth:s.flag===2?"2px":void 0})),Pse=s=>zm.default.createElement("svg",{width:"100%",height:"100%",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},zm.default.createElement("rect",{x:"4.46443",y:"8",width:"5",height:"5",transform:"rotate(-45 4.46443 8)",fill:"#23262B",stroke:s.flag===2?"white":UF(s),strokeWidth:s.flag===2?"2px":void 0}))});function o_e(s,l){let u=s.children.map(m=>m.type==="propWithChildren"?zF(m,l):Rse(m,l)).filter(VF);return u.length===0?null:{type:"sheetObject",sheetObject:s.sheetObject,children:u}}function zF(s,l){let u=s.children.map(m=>m.type==="propWithChildren"?zF(m,l):Rse(m,l)).filter(VF);return u.length===0?null:{type:"propWithChildren",pathToProp:s.pathToProp,propConfig:s.propConf,children:u}}function Rse(s,l){let u=l.find(m=>m.track.id===s.trackId);return u?{type:"primitiveProp",keyframe:u.kf,pathToProp:s.pathToProp,propConfig:s.propConf,sheetObject:s.sheetObject,trackId:s.trackId}:null}function a_e(s){var l,u,m,_;let{cur:b}=s.utils,E=LC(s.editorProps.viewModel.type==="sheet"?null:s.editorProps.viewModel.type==="sheetObject"?(u=(l=o_e(s.editorProps.viewModel,b.keyframes))==null?void 0:l.children)!=null?u:null:(_=(m=zF(s.editorProps.viewModel,b.keyframes))==null?void 0:m.children)!=null?_:null),T=U5(s.utils.itemKey);T.useRelations(()=>b.keyframes.map(G=>({affects:G.itemKey,flag:2})),[b.keyframes.map(G=>G.track.id).join("-")]);let[P,N]=Ai(null),[z]=l_e(s,N);return tS.default.createElement(tS.default.Fragment,null,tS.default.createElement(Mse,$(R(R({ref:P},T.attrs),yl.includePositionSnapAttrs(b.position)),{onClick:G=>s.editorProps.viewModel.type!=="sheet"?E.open(G,P.current):null})),tS.default.createElement(i_e,{flag:T.flag,isAllHere:b.allHere,isSelected:b.selected}),z,E.node)}function l_e(s,l){return ml(l,{displayName:"Aggregate Keyframe",menuItems:()=>{let u=s.editorProps.viewModel,m=s.editorProps.selection;return[{label:m?"Copy (selection)":"Copy",callback:()=>{if(m){let{projectId:_,sheetId:b}=u.type==="sheet"?u.sheet.address:u.sheetObject.address,E=NC(_,b,m);Se().transaction(T=>{T.stateEditors.studio.ahistoric.setClipboardKeyframes(E)})}else{let _=s.utils.cur.keyframes.flatMap(P=>{var N;return(N=bF($(R({},P.track.sheetObject.address),{trackId:P.track.id,keyframeIds:[P.kf.id]})))!=null?N:[]}),b=u.type==="sheet"?[]:u.type==="sheetObject"?[u.sheetObject.address.objectKey]:u.type==="propWithChildren"?[u.sheetObject.address.objectKey,...u.pathToProp]:[],E=dC([b,..._.map(P=>P.pathToProp)]),T=_.map(({keyframe:P,pathToProp:N})=>({keyframe:P,pathToProp:N.slice(E.length)}));Se().transaction(P=>{P.stateEditors.studio.ahistoric.setClipboardKeyframes(T)})}}},{label:m?"Delete (selection)":"Delete",callback:()=>{m?m.delete():Se().transaction(({stateEditors:_})=>{for(let b of s.utils.cur.keyframes)_.coreByProject.historic.sheetsById.sequence.deleteKeyframes($(R({},b.track.sheetObject.address),{keyframeIds:[b.kf.id],trackId:b.track.id}))})}}]}})}var tS,VF,c_e=k(()=>{tS=Q(qe()),Fi(),z5(),gl(),s_e(),Ae(),Nv(),Sp(),Rd(),UC(),VF=s=>s!==null}),kse,nS,Ise,Nse,Dse,Ose,u_e=k(()=>{kse=mn(),nS=Q(qe()),Ft(),r_e(),NF(),c_e(),Nse=Te.div(Ise||(Ise=J([`
  position: absolute;
`]))),Dse=nS.default.memo(s=>{let l=yse(s);return nS.default.createElement(Nse,{style:{top:"".concat(s.viewModel.nodeHeight/2,"px"),left:"calc(".concat((0,kse.val)(s.layoutP.scaledSpace.leftPadding),"px + calc(var(--unitSpaceToScaledSpaceMultiplier) * ").concat(l.cur.position,"px))")}},nS.default.createElement(a_e,{editorProps:s,utils:l}),nS.default.createElement(Sse,{editorProps:s,utils:l}))}),Ose=Dse});function h_e(s){let{layoutP:l,aggregatedKeyframes:u,viewModel:m}=s,_=P9("AggregatedKeyframeTrack"),[b,E]=Ai(null),{selectedPositions:T,selection:P}=d_e(l,u),[N,z,G]=m_e(E,s,()=>_._debug("see aggregatedKeyframes",s.aggregatedKeyframes)),V=(0,lh.useMemo)(()=>[...u.byPosition.entries()].sort((se,pe)=>se[0]-pe[0]).map(([se,pe])=>({position:se,keyframes:pe,selected:T.get(se),allHere:pe.length===u.tracks.length})),[u,T]),B=Xr(lF),H=B.mode==="snapToAll",j=B.mode==="snapToSome"?B.positions:uO,X=(0,lh.useMemo)(()=>m.type==="sheet"?a7e(m,j):tF(m,j),[j]).map(se=>lh.default.createElement($b,{key:"snap-target-"+se,layoutP:l,leaf:m,position:se})),K=(0,lh.useMemo)(()=>V.map(({position:se,keyframes:pe},fe)=>({position:se,editorProps:{index:fe,layoutP:l,viewModel:m,aggregateKeyframes:V,selection:T.has(se)?P:void 0}})),[V,m,T]);__e(E,se=>{var pe;return(pe=K.find(fe=>fe.position===se))==null?void 0:pe.editorProps},{onClickFromDrag(se){}});let te=K.map((se,pe)=>lh.default.createElement(lh.Fragment,{key:"agg-"+V[pe].keyframes[0].kf.id},H&&lh.default.createElement($b,{layoutP:l,leaf:m,position:se.position}),lh.default.createElement(Ose,R({},se.editorProps))));return lh.default.createElement(Use,{ref:b,style:{background:G?"#444850 ":"unset"}},te,X,N)}function d_e(s,l){return jr(()=>(0,_l.val)(f_e(s,l)),[s,l])}function f_e(s,l){return(0,_l.prism)(()=>{let u=(0,_l.val)(s.selectionAtom),m=(0,_l.val)(u.pointer.current);if(!m)return zse;let _=new Map;for(let[b,E]of l.byPosition){let T=p_e(E,m);T!==void 0&&T!==$C&&_.set(b,T)}return{selectedPositions:_,selection:(0,_l.val)(u.pointer.current)}})}function p_e(s,l){var u,m,_;let b;for(let{track:E,kf:T}of s){let P=((_=(m=(u=l.byObjectKey[E.sheetObject.address.objectKey])==null?void 0:u.byTrackId[E.id])==null?void 0:m.byKeyframeId)==null?void 0:_[T.id])===!0;b===void 0?P?b=HF:b=$C:P?b===$C&&(b=WF):b===HF&&(b=WF)}return b}function m_e(s,l,u){return ml(s,{onOpen:u,displayName:"Aggregate Keyframe Track",menuItems:()=>{var m;let _=(m=(0,_l.pointerToPrism)(Se().atomP.ahistoric.clipboard.keyframesWithRelativePaths).getValue())!=null?m:[];return[g_e(l,_)]}})}function g_e(s,l){return{label:"Paste Keyframes",enabled:l.length>0,callback:()=>{let u=(0,_l.val)(s.layoutP.sheet).getSequence();s.viewModel.type==="sheet"?y_e(s.viewModel,l,u):v_e(s.viewModel,l,u)}}}function y_e(s,l,u){var m;let{projectId:_,sheetId:b,sheetInstanceId:E}=s.sheet.address;if(l.every(({pathToProp:T})=>T.length===0))for(let T of s.children.map(P=>P.sheetObject)){let P=(0,_l.pointerToPrism)(Se().atomP.historic.coreByProject[_].sheetsById[b].sequence.tracksByObject[T.address.objectKey]).getValue(),N=Object.keys((m=P==null?void 0:P.trackData)!=null?m:{});GF(T.address,N,l,u)}else{let T=(0,_l.pointerToPrism)(Se().atomP.historic.coreByProject[_].sheetsById[b].sequence.tracksByObject).getValue(),P=l.map(({keyframe:N,pathToProp:z})=>{var G,V;let B=z[0],H=z.slice(1),j=bp([...H]),X=((V=(G=T==null?void 0:T[B])==null?void 0:G.trackIdByPropPath)!=null?V:{})[j];return X?{keyframe:N,trackId:X,address:{objectKey:B,projectId:_,sheetId:b,sheetInstanceId:E}}:null}).filter(N=>N!==null);Fse(P,u)}}function v_e(s,l,u){var m;let{projectId:_,sheetId:b,objectKey:E}=s.sheetObject.address,T=(0,_l.pointerToPrism)(Se().atomP.historic.coreByProject[_].sheetsById[b].sequence.tracksByObject[E]).getValue();if(l.every(({pathToProp:P})=>P.length===0)){let P=Object.keys((m=T==null?void 0:T.trackData)!=null?m:{});if(s.type==="sheetObject")GF(s.sheetObject.address,P,l,u);else{let N=(T==null?void 0:T.trackIdByPropPath)||{},z=Object.entries(N).filter(([G,V])=>V!==void 0&&Zve(fC(G),s.pathToProp)).map(([G,V])=>V);GF(s.sheetObject.address,z,l,u)}}else{let P=(T==null?void 0:T.trackIdByPropPath)||{},N=s.type==="propWithChildren"?s.pathToProp:[],z=l.map(({keyframe:G,pathToProp:V})=>{let B=bp([...N,...V]),H=P[B];return H?{keyframe:G,trackId:H,address:s.sheetObject.address}:null}).filter(G=>G!==null);Fse(z,u)}}function GF(s,l,u,m){var _;m.position=m.closestGridPosition(m.position);let b=(_=Lse(u.map(({keyframe:E})=>E)))==null?void 0:_.position;Se().transaction(({stateEditors:E})=>{for(let T of l)for(let{keyframe:P}of u)E.coreByProject.historic.sheetsById.sequence.setKeyframeAtPosition($(R({},s),{trackId:T,position:m.position+P.position-b,handles:P.handles,value:P.value,snappingFunction:m.closestGridPosition,type:P.type}))})}function Fse(s,l){var u;l.position=l.closestGridPosition(l.position);let m=(u=Lse(s.map(({keyframe:_})=>_)))==null?void 0:u.position;Se().transaction(({stateEditors:_})=>{for(let{keyframe:b,trackId:E,address:T}of s)_.coreByProject.historic.sheetsById.sequence.setKeyframeAtPosition($(R({},T),{trackId:E,position:l.position+b.position-m,handles:b.handles,value:b.value,snappingFunction:l.closestGridPosition,type:b.type}))})}function Lse(s){let l=null;for(let u of s)(l===null||u.position<l.position)&&(l=u);return l}function __e(s,l,u){let m=P9("useDragForAggregateKeyframeDot"),_=_re(),b=(0,lh.useMemo)(()=>({debugName:"AggregateKeyframeDot/useDragKeyframe",onDragStart(T){m._debug("onDragStart",{target:T.target});let P=Number(T.target.dataset.pos),N=l(P);if(!N)return m._debug("no props found for ",{positionToFind:P}),!1;_(!0,P);let z=(0,_l.prism)(vse(N)).getValue().cur.keyframes,G=N.viewModel.type==="sheet"?N.viewModel.sheet.address:N.viewModel.sheetObject.address,V=(0,_l.val)(Se().atomP.historic.coreByProject[G.projectId].sheetsById[G.sheetId].sequence.tracksByObject),B=Cre(V,function(K,{trackId:te,objectKey:se}){var pe,fe;return z.every(ve=>K.id!==ve.kf.id)&&!(N.selection&&(fe=(pe=N.selection.byObjectKey[se])==null?void 0:pe.byTrackId[te])!=null&&fe.byKeyframeId[K.id])});if(Mre(B),N.selection&&N.aggregateKeyframes[N.index].selected===0){let{selection:K,viewModel:te}=N,se=K.getDragHandlers($(R({},G),{domNode:s,positionAtStartOfDrag:z[0].kf.position})).onDragStart(T);return se&&$(R({},se),{onClick:u.onClickFromDrag,onDragEnd:(...pe)=>{var fe;(fe=se.onDragEnd)==null||fe.call(se,...pe),$5()}})}let H=N,j=(0,_l.val)(H.layoutP.scaledSpace.toUnitSpace),X;return{onDrag(K,te,se){var pe;let fe=Math.max((pe=yl.checkIfMouseEventSnapToPos(se,{}))!=null?pe:z[0].kf.position+j(K),0);_(!0,fe),X==null||X.discard(),X=void 0,X=Se().tempTransaction(({stateEditors:ve})=>{for(let Ne of z){let ze=Ne.kf;ve.coreByProject.historic.sheetsById.sequence.replaceKeyframes($(R({},Ne.track.sheetObject.address),{trackId:Ne.track.id,keyframes:[$(R({},ze),{position:fe})],snappingFunction:(0,_l.val)(H.layoutP.sheet).getSequence().closestGridPosition}))}})},onDragEnd(K){_(!1,-1),K?X==null||X.commit():(X==null||X.discard(),u.onClickFromDrag(T)),$5()},onClick(K){u.onClickFromDrag(K)}}}}),[l,u.onClickFromDrag]),[E]=uo(s,b);return rh(E,"draggingPositionInSequenceEditor","ew-resize"),[E]}var _l,lh,Bse,Use,zse,Vse,WC,jF,HF,WF,$C,$F=k(()=>{er(),_l=mn(),lh=Q(qe()),Ft(),gl(),Fi(),u_e(),Av(),R9(),NF(),Rd(),Yo(),Za(),ru(),Ae(),Sp(),q5(),PQ(),q5(),Av(),Use=Te.div(Bse||(Bse=J([`
  position: relative;
  height: 100%;
  width: 100%;
`]))),zse=Object.freeze({selectedPositions:new Map,selection:void 0}),Vse=lh.default.memo(h_e),WC=Vse,jF=(s=>(s[s.AllSelected=0]="AllSelected",s[s.AtLeastOneUnselected=1]="AtLeastOneUnselected",s[s.NoneSelected=2]="NoneSelected",s))(jF||{}),{AllSelected:HF,AtLeastOneUnselected:WF,NoneSelected:$C}=jF}),Ov,qF,Gse,x_e=k(()=>{er(),Ov=Q(qe()),Q7e(),bC(),$F(),Av(),R9(),qF=(s,l)=>s.type==="propWithChildren"?Ov.default.createElement(Gse,{layoutP:l,viewModel:s,key:"prop"+s.pathToProp[s.pathToProp.length-1]}):Ov.default.createElement(gse,{layoutP:l,leaf:s,key:"prop"+s.pathToProp[s.pathToProp.length-1]}),Gse=({viewModel:s,layoutP:l})=>{let u=P9("RightPropWithChildrenRow",s.pathToProp.join());return jr(()=>{let m=mC(s);return Ov.default.createElement(FX,{logger:u},Ov.default.createElement(Rv,{leaf:s,node:Ov.default.createElement(WC,{layoutP:l,aggregatedKeyframes:m,viewModel:s}),isCollapsed:s.isCollapsed},s.children.map(_=>qF(_,l))))},[s,l])}}),XF,jse,Hse,b_e=k(()=>{er(),XF=Q(qe()),x_e(),bC(),Av(),$F(),jse=({leaf:s,layoutP:l})=>jr(()=>{let u=mC(s);return XF.default.createElement(Rv,{leaf:s,node:XF.default.createElement(WC,{layoutP:l,aggregatedKeyframes:u,viewModel:s}),isCollapsed:s.isCollapsed},s.children.map(m=>qF(m,l)))},[s,l]),Hse=jse}),qC,Wse,$se,S_e=k(()=>{er(),qC=Q(qe()),b_e(),bC(),Av(),$F(),Wse=({leaf:s,layoutP:l})=>jr(()=>{let u=mC(s);return qC.default.createElement(Rv,{leaf:s,node:qC.default.createElement(WC,{layoutP:l,aggregatedKeyframes:u,viewModel:s}),isCollapsed:s.isCollapsed},s.children.map(m=>qC.default.createElement(Hse,{layoutP:l,key:"sheetObject-"+m.sheetObject.address.objectKey,leaf:m})))},[s,l]),$se=Wse}),rS,J5,XC,qse,Xse,Yse,Kse,Zse=k(()=>{er(),rS=mn(),J5=Q(qe()),Ft(),u7e(),Bre(),S_e(),XC=1e6,Xse=Te.ul(qse||(qse=J([`
  margin: 0;
  padding: 0;
  list-style: none;
  position: absolute;
  left: 0;
  width: `,`px;
`])),XC),Yse=({layoutP:s})=>jr(()=>{let l=(0,rS.val)(s.tree),u=(0,rS.val)(s.tree.top)+Math.max((0,rS.val)(s.tree.heightIncludingChildren),(0,rS.val)(s.dopeSheetDims.height));return J5.default.createElement(J5.default.Fragment,null,J5.default.createElement(uF,{layoutP:s,height:u},J5.default.createElement(ore,{layoutP:s,height:u},J5.default.createElement(Xse,{style:{top:l.top+"px"}},J5.default.createElement($se,{leaf:l,layoutP:s})))))},[s]),Kse=Yse});function YF(s,l,u,m){let _="calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(s,"px)"),b="calc((var(--graphEditorVerticalSpace) - var(--graphEditorVerticalSpace) * ".concat(l,") * 1px)");u===0&&(u=1e-4);let E="calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(u,")");m===0&&(m=.001);let T="calc(var(--graphEditorVerticalSpace) * ".concat(m*-1,")");return"translate(".concat(_,", ").concat(b,") scale(").concat(E,", ").concat(T,")")}function w_e(s,l){let{index:u,trackData:m}=l,_=m.keyframes[u],b=m.keyframes[u+1];return ml(s,{menuItems:()=>[{label:"Delete",callback:()=>{Se().transaction(({stateEditors:E})=>{let{deleteKeyframes:T}=E.coreByProject.historic.sheetsById.sequence;T($(R({},l.sheetObject.address),{trackId:l.trackId,keyframeIds:[_.id,b.id]}))})}}]})}var YC,Qse,Jse,eoe,toe,noe,KF=k(()=>{I9(),Ae(),gl(),Fi(),YC=Q(qe()),Ft(),Jse=Te.path(Qse||(Qse=J([`
  stroke-width: 2;
  stroke: var(--main-color);
  fill: none;
  vector-effect: non-scaling-stroke;
`]))),eoe="M 0 0 L 1 0 L 1 1",toe=s=>{let{index:l,trackData:u}=s,m=u.keyframes[l],_=u.keyframes[l+1],b=_.position-m.position,[E,T]=Ai(null),[P]=w_e(T,s),N=s.isScalar?RM(m.value,s.propConfig):0,z=s.isScalar?RM(_.value,s.propConfig):1,G=s.extremumSpace.fromValueSpace(N),V=s.extremumSpace.fromValueSpace(z)-G,B=YF(m.position,G,b,V),H=m.handles[2],j=m.handles[3],X=_.handles[0],K=_.handles[1],te="M 0 0 C ".concat(H," ").concat(j," ").concat(X," ").concat(K," 1 1");return YC.default.createElement(YC.default.Fragment,null,YC.default.createElement(Jse,{ref:E,d:!m.type||m.type==="bezier"?te:eoe,style:{transform:B}}),P)},noe=toe});function E_e(s,l){let u=(0,e8.useRef)(l);u.current=l;let m=(0,e8.useMemo)(()=>({debugName:"CurveHandler/useOurDrags",lockCSSCursorTo:"move",onDragStart(){let _,b=u.current,E=(0,iS.val)(b.layoutP.scaledSpace.toUnitSpace),T=(0,iS.val)(b.layoutP.graphEditorVerticalSpace.toExtremumSpace),P=b.extremumSpace.lock();return{onDrag(N,z){_&&(_.discard(),_=void 0);let{index:G,trackData:V}=b,B=V.keyframes[G],H=V.keyframes[G+1],j=E(N)/(H.position-B.position),X=-z,K=T(X),te=b.extremumSpace.deltaToValueSpace(K),se=l.isScalar?B.value:0,pe=l.isScalar?H.value:1,fe=te/(pe-se);if(b.which==="left"){let ve=ii(B.handles[2]+j,0,1),Ne=B.handles[3]+fe;_=Se().tempTransaction(({stateEditors:ze})=>{ze.coreByProject.historic.sheetsById.sequence.replaceKeyframes($(R({},b.sheetObject.address),{snappingFunction:(0,iS.val)(b.layoutP.sheet).getSequence().closestGridPosition,trackId:b.trackId,keyframes:[$(R({},B),{handles:[B.handles[0],B.handles[1],ve,Ne]})]}))})}else{let ve=ii(H.handles[0]+j,0,1),Ne=H.handles[1]+fe;_=Se().tempTransaction(({stateEditors:ze})=>{ze.coreByProject.historic.sheetsById.sequence.replaceKeyframes($(R({},b.sheetObject.address),{trackId:b.trackId,snappingFunction:(0,iS.val)(b.layoutP.sheet).getSequence().closestGridPosition,keyframes:[$(R({},H),{handles:[ve,Ne,H.handles[2],H.handles[3]]})]}))})}},onDragEnd(N){P(),N?_&&_.commit():_&&_.discard()}}}}),[]);uo(s,m)}function T_e(s,l){return ml(s,{menuItems:()=>[{label:"Delete",callback:()=>{Se().transaction(({stateEditors:u})=>{u.coreByProject.historic.sheetsById.sequence.deleteKeyframes($(R({},l.sheetObject.address),{keyframeIds:[l.keyframe.id],trackId:l.trackId}))})}}]})}var iS,e8,roe,ZF,ioe,soe,ooe,aoe,loe,QF,M_e=k(()=>{Ae(),gl(),Yo(),Fi(),iS=mn(),Fo(),e8=Q(qe()),Ft(),KF(),Li(),ZF=Te.circle(roe||(roe=J([`
  stroke-width: 1px;
  vector-effect: non-scaling-stroke;
  fill: var(--main-color);
  r: 2px;
  pointer-events: none;
`]))),soe=Te.circle(ioe||(ioe=J([`
  stroke-width: 6px;
  vector-effect: non-scaling-stroke;
  r: 6px;
  fill: transparent;
  cursor: move;
  `,`;
  &:hover {
  }
  &:hover + `,` {
    r: 6px;
  }
`])),Di,ZF),aoe=Te.path(ooe||(ooe=J([`
  stroke-width: 1;
  stroke: var(--main-color);
  /* stroke: gray; */
  fill: none;
  vector-effect: non-scaling-stroke;
`]))),loe=s=>{let[l,u]=Ai(null),{index:m,trackData:_}=s,b=_.keyframes[m],E=_.keyframes[m+1],[T]=T_e(u,s);E_e(u,s);let P=s.which==="left"?b.handles[2]:E.handles[0],N=b.position+(E.position-b.position)*P,z=s.which==="left"?b.handles[3]:E.handles[1],G=s.isScalar?b.value:0,V=s.isScalar?E.value:1,B=G+(V-G)*z,H=s.extremumSpace.fromValueSpace(B),j=H-s.extremumSpace.fromValueSpace(s.which==="left"?G:V),X=YF(s.which==="left"?b.position:E.position,s.extremumSpace.fromValueSpace(s.which==="left"?G:V),N-(s.which==="left"?b.position:E.position),j);return e8.default.createElement("g",null,e8.default.createElement(soe,{ref:l,style:{cx:"calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(N," * 1px)"),cy:"calc((var(--graphEditorVerticalSpace) - var(--graphEditorVerticalSpace) * ".concat(H,") * 1px)")}}),e8.default.createElement(ZF,{style:{cx:"calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(N," * 1px)"),cy:"calc((var(--graphEditorVerticalSpace) - var(--graphEditorVerticalSpace) * ".concat(H,") * 1px)")}}),e8.default.createElement(aoe,{d:"M 0 0 L 1 1",style:{transform:X}}),T)},QF=loe});function C_e(s){let[l,u]=(0,H9.useState)(!1);Bm(l,s.props.keyframe.position);let m=(0,H9.useRef)(s.props);m.current=s.props;let _=(0,H9.useMemo)(()=>({debugName:"GraphEditorDotScalar/useDragKeyframe",lockCSSCursorTo:"move",onDragStart(b){u(!0);let E=!!b.altKey,T=m.current,P=(0,KC.val)(T.layoutP.scaledSpace.toUnitSpace),N=(0,KC.val)(T.layoutP.graphEditorVerticalSpace.toExtremumSpace),z=T.extremumSpace.lock(),G;return{onDrag(V,B){let H=T.trackData.keyframes[T.index],j=P(V),X=-B,K=N(X),te=T.extremumSpace.deltaToValueSpace(K),se=[],pe=$(R({},H),{position:H.position+j,value:H.value+te,handles:[...H.handles]});if(se.push(pe),E){let fe=T.trackData.keyframes[T.index-1];if(fe&&Math.abs(H.value-fe.value)>0){let Ne=$(R({},fe),{handles:[...fe.handles]});se.push(Ne),Ne.handles[3]=P_e(fe.handles[3],fe.value,fe.value,H.value,pe.value)}let ve=T.trackData.keyframes[T.index+1];if(ve&&Math.abs(H.value-ve.value)>0){let Ne=$(R({},ve),{handles:[...ve.handles]});se.push(Ne),Ne.handles[1]=R_e(Ne.handles[1],Ne.value,Ne.value,H.value,pe.value)}}G==null||G.discard(),G=Se().tempTransaction(({stateEditors:fe})=>{fe.coreByProject.historic.sheetsById.sequence.replaceKeyframes($(R({},T.sheetObject.address),{trackId:T.trackId,keyframes:se,snappingFunction:(0,KC.val)(T.layoutP.sheet).getSequence().closestGridPosition}))})},onDragEnd(V){u(!1),z(),V?G==null||G.commit():(G==null||G.discard(),s.onDetectedClick(b))}}}}),[]);return uo(s.node,_),rh(l,"draggingPositionInSequenceEditor","move"),l}function A_e(s,l){return ml(s,{menuItems:()=>[{label:"Delete",callback:()=>{Se().transaction(({stateEditors:u})=>{u.coreByProject.historic.sheetsById.sequence.deleteKeyframes($(R({},l.sheetObject.address),{keyframeIds:[l.keyframe.id],trackId:l.trackId}))})}}]})}function P_e(s,l,u,m,_){return(m-l)*s/(_-u)}function R_e(s,l,u,m,_){return((l-m)*s+m-l+u-_)/(u-_)}var KC,H9,coe,JF,uoe,hoe,doe,foe,k_e=k(()=>{Ae(),gl(),Yo(),Fi(),KC=mn(),H9=Q(qe()),Ft(),Za(),Za(),Li(),ru(),Rd(),UC(),z5(),JF=Te.circle(coe||(coe=J([`
  fill: var(--main-color);
  stroke-width: 1px;
  vector-effect: non-scaling-stroke;

  r: 2px;
`]))),hoe=Te.circle(uoe||(uoe=J([`
  stroke-width: 6px;
  vector-effect: non-scaling-stroke;
  r: 6px;
  fill: transparent;
  `,`;

  &:hover + `,` {
    r: 6px;
  }

  #pointer-root.normal & {
    cursor: move;
  }

  #pointer-root.draggingPositionInSequenceEditor & {
    pointer-events: auto;
    cursor: var(`,`);
  }

  &.beingDragged {
    pointer-events: none !important;
  }
`])),Di,JF,Pm),doe=s=>{let[l,u]=Ai(null),{index:m,trackData:_}=s,b=_.keyframes[m],[E]=A_e(u,s),T=U5(s.itemKey),P=b.value,N=s.extremumSpace.fromValueSpace(P),z=LC([{type:"primitiveProp",keyframe:s.keyframe,pathToProp:s.pathToProp,propConfig:s.propConfig,sheetObject:s.sheetObject,trackId:s.trackId}]),G=C_e({node:u,props:s,onDetectedClick:V=>z.toggle(V,V.target instanceof Element?V.target:u)});return H9.default.createElement(H9.default.Fragment,null,H9.default.createElement(hoe,$(R(R(R({ref:l,style:{cx:"calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(b.position," * 1px)"),cy:"calc((var(--graphEditorVerticalSpace) - var(--graphEditorVerticalSpace) * ".concat(N,") * 1px)")}},wp(b.position)),yl.includePositionSnapAttrs(b.position)),T.attrs),{className:G?"beingDragged":""})),H9.default.createElement(JF,{style:{cx:"calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(b.position," * 1px)"),cy:"calc((var(--graphEditorVerticalSpace) - var(--graphEditorVerticalSpace) * ".concat(N,") * 1px)"),fill:T.flag===2?"white":void 0}}),z.node,E)},foe=doe});function I_e(s){let[l,u]=(0,W9.useState)(!1);Bm(l,s.props.keyframe.position);let m=(0,W9.useRef)(s.props);m.current=s.props;let _=(0,W9.useMemo)(()=>({debugName:"GraphEditorDotNonScalar/useDragKeyframe",lockCSSCursorTo:"ew-resize",onDragStart(b){u(!0);let E=m.current,T=(0,eL.val)(E.layoutP.scaledSpace.toUnitSpace),P=E.extremumSpace.lock(),N;return{onDrag(z,G){let V=E.trackData.keyframes[E.index],B=T(z),H=[],j=$(R({},V),{position:V.position+B,value:V.value,handles:[...V.handles]});H.push(j),N==null||N.discard(),N=Se().tempTransaction(({stateEditors:X})=>{X.coreByProject.historic.sheetsById.sequence.replaceKeyframes($(R({},E.sheetObject.address),{trackId:E.trackId,keyframes:H,snappingFunction:(0,eL.val)(E.layoutP.sheet).getSequence().closestGridPosition}))})},onDragEnd(z){u(!1),P(),z?N==null||N.commit():(N==null||N.discard(),s.onDetectedClick(b))}}}}),[]);return uo(s.node,_),rh(l,"draggingPositionInSequenceEditor","ew-resize"),l}function N_e(s,l){return ml(s,{menuItems:()=>[{label:"Delete",callback:()=>{Se().transaction(({stateEditors:u})=>{u.coreByProject.historic.sheetsById.sequence.deleteKeyframes($(R({},l.sheetObject.address),{keyframeIds:[l.keyframe.id],trackId:l.trackId}))})}}]})}var eL,W9,poe,tL,moe,goe,yoe,nL,D_e=k(()=>{Ae(),gl(),Yo(),Fi(),eL=mn(),W9=Q(qe()),Ft(),Za(),Za(),Li(),ru(),Rd(),UC(),z5(),tL=Te.circle(poe||(poe=J([`
  fill: var(--main-color);
  stroke-width: 1px;
  vector-effect: non-scaling-stroke;

  r: 2px;
`]))),goe=Te.circle(moe||(moe=J([`
  stroke-width: 6px;
  vector-effect: non-scaling-stroke;
  r: 6px;
  fill: transparent;
  `,`;

  &:hover + `,` {
    r: 6px;
  }

  #pointer-root.normal & {
    cursor: ew-resize;
  }

  #pointer-root.draggingPositionInSequenceEditor & {
    pointer-events: auto;
    cursor: var(`,`);
  }

  &.beingDragged {
    pointer-events: none !important;
  }
`])),Di,tL,Pm),yoe=s=>{let[l,u]=Ai(null),{index:m,trackData:_,itemKey:b}=s,E=_.keyframes[m],[T]=N_e(u,s),P=U5(b),N=s.which==="left"?0:1,z=LC([{type:"primitiveProp",keyframe:s.keyframe,pathToProp:s.pathToProp,propConfig:s.propConfig,sheetObject:s.sheetObject,trackId:s.trackId}]),G=I_e({node:u,props:s,onDetectedClick:B=>z.toggle(B,B.target instanceof Element?B.target:u)}),V=s.extremumSpace.fromValueSpace(N);return W9.default.createElement(W9.default.Fragment,null,W9.default.createElement(goe,$(R(R(R({ref:l,style:{cx:"calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(E.position," * 1px)"),cy:"calc((var(--graphEditorVerticalSpace) - var(--graphEditorVerticalSpace) * ".concat(V,") * 1px)")}},P.attrs),wp(E.position)),yl.includePositionSnapAttrs(E.position)),{className:G?"beingDragged":""})),W9.default.createElement(tL,{style:{cx:"calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(E.position," * 1px)"),cy:"calc((var(--graphEditorVerticalSpace) - var(--graphEditorVerticalSpace) * ".concat(V,") * 1px)"),fill:P.flag===2?"white":void 0}}),z.node,T)},nL=yoe}),ZC,voe,_oe,xoe,boe,O_e=k(()=>{ZC=Q(qe()),Ft(),KF(),_oe=Te.path(voe||(voe=J([`
  stroke-width: 2;
  stroke: var(--main-color);
  stroke-dasharray: 3 2;
  fill: none;
  vector-effect: non-scaling-stroke;
  opacity: 0.3;
`]))),xoe=s=>{let{index:l,trackData:u}=s,m="M 0 0 L 1 1",_=YF(u.keyframes[l].position,s.extremumSpace.fromValueSpace(0),0,s.extremumSpace.fromValueSpace(1)-s.extremumSpace.fromValueSpace(0));return ZC.default.createElement(ZC.default.Fragment,null,ZC.default.createElement(_oe,{d:m,style:{transform:_}}))},boe=xoe}),Ja,Soe,woe,Eoe,Toe,Moe,F_e=k(()=>{Ja=Q(qe()),Ft(),KF(),M_e(),k_e(),D_e(),O_e(),woe=Te.g(Soe||(Soe=J([`
  /* position: absolute; */
`]))),Eoe=Ja.default.createElement(Ja.default.Fragment,null),Toe=s=>{let{index:l,trackData:u,isScalar:m}=s,_=u.keyframes[l],b=u.keyframes[l+1],E=_.connectedRight&&!!b&&b.value!==_.value;return Ja.default.createElement(woe,null,E?Ja.default.createElement(Ja.default.Fragment,null,Ja.default.createElement(noe,R({},s)),!_.type||_.type==="bezier"&&Ja.default.createElement(Ja.default.Fragment,null,Ja.default.createElement(QF,$(R({},s),{which:"left"})),Ja.default.createElement(QF,$(R({},s),{which:"right"})))):Eoe,m?Ja.default.createElement(foe,R({},s)):Ja.default.createElement(Ja.default.Fragment,null,Ja.default.createElement(nL,$(R({},s),{which:"left"})),Ja.default.createElement(nL,$(R({},s),{which:"right"})),Ja.default.createElement(boe,R({},s))))},Moe=Toe});function L_e(s,l){let u=1/0,m=-1/0;function _(b){u=Math.min(b,u),m=Math.max(b,m)}return s.forEach((b,E)=>{let T=RM(b.value,l);if(_(T),!b.connectedRight)return;let P=s[E+1];if(!P)return;let N=(typeof P.value=="number"?P.value:1)-T;_(T+b.handles[3]*N),_(T+P.handles[1]*N)}),[u,m]}function B_e(s){let l=0,u=1;function m(_){l=Math.min(_,l),u=Math.max(_,u)}return s.forEach((_,b)=>{if(!_.connectedRight)return;let E=s[b+1];E&&(m(_.handles[3]),m(E.handles[1]))}),[l,u]}var Tp,Coe,Aoe,U_e=k(()=>{Dm(),Tp=Q(qe()),JC(),F_e(),I9(),er(),Coe=Tp.default.memo(({layoutP:s,trackData:l,sheetObject:u,trackId:m,color:_,pathToProp:b})=>{let E=PM(Xr(u.template.configPointer),b);if(_p(E))return console.error("Composite prop types cannot be keyframed"),Tp.default.createElement(Tp.default.Fragment,null);let[T,P]=(0,Tp.useState)(!1),N=(0,Tp.useMemo)(()=>{let B=new Set;return function(){let H=B.size===0;B.add(j),H&&P(!0);function j(){let X=B.size>0;B.delete(j),X&&B.size===0&&P(!1)}return j}},[]),z=(0,Tp.useMemo)(()=>{let B=E.type==="number"?L_e(l.keyframes,E):B_e(l.keyframes),H=K=>(K-B[0])/(B[1]-B[0]),j=K=>B[0]+X(K),X=K=>K*(B[1]-B[0]);return{fromValueSpace:H,toValueSpace:j,deltaToValueSpace:X,lock:N}},[l.keyframes]),G=(0,Tp.useRef)(void 0);T||(G.current=z);let V=l.keyframes.map((B,H)=>Tp.default.createElement(Moe,{pathToProp:b,propConfig:E,itemKey:ha.forTrackKeyframe(u,m,B.id),keyframe:B,index:H,trackData:l,layoutP:s,sheetObject:u,trackId:m,isScalar:E.type==="number",key:B.id,extremumSpace:G.current,color:_}));return Tp.default.createElement("g",{style:{"--main-color":sS[_].iconColor}},V)}),Aoe=Coe}),Poe,QC,Roe,koe,z_e=k(()=>{Ae(),er(),Poe=mn(),QC=Q(qe()),U_e(),Roe=s=>jr(()=>{let{sheetObject:l,trackId:u}=s,m=(0,Poe.val)(Se().atomP.historic.coreByProject[l.address.projectId].sheetsById[l.address.sheetId].sequence.tracksByObject[l.address.objectKey].trackData[u]);return(m==null?void 0:m.type)!=="BasicKeyframedTrack"?(console.error("trackData type ".concat(m==null?void 0:m.type," is not yet supported on the graph editor")),QC.default.createElement(QC.default.Fragment,null)):QC.default.createElement(Aoe,$(R({},s),{trackData:m}))},[s.trackId,s.layoutP]),koe=Roe});function Ioe({clippedSpaceRange:s,clippedSpaceWidth:l,fps:u,gapWidth:m=120},_){let b=1/u,E=s.end-s.start,T=l/(u*E),P=Math.floor(m/T),N=(P<u?Noe(u).find(V=>V>=P):u*Math.floor(P/u))*b,z=Math.floor(s.start/N),G=Math.ceil(s.end/N);for(let V=z;V<=G;V++){let B=V*N,H=B%1===0;_(B,H)}}var Noe,Doe=k(()=>{Fo(),Noe=Vf(s=>{let l=[];for(let u=1;u<=s;u++)s%u===0&&l.push(u);return l})});function V_e(s){let{clippedSpaceWidth:l,height:u,ctx:m,unitSpaceToClippedSpace:_,snapToGrid:b}=s;m.clearRect(0,0,l,u),Ioe(s,(E,T)=>{let P=b(E),N=Math.floor(_(P));m.strokeStyle=T?"rgba(225, 225, 225, 0.04)":"rgba(255, 255, 255, 0.01)",m.beginPath(),m.moveTo(N,0),m.lineTo(N,u),m.stroke(),m.closePath()})}var t8,n8,Ooe,Foe,Loe,Boe,Uoe,zoe,Voe,Goe,rL,joe=k(()=>{t8=mn(),n8=Q(qe()),Ft(),Doe(),Ae(),Foe=Te.div(Ooe||(Ooe=J([`
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  pointer-events: none;
`]))),Boe=Te.canvas(Loe||(Loe=J([`
  position: relative;
  left: 0;
`]))),Uoe=s=>{let l=s;return l.webkitBackingStorePixelRatio||l.mozBackingStorePixelRatio||l.msBackingStorePixelRatio||l.oBackingStorePixelRatio||l.backingStorePixelRatio||1},zoe=()=>window.devicePixelRatio||1,Voe=s=>zoe()/Uoe(s),Goe=({layoutP:s,width:l,height:u})=>{let m=(0,n8.useRef)(null),[_,b]=(0,n8.useState)(null),{ctx:E,ratio:T}=(0,n8.useMemo)(()=>{if(!_)return{};let P=_.getContext("2d"),N=Voe(P);return{ctx:P,ratio:N}},[_]);return(0,n8.useLayoutEffect)(()=>{if(!E)return;_.width=l*T,_.height=u*T;let P=(0,t8.prism)(()=>{let N=(0,t8.val)(s.sheet).getSequence();return{ctx:E,clippedSpaceRange:(0,t8.val)(s.clippedSpace.range),clippedSpaceWidth:(0,t8.val)(s.clippedSpace.width),unitSpaceToClippedSpace:(0,t8.val)(s.clippedSpace.fromUnitSpace),height:u,leftPadding:(0,t8.val)(s.scaledSpace.leftPadding),fps:N.subUnitsPerUnit,snapToGrid:z=>N.closestGridPosition(z)}}).onChange(Se().ticker,N=>{E.save(),E.scale(T,T),V_e(N),E.restore()},!0);return()=>{P()}},[E,l,u,s]),n8.default.createElement(Foe,{ref:m,style:{width:l+"px"}},n8.default.createElement(Boe,{ref:b,style:{width:l+"px",height:u+"px"}}))},rL=Goe}),Mp,r8,sS,Hoe,Woe,$oe,qoe,Xoe,Yoe,JC=k(()=>{Ae(),Sp(),DM(),er(),Mp=mn(),r8=Q(qe()),Ft(),Zse(),Bre(),z_e(),joe(),nu(),sS={1:{iconColor:"#b98b08"},2:{iconColor:"#70a904"},3:{iconColor:"#2e928a"},4:{iconColor:"#a943bb"},5:{iconColor:"#b90808"},6:{iconColor:"#b4bf0e"}},Woe=Te.div(Hoe||(Hoe=J([`
  position: absolute;
  right: 0;
  bottom: 0;
  background: `,`;
`])),Sd(.03,"#1a1c1e")),qoe=Te.svg($oe||($oe=J([`
  position: absolute;
  top: 0;
  left: 0;
  margin: 0;
  pointer-events: none;
`]))),Xoe=({layoutP:s})=>jr(()=>{let l=(0,Mp.val)(s.sheet),u=(0,Mp.val)(Se().atomP.historic.projects.stateByProjectId[l.address.projectId].stateBySheetId[l.address.sheetId].sequenceEditor.selectedPropsByObject),m=(0,Mp.val)(s.graphEditorDims.height),_=(0,Mp.val)(s.scaledSpace.fromUnitSpace)(1),b=[];if(u)for(let[T,P]of Object.entries(u)){let N=l.getObject(T);if(!N)continue;let z=(0,Mp.val)(N.template.getMapOfValidSequenceTracks_forStudio());for(let[G,V]of Object.entries(P)){let B=fC(G),H=D9(z,B);H&&b.push(r8.default.createElement(koe,{key:"graph-".concat(T,"-").concat(G),sheetObject:N,pathToProp:B,layoutP:s,trackId:H,color:V}))}}let E=(0,Mp.val)(s.rightDims.width);return r8.default.createElement(Woe,{style:{width:E+"px",height:m+"px","--unitSpaceToScaledSpaceMultiplier":_,"--graphEditorVerticalSpace":"".concat((0,Mp.val)(s.graphEditorVerticalSpace.space))}},r8.default.createElement(rL,{layoutP:s,width:E,height:m}),r8.default.createElement(uF,{layoutP:s,height:m},r8.default.createElement(qoe,{width:XC,height:m,viewBox:"0 0 ".concat(XC," ").concat(m)},r8.default.createElement("g",{style:{transform:"translate(".concat((0,Mp.val)(s.scaledSpace.leftPadding),"px, ").concat((0,Mp.val)(s.graphEditorDims.padding.top),"px)")}},b))))},[s]),Yoe=Xoe}),Koe,ch,Zoe,Qoe,Joe,eae,iL,tae,nae,rae,iae,sae,oae,aae,G_e=k(()=>{Ae(),Sp(),OM(),er(),Koe=mn(),ch=Q(qe()),Ft(),pO(),zM(),JC(),hC(),B5(),Lne(),Zoe={label:{color:"#9a9a9a"}},Joe=Te(XO)(Qoe||(Qoe=J([""]))),iL=Te(YO)(eae||(eae=J([`
  display: flex;
  color: `,`;
  padding-right: 12px;
  align-items: center;
  justify-content: flex-end;
  box-sizing: border-box;
`])),Zoe.label.color),nae=Te.button(tae||(tae=J([`
  background: none;
  border: none;
  outline: none;
  display: flex;
  box-sizing: border-box;
  font-size: 14px;
  align-items: center;
  height: 100%;
  margin-left: 12px;
  color: `,`;

  &:not([disabled]):hover {
    color: white;
  }
`])),s=>s.isSelected?sS[s.graphEditorColor].iconColor:O9.offColor),rae=()=>ch.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"10",height:"12",viewBox:"0 0 640 512"},ch.default.createElement("g",{transform:"translate(0 100)"},ch.default.createElement("path",{fill:"currentColor",d:"M368 32h-96c-17.67 0-32 14.33-32 32v96c0 17.67 14.33 32 32 32h96c17.67 0 32-14.33 32-32V64c0-17.67-14.33-32-32-32zM208 88h-84.75C113.75 64.56 90.84 48 64 48 28.66 48 0 76.65 0 112s28.66 64 64 64c26.84 0 49.75-16.56 59.25-40h79.73c-55.37 32.52-95.86 87.32-109.54 152h49.4c11.3-41.61 36.77-77.21 71.04-101.56-3.7-8.08-5.88-16.99-5.88-26.44V88zm-48 232H64c-17.67 0-32 14.33-32 32v96c0 17.67 14.33 32 32 32h96c17.67 0 32-14.33 32-32v-96c0-17.67-14.33-32-32-32zM576 48c-26.84 0-49.75 16.56-59.25 40H432v72c0 9.45-2.19 18.36-5.88 26.44 34.27 24.35 59.74 59.95 71.04 101.56h49.4c-13.68-64.68-54.17-119.48-109.54-152h79.73c9.5 23.44 32.41 40 59.25 40 35.34 0 64-28.65 64-64s-28.66-64-64-64zm0 272h-96c-17.67 0-32 14.33-32 32v96c0 17.67 14.33 32 32 32h96c17.67 0 32-14.33 32-32v-96c0-17.67-14.33-32-32-32z"}))),sae=Te.span(iae||(iae=J([`
  margin-right: 4px;
  `,`;

  `,`:hover & {
    color: #ccc;
  }
`])),N9,iL),oae=({leaf:s})=>{var l;let u=bb(s.sheetObject.propsP,s.pathToProp),m=s.sheetObject,{controlIndicators:_}=fO(u,m,s.propConf),b=jr(()=>{let G=s.sheetObject.address,V=bp(s.pathToProp);return(0,Koe.val)(Se().atomP.historic.projects.stateByProjectId[G.projectId].stateBySheetId[G.sheetId].sequenceEditor.selectedPropsByObject[G.objectKey][V])},[s]),E=(0,ch.useRef)(!1),T=typeof b=="string";E.current=T;let P=(0,ch.useCallback)(()=>{let G=s.sheetObject.address;Se().transaction(({stateEditors:V})=>{E.current?V.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.removePropFromGraphEditor($(R({},G),{pathToProp:s.pathToProp})):(V.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.addPropToGraphEditor($(R({},G),{pathToProp:s.pathToProp})),V.studio.historic.panels.sequenceEditor.graphEditor.setIsOpen({isOpen:!0}))})},[s]),N=(l=s.propConf.label)!=null?l:s.pathToProp[s.pathToProp.length-1],z=(0,ch.useRef)(null);return One(z.current,s),ch.default.createElement(Joe,{depth:s.depth},ch.default.createElement(iL,{ref:z,isEven:s.n%2===0,style:{height:s.nodeHeight+"px"},isSelected:T===!0},ch.default.createElement(sae,null,N),_,ch.default.createElement(nae,{onClick:P,isSelected:T===!0,graphEditorColor:b??"1",style:{opacity:1},disabled:!1},ch.default.createElement(rae,null))))},aae=oae});function sL(s,l){Se().transaction(({stateEditors:u})=>{u.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence.sequenceEditorCollapsableItems.set($(R({},l.sheetAddress),{studioSheetItemKey:l.sheetItemKey,isCollapsed:s}))})}var oL=k(()=>{Ae()}),Fv,aL,lae,j_e=k(()=>{Fv=Q(qe()),hC(),G_e(),oL(),aL=s=>{let l="prop"+s.pathToProp[s.pathToProp.length-1];return s.shouldRender?s.type==="propWithChildren"?Fv.default.createElement(lae,{leaf:s,key:l}):Fv.default.createElement(aae,{leaf:s,key:l}):Fv.default.createElement(Fv.default.Fragment,{key:l})},lae=({leaf:s})=>Fv.default.createElement(uC,{leaf:s,label:s.pathToProp[s.pathToProp.length-1],isCollapsed:s.isCollapsed,toggleCollapsed:()=>sL(!s.isCollapsed,{sheetAddress:s.sheetObject.address,sheetItemKey:s.sheetItemKey})},s.children.map(l=>aL(l)))}),cae,uae,hae,H_e=k(()=>{cae=Q(qe()),hC(),j_e(),oL(),Ae(),uae=({leaf:s})=>cae.default.createElement(uC,{leaf:s,label:s.sheetObject.address.objectKey,isCollapsed:s.isCollapsed,toggleSelect:()=>{Se().transaction(({stateEditors:l})=>{l.studio.historic.panels.outline.selection.set([s.sheetObject])})},toggleCollapsed:()=>sL(!s.isCollapsed,{sheetAddress:s.sheetObject.address,sheetItemKey:s.sheetItemKey})},s.children.map(l=>aL(l))),hae=uae}),lL,dae,fae,W_e=k(()=>{er(),lL=Q(qe()),H_e(),hC(),oL(),wJ(),dae=({leaf:s})=>jr(()=>lL.default.createElement(uC,{leaf:s,label:s.sheet.address.sheetId,isCollapsed:s.isCollapsed,toggleCollapsed:()=>{sL(!s.isCollapsed,{sheetAddress:s.sheet.address,sheetItemKey:s.sheetItemKey})}},s.children.map(l=>lL.default.createElement(hae,{key:"sheetObject-"+bJ(l.sheetObject),leaf:l}))),[s]),fae=dae}),cL,eA,pae,mae,gae,yae,vae,_ae,$_e=k(()=>{er(),cL=mn(),eA=Q(qe()),Ft(),W_e(),mae=Te.div(pae||(pae=J([`
  position: absolute;
  left: 0;
  overflow-x: visible;
`]))),yae=Te.ul(gae||(gae=J([`
  margin: 0;
  padding: 0;
  list-style: none;
`]))),vae=({layoutP:s})=>jr(()=>{let l=(0,cL.val)(s.tree),u=(0,cL.val)(s.leftDims.width);return eA.default.createElement(mae,{style:{width:u+"px",top:l.top+"px"}},eA.default.createElement(yae,null,eA.default.createElement(fae,{leaf:l})))},[s]),_ae=vae}),uL,xae,bae,Sae,wae,q_e=k(()=>{Li(),Hm(),er(),nu(),uL=Q(qe()),Ft(),joe(),bae=Te.div(xae||(xae=J([`
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  z-index: `,`;
  overflow: hidden;
  background: `,`;
  pointer-events: none;
`])),()=>Ip.rightBackground,Sd(.01,Yx(1*.03,sv.panel.bg))),Sae=({layoutP:s})=>{let l=Xr(s.rightDims.width),u=Xr(s.panelDims.height);return uL.default.createElement(bae,{style:{width:l+"px"}},uL.default.createElement(rL,{width:l,height:u,layoutP:s}))},wae=Sae}),Lv,Eae,Tae,Mae,Cae,X_e=k(()=>{er(),Lv=Q(qe()),Ft(),$_e(),q_e(),Zse(),dre(),Tae=Te.div(Eae||(Eae=J([`
  position: absolute;
  left: 0;
  right: 0;
`]))),Mae=({layoutP:s})=>{let l=Xr(s.dopeSheetDims.height);return Lv.default.createElement(Tae,{style:{height:l+"px"}},Lv.default.createElement(wae,{layoutP:s}),Lv.default.createElement(hre,null,Lv.default.createElement(_ae,{layoutP:s}),Lv.default.createElement(Kse,{layoutP:s})))},Cae=Mae});function Y_e(s,l,u){return hL.prism.memo(s,()=>(0,hL.prism)(l),u).getValue()}var hL,K_e=k(()=>{hL=mn()});function ks(s){return function(l,u){return s(l,u())}}function su(s){return Object.freeze({audience:i8(s,8)?"internal":i8(s,16)?"dev":"public",category:i8(s,4)?"troubleshooting":i8(s,2)?"todo":"general",level:i8(s,512)?512:i8(s,256)?256:i8(s,128)?128:64})}function i8(s,l){return(s&l)===l}function Is(s,l){return((l&32)===32?!0:(l&16)===16?s.dev:(l&8)===8?s.internal:!1)&&s.min<=l}function Aae(s=console,l={}){let u=$(R({},Cp),{includes:R({},Cp.includes)}),m={styled:J_e.bind(u,s),noStyle:txe.bind(u,s)},_=Q_e.bind(u);function b(){return u.loggingConsoleStyle&&u.loggerConsoleStyle?m.styled:m.noStyle}return u.create=b(),{configureLogger(E){var T;E==="console"?(u.loggerConsoleStyle=Cp.loggerConsoleStyle,u.create=b()):E.type==="console"?(u.loggerConsoleStyle=(T=E.style)!=null?T:Cp.loggerConsoleStyle,u.create=b()):E.type==="keyed"?(u.creatExt=P=>E.keyed(P.names),u.create=_):E.type==="named"&&(u.creatExt=Z_e.bind(null,E.named),u.create=_)},configureLogging(E){var T,P,N,z,G;u.includes.dev=(T=E.dev)!=null?T:Cp.includes.dev,u.includes.internal=(P=E.internal)!=null?P:Cp.includes.internal,u.includes.min=(N=E.min)!=null?N:Cp.includes.min,u.include=(z=E.include)!=null?z:Cp.include,u.loggingConsoleStyle=(G=E.consoleStyle)!=null?G:Cp.loggingConsoleStyle,u.create=b()},getLogger(){return u.create({names:[]})}}}function Z_e(s,l){let u=[];for(let{name:m,key:_}of l.names)u.push(_==null?m:"".concat(m," (").concat(_,")"));return s(u)}function Q_e(s){let l=R(R({},this.includes),this.include(s)),u=this.filtered,m=this.named.bind(this,s),_=this.creatExt(s),b=Is(l,524),E=Is(l,522),T=Is(l,521),P=Is(l,529),N=Is(l,545),z=Is(l,265),G=Is(l,268),V=Is(l,273),B=Is(l,289),H=Is(l,137),j=Is(l,145),X=Is(l,73),K=Is(l,81),te=b?_.error.bind(_,ac._hmm):u.bind(s,524),se=E?_.error.bind(_,ac._todo):u.bind(s,522),pe=T?_.error.bind(_,ac._error):u.bind(s,521),fe=P?_.error.bind(_,ac.errorDev):u.bind(s,529),ve=N?_.error.bind(_,ac.errorPublic):u.bind(s,545),Ne=G?_.warn.bind(_,ac._kapow):u.bind(s,268),ze=z?_.warn.bind(_,ac._warn):u.bind(s,265),Me=V?_.warn.bind(_,ac.warnDev):u.bind(s,273),He=B?_.warn.bind(_,ac.warnPublic):u.bind(s,273),vt=H?_.debug.bind(_,ac._debug):u.bind(s,137),xe=j?_.debug.bind(_,ac.debugDev):u.bind(s,145),We=X?_.trace.bind(_,ac._trace):u.bind(s,73),oe=K?_.trace.bind(_,ac.traceDev):u.bind(s,81),nt={_hmm:te,_todo:se,_error:pe,errorDev:fe,errorPublic:ve,_kapow:Ne,_warn:ze,warnDev:Me,warnPublic:He,_debug:vt,debugDev:xe,_trace:We,traceDev:oe,lazy:{_hmm:b?ks(te):te,_todo:E?ks(se):se,_error:T?ks(pe):pe,errorDev:P?ks(fe):fe,errorPublic:N?ks(ve):ve,_kapow:G?ks(Ne):Ne,_warn:z?ks(ze):ze,warnDev:V?ks(Me):Me,warnPublic:B?ks(He):He,_debug:H?ks(vt):vt,debugDev:j?ks(xe):xe,_trace:X?ks(We):We,traceDev:K?ks(oe):oe},named:m,utilFor:{internal(){return{debug:nt._debug,error:nt._error,warn:nt._warn,trace:nt._trace,named(dn,Ve){return nt.named(dn,Ve).utilFor.internal()}}},dev(){return{debug:nt.debugDev,error:nt.errorDev,warn:nt.warnDev,trace:nt.traceDev,named(dn,Ve){return nt.named(dn,Ve).utilFor.dev()}}},public(){return{error:nt.errorPublic,warn:nt.warnPublic,debug(dn,Ve){nt._warn('(public "debug" filtered out) '.concat(dn),Ve)},trace(dn,Ve){nt._warn('(public "trace" filtered out) '.concat(dn),Ve)},named(dn,Ve){return nt.named(dn,Ve).utilFor.public()}}}}};return nt}function J_e(s,l){let u=R(R({},this.includes),this.include(l)),m=[],_="";for(let P=0;P<l.names.length;P++){let{name:N,key:z}=l.names[P];if(_+=" %c".concat(N),m.push(this.style.css(N)),z!=null){let G="%c#".concat(z);_+=G,m.push(this.style.css(G))}}let b=this.filtered,E=this.named.bind(this,l),T=[_,...m];return Pae(b,l,u,s,T,exe(T),E)}function exe(s){let l=s.slice(0);for(let u=1;u<l.length;u++)l[u]+=";background-color:#e0005a;padding:2px;color:white";return l}function txe(s,l){let u=R(R({},this.includes),this.include(l)),m="";for(let T=0;T<l.names.length;T++){let{name:P,key:N}=l.names[T];m+=" ".concat(P),N!=null&&(m+="#".concat(N))}let _=this.filtered,b=this.named.bind(this,l),E=[m];return Pae(_,l,u,s,E,E,b)}function Pae(s,l,u,m,_,b,E){let T=Is(u,524),P=Is(u,522),N=Is(u,521),z=Is(u,529),G=Is(u,545),V=Is(u,265),B=Is(u,268),H=Is(u,273),j=Is(u,289),X=Is(u,137),K=Is(u,145),te=Is(u,73),se=Is(u,81),pe=T?m.error.bind(m,..._):s.bind(l,524),fe=P?m.error.bind(m,..._):s.bind(l,522),ve=N?m.error.bind(m,..._):s.bind(l,521),Ne=z?m.error.bind(m,..._):s.bind(l,529),ze=G?m.error.bind(m,..._):s.bind(l,545),Me=B?m.warn.bind(m,...b):s.bind(l,268),He=V?m.warn.bind(m,..._):s.bind(l,265),vt=H?m.warn.bind(m,..._):s.bind(l,273),xe=j?m.warn.bind(m,..._):s.bind(l,273),We=X?m.info.bind(m,..._):s.bind(l,137),oe=K?m.info.bind(m,..._):s.bind(l,145),nt=te?m.debug.bind(m,..._):s.bind(l,73),dn=se?m.debug.bind(m,..._):s.bind(l,81),Ve={_hmm:pe,_todo:fe,_error:ve,errorDev:Ne,errorPublic:ze,_kapow:Me,_warn:He,warnDev:vt,warnPublic:xe,_debug:We,debugDev:oe,_trace:nt,traceDev:dn,lazy:{_hmm:T?ks(pe):pe,_todo:P?ks(fe):fe,_error:N?ks(ve):ve,errorDev:z?ks(Ne):Ne,errorPublic:G?ks(ze):ze,_kapow:B?ks(Me):Me,_warn:V?ks(He):He,warnDev:H?ks(vt):vt,warnPublic:j?ks(xe):xe,_debug:X?ks(We):We,debugDev:K?ks(oe):oe,_trace:te?ks(nt):nt,traceDev:se?ks(dn):dn},named:E,utilFor:{internal(){return{debug:Ve._debug,error:Ve._error,warn:Ve._warn,trace:Ve._trace,named(Be,ot){return Ve.named(Be,ot).utilFor.internal()}}},dev(){return{debug:Ve.debugDev,error:Ve.errorDev,warn:Ve.warnDev,trace:Ve.traceDev,named(Be,ot){return Ve.named(Be,ot).utilFor.dev()}}},public(){return{error:Ve.errorPublic,warn:Ve.warnPublic,debug(Be,ot){Ve._warn('(public "debug" filtered out) '.concat(Be),ot)},trace(Be,ot){Ve._warn('(public "trace" filtered out) '.concat(Be),ot)},named(Be,ot){return Ve.named(Be,ot).utilFor.public()}}}}};return Ve}var ac,Cp,Rae=k(()=>{ac={_hmm:su(524),_todo:su(522),_error:su(521),errorDev:su(529),errorPublic:su(545),_kapow:su(268),_warn:su(265),warnDev:su(273),warnPublic:su(289),_debug:su(137),debugDev:su(145),_trace:su(73),traceDev:su(81)},Cp={loggingConsoleStyle:!0,loggerConsoleStyle:!0,includes:Object.freeze({internal:!1,dev:!1,min:256}),filtered:function(){},include:function(){return{}},create:null,creatExt:null,named(s,l,u){return this.create({names:[...s.names,{name:l,key:u}]})},style:{bold:void 0,italic:void 0,cssMemo:new Map([["",""]]),collapseOnRE:/[a-z- ]+/g,color:void 0,collapsed(s){if(s.length<5)return s;let l=s.replace(this.collapseOnRE,"");return this.cssMemo.has(l)||this.cssMemo.set(l,this.css(s)),l},css(s){var l,u,m,_;let b=this.cssMemo.get(s);if(b)return b;let E="color:".concat((u=(l=this.color)==null?void 0:l.call(this,s))!=null?u:"hsl(".concat((s.charCodeAt(0)+s.charCodeAt(s.length-1))%360,", 100%, 60%)"));return(m=this.bold)!=null&&m.test(s)&&(E+=";font-weight:600"),(_=this.italic)!=null&&_.test(s)&&(E+=";font-style:italic"),this.cssMemo.set(s,E),E}}}}),dL,tA,nA=k(()=>{Rae(),Rae(),dL=Aae(console,{}),dL.configureLogging({dev:!0,min:64}),tA=dL.getLogger().named("Theatre.js (default logger)").utilFor.dev()}),$9,s8,kae,nxe=k(()=>{Dm(),$9=mn(),nA(),Cm(),s8=28,kae=(s,l)=>{var u;$9.prism.ensurePrism();let m=!0,_=tM+s8,b=0,E=l.atomP.ahistoric.projects.stateByProjectId[s.address.projectId].stateBySheetId[s.address.sheetId].sequence.collapsableItems,T=E.byId[ha.forSheet()].isCollapsed,P=(u=(0,$9.pointerToPrism)(T).getValue())!=null?u:!1,N={type:"sheet",isCollapsed:P,sheet:s,children:[],sheetItemKey:ha.forSheet(),shouldRender:m,top:tM,depth:0,n:b,nodeHeight:s8,heightIncludingChildren:-1};b+=1;for(let j of Object.values((0,$9.val)(s.objectsP)))j&&z(j,N.children,N.depth+1,!P);N.heightIncludingChildren=_-N.top;function z(j,X,K,te){var se;let pe=(0,$9.val)(j.template.getMapOfValidSequenceTracks_forStudio()),fe=(0,$9.val)(j.template.configPointer);if(Object.keys(pe).length===0)return;let ve=E.byId[ha.forSheetObject(j)].isCollapsed,Ne=(se=(0,$9.pointerToPrism)(ve).getValue())!=null?se:!1,ze={type:"sheetObject",isCollapsed:Ne,sheetItemKey:ha.forSheetObject(j),shouldRender:te,top:_,children:[],depth:K,n:b,sheetObject:j,nodeHeight:te?s8:0,heightIncludingChildren:-1};X.push(ze),te&&(b+=1,_+=ze.nodeHeight),G(j,pe,[],fe,ze.children,K+1,te&&!Ne),ze.heightIncludingChildren=_-ze.top}function G(j,X,K,te,se,pe,fe){for(let[ve,Ne]of Object.entries(X)){let ze=te.props[ve];V(j,Ne,[...K,ve],ze,se,pe,fe)}}function V(j,X,K,te,se,pe,fe){te.type==="compound"?B(j,X,te,K,te,se,pe,fe):te.type==="enum"?tA.warn("Prop type enum is not yet supported in the sequence editor"):H(j,X,K,te,se,pe,fe)}function B(j,X,K,te,se,pe,fe,ve){var Ne;let ze=E.byId[ha.forSheetObjectProp(j,te)].isCollapsed,Me=(Ne=(0,$9.pointerToPrism)(ze).getValue())!=null?Ne:!1,He={type:"propWithChildren",isCollapsed:Me,propConf:K,pathToProp:te,sheetItemKey:ha.forSheetObjectProp(j,te),sheetObject:j,shouldRender:ve,top:_,children:[],nodeHeight:ve?s8:0,heightIncludingChildren:-1,depth:fe,trackMapping:X,n:b};pe.push(He),ve&&(_+=He.nodeHeight,b+=1),G(j,X,te,se,He.children,fe+1,ve&&!Me),He.heightIncludingChildren=_-He.top}function H(j,X,K,te,se,pe,fe){let ve={type:"primitiveProp",propConf:te,depth:pe,sheetItemKey:ha.forSheetObjectProp(j,K),sheetObject:j,pathToProp:K,shouldRender:fe,top:_,nodeHeight:fe?s8:0,heightIncludingChildren:fe?s8:0,trackId:X,n:b};se.push(ve),b+=1,_+=ve.nodeHeight}return N}});function rxe(s,l){let u=Se(),m=u.atomP.ahistoric.projects.stateByProjectId[s.address.projectId].stateBySheetId[s.address.sheetId],_=u.atomP.historic.projects.stateByProjectId[s.address.projectId].stateBySheetId[s.address.sheetId];return(0,lc.prism)(()=>{var b;let E=Y_e("tree",()=>kae(s,u),[]),T=(0,lc.val)(l),P=(0,lc.val)(u.atomP.historic.panels.sequenceEditor.graphEditor),N=(0,lc.val)(_.sequenceEditor.selectedPropsByObject),z=!!N&&Object.keys(N).length>0,{leftDims:G,rightDims:V,graphEditorDims:B,dopeSheetDims:H,horizontalScrollbarDims:j}=lc.prism.memo("leftDims",()=>{var He;let vt={width:Math.floor(T.width*Iae),height:T.height,screenX:T.screenX,screenY:T.screenY},xe={width:T.width-vt.width,height:T.height,screenX:T.screenX+vt.width,screenY:T.screenY},We=z&&(P==null?void 0:P.isOpen)===!0,oe=Math.floor((We?ii((He=P==null?void 0:P.height)!=null?He:.5,.1,.7):0)*T.heightWithoutBorder),nt=0+oe,dn=T.height-nt,Ve={width:T.width,height:dn,screenX:T.screenX,screenY:T.screenY},Be={isAvailable:z,isOpen:We,width:xe.width,height:oe,screenX:T.screenX,screenY:T.screenY+dn,padding:{top:20,bottom:20}};return{leftDims:vt,rightDims:xe,graphEditorDims:Be,dopeSheetDims:Ve,horizontalScrollbarDims:{bottom:0}}},[T,P,z]),X=lc.prism.memo("graphEditorVerticalSpace",()=>{let He=B.height-B.padding.top-B.padding.bottom;return{space:He,fromExtremumSpace(vt){return vt*He},toExtremumSpace(vt){return vt/He}}},[B]),[K,te]=lc.prism.state("isSeeking",!1),se={isSeeking:K,setIsSeeking:te},pe={},fe=(b=(0,lc.val)(m.sequence.clippedSpaceRange))!=null?b:Nae,ve=lc.prism.memo("scaledSpace",()=>{let He=fe.end-fe.start,vt=V.width,xe=He/vt,We=vt/He;return{fromUnitSpace(oe){return oe*We},toUnitSpace(oe){return oe*xe},leftPadding:10}},[fe,V.width]),Ne=lc.prism.memo("setClippedSpaceRange",()=>function(He){u.transaction(({stateEditors:vt})=>{let xe=R({},He);if(xe.end<=xe.start&&(xe.end=xe.start+1),xe.start<0){let We=xe.end-xe.start;xe.start=0,xe.end=We}vt.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence.clippedSpaceRange.set($(R({},s.address),{range:xe}))})},[]),ze=lc.prism.memo("clippedSpace",()=>({range:fe,width:V.width,fromUnitSpace(He){return ve.fromUnitSpace(He-fe.start)+ve.leftPadding},toUnitSpace(He){return ve.toUnitSpace(He-ve.leftPadding)+fe.start},setRange:Ne}),[fe,V.width,ve,Ne]),Me=lc.prism.memo("selection.current",()=>new lc.Atom({}),[]);return qO("finalAtom",{sheet:s,tree:E,panelDims:T,leftDims:G,rightDims:V,dopeSheetDims:H,horizontalScrollbarDims:j,seeker:se,unitSpace:pe,scaledSpace:ve,clippedSpace:ze,graphEditorDims:B,graphEditorVerticalSpace:X,selectionAtom:Me}).pointer})}var lc,Iae,Nae,ixe=k(()=>{Ae(),K_e(),Dne(),lc=mn(),nxe(),Fo(),Iae=.2,Nae={start:0,end:10}});function sxe(s){let{fullSecondStampsContainer:l,sequencePositionFormatter:u,snapToGrid:m,unitSpaceToClippedSpace:_}=s,b="";Ioe(s,(E,T)=>{let P=m(E),N=_(P);T?b+=Dae(u.formatFullUnitForGrid(P),N,"full-unit"):b+=Dae(u.formatSubUnitForGrid(P),N,"sub-unit")}),l.innerHTML=b}function Dae(s,l,u){return'<span class="'.concat(u,'" style="transform: translate3d(').concat(l.toFixed(1),'px, -50%, 0);">').concat(s,"</span>")}var o8,a8,Oae,Fae,q9,Lae,Bae,Uae,zae,Vae,Gae,jae=k(()=>{o8=mn(),nu(),a8=Q(qe()),Ft(),Doe(),Ae(),Fae=Te.div(Oae||(Oae=J([`
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  pointer-events: none;
`]))),q9={fullUnitStampColor:"#6a6a6a",stampFontSize:"10px",get subUnitStampColor(){return Yx(.2,q9.fullUnitStampColor)}},Bae=Te.div(Lae||(Lae=J([`
  position: absolute;
  top: 0;
  height: 100%;
  left: 0;
  overflow: hidden;
  z-index: 2;
  will-change: transform;
  pointer-events: none;
`]))),zae=Te.div(Uae||(Uae=J([`
  position: absolute;
  top: 0;
  left: 0;

  & > span {
    position: absolute;
    display: block;
    top: 9px;
    left: -10px;
    color: `,`;
    text-align: center;
    font-size: `,`;
    width: 20px;

    &.full-unit {
      color: `,`;
    }

    &.sub-unit {
      color: `,`;
    }
  }

  pointer-events: none;
`])),q9.fullUnitStampColor,q9.stampFontSize,q9.fullUnitStampColor,q9.subUnitStampColor),Vae=({layoutP:s,width:l})=>{let u=(0,a8.useRef)(null),[m,_]=(0,a8.useState)(null);return(0,a8.useLayoutEffect)(()=>{if(m)return(0,o8.prism)(()=>{let b=(0,o8.val)(s.sheet).getSequence();return{fullSecondStampsContainer:m,clippedSpaceRange:(0,o8.val)(s.clippedSpace.range),clippedSpaceWidth:(0,o8.val)(s.clippedSpace.width),unitSpaceToClippedSpace:(0,o8.val)(s.clippedSpace.fromUnitSpace),leftPadding:(0,o8.val)(s.scaledSpace.leftPadding),fps:b.subUnitsPerUnit,sequencePositionFormatter:b.positionFormatter,snapToGrid:E=>b.closestGridPosition(E)}}).onChange(Se().ticker,sxe,!0)},[m,l,s]),a8.default.createElement(Fae,{ref:u,style:{width:l+"px"}},a8.default.createElement(Bae,{style:{width:l+"px"}},a8.default.createElement(zae,{ref:_})))},Gae=Vae});function oxe(s){let[l,u]=(0,fL.useState)(!1);return(0,fL.useEffect)(()=>{if(u(!1),!s)return;let m=b=>{b.target===s?u(!0):u(!1)},_=()=>{u(!1)};return s.addEventListener("mouseenter",m),s.addEventListener("mousemove",m),s.addEventListener("mouseleave",_),()=>{u(!1),s.removeEventListener("mouseenter",m),s.removeEventListener("mousemove",m),s.removeEventListener("mouseleave",_)}},[s]),l}var fL,axe=k(()=>{fL=Q(qe())});function lxe(s,l){let u=0,[m,_]=s,[b,E]=l;return _-m>E-b?[b,E]:(m<b&&(u=0-m),_>E&&(u=E-_),[m+u,_+u])}var Ap,X9,Ko,pL,Hae,rA,Wae,$ae,qae=k(()=>{Ap=mn(),er(),Li(),Ae(),c8(),gl(),Yo(),Fi(),X9=Q(qe()),Ft(),Za(),Ko={enabled:{backgroundColor:"#2C2F34",stroke:"#646568"},disabled:{backgroundColor:"#282a2cc5",stroke:"#595a5d"},hover:{backgroundColor:"#34373D",stroke:"#C8CAC0"},dragging:{backgroundColor:"#3F444A",stroke:"#C8CAC0"},thumbWidth:9,hitZoneWidth:26,rangeStripMinWidth:30},pL=1e3,rA=Te.div(Hae||(Hae=J([`
  position: absolute;
  height: `,`px;
  background-color: `,`;
  cursor: grab;
  top: 0;
  left: 0;
  width: `,`px;
  transform-origin: left top;
  &:hover {
    background-color: `,`;
  }
  &.dragging {
    background-color: `,`;
    cursor: grabbing !important;
  }
  `,`;

  /* covers the one pixel space between the focus range strip and the top strip
  of the sequence editor panel, which would have caused that one pixel to act
  like a panel drag zone */
  &:after {
    display: block;
    content: ' ';
    position: absolute;
    bottom: -1px;
    height: 1px;
    left: 0;
    right: 0;
    background: transparent;
    pointer-events: normal;
    z-index: -1;
  }
`])),()=>Rp-1,s=>s.enabled?Ko.enabled.backgroundColor:Ko.disabled.backgroundColor,pL,Ko.hover.backgroundColor,Ko.dragging.backgroundColor,Di),Wae=({layoutP:s})=>{let l=(0,X9.useMemo)(()=>(0,Ap.prism)(()=>{let{projectId:N,sheetId:z}=(0,Ap.val)(s.sheet).address;return(0,Ap.val)(Se().atomP.ahistoric.projects.stateByProjectId[N].stateBySheetId[z].sequence.focusRange)}),[s]),[u,m]=Ai(null),[_]=ml(m,{menuItems:()=>{let N=(0,Ap.val)(s.sheet),z=l.getValue();return[{label:"Delete focus range",callback:()=>{Se().tempTransaction(({stateEditors:G})=>{G.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence.focusRange.unset(R({},N.address))}).commit()}},{label:z!=null&&z.enabled?"Disable focus range":"Enable focus range",callback:()=>{z!==void 0&&Se().tempTransaction(({stateEditors:G})=>{G.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence.focusRange.set($(R({},N.address),{range:z.range,enabled:!z.enabled}))}).commit()}}]}}),b=Xr(s.scaledSpace.toUnitSpace),E=Xr(s.sheet),T=(0,X9.useMemo)(()=>{let N,z;return{debugName:"FocusRangeStrip",onDragStart(G){let V,B=l.getValue();if(!B)return!1;let H=B.range.start,j=B.range.end,X=!1,K=(0,Ap.val)(s.sheet).getSequence();return{onDrag(te){if(B=l.getValue(),B){X=!0;let se=b(te),pe=H+se,fe=j+se;fe<pe&&(fe=pe),[N,z]=lxe([pe,fe],[0,K.length]).map(ve=>K.closestGridPosition(ve)),V&&V.discard(),V=Se().tempTransaction(({stateEditors:ve})=>{var Ne;ve.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence.focusRange.set($(R({},E.address),{range:{start:N,end:z},enabled:(Ne=B==null?void 0:B.enabled)!=null?Ne:!0}))})}},onDragEnd(){B&&(X&&V!==void 0?V.commit():V&&V.discard())}}},lockCSSCursorTo:"grabbing"}},[E,b]),[P]=uo(m,T);return Bm(P,-1),jr(()=>{let N=l.getValue(),z=(N==null?void 0:N.range)||{start:0,end:0},G=(0,Ap.val)(s.clippedSpace.fromUnitSpace)(z.start),V=(0,Ap.val)(s.clippedSpace.fromUnitSpace)(z.end),B,H;return G<0&&(G=0),V>(0,Ap.val)(s.clippedSpace.width)&&(V=(0,Ap.val)(s.clippedSpace.width)),G>V?(H=0,B=0):(H=G,B=(V-G)/pL),N?X9.default.createElement(X9.default.Fragment,null,_,X9.default.createElement(rA,{id:"range-strip",enabled:N.enabled,className:"".concat(P?"dragging":""," ").concat(N.enabled?"enabled":""),ref:u,style:{transform:"translateX(".concat(H,"px) scale(").concat(B,", 1)")}})):X9.default.createElement(X9.default.Fragment,null)},[s,u,l,_,P])},$ae=Wae}),Y9,Vm,Xae,Yae,Kae,Zae,Qae,Jae,e0e,mL,cxe=k(()=>{Y9=mn(),er(),Ae(),c8(),ru(),Yo(),Fi(),Vm=Q(qe()),Ft(),Za(),qae(),Rd(),Yae=Te.div(Xae||(Xae=J([`
  position: absolute;
  top: 0;
  // the right handle has to be pulled back by its width since its right side indicates its position, not its left side
  left: `,`px;
  transform-origin: left top;
  width: `,`px;
  height: `,`px;
  z-index: 3;

  --bg: `,`;

  stroke: `,`;
  user-select: none;

  cursor: `,`;

  // no pointer events unless pointer-root is in normal mode _and_ the
  // focus range is enabled
  #pointer-root & {
    pointer-events: none;
  }

  #pointer-root.normal & {
    pointer-events: auto;
  }

  #pointer-root.draggingPositionInSequenceEditor & {
    pointer-events: auto;
    cursor: var(`,`);
  }

  &.dragging {
    pointer-events: none !important;
  }

  // highlight the handle if it's hovered, or the whole strip is hovverd
  `,`:hover ~ &, &:hover {
    --bg: `,`;
    stroke: `,`;
  }

  // highlight the handle when it's being dragged or the whole strip is being dragged.
  // using dragging.dragging to give this selector priority, as it seems to be overridden
  // by the hover selector above
  &.dragging,
  `,`.dragging.dragging ~ & {
    --bg: `,`;
    stroke: `,`;
  }

  #pointer-root.draggingPositionInSequenceEditor &:hover {
    --bg: `,`;
    stroke: #40aaa4;
  }

  background-color: var(--bg);

  // a larger hit zone
  &:before {
    display: block;
    content: ' ';
    position: absolute;
    inset: -8px;
  }
`])),s=>s.type==="start"?0:-Ko.thumbWidth,Ko.thumbWidth,()=>Rp-1,({enabled:s})=>s?Ko.enabled.backgroundColor:Ko.disabled.backgroundColor,Ko.enabled.stroke,s=>s.type==="start"?"w-resize":"e-resize",Pm,()=>rA,Ko.hover.backgroundColor,Ko.hover.stroke,()=>rA,Ko.dragging.backgroundColor,Ko.dragging.stroke,Ko.dragging.backgroundColor),Zae=Te.div(Kae||(Kae=J([`
  position: absolute;
  top: 0;
  bottom: 0;
  pointer-events: none;

  background: linear-gradient(
    `,`deg,
    var(--bg) 0%,
    #ffffff00 100%
  );

  width: 12px;
  left: `,`px;
`])),s=>s.type==="start"?90:-90,s=>s.type==="start"?Ko.thumbWidth:-Ko.thumbWidth+1),Jae=Te.div(Qae||(Qae=J([`
  position: absolute;
  top: 0;
  bottom: 0;
  pointer-events: none;

  background: linear-gradient(
    `,`deg,
    `,` 0%,
    #ffffff00 100%
  );

  width: 12px;
  left: `,`px;
`])),s=>s.type==="start"?-90:90,()=>oS.backgroundColor,s=>s.type==="start"?-12:Ko.thumbWidth),e0e=({layoutP:s,thumbType:l})=>{var u;let[m,_]=Ai(null),b=(0,Vm.useMemo)(()=>(0,Y9.prism)(()=>{let{projectId:N,sheetId:z}=(0,Y9.val)(s.sheet).address;return(0,Y9.val)(Se().atomP.ahistoric.projects.stateByProjectId[N].stateBySheetId[z].sequence.focusRange)}),[s]),E=(0,Vm.useMemo)(()=>({debugName:"FocusRangeThumb",onDragStart(){let N,z,G=(0,Y9.val)(s.sheet),V={start:0,end:G.getSequence().length},B=b.getValue()||{range:V,enabled:!1},H=B.enabled,j=B.range[l],X=(0,Y9.val)(s.scaledSpace.toUnitSpace),K=X(Ko.rangeStripMinWidth);return{onDrag(te,se,pe){var fe;let ve,Ne=yl.checkIfMouseEventSnapToPos(pe,{ignore:_});if(Ne==null){let Me=X(te);ve=j+Me}else ve=Ne;z=((fe=b.getValue())==null?void 0:fe.range)||V,l==="start"?ve=Math.max(Math.min(ve,z.end-K),0):ve=Math.min(Math.max(ve,z.start+K),G.getSequence().length);let ze=G.getSequence().closestGridPosition(ve);N!==void 0&&N.discard(),N=Se().tempTransaction(({stateEditors:Me})=>{Me.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence.focusRange.set($(R({},G.address),{range:$(R({},z),{[l]:ze}),enabled:H}))})},onDragEnd(te){te?N==null||N.commit():N==null||N.discard()}}}}),[s]),[T]=uo(_,E);rh(T,"draggingPositionInSequenceEditor",l==="start"?"w-resize":"e-resize");let P=Xr(b);return Bm(T,(u=P==null?void 0:P.range[l])!=null?u:0),jr(()=>{let N=b.getValue();if(!N)return null;let{enabled:z}=N,G=N.range[l],V=(0,Y9.val)(s.clippedSpace.fromUnitSpace)(G);return(V<0||(0,Y9.val)(s.clippedSpace.width)<V)&&(V=-1e4),Vm.default.createElement(Yae,$(R(R({ref:m},yl.includePositionSnapAttrs(G)),wp(G)),{className:"".concat(T&&"dragging"," ").concat(z&&"enabled"),enabled:z,type:l,style:{transform:"translate3d(".concat(V,"px, 0, 0)")}}),Vm.default.createElement(Zae,{type:l,enabled:z}),Vm.default.createElement(Jae,{type:l}),Vm.default.createElement("svg",{viewBox:"0 0 9 18",xmlns:"http://www.w3.org/2000/svg"},Vm.default.createElement("line",{x1:"4",y1:"6",x2:"4",y2:"12"}),Vm.default.createElement("line",{x1:"6",y1:"6",x2:"6",y2:"12"})))},[s,m,b,T])},mL=e0e});function uxe(s,l){let[u,m]=(0,Pp.useState)("none");return rh(u!=="none","dragging",u==="creating"?"ew-resize":"move"),(0,Pp.useMemo)(()=>{let _=()=>({debugName:"FocusRangeZone/focusRangeCreationGestureHandlers",onDragStart(E){let T,P=(0,l8.val)(s.clippedSpace.toUnitSpace),N=(0,l8.val)(s.scaledSpace.toUnitSpace),z=(0,l8.val)(s.sheet),G=z.getSequence(),V=E.target.getBoundingClientRect(),B=P(E.clientX-V.left),H=N(Ko.rangeStripMinWidth);return{onDrag(j){let X=N(j),K=B,te=B+X;[K,te]=[ii(K,0,G.length),ii(te,0,G.length)].map(se=>G.closestGridPosition(se)),te<K?[K,te]=[Math.max(Math.min(te,K-H),0),K]:j>0&&(te=Math.min(Math.max(te,K+H),G.length)),T&&T.discard(),T=Se().tempTransaction(({stateEditors:se})=>{se.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence.focusRange.set($(R({},z.address),{range:{start:K,end:te},enabled:!0}))})},onDragEnd(j){j&&T!==void 0?T.commit():T&&T.discard()}}},lockCSSCursorTo:"ew-resize"}),b=()=>({debugName:"FocusRangeZone/panelMoveGestureHandlers",onDragStart(){let E,T=l.current,P=l.current.addBoundsHighlightLock();return{onDrag(N,z){let G=$(R({},T.dims),{top:ii(T.dims.top+z,0,window.innerHeight-up),left:ii(T.dims.left+N,-T.dims.width+up,window.innerWidth-up)}),V=aC(G,{width:window.innerWidth,height:window.innerHeight});E==null||E.discard(),E=Se().tempTransaction(({stateEditors:B})=>{B.studio.historic.panelPositions.setPanelPosition({position:V,panelId:T.panelId})})},onDragEnd(N){P(),N?E==null||E.commit():E==null||E.discard()}}},lockCSSCursorTo:"move"});return{debugName:"FocusRangeZone",onDragStart(E){let[T,P]=E.shiftKey?["creating",_().onDragStart(E)]:["moving-panel",b().onDragStart(E)];return m(T),P===!1?!1:{onDrag(N,z,G,V,B){P.onDrag(N,z,G,V,B)},onDragEnd(N){var z;m("none"),(z=P.onDragEnd)==null||z.call(P,N)}}}}},[s,l])}var l8,Pp,t0e,n0e,r0e,i0e,hxe=k(()=>{l8=mn(),er(),Ae(),Cv(),c8(),ru(),Yo(),axe(),Kne(),Fi(),Fo(),Pp=Q(qe()),Ft(),qae(),cxe(),Cm(),n0e=Te.div(t0e||(t0e=J([`
  position: absolute;
  height: `,`px;
  left: 0;
  right: 0;
  box-sizing: border-box;
  /* Use the "grab" cursor if the shift key is up, which is the one used on the top strip of the sequence editor */
  cursor: `,`;
`])),()=>Rp,s=>s.isShiftDown?"ew-resize":"move"),r0e=({layoutP:s})=>{let[l,u]=Ai(null),m=Mv(),_=(0,Pp.useRef)(m);_.current=m;let b=(0,Pp.useMemo)(()=>(0,l8.prism)(()=>{let{projectId:P,sheetId:N}=(0,l8.val)(s.sheet).address;return(0,l8.val)(Se().atomP.ahistoric.projects.stateByProjectId[P].stateBySheetId[N].sequence.focusRange)}),[s]);uo(u,uxe(s,_));let E=Xne("Shift"),T=oxe(u);return(0,Pp.useEffect)(()=>{if(!E&&T)return _.current.addBoundsHighlightLock()},[!E&&T]),jr(()=>Pp.default.createElement(n0e,{ref:l,isShiftDown:E},Pp.default.createElement($ae,{layoutP:s}),Pp.default.createElement(mL,{thumbType:"start",layoutP:s}),Pp.default.createElement(mL,{thumbType:"end",layoutP:s})),[s,b,E])},i0e=r0e}),Bv,Rp,oS,s0e,o0e,a0e,l0e,c8=k(()=>{er(),Bv=Q(qe()),Ft(),jae(),Za(),Li(),hxe(),Rp=18,oS={backgroundColor:"#1f2120eb",borderColor:"#1c1e21"},o0e=Te.div(s0e||(s0e=J([`
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: `,`px;
  box-sizing: border-box;
  background: `,`;
  border-bottom: 1px solid `,`;
  `,`;
`])),Rp,oS.backgroundColor,oS.borderColor,Di),a0e=({layoutP:s})=>{let l=Xr(s.rightDims.width);return Bv.default.createElement(Bv.default.Fragment,null,Bv.default.createElement(o0e,R({},wp("hide")),Bv.default.createElement(Gae,{layoutP:s,width:l,height:Rp}),Bv.default.createElement(i0e,{layoutP:s})))},l0e=a0e}),u8,c0e,u0e,h0e,d0e,f0e,p0e,m0e,g0e,dxe=k(()=>{u8=Q(qe()),Ft(),er(),Ae(),xD(),B5(),c0e=s=>isFinite(s)&&s>0,h0e=Te.div(u0e||(u0e=J([`
  display: flex;
  gap: 8px;
  padding: 4px 8px;
  height: 28px;
  align-items: center;
`]))),f0e=Te.div(d0e||(d0e=J([`
  `,`;
  white-space: nowrap;
`])),N9),p0e=({deltaX:s})=>s*.25,m0e=({layoutP:s})=>{let l=Xr(s.sheet),u=(0,u8.useMemo)(()=>{let _;return{temporarilySetValue(b){_&&(_.discard(),_=void 0),_=Se().tempTransaction(({stateEditors:E})=>{E.coreByProject.historic.sheetsById.sequence.setLength($(R({},l.address),{length:b}))})},discardTemporaryValue(){_&&(_.discard(),_=void 0)},permanentlySetValue(b){_&&(_.discard(),_=void 0),Se().transaction(({stateEditors:E})=>{E.coreByProject.historic.sheetsById.sequence.setLength($(R({},l.address),{length:b}))})}}},[s,l]),m=(0,u8.useRef)(null);return(0,u8.useLayoutEffect)(()=>{m.current.focus()},[]),jr(()=>{let _=l.getSequence().length;return u8.default.createElement(h0e,null,u8.default.createElement(f0e,null,"Sequence length"),u8.default.createElement(uM,$(R({value:_},u),{isValid:c0e,inputRef:m,nudge:p0e})))},[l,u,m])},g0e=m0e});function fxe(s,l){let u=(0,cc.useRef)(l);u.current=l;let m=(0,cc.useMemo)(()=>({debugName:"LengthIndicator/useDragBulge",lockCSSCursorTo:"ew-resize",onDragStart(b){let E,T=u.current,P=(0,h8.val)(u.current.layoutP.sheet),N=P.getSequence().length,z=(0,h8.val)(T.layoutP.scaledSpace.toUnitSpace);return{onDrag(G,V,B){let H=z(G);E&&(E.discard(),E=void 0),E=Se().tempTransaction(({stateEditors:j})=>{j.coreByProject.historic.sheetsById.sequence.setLength($(R({},P.address),{length:N+H}))})},onDragEnd(G){G?E&&E.commit():E&&E.discard()}}}}),[]),[_]=uo(s,m);return Bm(_,-1),[_]}var h8,cc,gL,aS,y0e,K9,v0e,_0e,x0e,b0e,S0e,w0e,E0e,T0e,M0e,C0e,A0e,pxe=k(()=>{er(),h8=mn(),cc=Q(qe()),Ft(),Hm(),c8(),Fi(),Yo(),Ae(),mp(),Za(),pv(),dxe(),Li(),yp(),gL=1e3,aS={stripNormal:"#0000006c",stripActive:"#000000"},K9=Te.div(y0e||(y0e=J([`
  position: absolute;
  top: 0;
  left: 0;
  width: 4px;
  z-index: `,`;
  pointer-events: none;

  &:after {
    display: block;
    content: ' ';
    position: absolute;
    /* top: `,`px; */
    top: 0;
    bottom: 0;
    left: -1px;
    width: 1px;
    background-color: `,`;
  }

  &:hover:after,
  &.dragging:after {
    background-color: `,`;
  }
`])),()=>Ip.lengthIndicatorStrip,Rp,aS.stripNormal,aS.stripActive),_0e=Te.div(v0e||(v0e=J([`
  position: absolute;
  top: `,`px;
  width: 100px;
  left: -50px;
  pointer-events: none;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 1;
`])),Rp-15),b0e=Te.div(x0e||(x0e=J([`
  margin-top: 8px;
  font-size: 10px;
  white-space: nowrap;
  padding: 2px 8px;
  border-radius: 2px;
  `,`;
  cursor: ew-resize;
  color: #464646;
  background-color: #0000004d;
  display: none;

  `,":hover &, ",`.dragging & {
    display: block;
    color: white;
    background-color: `,`;
  }
`])),Di,K9,K9,aS.stripActive),w0e=Te.div(S0e||(S0e=J([`
  font-size: 10px;
  white-space: nowrap;
  padding: 1px 2px;
  border-radius: 2px;
  `,`;
  justify-content: center;
  align-items: center;
  cursor: ew-resize;
  color: #5d5d5d;
  background-color: #191919;

  `,":hover &, ",`.dragging & {
    color: white;
    background-color: `,`;

    & > svg:first-child {
      margin-right: -1px;
    }
  }

  & > svg:first-child {
    margin-right: -4px;
  }
`])),Di,K9,K9,aS.stripActive),T0e=Te.div(E0e||(E0e=J([`
  position: absolute;
  top: 0;
  left: 0;
  background-color: rgb(23 23 23 / 43%);
  width: `,`px;
  z-index: `,`;
  transform-origin: left top;

  `,".dragging ~ &, ",`:hover ~ & {
    background-color: rgb(23 23 23 / 60%);
  }
`])),gL,()=>Ip.lengthIndicatorCover,K9,K9),M0e=-1e4,C0e=({layoutP:s})=>{let[l,u]=Ai(null),[m]=fxe(u,{layoutP:s}),{node:_,toggle:b,close:E}=pp({debugName:"LengthIndicator"},()=>cc.default.createElement(gp,null,cc.default.createElement(g0e,{layoutP:s,onRequestClose:E})));return jr(()=>{let T=(0,h8.val)(s.sheet),P=(0,h8.val)(s.rightDims.height),N=T.getSequence(),z=N.length,G=z,V=(0,h8.val)(s.clippedSpace.fromUnitSpace)(G),B=(0,h8.val)(s.clippedSpace.width),H,j;return V>B?(j=0,H=0):(V<0&&(V=0),j=V,H=(B-V)/gL),cc.default.createElement(cc.default.Fragment,null,_,cc.default.createElement(K9,{style:{height:P+"px",transform:"translateX(".concat(j===0?M0e:j,"px)")},className:m?"dragging":""},cc.default.createElement(_0e,null,cc.default.createElement(w0e,R({ref:l,onClick:X=>{b(X,u)}},wp("hide")),cc.default.createElement(rye,null),cc.default.createElement(iye,null)),cc.default.createElement(b0e,null,"Sequence length:"," ",N.positionFormatter.formatBasic(z)))),cc.default.createElement(T0e,{title:"Length",style:{height:P+"px",transform:"translateX(".concat(j,"px) scale(").concat(H,", 1)")}}))},[s,l,m,_])},A0e=C0e}),yL,Gm,P0e,R0e,k0e,I0e,N0e,D0e,O0e,F0e,mxe=k(()=>{er(),yL=mn(),Gm=Q(qe()),Ft(),jae(),Hm(),c8(),Za(),R0e=Te.div(P0e||(P0e=J([`
  position: absolute;
  top: 0;
  left: 0;
  margin-top: 0px;
`]))),I0e=Te.div(k0e||(k0e=J([`
  position: absolute;
  top: 16px;
  font-size: `,`;
  color: `,`;
  text-align: center;
  transform: translateX(-50%);
  background: `,`;
  padding: 1px 8px;
  font-variant-numeric: tabular-nums;
  pointer-events: none;
  z-index: `,`;
`])),q9.stampFontSize,q9.fullUnitStampColor,oS.backgroundColor,()=>Ip.currentFrameStamp),D0e=Te.div(N0e||(N0e=J([`
  position: absolute;
  top: 5px;
  left: -0px;
  bottom: 0;
  width: 0.5px;
  background: rgba(100, 100, 100, 0.2);
  pointer-events: none;
`]))),O0e=Gm.default.memo(({layoutP:s})=>{let[l,u]=Xr(vre()),m=Xr(s.clippedSpace.fromUnitSpace),{sequence:_,formatter:b,clippedSpaceWidth:E}=jr(()=>{let z=(0,yL.val)(s.sheet).getSequence(),G=(0,yL.val)(s.clippedSpace.width);return{sequence:z,formatter:z.positionFormatter,clippedSpaceWidth:G}},[s]);if(l==-1)return Gm.default.createElement(Gm.default.Fragment,null);let T=u===3?_.closestGridPosition(l):l,P=m(T),N=P>=0&&P<=E;return Gm.default.createElement(Gm.default.Fragment,null,Gm.default.createElement(R0e,null,Gm.default.createElement(I0e,{style:{opacity:N?1:0,transform:"translate3d(calc(".concat(P,"px - 50%), 0, 0)")}},b.formatForPlayhead(T)),Gm.default.createElement(D0e,{posType:u,style:{opacity:N?1:0,transform:"translate3d(".concat(P,"px, 0, 0)")}}))," ")}),F0e=O0e}),kd,xl,L0e,B0e,U0e,z0e,V0e,iA,G0e,vL,j0e,sA,H0e,oA,W0e,_L,$0e,q0e,gxe=k(()=>{er(),kd=mn(),wx(),nu(),xl=Q(qe()),Ft(),Hm(),Za(),Li(),Yo(),B0e=Te.div(L0e||(L0e=J([`
  --threadHeight: 6px;
  --bg-inactive: #32353b;
  --bg-active: #5b5c5d;
  position: absolute;
  height: 0;
  width: 100%;
  left: 12px;
  /* bottom: 8px; */
  z-index: `,`;
  `,`
`])),()=>Ip.horizontalScrollbar,Di),z0e=Te.div(U0e||(U0e=J([`
  position: relative;
  top: 0;
  left: 0;
  width: 100%;
  height: var(--threadHeight);
`]))),iA=Te.div(V0e||(V0e=J([`
  position: absolute;
  height: 5px;
  background: var(--bg-inactive);
  cursor: ew-resize;
  z-index: 2;

  &:hover,
  &:active {
    background: var(--bg-active);
  }

  &:after {
    `,`;
    display: block;
    content: ' ';
  }
`])),EN("absolute","-4px")),vL=Te.div(G0e||(G0e=J([`
  position: absolute;
  height: 5px;
  width: 7px;
  left: 0;
  z-index: 2;
  top: 0;
  bottom: 0;
  display: block;

  &:hover:before {
    background: var(--bg-active);
  }

  &:before {
    `,`;
    display: block;
    content: ' ';
    background: var(--bg-inactive);
    border-radius: 0 2px 2px 0;
  }

  &:after {
    `,`;
    display: block;
    content: ' ';
  }
`])),EN("absolute","0"),EN("absolute","-4px")),sA=Te(vL)(j0e||(j0e=J([`
  left: calc(-1 * 7px);
  cursor: w-resize;
  &:before {
    transform: scaleX(-1);
  }
`]))),oA=Te(vL)(H0e||(H0e=J([`
  cursor: e-resize;
  left: 0px;
`]))),_L=Te.div(W0e||(W0e=J([`
  display: `,`;
  position: absolute;
  top: -20px;
  left: 4px;
  padding: 0 4px;
  transform: translateX(-50%);
  background: #131d1f;
  border-radius: 4px;
  color: #fff;
  font-size: 10px;
  line-height: 18px;
  text-align: center;

  `,`:hover &,
  `,`:hover &,
  `,":hover ~ ",` &,
  `,":hover ~ ",` & {
    display: block;
  }
`])),s=>s.active?"block":"none",sA,oA,iA,sA,iA,oA),$0e=({layoutP:s})=>{let l=(0,xl.useCallback)(X=>X.toFixed(2),[]),u=(0,xl.useMemo)(()=>(0,kd.prism)(()=>{let X=(0,kd.val)(s.rightDims.width)-25,K=(0,kd.val)(s.clippedSpace.range),te=(0,kd.val)(s.sheet).getSequence().length,se=Math.max(K.end,te),pe=K.start/se*X,fe=K.end/se*X;return{rightWidth:X,clippedSpaceRange:K,sequenceLength:te,assumedLengthOfSequence:se,rangeStartX:pe,rangeEndX:fe,bottom:(0,kd.val)(s.horizontalScrollbarDims.bottom)}}),[s]),{rangeStartX:m,rangeEndX:_,clippedSpaceRange:b,bottom:E}=Xr(u),[T,P]=(0,xl.useState)("nothing"),N=(0,xl.useMemo)(()=>{let X=(0,kd.val)(u),K=()=>{X=(0,kd.val)(u)},te=se=>se/X.rightWidth*X.assumedLengthOfSequence;return{onRangeDragStart(){return K(),{onDrag(se){P("both");let pe=te(se),fe=np(X.clippedSpaceRange,ve=>ve+pe);(0,kd.val)(s.clippedSpace.setRange)(fe)},onDragEnd(){P("nothing")}}},onRangeStartDragStart(){return K(),{onDrag(se){P("start");let pe=te(se),fe={start:X.clippedSpaceRange.start+pe,end:X.clippedSpaceRange.end};fe.start>fe.end-1&&(fe.start=fe.end-1),fe.start<=0&&(fe.start=0),(0,kd.val)(s.clippedSpace.setRange)(fe)},onDragEnd(){P("nothing")}}},onRangeEndDragStart(){return K(),{onDrag(se){P("end");let pe=te(se),fe={start:X.clippedSpaceRange.start,end:X.clippedSpaceRange.end+pe};fe.end<fe.start+1&&(fe.end=fe.start+1),fe.end>=X.assumedLengthOfSequence&&(fe.end=X.assumedLengthOfSequence),(0,kd.val)(s.clippedSpace.setRange)(fe)},onDragEnd(){P("nothing")}}}}},[s,u]),[z,G]=(0,xl.useState)(null);uo(z,{debugName:"HorizontalScrollbar/onRangeDrag",onDragStart:N.onRangeDragStart,lockCSSCursorTo:"ew-resize"});let[V,B]=(0,xl.useState)(null);uo(V,{debugName:"HorizontalScrollbar/onRangeStartDrag",onDragStart:N.onRangeStartDragStart,lockCSSCursorTo:"w-resize"});let[H,j]=(0,xl.useState)(null);return uo(H,{debugName:"HorizontalScrollbar/onRangeEndDrag",onDragStart:N.onRangeEndDragStart,lockCSSCursorTo:"e-resize"}),xl.default.createElement(B0e,R({style:{bottom:E+8+"px"}},wp("hide")),xl.default.createElement(z0e,null,xl.default.createElement(iA,{ref:G,style:{width:"".concat(_-m,"px"),transform:"translate3d(".concat(m,"px, 0, 0)")}}),xl.default.createElement(sA,{ref:B,style:{transform:"translate3d(".concat(m,"px, 0, 0)")}},xl.default.createElement(_L,{active:T==="both"||T==="start"},l(b.start))),xl.default.createElement(oA,{ref:j,style:{transform:"translate3d(".concat(_,"px, 0, 0)")}},xl.default.createElement(_L,{active:T==="both"||T==="end"},l(b.end)))))},q0e=$0e}),X0e,Y0e,K0e,Z0e,Q0e,yxe=k(()=>{X0e=Q(qe()),Ft(),K0e=Te.div(Y0e||(Y0e=J([`
  position: absolute;
  inset: `,`px;
`])),s=>s.room*-1),Z0e=s=>X0e.default.createElement(K0e,{room:s.room}),Q0e=Z0e}),aA,lA,xL,J0e,ele,tle,nle,rle,ile,sle,ole,vxe=k(()=>{Ft(),er(),xD(),B5(),aA=Q(qe()),lA=Q(qe()),xL=mn(),Wf(),J0e=s=>isFinite(s)&&s>=0,tle=Te.div(ele||(ele=J([`
  display: flex;
  gap: 8px;
  padding: 4px 8px;
  height: 28px;
  align-items: center;
`]))),rle=Te.div(nle||(nle=J([`
  `,`;
  white-space: nowrap;
`])),N9),ile=({deltaX:s})=>s*.25,sle=({layoutP:s,onRequestClose:l})=>{let u=(0,xL.val)(s.sheet),m=u.getSequence(),_=(0,aA.useMemo)(()=>{let E,T=m.position;return{temporarilySetValue(P){E&&(E=void 0),E=ii(P,0,m.length),m.position=E},discardTemporaryValue(){E&&(E=void 0,m.position=T,l("discardTemporaryValue"))},permanentlySetValue(P){E&&(E=void 0),m.position=ii(P,0,m.length),l("permanentlySetValue")}}},[s,m]),b=(0,aA.useRef)(null);return(0,aA.useLayoutEffect)(()=>{b.current.focus()},[]),jr(()=>{let E=u.getSequence(),T=Number((0,xL.val)(E.pointer.position).toFixed(3));return lA.default.createElement(tle,null,lA.default.createElement(rle,null,"Sequence position"),lA.default.createElement(uM,$(R({value:T},_),{isValid:J0e,inputRef:b,nudge:ile})))},[u,_,b])},ole=sle}),ale,_xe=k(()=>{ale=typeof navigator<"u"&&navigator.platform.toUpperCase().indexOf("MAC")>=0}),lle,xxe=k(()=>{_xe(),lle=s=>ale?s.metaKey===!0:s.ctrlKey===!0});function bxe(){cA=!1}function Sxe(){cA=!0}function wxe(){let s=Se();(0,cle.useEffect)(()=>{let l=u=>{let m=u.composedPath()[0];if(!(m&&(m.tagName==="INPUT"||m.tagName==="TEXTAREA"))){if(u.key==="z"||u.key==="Z"||u.code==="KeyZ")if(lle(u))u.shiftKey===!0?s.redo():s.undo();else return;else if(u.code==="Space"&&!u.shiftKey&&!u.metaKey&&!u.altKey&&!u.ctrlKey){if(!cA)return;let _=M6e();if(_)if(_.playing)_.pause();else{let{projectId:b,sheetId:E}=_.address,T=(0,Id.prism)(()=>{let z=(0,Id.val)(Se().atomP.ahistoric.projects.stateByProjectId[b].stateBySheetId[E].sequence.focusRange);return Id.prism.memo("shouldFollowFocusRange",()=>{let G=_.position;if(z){let V=G>=z.range.start&&G<=z.range.end;return z.enabled?!!V:!0}else return!0},[])&&z&&z.enabled?{range:[z.range.start,z.range.end],isFollowingARange:!0}:{range:[0,(0,Id.val)(_.pointer.length)],isFollowingARange:!1}}),P=_.playDynamicRange((0,Id.prism)(()=>(0,Id.val)(T).range),Se().ticker),N=bL(_);P.finally(()=>{N.set(void 0)}),N.set(T)}else return}else if(u.altKey&&(u.key==="\\"||u.code==="Backslash"||u.code==="IntlBackslash"))s.transaction(({stateEditors:_,drafts:b})=>{_.studio.ahistoric.setVisibilityState(b.ahistoric.visibilityState==="everythingIsHidden"?"everythingIsVisible":"everythingIsHidden")});else return;u.preventDefault(),u.stopPropagation()}};return window.addEventListener("keydown",l),()=>{window.removeEventListener("keydown",l)}},[])}var cle,Id,cA,bL,ule,SL=k(()=>{cle=Q(qe()),Ae(),xxe(),A9(),Id=mn(),AM(),cA=!0,bL=gb(s=>new Id.Atom(void 0)),ule=gb(s=>(0,Id.prism)(()=>{let l=bL(s).prism.getValue();if(l)return l.getValue().isFollowingARange;{let{projectId:u,sheetId:m}=s.address,_=(0,Id.val)(Se().atomP.ahistoric.projects.stateByProjectId[u].stateBySheetId[m].sequence.focusRange);if(!_||!_.enabled)return!1;let b=(0,Id.val)(s.pointer.position);return b>=_.range.start&&b<=_.range.end}}))});function Exe(s,l){return ml(s,{menuItems(){return[{label:"Place marker",callback:()=>{Se().transaction(({stateEditors:u})=>{let m=(0,kp.val)(l.layoutP.sheet),_=m.getSequence();u.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.replaceMarkers({sheetAddress:m.address,markers:[{id:uve(),position:_.position}],snappingFunction:_.closestGridPosition})})}}]}})}var kp,uh,hle,d8,dle,fle,ple,wL,mle,gle,yle,vle,_le,xle,Txe=k(()=>{yxe(),Yo(),Fi(),er(),kp=mn(),Wf(),uh=Q(qe()),Ft(),Hm(),Za(),Li(),mp(),yp(),vxe(),SL(),ru(),gl(),Ae(),Dm(),Rd(),q5(),d8=Te.div(hle||(hle=J([`
  --thumbColor: #00e0ff;
  position: absolute;
  top: 0;
  left: 0;
  width: 5px;
  height: 100%;
  z-index: `,`;
  pointer-events: none;

  display: `,`;
`])),()=>Ip.playhead,s=>s.isVisible?"block":"none"),fle=Te.div(dle||(dle=J([`
  position: absolute;
  top: 8px;
  width: 0;
  height: calc(100% - 8px);
  border-left: 1px solid #27e0fd;
  z-index: 10;
  pointer-events: none;

  #pointer-root.draggingPositionInSequenceEditor &:not(.seeking) {
    /* pointer-events: auto; */
    /* cursor: var(`,`); */

    &:after {
      position: absolute;
      inset: -8px;
      display: block;
      content: ' ';
    }
  }
`])),Pm),wL=Te.div(ple||(ple=J([`
  background-color: var(--thumbColor);
  position: absolute;
  width: 5px;
  height: 13px;
  top: -4px;
  left: -2px;
  z-index: 11;
  cursor: ew-resize;
  --sunblock-color: #1f2b2b;

  `,`;

  `,`.seeking > & {
    pointer-events: none !important;
  }

  #pointer-root.draggingPositionInSequenceEditor
    `,`:not(.seeking)
    > & {
    pointer-events: auto;
    cursor: var(`,`);
  }

  `,`.playheadattachedtofocusrange > & {
    top: -8px;
    --sunblock-color: #005662;
    &:before,
    &:after {
      border-bottom-width: 8px;
    }
  }

  &:before {
    position: absolute;
    display: block;
    content: ' ';
    left: -2px;
    width: 0;
    height: 0;
    border-bottom: 4px solid var(--sunblock-color);
    border-left: 2px solid transparent;
  }

  &:after {
    position: absolute;
    display: block;
    content: ' ';
    right: -2px;
    width: 0;
    height: 0;
    border-bottom: 4px solid var(--sunblock-color);
    border-right: 2px solid transparent;
  }
`])),Di,d8,d8,Pm,d8),gle=Te.div(mle||(mle=J([`
  position: absolute;
  left: 1px;
  right: 1px;
  top: 13px;
  border-top: 3px solid var(--thumbColor);
  border-right: 1px solid transparent;
  border-left: 1px solid transparent;
  pointer-events: none;

  /* `,`.playheadattachedtofocusrange & {
    top: 10px;
    &:before,
    &:after {
      height: 15px;
    }
  } */

  &:before {
    position: absolute;
    display: block;
    content: ' ';
    top: -4px;
    left: -2px;
    height: 8px;
    width: 2px;
    background: none;
    border-radius: 0 100% 0 0;
    border-top: 1px solid var(--thumbColor);
    border-right: 1px solid var(--thumbColor);
  }

  &:after {
    position: absolute;
    display: block;
    content: ' ';
    top: -4px;
    right: -2px;
    height: 8px;
    width: 2px;
    background: none;
    border-radius: 100% 0 0 0;
    border-top: 1px solid var(--thumbColor);
    border-left: 1px solid var(--thumbColor);
  }
`])),d8),vle=Te.div(yle||(yle=J([`
  display: none;
  position: absolute;
  top: -20px;
  left: 4px;
  padding: 0 2px;
  transform: translateX(-50%);
  background: #1a1a1a;
  border-radius: 4px;
  color: #fff;
  font-size: 10px;
  line-height: 18px;
  text-align: center;
  `,":hover &, ",`.seeking & {
    display: block;
  }
`])),wL,d8),_le=({layoutP:s})=>{let[l,u]=Ai(null),{node:m,toggle:_,close:b}=pp({debugName:"Playhead"},()=>uh.default.createElement(gp,null,uh.default.createElement(ole,{layoutP:s,onRequestClose:b}))),E=(0,uh.useMemo)(()=>({debugName:"RightOverlay/Playhead",onDragStart(){let N=(0,kp.val)(s.sheet).getSequence(),z=N.position,G=(0,kp.val)(s.scaledSpace.toUnitSpace),V=(0,kp.val)(s.seeker.setIsSeeking);return V(!0),oF(),{onDrag(B,H,j){var X;let K=G(B);N.position=(X=yl.checkIfMouseEventSnapToPos(j,{ignore:u}))!=null?X:ii(z+K,0,N.length)},onDragEnd(B){V(!1),$5()},onClick(B){_(B,l.current)}}}}),[s,u]),[T]=uo(u,E);rh(T,"draggingPositionInSequenceEditor","ew-resize"),Bm(Xr(s.seeker.isSeeking)||T,-1);let[P]=Exe(u,{layoutP:s});return jr(()=>{let N=(0,kp.val)(s.seeker.isSeeking),z=(0,kp.val)(s.sheet).getSequence(),G=(0,kp.val)(ule(z)),V=z.positionPrism.getValue(),B=(0,kp.val)(s.clippedSpace.fromUnitSpace)(V),H=B>=0&&B<=(0,kp.val)(s.clippedSpace.width);return uh.default.createElement(uh.default.Fragment,null,P,m,uh.default.createElement(d8,R({isVisible:H,style:{transform:"translate3d(".concat(B,"px, 0, 0)")},className:"".concat(N&&"seeking"," ").concat(G&&"playheadattachedtofocusrange")},wp("hide")),uh.default.createElement(wL,R({ref:l},yl.includePositionSnapAttrs(V)),uh.default.createElement(Q0e,{room:8}),uh.default.createElement(gle,null),uh.default.createElement(vle,null,z.positionFormatter.formatForPlayhead(z.closestGridPosition(V)))),uh.default.createElement(fle,$(R({},yl.includePositionSnapAttrs(V)),{className:N?"seeking":""}))))},[s,l,m])},xle=_le}),f8,lS,uA,ble,Sle,wle,Ele,Mxe=k(()=>{f8=mn(),er(),Ae(),c8(),lS=Q(qe()),Ft(),uA=1e3,Sle=Te.div(ble||(ble=J([`
  position: absolute;
  top: `,`px;
  left: 0;
  opacity: 0.15;
  width: `,`px;
  transform-origin: top left;
  pointer-events: none;
  background-color: `,`;
`])),Rp,uA,s=>s.enabled?"#000000":"transparent"),wle=({layoutP:s})=>{let l=(0,lS.useMemo)(()=>(0,f8.prism)(()=>{let{projectId:u,sheetId:m}=(0,f8.val)(s.sheet).address;return(0,f8.val)(Se().atomP.ahistoric.projects.stateByProjectId[u].stateBySheetId[m].sequence.focusRange)}),[s]);return jr(()=>{let u=l.getValue();if(!u||!u.enabled)return null;let{range:m}=u,_=(0,f8.val)(s.rightDims.height)-Rp,b=(0,f8.val)(s.clippedSpace.fromUnitSpace),E=(0,f8.val)(s.clippedSpace.width),T=[];{let P=0,N=b(u.range.start),z,G;P>N?(G=0,z=0):(N>E&&(N=E),G=P,z=(N-P)/uA),T.push({translateX:G,scaleX:z})}{let P=b(u.range.end),N=E,z,G;P>N?(G=0,z=0):(P<0&&(P=0),G=P,z=(N-P)/uA),T.push({translateX:G,scaleX:z})}return lS.default.createElement(lS.default.Fragment,null,T.map(({translateX:P,scaleX:N},z)=>lS.default.createElement(Sle,{key:"curtain-".concat(z),enabled:!0,style:{height:"".concat(_,"px"),transform:"translateX(".concat(P,"px) scaleX(").concat(N,")")}})))},[s,l])},Ele=wle}),Uv,Tle,Mle,Cle,Ale,Ple,Cxe=k(()=>{Uv=Q(qe()),Ft(),er(),Ae(),B5(),CD(),Mle=Te.div(Tle||(Tle=J([`
  display: flex;
  gap: 8px;
  /* padding: 4px 8px; */
  height: 28px;
  align-items: center;
`]))),Te.div(Cle||(Cle=J([`
  `,`;
  white-space: nowrap;
`])),N9),Ale=({layoutP:s,marker:l})=>{var u;let m=Xr(s.sheet),_=(0,Uv.useMemo)(()=>{let E;return{temporarilySetValue(T){E&&(E.discard(),E=void 0),E=Se().tempTransaction(({stateEditors:P})=>{P.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.updateMarker({sheetAddress:m.address,markerId:l.id,label:T})})},discardTemporaryValue(){E&&(E.discard(),E=void 0)},permanentlySetValue(T){E&&(E.discard(),E=void 0),Se().transaction(({stateEditors:P})=>{P.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.updateMarker({sheetAddress:m.address,markerId:l.id,label:T})})}}},[s,m]),b=(0,Uv.useRef)(null);return(0,Uv.useLayoutEffect)(()=>{b.current.focus()},[]),Uv.default.createElement(Mle,null,Uv.default.createElement(dM,$(R({value:(u=l.label)!=null?u:""},_),{isValid:()=>!0,inputRef:b})))},Ple=Ale});function Axe(s,l){return ml(s,{menuItems(){return[{label:"Remove marker",callback:()=>{Se().transaction(({stateEditors:u})=>{u.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.removeMarker({sheetAddress:l.sheetAddress,markerId:l.markerId})})}}]}})}function Pxe(s,l){let u=(0,bl.useRef)(l);u.current=l;let m=(0,bl.useMemo)(()=>({debugName:"MarkerDot/useDragMarker (".concat(l.marker.id,")"),onDragStart(b){let E=u.current.marker,T=(0,hA.val)(l.layoutP.scaledSpace.toUnitSpace),P;return oF(),{onDrag(N,z,G){var V;let B=E,H=Math.max((V=yl.checkIfMouseEventSnapToPos(G,{ignore:s}))!=null?V:B.position+T(N),0);P==null||P.discard(),P=Se().tempTransaction(({stateEditors:j})=>{j.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.replaceMarkers({sheetAddress:(0,hA.val)(l.layoutP.sheet.address),markers:[$(R({},B),{position:H})],snappingFunction:(0,hA.val)(l.layoutP.sheet).getSequence().closestGridPosition})})},onDragEnd(N){N?P==null||P.commit():P==null||P.discard(),$5()}}}}),[]),[_]=uo(s,m);return Bm(_,l.marker.position),rh(_,"draggingPositionInSequenceEditor draggingMarker","ew-resize"),[_]}var hA,bl,EL,TL,Rle,kle,Ile,Nle,Dle,dA,Ole,Fle,Lle,Ble,Ule,zle,Rxe=k(()=>{hA=mn(),er(),Ae(),ru(),gl(),Fi(),bl=Q(qe()),Ft(),Za(),Yo(),Hm(),Rd(),yC(),Tre(),q5(),mp(),yp(),Cxe(),EL=12,TL=12,Rle=EL*2,kle=TL*2,Nle=Te.div(Ile||(Ile=J([`
  position: absolute;
  // below the sequence ruler "top bar"
  top: 18px;
  z-index: `,`;
`])),()=>Ip.marker),dA=Te.div(Dle||(Dle=J([`
  position: absolute;
  `,`
  pointer-events: none;
`])),oh(EL,TL)),Ole=bl.default.memo(()=>bl.default.createElement(dA,{children:bl.default.createElement("svg",{width:"100%",height:"100%",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},bl.default.createElement("path",{d:"M12 5H0V7H2.71973L5.96237 10.2426L9.20501 7H12V5Z",fill:"#40AAA4"}))})),Lle=Te.div(Fle||(Fle=J([`
  z-index: 1;
  cursor: ew-resize;

  `,`

  // :not dragging marker to ensure that markers don't snap to other markers
  // this works because only one marker track (so this technique is not used by keyframes...)
  #pointer-root.draggingPositionInSequenceEditor:not(.draggingMarker) & {
    `,`
  }

  // "All instances of this component <Mark/> inside #pointer-root when it has the .draggingPositionInSequenceEditor class"
  // ref: https://styled-components.com/docs/basics#pseudoelements-pseudoselectors-and-nesting
  #pointer-root.draggingPositionInSequenceEditor:not(.draggingMarker) &,
  #pointer-root.draggingPositionInSequenceEditor
    &.`,` {
    pointer-events: auto;
    cursor: var(`,`);
  }

  &:hover
    + `,`,
    // notice , "or" in CSS
    &.`,`
    + `,` {
    `,`
  }
`])),Ep.CSS,Ep.CSS_WHEN_SOMETHING_DRAGGING,Ep.BEING_DRAGGED_CLASS,Pm,dA,Ep.BEING_DRAGGED_CLASS,dA,oh(Rle,kle)),Ble=({layoutP:s,markerId:l})=>{let u=Xr(s.sheet.address),m=Xr(Se().atomP.historic.projects.stateByProjectId[u.projectId].stateBySheetId[u.sheetId].sequenceEditor.markerSet.byId[l]);if(!m)return null;let _=Xr(s.clippedSpace.width),b=Xr(s.clippedSpace.fromUnitSpace)(m.position),E=b<=0||b>_,T=E?-1e4:b,P=E?0:1;return bl.default.createElement(Nle,{style:{transform:"translateX(".concat(T,"px) scale(").concat(P,")")}},bl.default.createElement(zle,{marker:m,layoutP:s}))},Ule=Ble,zle=({layoutP:s,marker:l})=>{let u=Xr(s.sheet.address),[m,_]=Ai(null),[b]=Axe(_,{sheetAddress:u,markerId:l.id}),[E]=Pxe(_,{layoutP:s,marker:l}),{node:T,toggle:P,close:N}=pp({debugName:"MarkerPopover"},()=>bl.default.createElement(gp,null,bl.default.createElement(Ple,{marker:l,layoutP:s,onRequestClose:N})));return bl.default.createElement(bl.default.Fragment,null,b,T,bl.default.createElement(Lle,R({title:l.label?"Marker: ".concat(l.label):"Marker",ref:m,onClick:z=>{P(z,m.current)}},Ep.reactProps({isDragging:E,position:l.position}))),bl.default.createElement(Ole,null))}}),fA,Vle,Gle,kxe=k(()=>{er(),Ae(),fA=Q(qe()),Rxe(),Vle=({layoutP:s})=>{let l=Xr(s.sheet.address),u=Se().atomP.historic.projects.stateByProjectId[l.projectId].stateBySheetId[l.sheetId].sequenceEditor.markerSet,m=Xr(u.allIds);return fA.default.createElement(fA.default.Fragment,null,m&&Object.keys(m).map(_=>fA.default.createElement(Ule,{key:_,layoutP:s,markerId:_})))},Gle=Vle}),jle,jm,Hle,Wle,$le,qle,Ixe=k(()=>{Hm(),er(),jle=mn(),jm=Q(qe()),Ft(),pxe(),mxe(),gxe(),Txe(),c8(),Mxe(),kxe(),Wle=Te.div(Hle||(Hle=J([`
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  z-index: `,`;
  overflow: visible;
  pointer-events: none;
`])),()=>Ip.rightOverlay),$le=({layoutP:s})=>jr(()=>{let l=(0,jle.val)(s.rightDims.width);return jm.default.createElement(Wle,{style:{width:l+"px"}},jm.default.createElement(xle,{layoutP:s}),jm.default.createElement(q0e,{layoutP:s}),jm.default.createElement(F0e,{layoutP:s}),jm.default.createElement(l0e,{layoutP:s}),jm.default.createElement(Gle,{layoutP:s}),jm.default.createElement(A0e,{layoutP:s}),jm.default.createElement(Ele,{layoutP:s}))},[s]),qle=$le}),Xle,pA,Yle,Kle,Zle,Qle,Nxe=k(()=>{Xle=mn(),er(),Ae(),pA=Q(qe()),Ft(),pv(),Za(),Kle=Te.button(Yle||(Yle=J([`
  outline: none;
  background-color: #1c1d21;
  border: 1px solid #191919;
  border-radius: 2px;
  display: flex;
  bottom: 14px;
  right: 8px;
  z-index: 1;
  position: absolute;

  padding: 4px 8px;
  display: flex;
  color: #656d77;
  line-height: 20px;
  font-size: 10px;

  &:hover {
    color: white;
  }

  & > svg {
    transition: transform 0.3s;
    transform: rotateZ(0deg);
  }

  &:hover > svg {
    transform: rotateZ(-20deg);
  }

  &.open > svg {
    transform: rotateZ(-180deg);
  }

  &.open:hover > svg {
    transform: rotateZ(-160deg);
  }
`]))),Zle=({layoutP:s})=>{let l=Xr(s.graphEditorDims.isOpen),u=(0,pA.useCallback)(()=>{let m=(0,Xle.val)(s.graphEditorDims.isOpen);Se().transaction(({stateEditors:_})=>{_.studio.historic.panels.sequenceEditor.graphEditor.setIsOpen({isOpen:!m})})},[s]);return pA.default.createElement(Kle,R({onClick:u,title:"Toggle graph editor",className:l?"open":""},wp("hide")),pA.default.createElement(bye,null))},Qle=Zle}),Nd,Xs,Jle,ece,tce,nce,Ip,rce,ice,sce,oce,ace,lce,cce,uce,hce,Hm=k(()=>{A9(),er(),Dne(),Nd=mn(),Xs=Q(qe()),Ft(),X_e(),JC(),ixe(),Ixe(),Cv(),Ute(),pne(),Za(),ai(),Fo(),Nxe(),Cm(),z5(),ece=Te(WO)(Jle||(Jle=J([`
  z-index: `,`;
  box-shadow: 2px 2px 0 rgb(0 0 0 / 11%);
`])),ov.sequenceEditorPanel),nce=Te.div(tce||(tce=J([`
  background-color: rgba(40, 43, 47, 0.99);
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  z-index: -1;
  pointer-events: none;
`]))),Ip=(()=>{let s={rightBackground:0,scrollableArea:0,rightOverlay:0,lengthIndicatorCover:0,lengthIndicatorStrip:0,playhead:0,currentFrameStamp:0,marker:0,horizontalScrollbar:0},l=-1;for(let u of Object.keys(s))s[u]=l,l++;return s})(),ice=Te(UO)(rce||(rce=J([`
  position: absolute;
  left: 0;
  top: 0;
  z-index: 1;
`]))),sce={edges:{left:{from:"screenLeft",distance:.1},right:{from:"screenRight",distance:.2},top:{from:"screenBottom",distance:.4},bottom:{from:"screenBottom",distance:.01}}},oce={width:800,height:200},ace=s=>Xs.default.createElement(BO,{panelId:"sequenceEditor",defaultPosition:sce,minDims:oce},Xs.default.createElement(lce,null)),lce=()=>{let{dims:s}=Mv(),[l,u]=(0,Xs.useState)(null);return JZ(l),jr(()=>{let m=Nd.prism.memo("panelSize",()=>{let V=s.width,B=s.height;return{width:V,height:B,widthWithoutBorder:V-2,heightWithoutBorder:B-4,screenX:s.left,screenY:s.top}},[s]),_=ip(C9().filter(V=>Dt(V)||qt(V)).map(V=>qt(V)?V.sheet:V));if(ip(_.map(V=>V.template)).length!==1)return Xs.default.createElement(Xs.default.Fragment,null);let b=_[0];if(!b)return Xs.default.createElement(Xs.default.Fragment,null);let E=qO("panelSizeP",m).pointer,T=Nd.prism.memo("key",()=>JSON.stringify(b.address),[b]),P=Nd.prism.memo("layout",()=>rxe(b,E),[b,E]).getValue();if((0,Nd.val)(P.tree.children).length===0)return Xs.default.createElement(Xs.default.Fragment,null);let N=Nd.prism.memo("containerRef",hce,[]),z=(0,Nd.val)(P.graphEditorDims.isAvailable),G=(0,Nd.val)(P.graphEditorDims.isOpen);return Xs.default.createElement(ece,{ref:V=>{N(V),V!==l&&u(V)}},Xs.default.createElement(nce,{style:{width:"".concat((0,Nd.val)(P.leftDims.width),"px")}}),Xs.default.createElement(bre,{layoutP:P},Xs.default.createElement(cce,{layoutP:P}),Xs.default.createElement(Cae,{key:T+"-dopeSheet",layoutP:P}),G&&Xs.default.createElement(Yoe,{key:T+"-graphEditor",layoutP:P}),z&&Xs.default.createElement(Qle,{layoutP:P}),Xs.default.createElement(qle,{layoutP:P})))},[s,l])},cce=({layoutP:s})=>jr(()=>{let l=(0,Nd.val)(s.sheet);return Xs.default.createElement(ice,{style:{width:(0,Nd.val)(s.leftDims.width)}},Xs.default.createElement(qN,null,Xs.default.createElement(M9,null,l.address.sheetId," "),Xs.default.createElement(nb,null,":",""),Xs.default.createElement(M9,null,l.address.sheetInstanceId," "),Xs.default.createElement(nb,null,"",">",""),Xs.default.createElement(M9,null,"Sequence")))},[s]),uce=ace,hce=()=>{let s=null,l={passive:!1,capture:!1},u=m=>{Math.abs(m.deltaY)<Math.abs(m.deltaX)&&(m.preventDefault(),m.stopPropagation())};return m=>{s!==m&&s&&s.removeEventListener("wheel",u,l),s=m,m&&m.addEventListener("wheel",u,l)}}}),p8,dce,fce,Dxe=k(()=>{F6e(),OO(),p8=Q(qe()),Ae(),er(),Kve(),Hm(),dce=()=>{let s=Xr(Se().paneManager.allPanesD),l=Object.entries(s).map(([u,m])=>p8.default.createElement(Nne,{key:"pane-".concat(u),paneInstance:m}));return p8.default.createElement(p8.default.Fragment,null,l,p8.default.createElement(xX,null),p8.default.createElement(Dte,null),p8.default.createElement(uce,null))},fce=dce}),pce,mce,gce,Oxe=k(()=>{Ft(),YM(),mce=Te(wv)(pce||(pce=J([`
  --popover-outer-stroke: #e11c1c;
  --popover-inner-stroke: #2c1c1c;
  --popover-bg: #2c1c1c;
  pointer-events: none !important;
`]))),gce=mce}),Fxe=ie((s,l)=>{var u,m;u=[],m=[];function _(b,E,T){var P,N,z,G,V,B,H,j;if(b===E)return 0;if(P=b.length,N=E.length,P===0)return N;if(N===0)return P;for(T&&(b=b.toLowerCase(),E=E.toLowerCase()),H=0;H<P;)m[H]=b.charCodeAt(H),u[H]=++H;for(j=0;j<N;)for(z=E.charCodeAt(j),G=V=j++,H=-1;++H<P;)B=z===m[H]?V:V+1,V=u[H],u[H]=G=V>G?B>G?G+1:B:B>V?V+1:B;return G}l.exports=_}),Lxe=ie((s,l)=>{var u=Fxe();function m(){var _,b,E,T,P,N=0,z=arguments[0],G=arguments[1],V=G.length,B=arguments[2];B&&(T=B.threshold,P=B.ignoreCase),T===void 0&&(T=0);for(var H=0;H<V;++H)P?b=u(z,G[H],!0):b=u(z,G[H]),b>z.length?_=1-b/G[H].length:_=1-b/z.length,_>N&&(N=_,E=G[H]);return N>=T?E:null}l.exports=m});function Bxe(s,l,u="Did you mean ",m="?"){let _=(0,yce.default)(s,l,{threshold:.7});return _?u+JSON.stringify(_)+m:""}var yce,Uxe=k(()=>{yce=Q(Lxe())});function vce(s,l){return s.length<=l?s:s.substr(0,l-3)+"..."}var zxe=k(()=>{}),_ce,ML,xce=k(()=>{zxe(),_ce=s=>typeof s=="string"?'string("'.concat(vce(s,10),'")'):typeof s=="number"?"number(".concat(vce(String(s),10),")"):s===null?"null":s===void 0?"undefined":typeof s=="boolean"?String(s):Array.isArray(s)?"array":typeof s=="object"?"object":"unknown",ML=_ce}),bce,Sce,CL,wce=k(()=>{Ft(),O5(),Sce=Te(nq)(bce||(bce=J([`
  display: flex;
  height: fit-content;
  backdrop-filter: blur(14px);
  border-radius: 2px;
`]))),CL=Sce}),zv,Ece,Tce,Mce,Vv,cS=k(()=>{Ft(),Li(),zv=Q(qe()),kb(),lM(),Dee(),wce(),Tce=Te.button(Ece||(Ece=J([`
  `,`;
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  font-weight: 600;
  width: 32px;
  height: 32px;
  outline: none;

  color: #a8a8a9;

  background: rgba(40, 43, 47, 0.8);
  backdrop-filter: blur(14px);
  border: none;
  border-bottom: 1px solid rgba(255, 255, 255, 0.08);
  border-radius: 2px;

  svg {
    display: block;
  }

  &:hover {
    background: rgba(59, 63, 69, 0.8);
  }

  &:active {
    background: rgba(82, 88, 96, 0.8);
  }

  &.selected {
    color: rgba(255, 255, 255, 0.8);
    border-bottom: 1px solid rgba(255, 255, 255, 0.7);
  }

  // Don't blur if in a button group, because it already blurs. We need to blur
  // on the group-level, otherwise we get seams.
  `,` > & {
    backdrop-filter: none;
    filter: none;
    border-radius: 0;

    &:first-child {
      border-top-left-radius: 2px;
      border-bottom-left-radius: 2px;
    }

    &:last-child {
      border-bottom-right-radius: 2px;
      border-top-right-radius: 2px;
    }
  }

  @supports not (backdrop-filter: blur()) {
    background: rgba(40, 43, 47, 0.95);
  }
`])),Di,CL),Mce=zv.default.forwardRef((s,l)=>{var u=s,{title:m}=u,_=Z(u,["title"]);let[b,E]=Sv({enabled:typeof m=="string"},()=>zv.default.createElement(MO,null,m));return zv.default.createElement(zv.default.Fragment,null,b,zv.default.createElement(Tce,R({ref:aM([E,l])},_))," ")}),Vv=Mce}),Cce,Ace,Pce,Rce,kce,Vxe=k(()=>{Cce=Q(qe()),cS(),Ft(),Li(),Pce=Te(Vv)(Ace||(Ace=J([`
  `,`;
  & > svg {
    width: 1em;
    height: 1em;
    pointer-events: none;
  }
`])),Di),Rce=({config:s,testId:l})=>{var u;return Cce.default.createElement(Pce,{onClick:s.onClick,"data-testid":l,title:s.title,dangerouslySetInnerHTML:{__html:(u=s.svgSource)!=null?u:""}})},kce=Rce});function Gxe({value:s,label:l,icon:u,onClick:m,isSelected:_}){return Gv.default.createElement(Gv.default.Fragment,null,Gv.default.createElement(Vv,{forwardedAs:J$,className:_?"selected":void 0,"aria-label":l,onClick:m,title:l},u))}var Gv,Ice,Nce,jxe=k(()=>{Gv=Q(qe()),O5(),cS(),wce(),Ice=({value:s,onChange:l,options:u})=>Gv.default.createElement(CL,null,u.map(({label:m,icon:_,value:b})=>Gv.default.createElement(Gxe,{key:b,value:b,isSelected:s===b,label:m,icon:_,onClick:()=>l(b)}))),Nce=Ice}),AL,Dce,Oce,Fce,Lce,Hxe=k(()=>{AL=Q(qe()),Ft(),Li(),jxe(),Oce=Te.div(Dce||(Dce=J([`
  `,`;
  & > svg {
    width: 1em;
    height: 1em;
    pointer-events: none;
  }
`])),Di),Fce=({config:s})=>AL.default.createElement(Nce,{onChange:s.onChange,options:s.options.map(({label:l,value:u,svgSource:m})=>({label:l,value:u,icon:AL.default.createElement(Oce,{dangerouslySetInnerHTML:{__html:m}})})),value:s.value}),Lce=Fce}),uS,Bce,Uce,zce,Vce,Wxe=k(()=>{uS=Q(qe()),Ft(),Li(),cS(),jZ(),mp(),Uce=Te.div(Bce||(Bce=J([`
  `,`;
  & > svg {
    width: 1em;
    height: 1em;
    pointer-events: none;
  }
`])),Di),zce=({config:s})=>{let l=(0,uS.useRef)(null),u=pp(()=>{let m=l.current.getBoundingClientRect();return{debugName:"ExtensionFlyoutMenu:"+s.label,constraints:{maxX:m.right,maxY:8,minX:m.left,minY:8},verticalGap:2}},()=>uS.default.createElement(nO,{items:s.items.map((m,_)=>({label:m.label,callback:()=>{var b;try{(b=m.onClick)==null||b.call(m)}catch(E){console.error(E)}}})),onRequestClose:()=>{u.close("clicked")}}));return uS.default.createElement(Uce,null,u.node,uS.default.createElement(Vv,{ref:l,onClick:m=>{u.open(m,l.current)}},s.label))},Vce=zce});function $xe(s){return PL[s]}var hS,Gce,PL,jce,Hce,qxe=k(()=>{Uxe(),xce(),hS=Q(qe()),Vxe(),Hxe(),Wxe(),Gce=s=>hS.default.createElement(hS.default.Fragment,null,s.config.map((l,u)=>hS.default.createElement(jce,{config:l,key:u}))),PL={Icon:kce,Switch:Lce,Flyout:Vce},jce=({config:s})=>{let l=$xe(s.type);if(!l)throw new Error("No tool with tool.type ".concat(ML(s.type)," exists. Did you mean ").concat(Bxe(s.type,Object.keys(PL))));return hS.default.createElement(l,{config:s})},Hce=Gce}),Wce,Np,$ce,qce,Xce,RL,Yce,Kce,kL,Zce=k(()=>{Wce=mn(),er(),Ae(),Np=Q(qe()),Ft(),qxe(),qce=Te.div($ce||($ce=J([`
  height: 36px;
  /* pointer-events: none; */

  display: flex;
  gap: 0.5rem;
  justify-content: center;
`]))),RL=Te.div(Xce||(Xce=J([`
  position: abolute;
  height: 32px;
  width: 1px;
  background: #373b40;
  opacity: 0.4;
`]))),Yce=({extension:s,toolbarId:l})=>{var u;let m=(0,Np.useMemo)(()=>new Wce.Atom([]),[]),_=(u=s.toolbars)==null?void 0:u[l];(0,Np.useLayoutEffect)(()=>{let E=_==null?void 0:_(m.set.bind(m),Se().publicApi);if(typeof E=="function")return E},[s,l,_]);let b=Xr(m.prism);return Np.default.createElement(Hce,{config:b})},Kce=({toolbarId:s,showLeftDivider:l})=>{var u;let m=[],_=Xr(Se().atomP.ephemeral.extensions.byId),b=!1;for(let[,E]of Object.entries(_))!E||!((u=E.toolbars)!=null&&u[s])||(m.push(Np.default.createElement(Np.default.Fragment,{key:"extensionToolbar-"+E.id},b?Np.default.createElement(RL,null):void 0,Np.default.createElement(Yce,{extension:E,toolbarId:s}))),b=!0);return m.length===0?null:Np.default.createElement(qce,{"data-testid":"theatre-extensionToolbar-".concat(s)},l?Np.default.createElement(RL,null):void 0,m)},kL=Kce}),dS,Qce,Jce,eue,mA,Xxe=k(()=>{Ft(),dS=Q(qe()),cS(),Jce=Te(Vv)(Qce||(Qce=J([`
  color: `,`;

  border-bottom: 1px solid
    `,`;
`])),({pinned:s})=>s?"rgba(255, 255, 255, 0.8)":"#A8A8A9",({pinned:s})=>s?"rgba(255, 255, 255, 0.7)":"rgba(255, 255, 255, 0.08)"),eue=(0,dS.forwardRef)((s,l)=>{var u=s,{children:m,hint:_,pinned:b,icon:E,pinHintIcon:T,unpinHintIcon:P}=u,N=Z(u,["children","hint","pinned","icon","pinHintIcon","unpinHintIcon"]);let[z,G]=(0,dS.useState)(!1),V=z||_;return dS.default.createElement(Jce,$(R({},N),{pinned:b,ref:l,onMouseOver:()=>G(!0),onMouseOut:()=>G(!1)}),dS.default.createElement("div",{style:{pointerEvents:"none",width:"fit-content",height:"fit-content",inset:0}},V&&!b?T:V&&b?P:E),m)}),mA=eue});function Yxe(s){return IL.createElement("svg",R({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s),IL.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.732 4.048l-.792-.792L7.2 8l4.74 4.744.792-.792L8.781 8l3.951-3.952zm-3.932 0l-.792-.792L3.268 8l4.74 4.744.792-.792L4.848 8 8.8 4.048z",fill:"currentColor"}))}var IL,NL,Kxe=k(()=>{IL=Q(qe()),NL=Yxe});function Zxe(s){return DL.createElement("svg",R({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s),DL.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.694 3.765l.792-.792 4.74 4.744-4.74 4.744-.792-.793 3.951-3.951-3.951-3.952zm3.932 0l.792-.792 4.74 4.744-4.74 4.744-.792-.793 3.952-3.951-3.952-3.952z",fill:"currentColor"}))}var DL,OL,Qxe=k(()=>{DL=Q(qe()),OL=Zxe}),Zo,tue,nue,rue,FL,iue,Z9,sue,oue,aue,lue,cue,uue,hue,due,fue,gA,pue,mue,LL,BL,gue,yue,Jxe=k(()=>{er(),Ae(),Zo=Q(qe()),Ft(),nue=Te.div(tue||(tue=J([`
  width: 138px;
  border-radius: 2px;
  background-color: rgba(42, 45, 50, 0.9);
  position: absolute;
  display: flex;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  box-shadow: 0px 1px 1px rgba(0, 0, 0, 0.25), 0px 2px 6px rgba(0, 0, 0, 0.15);
  backdrop-filter: blur(14px);
  pointer-events: auto;
  // makes the edges of the item highlights match the rounded corners
  overflow: hidden;

  @supports not (backdrop-filter: blur()) {
    background-color: rgba(42, 45, 50, 0.98);
  }

  color: rgba(255, 255, 255, 0.9);

  & a {
    // Fix colors of links to not be default
    color: inherit;
  }
`]))),FL=Te.div(rue||(rue=J([`
  position: relative;
  padding: 0px 12px;
  font-weight: 400;
  font-size: 11px;
  height: 32px;
  text-decoration: none;
  user-select: none;
  display: flex;
  flex-direction: row;
  align-items: center;
  cursor: default;
`]))),Z9=Te(FL)(iue||(iue=J([`
  &:before {
    position: absolute;
    display: block;
    content: ' ';
    inset: 3px;
    border-radius: 3px;
    background: rgba(255, 255, 255, 0.1);
    opacity: 0;
  }

  &.secondary {
    color: rgba(255, 255, 255, 0.5);
  }

  &:hover {
    /* background-color: #398995; */
    color: white !important;
    &:before {
      opacity: 1;
    }
  }
`]))),oue=Te(FL)(sue||(sue=J([`
  height: auto;
  min-height: 32px;
  padding-top: 12px;
  padding-bottom: 10px;
  flex-direction: column;
  justify-content: flex-start;
  align-items: stretch;
  gap: 8px;
  color: rgba(255, 255, 255, 0.5);
`]))),lue=Te.div(aue||(aue=J([`
  font-weight: 600;
`]))),uue=Te.div(cue||(cue=J([`
  display: flex;
  flex-direction: row;
  justify-content: space-between;
`]))),due=Te.div(hue||(hue=J([`
  margin-left: 2px;
`]))),gA=Te.div(fue||(fue=J([`
  height: 1px;
  margin: 0 2px;
  background: rgba(255, 255, 255, 0.02);
`]))),mue=Te.div(pue||(pue=J([`
  position: absolute;
  width: 8px;
  height: 8px;
  background: #40aaa4;
  right: 14px;
  top: 12px;
  border-radius: 50%;
`]))),LL="0.7.2",BL=LL.match(/^[^\-]+/)[0],gue=Zo.default.forwardRef((s,l)=>{let u=Xr(Se().atomP.ahistoric.updateChecker.result.hasUpdates);return Zo.default.createElement(nue,{ref:l},Zo.default.createElement(Z9,{as:"a",href:"https://www.theatrejs.com/docs/latest",className:"",target:"_blank"},"Docs"),Zo.default.createElement(Z9,{as:"a",href:"https://www.theatrejs.com/docs/latest/releases",className:"",target:"_blank"},"Changelog"),Zo.default.createElement(gA,null),Zo.default.createElement(Z9,{as:"a",href:"https://github.com/theatre-js/theatre",className:"",target:"_blank"},"Github"),Zo.default.createElement(Z9,{as:"a",href:"https://twitter.com/theatre_js",className:"",target:"_blank"},"Twitter"),Zo.default.createElement(Z9,{className:"",as:"a",href:"https://discord.gg/bm9f8F9Y9N",target:"_blank"},"Discord"),Zo.default.createElement(gA,null),Zo.default.createElement(oue,null,Zo.default.createElement(lue,null,"Version"),Zo.default.createElement(uue,null,Zo.default.createElement(due,null,LL," ",u===!0?"(outdated)":u===!1?"(latest)":""))),u===!0&&Zo.default.createElement(Zo.default.Fragment,null,Zo.default.createElement(gA,null),Zo.default.createElement(Z9,{as:"a",href:"https://www.theatrejs.com/docs/latest/releases".concat(encodeURIComponent(BL)),className:"",target:"_blank"},"Update",Zo.default.createElement(mue,null)),Zo.default.createElement(Z9,{as:"a",href:"https://www.theatrejs.com/docs/latest/releases#".concat(encodeURIComponent(BL)),className:"",target:"_blank"},"What's new?")))}),yue=gue}),cs,vue,_ue,xue,bue,Sue,wue,UL,Eue,zL,Tue,VL,Mue,Cue,ebe=k(()=>{er(),Ae(),cs=Q(qe()),Ft(),kb(),Oxe(),YM(),vue=mn(),Zce(),Xxe(),rb(),Kxe(),Qxe(),cS(),mp(),Jxe(),zb(),xue=Te.div(_ue||(_ue=J([`
  height: 36px;
  pointer-events: none;

  display: flex;
  justify-content: space-between;
  padding: 12px;
`]))),Sue=Te.div(bue||(bue=J([`
  color: white;
  width: 14px;
  height: 14px;
  background: #d00;
  border-radius: 4px;
  text-align: center;
  line-height: 14px;
  font-weight: 600;
  font-size: 8px;
  position: relative;
  left: -6px;
  top: -11px;
  margin-right: -14px;
  box-shadow: 0 4px 6px -4px #00000059;
`]))),UL=Te.div(wue||(wue=J([`
  display: flex;
  gap: 8px;
`]))),zL=Te.div(Eue||(Eue=J([`
  position: absolute;
  background: `,`;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  right: -2px;
  top: -2px;
`])),({type:s})=>s==="info"?"#40aaa4":"#f59e0b"),Te.div(Tue||(Tue=J([`
  position: absolute;
  height: 32px;
  width: 1px;
  background: #373b40;
  opacity: 0.4;
`]))),VL=!1,Mue=()=>{var s,l,u;let m=jr(()=>{let j=(0,vue.val)(Se().atomP.ephemeral.coreByProject);return Object.entries(j).map(([X,K])=>({projectId:X,state:K})).filter(({state:X})=>X.loadingState.type==="browserStateIsNotBasedOnDiskState")},[]),[_,b]=Sv({enabled:m.length>0,enterDelay:m.length>0?0:200},()=>m.length>0?cs.default.createElement(gce,null,m.length===1?'There is a state conflict in project "'.concat(m[0].projectId,'". Select the project in the outline below in order to fix it.'):"There are ".concat(m.length," projects that have state conflicts. They are highlighted in the outline below. ")):cs.default.createElement(wv,null,cs.default.createElement(cs.default.Fragment,null,"Outline"))),E=(s=Xr(Se().atomP.ahistoric.pinOutline))!=null?s:!0,T=(l=Xr(Se().atomP.ahistoric.pinDetails))!=null?l:!0,P=Xr(Se().atomP.ahistoric.updateChecker.result.hasUpdates)===!0,N=pp(()=>{let j=z.current.getBoundingClientRect();return{debugName:"More Menu",constraints:{maxX:j.right,maxY:8,minX:j.left-140,minY:8},verticalGap:2}},()=>cs.default.createElement(yue,null)),z=(0,cs.useRef)(null),G=(0,cs.useMemo)(()=>(window.__IS_VISUAL_REGRESSION_TESTING&&(VL||(VL=!0,console.warn("Visual regression testing enabled, so we're showing the updates badge unconditionally"))),P||window.__IS_VISUAL_REGRESSION_TESTING?!0:P),[P]),{hasNotifications:V}=PO(),[B,H]=nte();return cs.default.createElement(xue,null,cs.default.createElement(UL,null,_,cs.default.createElement(mA,{ref:b,"data-testid":"OutlinePanel-TriggerButton",onClick:()=>{Se().transaction(({stateEditors:j,drafts:X})=>{var K;j.studio.ahistoric.setPinOutline(!((K=X.ahistoric.pinOutline)==null||K))})},icon:cs.default.createElement(YN,null),pinHintIcon:cs.default.createElement(OL,null),unpinHintIcon:cs.default.createElement(NL,null),pinned:E}),m.length>0?cs.default.createElement(Sue,null,m.length):null,cs.default.createElement(kL,{showLeftDivider:!0,toolbarId:"global"})),cs.default.createElement(UL,null,B,cs.default.createElement(mA,{ref:H,onClick:()=>{Se().transaction(({stateEditors:j,drafts:X})=>{var K;j.studio.ahistoric.setPinNotifications(!((K=X.ahistoric.pinNotifications)!=null&&K))})},icon:cs.default.createElement(nM,null),pinHintIcon:cs.default.createElement(nM,null),unpinHintIcon:cs.default.createElement(nM,null),pinned:(u=Xr(Se().atomP.ahistoric.pinNotifications))!=null?u:!1},V&&cs.default.createElement(zL,{type:"warning"})),N.node,cs.default.createElement(Vv,{ref:z,onClick:j=>{N.toggle(j,z.current)}},cs.default.createElement(_q,null),G&&cs.default.createElement(zL,{type:"info"})),cs.default.createElement(mA,{ref:b,onClick:()=>{Se().transaction(({stateEditors:j,drafts:X})=>{var K;j.studio.ahistoric.setPinDetails(!((K=X.ahistoric.pinDetails)==null||K))})},icon:cs.default.createElement(vq,null),pinHintIcon:cs.default.createElement(NL,null),unpinHintIcon:cs.default.createElement(OL,null),pinned:T})))},Cue=Mue}),Aue,fS,Pue,pS,Rue,kue,Iue,Nue,Due=k(()=>{Aue=mn(),er(),fS=Q(qe()),Pue=Q(ua()),pS=new Aue.Atom({set:{},byId:{}}),Rue=1,kue=()=>{let s=Rue++;function l(m,_,b){pS.reduce(E=>({byId:$(R({},E.byId),{[s]:{comp:m,props:_,portalNode:b}}),set:$(R({},E.set),{[s]:!0})}))}function u(){pS.reduce(m=>{let _=R({},m.set),b=R({},m.byId);return delete _[s],{byId:b,set:_}})}return{mountOrRender:l,unmount:u}},Iue=()=>{let s=Object.keys(Xr(pS.pointer.set));return fS.default.createElement(fS.default.Fragment,null,s.map(l=>fS.default.createElement(Nue,{key:"id-"+l,id:l})))},Nue=({id:s})=>{let{comp:l,portalNode:u,props:m}=Xr(pS.pointer.byId[s]);return(0,Pue.createPortal)(fS.default.createElement(l,R({},m)),u)}});function tbe(s){let l=Se(),[u,m]=Ai(void 0),_=Aae();_.configureLogging({min:128,dev:jL,internal:jL});let b=_.getLogger().named("Theatre.js UIRoot");wxe();let E=Xr(l.atomP.ahistoric.visibilityState);return(0,e0.useEffect)(()=>(E==="everythingIsHidden"&&console.warn("Theatre.js Studio is hidden. Use the keyboard shortcut 'alt + \\' to restore the studio, or call studio.ui.restore()."),()=>{}),[E]),jr(()=>{let T=(0,GL.val)(l.atomP.ahistoric.visibilityState);return(0,GL.val)(l.atomP.ephemeral.initialised)?e0.default.createElement(FX,{logger:b},e0.default.createElement(zJ,null,e0.default.createElement(V6e,null,e0.default.createElement(zue,null),e0.default.createElement(iv.Provider,{value:m},e0.default.createElement($N,{target:window.__IS_VISUAL_REGRESSION_TESTING===!0?void 0:s.containerShadow},e0.default.createElement(e0.default.Fragment,null,e0.default.createElement(Fue,null),e0.default.createElement(Bue,{className:T==="everythingIsHidden"?"invisible":""},e0.default.createElement(WN,{ref:u}),e0.default.createElement(Cue,null),e0.default.createElement(fce,null),e0.default.createElement(rte,null)))))))):null},[l,u,m])}var GL,e0,Oue,Fue,Lue,Bue,Uue,jL,zue,nbe=k(()=>{Ae(),er(),GL=mn(),e0=Q(qe()),Ft(),Dxe(),ebe(),Fi(),O5(),SL(),ru(),VJ(),yD(),Due(),Li(),nA(),R9(),zb(),Fue=typeof window<"u"?Lx(Oue||(Oue=J([`
  :host {
    contain: strict;
  }
`]))):{},Bue=Te(OX)(Lue||(Lue=J([`
  z-index: 50;
  position: fixed;
  inset: 0;

  &.invisible {
    pointer-events: none !important;
    opacity: 0;
    transform: translateX(1000000px);
  }
`]))),jL=/Playground.+Theatre\.js/.test((Uue=typeof document<"u"?document==null?void 0:document.title:null)!=null?Uue:""),zue=()=>e0.default.createElement(Iue,null)}),rbe=ie(s=>{var l=ua();s.createRoot=l.createRoot,s.hydrateRoot=l.hydrateRoot}),Vue={};ue(Vue,{default:()=>Hue});var Gue,jue,Hue,ibe=k(()=>{nbe(),Gue=Q(qe()),jue=Q(rbe()),Due(),Li(),Zce(),Hue=class{constructor(){le(this,"containerEl",document.createElement("div")),le(this,"_renderTimeout"),le(this,"_documentBodyUIIsRenderedIn"),le(this,"containerShadow"),this.containerEl.id="theatrejs-studio-root",this.containerEl.style.cssText=`
      position: fixed;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
      pointer-events: none;
      z-index: 100;
    `;let s=()=>{if(window.__IS_VISUAL_REGRESSION_TESTING===!0){let l=document.createElement("div");return l.id="theatrejs-faux-shadow-root",document.body.appendChild(l),l}else return this.containerEl.attachShadow({mode:"open"})};this.containerShadow=s()}render(){let s=()=>{if(!document.body){this._renderTimeout=setTimeout(s,5);return}this._renderTimeout=void 0,this._documentBodyUIIsRenderedIn=document.body,this._documentBodyUIIsRenderedIn.appendChild(this.containerEl),jue.default.createRoot(this.containerShadow).render(Gue.default.createElement(tbe,{containerShadow:this.containerShadow}))};this._renderTimeout=setTimeout(s,10)}renderToolset(s,l){let u=kue();return u.mountOrRender(c6e(kL),{toolbarId:s},l),u.unmount}}}),sbe=ie(s=>{s.compare=_,s.reduce=b;var l,u,m;s.REMOVE=l=-1,s.ADD=u=1,s.EQUAL=m=0;function _(z,G){var V=z.length,B=G.length,H=E(z,G),j=H<V&&H<B?T(z,G):0,X=j+H-1;V-=X,B-=X;for(var K=N(V,B),te=V-1;te>=0;--te)for(var se=B-1;se>=0;--se)K[se][te]=P(K,z,G,H,te,se);return{prefix:H,matrix:K,suffix:j}}function b(z,G,V){var B,H,j,X,K=V.matrix,te=V.prefix;for(B=0;B<te;++B)G=z(G,m,B,B);for(j=B,te=K.length,B=0,H=0;B<te;)switch(X=K[B][H].type,G=z(G,X,B+j,H+j),X){case m:++B,++H;break;case l:++H;break;case u:++B;break}for(B+=j,H+=j,te=V.suffix,j=0;j<te;++j)G=z(G,m,B+j,H+j);return G}function E(z,G){for(var V=0,B=Math.min(z.length,G.length);V<B&&z[V]===G[V];)++V;return V}function T(z,G){for(var V=z.length-1,B=G.length-1,H=Math.min(V,B),j=0;j<H&&z[V-j]===G[B-j];)++j;return j}function P(z,G,V,B,H,j){return G[H+B]===V[j+B]?{value:z[j+1][H+1].value,type:m}:z[j][H+1].value<z[j+1][H].value?{value:z[j][H+1].value+1,type:l}:{value:z[j+1][H].value+1,type:u}}function N(z,G){var V=[],B,H,j;for(j=V[G]=[],H=0;H<z;++H)j[H]={value:z-H,type:l};for(B=0;B<G;++B)V[B]=[],V[B][z]={value:G-B,type:u};return V[G][z]={value:0,type:m},V}}),Wue=ie(s=>{s.cons=l,s.tail=u,s.map=m;function l(_,b){var E=b.length,T=new Array(E+1);T[0]=_;for(var P=0;P<E;++P)T[P+1]=b[P];return T}function u(_){for(var b=_.length-1,E=new Array(b),T=0;T<b;++T)E[T]=_[T+1];return E}function m(_,b){for(var E=new Array(b.length),T=0;T<b.length;++T)E[T]=_(b[T]);return E}}),obe=ie((s,l)=>{l.exports=E;var u=/\/|~1|~0/g,m="/",_="~",b="~1";function E(T,P){var N,z,G,V;for(N=T.charAt(0)===m?1:0,z="",u.lastIndex=N;G=u.exec(T);)if(V=G[0],z+=T.slice(N,u.lastIndex-V.length),N=u.lastIndex,V===m){if(P(z)===!1)return T;z=""}else z+=V===b?m:_;return z+=T.slice(N),P(z),T}}),HL=ie(s=>{var l=obe();s.find=z,s.join=V,s.absolute=G,s.parse=B,s.contains=H,s.encodeSegment=X,s.decodeSegment=j,s.parseArrayIndex=se,s.isValidArrayIndex=te;var u="/",m=/\//g,_="~1",b=/~1/g,E="~",T=/~/g,P="~0",N=/~0/g;function z(fe,ve,Ne,ze){if(typeof ve=="string"){if(ve==="")return{target:fe,key:void 0};if(ve===u)return{target:fe,key:""};var Me=fe,He,vt=ze!==void 0;return l(ve,function(xe){if(fe==null)return Me=null,!1;Array.isArray(fe)?He=vt?pe(Ne,se(xe),fe,ze):xe==="-"?xe:se(xe):He=xe,Me=fe,fe=fe[He]}),Me===null?void 0:{target:Me,key:He}}}function G(fe){return fe[0]===u?fe:u+fe}function V(fe){return fe.join(u)}function B(fe){var ve=[];return l(fe,ve.push.bind(ve)),ve}function H(fe,ve){return ve.indexOf(fe)===0&&ve[fe.length]===u}function j(fe){return fe.replace(b,u).replace(N,E)}function X(fe){return fe.replace(T,P).replace(m,_)}var K=/^(0|[1-9]\d*)$/;function te(fe){return K.test(fe)}function se(fe){if(te(fe))return+fe;throw new SyntaxError("invalid array index "+fe)}function pe(fe,ve,Ne,ze){var Me=ve;if(Me<0)throw new Error("array index out of bounds "+Me);if(ze!==void 0&&typeof fe=="function"&&(Me=fe(ve,Ne,ze),Me<0))throw new Error("could not find patch context "+ze);return Me}}),$ue=ie((s,l)=>{l.exports=u;function u(b){return b==null||typeof b!="object"?b:Array.isArray(b)?m(b):_(b)}function m(b){for(var E=b.length,T=new Array(E),P=0;P<E;++P)T[P]=u(b[P]);return T}function _(b){for(var E=Object.keys(b),T={},P,N=0,z=E.length;N<z;++N)P=E[N],T[P]=u(b[P]);return T}}),abe=ie((s,l)=>{l.exports=u;function u(b,E){return b===E?!0:Array.isArray(b)&&Array.isArray(E)?m(b,E):typeof b=="object"&&typeof E=="object"?_(b,E):!1}function m(b,E){if(b.length!==E.length)return!1;for(var T=0;T<b.length;++T)if(!u(b[T],E[T]))return!1;return!0}function _(b,E){if(b===null&&E!==null||b!==null&&E===null)return!1;var T=Object.keys(b),P=Object.keys(E);if(T.length!==P.length)return!1;for(var N=0,z;N<T.length;++N)if(z=T[N],!(z in E&&u(b[z],E[z])))return!1;return!0}}),lbe=ie((s,l)=>{var u=HL();l.exports=function(z,G){var V=u.parse(z.path),B=u.parse(G.path),H=P(V,B),j=b(V,B,H.length),X=N(z),K=N(G);return H.length===0&&!j?[K,X]:j?_(X,V,K,B):m(X,V,K)};function m(z,G,V,B){if(z.path===V.path)throw new TypeError("cannot commute "+z.op+","+V.op+" with identical object paths");return[V,z]}function _(z,G,V,B){return G.length===B.length?E(z,G,V,B):(G.length>B.length?(G=T(V,B,z,G,-1),z.path=u.absolute(u.join(G))):(B=T(z,G,V,B,1),V.path=u.absolute(u.join(B))),[V,z])}function b(z,G,V){return u.isValidArrayIndex(z[V])&&u.isValidArrayIndex(G[V])}function E(z,G,V,B){var H=G.length-1,j=+G[H],X=+B[H],K;return j<X?z.op==="add"||z.op==="copy"?(K=B.slice(),K[H]=Math.max(0,X-1),V.path=u.absolute(u.join(K))):z.op==="remove"&&(K=B.slice(),K[H]=X+1,V.path=u.absolute(u.join(K))):V.op==="add"||V.op==="copy"?(K=G.slice(),K[H]=j+1,z.path=u.absolute(u.join(K))):j>X&&V.op==="remove"&&(K=G.slice(),K[H]=Math.max(0,j-1),z.path=u.absolute(u.join(K))),[V,z]}function T(z,G,V,B,H){var j=G.length-1,X=+G[j],K=+B[j],te=B.slice();return X>K||(z.op==="add"||z.op==="copy"?te[j]=Math.max(0,K-H):z.op==="remove"&&(te[j]=Math.max(0,K+H))),te}function P(z,G){var V=z.length,B=G.length;if(V===0||B===0||V<2&&B<2)return[];for(var H=V===B?V-1:Math.min(V,B),j=0;j<H&&z[j]===G[j];)++j;return z.slice(0,j)}function N(z){return z.op==="remove"?{op:z.op,path:z.path}:z.op==="copy"||z.op==="move"?{op:z.op,path:z.path,from:z.from}:{op:z.op,path:z.path,value:z.value}}}),que=ie((s,l)=>{l.exports=u;function u(m){Error.call(this),this.name=this.constructor.name,this.message=m,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,this.constructor)}u.prototype=Object.create(Error.prototype),u.prototype.constructor=u}),WL=ie((s,l)=>{l.exports=u;function u(m){Error.call(this),this.name=this.constructor.name,this.message=m,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,this.constructor)}u.prototype=Object.create(Error.prototype),u.prototype.constructor=u}),Xue=ie((s,l)=>{l.exports=u;function u(m){Error.call(this),this.name=this.constructor.name,this.message=m,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,this.constructor)}u.prototype=Object.create(Error.prototype),u.prototype.constructor=u}),Yue=ie(s=>{var l=HL(),u=$ue(),m=abe(),_=lbe(),b=Wue(),E=que(),T=WL(),P=Xue(),N=l.find,z=l.parseArrayIndex;s.test={apply:G,inverse:V,commute:B},s.add={apply:H,inverse:X,commute:K},s.remove={apply:fe,inverse:Ne,commute:ze},s.replace={apply:te,inverse:se,commute:pe},s.move={apply:Me,inverse:He,commute:vt},s.copy={apply:xe,inverse:We,commute:K};function G(Ve,Be,ot){var Wt=N(Ve,Be.path,ot.findContext,Be.context),be=Wt.target,Ce,St;if(Array.isArray(be)?(Ce=z(Wt.key),St=be[Ce]):St=Wt.key===void 0?Wt.target:Wt.target[Wt.key],!m(St,Be.value))throw new E("test failed "+JSON.stringify(Be));return Ve}function V(Ve,Be){return Ve.push(Be),1}function B(Ve,Be){if(Ve.path===Be.path&&Be.op==="remove")throw new TypeError("Can't commute test,remove -> remove,test for same path");return Be.op==="test"||Be.op==="replace"?[Be,Ve]:_(Ve,Be)}function H(Ve,Be,ot){var Wt=N(Ve,Be.path,ot.findContext,Be.context);if(oe(Wt))throw new T("path does not exist "+Be.path);if(Be.value===void 0)throw new T("missing value");var be=u(Be.value);return Wt.key===void 0?be:(j(Wt,be),Ve)}function j(Ve,Be){var ot=Ve.target;if(Array.isArray(ot))if(Ve.key==="-")ot.push(Be);else{if(Ve.key>ot.length)throw new T("target of add outside of array bounds");ot.splice(Ve.key,0,Be)}else if(dn(ot))ot[Ve.key]=Be;else throw new T("target of add must be an object or array "+Ve.key)}function X(Ve,Be){var ot=Be.context;return ot!==void 0&&(ot={before:ot.before,after:b.cons(Be.value,ot.after)}),Ve.push({op:"test",path:Be.path,value:Be.value,context:ot}),Ve.push({op:"remove",path:Be.path,context:ot}),1}function K(Ve,Be){if(Ve.path===Be.path&&Be.op==="remove")throw new TypeError("Can't commute add,remove -> remove,add for same path");return _(Ve,Be)}function te(Ve,Be,ot){var Wt=N(Ve,Be.path,ot.findContext,Be.context);if(oe(Wt)||nt(Wt))throw new T("path does not exist "+Be.path);if(Be.value===void 0)throw new T("missing value");var be=u(Be.value);if(Wt.key===void 0)return be;var Ce=Wt.target;return Array.isArray(Ce)?Ce[z(Wt.key)]=be:Ce[Wt.key]=be,Ve}function se(Ve,Be,ot,Wt){var be=Wt[ot-1];if(be===void 0||be.op!=="test"||be.path!==Be.path)throw new P("cannot invert replace w/o test");var Ce=be.context;return Ce!==void 0&&(Ce={before:Ce.before,after:b.cons(be.value,b.tail(Ce.after))}),Ve.push({op:"test",path:be.path,value:Be.value}),Ve.push({op:"replace",path:be.path,value:be.value}),2}function pe(Ve,Be){if(Ve.path===Be.path&&Be.op==="remove")throw new TypeError("Can't commute replace,remove -> remove,replace for same path");return Be.op==="test"||Be.op==="replace"?[Be,Ve]:_(Ve,Be)}function fe(Ve,Be,ot){var Wt=N(Ve,Be.path,ot.findContext,Be.context);if(oe(Wt)||Wt.target[Wt.key]===void 0)throw new T("path does not exist "+Be.path);return ve(Wt),Ve}function ve(Ve){var Be=Ve.target,ot;if(Array.isArray(Be))return ot=Be.splice(z(Ve.key),1),ot[0];if(dn(Be))return ot=Be[Ve.key],delete Be[Ve.key],ot;throw new T("target of remove must be an object or array")}function Ne(Ve,Be,ot,Wt){var be=Wt[ot-1];if(be===void 0||be.op!=="test"||be.path!==Be.path)throw new P("cannot invert remove w/o test");var Ce=be.context;return Ce!==void 0&&(Ce={before:Ce.before,after:b.tail(Ce.after)}),Ve.push({op:"add",path:be.path,value:be.value,context:Ce}),2}function ze(Ve,Be){return Ve.path===Be.path&&Be.op==="remove"?[Be,Ve]:_(Ve,Be)}function Me(Ve,Be,ot){if(l.contains(Be.path,Be.from))throw new T("move.from cannot be ancestor of move.path");var Wt=N(Ve,Be.path,ot.findContext,Be.context),be=N(Ve,Be.from,ot.findContext,Be.fromContext);return j(Wt,ve(be)),Ve}function He(Ve,Be){return Ve.push({op:"move",path:Be.from,context:Be.fromContext,from:Be.path,fromContext:Be.context}),1}function vt(Ve,Be){if(Ve.path===Be.path&&Be.op==="remove")throw new TypeError("Can't commute move,remove -> move,replace for same path");return _(Ve,Be)}function xe(Ve,Be,ot){var Wt=N(Ve,Be.path,ot.findContext,Be.context),be=N(Ve,Be.from,ot.findContext,Be.fromContext);if(oe(be)||nt(be))throw new T("copy.from must exist");var Ce=be.target,St;return Array.isArray(Ce)?St=Ce[z(be.key)]:St=Ce[be.key],j(Wt,u(St)),Ve}function We(Ve,Be){throw new P("cannot invert "+Be.op)}function oe(Ve){return Ve===void 0||Ve.target==null&&Ve.key!==void 0}function nt(Ve){return Ve.key!==void 0&&Ve.target[Ve.key]===void 0}function dn(Ve){return Ve!==null&&typeof Ve=="object"}}),cbe=ie(s=>{var l=Yue(),u=$ue(),m=WL();s.apply=b,s.applyInPlace=E,s.clone=u,s.isValidObject=P,s.defaultHash=T;var _={};function b(z,G,V){return E(z,u(G),V)}function E(z,G,V){if(V||(V=_),!Array.isArray(z))return G;for(var B,H,j=0;j<z.length;++j){if(H=z[j],B=l[H.op],B===void 0)throw new m("invalid op "+JSON.stringify(H));G=B.apply(G,H,V)}return G}function T(z){return P(z)||N(z)?JSON.stringify(z):z}function P(z){return z!==null&&Object.prototype.toString.call(z)==="[object Object]"}function N(z){return Object.prototype.toString.call(z)==="[object Array]"}}),ube=ie((s,l)=>{var u=Yue();l.exports=function(_){var b=[],E,T;for(E=_.length-1;E>=0;E-=T)T=m(b,_[E],E,_);return b};function m(_,b,E,T){var P=u[b.op];return P!==void 0&&typeof P.inverse=="function"?P.inverse(_,b,E,T):1}}),hbe=ie(s=>{var l=sbe(),u=Wue(),m=cbe(),_=ube(),b=HL(),E=b.encodeSegment;s.diff=N,s.patch=m.apply,s.patchInPlace=m.applyInPlace,s.inverse=_,s.clone=m.clone,s.InvalidPatchOperationError=WL(),s.TestFailedError=que(),s.PatchNotInvertibleError=Xue();var T=m.isValidObject,P=m.defaultHash;function N(se,pe,fe){return G(se,pe,"",z(fe,[])).patch}function z(se,pe){return typeof se=="object"?{patch:pe,hash:X(te,se.hash,P),makeContext:X(te,se.makeContext,K),invertible:se.invertible!==!1}:{patch:pe,hash:X(te,se,P),makeContext:K,invertible:!0}}function G(se,pe,fe,ve){return Array.isArray(se)&&Array.isArray(pe)?B(se,pe,fe,ve):T(se)&&T(pe)?V(se,pe,fe,ve):j(se,pe,fe,ve)}function V(se,pe,fe,ve){var Ne=Object.keys(pe),ze=ve.patch,Me,He;for(Me=Ne.length-1;Me>=0;--Me){He=Ne[Me];var vt=fe+"/"+E(He);se[He]!==void 0?G(se[He],pe[He],vt,ve):ze.push({op:"add",path:vt,value:pe[He]})}for(Ne=Object.keys(se),Me=Ne.length-1;Me>=0;--Me)if(He=Ne[Me],pe[He]===void 0){var xe=fe+"/"+E(He);ve.invertible&&ze.push({op:"test",path:xe,value:se[He]}),ze.push({op:"remove",path:xe})}return ve}function B(se,pe,fe,ve){var Ne=u.map(ve.hash,se),ze=u.map(ve.hash,pe),Me=l.compare(Ne,ze);return H(se,pe,fe,ve,Me)}function H(se,pe,fe,ve,Ne){var ze=0;return l.reduce(function(Me,He,vt,xe){var We,oe,nt=Me.patch,dn=fe+"/"+(xe+ze);return He===l.REMOVE?(We=nt[nt.length-1],oe=Me.makeContext(xe,se),Me.invertible&&nt.push({op:"test",path:dn,value:se[xe],context:oe}),We!==void 0&&We.op==="add"&&We.path===dn?(We.op="replace",We.context=oe):nt.push({op:"remove",path:dn,context:oe}),ze-=1):He===l.ADD?(nt.push({op:"add",path:dn,value:pe[vt],context:Me.makeContext(xe,se)}),ze+=1):G(se[xe],pe[vt],dn,Me),Me},ve,Ne)}function j(se,pe,fe,ve){return se!==pe&&(ve.invertible&&ve.patch.push({op:"test",path:fe,value:se}),ve.patch.push({op:"replace",path:fe,value:pe})),ve}function X(se,pe,fe){return se(pe)?pe:fe}function K(){}function te(se){return typeof se=="function"}}),m8=ie((s,l)=>{function u(m,_){for(var b=0,E=_.length-1;b<E;b++){if(!m[_[b]])return null;m=m[_[b]]}return m}l.exports=u}),Q9=ie((s,l)=>{function u(_){return _==="~0"?"~":"/"}function m(_){var b=_.split("/");if(_.indexOf("~")===-1)return b;for(var E=0,T=b.length;E<T;E++)b[E].indexOf("~")!==-1&&(b[E]=b[E].replace(/~[01]/g,u));return b}l.exports=m}),dbe=ie((s,l)=>{var u=m8(),m=Q9();function _(b,E){var T=m(E),P=T[T.length-1],N=u(b,T);return N?N[P]:void 0}l.exports=_}),yA=ie((s,l)=>{function u(m,_){if(m===_)return!0;if(!(m&&_)||typeof m!="object"||typeof _!="object"||m.length!==_.length)return!1;if(Array.isArray(m)){if(!Array.isArray(_))return!1;for(var b=0,E=m.length;b<E;b++)if(!u(m[b],_[b]))return!1;return!0}var T=Object.keys(m);if(T.length!==Object.keys(_).length)return!1;for(var P=0,N=T.length;P<N;P++){var z=T[P];if(!u(m[z],_[z]))return!1}return!0}l.exports=u}),vA=ie((s,l)=>{function u(m,_){if(_==="-")return m.length;for(var b=0,E=_.length;b<E;b++){var T=_.charCodeAt(b);if(57<T||T<48)return 1/0}return+_}l.exports=u}),_A=ie((s,l)=>{var u=yA(),m=m8(),_=vA(),b=Q9();function E(T,P,N,z){if(typeof N>"u")return"[op:add] require value, but got undefined";var G=b(P),V=G[G.length-1],B=m(T,G);if(B===null)return"[op:add] path not found: "+P;if(Array.isArray(B)){var H=_(B,V);if(B.length<H)return"[op:add] invalid array index: "+P;z(T,G).splice(H,0,N)}else u(B[V],N)||(z(T,G)[V]=N)}l.exports=E}),Kue=ie((s,l)=>{var u=m8(),m=vA(),_=Q9();function b(E,T,P){var N=_(T),z=N[N.length-1],G=u(E,N);if(G===null)return"[op:remove] path not found: "+T;if(Array.isArray(G)){var V=m(G,z);if(G.length<=V)return"[op:remove] invalid array index: "+T;P(E,N).splice(V,1)}else delete P(E,N)[z]}l.exports=b}),Zue=ie((s,l)=>{var u=yA(),m=m8(),_=vA(),b=Q9();function E(T,P,N,z){if(typeof N>"u")return"[op:replace] require value, but got undefined";var G=b(P),V=G[G.length-1],B=m(T,G);if(B===null)return"[op:replace] path not found: "+P;if(Array.isArray(B)){var H=_(B,V);if(B.length<=H)return"[op:replace] invalid array index: "+P;u(B[H],N)||z(T,G).splice(H,1,N)}else u(B[V],N)||(z(T,G)[V]=N)}l.exports=E}),Que=ie((s,l)=>{var u=_A(),m=m8(),_=vA(),b=Q9();function E(T,P,N,z){if(N!==P){var G=b(P),V=G[G.length-1],B=m(T,G);if(B===null)return"[op:move] path not found: "+P;var H=void 0;if(Array.isArray(B)){var j=_(B,V);if(B.length<=j)return"[op:move] invalid array index: "+N;H=B[j],z(T,G).splice(j,1)}else H=B[V],delete z(T,G)[V];return u(T,N,H,z)}}l.exports=E}),Jue=ie((s,l)=>{var u=m8(),m=Q9(),_=_A();function b(E,T,P,N){var z=m(T),G=z[z.length-1],V=u(E,z);return V===null?"[op:copy] path not found: "+T:_(E,P,V[G],N)}l.exports=b}),ehe=ie((s,l)=>{var u=yA(),m=m8(),_=Q9();function b(E,T,P){var N=_(T),z=N[N.length-1],G=m(E,N);if(G===null)return"[op:test] path not found: "+T;if(!u(G[z],P)){var V=JSON.stringify(G[z]),B=JSON.stringify(P);return"[op:test] not matched: "+V+" "+B}}l.exports=b}),$L=ie((s,l)=>{function u(m){if(!m||typeof m!="object")return m;if(Array.isArray(m)){for(var _=m.length,b=new Array(_),E=0;E<_;E++)b[E]=m[E];return b}for(var T=Object.keys(m),P={},N=0,z=T.length;N<z;N++){var G=T[N];P[G]=m[G]}return P}l.exports=u}),fbe=ie((s,l)=>{var u=dbe(),m=_A(),_=Kue(),b=Zue(),E=Que(),T=Jue(),P=ehe(),N=yA(),z=$L(),G=Q9();function V(B,H){return{get:function(j){return u(B,j)},add:function(j,X){return m(B,j,X,H)},remove:function(j){return _(B,j,H)},replace:function(j,X){return b(B,j,X,H)},move:function(j,X){return E(B,j,X,H)},copy:function(j,X){return T(B,j,X,H)},test:function(j,X){return P(B,j,X)},deepEqual:N,shallowCopy:z,toKeys:G}}l.exports=V}),pbe=ie((s,l)=>{function u(m,_,b,E){return E.error=b,E.partial?_[""]:m}l.exports=u}),mbe=ie((s,l)=>{function u(m){return!!m}l.exports=u}),gbe=ie((s,l)=>{function u(m){if(m)throw new TypeError(m)}l.exports=u}),ybe=ie((s,l)=>{var u=$L();function m(_,b){for(var E=0,T=b.length-1;E<T;E++)_=_[b[E]]=u(_[b[E]]);return _}l.exports=m}),vbe=ie((s,l)=>{var u=$L();function m(b,E,T){var P=b[E];return T.has(P)||(P=u(P),T.add(P)),P}function _(b,E,T){for(var P=0,N=E.length-1;P<N;P++)b=b[E[P]]=m(b,E[P],T);return b}l.exports=_}),_be=ie((s,l)=>{var u=fbe(),m=pbe(),_=mbe(),b=gbe(),E=ybe(),T=vbe(),P=_A(),N=Kue(),z=Zue(),G=Que(),V=Jue(),B=ehe(),H=Set||function(){var X=[];return X.has=function(K){return this.indexOf(K)!==-1},X.add=function(K){this.push(K)},X};function j(X,K,te){if(K.length===0)return X;te=te||{};for(var se=te.strict?b:_,pe=K.length===1?E:function(He){return function(vt,xe){return T(vt,xe,He)}}(new H),fe={"":X},ve,Ne=0,ze=K.length;Ne<ze;Ne++){var Me=K[Ne];switch(Me.op){case"add":if(se(P(fe,""+Me.path,Me.value,pe)))return m(X,fe,Me,te);break;case"remove":if(se(N(fe,""+Me.path,pe)))return m(X,fe,Me,te);break;case"replace":if(se(z(fe,""+Me.path,Me.value,pe)))return m(X,fe,Me,te);break;case"move":if(se(G(fe,""+Me.from,""+Me.path,pe)))return m(X,fe,Me,te);break;case"copy":if(se(V(fe,""+Me.from,""+Me.path,pe)))return m(X,fe,Me,te);break;case"test":if(se(B(fe,""+Me.path,Me.value)))return m(X,fe,Me,te);break;default:if(te.custom&&te.custom[Me.op]){if(ve=ve||u(fe,pe),se(te.custom[Me.op](ve,Me,Ne,K)))return m(X,fe,Me,te)}else return se("[op:"+Me.op+"] unknown"),m(X,fe,Me,te);break}}return fe[""]}l.exports=j}),xbe=ie((s,l)=>{l.exports=_be()}),bbe=ie((s,l)=>{(function(u,m){typeof s=="object"&&typeof l=="object"?l.exports=m():typeof s=="object"?s.blobCompare=m():u.blobCompare=m()})(window,function(){return function(u){var m={};function _(b){if(m[b])return m[b].exports;var E=m[b]={i:b,l:!1,exports:{}};return u[b].call(E.exports,E,E.exports,_),E.l=!0,E.exports}return _.m=u,_.c=m,_.d=function(b,E,T){_.o(b,E)||Object.defineProperty(b,E,{enumerable:!0,get:T})},_.r=function(b){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(b,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(b,"__esModule",{value:!0})},_.t=function(b,E){if(1&E&&(b=_(b)),8&E||4&E&&typeof b=="object"&&b&&b.__esModule)return b;var T=Object.create(null);if(_.r(T),Object.defineProperty(T,"default",{enumerable:!0,value:b}),2&E&&typeof b!="string")for(var P in b)_.d(T,P,(function(N){return b[N]}).bind(null,P));return T},_.n=function(b){var E=b&&b.__esModule?function(){return b.default}:function(){return b};return _.d(E,"a",E),E},_.o=function(b,E){return Object.prototype.hasOwnProperty.call(b,E)},_.p="",_(_.s=4)}([function(u,m,_){var b=function(z,G){if(Array.isArray(z))return z;if(Symbol.iterator in Object(z))return function(V,B){var H=[],j=!0,X=!1,K=void 0;try{for(var te,se=V[Symbol.iterator]();!(j=(te=se.next()).done)&&(H.push(te.value),!B||H.length!==B);j=!0);}catch(pe){X=!0,K=pe}finally{try{!j&&se.return&&se.return()}finally{if(X)throw K}}return H}(z,G);throw new TypeError("Invalid attempt to destructure non-iterable instance")},E=function(){function z(G,V){for(var B=0;B<V.length;B++){var H=V[B];H.enumerable=H.enumerable||!1,H.configurable=!0,"value"in H&&(H.writable=!0),Object.defineProperty(G,H.key,H)}}return function(G,V,B){return V&&z(G.prototype,V),B&&z(G,B),G}}();function T(z){if(Array.isArray(z)){for(var G=0,V=Array(z.length);G<z.length;G++)V[G]=z[G];return V}return Array.from(z)}var P=_(2),N=function(z){function G(V){(function(H,j){if(!(H instanceof j))throw new TypeError("Cannot call a class as a function")})(this,G);var B=function(H,j){if(!H)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!j||typeof j!="object"&&typeof j!="function"?H:j}(this,(G.__proto__||Object.getPrototypeOf(G)).call(this));return B._messageId=1,B._messages=new Map,B._worker=V,B._worker.onmessage=B._onMessage.bind(B),B._id=Math.ceil(1e7*Math.random()),B}return function(V,B){if(typeof B!="function"&&B!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof B);V.prototype=Object.create(B&&B.prototype,{constructor:{value:V,enumerable:!1,writable:!0,configurable:!0}}),B&&(Object.setPrototypeOf?Object.setPrototypeOf(V,B):V.__proto__=B)}(G,z),E(G,[{key:"terminate",value:function(){this._worker.terminate()}},{key:"isFree",value:function(){return this._messages.size===0}},{key:"jobsLength",value:function(){return this._messages.size}},{key:"exec",value:function(V){var B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,H=this,j=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],X=arguments[3];return new Promise(function(K,te){var se=H._messageId++;H._messages.set(se,[K,te,X]),H._worker.postMessage([se,B,V],j||[])})}},{key:"postMessage",value:function(){var V=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,B=this,H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],j=arguments[2];return new Promise(function(X,K){var te=B._messageId++;B._messages.set(te,[X,K,j]),B._worker.postMessage([te,V],H||[])})}},{key:"emit",value:function(V){for(var B=arguments.length,H=Array(B>1?B-1:0),j=1;j<B;j++)H[j-1]=arguments[j];this._worker.postMessage({eventName:V,args:H})}},{key:"_onMessage",value:function(V){var B;if(!Array.isArray(V.data)&&V.data.eventName)return(B=function te(se,pe,fe){se===null&&(se=Function.prototype);var ve=Object.getOwnPropertyDescriptor(se,pe);if(ve===void 0){var Ne=Object.getPrototypeOf(se);return Ne===null?void 0:te(Ne,pe,fe)}if("value"in ve)return ve.value;var ze=ve.get;return ze!==void 0?ze.call(fe):void 0}(G.prototype.__proto__||Object.getPrototypeOf(G.prototype),"emit",this)).call.apply(B,[this,V.data.eventName].concat(T(V.data.args)));var H,j=(H=V.data,Array.isArray(H)?H:Array.from(H)),X=j[0],K=j.slice(1);if(X===1)this._onEvent.apply(this,T(K));else{if(X!==0)throw new Error("Wrong message type '"+X+"'");this._onResult.apply(this,T(K))}}},{key:"_onResult",value:function(V,B,H){var j=this._messages.get(V),X=b(j,2),K=X[0],te=X[1];return this._messages.delete(V),B===1?K(H):te(H)}},{key:"_onEvent",value:function(V,B,H){var j=this._messages.get(V),X=b(j,3)[2];X&&X(B,H)}}]),G}(P);u.exports=N},function(u,m,_){u.exports=function(){return _(3)(`!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=2)}([function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=function e(t,r,n){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,r);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,r,n)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(n):void 0},i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function a(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var f=r(1),c=0,l=1,s=0,y=1,p="main",b=function(e){return"object"===(void 0===e?"undefined":i(e))&&"function"==typeof e.then&&"function"==typeof e.catch};var v=function e(t,r){u(this,e),this.payload=t,this.transferable=r};e.exports=function(e){var t,r,i,h=(i=e,(r=p)in(t={})?Object.defineProperty(t,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[r]=i,t),d=self.postMessage.bind(self),m=new(function(e){function t(){return u(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"emit",value:function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return d({eventName:e,args:r}),this}},{key:"emitLocally",value:function(e){for(var r,n=arguments.length,i=Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];(r=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"emit",this)).call.apply(r,[this,e].concat(i))}},{key:"operation",value:function(e,t){return h[e]=t,this}}]),t}(f)),g=function(e,t,r){var n=function(t){t&&t instanceof v?w(e,y,t.payload,t.transferable):w(e,y,t)},o=function(t){w(e,s,{message:t.message,stack:t.stack})};try{var i=_(e,t,r);b(i)?i.then(n).catch(o):n(i)}catch(e){o(e)}},_=function(e,t,r){var n=h[r||p];if(!n)throw new Error("Not found handler for this request");return n(t,O.bind(null,e))},w=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];d([c,e,t,r],n)},O=function(e,t,r){if(!t)throw new Error("eventName is required");if("string"!=typeof t)throw new Error("eventName should be string");d([l,e,t,r])};return self.addEventListener("message",(function(e){var t=e.data;Array.isArray(t)?g.apply(void 0,a(t)):t&&t.eventName&&m.emitLocally.apply(m,[t.eventName].concat(a(t.args)))})),m},e.exports.TransferableResponse=v},function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,"__listeners",{value:{},enumerable:!1,writable:!1})}return n(e,[{key:"emit",value:function(e){if(!this.__listeners[e])return this;for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=!0,i=!1,a=void 0;try{for(var u,f=this.__listeners[e][Symbol.iterator]();!(o=(u=f.next()).done);o=!0){var c=u.value;c.apply(void 0,r)}}catch(e){i=!0,a=e}finally{try{!o&&f.return&&f.return()}finally{if(i)throw a}}return this}},{key:"once",value:function(e,t){var r=this,n=function n(){r.off(e,n),t.apply(void 0,arguments)};return this.on(e,n)}},{key:"on",value:function(e,t){return this.__listeners[e]||(this.__listeners[e]=[]),this.__listeners[e].push(t),this}},{key:"off",value:function(e,t){return this.__listeners[e]=t?this.__listeners[e].filter((function(e){return e!==t})):[],this}}]),e}();e.exports=o},function(e,t,r){"use strict";r.r(t);var n=r(0);r.n(n)()().operation("binary",async({blob:e,chunk:t})=>await function(e,t){return new Promise((r,n)=>{const o=new FileReader,i=t?Math.min(t,e.size):e.size,a=e.slice(0,i);o.onload=()=>r(o.result),o.onerror=n,o.readAsBinaryString(a)})}(e,t)).operation("buffer",async({blob:e,chunk:t})=>await function(e,t){return new Promise((r,n)=>{const o=new FileReader,i=t?Math.min(t,e.size):e.size,a=e.slice(0,i);o.onload=()=>r(o.result),o.onerror=n,o.readAsArrayBuffer(a)})}(e,t)).operation("compare",({buf1:e,buf2:t})=>(function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;const r=new DataView(e),n=new DataView(t);for(var o=e.byteLength;o--;)if(r.getUint8(o)!==n.getUint8(o))return!1;return!0})(e,t))}]);`,null)}},function(u,m,_){var b=function(){function T(P,N){for(var z=0;z<N.length;z++){var G=N[z];G.enumerable=G.enumerable||!1,G.configurable=!0,"value"in G&&(G.writable=!0),Object.defineProperty(P,G.key,G)}}return function(P,N,z){return N&&T(P.prototype,N),z&&T(P,z),P}}(),E=function(){function T(){(function(P,N){if(!(P instanceof N))throw new TypeError("Cannot call a class as a function")})(this,T),Object.defineProperty(this,"__listeners",{value:{},enumerable:!1,writable:!1})}return b(T,[{key:"emit",value:function(P){if(!this.__listeners[P])return this;for(var N=arguments.length,z=Array(N>1?N-1:0),G=1;G<N;G++)z[G-1]=arguments[G];var V=!0,B=!1,H=void 0;try{for(var j,X=this.__listeners[P][Symbol.iterator]();!(V=(j=X.next()).done);V=!0){var K=j.value;K.apply(void 0,z)}}catch(te){B=!0,H=te}finally{try{!V&&X.return&&X.return()}finally{if(B)throw H}}return this}},{key:"once",value:function(P,N){var z=this,G=function V(){z.off(P,V),N.apply(void 0,arguments)};return this.on(P,G)}},{key:"on",value:function(P,N){return this.__listeners[P]||(this.__listeners[P]=[]),this.__listeners[P].push(N),this}},{key:"off",value:function(P,N){return this.__listeners[P]=N?this.__listeners[P].filter(function(z){return z!==N}):[],this}}]),T}();u.exports=E},function(u,m,_){var b=window.URL||window.webkitURL;u.exports=function(E,T){try{try{var P;try{(P=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder)).append(E),P=P.getBlob()}catch{P=new Blob([E])}return new Worker(b.createObjectURL(P))}catch{return new Worker("data:application/javascript,"+encodeURIComponent(E))}}catch{if(!T)throw Error("Inline worker is not supported");return new Worker(T)}}},function(u,m,_){_.r(m);var b=_(0),E=_.n(b),T=_(1),P=_.n(T);_.d(m,"workersEnabled",function(){return N}),_.d(m,"default",function(){return z});let N=!!window.Worker;class z{static toBinaryStringWithWorker(V,B){return Ue(this,null,function*(){let H=new E.a(new P.a),j=yield H.exec("binary",{blob:V,chunk:B});return H.terminate(),j})}static toBinaryStringWithoutWorker(V,B){return function(H,j){return new Promise((X,K)=>{let te=new FileReader,se=j?Math.min(j,H.size):H.size,pe=H.slice(0,se);te.onload=()=>X(te.result),te.onerror=K,te.readAsBinaryString(pe)})}(V,B)}static toBinaryString(V,B,H=!0){return H&&N?this.toBinaryStringWithWorker(V,B):this.toBinaryStringWithoutWorker(V,B)}static toArrayBufferWithWorker(V,B){return Ue(this,null,function*(){let H=new E.a(new P.a),j=yield H.exec("buffer",{blob:V,chunk:B});return H.terminate(),j})}static toArrayBufferWithoutWorker(V,B){return function(H,j){return new Promise((X,K)=>{let te=new FileReader,se=j?Math.min(j,H.size):H.size,pe=H.slice(0,se);te.onload=()=>X(te.result),te.onerror=K,te.readAsArrayBuffer(pe)})}(V,B)}static toArrayBuffer(V,B,H=!0){return H&&N?this.toArrayBufferWithWorker(V,B):this.toArrayBufferWithoutWorker(V,B)}static compareBuffersWithWorker(V,B){return Ue(this,null,function*(){if(V===B)return!0;let H=new E.a(new P.a),j=yield H.exec("compare",{buf1:V,buf2:B},[V,B]);return H.terminate(),j})}static compareBuffersWithoutWorker(V,B){return function(H,j){if(H===j)return!0;if(H.byteLength!==j.byteLength)return!1;let X=new DataView(H),K=new DataView(j);for(var te=H.byteLength;te--;)if(X.getUint8(te)!==K.getUint8(te))return!1;return!0}(V,B)}static compareBuffers(V,B,H=!0){return H&&N?this.compareBuffersWithWorker(V,B):this.compareBuffersWithoutWorker(V,B)}static sizeEqual(V,B){return V.size===B.size}static typeEqual(V,B){return V.type===B.type}static magicNumbersEqual(V,B,H=!0){return Ue(this,null,function*(){if(V===B)return!0;let j=[24,16,14,12,8,6,4],[X,K]=yield Promise.all([this.toBinaryString(V,24,H),this.toBinaryString(B,24,H)]);for(let te of j)if(X.substring(0,te)===K.substring(0,te))return!0;return!1})}static bytesEqualWithBinaryString(V,B,H,j=!0){return Ue(this,null,function*(){if(V===B)return!0;let[X,K]=yield Promise.all([this.toBinaryString(V,H,j),this.toBinaryString(B,H,j)]);return X===K})}static bytesEqualWithArrayBuffer(V,B,H,j=!0){return Ue(this,null,function*(){if(V===B)return!0;let[X,K]=yield Promise.all([this.toArrayBuffer(V,H,j),this.toArrayBuffer(B,H,j)]);return this.compareBuffers(X,K,j)})}static isEqual(V,B){return Ue(this,arguments,function*(H,j,{methods:X=["size","type","magic","byte"],byte:K="buffer",partial:te=!1,chunks:se=null,worker:pe=!0}={}){let fe=null;for(let ve of X){if(fe===!1||te&&fe===!0)break;switch(ve){case"byte":case"bytes":case"content":se=se instanceof Array?se:[H.size],fe=!0;for(let Ne of se){let ze=!1;ze=K==="buffer"?yield this.bytesEqualWithArrayBuffer(H,j,Ne,pe):yield this.bytesEqualWithBinaryString(H,j,Ne,pe),ze||(fe=!1)}break;case"magic":case"headers":case"numbers":case"mime":fe=yield this.magicNumbersEqual(H,j,pe);break;case"size":case"sizes":fe=this.sizeEqual(H,j);break;case"type":case"types":fe=this.typeEqual(H,j);break;default:throw new Error("Blob-compare : Unknown comparison method")}}return fe})}}}])})}),the={};ue(the,{ToolbarDropdownSelect:()=>USe,default:()=>VSe}),o.exports=ae(the),Ae(),_t();var nhe=mn();ai();var Sbe=0,wbe=class{constructor(s){this._studio=s,le(this,"_id"),le(this,"_state",{type:"Ready"}),this._id=String(Sbe++)}get status(){return this._state.type}reset(){let{_state:s}=this;if(s.type!=="Ready")if(s.type==="Captured")this._state={type:"Ready"},s.transaction.discard(),s.flagsTransaction.discard();else throw s.type==="Committed"?new Error("This scrub is already committed and can't be reset."):new Error("This scrub is already discarded and can't be reset.")}commit(){let{_state:s}=this;if(s.type==="Captured")s.transaction.commit(),s.flagsTransaction.discard(),this._state={type:"Committed"};else if(s.type==="Ready"){console.warn("Scrub is empty. Nothing to commit.");return}else throw s.type==="Committed"?new Error("This scrub is already committed."):new Error("This scrub is already discarded and can't be comitted.")}capture(s){if(this._state.type==="Captured"&&this.reset(),this._state.type==="Ready"){let l=!0;try{this._state=R({type:"Captured"},this._capture(s)),l=!1}finally{l&&(console.error("This scrub's callback threw an error. We're undo-ing all of the changes made by this scrub, and marking it as discarded."),this._state={type:"Discarded"})}}else throw this._state.type==="Committed"?new Error("This scrub is already committed and cannot capture again. If you wish to capture more, you can start a new studio.scrub() or do so before scrub.commit()"):new Error("This scrub is already discarded and cannot capture again. If you wish to capture more, you can start a new studio.scrub() or do so before scrub.discard()")}_capture(s){let l=[],u=this._studio.tempTransaction(_=>{let b=!0,E={set:(T,P)=>{if(!b)throw new Error("You seem to have called the scrub api after scrub.capture()");let{root:N,path:z}=(0,nhe.getPointerParts)(T);if(!qt(N))throw new Error("We can only scrub props of Sheet Objects for now");_.set(T,P),l.push(T)}};try{s(E)}finally{b=!1}}),m=this._studio.tempTransaction(({stateEditors:_})=>{l.forEach(b=>{let{root:E,path:T}=(0,nhe.getPointerParts)(b);if(!qt(E))return;let P=E.template.getDefaultsAtPointer(b);lt(P,(N,z)=>{_.studio.ephemeral.projects.stateByProjectId.stateBySheetId.stateByObjectKey.propsBeingScrubbed.flag($(R({},E.address),{pathToProp:z}))},T)})});return{transaction:u,flagsTransaction:m}}discard(){let{_state:s}=this;if(s.type==="Captured"||s.type==="Ready")s.type==="Captured"&&(s.transaction.discard(),s.flagsTransaction.discard()),this._state={type:"Discarded"};else throw s.type==="Committed"?new Error("This scrub is already committed and can't be discarded."):new Error("This scrub is already discarded")}},Ebe=mn(),rhe=typeof window<"u"?Promise.resolve().then(()=>(ibe(),Vue)).then(s=>s.default):null,Tbe=class{constructor(s){this.studio=s,le(this,"_rendered",!1),le(this,"_nonSSRBits",rhe?rhe.then(l=>new l):Promise.reject()),le(this,"ready",this._nonSSRBits.then(()=>{},()=>{}))}render(){this._rendered||(this._rendered=!0,this._nonSSRBits.then(s=>{s.render()}).catch(s=>{throw console.error(s),s}))}hide(){this.studio.transaction(({drafts:s})=>{s.ahistoric.visibilityState="everythingIsHidden"})}restore(){this.render(),this.studio.transaction(({drafts:s})=>{s.ahistoric.visibilityState="everythingIsVisible"})}get isHidden(){return(0,Ebe.val)(this.studio.atomP.ahistoric.visibilityState)==="everythingIsHidden"}renderToolset(s,l){let u=!1,m=null;return this._nonSSRBits.then(_=>{u||(m=_.renderToolset(s,l))}).catch(_=>{console.error(_)}),()=>{if(m){m();return}u||(u=!0)}}},xA=mn();function Mbe(s){return s}var Cbe=(s,l=Mbe)=>{let u=m=>({type:s,payload:l(m)});return u.type=s,u.is=m=>m&&m.type&&m.type===s,u},Dp=Cbe,ihe=Q(hbe()),she=Q(xbe());Cy();var bA,Abe=new Uint8Array(16);function Pbe(){if(!bA&&(bA=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!bA))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return bA(Abe)}var Rbe=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function kbe(s){return typeof s=="string"&&Rbe.test(s)}var Ibe=kbe,t0=[];for(SA=0;SA<256;++SA)t0.push((SA+256).toString(16).substr(1));var SA;function Nbe(s){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,u=(t0[s[l+0]]+t0[s[l+1]]+t0[s[l+2]]+t0[s[l+3]]+"-"+t0[s[l+4]]+t0[s[l+5]]+"-"+t0[s[l+6]]+t0[s[l+7]]+"-"+t0[s[l+8]]+t0[s[l+9]]+"-"+t0[s[l+10]]+t0[s[l+11]]+t0[s[l+12]]+t0[s[l+13]]+t0[s[l+14]]+t0[s[l+15]]).toLowerCase();if(!Ibe(u))throw TypeError("Stringified UUID is invalid");return u}var Dbe=Nbe;function Obe(s,l,u){s=s||{};var m=s.random||(s.rng||Pbe)();if(m[6]=m[6]&15|64,m[8]=m[8]&63|128,l){u=u||0;for(var _=0;_<16;++_)l[u+_]=m[_];return l}return Dbe(m)}var Fbe=Obe,mS={replaceHistory:Dp("@history/replaceHistory"),startHistoryFromScratch:Dp("@history/startHistoryFromScratch"),undo:Dp("@history/undo"),redo:Dp("@history/redo")},Lbe={type:"@history/unknownAction",payload:""},Bbe={maxNumberOfCommits:100},Ube=(s,l=Bbe)=>{let u=qL(s(void 0,Lbe));return function(m,_){return mS.startHistoryFromScratch.is(_)?qL(s(void 0,_.payload)):mS.replaceHistory.is(_)?_.payload:mS.undo.is(_)?m?Gbe(m):u:mS.redo.is(_)?m?jbe(m):u:m?zbe(m,s(m.innerState,_),l):qL(s(void 0,_))}};function qL(s){return{currentCommitHash:void 0,commitsByHash:{},listOfCommitHashes:[],innerState:s}}function zbe(s,l,u){if(l===s.innerState)return s;let m=Vbe(s.innerState,l);if(m.forwardDiff.length===0)return s;let _=dm(s.listOfCommitHashes),b={currentCommitHash:m.hash,commitsByHash:R({},s.commitsByHash),listOfCommitHashes:[...s.listOfCommitHashes],innerState:l};if(s.currentCommitHash!==_){let E=s.listOfCommitHashes.findIndex(T=>T===s.currentCommitHash);s.listOfCommitHashes.slice(E+1).forEach(T=>{delete b.commitsByHash[T]}),b.listOfCommitHashes.splice(E+1,b.listOfCommitHashes.length)}if(b.listOfCommitHashes.push(m.hash),b.commitsByHash[m.hash]=m,b.listOfCommitHashes.length>u.maxNumberOfCommits){let E=b.listOfCommitHashes.length-u.maxNumberOfCommits;b.listOfCommitHashes.slice(0,E).forEach(T=>{delete b.commitsByHash[T]}),b.listOfCommitHashes.splice(0,E)}return b}function Vbe(s,l){let u=ihe.default.diff(s,l,{invertible:!1}),m=ihe.default.diff(l,s,{invertible:!1}),_=Date.now(),b=Fbe();return{forwardDiff:u,backwardDiff:m,timestamp:_,hash:b}}function Gbe(s){if(s.currentCommitHash===void 0)return s;let l=s.listOfCommitHashes.findIndex(E=>E===s.currentCommitHash);if(l===-1)throw new Error("This should never happen");let u=s.commitsByHash[s.currentCommitHash],m=(0,she.default)(s.innerState,u.backwardDiff),_=l-1,b=_===-1?void 0:s.listOfCommitHashes[_];return $(R({},s),{currentCommitHash:b,innerState:m})}function jbe(s){if(s.listOfCommitHashes.length===0)return s;let l=s.listOfCommitHashes.findIndex(E=>E===s.currentCommitHash);if(l===s.listOfCommitHashes.length-1)return s;let u=l+1,m=s.listOfCommitHashes[u],_=s.commitsByHash[m],b=(0,she.default)(s.innerState,_.forwardDiff);return $(R({},s),{currentCommitHash:m,innerState:b})}nA();var wA={ahistoric:{visibilityState:"everythingIsVisible",theTrigger:{position:{closestCorner:"bottomLeft",distanceFromHorizontalEdge:.02,distanceFromVerticalEdge:.02}},coreByProject:{},projects:{stateByProjectId:{}}},historic:{projects:{stateByProjectId:{}},autoKey:!0,coreByProject:{},panelInstanceDesceriptors:{}},ephemeral:{initialised:!1,coreByProject:{},projects:{stateByProjectId:{}},extensions:{byId:{},paneClasses:{}},showOutline:!1}},ohe=Dp("@storeBundle/replacePersistentState",s=>s),ahe=Dp("@storeBundle/reduceParts",s=>s),jv={historic:mS,replacePersistentState:ohe,reduceParts:ahe},lhe=Dp("@storeBundle/setInnerHistoricState",s=>s),Hbe=(s=wA.historic,l)=>lhe.is(l)?l.payload:s,XL=Ube(Hbe),che=(s,l)=>{if(ohe.is(l)){let{historic:u,ahistoric:m}=l.payload,_=(s==null?void 0:s.ephemeral)||wA.ephemeral;return{$persistent:{historic:u,ahistoric:m},ephemeral:_}}else if(s){let{historic:u,ahistoric:m}=s.$persistent,{ephemeral:_}=s;if(ahe.is(l)){let b={historic:s.$persistent.historic.innerState,ahistoric:s.$persistent.ahistoric,ephemeral:s.ephemeral},E=l.payload(b);if(E===b)return s;u.innerState!==E.historic&&(u=XL(u,lhe(E.historic))),m=E.ahistoric,_=E.ephemeral}else{let b=XL(u,l);if(b===u)return s;u=b}return{$persistent:u===s.$persistent.historic&&m===s.$persistent.ahistoric?s.$persistent:{historic:u,ahistoric:m},ephemeral:_}}else{let u=XL(void 0,{}),m=wA.ahistoric,_=wA.ephemeral;return{$persistent:{historic:u,ahistoric:m},ephemeral:_}}},uhe=Dp("@history/pushTempAction",s=>s),hhe=Dp("@history/discardTempAction",s=>s),dhe=Dp("@history/commitTempAction",s=>s),Wbe=0,$be=()=>{let s=Wbe++;return{push:l=>uhe({id:s,originalAction:l}),discard:()=>hhe(s),commit:()=>dhe(s)}},qbe=(s,l)=>{if(s){let{tempActions:u,permanent:m}=s.$temps,_;if(uhe.is(l))u=[...u,l];else if(dhe.is(l)){let E=u.find(T=>T.payload.id===l.payload);E?(_=E.payload.originalAction,u=u.filter(T=>T.payload.id!==l.payload)):tA.error("Comitting temp action group ".concat(l.payload," isn't possible as this group doesn't exist"))}else hhe.is(l)?u=u.filter(E=>E.payload.id!==l.payload):_=l;_&&(m=che(s.$temps.permanent,_));let b={historic:m.$persistent.historic.innerState,ahistoric:m.$persistent.ahistoric,ephemeral:m.ephemeral};for(let E of u)b=E.payload.originalAction.payload(b);return R({$temps:{tempActions:u,permanent:m},$persistent:m.$persistent},b)}else{let u=che(void 0,l);return{$temps:{permanent:u,tempActions:[]},$persistent:u.$persistent,historic:u.$persistent.historic.innerState,ahistoric:u.$persistent.ahistoric,ephemeral:u.ephemeral}}};Sp(),Sp(),Dm();function fhe(s,l){if(typeof s!="object"||s===null)return;if(l.length===0){for(let E of Object.keys(s))delete s[E];return}let u=l.slice(0,l.length-1),m=s,_=new WeakMap;for(let E of u){let T=m,P=T[E];if(typeof P!="object"||P===null)return;_.set(P,T),m=P}let b=l.slice().reverse();for(let E of b){if(delete m[E],Object.keys(m).length>0)return;m=_.get(m)}}function Xbe(s,{scale:l,origin:u,translate:m}){let _=u+(s-u)*l;return m+_}function Dd(s){for(var l=arguments.length,u=Array(l>1?l-1:0),m=1;m<l;m++)u[m-1]=arguments[m];throw Error("[Immer] minified error nr: "+s+(u.length?" "+u.map(function(_){return"'"+_+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function Hv(s){return!!s&&!!s[ou]}function g8(s){return!!s&&(function(l){if(!l||typeof l!="object")return!1;var u=Object.getPrototypeOf(l);if(u===null)return!0;var m=Object.hasOwnProperty.call(u,"constructor")&&u.constructor;return m===Object||typeof m=="function"&&Function.toString.call(m)===tSe}(s)||Array.isArray(s)||!!s[whe]||!!s.constructor[whe]||KL(s)||ZL(s))}function gS(s,l,u){u===void 0&&(u=!1),Wv(s)===0?(u?Object.keys:cB)(s).forEach(function(m){u&&typeof m=="symbol"||l(m,s[m],s)}):s.forEach(function(m,_){return l(_,m,s)})}function Wv(s){var l=s[ou];return l?l.i>3?l.i-4:l.i:Array.isArray(s)?1:KL(s)?2:ZL(s)?3:0}function YL(s,l){return Wv(s)===2?s.has(l):Object.prototype.hasOwnProperty.call(s,l)}function Ybe(s,l){return Wv(s)===2?s.get(l):s[l]}function phe(s,l,u){var m=Wv(s);m===2?s.set(l,u):m===3?(s.delete(l),s.add(u)):s[l]=u}function Kbe(s,l){return s===l?s!==0||1/s==1/l:s!=s&&l!=l}function KL(s){return Jbe&&s instanceof Map}function ZL(s){return eSe&&s instanceof Set}function y8(s){return s.o||s.t}function QL(s){if(Array.isArray(s))return Array.prototype.slice.call(s);var l=nSe(s);delete l[ou];for(var u=cB(l),m=0;m<u.length;m++){var _=u[m],b=l[_];b.writable===!1&&(b.writable=!0,b.configurable=!0),(b.get||b.set)&&(l[_]={configurable:!0,writable:!0,enumerable:b.enumerable,value:s[_]})}return Object.create(Object.getPrototypeOf(s),l)}function JL(s,l){return l===void 0&&(l=!1),eB(s)||Hv(s)||!g8(s)||(Wv(s)>1&&(s.set=s.add=s.clear=s.delete=Zbe),Object.freeze(s),l&&gS(s,function(u,m){return JL(m,!0)},!0)),s}function Zbe(){Dd(2)}function eB(s){return s==null||typeof s!="object"||Object.isFrozen(s)}function Wm(s){var l=rSe[s];return l||Dd(18,s),l}function mhe(){return yS}function tB(s,l){l&&(Wm("Patches"),s.u=[],s.s=[],s.v=l)}function EA(s){nB(s),s.p.forEach(Qbe),s.p=null}function nB(s){s===yS&&(yS=s.l)}function ghe(s){return yS={p:[],l:yS,h:s,m:!0,_:0}}function Qbe(s){var l=s[ou];l.i===0||l.i===1?l.j():l.O=!0}function rB(s,l){l._=l.p.length;var u=l.p[0],m=s!==void 0&&s!==u;return l.h.g||Wm("ES5").S(l,s,m),m?(u[ou].P&&(EA(l),Dd(4)),g8(s)&&(s=TA(l,s),l.l||MA(l,s)),l.u&&Wm("Patches").M(u[ou],s,l.u,l.s)):s=TA(l,u,[]),EA(l),l.u&&l.v(l.u,l.s),s!==She?s:void 0}function TA(s,l,u){if(eB(l))return l;var m=l[ou];if(!m)return gS(l,function(b,E){return yhe(s,m,l,b,E,u)},!0),l;if(m.A!==s)return l;if(!m.P)return MA(s,m.t,!0),m.t;if(!m.I){m.I=!0,m.A._--;var _=m.i===4||m.i===5?m.o=QL(m.k):m.o;gS(m.i===3?new Set(_):_,function(b,E){return yhe(s,m,_,b,E,u)}),MA(s,_,!1),u&&s.u&&Wm("Patches").R(m,u,s.u,s.s)}return m.o}function yhe(s,l,u,m,_,b){if(Hv(_)){var E=TA(s,_,b&&l&&l.i!==3&&!YL(l.D,m)?b.concat(m):void 0);if(phe(u,m,E),!Hv(E))return;s.m=!1}if(g8(_)&&!eB(_)){if(!s.h.F&&s._<1)return;TA(s,_),l&&l.A.l||MA(s,_)}}function MA(s,l,u){u===void 0&&(u=!1),s.h.F&&s.m&&JL(l,u)}function iB(s,l){var u=s[ou];return(u?y8(u):s)[l]}function vhe(s,l){if(l in s)for(var u=Object.getPrototypeOf(s);u;){var m=Object.getOwnPropertyDescriptor(u,l);if(m)return m;u=Object.getPrototypeOf(u)}}function sB(s){s.P||(s.P=!0,s.l&&sB(s.l))}function oB(s){s.o||(s.o=QL(s.t))}function aB(s,l,u){var m=KL(l)?Wm("MapSet").N(l,u):ZL(l)?Wm("MapSet").T(l,u):s.g?function(_,b){var E=Array.isArray(_),T={i:E?1:0,A:b?b.A:mhe(),P:!1,I:!1,D:{},l:b,t:_,k:null,o:null,j:null,C:!1},P=T,N=AA;E&&(P=[T],N=PA);var z=Proxy.revocable(P,N),G=z.revoke,V=z.proxy;return T.k=V,T.j=G,V}(l,u):Wm("ES5").J(l,u);return(u?u.A:mhe()).p.push(m),m}function CA(s){return Hv(s)||Dd(22,s),function l(u){if(!g8(u))return u;var m,_=u[ou],b=Wv(u);if(_){if(!_.P&&(_.i<4||!Wm("ES5").K(_)))return _.t;_.I=!0,m=_he(u,b),_.I=!1}else m=_he(u,b);return gS(m,function(E,T){_&&Ybe(_.t,E)===T||phe(m,E,l(T))}),b===3?new Set(m):m}(s)}function _he(s,l){switch(l){case 2:return new Map(s);case 3:return Array.from(s)}return QL(s)}var xhe,yS,lB=typeof Symbol<"u"&&typeof Symbol("x")=="symbol",Jbe=typeof Map<"u",eSe=typeof Set<"u",bhe=typeof Proxy<"u"&&Proxy.revocable!==void 0&&typeof Reflect<"u",She=lB?Symbol.for("immer-nothing"):((xhe={})["immer-nothing"]=!0,xhe),whe=lB?Symbol.for("immer-draftable"):"__$immer_draftable",ou=lB?Symbol.for("immer-state"):"__$immer_state",tSe=""+Object.prototype.constructor,cB=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols!==void 0?function(s){return Object.getOwnPropertyNames(s).concat(Object.getOwnPropertySymbols(s))}:Object.getOwnPropertyNames,nSe=Object.getOwnPropertyDescriptors||function(s){var l={};return cB(s).forEach(function(u){l[u]=Object.getOwnPropertyDescriptor(s,u)}),l},rSe={},AA={get:function(s,l){if(l===ou)return s;var u=y8(s);if(!YL(u,l))return function(_,b,E){var T,P=vhe(b,E);return P?"value"in P?P.value:(T=P.get)===null||T===void 0?void 0:T.call(_.k):void 0}(s,u,l);var m=u[l];return s.I||!g8(m)?m:m===iB(s.t,l)?(oB(s),s.o[l]=aB(s.A.h,m,s)):m},has:function(s,l){return l in y8(s)},ownKeys:function(s){return Reflect.ownKeys(y8(s))},set:function(s,l,u){var m=vhe(y8(s),l);if(m!=null&&m.set)return m.set.call(s.k,u),!0;if(!s.P){var _=iB(y8(s),l),b=_==null?void 0:_[ou];if(b&&b.t===u)return s.o[l]=u,s.D[l]=!1,!0;if(Kbe(u,_)&&(u!==void 0||YL(s.t,l)))return!0;oB(s),sB(s)}return s.o[l]===u&&typeof u!="number"&&(u!==void 0||l in s.o)||(s.o[l]=u,s.D[l]=!0,!0)},deleteProperty:function(s,l){return iB(s.t,l)!==void 0||l in s.t?(s.D[l]=!1,oB(s),sB(s)):delete s.D[l],s.o&&delete s.o[l],!0},getOwnPropertyDescriptor:function(s,l){var u=y8(s),m=Reflect.getOwnPropertyDescriptor(u,l);return m&&{writable:!0,configurable:s.i!==1||l!=="length",enumerable:m.enumerable,value:u[l]}},defineProperty:function(){Dd(11)},getPrototypeOf:function(s){return Object.getPrototypeOf(s.t)},setPrototypeOf:function(){Dd(12)}},PA={};gS(AA,function(s,l){PA[s]=function(){return arguments[0]=arguments[0][0],l.apply(this,arguments)}}),PA.deleteProperty=function(s,l){return AA.deleteProperty.call(this,s[0],l)},PA.set=function(s,l,u){return AA.set.call(this,s[0],l,u,s[0])};var iSe=function(){function s(u){var m=this;this.g=bhe,this.F=!0,this.produce=function(_,b,E){if(typeof _=="function"&&typeof b!="function"){var T=b;b=_;var P=m;return function(B){var H=this;B===void 0&&(B=T);for(var j=arguments.length,X=Array(j>1?j-1:0),K=1;K<j;K++)X[K-1]=arguments[K];return P.produce(B,function(te){var se;return(se=b).call.apply(se,[H,te].concat(X))})}}var N;if(typeof b!="function"&&Dd(6),E!==void 0&&typeof E!="function"&&Dd(7),g8(_)){var z=ghe(m),G=aB(m,_,void 0),V=!0;try{N=b(G),V=!1}finally{V?EA(z):nB(z)}return typeof Promise<"u"&&N instanceof Promise?N.then(function(B){return tB(z,E),rB(B,z)},function(B){throw EA(z),B}):(tB(z,E),rB(N,z))}if(!_||typeof _!="object")return(N=b(_))===She?void 0:(N===void 0&&(N=_),m.F&&JL(N,!0),N);Dd(21,_)},this.produceWithPatches=function(_,b){return typeof _=="function"?function(P){for(var N=arguments.length,z=Array(N>1?N-1:0),G=1;G<N;G++)z[G-1]=arguments[G];return m.produceWithPatches(P,function(V){return _.apply(void 0,[V].concat(z))})}:[m.produce(_,b,function(P,N){E=P,T=N}),E,T];var E,T},typeof(u==null?void 0:u.useProxies)=="boolean"&&this.setUseProxies(u.useProxies),typeof(u==null?void 0:u.autoFreeze)=="boolean"&&this.setAutoFreeze(u.autoFreeze)}var l=s.prototype;return l.createDraft=function(u){g8(u)||Dd(8),Hv(u)&&(u=CA(u));var m=ghe(this),_=aB(this,u,void 0);return _[ou].C=!0,nB(m),_},l.finishDraft=function(u,m){var _=u&&u[ou],b=_.A;return tB(b,m),rB(void 0,b)},l.setAutoFreeze=function(u){this.F=u},l.setUseProxies=function(u){u&&!bhe&&Dd(20),this.g=u},l.applyPatches=function(u,m){var _;for(_=m.length-1;_>=0;_--){var b=m[_];if(b.path.length===0&&b.op==="replace"){u=b.value;break}}var E=Wm("Patches").$;return Hv(u)?E(u,m):this.produce(u,function(T){return E(T,m.slice(_+1))})},s}(),au=new iSe;au.produce,au.produceWithPatches.bind(au),au.setAutoFreeze.bind(au),au.setUseProxies.bind(au),au.applyPatches.bind(au);var uB=au.createDraft.bind(au),hB=au.finishDraft.bind(au);ZI(),JI(),aN(),Oy(),cN(),JC(),Fo(),ai();var Od={create(s){let l={byId:{},allIds:{}};if(s)for(let[u,m]of s)l.byId[u]=m,l.allIds[u]=!0;return l},shallowCopy(s){return{byId:R({},s==null?void 0:s.byId),allIds:R({},s==null?void 0:s.allIds)}},add(s,l,u){return{byId:$(R({},s==null?void 0:s.byId),{[l]:u}),allIds:$(R({},s==null?void 0:s.allIds),{[l]:!0})}},merge(s){let l=Od.create();for(let u=0;u<s.length;u++)l.byId=R(R({},l.byId),s[u].byId),l.allIds=R(R({},l.allIds),s[u].allIds);return l},remove(s,l){let u=Od.shallowCopy(s);return delete u.allIds[l],delete u.byId[l],u},filter(s,l){let u=Od.shallowCopy(s);for(let[m,_]of Object.entries(u.byId))l(_)||(delete u.allIds[m],delete u.byId[m]);return u}},Ehe=s=>(dB=s,fB),dB,n0=()=>{if(dB===void 0)throw new Error("Calling stateEditors outside of a transaction is not allowed.");return dB},fB;(s=>{(l=>{(u=>{(m=>{function _(b){let E=n0().historic;E.panelPositions!=null||(E.panelPositions={}),E.panelPositions[b.panelId]=b.position}m.setPanelPosition=_})(u.panelPositions||(u.panelPositions={})),(m=>{function _(){var b;return(b=n0().historic).panels!=null||(b.panels={}),n0().historic.panels}m._ensure=_,(b=>{function E(){let T=s.studio.historic.panels._ensure();return T.outlinePanel!=null||(T.outlinePanel={}),T.outlinePanel}b._ensure=E,(T=>{function P(z){let G=[];for(let V of ip(z))dt(V)?G.push(R({type:"Project"},V.address)):Dt(V)?(G.push(R({type:"Sheet"},V.template.address)),s.studio.historic.projects.stateByProjectId.stateBySheetId.setSelectedInstanceId(V.address)):gn(V)?G.push(R({type:"Sheet"},V.address)):qt(V)?(G.push(R({type:"SheetObject"},V.template.address)),s.studio.historic.projects.stateByProjectId.stateBySheetId.setSelectedInstanceId(V.sheet.address)):nr(V)&&G.push(R({type:"SheetObject"},V.address));b._ensure().selection=G}T.set=P;function N(){b._ensure().selection=[]}T.unset=N})(b.selection||(b.selection={}))})(m.outline||(m.outline={})),(b=>{function E(){let T=s.studio.historic.panels._ensure();return T.sequenceEditor!=null||(T.sequenceEditor={}),T.sequenceEditor}b._ensure=E,(T=>{function P(){let z=b._ensure();return z.graphEditor!=null||(z.graphEditor={height:.5,isOpen:!1}),z.graphEditor}function N(z){P().isOpen=z.isOpen}T.setIsOpen=N})(b.graphEditor||(b.graphEditor={}))})(m.sequenceEditor||(m.sequenceEditor={}))})(u.panels||(u.panels={})),(m=>{(_=>{function b(E){let T=n0().historic;return T.projects.stateByProjectId[E.projectId]||(T.projects.stateByProjectId[E.projectId]={stateBySheetId:{}}),T.projects.stateByProjectId[E.projectId]}_._ensure=b,(E=>{function T(N){let z=s.studio.historic.projects.stateByProjectId._ensure(N);return z.stateBySheetId[N.sheetId]||(z.stateBySheetId[N.sheetId]={selectedInstanceId:void 0,sequenceEditor:{selectedPropsByObject:{}}}),z.stateBySheetId[N.sheetId]}E._ensure=T;function P(N){s.studio.historic.projects.stateByProjectId.stateBySheetId._ensure(N).selectedInstanceId=N.sheetInstanceId}E.setSelectedInstanceId=P,(N=>{function z(X){let{selectedPropsByObject:K}=E._ensure(X).sequenceEditor;K[X.objectKey]||(K[X.objectKey]={});let te=K[X.objectKey],se=bp(X.pathToProp),pe=new Set(Object.keys(sS));for(let[ve,Ne]of Object.entries(CA(K)))for(let[ze,Me]of Object.entries(Ne))pe.delete(Me);let fe=pe.size>0?pe.values().next().value:Object.keys(sS)[0];te[se]=fe}N.addPropToGraphEditor=z;function G(X){let{selectedPropsByObject:K}=E._ensure(X).sequenceEditor;if(!K[X.objectKey])return;let te=K[X.objectKey],se=bp(X.pathToProp);te[se]&&fhe(K,[X.objectKey,se])}N.removePropFromGraphEditor=G;function V(X){let K=s.studio.historic.projects.stateByProjectId.stateBySheetId._ensure(X).sequenceEditor;return K.markerSet||(K.markerSet=Od.create()),K.markerSet}function B(X){let K=V(X.sheetAddress),te=X.markers.filter(ve=>!!isFinite(ve.position)).map(ve=>$(R({},ve),{position:X.snappingFunction(ve.position)})),se=b5(te,"id"),pe=Od.filter(K,ve=>ve&&!se[ve.id]),fe=b5(Object.values(pe.byId),"position");te.forEach(({position:ve})=>{let Ne=fe[ve];Ne&&(pe=Od.remove(pe,Ne.id))}),Object.assign(K,Od.merge([pe,Od.create(te.map(ve=>[ve.id,ve]))]))}N.replaceMarkers=B;function H(X){let K=V(X.sheetAddress);Object.assign(K,Od.remove(K,X.markerId))}N.removeMarker=H;function j(X){let K=V(X.sheetAddress).byId[X.markerId];K!==void 0&&(K.label=X.label)}N.updateMarker=j})(E.sequenceEditor||(E.sequenceEditor={}))})(_.stateBySheetId||(_.stateBySheetId={}))})(m.stateByProjectId||(m.stateByProjectId={}))})(u.projects||(u.projects={}))})(l.historic||(l.historic={})),(u=>{function m(_){n0().ephemeral.showOutline=_}u.setShowOutline=m,(_=>{(b=>{function E(T){let P=n0().ephemeral;return P.projects.stateByProjectId[T.projectId]||(P.projects.stateByProjectId[T.projectId]={stateBySheetId:{}}),P.projects.stateByProjectId[T.projectId]}b._ensure=E,(T=>{function P(N){let z=s.studio.ephemeral.projects.stateByProjectId._ensure(N);return z.stateBySheetId[N.sheetId]||(z.stateBySheetId[N.sheetId]={stateByObjectKey:{}}),z.stateBySheetId[N.sheetId]}T._ensure=P,(N=>{function z(G){var V;let B=s.studio.ephemeral.projects.stateByProjectId.stateBySheetId._ensure(G).stateByObjectKey;return B[V=G.objectKey]!=null||(B[V]={}),B[G.objectKey]}N._ensure=z,(G=>{function V(H){let j=s.studio.ephemeral.projects.stateByProjectId.stateBySheetId.stateByObjectKey._ensure(H);return j.valuesBeingScrubbed!=null||(j.valuesBeingScrubbed={}),j.valuesBeingScrubbed}G._ensure=V;function B(H){pm(V(H),H.pathToProp,!0)}G.flag=B})(N.propsBeingScrubbed||(N.propsBeingScrubbed={}))})(T.stateByObjectKey||(T.stateByObjectKey={}))})(b.stateBySheetId||(b.stateBySheetId={}))})(_.stateByProjectId||(_.stateByProjectId={}))})(u.projects||(u.projects={}))})(l.ephemeral||(l.ephemeral={})),(u=>{function m(P){n0().ahistoric.pinOutline=P}u.setPinOutline=m;function _(P){n0().ahistoric.pinDetails=P}u.setPinDetails=_;function b(P){n0().ahistoric.pinNotifications=P}u.setPinNotifications=b;function E(P){n0().ahistoric.visibilityState=P}u.setVisibilityState=E;function T(P){let N=dC(P.map(V=>V.pathToProp)),z=P.map(({keyframe:V,pathToProp:B})=>({keyframe:V,pathToProp:B.slice(N.length)})),G=n0();G.ahistoric.clipboard?G.ahistoric.clipboard.keyframesWithRelativePaths=z:G.ahistoric.clipboard={keyframesWithRelativePaths:z}}u.setClipboardKeyframes=T,(P=>{(N=>{function z(G){let V=n0().ahistoric;return V.projects.stateByProjectId[G.projectId]||(V.projects.stateByProjectId[G.projectId]={stateBySheetId:{}}),V.projects.stateByProjectId[G.projectId]}N._ensure=z,(G=>{function V(H){let j=s.studio.ahistoric.projects.stateByProjectId._ensure(H);return j.collapsedItemsInOutline||(j.collapsedItemsInOutline={}),j.collapsedItemsInOutline}G._ensure=V;function B(H){let j=s.studio.ahistoric.projects.stateByProjectId.collapsedItemsInOutline._ensure(H);H.isCollapsed?j[H.itemKey]=!0:delete j[H.itemKey]}G.set=B})(N.collapsedItemsInOutline||(N.collapsedItemsInOutline={})),(G=>{function V(B){let H=s.studio.ahistoric.projects.stateByProjectId._ensure(B);return H.stateBySheetId[B.sheetId]||(H.stateBySheetId[B.sheetId]={}),H.stateBySheetId[B.sheetId]}G._ensure=V,(B=>{function H(j){let X=s.studio.ahistoric.projects.stateByProjectId.stateBySheetId._ensure(j);return X.sequence||(X.sequence={}),X.sequence}B._ensure=H,(j=>{function X(te){s.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence._ensure(te).focusRange={range:te.range,enabled:te.enabled}}j.set=X;function K(te){s.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence._ensure(te).focusRange=void 0}j.unset=K})(B.focusRange||(B.focusRange={})),(j=>{function X(K){s.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence._ensure(K).clippedSpaceRange=R({},K.range)}j.set=X})(B.clippedSpaceRange||(B.clippedSpaceRange={})),(j=>{function X(te){let se=s.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence._ensure(te),pe=se.collapsableItems;return pe||(pe=se.collapsableItems=Od.create()),pe}function K(te){let se=X(te);Object.assign(se,Od.add(se,te.studioSheetItemKey,{isCollapsed:te.isCollapsed}))}j.set=K})(B.sequenceEditorCollapsableItems||(B.sequenceEditorCollapsableItems={}))})(G.sequence||(G.sequence={}))})(N.stateBySheetId||(N.stateBySheetId={}))})(P.stateByProjectId||(P.stateByProjectId={}))})(u.projects||(u.projects={}))})(l.ahistoric||(l.ahistoric={}))})(s.studio||(s.studio={})),(l=>{(u=>{(m=>{function _(b){let E=n0().historic.coreByProject[b.projectId].revisionHistory,T=50;E.unshift(b.revision),E.length>T&&(E.length=T)}m.add=_})(u.revisionHistory||(u.revisionHistory={})),(m=>{function _(T){let P=n0().historic.coreByProject[T.projectId].sheetsById;return P[T.sheetId]||(P[T.sheetId]={staticOverrides:{byObject:{}}}),P[T.sheetId]}m._ensure=_;function b(T){let P=n0().historic.coreByProject[T.projectId].sheetsById[T.sheetId];if(!P)return;delete P.staticOverrides.byObject[T.objectKey];let N=P.sequence;N&&delete N.tracksByObject[T.objectKey]}m.forgetObject=b;function E(T){n0().historic.coreByProject[T.projectId].sheetsById[T.sheetId]&&delete n0().historic.coreByProject[T.projectId].sheetsById[T.sheetId]}m.forgetSheet=E,(T=>{function P(Me){let He=s.coreByProject.historic.sheetsById._ensure(Me);return He.sequence!=null||(He.sequence={subUnitsPerUnit:30,length:10,type:"PositionalSequence",tracksByObject:{}}),He.sequence}T._ensure=P;function N(Me){P(Me).length=ii(parseFloat(Me.length.toFixed(2)),.01,1/0)}T.setLength=N;function z(Me){P(Me).subUnitsPerUnit=ii(Me.subUnitsPerUnit,1,L(2,12))}T.setSubUnitsPerUnit=z;function G(Me){var He;let vt=s.coreByProject.historic.sheetsById.sequence._ensure(Me).tracksByObject;return vt[He=Me.objectKey]!=null||(vt[He]={trackData:{},trackIdByPropPath:{}}),vt[Me.objectKey]}function V(Me,He){let vt=G(Me),xe=bp(Me.pathToProp);if(typeof vt.trackIdByPropPath[xe]=="string")return;let We=cve(),oe={type:"BasicKeyframedTrack",__debugName:"".concat(Me.objectKey,":").concat(xe),keyframes:[]};vt.trackData[We]=oe,vt.trackIdByPropPath[xe]=We}T.setPrimitivePropAsSequenced=V;function B(Me){let He=G(Me),vt=bp(Me.pathToProp),xe=He.trackIdByPropPath[vt];typeof xe=="string"&&(delete He.trackIdByPropPath[vt],delete He.trackData[xe],s.coreByProject.historic.sheetsById.staticOverrides.byObject.setValueOfPrimitiveProp(Me))}T.setPrimitivePropAsStatic=B;function H(Me){let He=G(Me);for(let vt of Object.keys(He.trackIdByPropPath)){let xe=JSON.parse(vt);if(Me.pathToProp.every((We,oe)=>xe[oe]===We)){let We=He.trackIdByPropPath[vt];if(typeof We!="string")continue;delete He.trackIdByPropPath[vt],delete He.trackData[We]}}s.coreByProject.historic.sheetsById.staticOverrides.byObject.setValueOfCompoundProp(Me)}T.setCompoundPropAsStatic=H;function j(Me){return G(Me).trackData[Me.trackId]}function X(Me){let He=j(Me);if(He)return He.keyframes.find(vt=>vt.id===Me.keyframeId)}function K(Me){let He=Me.snappingFunction(Me.position),vt=j(Me);if(!vt)return;let{keyframes:xe}=vt,We=xe.findIndex(dn=>dn.position===He);if(We!==-1){let dn=xe[We];dn.value=Me.value;return}let oe=bx(xe,dn=>dn.position<He);if(oe===-1){xe.unshift({id:TQ(),position:He,connectedRight:!0,handles:Me.handles||[.5,1,.5,0],type:Me.type||"bezier",value:Me.value});return}let nt=xe[oe];xe.splice(oe+1,0,{id:TQ(),position:He,connectedRight:nt.connectedRight,handles:Me.handles||[.5,1,.5,0],type:Me.type||"bezier",value:Me.value})}T.setKeyframeAtPosition=K;function te(Me){let He=j(Me);if(!He)return;let{keyframes:vt}=He,xe=vt.findIndex(We=>We.position===Me.position);xe!==-1&&vt.splice(xe,1)}T.unsetKeyframeAtPosition=te;function se(Me){let He=j(Me);if(!He)return;let vt=CA(He.keyframes).filter(xe=>Me.keyframeIds.includes(xe.id)).map(xe=>{let We=xe.position,oe=Me.snappingFunction(Xbe(We,Me));return $(R({},xe),{position:oe})});ze($(R({},Me),{keyframes:vt}))}T.transformKeyframes=se;function pe(Me){let He=j(Me);He&&(He.keyframes=He.keyframes.map((vt,xe)=>{let We=He.keyframes[xe-1],oe=Me.keyframeIds.includes(vt.id),nt=Me.keyframeIds.includes(We==null?void 0:We.id);return oe&&!nt?$(R({},vt),{handles:[vt.handles[0],vt.handles[1],Me.handles[0],Me.handles[1]]}):oe&&nt?$(R({},vt),{handles:[Me.handles[2],Me.handles[3],Me.handles[0],Me.handles[1]]}):nt?$(R({},vt),{handles:[Me.handles[2],Me.handles[3],vt.handles[2],vt.handles[3]]}):vt}))}T.setTweenBetweenKeyframes=pe;function fe(Me){var He,vt,xe,We,oe,nt,dn,Ve;let Be=X(Me);Be&&(Be.handles=[(vt=(He=Me.end)==null?void 0:He[0])!=null?vt:Be.handles[0],(We=(xe=Me.end)==null?void 0:xe[1])!=null?We:Be.handles[1],(nt=(oe=Me.start)==null?void 0:oe[0])!=null?nt:Be.handles[2],(Ve=(dn=Me.start)==null?void 0:dn[1])!=null?Ve:Be.handles[3]])}T.setHandlesForKeyframe=fe;function ve(Me){let He=j(Me);He&&(He.keyframes=He.keyframes.filter(vt=>Me.keyframeIds.indexOf(vt.id)===-1))}T.deleteKeyframes=ve;function Ne(Me){let He=X(Me);He&&(He.type=Me.keyframeType)}T.setKeyframeType=Ne;function ze(Me){let He=j(Me);if(!He)return;let vt=CA(He.keyframes),xe=Me.keyframes.filter(Ve=>!(typeof Ve.value=="number"&&!isFinite(Ve.value)||!Ve.handles.every(Be=>isFinite(Be)))).map(Ve=>$(R({},Ve),{position:Me.snappingFunction(Ve.position)})),We=b5(xe,"id"),oe=vt.filter(Ve=>!We[Ve.id]),nt=b5(oe,"position");xe.forEach(({position:Ve})=>{let Be=nt[Ve];Be&&pT(oe,Be)});let dn=gT([...oe,...xe],"position");He.keyframes=dn}T.replaceKeyframes=ze})(m.sequence||(m.sequence={})),(T=>{(P=>{function N(B){var H;let j=s.coreByProject.historic.sheetsById._ensure(B).staticOverrides.byObject;return j[H=B.objectKey]!=null||(j[H]={}),j[B.objectKey]}function z(B){let H=N(B);pm(H,B.pathToProp,B.value)}P.setValueOfCompoundProp=z;function G(B){let H=N(B);pm(H,B.pathToProp,B.value)}P.setValueOfPrimitiveProp=G;function V(B){let H=s.coreByProject.historic.sheetsById._ensure(B).staticOverrides.byObject[B.objectKey];H&&fhe(H,B.pathToProp)}P.unsetValueOfPrimitiveProp=V})(T.byObject||(T.byObject={}))})(m.staticOverrides||(m.staticOverrides={}))})(u.sheetsById||(u.sheetsById={}))})(l.historic||(l.historic={}))})(s.coreByProject||(s.coreByProject={}))})(fB||(fB={}));function pB(){let s,l,u=new Promise((_,b)=>{s=E=>{_(E),m.status="resolved"},l=E=>{b(E),m.status="rejected"}}),m={resolve:s,reject:l,promise:u,status:"pending"};return m}var sSe=mn();function oSe(s){let l=s.getState(),u=new sSe.Atom(l);return s.subscribe(()=>{let m=s.getState();u.set(m),l=m}),u}L2();function aSe(s){var l,u=s.Symbol;return typeof u=="function"?u.observable?l=u.observable:(l=u("observable"),u.observable=l):l="@@observable",l}var vS;typeof self<"u"?vS=self:typeof window<"u"?vS=window:typeof vo<"u"?vS=vo:vS=o;var lSe=aSe(vS),The=lSe,Mhe={INIT:"@@redux/INIT"};function Che(s,l,u){var m;if(typeof l=="function"&&typeof u>"u"&&(u=l,l=void 0),typeof u<"u"){if(typeof u!="function")throw new Error("Expected the enhancer to be a function.");return u(Che)(s,l)}if(typeof s!="function")throw new Error("Expected the reducer to be a function.");var _=s,b=l,E=[],T=E,P=!1;function N(){T===E&&(T=E.slice())}function z(){return b}function G(j){if(typeof j!="function")throw new Error("Expected listener to be a function.");var X=!0;return N(),T.push(j),function(){if(X){X=!1,N();var K=T.indexOf(j);T.splice(K,1)}}}function V(j){if(!Wc(j))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(typeof j.type>"u")throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(P)throw new Error("Reducers may not dispatch actions.");try{P=!0,b=_(b,j)}finally{P=!1}for(var X=E=T,K=0;K<X.length;K++){var te=X[K];te()}return j}function B(j){if(typeof j!="function")throw new Error("Expected the nextReducer to be a function.");_=j,V({type:Mhe.INIT})}function H(){var j,X=G;return j={subscribe:function(K){if(typeof K!="object")throw new TypeError("Expected the observer to be an object.");function te(){K.next&&K.next(z())}te();var se=X(te);return{unsubscribe:se}}},j[The]=function(){return this},j}return V({type:Mhe.INIT}),m={dispatch:V,subscribe:G,getState:z,replaceReducer:B},m[The]=H,m}function cSe(){for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return l.length===0?function(m){return m}:l.length===1?l[0]:l.reduce(function(m,_){return function(){return m(_.apply(void 0,arguments))}})}function uSe(s){let l=cSe();return Che(s.rootReducer,void 0,l)}nA(),qE();var mB=new WeakMap,hSe=(s,l,u)=>{let m=P=>{s.dispatch(jv.replacePersistentState(P))},_=Ahe(u),b=()=>s.getState().$persistent;T();let E=()=>{let P=b(),N=mB.get(s);P!==N&&(mB.set(s,P),localStorage.setItem(_,JSON.stringify(P)))};s.subscribe(My(E,1e3)),window&&window.addEventListener("beforeunload",E);function T(){let P=localStorage.getItem(_);if(P){let N,z=!0;try{N=JSON.parse(P),z=!1}catch{tA.warn("Could not parse Theatre's persisted state. This must be a bug. Please report it.")}finally{z||m(N),l()}}else l()}},dSe=(s,l)=>{let u=Ahe(l),m=s.getState().$persistent;localStorage.removeItem(u),mB.set(s,m)};function Ahe(s){return s+".persistent"}OJ(),ai(),Hf(),nT(),_t(),DM();var RA=mn();I9(),Fo(),xce();function gB(s){if(typeof s=="boolean"||typeof s=="string"||typeof s=="number")return s;if(Wc(s)){let l={},u=!1;for(let[m,_]of Object.entries(s))gB(_)!==void 0&&(l[m]=_,u=!0);if(u)return l}else return}function Phe(s,l,u){for(let[m,_]of Object.entries(s.props))if(_.type==="compound")Phe(_,[...l,m],u);else{if(_.type==="enum")throw new Error("Not yet implemented");u(_,[...l,m])}}function fSe(s,l,u){return{set:(m,_)=>{s();let b=gB(_);if(typeof b>"u")return;let{root:E,path:T}=(0,RA.getPointerParts)(m);if(qt(E)){let P=E.template.getMapOfValidSequenceTracks_forStudio().getValue(),N=PM(E.template.staticConfig,T);if(!N)throw new Error("Object ".concat(E.address.objectKey," does not have a prop at ").concat(JSON.stringify(T)));let z=(G,V,B)=>{if(G==null)return;if(gB(V.deserializeAndSanitize(G))===void 0)throw new Error("Invalid value ".concat(ML(G)," for object.props").concat(B.map(X=>"[".concat(JSON.stringify(X),"]")).join("")," is invalid"));let H=$(R({},E.address),{pathToProp:B}),j=jc(P,B);if(typeof j=="string"){let X=E.sheet.getSequence();X.position=X.closestGridPosition(X.position),l.coreByProject.historic.sheetsById.sequence.setKeyframeAtPosition($(R({},H),{trackId:j,position:X.position,value:G,snappingFunction:X.closestGridPosition,type:"bezier"}))}else l.coreByProject.historic.sheetsById.staticOverrides.byObject.setValueOfPrimitiveProp($(R({},H),{value:G}))};if(N.type==="compound"){let G=(0,RA.getPointerParts)(m).path,V=G.length;Phe(N,G,(B,H)=>{let j=H.slice(V),X=D9(b,j);if(typeof X<"u")z(X,B,H);else throw new Error("Property object.props".concat(H.map(K=>"[".concat(JSON.stringify(K),"]")).join("")," is required but not provided"))})}else{if(N.type==="enum")throw new Error("Enums aren't implemented yet");z(b,N,T)}}else if(wn(E)){let[P]=T;if(P==="subUnitsPerUnit"){if(typeof b!="number"||!Py(b)||b<1)throw new Error("Value ".concat(b," is not an integer, which is required for setting sequence prop ").concat(P));l.coreByProject.historic.sheetsById.sequence.setSubUnitsPerUnit($(R({},E.address),{subUnitsPerUnit:b}))}else if(P==="length"){if(typeof b!="number"||b<=.001)throw new Error("Value ".concat(b," is not a positive number, which is required for setting sequence prop ").concat(P));l.coreByProject.historic.sheetsById.sequence.setLength($(R({},E.address),{length:b}))}else throw new Error("Setting sequence prop ".concat(P," is not supported"))}else throw new Error("Only setting props of SheetObject-s and sequences is supported in a transaction so far")},unset:m=>{s();let{root:_,path:b}=(0,RA.getPointerParts)(m);if(qt(_)){let E=_.template.getMapOfValidSequenceTracks_forStudio().getValue(),T=D9(_.template.getDefaultValues().getValue(),b),P=PM(_.template.staticConfig,b),N=(z,G)=>{let V=$(R({},_.address),{pathToProp:G}),B=jc(E,G);typeof B=="string"?l.coreByProject.historic.sheetsById.sequence.unsetKeyframeAtPosition($(R({},V),{trackId:B,position:_.sheet.getSequence().positionSnappedToGrid})):P!==void 0&&l.coreByProject.historic.sheetsById.staticOverrides.byObject.unsetValueOfPrimitiveProp(V)};P.type==="compound"?lt(T,(z,G)=>{N(z,G)},(0,RA.getPointerParts)(m).path):N(T,b)}else throw new Error("Only setting props of SheetObject-s is supported in a transaction so far")},get drafts(){return s(),u},get stateEditors(){return l}}}var pSe=class{constructor(){le(this,"_reduxStore"),le(this,"_atom"),le(this,"atomP"),this._reduxStore=uSe({rootReducer:qbe}),this._atom=oSe(this._reduxStore),this.atomP=this._atom.pointer}initialize(s){let l=pB();return s.usePersistentStorage===!0?hSe(this._reduxStore,()=>{this.tempTransaction(({drafts:u})=>{u.ephemeral.initialised=!0}).commit(),l.resolve()},s.persistenceKey):(this.tempTransaction(({drafts:u})=>{u.ephemeral.initialised=!0}).commit(),l.resolve()),l.promise}getState(){return this._reduxStore.getState()}__experimental_clearPersistentStorage(s){return dSe(this._reduxStore,s),this.getState()}__dev_startHistoryFromScratch(s){this._reduxStore.dispatch(jv.historic.startHistoryFromScratch(jv.reduceParts(l=>$(R({},l),{historic:s}))))}tempTransaction(s){let l=$be(),u,m=l.push(jv.reduceParts(_=>{let b={historic:uB(_.historic),ahistoric:uB(_.ahistoric),ephemeral:uB(_.ephemeral)},E=!0,T=()=>{if(!E)throw new Error("You seem to have called the transaction api after studio.transaction() has finished running")},P=Ehe(b),N=fSe(T,P,b);try{return s(N),E=!1,{historic:hB(b.historic),ahistoric:hB(b.ahistoric),ephemeral:hB(b.ephemeral)}}catch(z){return u=z,_}finally{Ehe(void 0)}}));if(this._reduxStore.dispatch(m),u)throw this._reduxStore.dispatch(l.discard()),u;return{commit:()=>{this._reduxStore.dispatch(l.commit())},discard:()=>{this._reduxStore.dispatch(l.discard())}}}undo(){this._reduxStore.dispatch(jv.historic.undo())}redo(){this._reduxStore.dispatch(jv.historic.redo())}createContentOfSaveFile(s){if(!this._reduxStore.getState().$persistent.historic.innerState.coreByProject[s])throw new Error("Project ".concat(s," has not been initialized."));let l=DJ();this.tempTransaction(({stateEditors:m})=>{m.coreByProject.historic.revisionHistory.add({projectId:s,revision:l})}).commit();let u=this._reduxStore.getState().$persistent.historic.innerState.coreByProject[s];return R({},u)}},mSe=mn(),yB=class{constructor(){le(this,"_values",{})}get(s,l){if(this.has(s))return this._values[s];{let u=l();return this._values[s]=u,u}}has(s){return this._values.hasOwnProperty(s)}};ai(),A9(),Ae(),Fo(),SL();var gSe=class{constructor(s){le(this,"ui",{hide(){Se().ui.hide()},get isHidden(){return Se().ui.isHidden},restore(){Se().ui.restore()},renderToolset(l,u){return Se().ui.renderToolset(l,u)}}),le(this,"_cache",new yB),le(this,"__experimental",{__experimental_disblePlayPauseKeyboardShortcut(){bxe()},__experimental_enablePlayPauseKeyboardShortcut(){Sxe()},__experimental_clearPersistentStorage(l){return Se().clearPersistentStorage(l)},__experimental_createContentOfSaveFileTyped(l){return Se().createContentOfSaveFile(l)}})}initialize(s){return Se().initialize(s)}extend(s,l){Se().extend(s,l)}transaction(s){return Se().transaction(({set:l,unset:u,stateEditors:m})=>s({set:l,unset:u,__experimental_forgetObject:_=>{if(!ni(_))throw new Error("object in transactionApi.__experimental_forgetObject(object) must be the return type of sheet.object(...)");m.coreByProject.historic.sheetsById.forgetObject(_.address)},__experimental_forgetSheet:_=>{if(!qn(_))throw new Error("sheet in transactionApi.__experimental_forgetSheet(sheet) must be the return type of project.sheet()");m.coreByProject.historic.sheetsById.forgetSheet(_.address)}}))}_getSelectionPrism(){return this._cache.get("_getSelectionPrism()",()=>(0,mSe.prism)(()=>C9().filter(s=>s.type==="Theatre_SheetObject"||s.type==="Theatre_Sheet").map(s=>s.publicApi)))}_getSelection(){return this._getSelectionPrism().getValue()}setSelection(s){let l=[...s].filter(u=>ni(u)||qn(u)).map(u=>Se().corePrivateAPI(u));Se().transaction(({stateEditors:u})=>{u.studio.historic.panels.outline.selection.set(l)})}onSelectionChange(s){let l=Se();return this._getSelectionPrism().onChange(l.ticker,s,!0)}get selection(){return this._getSelection()}scrub(){return Se().scrub()}getStudioProject(){let s=Se().core;if(!s)throw new Error("You're calling studio.getStudioProject() before `@theatre/core` is loaded. To fix this:\n1. Check if `@theatre/core` is import/required in your bundle.\n2. Check the stack trace of this error and make sure the funciton that calls getStudioProject() is run after `@theatre/core` is loaded.");return Se().getStudioProject(s)}debouncedScrub(s=1e3){let l,u=My(()=>{let m=l;m&&(l=void 0,m.commit())},s);return{capture:m=>{l||(l=this.scrub());let _=!0;try{l.capture(m),_=!1}finally{if(_){let b=l;l=void 0,b.discard()}else u()}}}}createPane(s){return Se().paneManager.createPane(s)}destroyPane(s){return Se().paneManager.destroyPane(s)}createContentOfSaveFile(s){return Se().createContentOfSaveFile(s)}};EQ();var v8=mn(),ySe=class{constructor(s){this._studio=s,le(this,"_cache",new yB),this._instantiatePanesAsTheyComeIn()}_instantiatePanesAsTheyComeIn(){let s=this._getAllPanes();s.onStale(()=>{s.getValue()})}_getAllPanes(){return this._cache.get("_getAllPanels()",()=>(0,v8.prism)(()=>{if(!(0,v8.val)(this._studio.coreP))return{};let s=(0,v8.val)(this._studio.atomP.historic.panelInstanceDesceriptors),l=(0,v8.val)(this._studio.atomP.ephemeral.extensions.paneClasses),u={};for(let m of Object.values(s)){if(!m)continue;let _=l[m.paneClass];if(!_)continue;let{instanceId:b}=m,{extensionId:E,classDefinition:T}=_,P=v8.prism.memo("instance-".concat(m.instanceId),()=>({extensionId:E,instanceId:b,definition:T}),[T]);u[b]=P}return u}))}get allPanesD(){return this._getAllPanes()}createPane(s){if(!this._studio.core)throw new Error("Can't create a pane because @theatre/core is not yet loaded");let l=(0,v8.val)(this._studio.atomP.ephemeral.extensions.paneClasses[s].extensionId),u=(0,v8.val)(this._studio.atomP.historic.panelInstanceDesceriptors),m;for(let _=1;_<1e3&&(m="".concat(s," #").concat(_),!!u[m]);_++);if(!l)throw new Error('Pane class "'.concat(s,'" is not registered.'));return this._studio.transaction(({drafts:_})=>{_.historic.panelInstanceDesceriptors[m]={instanceId:m,paneClass:s}}),this._getAllPanes().getValue()[m]}destroyPane(s){if(!this._studio.core)throw new Error("Can't do this yet because @theatre/core is not yet loaded");this._studio.transaction(({drafts:l})=>{delete l.historic.panelInstanceDesceriptors[s]})}},kA=mn();Ae();var Rhe=30*60*1e3,vSe=1e3*60*60;function _Se(){return Ue(this,null,function*(){let s=Se().atomP.ahistoric.visibilityState;if((0,kA.val)(s)==="everythingIsVisible")return;let l=pB(),u=(0,kA.pointerToPrism)(s).onStale(()=>{(0,kA.val)(s)==="everythingIsVisible"&&(u(),l.resolve(void 0))});return l.promise})}function xSe(){return Ue(this,null,function*(){if(!"0.7.2".match(/COMPAT/))for(yield IA(500),yield _Se();;){let s=(0,kA.val)(Se().atomP.ahistoric.updateChecker);if(s&&s.result!=="error"){let l=s.lastChecked,u=Date.now(),m=Math.abs(u-l);m<Rhe&&(yield IA(Rhe-m))}try{let l=yield fetch(new Request("https://updates.theatrejs.com/updates/0.7.2"));if(l.ok){let u=yield l.json();if(!bSe(u))throw new Error("Bad response");Se().transaction(({drafts:m})=>{m.ahistoric.updateChecker={lastChecked:Date.now(),result:R({},u)}}),yield IA(1e3)}else throw new Error("HTTP Error ".concat(l.statusText))}catch{yield IA(vSe)}}})}var IA=s=>new Promise(l=>setTimeout(l,s));function bSe(s){if(typeof s!="object")return!1;let l=s;return typeof l.hasUpdates!="boolean"?!1:l.hasUpdates===!0&&typeof l.newVersion=="string"&&typeof l.releasePage=="string"||l.hasUpdates===!1}var SSe=Q(PT());function $m(s){return new Promise((l,u)=>{s.oncomplete=s.onsuccess=()=>l(s.result),s.onabort=s.onerror=()=>u(s.error)})}function khe(s,l){let u=indexedDB.open(s);u.onupgradeneeded=()=>u.result.createObjectStore(l);let m=$m(u);return(_,b)=>m.then(E=>b(E.transaction(l,_).objectStore(l)))}var vB;function $v(){return vB||(vB=khe("keyval-store","keyval")),vB}function wSe(s,l=$v()){return l("readonly",u=>$m(u.get(s)))}function ESe(s,l,u=$v()){return u("readwrite",m=>(m.put(l,s),$m(m.transaction)))}function TSe(s,l=$v()){return l("readwrite",u=>(u.delete(s),$m(u.transaction)))}function _B(s,l){return s.openCursor().onsuccess=function(){this.result&&(l(this.result),this.result.continue())},$m(s.transaction)}function MSe(s=$v()){return s("readonly",l=>{if(l.getAllKeys)return $m(l.getAllKeys());let u=[];return _B(l,m=>u.push(m.key)).then(()=>u)})}function CSe(s=$v()){return s("readonly",l=>{if(l.getAll)return $m(l.getAll());let u=[];return _B(l,m=>u.push(m.value)).then(()=>u)})}function ASe(s=$v()){return s("readonly",l=>{if(l.getAll&&l.getAllKeys)return Promise.all([$m(l.getAllKeys()),$m(l.getAll())]).then(([m,_])=>m.map((b,E)=>[b,_[E]]));let u=[];return s("readonly",m=>_B(m,_=>u.push([_.key,_.value])).then(()=>u))})}var PSe=s=>{let l=khe("theatrejs-".concat(s),"default-store");return{set:(u,m)=>ESe(u,m,l),get:u=>wSe(u,l),del:u=>TSe(u,l),keys:()=>MSe(l),entries:()=>ASe(l),values:()=>CSe(l)}};ste(),zb();var Ihe="theatre-0.4",RSe=`You seem to have imported '@theatre/studio' but haven't initialized it. You can initialize the studio by:
\`\`\`
import studio from '@theatre/studio'
studio.initialize()
\`\`\`

* If you didn't mean to import '@theatre/studio', this means that your bundler is not tree-shaking it. This is most likely a bundler misconfiguration.

* If you meant to import '@theatre/studio' without showing its UI, you can do that by running:

\`\`\`
import studio from '@theatre/studio'
studio.initialize()
studio.ui.hide()
\`\`\`
`,kSe="You seem to have imported '@theatre/studio' but called `studio.initialize()` after some delay.\nTheatre.js projects remain in pending mode (won't play their sequences) until the studio is initialized, so you should place the `studio.initialize()` line right after the import line:\n\n```\nimport studio from '@theatre/studio'\n// ... and other imports\n\nstudio.initialize()\n```\n",ISe=class{constructor(){le(this,"ui"),le(this,"publicApi"),le(this,"address"),le(this,"_projectsProxy",new xA.PointerProxy(new xA.Atom({}).pointer)),le(this,"projectsP",this._projectsProxy.pointer),le(this,"_store",new pSe),le(this,"_corePrivateApi"),le(this,"_cache",new yB),le(this,"paneManager"),le(this,"_coreAtom",new xA.Atom({})),le(this,"_initializedDeferred",pB()),le(this,"_initializeFnCalled",!1),le(this,"_didWarnAboutNotInitializing",!1),le(this,"_coreBits"),le(this,"_rafDriver"),this.address={studioId:Cb(10)},this.publicApi=new gSe(this),this.ui=new Tbe(this),this._attachToIncomingProjects(),this.paneManager=new ySe(this),typeof window<"u"&&setTimeout(()=>{this._initializeFnCalled||(console.error(RSe),this._didWarnAboutNotInitializing=!0)},100)}get ticker(){if(!this._rafDriver)throw new Error("`studio.ticker` was read before studio.initialize() was called.");return this._rafDriver.ticker}get atomP(){return this._store.atomP}initialize(s){return Ue(this,null,function*(){if(!this._coreBits)throw new Error("You seem to have imported `@theatre/studio` without importing `@theatre/core`. Make sure to include an import of `@theatre/core` before calling `studio.initializer()`.");if(this._initializeFnCalled)return this._initializedDeferred.promise;this._initializeFnCalled=!0,this._didWarnAboutNotInitializing&&console.warn(kSe);let l={persistenceKey:Ihe,usePersistentStorage:!0};if(typeof(s==null?void 0:s.persistenceKey)=="string"&&(l.persistenceKey=s.persistenceKey),((s==null?void 0:s.usePersistentStorage)===!1||typeof window>"u")&&(l.usePersistentStorage=!1),s!=null&&s.__experimental_rafDriver){if(s.__experimental_rafDriver.type!=="Theatre_RafDriver_PublicAPI")throw new Error("parameter `rafDriver` in `studio.initialize({__experimental_rafDriver})` must be either be undefined, or the return type of core.createRafDriver()");let u=this._coreBits.privateAPI(s.__experimental_rafDriver);if(!u)throw new Error("parameter `rafDriver` in `studio.initialize({__experimental_rafDriver})` seems to come from a different version of `@theatre/core` than the version that is attached to `@theatre/studio`");this._rafDriver=u}else this._rafDriver=this._coreBits.getCoreRafDriver();try{yield this._store.initialize(l)}catch(u){this._initializedDeferred.reject(u);return}typeof window<"u"&&(yield this.ui.ready),this._initializedDeferred.resolve(),this.ui.render(),xSe().catch(u=>{console.error(u)})})}get initialized(){return this._initializedDeferred.promise}_attachToIncomingProjects(){let s=(0,xA.pointerToPrism)(this.projectsP),l=u=>{for(let m of Object.values(u))m.isAttachedToStudio||m.attachToStudio(this)};s.onStale(()=>{l(s.getValue())}),l(s.getValue())}setCoreBits(s){this._coreBits=s,this._corePrivateApi=s.privateAPI,this._coreAtom.setByPointer(l=>l.core,s.coreExports),this._setProjectsP(s.projectsP)}_setProjectsP(s){this._projectsProxy.setPointer(s)}scrub(){return new wbe(this)}tempTransaction(s){return this._store.tempTransaction(s)}transaction(s){return this.tempTransaction(s).commit()}__dev_startHistoryFromScratch(s){return this._store.__dev_startHistoryFromScratch(s)}get corePrivateAPI(){return this._corePrivateApi}get core(){return this._coreAtom.get().core}get coreP(){return this._coreAtom.pointer.core}extend(s,l){if(!s||typeof s!="object")throw new Error("Extensions must be JS objects");if(typeof s.id!="string")throw new Error("extension.id must be a string");let u=(l==null?void 0:l.__experimental_reconfigure)===!0,m=s.id,_=this._store.getState().ephemeral.extensions.byId[m];if(_&&!u){if(s===_||(0,SSe.default)(s,_))return;throw new Error('Extension id "'.concat(s.id,'" is already defined. If you mean to re-configure the extension, do it like this: studio.extend(extension, {__experimental_reconfigure: true})})'))}this.transaction(({drafts:b})=>{var E,T;b.ephemeral.extensions.byId[s.id]=s;let P=b.ephemeral.extensions.paneClasses;u&&_&&((E=_.panes)==null||E.forEach(N=>{delete P[N.class]})),(T=s.panes)==null||T.forEach(N=>{if(typeof N.class!="string")throw new Error("pane.class must be a string");if(N.class.length<3)throw new Error("pane.class should be a string with 3 or more characters");let z=P[N.class];if(z)if(u&&z.extensionId===s.id)console.warn('Pane class "'.concat(N.class,'" already exists. This is a bug in Theatre.js. Please report it at https://github.com/theatre-js/theatre/issues/new'));else throw new Error('Pane class "'.concat(N.class,'" already exists and is supplied by extension ').concat(z));P[N.class]={extensionId:s.id,classDefinition:N}})})}getStudioProject(s){return this._cache.get("getStudioProject",()=>s.getProject("Studio"))}getExtensionSheet(s,l){return this._cache.get("extensionSheet-"+s,()=>this.getStudioProject(l).sheet("Extension "+s))}undo(){this._store.undo()}redo(){this._store.redo()}createContentOfSaveFile(s){return this._store.createContentOfSaveFile(s)}createAssetStorage(s,l){return Ue(this,null,function*(){if(typeof window>"u")return{getAssetUrl:()=>"",createAsset:()=>Promise.resolve(null)};if(!("indexedDB"in window))return console.log("This browser doesn't support IndexedDB."),{getAssetUrl:N=>{throw new Error("IndexedDB is required by the default asset manager, but it's not supported by this browser. To use assets, please provide your own asset manager to the project config.")},createAsset:N=>{throw new Error("IndexedDB is required by the default asset manager, but it's not supported by this browser. To use assets, please provide your own asset manager to the project config.")}};let u=PSe("".concat(s.address.projectId,"-assets")),m=RO(s),_=yield u.keys();yield Promise.all(_.map(N=>Ue(this,null,function*(){m.includes(N)||(yield u.del(N))}))),yield Promise.all(_.map(N=>Ue(this,null,function*(){var z,G;let V="".concat(l,"/").concat(N);try{(yield fetch(V,{method:"HEAD"})).ok&&(yield u.del(N))}catch{Ub.error("Failed to access assets","Failed to access assets at ".concat((G=(z=s.config.assets)==null?void 0:z.baseUrl)!=null?G:"/",". This is likely due to a CORS issue."))}})));let b=new Map(yield u.entries()),E=new Map,T=N=>{if(E.has(N))return E.get(N);{let z=URL.createObjectURL(N);return E.set(N,z),z}},P=N=>{let z=b.get(N);if(!z)throw new Error("Asset with id ".concat(N," not found"));return T(z)};return{getAssetUrl:N=>b.has(N)?P(N):"".concat(l,"/").concat(N),createAsset:N=>Ue(this,null,function*(){var z,G,V;let B=RO(s),H=!1;if(B.includes(N.name)){let j;try{j=(z=b.get(N.name))!=null?z:yield fetch("".concat(l,"/").concat(N.name)).then(X=>X.ok?X.blob():void 0)}catch{return Ub.error("Failed to access assets","Failed to access assets at ".concat((V=(G=s.config.assets)==null?void 0:G.baseUrl)!=null?V:"/",". This is likely due to a CORS issue.")),Promise.resolve(null)}if(j){if(H=yield(yield Promise.resolve().then(()=>Q(bbe()))).default.isEqual(N,j),H)return N.name;{let X=K=>{let te=prompt(K,N.name);return te===null?!1:te===""?X("Asset name cannot be empty. Please choose a different file name for this asset."):B.includes(te)?(console.log(B),X("An asset with this name already exists. Please choose a different file name for this asset.")):(N=new File([N],te,{type:N.type}),!0)};if(!X("An asset with this name already exists. Please choose a different file name for this asset."))return null}}}return b.set(N.name,N),yield u.set(N.name,N),N.name})}})}clearPersistentStorage(s=Ihe){this._store.__experimental_clearPersistentStorage(s)}},xB="__TheatreJS_StudioBundle",NSe="__TheatreJS_CoreBundle",DSe="__TheatreJS_Notifications",OSe=class{constructor(s){this._studio=s,le(this,"_coreBundle")}get type(){return"Theatre_StudioBundle"}registerCoreBundle(s){if(this._coreBundle)throw new Error("StudioBundle.coreBundle is already registered. This is a bug.");this._coreBundle=s;let l;s.getBitsForStudio(this._studio,u=>{l=u}),this._studio.setCoreBits(l)}},FSe=Q(qe());Ft();var Nhe,LSe=Te.div(Nhe||(Nhe=J([""]))),BSe=s=>FSe.default.createElement(LSe,null),USe=BSe;zb();var bB=new ISe;at(bB);var zSe=bB.publicApi,VSe=zSe;GSe();function GSe(){if(typeof window>"u")return;let s=window[xB];if(typeof s<"u")throw typeof s=="object"&&s&&typeof s.version=="string"?new Error(`It seems that the module '@theatre/studio' is loaded more than once. This could have two possible causes:
1. You might have two separate versions of Theatre.js in node_modules.
2. Or this might be a bundling misconfiguration, in case you're using a bundler like Webpack/ESBuild/Rollup.

Note that it **is okay** to import '@theatre/studio' multiple times. But those imports should point to the same module.`):new Error("The variable window.".concat(xB," seems to be already set by a module other than @theatre/core."));let l=new OSe(bB);window[xB]=l;let u=window[NSe];u&&u!==null&&u.type==="Theatre_CoreBundle"&&l.registerCoreBundle(u)}typeof window<"u"&&(window[DSe]={notify:Ub});/*! Bundled license information:

		lodash-es/lodash.js:
		  (**
		   * @license
		   * Lodash (Custom Build) <https://lodash.com/>
		   * Build: `lodash modularize exports="es" -o ./`
		   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
		   * Released under MIT license <https://lodash.com/license>
		   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
		   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
		   *)

		queue-microtask/index.js:
		  (*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> *)

		react/cjs/react.production.min.js:
		  (**
		   * @license React
		   * react.production.min.js
		   *
		   * Copyright (c) Facebook, Inc. and its affiliates.
		   *
		   * This source code is licensed under the MIT license found in the
		   * LICENSE file in the root directory of this source tree.
		   *)

		scheduler/cjs/scheduler.production.min.js:
		  (**
		   * @license React
		   * scheduler.production.min.js
		   *
		   * Copyright (c) Facebook, Inc. and its affiliates.
		   *
		   * This source code is licensed under the MIT license found in the
		   * LICENSE file in the root directory of this source tree.
		   *)

		react-dom/cjs/react-dom.production.min.js:
		  (**
		   * @license React
		   * react-dom.production.min.js
		   *
		   * Copyright (c) Facebook, Inc. and its affiliates.
		   *
		   * This source code is licensed under the MIT license found in the
		   * LICENSE file in the root directory of this source tree.
		   *)

		react-is/cjs/react-is.production.min.js:
		  (** @license React v17.0.2
		   * react-is.production.min.js
		   *
		   * Copyright (c) Facebook, Inc. and its affiliates.
		   *
		   * This source code is licensed under the MIT license found in the
		   * LICENSE file in the root directory of this source tree.
		   *)

		react-is/cjs/react-is.production.min.js:
		  (** @license React v16.13.1
		   * react-is.production.min.js
		   *
		   * Copyright (c) Facebook, Inc. and its affiliates.
		   *
		   * This source code is licensed under the MIT license found in the
		   * LICENSE file in the root directory of this source tree.
		   *)

		jszip/dist/jszip.min.js:
		  (*!
		  
		  JSZip v3.10.1 - A JavaScript class for generating and reading zip files
		  <http://stuartk.com/jszip>
		  
		  (c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
		  Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.
		  
		  JSZip uses the library pako released under the MIT license :
		  https://github.com/nodeca/pako/blob/main/LICENSE
		  *)

		jiff/lib/lcs.js:
		  (** @license MIT License (c) copyright 2010-2014 original author or authors *)

		jiff/lib/array.js:
		  (** @license MIT License (c) copyright 2010-2014 original author or authors *)

		jiff/lib/jsonPointerParse.js:
		  (** @license MIT License (c) copyright 2010-2014 original author or authors *)

		jiff/lib/jsonPointer.js:
		  (** @license MIT License (c) copyright 2010-2014 original author or authors *)

		jiff/lib/clone.js:
		  (** @license MIT License (c) copyright 2010-2014 original author or authors *)

		jiff/lib/jsonPatch.js:
		  (** @license MIT License (c) copyright 2010-2014 original author or authors *)

		jiff/jiff.js:
		  (** @license MIT License (c) copyright 2010-2014 original author or authors *)
		*/}(Uw,Uw.exports)),Uw.exports}var XEe=qEe();const W2e=H2e(XEe);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const oH="177",__={ROTATE:0,DOLLY:1,PAN:2},o_={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},YEe=0,kpe=1,KEe=2,$2e=1,ZEe=2,fg=3,Rg=0,u0=1,wh=2,xg=0,p6=1,EG=2,TG=3,MG=4,q2e=5,V3=100,X2e=101,Y2e=102,K2e=103,Z2e=104,aH=200,lH=201,cH=202,uH=203,hE=204,dE=205,hH=206,dH=207,fH=208,pH=209,Q2e=210,mH=211,gH=212,yH=213,vH=214,CG=0,AG=1,PG=2,k_=3,RG=4,kG=5,IG=6,NG=7,gI=0,QEe=1,JEe=2,Jp=0,J2e=1,e9e=2,t9e=3,n9e=4,r9e=5,i9e=6,s9e=7,Ipe="attached",eTe="detached",a_=300,I_=301,N_=302,Dk=303,DG=304,yI=306,kg=1e3,l0=1001,OG=1002,c0=1003,tTe=1004,HP=1005,xc=1006,lz=1007,u6=1008,n1=1009,o9e=1010,a9e=1011,fE=1012,_H=1013,y6=1014,Th=1015,v6=1016,xH=1017,bH=1018,pE=1020,l9e=35902,c9e=1021,u9e=1022,V0=1023,mE=1026,gE=1027,h9e=1028,SH=1029,d9e=1030,wH=1031,EH=1033,pk=33776,mk=33777,gk=33778,yk=33779,FG=35840,LG=35841,BG=35842,UG=35843,zG=36196,VG=37492,GG=37496,jG=37808,HG=37809,WG=37810,$G=37811,qG=37812,XG=37813,YG=37814,KG=37815,ZG=37816,QG=37817,JG=37818,ej=37819,tj=37820,nj=37821,vk=36492,rj=36494,ij=36495,f9e=36283,sj=36284,oj=36285,aj=36286,nTe=2200,rTe=2201,iTe=2202,Ok=2300,lj=2301,cz=2302,l_=2400,c_=2401,Fk=2402,TH=2500,sTe=2501,oTe=3200,aTe=3201,K_=0,lTe=1,mg="",ys="srgb",df="srgb-linear",Lk="linear",ms="srgb",_7=7680,Npe=519,cTe=512,uTe=513,hTe=514,p9e=515,dTe=516,fTe=517,pTe=518,mTe=519,Dpe=35044,cj="300 es",Qp=2e3,Bk=2001;let gf=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return n===void 0?!1:n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){const n=this._listeners;if(n===void 0)return;const r=n[e];if(r!==void 0){const i=r.indexOf(t);i!==-1&&r.splice(i,1)}}dispatchEvent(e){const t=this._listeners;if(t===void 0)return;const n=t[e.type];if(n!==void 0){e.target=this;const r=n.slice(0);for(let i=0,a=r.length;i<a;i++)r[i].call(this,e);e.target=null}}};const N0=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let Ope=1234567;const Jw=Math.PI/180,D_=180/Math.PI;function J3(){const o=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(N0[o&255]+N0[o>>8&255]+N0[o>>16&255]+N0[o>>24&255]+"-"+N0[e&255]+N0[e>>8&255]+"-"+N0[e>>16&15|64]+N0[e>>24&255]+"-"+N0[t&63|128]+N0[t>>8&255]+"-"+N0[t>>16&255]+N0[t>>24&255]+N0[n&255]+N0[n>>8&255]+N0[n>>16&255]+N0[n>>24&255]).toLowerCase()}function oi(o,e,t){return Math.max(e,Math.min(t,o))}function MH(o,e){return(o%e+e)%e}function gTe(o,e,t,n,r){return n+(o-e)*(r-n)/(t-e)}function yTe(o,e,t){return o!==e?(t-o)/(e-o):0}function eE(o,e,t){return(1-t)*o+t*e}function vTe(o,e,t,n){return eE(o,e,1-Math.exp(-t*n))}function _Te(o,e=1){return e-Math.abs(MH(o,e*2)-e)}function xTe(o,e,t){return o<=e?0:o>=t?1:(o=(o-e)/(t-e),o*o*(3-2*o))}function bTe(o,e,t){return o<=e?0:o>=t?1:(o=(o-e)/(t-e),o*o*o*(o*(o*6-15)+10))}function STe(o,e){return o+Math.floor(Math.random()*(e-o+1))}function wTe(o,e){return o+Math.random()*(e-o)}function ETe(o){return o*(.5-Math.random())}function TTe(o){o!==void 0&&(Ope=o);let e=Ope+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function MTe(o){return o*Jw}function CTe(o){return o*D_}function ATe(o){return(o&o-1)===0&&o!==0}function PTe(o){return Math.pow(2,Math.ceil(Math.log(o)/Math.LN2))}function RTe(o){return Math.pow(2,Math.floor(Math.log(o)/Math.LN2))}function kTe(o,e,t,n,r){const i=Math.cos,a=Math.sin,c=i(t/2),h=a(t/2),p=i((e+n)/2),v=a((e+n)/2),x=i((e-n)/2),S=a((e-n)/2),C=i((n-e)/2),I=a((n-e)/2);switch(r){case"XYX":o.set(c*v,h*x,h*S,c*p);break;case"YZY":o.set(h*S,c*v,h*x,c*p);break;case"ZXZ":o.set(h*x,h*S,c*v,c*p);break;case"XZX":o.set(c*v,h*I,h*C,c*p);break;case"YXY":o.set(h*C,c*v,h*I,c*p);break;case"ZYZ":o.set(h*I,h*C,c*v,c*p);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function n_(o,e){switch(e.constructor){case Float32Array:return o;case Uint32Array:return o/4294967295;case Uint16Array:return o/65535;case Uint8Array:return o/255;case Int32Array:return Math.max(o/2147483647,-1);case Int16Array:return Math.max(o/32767,-1);case Int8Array:return Math.max(o/127,-1);default:throw new Error("Invalid component type.")}}function Tl(o,e){switch(e.constructor){case Float32Array:return o;case Uint32Array:return Math.round(o*4294967295);case Uint16Array:return Math.round(o*65535);case Uint8Array:return Math.round(o*255);case Int32Array:return Math.round(o*2147483647);case Int16Array:return Math.round(o*32767);case Int8Array:return Math.round(o*127);default:throw new Error("Invalid component type.")}}const B0={DEG2RAD:Jw,RAD2DEG:D_,generateUUID:J3,clamp:oi,euclideanModulo:MH,mapLinear:gTe,inverseLerp:yTe,lerp:eE,damp:vTe,pingpong:_Te,smoothstep:xTe,smootherstep:bTe,randInt:STe,randFloat:wTe,randFloatSpread:ETe,seededRandom:TTe,degToRad:MTe,radToDeg:CTe,isPowerOfTwo:ATe,ceilPowerOfTwo:PTe,floorPowerOfTwo:RTe,setQuaternionFromProperEuler:kTe,normalize:Tl,denormalize:n_};let mr=class m9e{constructor(e=0,t=0){m9e.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=oi(this.x,e.x,t.x),this.y=oi(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=oi(this.x,e,t),this.y=oi(this.y,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(oi(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(oi(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),i=this.x-e.x,a=this.y-e.y;return this.x=i*n-a*r+e.x,this.y=i*r+a*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},os=class{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,i,a,c){let h=n[r+0],p=n[r+1],v=n[r+2],x=n[r+3];const S=i[a+0],C=i[a+1],I=i[a+2],L=i[a+3];if(c===0){e[t+0]=h,e[t+1]=p,e[t+2]=v,e[t+3]=x;return}if(c===1){e[t+0]=S,e[t+1]=C,e[t+2]=I,e[t+3]=L;return}if(x!==L||h!==S||p!==C||v!==I){let U=1-c;const R=h*S+p*C+v*I+x*L,$=R>=0?1:-1,Z=1-R*R;if(Z>Number.EPSILON){const ie=Math.sqrt(Z),ue=Math.atan2(ie,R*$);U=Math.sin(U*ue)/ie,c=Math.sin(c*ue)/ie}const k=c*$;if(h=h*U+S*k,p=p*U+C*k,v=v*U+I*k,x=x*U+L*k,U===1-c){const ie=1/Math.sqrt(h*h+p*p+v*v+x*x);h*=ie,p*=ie,v*=ie,x*=ie}}e[t]=h,e[t+1]=p,e[t+2]=v,e[t+3]=x}static multiplyQuaternionsFlat(e,t,n,r,i,a){const c=n[r],h=n[r+1],p=n[r+2],v=n[r+3],x=i[a],S=i[a+1],C=i[a+2],I=i[a+3];return e[t]=c*I+v*x+h*C-p*S,e[t+1]=h*I+v*S+p*x-c*C,e[t+2]=p*I+v*C+c*S-h*x,e[t+3]=v*I-c*x-h*S-p*C,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const n=e._x,r=e._y,i=e._z,a=e._order,c=Math.cos,h=Math.sin,p=c(n/2),v=c(r/2),x=c(i/2),S=h(n/2),C=h(r/2),I=h(i/2);switch(a){case"XYZ":this._x=S*v*x+p*C*I,this._y=p*C*x-S*v*I,this._z=p*v*I+S*C*x,this._w=p*v*x-S*C*I;break;case"YXZ":this._x=S*v*x+p*C*I,this._y=p*C*x-S*v*I,this._z=p*v*I-S*C*x,this._w=p*v*x+S*C*I;break;case"ZXY":this._x=S*v*x-p*C*I,this._y=p*C*x+S*v*I,this._z=p*v*I+S*C*x,this._w=p*v*x-S*C*I;break;case"ZYX":this._x=S*v*x-p*C*I,this._y=p*C*x+S*v*I,this._z=p*v*I-S*C*x,this._w=p*v*x+S*C*I;break;case"YZX":this._x=S*v*x+p*C*I,this._y=p*C*x+S*v*I,this._z=p*v*I-S*C*x,this._w=p*v*x-S*C*I;break;case"XZY":this._x=S*v*x-p*C*I,this._y=p*C*x-S*v*I,this._z=p*v*I+S*C*x,this._w=p*v*x+S*C*I;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],i=t[8],a=t[1],c=t[5],h=t[9],p=t[2],v=t[6],x=t[10],S=n+c+x;if(S>0){const C=.5/Math.sqrt(S+1);this._w=.25/C,this._x=(v-h)*C,this._y=(i-p)*C,this._z=(a-r)*C}else if(n>c&&n>x){const C=2*Math.sqrt(1+n-c-x);this._w=(v-h)/C,this._x=.25*C,this._y=(r+a)/C,this._z=(i+p)/C}else if(c>x){const C=2*Math.sqrt(1+c-n-x);this._w=(i-p)/C,this._x=(r+a)/C,this._y=.25*C,this._z=(h+v)/C}else{const C=2*Math.sqrt(1+x-n-c);this._w=(a-r)/C,this._x=(i+p)/C,this._y=(h+v)/C,this._z=.25*C}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(oi(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,i=e._z,a=e._w,c=t._x,h=t._y,p=t._z,v=t._w;return this._x=n*v+a*c+r*p-i*h,this._y=r*v+a*h+i*c-n*p,this._z=i*v+a*p+n*h-r*c,this._w=a*v-n*c-r*h-i*p,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const n=this._x,r=this._y,i=this._z,a=this._w;let c=a*e._w+n*e._x+r*e._y+i*e._z;if(c<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,c=-c):this.copy(e),c>=1)return this._w=a,this._x=n,this._y=r,this._z=i,this;const h=1-c*c;if(h<=Number.EPSILON){const C=1-t;return this._w=C*a+t*this._w,this._x=C*n+t*this._x,this._y=C*r+t*this._y,this._z=C*i+t*this._z,this.normalize(),this}const p=Math.sqrt(h),v=Math.atan2(p,c),x=Math.sin((1-t)*v)/p,S=Math.sin(t*v)/p;return this._w=a*x+this._w*S,this._x=n*x+this._x*S,this._y=r*x+this._y*S,this._z=i*x+this._z*S,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),r=Math.sqrt(1-n),i=Math.sqrt(n);return this.set(r*Math.sin(e),r*Math.cos(e),i*Math.sin(t),i*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},Ie=class g9e{constructor(e=0,t=0,n=0){g9e.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(Fpe.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Fpe.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6]*r,this.y=i[1]*t+i[4]*n+i[7]*r,this.z=i[2]*t+i[5]*n+i[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,i=e.elements,a=1/(i[3]*t+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*a,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*a,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*a,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,i=e.x,a=e.y,c=e.z,h=e.w,p=2*(a*r-c*n),v=2*(c*t-i*r),x=2*(i*n-a*t);return this.x=t+h*p+a*x-c*v,this.y=n+h*v+c*p-i*x,this.z=r+h*x+i*v-a*p,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r,this.y=i[1]*t+i[5]*n+i[9]*r,this.z=i[2]*t+i[6]*n+i[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=oi(this.x,e.x,t.x),this.y=oi(this.y,e.y,t.y),this.z=oi(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=oi(this.x,e,t),this.y=oi(this.y,e,t),this.z=oi(this.z,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(oi(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,i=e.z,a=t.x,c=t.y,h=t.z;return this.x=r*h-i*c,this.y=i*a-n*h,this.z=n*c-r*a,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return uz.copy(this).projectOnVector(e),this.sub(uz)}reflect(e){return this.sub(uz.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(oi(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}};const uz=new Ie,Fpe=new os;let ui=class y9e{constructor(e,t,n,r,i,a,c,h,p){y9e.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,n,r,i,a,c,h,p)}set(e,t,n,r,i,a,c,h,p){const v=this.elements;return v[0]=e,v[1]=r,v[2]=c,v[3]=t,v[4]=i,v[5]=h,v[6]=n,v[7]=a,v[8]=p,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,i=this.elements,a=n[0],c=n[3],h=n[6],p=n[1],v=n[4],x=n[7],S=n[2],C=n[5],I=n[8],L=r[0],U=r[3],R=r[6],$=r[1],Z=r[4],k=r[7],ie=r[2],ue=r[5],ce=r[8];return i[0]=a*L+c*$+h*ie,i[3]=a*U+c*Z+h*ue,i[6]=a*R+c*k+h*ce,i[1]=p*L+v*$+x*ie,i[4]=p*U+v*Z+x*ue,i[7]=p*R+v*k+x*ce,i[2]=S*L+C*$+I*ie,i[5]=S*U+C*Z+I*ue,i[8]=S*R+C*k+I*ce,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],c=e[5],h=e[6],p=e[7],v=e[8];return t*a*v-t*c*p-n*i*v+n*c*h+r*i*p-r*a*h}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],c=e[5],h=e[6],p=e[7],v=e[8],x=v*a-c*p,S=c*h-v*i,C=p*i-a*h,I=t*x+n*S+r*C;if(I===0)return this.set(0,0,0,0,0,0,0,0,0);const L=1/I;return e[0]=x*L,e[1]=(r*p-v*n)*L,e[2]=(c*n-r*a)*L,e[3]=S*L,e[4]=(v*t-r*h)*L,e[5]=(r*i-c*t)*L,e[6]=C*L,e[7]=(n*h-p*t)*L,e[8]=(a*t-n*i)*L,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,i,a,c){const h=Math.cos(i),p=Math.sin(i);return this.set(n*h,n*p,-n*(h*a+p*c)+a+e,-r*p,r*h,-r*(-p*a+h*c)+c+t,0,0,1),this}scale(e,t){return this.premultiply(hz.makeScale(e,t)),this}rotate(e){return this.premultiply(hz.makeRotation(-e)),this}translate(e,t){return this.premultiply(hz.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}};const hz=new ui;function v9e(o){for(let e=o.length-1;e>=0;--e)if(o[e]>=65535)return!0;return!1}function yE(o){return document.createElementNS("http://www.w3.org/1999/xhtml",o)}function ITe(){const o=yE("canvas");return o.style.display="block",o}const Lpe={};function x_(o){o in Lpe||(Lpe[o]=!0,console.warn(o))}function NTe(o,e,t){return new Promise(function(n,r){function i(){switch(o.clientWaitSync(e,o.SYNC_FLUSH_COMMANDS_BIT,0)){case o.WAIT_FAILED:r();break;case o.TIMEOUT_EXPIRED:setTimeout(i,t);break;default:n()}}setTimeout(i,t)})}function DTe(o){const e=o.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}function OTe(o){const e=o.elements;e[11]===-1?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=-e[14]+1)}const Bpe=new ui().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),Upe=new ui().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function FTe(){const o={enabled:!0,workingColorSpace:df,spaces:{},convert:function(r,i,a){return this.enabled===!1||i===a||!i||!a||(this.spaces[i].transfer===ms&&(r.r=bg(r.r),r.g=bg(r.g),r.b=bg(r.b)),this.spaces[i].primaries!==this.spaces[a].primaries&&(r.applyMatrix3(this.spaces[i].toXYZ),r.applyMatrix3(this.spaces[a].fromXYZ)),this.spaces[a].transfer===ms&&(r.r=b_(r.r),r.g=b_(r.g),r.b=b_(r.b))),r},workingToColorSpace:function(r,i){return this.convert(r,this.workingColorSpace,i)},colorSpaceToWorking:function(r,i){return this.convert(r,i,this.workingColorSpace)},getPrimaries:function(r){return this.spaces[r].primaries},getTransfer:function(r){return r===mg?Lk:this.spaces[r].transfer},getLuminanceCoefficients:function(r,i=this.workingColorSpace){return r.fromArray(this.spaces[i].luminanceCoefficients)},define:function(r){Object.assign(this.spaces,r)},_getMatrix:function(r,i,a){return r.copy(this.spaces[i].toXYZ).multiply(this.spaces[a].fromXYZ)},_getDrawingBufferColorSpace:function(r){return this.spaces[r].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(r=this.workingColorSpace){return this.spaces[r].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(r,i){return x_("THREE.ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),o.workingToColorSpace(r,i)},toWorkingColorSpace:function(r,i){return x_("THREE.ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),o.colorSpaceToWorking(r,i)}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],n=[.3127,.329];return o.define({[df]:{primaries:e,whitePoint:n,transfer:Lk,toXYZ:Bpe,fromXYZ:Upe,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:ys},outputColorSpaceConfig:{drawingBufferColorSpace:ys}},[ys]:{primaries:e,whitePoint:n,transfer:ms,toXYZ:Bpe,fromXYZ:Upe,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:ys}}}),o}const Kr=FTe();function bg(o){return o<.04045?o*.0773993808:Math.pow(o*.9478672986+.0521327014,2.4)}function b_(o){return o<.0031308?o*12.92:1.055*Math.pow(o,.41666)-.055}let x7,LTe=class{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{x7===void 0&&(x7=yE("canvas")),x7.width=e.width,x7.height=e.height;const r=x7.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),n=x7}return n.toDataURL(t)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=yE("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),i=r.data;for(let a=0;a<i.length;a++)i[a]=bg(i[a]/255)*255;return n.putImageData(r,0,0),t}else if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(bg(t[n]/255)*255):t[n]=bg(t[n]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}},BTe=0,CH=class{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:BTe++}),this.uuid=J3(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const t=this.data;return t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight):t!==null?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(r!==null){let i;if(Array.isArray(r)){i=[];for(let a=0,c=r.length;a<c;a++)r[a].isDataTexture?i.push(dz(r[a].image)):i.push(dz(r[a]))}else i=dz(r);n.url=i}return t||(e.images[this.uuid]=n),n}};function dz(o){return typeof HTMLImageElement<"u"&&o instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&o instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&o instanceof ImageBitmap?LTe.getDataURL(o):o.data?{data:Array.from(o.data),width:o.width,height:o.height,type:o.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let UTe=0;const fz=new Ie;let H0=class _k extends gf{constructor(e=_k.DEFAULT_IMAGE,t=_k.DEFAULT_MAPPING,n=l0,r=l0,i=xc,a=u6,c=V0,h=n1,p=_k.DEFAULT_ANISOTROPY,v=mg){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:UTe++}),this.uuid=J3(),this.name="",this.source=new CH(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=r,this.magFilter=i,this.minFilter=a,this.anisotropy=p,this.format=c,this.internalFormat=null,this.type=h,this.offset=new mr(0,0),this.repeat=new mr(1,1),this.center=new mr(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ui,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=v,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(fz).x}get height(){return this.source.getSize(fz).y}get depth(){return this.source.getSize(fz).z}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const t in e){const n=e[t];if(n===void 0){console.warn(`THREE.Texture.setValues(): parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){console.warn(`THREE.Texture.setValues(): property '${t}' does not exist.`);continue}r&&n&&r.isVector2&&n.isVector2||r&&n&&r.isVector3&&n.isVector3||r&&n&&r.isMatrix3&&n.isMatrix3?r.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==a_)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case kg:e.x=e.x-Math.floor(e.x);break;case l0:e.x=e.x<0?0:1;break;case OG:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case kg:e.y=e.y-Math.floor(e.y);break;case l0:e.y=e.y<0?0:1;break;case OG:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}};H0.DEFAULT_IMAGE=null;H0.DEFAULT_MAPPING=a_;H0.DEFAULT_ANISOTROPY=1;let Pi=class _9e{constructor(e=0,t=0,n=0,r=1){_9e.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,i=this.w,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*r+a[12]*i,this.y=a[1]*t+a[5]*n+a[9]*r+a[13]*i,this.z=a[2]*t+a[6]*n+a[10]*r+a[14]*i,this.w=a[3]*t+a[7]*n+a[11]*r+a[15]*i,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,i;const h=e.elements,p=h[0],v=h[4],x=h[8],S=h[1],C=h[5],I=h[9],L=h[2],U=h[6],R=h[10];if(Math.abs(v-S)<.01&&Math.abs(x-L)<.01&&Math.abs(I-U)<.01){if(Math.abs(v+S)<.1&&Math.abs(x+L)<.1&&Math.abs(I+U)<.1&&Math.abs(p+C+R-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const Z=(p+1)/2,k=(C+1)/2,ie=(R+1)/2,ue=(v+S)/4,ce=(x+L)/4,Q=(I+U)/4;return Z>k&&Z>ie?Z<.01?(n=0,r=.707106781,i=.707106781):(n=Math.sqrt(Z),r=ue/n,i=ce/n):k>ie?k<.01?(n=.707106781,r=0,i=.707106781):(r=Math.sqrt(k),n=ue/r,i=Q/r):ie<.01?(n=.707106781,r=.707106781,i=0):(i=Math.sqrt(ie),n=ce/i,r=Q/i),this.set(n,r,i,t),this}let $=Math.sqrt((U-I)*(U-I)+(x-L)*(x-L)+(S-v)*(S-v));return Math.abs($)<.001&&($=1),this.x=(U-I)/$,this.y=(x-L)/$,this.z=(S-v)/$,this.w=Math.acos((p+C+R-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=oi(this.x,e.x,t.x),this.y=oi(this.y,e.y,t.y),this.z=oi(this.z,e.z,t.z),this.w=oi(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=oi(this.x,e,t),this.y=oi(this.y,e,t),this.z=oi(this.z,e,t),this.w=oi(this.w,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(oi(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},AH=class extends gf{constructor(e=1,t=1,n={}){super(),n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:xc,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},n),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=n.depth,this.scissor=new Pi(0,0,e,t),this.scissorTest=!1,this.viewport=new Pi(0,0,e,t);const r={width:e,height:t,depth:n.depth},i=new H0(r);this.textures=[];const a=n.count;for(let c=0;c<a;c++)this.textures[c]=i.clone(),this.textures[c].isRenderTargetTexture=!0,this.textures[c].renderTarget=this;this._setTextureOptions(n),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=n.depthTexture,this.samples=n.samples,this.multiview=n.multiview}_setTextureOptions(e={}){const t={minFilter:xc,generateMipmaps:!1,flipY:!1,internalFormat:null};e.mapping!==void 0&&(t.mapping=e.mapping),e.wrapS!==void 0&&(t.wrapS=e.wrapS),e.wrapT!==void 0&&(t.wrapT=e.wrapT),e.wrapR!==void 0&&(t.wrapR=e.wrapR),e.magFilter!==void 0&&(t.magFilter=e.magFilter),e.minFilter!==void 0&&(t.minFilter=e.minFilter),e.format!==void 0&&(t.format=e.format),e.type!==void 0&&(t.type=e.type),e.anisotropy!==void 0&&(t.anisotropy=e.anisotropy),e.colorSpace!==void 0&&(t.colorSpace=e.colorSpace),e.flipY!==void 0&&(t.flipY=e.flipY),e.generateMipmaps!==void 0&&(t.generateMipmaps=e.generateMipmaps),e.internalFormat!==void 0&&(t.internalFormat=e.internalFormat);for(let n=0;n<this.textures.length;n++)this.textures[n].setValues(t)}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,i=this.textures.length;r<i;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=n,this.textures[r].isArrayTexture=this.textures[r].image.depth>1;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,n=e.textures.length;t<n;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const r=Object.assign({},e.textures[t].image);this.textures[t].source=new CH(r)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},_6=class extends AH{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}},x9e=class extends H0{constructor(e=null,t=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=c0,this.minFilter=c0,this.wrapR=l0,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}};class zTe extends H0{constructor(e=null,t=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=c0,this.minFilter=c0,this.wrapR=l0,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}let T6=class{constructor(e=new Ie(1/0,1/0,1/0),t=new Ie(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint($d.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint($d.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=$d.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0){const i=n.getAttribute("position");if(t===!0&&i!==void 0&&e.isInstancedMesh!==!0)for(let a=0,c=i.count;a<c;a++)e.isMesh===!0?e.getVertexPosition(a,$d):$d.fromBufferAttribute(i,a),$d.applyMatrix4(e.matrixWorld),this.expandByPoint($d);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),WP.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),WP.copy(n.boundingBox)),WP.applyMatrix4(e.matrixWorld),this.union(WP)}const r=e.children;for(let i=0,a=r.length;i<a;i++)this.expandByObject(r[i],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,$d),$d.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(sw),$P.subVectors(this.max,sw),b7.subVectors(e.a,sw),S7.subVectors(e.b,sw),w7.subVectors(e.c,sw),_3.subVectors(S7,b7),x3.subVectors(w7,S7),N8.subVectors(b7,w7);let t=[0,-_3.z,_3.y,0,-x3.z,x3.y,0,-N8.z,N8.y,_3.z,0,-_3.x,x3.z,0,-x3.x,N8.z,0,-N8.x,-_3.y,_3.x,0,-x3.y,x3.x,0,-N8.y,N8.x,0];return!pz(t,b7,S7,w7,$P)||(t=[1,0,0,0,1,0,0,0,1],!pz(t,b7,S7,w7,$P))?!1:(qP.crossVectors(_3,x3),t=[qP.x,qP.y,qP.z],pz(t,b7,S7,w7,$P))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,$d).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize($d).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(tg[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),tg[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),tg[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),tg[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),tg[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),tg[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),tg[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),tg[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(tg),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}};const tg=[new Ie,new Ie,new Ie,new Ie,new Ie,new Ie,new Ie,new Ie],$d=new Ie,WP=new T6,b7=new Ie,S7=new Ie,w7=new Ie,_3=new Ie,x3=new Ie,N8=new Ie,sw=new Ie,$P=new Ie,qP=new Ie,D8=new Ie;function pz(o,e,t,n,r){for(let i=0,a=o.length-3;i<=a;i+=3){D8.fromArray(o,i);const c=r.x*Math.abs(D8.x)+r.y*Math.abs(D8.y)+r.z*Math.abs(D8.z),h=e.dot(D8),p=t.dot(D8),v=n.dot(D8);if(Math.max(-Math.max(h,p,v),Math.min(h,p,v))>c)return!1}return!0}const VTe=new T6,ow=new Ie,mz=new Ie;let e4=class{constructor(e=new Ie,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):VTe.setFromPoints(e).getCenter(n);let r=0;for(let i=0,a=e.length;i<a;i++)r=Math.max(r,n.distanceToSquared(e[i]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;ow.subVectors(e,this.center);const t=ow.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),r=(n-this.radius)*.5;this.center.addScaledVector(ow,r/n),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(mz.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(ow.copy(e.center).add(mz)),this.expandByPoint(ow.copy(e.center).sub(mz))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}};const ng=new Ie,gz=new Ie,XP=new Ie,b3=new Ie,yz=new Ie,YP=new Ie,vz=new Ie;let Z_=class{constructor(e=new Ie,t=new Ie(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,ng)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=ng.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(ng.copy(this.origin).addScaledVector(this.direction,t),ng.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){gz.copy(e).add(t).multiplyScalar(.5),XP.copy(t).sub(e).normalize(),b3.copy(this.origin).sub(gz);const i=e.distanceTo(t)*.5,a=-this.direction.dot(XP),c=b3.dot(this.direction),h=-b3.dot(XP),p=b3.lengthSq(),v=Math.abs(1-a*a);let x,S,C,I;if(v>0)if(x=a*h-c,S=a*c-h,I=i*v,x>=0)if(S>=-I)if(S<=I){const L=1/v;x*=L,S*=L,C=x*(x+a*S+2*c)+S*(a*x+S+2*h)+p}else S=i,x=Math.max(0,-(a*S+c)),C=-x*x+S*(S+2*h)+p;else S=-i,x=Math.max(0,-(a*S+c)),C=-x*x+S*(S+2*h)+p;else S<=-I?(x=Math.max(0,-(-a*i+c)),S=x>0?-i:Math.min(Math.max(-i,-h),i),C=-x*x+S*(S+2*h)+p):S<=I?(x=0,S=Math.min(Math.max(-i,-h),i),C=S*(S+2*h)+p):(x=Math.max(0,-(a*i+c)),S=x>0?i:Math.min(Math.max(-i,-h),i),C=-x*x+S*(S+2*h)+p);else S=a>0?-i:i,x=Math.max(0,-(a*S+c)),C=-x*x+S*(S+2*h)+p;return n&&n.copy(this.origin).addScaledVector(this.direction,x),r&&r.copy(gz).addScaledVector(XP,S),C}intersectSphere(e,t){ng.subVectors(e.center,this.origin);const n=ng.dot(this.direction),r=ng.dot(ng)-n*n,i=e.radius*e.radius;if(r>i)return null;const a=Math.sqrt(i-r),c=n-a,h=n+a;return h<0?null:c<0?this.at(h,t):this.at(c,t)}intersectsSphere(e){return e.radius<0?!1:this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,i,a,c,h;const p=1/this.direction.x,v=1/this.direction.y,x=1/this.direction.z,S=this.origin;return p>=0?(n=(e.min.x-S.x)*p,r=(e.max.x-S.x)*p):(n=(e.max.x-S.x)*p,r=(e.min.x-S.x)*p),v>=0?(i=(e.min.y-S.y)*v,a=(e.max.y-S.y)*v):(i=(e.max.y-S.y)*v,a=(e.min.y-S.y)*v),n>a||i>r||((i>n||isNaN(n))&&(n=i),(a<r||isNaN(r))&&(r=a),x>=0?(c=(e.min.z-S.z)*x,h=(e.max.z-S.z)*x):(c=(e.max.z-S.z)*x,h=(e.min.z-S.z)*x),n>h||c>r)||((c>n||n!==n)&&(n=c),(h<r||r!==r)&&(r=h),r<0)?null:this.at(n>=0?n:r,t)}intersectsBox(e){return this.intersectBox(e,ng)!==null}intersectTriangle(e,t,n,r,i){yz.subVectors(t,e),YP.subVectors(n,e),vz.crossVectors(yz,YP);let a=this.direction.dot(vz),c;if(a>0){if(r)return null;c=1}else if(a<0)c=-1,a=-a;else return null;b3.subVectors(this.origin,e);const h=c*this.direction.dot(YP.crossVectors(b3,YP));if(h<0)return null;const p=c*this.direction.dot(yz.cross(b3));if(p<0||h+p>a)return null;const v=-c*b3.dot(vz);return v<0?null:this.at(v/a,i)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},vr=class uj{constructor(e,t,n,r,i,a,c,h,p,v,x,S,C,I,L,U){uj.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,n,r,i,a,c,h,p,v,x,S,C,I,L,U)}set(e,t,n,r,i,a,c,h,p,v,x,S,C,I,L,U){const R=this.elements;return R[0]=e,R[4]=t,R[8]=n,R[12]=r,R[1]=i,R[5]=a,R[9]=c,R[13]=h,R[2]=p,R[6]=v,R[10]=x,R[14]=S,R[3]=C,R[7]=I,R[11]=L,R[15]=U,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new uj().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,r=1/E7.setFromMatrixColumn(e,0).length(),i=1/E7.setFromMatrixColumn(e,1).length(),a=1/E7.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=0,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,r=e.y,i=e.z,a=Math.cos(n),c=Math.sin(n),h=Math.cos(r),p=Math.sin(r),v=Math.cos(i),x=Math.sin(i);if(e.order==="XYZ"){const S=a*v,C=a*x,I=c*v,L=c*x;t[0]=h*v,t[4]=-h*x,t[8]=p,t[1]=C+I*p,t[5]=S-L*p,t[9]=-c*h,t[2]=L-S*p,t[6]=I+C*p,t[10]=a*h}else if(e.order==="YXZ"){const S=h*v,C=h*x,I=p*v,L=p*x;t[0]=S+L*c,t[4]=I*c-C,t[8]=a*p,t[1]=a*x,t[5]=a*v,t[9]=-c,t[2]=C*c-I,t[6]=L+S*c,t[10]=a*h}else if(e.order==="ZXY"){const S=h*v,C=h*x,I=p*v,L=p*x;t[0]=S-L*c,t[4]=-a*x,t[8]=I+C*c,t[1]=C+I*c,t[5]=a*v,t[9]=L-S*c,t[2]=-a*p,t[6]=c,t[10]=a*h}else if(e.order==="ZYX"){const S=a*v,C=a*x,I=c*v,L=c*x;t[0]=h*v,t[4]=I*p-C,t[8]=S*p+L,t[1]=h*x,t[5]=L*p+S,t[9]=C*p-I,t[2]=-p,t[6]=c*h,t[10]=a*h}else if(e.order==="YZX"){const S=a*h,C=a*p,I=c*h,L=c*p;t[0]=h*v,t[4]=L-S*x,t[8]=I*x+C,t[1]=x,t[5]=a*v,t[9]=-c*v,t[2]=-p*v,t[6]=C*x+I,t[10]=S-L*x}else if(e.order==="XZY"){const S=a*h,C=a*p,I=c*h,L=c*p;t[0]=h*v,t[4]=-x,t[8]=p*v,t[1]=S*x+L,t[5]=a*v,t[9]=C*x-I,t[2]=I*x-C,t[6]=c*v,t[10]=L*x+S}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(GTe,e,jTe)}lookAt(e,t,n){const r=this.elements;return du.subVectors(e,t),du.lengthSq()===0&&(du.z=1),du.normalize(),S3.crossVectors(n,du),S3.lengthSq()===0&&(Math.abs(n.z)===1?du.x+=1e-4:du.z+=1e-4,du.normalize(),S3.crossVectors(n,du)),S3.normalize(),KP.crossVectors(du,S3),r[0]=S3.x,r[4]=KP.x,r[8]=du.x,r[1]=S3.y,r[5]=KP.y,r[9]=du.y,r[2]=S3.z,r[6]=KP.z,r[10]=du.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,i=this.elements,a=n[0],c=n[4],h=n[8],p=n[12],v=n[1],x=n[5],S=n[9],C=n[13],I=n[2],L=n[6],U=n[10],R=n[14],$=n[3],Z=n[7],k=n[11],ie=n[15],ue=r[0],ce=r[4],Q=r[8],ae=r[12],le=r[1],J=r[5],Ue=r[9],je=r[13],rt=r[2],at=r[6],Se=r[10],gt=r[14],Ae=r[3],lt=r[7],pt=r[11],De=r[15];return i[0]=a*ue+c*le+h*rt+p*Ae,i[4]=a*ce+c*J+h*at+p*lt,i[8]=a*Q+c*Ue+h*Se+p*pt,i[12]=a*ae+c*je+h*gt+p*De,i[1]=v*ue+x*le+S*rt+C*Ae,i[5]=v*ce+x*J+S*at+C*lt,i[9]=v*Q+x*Ue+S*Se+C*pt,i[13]=v*ae+x*je+S*gt+C*De,i[2]=I*ue+L*le+U*rt+R*Ae,i[6]=I*ce+L*J+U*at+R*lt,i[10]=I*Q+L*Ue+U*Se+R*pt,i[14]=I*ae+L*je+U*gt+R*De,i[3]=$*ue+Z*le+k*rt+ie*Ae,i[7]=$*ce+Z*J+k*at+ie*lt,i[11]=$*Q+Z*Ue+k*Se+ie*pt,i[15]=$*ae+Z*je+k*gt+ie*De,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],a=e[1],c=e[5],h=e[9],p=e[13],v=e[2],x=e[6],S=e[10],C=e[14],I=e[3],L=e[7],U=e[11],R=e[15];return I*(+i*h*x-r*p*x-i*c*S+n*p*S+r*c*C-n*h*C)+L*(+t*h*C-t*p*S+i*a*S-r*a*C+r*p*v-i*h*v)+U*(+t*p*x-t*c*C-i*a*x+n*a*C+i*c*v-n*p*v)+R*(-r*c*v-t*h*x+t*c*S+r*a*x-n*a*S+n*h*v)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],c=e[5],h=e[6],p=e[7],v=e[8],x=e[9],S=e[10],C=e[11],I=e[12],L=e[13],U=e[14],R=e[15],$=x*U*p-L*S*p+L*h*C-c*U*C-x*h*R+c*S*R,Z=I*S*p-v*U*p-I*h*C+a*U*C+v*h*R-a*S*R,k=v*L*p-I*x*p+I*c*C-a*L*C-v*c*R+a*x*R,ie=I*x*h-v*L*h-I*c*S+a*L*S+v*c*U-a*x*U,ue=t*$+n*Z+r*k+i*ie;if(ue===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const ce=1/ue;return e[0]=$*ce,e[1]=(L*S*i-x*U*i-L*r*C+n*U*C+x*r*R-n*S*R)*ce,e[2]=(c*U*i-L*h*i+L*r*p-n*U*p-c*r*R+n*h*R)*ce,e[3]=(x*h*i-c*S*i-x*r*p+n*S*p+c*r*C-n*h*C)*ce,e[4]=Z*ce,e[5]=(v*U*i-I*S*i+I*r*C-t*U*C-v*r*R+t*S*R)*ce,e[6]=(I*h*i-a*U*i-I*r*p+t*U*p+a*r*R-t*h*R)*ce,e[7]=(a*S*i-v*h*i+v*r*p-t*S*p-a*r*C+t*h*C)*ce,e[8]=k*ce,e[9]=(I*x*i-v*L*i-I*n*C+t*L*C+v*n*R-t*x*R)*ce,e[10]=(a*L*i-I*c*i+I*n*p-t*L*p-a*n*R+t*c*R)*ce,e[11]=(v*c*i-a*x*i-v*n*p+t*x*p+a*n*C-t*c*C)*ce,e[12]=ie*ce,e[13]=(v*L*r-I*x*r+I*n*S-t*L*S-v*n*U+t*x*U)*ce,e[14]=(I*c*r-a*L*r-I*n*h+t*L*h+a*n*U-t*c*U)*ce,e[15]=(a*x*r-v*c*r+v*n*h-t*x*h-a*n*S+t*c*S)*ce,this}scale(e){const t=this.elements,n=e.x,r=e.y,i=e.z;return t[0]*=n,t[4]*=r,t[8]*=i,t[1]*=n,t[5]*=r,t[9]*=i,t[2]*=n,t[6]*=r,t[10]*=i,t[3]*=n,t[7]*=r,t[11]*=i,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),i=1-n,a=e.x,c=e.y,h=e.z,p=i*a,v=i*c;return this.set(p*a+n,p*c-r*h,p*h+r*c,0,p*c+r*h,v*c+n,v*h-r*a,0,p*h-r*c,v*h+r*a,i*h*h+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,i,a){return this.set(1,n,i,0,e,1,a,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,i=t._x,a=t._y,c=t._z,h=t._w,p=i+i,v=a+a,x=c+c,S=i*p,C=i*v,I=i*x,L=a*v,U=a*x,R=c*x,$=h*p,Z=h*v,k=h*x,ie=n.x,ue=n.y,ce=n.z;return r[0]=(1-(L+R))*ie,r[1]=(C+k)*ie,r[2]=(I-Z)*ie,r[3]=0,r[4]=(C-k)*ue,r[5]=(1-(S+R))*ue,r[6]=(U+$)*ue,r[7]=0,r[8]=(I+Z)*ce,r[9]=(U-$)*ce,r[10]=(1-(S+L))*ce,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;let i=E7.set(r[0],r[1],r[2]).length();const a=E7.set(r[4],r[5],r[6]).length(),c=E7.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],qd.copy(this);const p=1/i,v=1/a,x=1/c;return qd.elements[0]*=p,qd.elements[1]*=p,qd.elements[2]*=p,qd.elements[4]*=v,qd.elements[5]*=v,qd.elements[6]*=v,qd.elements[8]*=x,qd.elements[9]*=x,qd.elements[10]*=x,t.setFromRotationMatrix(qd),n.x=i,n.y=a,n.z=c,this}makePerspective(e,t,n,r,i,a,c=Qp){const h=this.elements,p=2*i/(t-e),v=2*i/(n-r),x=(t+e)/(t-e),S=(n+r)/(n-r);let C,I;if(c===Qp)C=-(a+i)/(a-i),I=-2*a*i/(a-i);else if(c===Bk)C=-a/(a-i),I=-a*i/(a-i);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+c);return h[0]=p,h[4]=0,h[8]=x,h[12]=0,h[1]=0,h[5]=v,h[9]=S,h[13]=0,h[2]=0,h[6]=0,h[10]=C,h[14]=I,h[3]=0,h[7]=0,h[11]=-1,h[15]=0,this}makeOrthographic(e,t,n,r,i,a,c=Qp){const h=this.elements,p=1/(t-e),v=1/(n-r),x=1/(a-i),S=(t+e)*p,C=(n+r)*v;let I,L;if(c===Qp)I=(a+i)*x,L=-2*x;else if(c===Bk)I=i*x,L=-1*x;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+c);return h[0]=2*p,h[4]=0,h[8]=0,h[12]=-S,h[1]=0,h[5]=2*v,h[9]=0,h[13]=-C,h[2]=0,h[6]=0,h[10]=L,h[14]=-I,h[3]=0,h[7]=0,h[11]=0,h[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}};const E7=new Ie,qd=new vr,GTe=new Ie(0,0,0),jTe=new Ie(1,1,1),S3=new Ie,KP=new Ie,du=new Ie,zpe=new vr,Vpe=new os;let na=class b9e{constructor(e=0,t=0,n=0,r=b9e.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,r=this._order){return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const r=e.elements,i=r[0],a=r[4],c=r[8],h=r[1],p=r[5],v=r[9],x=r[2],S=r[6],C=r[10];switch(t){case"XYZ":this._y=Math.asin(oi(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-v,C),this._z=Math.atan2(-a,i)):(this._x=Math.atan2(S,p),this._z=0);break;case"YXZ":this._x=Math.asin(-oi(v,-1,1)),Math.abs(v)<.9999999?(this._y=Math.atan2(c,C),this._z=Math.atan2(h,p)):(this._y=Math.atan2(-x,i),this._z=0);break;case"ZXY":this._x=Math.asin(oi(S,-1,1)),Math.abs(S)<.9999999?(this._y=Math.atan2(-x,C),this._z=Math.atan2(-a,p)):(this._y=0,this._z=Math.atan2(h,i));break;case"ZYX":this._y=Math.asin(-oi(x,-1,1)),Math.abs(x)<.9999999?(this._x=Math.atan2(S,C),this._z=Math.atan2(h,i)):(this._x=0,this._z=Math.atan2(-a,p));break;case"YZX":this._z=Math.asin(oi(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-v,p),this._y=Math.atan2(-x,i)):(this._x=0,this._y=Math.atan2(c,C));break;case"XZY":this._z=Math.asin(-oi(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(S,p),this._y=Math.atan2(c,i)):(this._x=Math.atan2(-v,C),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return zpe.makeRotationFromQuaternion(e),this.setFromRotationMatrix(zpe,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return Vpe.setFromEuler(this),this.setFromQuaternion(Vpe,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};na.DEFAULT_ORDER="XYZ";let PH=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}},HTe=0;const Gpe=new Ie,T7=new os,rg=new vr,ZP=new Ie,aw=new Ie,WTe=new Ie,$Te=new os,jpe=new Ie(1,0,0),Hpe=new Ie(0,1,0),Wpe=new Ie(0,0,1),$pe={type:"added"},qTe={type:"removed"},M7={type:"childadded",child:null},_z={type:"childremoved",child:null};let Ci=class xk extends gf{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:HTe++}),this.uuid=J3(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=xk.DEFAULT_UP.clone();const e=new Ie,t=new na,n=new os,r=new Ie(1,1,1);function i(){n.setFromEuler(t,!1)}function a(){t.setFromQuaternion(n,void 0,!1)}t._onChange(i),n._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new vr},normalMatrix:{value:new ui}}),this.matrix=new vr,this.matrixWorld=new vr,this.matrixAutoUpdate=xk.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=xk.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new PH,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return T7.setFromAxisAngle(e,t),this.quaternion.multiply(T7),this}rotateOnWorldAxis(e,t){return T7.setFromAxisAngle(e,t),this.quaternion.premultiply(T7),this}rotateX(e){return this.rotateOnAxis(jpe,e)}rotateY(e){return this.rotateOnAxis(Hpe,e)}rotateZ(e){return this.rotateOnAxis(Wpe,e)}translateOnAxis(e,t){return Gpe.copy(e).applyQuaternion(this.quaternion),this.position.add(Gpe.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(jpe,e)}translateY(e){return this.translateOnAxis(Hpe,e)}translateZ(e){return this.translateOnAxis(Wpe,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(rg.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?ZP.copy(e):ZP.set(e,t,n);const r=this.parent;this.updateWorldMatrix(!0,!1),aw.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?rg.lookAt(aw,ZP,this.up):rg.lookAt(ZP,aw,this.up),this.quaternion.setFromRotationMatrix(rg),r&&(rg.extractRotation(r.matrixWorld),T7.setFromRotationMatrix(rg),this.quaternion.premultiply(T7.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent($pe),M7.child=e,this.dispatchEvent(M7),M7.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(qTe),_z.child=e,this.dispatchEvent(_z),_z.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),rg.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),rg.multiply(e.parent.matrixWorld)),e.applyMatrix4(rg),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent($pe),M7.child=e,this.dispatchEvent(M7),M7.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,r=this.children.length;n<r;n++){const a=this.children[n].getObjectByProperty(e,t);if(a!==void 0)return a}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);const r=this.children;for(let i=0,a=r.length;i<a;i++)r[i].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(aw,e,WTe),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(aw,$Te,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(e===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const r=this.children;for(let i=0,a=r.length;i<a;i++)r[i].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.geometryInfo=this._geometryInfo.map(c=>({...c,boundingBox:c.boundingBox?c.boundingBox.toJSON():void 0,boundingSphere:c.boundingSphere?c.boundingSphere.toJSON():void 0})),r.instanceInfo=this._instanceInfo.map(c=>({...c})),r.availableInstanceIds=this._availableInstanceIds.slice(),r.availableGeometryIds=this._availableGeometryIds.slice(),r.nextIndexStart=this._nextIndexStart,r.nextVertexStart=this._nextVertexStart,r.geometryCount=this._geometryCount,r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.matricesTexture=this._matricesTexture.toJSON(e),r.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(r.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(r.boundingSphere=this.boundingSphere.toJSON()),this.boundingBox!==null&&(r.boundingBox=this.boundingBox.toJSON()));function i(c,h){return c[h.uuid]===void 0&&(c[h.uuid]=h.toJSON(e)),h.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=i(e.geometries,this.geometry);const c=this.geometry.parameters;if(c!==void 0&&c.shapes!==void 0){const h=c.shapes;if(Array.isArray(h))for(let p=0,v=h.length;p<v;p++){const x=h[p];i(e.shapes,x)}else i(e.shapes,h)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(i(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const c=[];for(let h=0,p=this.material.length;h<p;h++)c.push(i(e.materials,this.material[h]));r.material=c}else r.material=i(e.materials,this.material);if(this.children.length>0){r.children=[];for(let c=0;c<this.children.length;c++)r.children.push(this.children[c].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let c=0;c<this.animations.length;c++){const h=this.animations[c];r.animations.push(i(e.animations,h))}}if(t){const c=a(e.geometries),h=a(e.materials),p=a(e.textures),v=a(e.images),x=a(e.shapes),S=a(e.skeletons),C=a(e.animations),I=a(e.nodes);c.length>0&&(n.geometries=c),h.length>0&&(n.materials=h),p.length>0&&(n.textures=p),v.length>0&&(n.images=v),x.length>0&&(n.shapes=x),S.length>0&&(n.skeletons=S),C.length>0&&(n.animations=C),I.length>0&&(n.nodes=I)}return n.object=r,n;function a(c){const h=[];for(const p in c){const v=c[p];delete v.metadata,h.push(v)}return h}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){const r=e.children[n];this.add(r.clone())}return this}};Ci.DEFAULT_UP=new Ie(0,1,0);Ci.DEFAULT_MATRIX_AUTO_UPDATE=!0;Ci.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Xd=new Ie,ig=new Ie,xz=new Ie,sg=new Ie,C7=new Ie,A7=new Ie,qpe=new Ie,bz=new Ie,Sz=new Ie,wz=new Ie,Ez=new Pi,Tz=new Pi,Mz=new Pi;let lw=class r_{constructor(e=new Ie,t=new Ie,n=new Ie){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),Xd.subVectors(e,t),r.cross(Xd);const i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}static getBarycoord(e,t,n,r,i){Xd.subVectors(r,t),ig.subVectors(n,t),xz.subVectors(e,t);const a=Xd.dot(Xd),c=Xd.dot(ig),h=Xd.dot(xz),p=ig.dot(ig),v=ig.dot(xz),x=a*p-c*c;if(x===0)return i.set(0,0,0),null;const S=1/x,C=(p*h-c*v)*S,I=(a*v-c*h)*S;return i.set(1-C-I,I,C)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,sg)===null?!1:sg.x>=0&&sg.y>=0&&sg.x+sg.y<=1}static getInterpolation(e,t,n,r,i,a,c,h){return this.getBarycoord(e,t,n,r,sg)===null?(h.x=0,h.y=0,"z"in h&&(h.z=0),"w"in h&&(h.w=0),null):(h.setScalar(0),h.addScaledVector(i,sg.x),h.addScaledVector(a,sg.y),h.addScaledVector(c,sg.z),h)}static getInterpolatedAttribute(e,t,n,r,i,a){return Ez.setScalar(0),Tz.setScalar(0),Mz.setScalar(0),Ez.fromBufferAttribute(e,t),Tz.fromBufferAttribute(e,n),Mz.fromBufferAttribute(e,r),a.setScalar(0),a.addScaledVector(Ez,i.x),a.addScaledVector(Tz,i.y),a.addScaledVector(Mz,i.z),a}static isFrontFacing(e,t,n,r){return Xd.subVectors(n,t),ig.subVectors(e,t),Xd.cross(ig).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Xd.subVectors(this.c,this.b),ig.subVectors(this.a,this.b),Xd.cross(ig).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return r_.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return r_.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,r,i){return r_.getInterpolation(e,this.a,this.b,this.c,t,n,r,i)}containsPoint(e){return r_.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return r_.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,i=this.c;let a,c;C7.subVectors(r,n),A7.subVectors(i,n),bz.subVectors(e,n);const h=C7.dot(bz),p=A7.dot(bz);if(h<=0&&p<=0)return t.copy(n);Sz.subVectors(e,r);const v=C7.dot(Sz),x=A7.dot(Sz);if(v>=0&&x<=v)return t.copy(r);const S=h*x-v*p;if(S<=0&&h>=0&&v<=0)return a=h/(h-v),t.copy(n).addScaledVector(C7,a);wz.subVectors(e,i);const C=C7.dot(wz),I=A7.dot(wz);if(I>=0&&C<=I)return t.copy(i);const L=C*p-h*I;if(L<=0&&p>=0&&I<=0)return c=p/(p-I),t.copy(n).addScaledVector(A7,c);const U=v*I-C*x;if(U<=0&&x-v>=0&&C-I>=0)return qpe.subVectors(i,r),c=(x-v)/(x-v+(C-I)),t.copy(r).addScaledVector(qpe,c);const R=1/(U+L+S);return a=L*R,c=S*R,t.copy(n).addScaledVector(C7,a).addScaledVector(A7,c)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}};const S9e={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},w3={h:0,s:0,l:0},QP={h:0,s:0,l:0};function Cz(o,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?o+(e-o)*6*t:t<1/2?e:t<2/3?o+(e-o)*6*(2/3-t):o}let Vn=class{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=ys){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Kr.colorSpaceToWorking(this,t),this}setRGB(e,t,n,r=Kr.workingColorSpace){return this.r=e,this.g=t,this.b=n,Kr.colorSpaceToWorking(this,r),this}setHSL(e,t,n,r=Kr.workingColorSpace){if(e=MH(e,1),t=oi(t,0,1),n=oi(n,0,1),t===0)this.r=this.g=this.b=n;else{const i=n<=.5?n*(1+t):n+t-n*t,a=2*n-i;this.r=Cz(a,i,e+1/3),this.g=Cz(a,i,e),this.b=Cz(a,i,e-1/3)}return Kr.colorSpaceToWorking(this,r),this}setStyle(e,t=ys){function n(i){i!==void 0&&parseFloat(i)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let i;const a=r[1],c=r[2];switch(a){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return n(i[4]),this.setRGB(Math.min(255,parseInt(i[1],10))/255,Math.min(255,parseInt(i[2],10))/255,Math.min(255,parseInt(i[3],10))/255,t);if(i=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return n(i[4]),this.setRGB(Math.min(100,parseInt(i[1],10))/100,Math.min(100,parseInt(i[2],10))/100,Math.min(100,parseInt(i[3],10))/100,t);break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return n(i[4]),this.setHSL(parseFloat(i[1])/360,parseFloat(i[2])/100,parseFloat(i[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const i=r[1],a=i.length;if(a===3)return this.setRGB(parseInt(i.charAt(0),16)/15,parseInt(i.charAt(1),16)/15,parseInt(i.charAt(2),16)/15,t);if(a===6)return this.setHex(parseInt(i,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=ys){const n=S9e[e.toLowerCase()];return n!==void 0?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=bg(e.r),this.g=bg(e.g),this.b=bg(e.b),this}copyLinearToSRGB(e){return this.r=b_(e.r),this.g=b_(e.g),this.b=b_(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=ys){return Kr.workingToColorSpace(D0.copy(this),e),Math.round(oi(D0.r*255,0,255))*65536+Math.round(oi(D0.g*255,0,255))*256+Math.round(oi(D0.b*255,0,255))}getHexString(e=ys){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Kr.workingColorSpace){Kr.workingToColorSpace(D0.copy(this),t);const n=D0.r,r=D0.g,i=D0.b,a=Math.max(n,r,i),c=Math.min(n,r,i);let h,p;const v=(c+a)/2;if(c===a)h=0,p=0;else{const x=a-c;switch(p=v<=.5?x/(a+c):x/(2-a-c),a){case n:h=(r-i)/x+(r<i?6:0);break;case r:h=(i-n)/x+2;break;case i:h=(n-r)/x+4;break}h/=6}return e.h=h,e.s=p,e.l=v,e}getRGB(e,t=Kr.workingColorSpace){return Kr.workingToColorSpace(D0.copy(this),t),e.r=D0.r,e.g=D0.g,e.b=D0.b,e}getStyle(e=ys){Kr.workingToColorSpace(D0.copy(this),e);const t=D0.r,n=D0.g,r=D0.b;return e!==ys?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(n*255)},${Math.round(r*255)})`}offsetHSL(e,t,n){return this.getHSL(w3),this.setHSL(w3.h+e,w3.s+t,w3.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(w3),e.getHSL(QP);const n=eE(w3.h,QP.h,t),r=eE(w3.s,QP.s,t),i=eE(w3.l,QP.l,t);return this.setHSL(n,r,i),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,r=this.b,i=e.elements;return this.r=i[0]*t+i[3]*n+i[6]*r,this.g=i[1]*t+i[4]*n+i[7]*r,this.b=i[2]*t+i[5]*n+i[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const D0=new Vn;Vn.NAMES=S9e;let XTe=0,yf=class extends gf{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:XTe++}),this.uuid=J3(),this.name="",this.type="Material",this.blending=p6,this.side=Rg,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=hE,this.blendDst=dE,this.blendEquation=V3,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Vn(0,0,0),this.blendAlpha=0,this.depthFunc=k_,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Npe,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=_7,this.stencilZFail=_7,this.stencilZPass=_7,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==p6&&(n.blending=this.blending),this.side!==Rg&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==hE&&(n.blendSrc=this.blendSrc),this.blendDst!==dE&&(n.blendDst=this.blendDst),this.blendEquation!==V3&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==k_&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==Npe&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==_7&&(n.stencilFail=this.stencilFail),this.stencilZFail!==_7&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==_7&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function r(i){const a=[];for(const c in i){const h=i[c];delete h.metadata,a.push(h)}return a}if(t){const i=r(e.textures),a=r(e.images);i.length>0&&(n.textures=i),a.length>0&&(n.images=a)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const r=t.length;n=new Array(r);for(let i=0;i!==r;++i)n[i]=t[i].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}},wu=class extends yf{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Vn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new na,this.combine=gI,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}};const gg=YTe();function YTe(){const o=new ArrayBuffer(4),e=new Float32Array(o),t=new Uint32Array(o),n=new Uint32Array(512),r=new Uint32Array(512);for(let h=0;h<256;++h){const p=h-127;p<-27?(n[h]=0,n[h|256]=32768,r[h]=24,r[h|256]=24):p<-14?(n[h]=1024>>-p-14,n[h|256]=1024>>-p-14|32768,r[h]=-p-1,r[h|256]=-p-1):p<=15?(n[h]=p+15<<10,n[h|256]=p+15<<10|32768,r[h]=13,r[h|256]=13):p<128?(n[h]=31744,n[h|256]=64512,r[h]=24,r[h|256]=24):(n[h]=31744,n[h|256]=64512,r[h]=13,r[h|256]=13)}const i=new Uint32Array(2048),a=new Uint32Array(64),c=new Uint32Array(64);for(let h=1;h<1024;++h){let p=h<<13,v=0;for(;(p&8388608)===0;)p<<=1,v-=8388608;p&=-8388609,v+=947912704,i[h]=p|v}for(let h=1024;h<2048;++h)i[h]=939524096+(h-1024<<13);for(let h=1;h<31;++h)a[h]=h<<23;a[31]=1199570944,a[32]=2147483648;for(let h=33;h<63;++h)a[h]=2147483648+(h-32<<23);a[63]=3347054592;for(let h=1;h<64;++h)h!==32&&(c[h]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:r,mantissaTable:i,exponentTable:a,offsetTable:c}}function KTe(o){Math.abs(o)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),o=oi(o,-65504,65504),gg.floatView[0]=o;const e=gg.uint32View[0],t=e>>23&511;return gg.baseTable[t]+((e&8388607)>>gg.shiftTable[t])}function ZTe(o){const e=o>>10;return gg.uint32View[0]=gg.mantissaTable[gg.offsetTable[e]+(o&1023)]+gg.exponentTable[e],gg.floatView[0]}class Xpe{static toHalfFloat(e){return KTe(e)}static fromHalfFloat(e){return ZTe(e)}}const Jo=new Ie,JP=new mr;let QTe=0,hf=class{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:QTe++}),this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=Dpe,this.updateRanges=[],this.gpuType=Th,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)JP.fromBufferAttribute(this,t),JP.applyMatrix3(e),this.setXY(t,JP.x,JP.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)Jo.fromBufferAttribute(this,t),Jo.applyMatrix3(e),this.setXYZ(t,Jo.x,Jo.y,Jo.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)Jo.fromBufferAttribute(this,t),Jo.applyMatrix4(e),this.setXYZ(t,Jo.x,Jo.y,Jo.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Jo.fromBufferAttribute(this,t),Jo.applyNormalMatrix(e),this.setXYZ(t,Jo.x,Jo.y,Jo.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Jo.fromBufferAttribute(this,t),Jo.transformDirection(e),this.setXYZ(t,Jo.x,Jo.y,Jo.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=n_(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=Tl(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=n_(t,this.array)),t}setX(e,t){return this.normalized&&(t=Tl(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=n_(t,this.array)),t}setY(e,t){return this.normalized&&(t=Tl(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=n_(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Tl(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=n_(t,this.array)),t}setW(e,t){return this.normalized&&(t=Tl(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=Tl(t,this.array),n=Tl(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=Tl(t,this.array),n=Tl(n,this.array),r=Tl(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,i){return e*=this.itemSize,this.normalized&&(t=Tl(t,this.array),n=Tl(n,this.array),r=Tl(r,this.array),i=Tl(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Dpe&&(e.usage=this.usage),e}},RH=class extends hf{constructor(e,t,n){super(new Uint16Array(e),t,n)}},w9e=class extends hf{constructor(e,t,n){super(new Uint32Array(e),t,n)}},Ur=class extends hf{constructor(e,t,n){super(new Float32Array(e),t,n)}},JTe=0;const vh=new vr,Az=new Ci,P7=new Ie,fu=new T6,cw=new T6,Da=new Ie;let _s=class E9e extends gf{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:JTe++}),this.uuid=J3(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(v9e(e)?w9e:RH)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const i=new ui().getNormalMatrix(e);n.applyNormalMatrix(i),n.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return vh.makeRotationFromQuaternion(e),this.applyMatrix4(vh),this}rotateX(e){return vh.makeRotationX(e),this.applyMatrix4(vh),this}rotateY(e){return vh.makeRotationY(e),this.applyMatrix4(vh),this}rotateZ(e){return vh.makeRotationZ(e),this.applyMatrix4(vh),this}translate(e,t,n){return vh.makeTranslation(e,t,n),this.applyMatrix4(vh),this}scale(e,t,n){return vh.makeScale(e,t,n),this.applyMatrix4(vh),this}lookAt(e){return Az.lookAt(e),Az.updateMatrix(),this.applyMatrix4(Az.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(P7).negate(),this.translate(P7.x,P7.y,P7.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const n=[];for(let r=0,i=e.length;r<i;r++){const a=e[r];n.push(a.x,a.y,a.z||0)}this.setAttribute("position",new Ur(n,3))}else{const n=Math.min(e.length,t.count);for(let r=0;r<n;r++){const i=e[r];t.setXYZ(r,i.x,i.y,i.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new T6);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new Ie(-1/0,-1/0,-1/0),new Ie(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++){const i=t[n];fu.setFromBufferAttribute(i),this.morphTargetsRelative?(Da.addVectors(this.boundingBox.min,fu.min),this.boundingBox.expandByPoint(Da),Da.addVectors(this.boundingBox.max,fu.max),this.boundingBox.expandByPoint(Da)):(this.boundingBox.expandByPoint(fu.min),this.boundingBox.expandByPoint(fu.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new e4);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new Ie,1/0);return}if(e){const n=this.boundingSphere.center;if(fu.setFromBufferAttribute(e),t)for(let i=0,a=t.length;i<a;i++){const c=t[i];cw.setFromBufferAttribute(c),this.morphTargetsRelative?(Da.addVectors(fu.min,cw.min),fu.expandByPoint(Da),Da.addVectors(fu.max,cw.max),fu.expandByPoint(Da)):(fu.expandByPoint(cw.min),fu.expandByPoint(cw.max))}fu.getCenter(n);let r=0;for(let i=0,a=e.count;i<a;i++)Da.fromBufferAttribute(e,i),r=Math.max(r,n.distanceToSquared(Da));if(t)for(let i=0,a=t.length;i<a;i++){const c=t[i],h=this.morphTargetsRelative;for(let p=0,v=c.count;p<v;p++)Da.fromBufferAttribute(c,p),h&&(P7.fromBufferAttribute(e,p),Da.add(P7)),r=Math.max(r,n.distanceToSquared(Da))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=t.position,r=t.normal,i=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new hf(new Float32Array(4*n.count),4));const a=this.getAttribute("tangent"),c=[],h=[];for(let Q=0;Q<n.count;Q++)c[Q]=new Ie,h[Q]=new Ie;const p=new Ie,v=new Ie,x=new Ie,S=new mr,C=new mr,I=new mr,L=new Ie,U=new Ie;function R(Q,ae,le){p.fromBufferAttribute(n,Q),v.fromBufferAttribute(n,ae),x.fromBufferAttribute(n,le),S.fromBufferAttribute(i,Q),C.fromBufferAttribute(i,ae),I.fromBufferAttribute(i,le),v.sub(p),x.sub(p),C.sub(S),I.sub(S);const J=1/(C.x*I.y-I.x*C.y);isFinite(J)&&(L.copy(v).multiplyScalar(I.y).addScaledVector(x,-C.y).multiplyScalar(J),U.copy(x).multiplyScalar(C.x).addScaledVector(v,-I.x).multiplyScalar(J),c[Q].add(L),c[ae].add(L),c[le].add(L),h[Q].add(U),h[ae].add(U),h[le].add(U))}let $=this.groups;$.length===0&&($=[{start:0,count:e.count}]);for(let Q=0,ae=$.length;Q<ae;++Q){const le=$[Q],J=le.start,Ue=le.count;for(let je=J,rt=J+Ue;je<rt;je+=3)R(e.getX(je+0),e.getX(je+1),e.getX(je+2))}const Z=new Ie,k=new Ie,ie=new Ie,ue=new Ie;function ce(Q){ie.fromBufferAttribute(r,Q),ue.copy(ie);const ae=c[Q];Z.copy(ae),Z.sub(ie.multiplyScalar(ie.dot(ae))).normalize(),k.crossVectors(ue,ae);const J=k.dot(h[Q])<0?-1:1;a.setXYZW(Q,Z.x,Z.y,Z.z,J)}for(let Q=0,ae=$.length;Q<ae;++Q){const le=$[Q],J=le.start,Ue=le.count;for(let je=J,rt=J+Ue;je<rt;je+=3)ce(e.getX(je+0)),ce(e.getX(je+1)),ce(e.getX(je+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new hf(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let S=0,C=n.count;S<C;S++)n.setXYZ(S,0,0,0);const r=new Ie,i=new Ie,a=new Ie,c=new Ie,h=new Ie,p=new Ie,v=new Ie,x=new Ie;if(e)for(let S=0,C=e.count;S<C;S+=3){const I=e.getX(S+0),L=e.getX(S+1),U=e.getX(S+2);r.fromBufferAttribute(t,I),i.fromBufferAttribute(t,L),a.fromBufferAttribute(t,U),v.subVectors(a,i),x.subVectors(r,i),v.cross(x),c.fromBufferAttribute(n,I),h.fromBufferAttribute(n,L),p.fromBufferAttribute(n,U),c.add(v),h.add(v),p.add(v),n.setXYZ(I,c.x,c.y,c.z),n.setXYZ(L,h.x,h.y,h.z),n.setXYZ(U,p.x,p.y,p.z)}else for(let S=0,C=t.count;S<C;S+=3)r.fromBufferAttribute(t,S+0),i.fromBufferAttribute(t,S+1),a.fromBufferAttribute(t,S+2),v.subVectors(a,i),x.subVectors(r,i),v.cross(x),n.setXYZ(S+0,v.x,v.y,v.z),n.setXYZ(S+1,v.x,v.y,v.z),n.setXYZ(S+2,v.x,v.y,v.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Da.fromBufferAttribute(e,t),Da.normalize(),e.setXYZ(t,Da.x,Da.y,Da.z)}toNonIndexed(){function e(c,h){const p=c.array,v=c.itemSize,x=c.normalized,S=new p.constructor(h.length*v);let C=0,I=0;for(let L=0,U=h.length;L<U;L++){c.isInterleavedBufferAttribute?C=h[L]*c.data.stride+c.offset:C=h[L]*v;for(let R=0;R<v;R++)S[I++]=p[C++]}return new hf(S,v,x)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new E9e,n=this.index.array,r=this.attributes;for(const c in r){const h=r[c],p=e(h,n);t.setAttribute(c,p)}const i=this.morphAttributes;for(const c in i){const h=[],p=i[c];for(let v=0,x=p.length;v<x;v++){const S=p[v],C=e(S,n);h.push(C)}t.morphAttributes[c]=h}t.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let c=0,h=a.length;c<h;c++){const p=a[c];t.addGroup(p.start,p.count,p.materialIndex)}return t}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const h=this.parameters;for(const p in h)h[p]!==void 0&&(e[p]=h[p]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const h in n){const p=n[h];e.data.attributes[h]=p.toJSON(e.data)}const r={};let i=!1;for(const h in this.morphAttributes){const p=this.morphAttributes[h],v=[];for(let x=0,S=p.length;x<S;x++){const C=p[x];v.push(C.toJSON(e.data))}v.length>0&&(r[h]=v,i=!0)}i&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const c=this.boundingSphere;return c!==null&&(e.data.boundingSphere=c.toJSON()),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone());const r=e.attributes;for(const p in r){const v=r[p];this.setAttribute(p,v.clone(t))}const i=e.morphAttributes;for(const p in i){const v=[],x=i[p];for(let S=0,C=x.length;S<C;S++)v.push(x[S].clone(t));this.morphAttributes[p]=v}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let p=0,v=a.length;p<v;p++){const x=a[p];this.addGroup(x.start,x.count,x.materialIndex)}const c=e.boundingBox;c!==null&&(this.boundingBox=c.clone());const h=e.boundingSphere;return h!==null&&(this.boundingSphere=h.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}};const Ype=new vr,O8=new Z_,eR=new e4,Kpe=new Ie,tR=new Ie,nR=new Ie,rR=new Ie,Pz=new Ie,iR=new Ie,Zpe=new Ie,sR=new Ie;let Mn=class extends Ci{constructor(e=new _s,t=new wu){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,a=r.length;i<a;i++){const c=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=i}}}}getVertexPosition(e,t){const n=this.geometry,r=n.attributes.position,i=n.morphAttributes.position,a=n.morphTargetsRelative;t.fromBufferAttribute(r,e);const c=this.morphTargetInfluences;if(i&&c){iR.set(0,0,0);for(let h=0,p=i.length;h<p;h++){const v=c[h],x=i[h];v!==0&&(Pz.fromBufferAttribute(x,e),a?iR.addScaledVector(Pz,v):iR.addScaledVector(Pz.sub(t),v))}t.add(iR)}return t}raycast(e,t){const n=this.geometry,r=this.material,i=this.matrixWorld;r!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),eR.copy(n.boundingSphere),eR.applyMatrix4(i),O8.copy(e.ray).recast(e.near),!(eR.containsPoint(O8.origin)===!1&&(O8.intersectSphere(eR,Kpe)===null||O8.origin.distanceToSquared(Kpe)>(e.far-e.near)**2))&&(Ype.copy(i).invert(),O8.copy(e.ray).applyMatrix4(Ype),!(n.boundingBox!==null&&O8.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,t,O8)))}_computeIntersections(e,t,n){let r;const i=this.geometry,a=this.material,c=i.index,h=i.attributes.position,p=i.attributes.uv,v=i.attributes.uv1,x=i.attributes.normal,S=i.groups,C=i.drawRange;if(c!==null)if(Array.isArray(a))for(let I=0,L=S.length;I<L;I++){const U=S[I],R=a[U.materialIndex],$=Math.max(U.start,C.start),Z=Math.min(c.count,Math.min(U.start+U.count,C.start+C.count));for(let k=$,ie=Z;k<ie;k+=3){const ue=c.getX(k),ce=c.getX(k+1),Q=c.getX(k+2);r=oR(this,R,e,n,p,v,x,ue,ce,Q),r&&(r.faceIndex=Math.floor(k/3),r.face.materialIndex=U.materialIndex,t.push(r))}}else{const I=Math.max(0,C.start),L=Math.min(c.count,C.start+C.count);for(let U=I,R=L;U<R;U+=3){const $=c.getX(U),Z=c.getX(U+1),k=c.getX(U+2);r=oR(this,a,e,n,p,v,x,$,Z,k),r&&(r.faceIndex=Math.floor(U/3),t.push(r))}}else if(h!==void 0)if(Array.isArray(a))for(let I=0,L=S.length;I<L;I++){const U=S[I],R=a[U.materialIndex],$=Math.max(U.start,C.start),Z=Math.min(h.count,Math.min(U.start+U.count,C.start+C.count));for(let k=$,ie=Z;k<ie;k+=3){const ue=k,ce=k+1,Q=k+2;r=oR(this,R,e,n,p,v,x,ue,ce,Q),r&&(r.faceIndex=Math.floor(k/3),r.face.materialIndex=U.materialIndex,t.push(r))}}else{const I=Math.max(0,C.start),L=Math.min(h.count,C.start+C.count);for(let U=I,R=L;U<R;U+=3){const $=U,Z=U+1,k=U+2;r=oR(this,a,e,n,p,v,x,$,Z,k),r&&(r.faceIndex=Math.floor(U/3),t.push(r))}}}};function eMe(o,e,t,n,r,i,a,c){let h;if(e.side===u0?h=n.intersectTriangle(a,i,r,!0,c):h=n.intersectTriangle(r,i,a,e.side===Rg,c),h===null)return null;sR.copy(c),sR.applyMatrix4(o.matrixWorld);const p=t.ray.origin.distanceTo(sR);return p<t.near||p>t.far?null:{distance:p,point:sR.clone(),object:o}}function oR(o,e,t,n,r,i,a,c,h,p){o.getVertexPosition(c,tR),o.getVertexPosition(h,nR),o.getVertexPosition(p,rR);const v=eMe(o,e,t,n,tR,nR,rR,Zpe);if(v){const x=new Ie;lw.getBarycoord(Zpe,tR,nR,rR,x),r&&(v.uv=lw.getInterpolatedAttribute(r,c,h,p,x,new mr)),i&&(v.uv1=lw.getInterpolatedAttribute(i,c,h,p,x,new mr)),a&&(v.normal=lw.getInterpolatedAttribute(a,c,h,p,x,new Ie),v.normal.dot(n.direction)>0&&v.normal.multiplyScalar(-1));const S={a:c,b:h,c:p,normal:new Ie,materialIndex:0};lw.getNormal(tR,nR,rR,S.normal),v.face=S,v.barycoord=x}return v}let ma=class T9e extends _s{constructor(e=1,t=1,n=1,r=1,i=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:i,depthSegments:a};const c=this;r=Math.floor(r),i=Math.floor(i),a=Math.floor(a);const h=[],p=[],v=[],x=[];let S=0,C=0;I("z","y","x",-1,-1,n,t,e,a,i,0),I("z","y","x",1,-1,n,t,-e,a,i,1),I("x","z","y",1,1,e,n,t,r,a,2),I("x","z","y",1,-1,e,n,-t,r,a,3),I("x","y","z",1,-1,e,t,n,r,i,4),I("x","y","z",-1,-1,e,t,-n,r,i,5),this.setIndex(h),this.setAttribute("position",new Ur(p,3)),this.setAttribute("normal",new Ur(v,3)),this.setAttribute("uv",new Ur(x,2));function I(L,U,R,$,Z,k,ie,ue,ce,Q,ae){const le=k/ce,J=ie/Q,Ue=k/2,je=ie/2,rt=ue/2,at=ce+1,Se=Q+1;let gt=0,Ae=0;const lt=new Ie;for(let pt=0;pt<Se;pt++){const De=pt*J-je;for(let _t=0;_t<at;_t++){const Jt=_t*le-Ue;lt[L]=Jt*$,lt[U]=De*Z,lt[R]=rt,p.push(lt.x,lt.y,lt.z),lt[L]=0,lt[U]=0,lt[R]=ue>0?1:-1,v.push(lt.x,lt.y,lt.z),x.push(_t/ce),x.push(1-pt/Q),gt+=1}}for(let pt=0;pt<Q;pt++)for(let De=0;De<ce;De++){const _t=S+De+at*pt,Jt=S+De+at*(pt+1),dt=S+(De+1)+at*(pt+1),Dt=S+(De+1)+at*pt;h.push(_t,Jt,Dt),h.push(Jt,dt,Dt),Ae+=6}c.addGroup(C,Ae,ae),C+=Ae,S+=gt}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new T9e(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};function O_(o){const e={};for(const t in o){e[t]={};for(const n in o[t]){const r=o[t][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=r.clone():Array.isArray(r)?e[t][n]=r.slice():e[t][n]=r}}return e}function Ml(o){const e={};for(let t=0;t<o.length;t++){const n=O_(o[t]);for(const r in n)e[r]=n[r]}return e}function tMe(o){const e=[];for(let t=0;t<o.length;t++)e.push(o[t].clone());return e}function M9e(o){const e=o.getRenderTarget();return e===null?o.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:Kr.workingColorSpace}const nMe={clone:O_,merge:Ml};var rMe=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,iMe=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;let ff=class extends yf{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=rMe,this.fragmentShader=iMe,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=O_(e.uniforms),this.uniformsGroups=tMe(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const a=this.uniforms[r].value;a&&a.isTexture?t.uniforms[r]={type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?t.uniforms[r]={type:"c",value:a.getHex()}:a&&a.isVector2?t.uniforms[r]={type:"v2",value:a.toArray()}:a&&a.isVector3?t.uniforms[r]={type:"v3",value:a.toArray()}:a&&a.isVector4?t.uniforms[r]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?t.uniforms[r]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?t.uniforms[r]={type:"m4",value:a.toArray()}:t.uniforms[r]={value:a}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const r in this.extensions)this.extensions[r]===!0&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}},kH=class extends Ci{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new vr,this.projectionMatrix=new vr,this.projectionMatrixInverse=new vr,this.coordinateSystem=Qp}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}};const E3=new Ie,Qpe=new mr,Jpe=new mr;let La=class extends kH{constructor(e=50,t=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=D_*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Jw*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return D_*2*Math.atan(Math.tan(Jw*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){E3.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(E3.x,E3.y).multiplyScalar(-e/E3.z),E3.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(E3.x,E3.y).multiplyScalar(-e/E3.z)}getViewSize(e,t){return this.getViewBounds(e,Qpe,Jpe),t.subVectors(Jpe,Qpe)}setViewOffset(e,t,n,r,i,a){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(Jw*.5*this.fov)/this.zoom,n=2*t,r=this.aspect*n,i=-.5*r;const a=this.view;if(this.view!==null&&this.view.enabled){const h=a.fullWidth,p=a.fullHeight;i+=a.offsetX*r/h,t-=a.offsetY*n/p,r*=a.width/h,n*=a.height/p}const c=this.filmOffset;c!==0&&(i+=e*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,t,t-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}};const R7=-90,k7=1;let sMe=class extends Ci{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new La(R7,k7,e,t);r.layers=this.layers,this.add(r);const i=new La(R7,k7,e,t);i.layers=this.layers,this.add(i);const a=new La(R7,k7,e,t);a.layers=this.layers,this.add(a);const c=new La(R7,k7,e,t);c.layers=this.layers,this.add(c);const h=new La(R7,k7,e,t);h.layers=this.layers,this.add(h);const p=new La(R7,k7,e,t);p.layers=this.layers,this.add(p)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,r,i,a,c,h]=t;for(const p of t)this.remove(p);if(e===Qp)n.up.set(0,1,0),n.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),i.up.set(0,0,-1),i.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),c.up.set(0,1,0),c.lookAt(0,0,1),h.up.set(0,1,0),h.lookAt(0,0,-1);else if(e===Bk)n.up.set(0,-1,0),n.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),i.up.set(0,0,1),i.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),c.up.set(0,-1,0),c.lookAt(0,0,1),h.up.set(0,-1,0),h.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const p of t)this.add(p),p.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[i,a,c,h,p,v]=this.children,x=e.getRenderTarget(),S=e.getActiveCubeFace(),C=e.getActiveMipmapLevel(),I=e.xr.enabled;e.xr.enabled=!1;const L=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,r),e.render(t,i),e.setRenderTarget(n,1,r),e.render(t,a),e.setRenderTarget(n,2,r),e.render(t,c),e.setRenderTarget(n,3,r),e.render(t,h),e.setRenderTarget(n,4,r),e.render(t,p),n.texture.generateMipmaps=L,e.setRenderTarget(n,5,r),e.render(t,v),e.setRenderTarget(x,S,C),e.xr.enabled=I,n.texture.needsPMREMUpdate=!0}},IH=class extends H0{constructor(e=[],t=I_,n,r,i,a,c,h,p,v){super(e,t,n,r,i,a,c,h,p,v),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}},oMe=class extends _6{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},r=[n,n,n,n,n,n];this.texture=new IH(r),this._setTextureOptions(t),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new ma(5,5,5),i=new ff({name:"CubemapFromEquirect",uniforms:O_(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:u0,blending:xg});i.uniforms.tEquirect.value=t;const a=new Mn(r,i),c=t.minFilter;return t.minFilter===u6&&(t.minFilter=xc),new sMe(1,10,this).update(e,a),t.minFilter=c,a.geometry.dispose(),a.material.dispose(),this}clear(e,t=!0,n=!0,r=!0){const i=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,n,r);e.setRenderTarget(i)}},h6=class extends Ci{constructor(){super(),this.isGroup=!0,this.type="Group"}};const aMe={type:"move"};let Rz=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new h6,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new h6,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Ie,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Ie),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new h6,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Ie,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Ie),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let r=null,i=null,a=null;const c=this._targetRay,h=this._grip,p=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(p&&e.hand){a=!0;for(const L of e.hand.values()){const U=t.getJointPose(L,n),R=this._getHandJoint(p,L);U!==null&&(R.matrix.fromArray(U.transform.matrix),R.matrix.decompose(R.position,R.rotation,R.scale),R.matrixWorldNeedsUpdate=!0,R.jointRadius=U.radius),R.visible=U!==null}const v=p.joints["index-finger-tip"],x=p.joints["thumb-tip"],S=v.position.distanceTo(x.position),C=.02,I=.005;p.inputState.pinching&&S>C+I?(p.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!p.inputState.pinching&&S<=C-I&&(p.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else h!==null&&e.gripSpace&&(i=t.getPose(e.gripSpace,n),i!==null&&(h.matrix.fromArray(i.transform.matrix),h.matrix.decompose(h.position,h.rotation,h.scale),h.matrixWorldNeedsUpdate=!0,i.linearVelocity?(h.hasLinearVelocity=!0,h.linearVelocity.copy(i.linearVelocity)):h.hasLinearVelocity=!1,i.angularVelocity?(h.hasAngularVelocity=!0,h.angularVelocity.copy(i.angularVelocity)):h.hasAngularVelocity=!1));c!==null&&(r=t.getPose(e.targetRaySpace,n),r===null&&i!==null&&(r=i),r!==null&&(c.matrix.fromArray(r.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),c.matrixWorldNeedsUpdate=!0,r.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(r.linearVelocity)):c.hasLinearVelocity=!1,r.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(r.angularVelocity)):c.hasAngularVelocity=!1,this.dispatchEvent(aMe)))}return c!==null&&(c.visible=r!==null),h!==null&&(h.visible=i!==null),p!==null&&(p.visible=a!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const n=new h6;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}},vI=class extends Ci{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new na,this.environmentIntensity=1,this.environmentRotation=new na,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}};const e1e=new Ie,t1e=new Pi,n1e=new Pi,lMe=new Ie,r1e=new vr,aR=new Ie,kz=new e4,i1e=new vr,Iz=new Z_;class NH extends Mn{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=Ipe,this.bindMatrix=new vr,this.bindMatrixInverse=new vr,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new T6),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,aR),this.boundingBox.expandByPoint(aR)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new e4),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,aR),this.boundingSphere.expandByPoint(aR)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const n=this.material,r=this.matrixWorld;n!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),kz.copy(this.boundingSphere),kz.applyMatrix4(r),e.ray.intersectsSphere(kz)!==!1&&(i1e.copy(r).invert(),Iz.copy(e.ray).applyMatrix4(i1e),!(this.boundingBox!==null&&Iz.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,Iz)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Pi,t=this.geometry.attributes.skinWeight;for(let n=0,r=t.count;n<r;n++){e.fromBufferAttribute(t,n);const i=1/e.manhattanLength();i!==1/0?e.multiplyScalar(i):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===Ipe?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===eTe?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const n=this.skeleton,r=this.geometry;t1e.fromBufferAttribute(r.attributes.skinIndex,e),n1e.fromBufferAttribute(r.attributes.skinWeight,e),e1e.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let i=0;i<4;i++){const a=n1e.getComponent(i);if(a!==0){const c=t1e.getComponent(i);r1e.multiplyMatrices(n.bones[c].matrixWorld,n.boneInverses[c]),t.addScaledVector(lMe.copy(e1e).applyMatrix4(r1e),a)}}return t.applyMatrix4(this.bindMatrixInverse)}}class hj extends Ci{constructor(){super(),this.isBone=!0,this.type="Bone"}}let zw=class extends H0{constructor(e=null,t=1,n=1,r,i,a,c,h,p=c0,v=c0,x,S){super(null,a,c,h,p,v,r,i,x,S),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};const s1e=new vr,cMe=new vr;class DH{constructor(e=[],t=[]){this.uuid=J3(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new vr)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new vr;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let i=0,a=e.length;i<a;i++){const c=e[i]?e[i].matrixWorld:cMe;s1e.multiplyMatrices(c,t[i]),s1e.toArray(n,i*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new DH(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new zw(t,e,e,V0,Th);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,r=e.bones.length;n<r;n++){const i=e.bones[n];let a=t[i];a===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",i),a=new hj),this.bones.push(a),this.boneInverses.push(new vr().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.7,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let r=0,i=t.length;r<i;r++){const a=t[r];e.bones.push(a.uuid);const c=n[r];e.boneInverses.push(c.toArray())}return e}}const Nz=new Ie,uMe=new Ie,hMe=new ui;let L3=class{constructor(e=new Ie(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const r=Nz.subVectors(n,t).cross(uMe.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(Nz),r=this.normal.dot(n);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const i=-(e.start.dot(this.normal)+this.constant)/r;return i<0||i>1?null:t.copy(e.start).addScaledVector(n,i)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||hMe.getNormalMatrix(e),r=this.coplanarPoint(Nz).applyMatrix4(e),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}};const F8=new e4,lR=new Ie;let OH=class{constructor(e=new L3,t=new L3,n=new L3,r=new L3,i=new L3,a=new L3){this.planes=[e,t,n,r,i,a]}set(e,t,n,r,i,a){const c=this.planes;return c[0].copy(e),c[1].copy(t),c[2].copy(n),c[3].copy(r),c[4].copy(i),c[5].copy(a),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=Qp){const n=this.planes,r=e.elements,i=r[0],a=r[1],c=r[2],h=r[3],p=r[4],v=r[5],x=r[6],S=r[7],C=r[8],I=r[9],L=r[10],U=r[11],R=r[12],$=r[13],Z=r[14],k=r[15];if(n[0].setComponents(h-i,S-p,U-C,k-R).normalize(),n[1].setComponents(h+i,S+p,U+C,k+R).normalize(),n[2].setComponents(h+a,S+v,U+I,k+$).normalize(),n[3].setComponents(h-a,S-v,U-I,k-$).normalize(),n[4].setComponents(h-c,S-x,U-L,k-Z).normalize(),t===Qp)n[5].setComponents(h+c,S+x,U+L,k+Z).normalize();else if(t===Bk)n[5].setComponents(c,x,L,Z).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),F8.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),F8.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(F8)}intersectsSprite(e){return F8.center.set(0,0,0),F8.radius=.7071067811865476,F8.applyMatrix4(e.matrixWorld),this.intersectsSphere(F8)}intersectsSphere(e){const t=this.planes,n=e.center,r=-e.radius;for(let i=0;i<6;i++)if(t[i].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];if(lR.x=r.normal.x>0?e.max.x:e.min.x,lR.y=r.normal.y>0?e.max.y:e.min.y,lR.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(lR)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}},vf=class extends yf{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Vn(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}};const Uk=new Ie,zk=new Ie,o1e=new vr,uw=new Z_,cR=new e4,Dz=new Ie,a1e=new Ie;class _c extends Ci{constructor(e=new _s,t=new vf){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[0];for(let r=1,i=t.count;r<i;r++)Uk.fromBufferAttribute(t,r-1),zk.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=Uk.distanceTo(zk);e.setAttribute("lineDistance",new Ur(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,i=e.params.Line.threshold,a=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),cR.copy(n.boundingSphere),cR.applyMatrix4(r),cR.radius+=i,e.ray.intersectsSphere(cR)===!1)return;o1e.copy(r).invert(),uw.copy(e.ray).applyMatrix4(o1e);const c=i/((this.scale.x+this.scale.y+this.scale.z)/3),h=c*c,p=this.isLineSegments?2:1,v=n.index,S=n.attributes.position;if(v!==null){const C=Math.max(0,a.start),I=Math.min(v.count,a.start+a.count);for(let L=C,U=I-1;L<U;L+=p){const R=v.getX(L),$=v.getX(L+1),Z=uR(this,e,uw,h,R,$,L);Z&&t.push(Z)}if(this.isLineLoop){const L=v.getX(I-1),U=v.getX(C),R=uR(this,e,uw,h,L,U,I-1);R&&t.push(R)}}else{const C=Math.max(0,a.start),I=Math.min(S.count,a.start+a.count);for(let L=C,U=I-1;L<U;L+=p){const R=uR(this,e,uw,h,L,L+1,L);R&&t.push(R)}if(this.isLineLoop){const L=uR(this,e,uw,h,I-1,C,I-1);L&&t.push(L)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,a=r.length;i<a;i++){const c=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=i}}}}}function uR(o,e,t,n,r,i,a){const c=o.geometry.attributes.position;if(Uk.fromBufferAttribute(c,r),zk.fromBufferAttribute(c,i),t.distanceSqToSegment(Uk,zk,Dz,a1e)>n)return;Dz.applyMatrix4(o.matrixWorld);const p=e.ray.origin.distanceTo(Dz);if(!(p<e.near||p>e.far))return{distance:p,point:a1e.clone().applyMatrix4(o.matrixWorld),index:a,face:null,faceIndex:null,barycoord:null,object:o}}const l1e=new Ie,c1e=new Ie;class NE extends _c{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[];for(let r=0,i=t.count;r<i;r+=2)l1e.fromBufferAttribute(t,r),c1e.fromBufferAttribute(t,r+1),n[r]=r===0?0:n[r-1],n[r+1]=n[r]+l1e.distanceTo(c1e);e.setAttribute("lineDistance",new Ur(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}let C9e=class extends yf{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Vn(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}};const u1e=new vr,dj=new Z_,hR=new e4,dR=new Ie;class dMe extends Ci{constructor(e=new _s,t=new C9e){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,i=e.params.Points.threshold,a=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),hR.copy(n.boundingSphere),hR.applyMatrix4(r),hR.radius+=i,e.ray.intersectsSphere(hR)===!1)return;u1e.copy(r).invert(),dj.copy(e.ray).applyMatrix4(u1e);const c=i/((this.scale.x+this.scale.y+this.scale.z)/3),h=c*c,p=n.index,x=n.attributes.position;if(p!==null){const S=Math.max(0,a.start),C=Math.min(p.count,a.start+a.count);for(let I=S,L=C;I<L;I++){const U=p.getX(I);dR.fromBufferAttribute(x,U),h1e(dR,U,h,r,e,t,this)}}else{const S=Math.max(0,a.start),C=Math.min(x.count,a.start+a.count);for(let I=S,L=C;I<L;I++)dR.fromBufferAttribute(x,I),h1e(dR,I,h,r,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,a=r.length;i<a;i++){const c=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=i}}}}}function h1e(o,e,t,n,r,i,a){const c=dj.distanceSqToPoint(o);if(c<t){const h=new Ie;dj.closestPointToPoint(o,h),h.applyMatrix4(n);const p=r.ray.origin.distanceTo(h);if(p<r.near||p>r.far)return;i.push({distance:p,distanceToRay:Math.sqrt(c),point:h,index:e,face:null,faceIndex:null,barycoord:null,object:a})}}let A9e=class extends H0{constructor(e,t,n=y6,r,i,a,c=c0,h=c0,p,v=mE,x=1){if(v!==mE&&v!==gE)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");const S={width:e,height:t,depth:x};super(S,r,i,a,c,h,v,n,p),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new CH(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}};class _I extends _s{constructor(e=1,t=32,n=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},t=Math.max(3,t);const i=[],a=[],c=[],h=[],p=new Ie,v=new mr;a.push(0,0,0),c.push(0,0,1),h.push(.5,.5);for(let x=0,S=3;x<=t;x++,S+=3){const C=n+x/t*r;p.x=e*Math.cos(C),p.y=e*Math.sin(C),a.push(p.x,p.y,p.z),c.push(0,0,1),v.x=(a[S]/e+1)/2,v.y=(a[S+1]/e+1)/2,h.push(v.x,v.y)}for(let x=1;x<=t;x++)i.push(x,x+1,0);this.setIndex(i),this.setAttribute("position",new Ur(a,3)),this.setAttribute("normal",new Ur(c,3)),this.setAttribute("uv",new Ur(h,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new _I(e.radius,e.segments,e.thetaStart,e.thetaLength)}}let gc=class P9e extends _s{constructor(e=1,t=1,n=1,r=32,i=1,a=!1,c=0,h=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:i,openEnded:a,thetaStart:c,thetaLength:h};const p=this;r=Math.floor(r),i=Math.floor(i);const v=[],x=[],S=[],C=[];let I=0;const L=[],U=n/2;let R=0;$(),a===!1&&(e>0&&Z(!0),t>0&&Z(!1)),this.setIndex(v),this.setAttribute("position",new Ur(x,3)),this.setAttribute("normal",new Ur(S,3)),this.setAttribute("uv",new Ur(C,2));function $(){const k=new Ie,ie=new Ie;let ue=0;const ce=(t-e)/n;for(let Q=0;Q<=i;Q++){const ae=[],le=Q/i,J=le*(t-e)+e;for(let Ue=0;Ue<=r;Ue++){const je=Ue/r,rt=je*h+c,at=Math.sin(rt),Se=Math.cos(rt);ie.x=J*at,ie.y=-le*n+U,ie.z=J*Se,x.push(ie.x,ie.y,ie.z),k.set(at,ce,Se).normalize(),S.push(k.x,k.y,k.z),C.push(je,1-le),ae.push(I++)}L.push(ae)}for(let Q=0;Q<r;Q++)for(let ae=0;ae<i;ae++){const le=L[ae][Q],J=L[ae+1][Q],Ue=L[ae+1][Q+1],je=L[ae][Q+1];(e>0||ae!==0)&&(v.push(le,J,je),ue+=3),(t>0||ae!==i-1)&&(v.push(J,Ue,je),ue+=3)}p.addGroup(R,ue,0),R+=ue}function Z(k){const ie=I,ue=new mr,ce=new Ie;let Q=0;const ae=k===!0?e:t,le=k===!0?1:-1;for(let Ue=1;Ue<=r;Ue++)x.push(0,U*le,0),S.push(0,le,0),C.push(.5,.5),I++;const J=I;for(let Ue=0;Ue<=r;Ue++){const rt=Ue/r*h+c,at=Math.cos(rt),Se=Math.sin(rt);ce.x=ae*Se,ce.y=U*le,ce.z=ae*at,x.push(ce.x,ce.y,ce.z),S.push(0,le,0),ue.x=at*.5+.5,ue.y=Se*.5*le+.5,C.push(ue.x,ue.y),I++}for(let Ue=0;Ue<r;Ue++){const je=ie+Ue,rt=J+Ue;k===!0?v.push(rt,rt+1,je):v.push(rt+1,rt,je),Q+=3}p.addGroup(R,Q,k===!0?1:2),R+=Q}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new P9e(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}};class FH extends _s{constructor(e=[],t=[],n=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r};const i=[],a=[];c(r),p(n),v(),this.setAttribute("position",new Ur(i,3)),this.setAttribute("normal",new Ur(i.slice(),3)),this.setAttribute("uv",new Ur(a,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function c($){const Z=new Ie,k=new Ie,ie=new Ie;for(let ue=0;ue<t.length;ue+=3)C(t[ue+0],Z),C(t[ue+1],k),C(t[ue+2],ie),h(Z,k,ie,$)}function h($,Z,k,ie){const ue=ie+1,ce=[];for(let Q=0;Q<=ue;Q++){ce[Q]=[];const ae=$.clone().lerp(k,Q/ue),le=Z.clone().lerp(k,Q/ue),J=ue-Q;for(let Ue=0;Ue<=J;Ue++)Ue===0&&Q===ue?ce[Q][Ue]=ae:ce[Q][Ue]=ae.clone().lerp(le,Ue/J)}for(let Q=0;Q<ue;Q++)for(let ae=0;ae<2*(ue-Q)-1;ae++){const le=Math.floor(ae/2);ae%2===0?(S(ce[Q][le+1]),S(ce[Q+1][le]),S(ce[Q][le])):(S(ce[Q][le+1]),S(ce[Q+1][le+1]),S(ce[Q+1][le]))}}function p($){const Z=new Ie;for(let k=0;k<i.length;k+=3)Z.x=i[k+0],Z.y=i[k+1],Z.z=i[k+2],Z.normalize().multiplyScalar($),i[k+0]=Z.x,i[k+1]=Z.y,i[k+2]=Z.z}function v(){const $=new Ie;for(let Z=0;Z<i.length;Z+=3){$.x=i[Z+0],$.y=i[Z+1],$.z=i[Z+2];const k=U($)/2/Math.PI+.5,ie=R($)/Math.PI+.5;a.push(k,1-ie)}I(),x()}function x(){for(let $=0;$<a.length;$+=6){const Z=a[$+0],k=a[$+2],ie=a[$+4],ue=Math.max(Z,k,ie),ce=Math.min(Z,k,ie);ue>.9&&ce<.1&&(Z<.2&&(a[$+0]+=1),k<.2&&(a[$+2]+=1),ie<.2&&(a[$+4]+=1))}}function S($){i.push($.x,$.y,$.z)}function C($,Z){const k=$*3;Z.x=e[k+0],Z.y=e[k+1],Z.z=e[k+2]}function I(){const $=new Ie,Z=new Ie,k=new Ie,ie=new Ie,ue=new mr,ce=new mr,Q=new mr;for(let ae=0,le=0;ae<i.length;ae+=9,le+=6){$.set(i[ae+0],i[ae+1],i[ae+2]),Z.set(i[ae+3],i[ae+4],i[ae+5]),k.set(i[ae+6],i[ae+7],i[ae+8]),ue.set(a[le+0],a[le+1]),ce.set(a[le+2],a[le+3]),Q.set(a[le+4],a[le+5]),ie.copy($).add(Z).add(k).divideScalar(3);const J=U(ie);L(ue,le+0,$,J),L(ce,le+2,Z,J),L(Q,le+4,k,J)}}function L($,Z,k,ie){ie<0&&$.x===1&&(a[Z]=$.x-1),k.x===0&&k.z===0&&(a[Z]=ie/2/Math.PI+.5)}function U($){return Math.atan2($.z,-$.x)}function R($){return Math.atan2(-$.y,Math.sqrt($.x*$.x+$.z*$.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new FH(e.vertices,e.indices,e.radius,e.details)}}class R9e{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){console.warn("THREE.Curve: .getPoint() not implemented.")}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,r=this.getPoint(0),i=0;t.push(0);for(let a=1;a<=e;a++)n=this.getPoint(a/e),i+=n.distanceTo(r),t.push(i),r=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t=null){const n=this.getLengths();let r=0;const i=n.length;let a;t?a=t:a=e*n[i-1];let c=0,h=i-1,p;for(;c<=h;)if(r=Math.floor(c+(h-c)/2),p=n[r]-a,p<0)c=r+1;else if(p>0)h=r-1;else{h=r;break}if(r=h,n[r]===a)return r/(i-1);const v=n[r],S=n[r+1]-v,C=(a-v)/S;return(r+C)/(i-1)}getTangent(e,t){let r=e-1e-4,i=e+1e-4;r<0&&(r=0),i>1&&(i=1);const a=this.getPoint(r),c=this.getPoint(i),h=t||(a.isVector2?new mr:new Ie);return h.copy(c).sub(a).normalize(),h}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t=!1){const n=new Ie,r=[],i=[],a=[],c=new Ie,h=new vr;for(let C=0;C<=e;C++){const I=C/e;r[C]=this.getTangentAt(I,new Ie)}i[0]=new Ie,a[0]=new Ie;let p=Number.MAX_VALUE;const v=Math.abs(r[0].x),x=Math.abs(r[0].y),S=Math.abs(r[0].z);v<=p&&(p=v,n.set(1,0,0)),x<=p&&(p=x,n.set(0,1,0)),S<=p&&n.set(0,0,1),c.crossVectors(r[0],n).normalize(),i[0].crossVectors(r[0],c),a[0].crossVectors(r[0],i[0]);for(let C=1;C<=e;C++){if(i[C]=i[C-1].clone(),a[C]=a[C-1].clone(),c.crossVectors(r[C-1],r[C]),c.length()>Number.EPSILON){c.normalize();const I=Math.acos(oi(r[C-1].dot(r[C]),-1,1));i[C].applyMatrix4(h.makeRotationAxis(c,I))}a[C].crossVectors(r[C],i[C])}if(t===!0){let C=Math.acos(oi(i[0].dot(i[e]),-1,1));C/=e,r[0].dot(c.crossVectors(i[0],i[e]))>0&&(C=-C);for(let I=1;I<=e;I++)i[I].applyMatrix4(h.makeRotationAxis(r[I],C*I)),a[I].crossVectors(r[I],i[I])}return{tangents:r,normals:i,binormals:a}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.7,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}function LH(){let o=0,e=0,t=0,n=0;function r(i,a,c,h){o=i,e=c,t=-3*i+3*a-2*c-h,n=2*i-2*a+c+h}return{initCatmullRom:function(i,a,c,h,p){r(a,c,p*(c-i),p*(h-a))},initNonuniformCatmullRom:function(i,a,c,h,p,v,x){let S=(a-i)/p-(c-i)/(p+v)+(c-a)/v,C=(c-a)/v-(h-a)/(v+x)+(h-c)/x;S*=v,C*=v,r(a,c,S,C)},calc:function(i){const a=i*i,c=a*i;return o+e*i+t*a+n*c}}}const fR=new Ie,Oz=new LH,Fz=new LH,Lz=new LH;class d1e extends R9e{constructor(e=[],t=!1,n="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=r}getPoint(e,t=new Ie){const n=t,r=this.points,i=r.length,a=(i-(this.closed?0:1))*e;let c=Math.floor(a),h=a-c;this.closed?c+=c>0?0:(Math.floor(Math.abs(c)/i)+1)*i:h===0&&c===i-1&&(c=i-2,h=1);let p,v;this.closed||c>0?p=r[(c-1)%i]:(fR.subVectors(r[0],r[1]).add(r[0]),p=fR);const x=r[c%i],S=r[(c+1)%i];if(this.closed||c+2<i?v=r[(c+2)%i]:(fR.subVectors(r[i-1],r[i-2]).add(r[i-1]),v=fR),this.curveType==="centripetal"||this.curveType==="chordal"){const C=this.curveType==="chordal"?.5:.25;let I=Math.pow(p.distanceToSquared(x),C),L=Math.pow(x.distanceToSquared(S),C),U=Math.pow(S.distanceToSquared(v),C);L<1e-4&&(L=1),I<1e-4&&(I=L),U<1e-4&&(U=L),Oz.initNonuniformCatmullRom(p.x,x.x,S.x,v.x,I,L,U),Fz.initNonuniformCatmullRom(p.y,x.y,S.y,v.y,I,L,U),Lz.initNonuniformCatmullRom(p.z,x.z,S.z,v.z,I,L,U)}else this.curveType==="catmullrom"&&(Oz.initCatmullRom(p.x,x.x,S.x,v.x,this.tension),Fz.initCatmullRom(p.y,x.y,S.y,v.y,this.tension),Lz.initCatmullRom(p.z,x.z,S.z,v.z,this.tension));return n.set(Oz.calc(h),Fz.calc(h),Lz.calc(h)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(new Ie().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function fMe(o,e,t=2){const n=e&&e.length,r=n?e[0]*t:o.length;let i=k9e(o,0,r,t,!0);const a=[];if(!i||i.next===i.prev)return a;let c,h,p;if(n&&(i=vMe(o,e,i,t)),o.length>80*t){c=1/0,h=1/0;let v=-1/0,x=-1/0;for(let S=t;S<r;S+=t){const C=o[S],I=o[S+1];C<c&&(c=C),I<h&&(h=I),C>v&&(v=C),I>x&&(x=I)}p=Math.max(v-c,x-h),p=p!==0?32767/p:0}return vE(i,a,t,c,h,p,0),a}function k9e(o,e,t,n,r){let i;if(r===PMe(o,e,t,n)>0)for(let a=e;a<t;a+=n)i=f1e(a/n|0,o[a],o[a+1],i);else for(let a=t-n;a>=e;a-=n)i=f1e(a/n|0,o[a],o[a+1],i);return i&&F_(i,i.next)&&(xE(i),i=i.next),i}function x6(o,e){if(!o)return o;e||(e=o);let t=o,n;do if(n=!1,!t.steiner&&(F_(t,t.next)||xo(t.prev,t,t.next)===0)){if(xE(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function vE(o,e,t,n,r,i,a){if(!o)return;!a&&i&&wMe(o,n,r,i);let c=o;for(;o.prev!==o.next;){const h=o.prev,p=o.next;if(i?mMe(o,n,r,i):pMe(o)){e.push(h.i,o.i,p.i),xE(o),o=p.next,c=p.next;continue}if(o=p,o===c){a?a===1?(o=gMe(x6(o),e),vE(o,e,t,n,r,i,2)):a===2&&yMe(o,e,t,n,r,i):vE(x6(o),e,t,n,r,i,1);break}}}function pMe(o){const e=o.prev,t=o,n=o.next;if(xo(e,t,n)>=0)return!1;const r=e.x,i=t.x,a=n.x,c=e.y,h=t.y,p=n.y,v=Math.min(r,i,a),x=Math.min(c,h,p),S=Math.max(r,i,a),C=Math.max(c,h,p);let I=n.next;for(;I!==e;){if(I.x>=v&&I.x<=S&&I.y>=x&&I.y<=C&&Vw(r,c,i,h,a,p,I.x,I.y)&&xo(I.prev,I,I.next)>=0)return!1;I=I.next}return!0}function mMe(o,e,t,n){const r=o.prev,i=o,a=o.next;if(xo(r,i,a)>=0)return!1;const c=r.x,h=i.x,p=a.x,v=r.y,x=i.y,S=a.y,C=Math.min(c,h,p),I=Math.min(v,x,S),L=Math.max(c,h,p),U=Math.max(v,x,S),R=fj(C,I,e,t,n),$=fj(L,U,e,t,n);let Z=o.prevZ,k=o.nextZ;for(;Z&&Z.z>=R&&k&&k.z<=$;){if(Z.x>=C&&Z.x<=L&&Z.y>=I&&Z.y<=U&&Z!==r&&Z!==a&&Vw(c,v,h,x,p,S,Z.x,Z.y)&&xo(Z.prev,Z,Z.next)>=0||(Z=Z.prevZ,k.x>=C&&k.x<=L&&k.y>=I&&k.y<=U&&k!==r&&k!==a&&Vw(c,v,h,x,p,S,k.x,k.y)&&xo(k.prev,k,k.next)>=0))return!1;k=k.nextZ}for(;Z&&Z.z>=R;){if(Z.x>=C&&Z.x<=L&&Z.y>=I&&Z.y<=U&&Z!==r&&Z!==a&&Vw(c,v,h,x,p,S,Z.x,Z.y)&&xo(Z.prev,Z,Z.next)>=0)return!1;Z=Z.prevZ}for(;k&&k.z<=$;){if(k.x>=C&&k.x<=L&&k.y>=I&&k.y<=U&&k!==r&&k!==a&&Vw(c,v,h,x,p,S,k.x,k.y)&&xo(k.prev,k,k.next)>=0)return!1;k=k.nextZ}return!0}function gMe(o,e){let t=o;do{const n=t.prev,r=t.next.next;!F_(n,r)&&N9e(n,t,t.next,r)&&_E(n,r)&&_E(r,n)&&(e.push(n.i,t.i,r.i),xE(t),xE(t.next),t=o=r),t=t.next}while(t!==o);return x6(t)}function yMe(o,e,t,n,r,i){let a=o;do{let c=a.next.next;for(;c!==a.prev;){if(a.i!==c.i&&MMe(a,c)){let h=D9e(a,c);a=x6(a,a.next),h=x6(h,h.next),vE(a,e,t,n,r,i,0),vE(h,e,t,n,r,i,0);return}c=c.next}a=a.next}while(a!==o)}function vMe(o,e,t,n){const r=[];for(let i=0,a=e.length;i<a;i++){const c=e[i]*n,h=i<a-1?e[i+1]*n:o.length,p=k9e(o,c,h,n,!1);p===p.next&&(p.steiner=!0),r.push(TMe(p))}r.sort(_Me);for(let i=0;i<r.length;i++)t=xMe(r[i],t);return t}function _Me(o,e){let t=o.x-e.x;if(t===0&&(t=o.y-e.y,t===0)){const n=(o.next.y-o.y)/(o.next.x-o.x),r=(e.next.y-e.y)/(e.next.x-e.x);t=n-r}return t}function xMe(o,e){const t=bMe(o,e);if(!t)return e;const n=D9e(t,o);return x6(n,n.next),x6(t,t.next)}function bMe(o,e){let t=e;const n=o.x,r=o.y;let i=-1/0,a;if(F_(o,t))return t;do{if(F_(o,t.next))return t.next;if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){const x=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(x<=n&&x>i&&(i=x,a=t.x<t.next.x?t:t.next,x===n))return a}t=t.next}while(t!==e);if(!a)return null;const c=a,h=a.x,p=a.y;let v=1/0;t=a;do{if(n>=t.x&&t.x>=h&&n!==t.x&&I9e(r<p?n:i,r,h,p,r<p?i:n,r,t.x,t.y)){const x=Math.abs(r-t.y)/(n-t.x);_E(t,o)&&(x<v||x===v&&(t.x>a.x||t.x===a.x&&SMe(a,t)))&&(a=t,v=x)}t=t.next}while(t!==c);return a}function SMe(o,e){return xo(o.prev,o,e.prev)<0&&xo(e.next,o,o.next)<0}function wMe(o,e,t,n){let r=o;do r.z===0&&(r.z=fj(r.x,r.y,e,t,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==o);r.prevZ.nextZ=null,r.prevZ=null,EMe(r)}function EMe(o){let e,t=1;do{let n=o,r;o=null;let i=null;for(e=0;n;){e++;let a=n,c=0;for(let p=0;p<t&&(c++,a=a.nextZ,!!a);p++);let h=t;for(;c>0||h>0&&a;)c!==0&&(h===0||!a||n.z<=a.z)?(r=n,n=n.nextZ,c--):(r=a,a=a.nextZ,h--),i?i.nextZ=r:o=r,r.prevZ=i,i=r;n=a}i.nextZ=null,t*=2}while(e>1);return o}function fj(o,e,t,n,r){return o=(o-t)*r|0,e=(e-n)*r|0,o=(o|o<<8)&16711935,o=(o|o<<4)&252645135,o=(o|o<<2)&858993459,o=(o|o<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,o|e<<1}function TMe(o){let e=o,t=o;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==o);return t}function I9e(o,e,t,n,r,i,a,c){return(r-a)*(e-c)>=(o-a)*(i-c)&&(o-a)*(n-c)>=(t-a)*(e-c)&&(t-a)*(i-c)>=(r-a)*(n-c)}function Vw(o,e,t,n,r,i,a,c){return!(o===a&&e===c)&&I9e(o,e,t,n,r,i,a,c)}function MMe(o,e){return o.next.i!==e.i&&o.prev.i!==e.i&&!CMe(o,e)&&(_E(o,e)&&_E(e,o)&&AMe(o,e)&&(xo(o.prev,o,e.prev)||xo(o,e.prev,e))||F_(o,e)&&xo(o.prev,o,o.next)>0&&xo(e.prev,e,e.next)>0)}function xo(o,e,t){return(e.y-o.y)*(t.x-e.x)-(e.x-o.x)*(t.y-e.y)}function F_(o,e){return o.x===e.x&&o.y===e.y}function N9e(o,e,t,n){const r=mR(xo(o,e,t)),i=mR(xo(o,e,n)),a=mR(xo(t,n,o)),c=mR(xo(t,n,e));return!!(r!==i&&a!==c||r===0&&pR(o,t,e)||i===0&&pR(o,n,e)||a===0&&pR(t,o,n)||c===0&&pR(t,e,n))}function pR(o,e,t){return e.x<=Math.max(o.x,t.x)&&e.x>=Math.min(o.x,t.x)&&e.y<=Math.max(o.y,t.y)&&e.y>=Math.min(o.y,t.y)}function mR(o){return o>0?1:o<0?-1:0}function CMe(o,e){let t=o;do{if(t.i!==o.i&&t.next.i!==o.i&&t.i!==e.i&&t.next.i!==e.i&&N9e(t,t.next,o,e))return!0;t=t.next}while(t!==o);return!1}function _E(o,e){return xo(o.prev,o,o.next)<0?xo(o,e,o.next)>=0&&xo(o,o.prev,e)>=0:xo(o,e,o.prev)<0||xo(o,o.next,e)<0}function AMe(o,e){let t=o,n=!1;const r=(o.x+e.x)/2,i=(o.y+e.y)/2;do t.y>i!=t.next.y>i&&t.next.y!==t.y&&r<(t.next.x-t.x)*(i-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==o);return n}function D9e(o,e){const t=pj(o.i,o.x,o.y),n=pj(e.i,e.x,e.y),r=o.next,i=e.prev;return o.next=e,e.prev=o,t.next=r,r.prev=t,n.next=t,t.prev=n,i.next=n,n.prev=i,n}function f1e(o,e,t,n){const r=pj(o,e,t);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function xE(o){o.next.prev=o.prev,o.prev.next=o.next,o.prevZ&&(o.prevZ.nextZ=o.nextZ),o.nextZ&&(o.nextZ.prevZ=o.prevZ)}function pj(o,e,t){return{i:o,x:e,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function PMe(o,e,t,n){let r=0;for(let i=e,a=t-n;i<t;i+=n)r+=(o[a]-o[i])*(o[i+1]+o[a+1]),a=i;return r}class RMe{static triangulate(e,t,n=2){return fMe(e,t,n)}}class BH{static area(e){const t=e.length;let n=0;for(let r=t-1,i=0;i<t;r=i++)n+=e[r].x*e[i].y-e[i].x*e[r].y;return n*.5}static isClockWise(e){return BH.area(e)<0}static triangulateShape(e,t){const n=[],r=[],i=[];p1e(e),m1e(n,e);let a=e.length;t.forEach(p1e);for(let h=0;h<t.length;h++)r.push(a),a+=t[h].length,m1e(n,t[h]);const c=RMe.triangulate(n,r);for(let h=0;h<c.length;h+=3)i.push(c.slice(h,h+3));return i}}function p1e(o){const e=o.length;e>2&&o[e-1].equals(o[0])&&o.pop()}function m1e(o,e){for(let t=0;t<e.length;t++)o.push(e[t].x),o.push(e[t].y)}class d6 extends FH{constructor(e=1,t=0){const n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(n,r,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new d6(e.radius,e.detail)}}let b6=class O9e extends _s{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};const i=e/2,a=t/2,c=Math.floor(n),h=Math.floor(r),p=c+1,v=h+1,x=e/c,S=t/h,C=[],I=[],L=[],U=[];for(let R=0;R<v;R++){const $=R*S-a;for(let Z=0;Z<p;Z++){const k=Z*x-i;I.push(k,-$,0),L.push(0,0,1),U.push(Z/c),U.push(1-R/h)}}for(let R=0;R<h;R++)for(let $=0;$<c;$++){const Z=$+p*R,k=$+p*(R+1),ie=$+1+p*(R+1),ue=$+1+p*R;C.push(Z,k,ue),C.push(k,ie,ue)}this.setIndex(C),this.setAttribute("position",new Ur(I,3)),this.setAttribute("normal",new Ur(L,3)),this.setAttribute("uv",new Ur(U,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new O9e(e.width,e.height,e.widthSegments,e.heightSegments)}},S6=class F9e extends _s{constructor(e=1,t=32,n=16,r=0,i=Math.PI*2,a=0,c=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:i,thetaStart:a,thetaLength:c},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const h=Math.min(a+c,Math.PI);let p=0;const v=[],x=new Ie,S=new Ie,C=[],I=[],L=[],U=[];for(let R=0;R<=n;R++){const $=[],Z=R/n;let k=0;R===0&&a===0?k=.5/t:R===n&&h===Math.PI&&(k=-.5/t);for(let ie=0;ie<=t;ie++){const ue=ie/t;x.x=-e*Math.cos(r+ue*i)*Math.sin(a+Z*c),x.y=e*Math.cos(a+Z*c),x.z=e*Math.sin(r+ue*i)*Math.sin(a+Z*c),I.push(x.x,x.y,x.z),S.copy(x).normalize(),L.push(S.x,S.y,S.z),U.push(ue+k,1-Z),$.push(p++)}v.push($)}for(let R=0;R<n;R++)for(let $=0;$<t;$++){const Z=v[R][$+1],k=v[R][$],ie=v[R+1][$],ue=v[R+1][$+1];(R!==0||a>0)&&C.push(Z,k,ue),(R!==n-1||h<Math.PI)&&C.push(k,ie,ue)}this.setIndex(C),this.setAttribute("position",new Ur(I,3)),this.setAttribute("normal",new Ur(L,3)),this.setAttribute("uv",new Ur(U,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new F9e(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}};class i6 extends _s{constructor(e=1,t=.4,n=12,r=48,i=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:i},n=Math.floor(n),r=Math.floor(r);const a=[],c=[],h=[],p=[],v=new Ie,x=new Ie,S=new Ie;for(let C=0;C<=n;C++)for(let I=0;I<=r;I++){const L=I/r*i,U=C/n*Math.PI*2;x.x=(e+t*Math.cos(U))*Math.cos(L),x.y=(e+t*Math.cos(U))*Math.sin(L),x.z=t*Math.sin(U),c.push(x.x,x.y,x.z),v.x=e*Math.cos(L),v.y=e*Math.sin(L),S.subVectors(x,v).normalize(),h.push(S.x,S.y,S.z),p.push(I/r),p.push(C/n)}for(let C=1;C<=n;C++)for(let I=1;I<=r;I++){const L=(r+1)*C+I-1,U=(r+1)*(C-1)+I-1,R=(r+1)*(C-1)+I,$=(r+1)*C+I;a.push(L,U,$),a.push(U,R,$)}this.setIndex(a),this.setAttribute("position",new Ur(c,3)),this.setAttribute("normal",new Ur(h,3)),this.setAttribute("uv",new Ur(p,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new i6(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class UH extends _s{constructor(e=1,t=.4,n=64,r=8,i=2,a=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:i,q:a},n=Math.floor(n),r=Math.floor(r);const c=[],h=[],p=[],v=[],x=new Ie,S=new Ie,C=new Ie,I=new Ie,L=new Ie,U=new Ie,R=new Ie;for(let Z=0;Z<=n;++Z){const k=Z/n*i*Math.PI*2;$(k,i,a,e,C),$(k+.01,i,a,e,I),U.subVectors(I,C),R.addVectors(I,C),L.crossVectors(U,R),R.crossVectors(L,U),L.normalize(),R.normalize();for(let ie=0;ie<=r;++ie){const ue=ie/r*Math.PI*2,ce=-t*Math.cos(ue),Q=t*Math.sin(ue);x.x=C.x+(ce*R.x+Q*L.x),x.y=C.y+(ce*R.y+Q*L.y),x.z=C.z+(ce*R.z+Q*L.z),h.push(x.x,x.y,x.z),S.subVectors(x,C).normalize(),p.push(S.x,S.y,S.z),v.push(Z/n),v.push(ie/r)}}for(let Z=1;Z<=n;Z++)for(let k=1;k<=r;k++){const ie=(r+1)*(Z-1)+(k-1),ue=(r+1)*Z+(k-1),ce=(r+1)*Z+k,Q=(r+1)*(Z-1)+k;c.push(ie,ue,Q),c.push(ue,ce,Q)}this.setIndex(c),this.setAttribute("position",new Ur(h,3)),this.setAttribute("normal",new Ur(p,3)),this.setAttribute("uv",new Ur(v,2));function $(Z,k,ie,ue,ce){const Q=Math.cos(Z),ae=Math.sin(Z),le=ie/k*Z,J=Math.cos(le);ce.x=ue*(2+J)*.5*Q,ce.y=ue*(2+J)*ae*.5,ce.z=ue*Math.sin(le)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new UH(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}let kMe=class extends yf{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new Vn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Vn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=K_,this.normalScale=new mr(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new na,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}},Vk=class extends kMe{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new mr(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return oi(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Vn(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Vn(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Vn(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}},u_=class extends yf{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Vn(16777215),this.specular=new Vn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Vn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=K_,this.normalScale=new mr(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new na,this.combine=gI,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}},L9e=class extends yf{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=K_,this.normalScale=new mr(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}},IMe=class extends yf{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Vn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Vn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=K_,this.normalScale=new mr(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new na,this.combine=gI,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}};class B9e extends yf{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=oTe,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class NMe extends yf{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}let U9e=class extends yf{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Vn(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=K_,this.normalScale=new mr(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}};function gR(o,e){return!o||o.constructor===e?o:typeof e.BYTES_PER_ELEMENT=="number"?new e(o):Array.prototype.slice.call(o)}function DMe(o){return ArrayBuffer.isView(o)&&!(o instanceof DataView)}function OMe(o){function e(r,i){return o[r]-o[i]}const t=o.length,n=new Array(t);for(let r=0;r!==t;++r)n[r]=r;return n.sort(e),n}function g1e(o,e,t){const n=o.length,r=new o.constructor(n);for(let i=0,a=0;a!==n;++i){const c=t[i]*e;for(let h=0;h!==e;++h)r[a++]=o[c+h]}return r}function z9e(o,e,t,n){let r=1,i=o[0];for(;i!==void 0&&i[n]===void 0;)i=o[r++];if(i===void 0)return;let a=i[n];if(a!==void 0)if(Array.isArray(a))do a=i[n],a!==void 0&&(e.push(i.time),t.push(...a)),i=o[r++];while(i!==void 0);else if(a.toArray!==void 0)do a=i[n],a!==void 0&&(e.push(i.time),a.toArray(t,t.length)),i=o[r++];while(i!==void 0);else do a=i[n],a!==void 0&&(e.push(i.time),t.push(a)),i=o[r++];while(i!==void 0)}class xI{constructor(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,r=t[n],i=t[n-1];e:{t:{let a;n:{r:if(!(e<r)){for(let c=n+2;;){if(r===void 0){if(e<i)break r;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===c)break;if(i=r,r=t[++n],e<r)break t}a=t.length;break n}if(!(e>=i)){const c=t[1];e<c&&(n=2,i=c);for(let h=n-2;;){if(i===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===h)break;if(r=i,i=t[--n-1],e>=i)break t}a=n,n=0;break n}break e}for(;n<a;){const c=n+a>>>1;e<t[c]?a=c:n=c+1}if(r=t[n],i=t[n-1],i===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r;for(let a=0;a!==r;++a)t[a]=n[i+a];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class FMe extends xI{constructor(e,t,n,r){super(e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:l_,endingEnd:l_}}intervalChanged_(e,t,n){const r=this.parameterPositions;let i=e-2,a=e+1,c=r[i],h=r[a];if(c===void 0)switch(this.getSettings_().endingStart){case c_:i=e,c=2*t-n;break;case Fk:i=r.length-2,c=t+r[i]-r[i+1];break;default:i=e,c=n}if(h===void 0)switch(this.getSettings_().endingEnd){case c_:a=e,h=2*n-t;break;case Fk:a=1,h=n+r[1]-r[0];break;default:a=e-1,h=t}const p=(n-t)*.5,v=this.valueSize;this._weightPrev=p/(t-c),this._weightNext=p/(h-n),this._offsetPrev=i*v,this._offsetNext=a*v}interpolate_(e,t,n,r){const i=this.resultBuffer,a=this.sampleValues,c=this.valueSize,h=e*c,p=h-c,v=this._offsetPrev,x=this._offsetNext,S=this._weightPrev,C=this._weightNext,I=(n-t)/(r-t),L=I*I,U=L*I,R=-S*U+2*S*L-S*I,$=(1+S)*U+(-1.5-2*S)*L+(-.5+S)*I+1,Z=(-1-C)*U+(1.5+C)*L+.5*I,k=C*U-C*L;for(let ie=0;ie!==c;++ie)i[ie]=R*a[v+ie]+$*a[p+ie]+Z*a[h+ie]+k*a[x+ie];return i}}class V9e extends xI{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const i=this.resultBuffer,a=this.sampleValues,c=this.valueSize,h=e*c,p=h-c,v=(n-t)/(r-t),x=1-v;for(let S=0;S!==c;++S)i[S]=a[p+S]*x+a[h+S]*v;return i}}class LMe extends xI{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class _f{constructor(e,t,n,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=gR(t,this.TimeBufferType),this.values=gR(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:gR(e.times,Array),values:gR(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(n.interpolation=r)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new LMe(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new V9e(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new FMe(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Ok:t=this.InterpolantFactoryMethodDiscrete;break;case lj:t=this.InterpolantFactoryMethodLinear;break;case cz:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Ok;case this.InterpolantFactoryMethodLinear:return lj;case this.InterpolantFactoryMethodSmooth:return cz}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){const n=this.times,r=n.length;let i=0,a=r-1;for(;i!==r&&n[i]<e;)++i;for(;a!==-1&&n[a]>t;)--a;if(++a,i!==0||a!==r){i>=a&&(a=Math.max(a,1),i=a-1);const c=this.getValueSize();this.times=n.slice(i,a),this.values=this.values.slice(i*c,a*c)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,r=this.values,i=n.length;i===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let c=0;c!==i;c++){const h=n[c];if(typeof h=="number"&&isNaN(h)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,c,h),e=!1;break}if(a!==null&&a>h){console.error("THREE.KeyframeTrack: Out of order keys.",this,c,h,a),e=!1;break}a=h}if(r!==void 0&&DMe(r))for(let c=0,h=r.length;c!==h;++c){const p=r[c];if(isNaN(p)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,c,p),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),r=this.getInterpolation()===cz,i=e.length-1;let a=1;for(let c=1;c<i;++c){let h=!1;const p=e[c],v=e[c+1];if(p!==v&&(c!==1||p!==e[0]))if(r)h=!0;else{const x=c*n,S=x-n,C=x+n;for(let I=0;I!==n;++I){const L=t[x+I];if(L!==t[S+I]||L!==t[C+I]){h=!0;break}}}if(h){if(c!==a){e[a]=e[c];const x=c*n,S=a*n;for(let C=0;C!==n;++C)t[S+C]=t[x+C]}++a}}if(i>0){e[a]=e[i];for(let c=i*n,h=a*n,p=0;p!==n;++p)t[h+p]=t[c+p];++a}return a!==e.length?(this.times=e.slice(0,a),this.values=t.slice(0,a*n)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=this.constructor,r=new n(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}_f.prototype.ValueTypeName="";_f.prototype.TimeBufferType=Float32Array;_f.prototype.ValueBufferType=Float32Array;_f.prototype.DefaultInterpolation=lj;class Q_ extends _f{constructor(e,t,n){super(e,t,n)}}Q_.prototype.ValueTypeName="bool";Q_.prototype.ValueBufferType=Array;Q_.prototype.DefaultInterpolation=Ok;Q_.prototype.InterpolantFactoryMethodLinear=void 0;Q_.prototype.InterpolantFactoryMethodSmooth=void 0;class G9e extends _f{constructor(e,t,n,r){super(e,t,n,r)}}G9e.prototype.ValueTypeName="color";class bE extends _f{constructor(e,t,n,r){super(e,t,n,r)}}bE.prototype.ValueTypeName="number";class BMe extends xI{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const i=this.resultBuffer,a=this.sampleValues,c=this.valueSize,h=(n-t)/(r-t);let p=e*c;for(let v=p+c;p!==v;p+=4)os.slerpFlat(i,0,a,p-c,a,p,h);return i}}class L_ extends _f{constructor(e,t,n,r){super(e,t,n,r)}InterpolantFactoryMethodLinear(e){return new BMe(this.times,this.values,this.getValueSize(),e)}}L_.prototype.ValueTypeName="quaternion";L_.prototype.InterpolantFactoryMethodSmooth=void 0;class J_ extends _f{constructor(e,t,n){super(e,t,n)}}J_.prototype.ValueTypeName="string";J_.prototype.ValueBufferType=Array;J_.prototype.DefaultInterpolation=Ok;J_.prototype.InterpolantFactoryMethodLinear=void 0;J_.prototype.InterpolantFactoryMethodSmooth=void 0;class SE extends _f{constructor(e,t,n,r){super(e,t,n,r)}}SE.prototype.ValueTypeName="vector";class mj{constructor(e="",t=-1,n=[],r=TH){this.name=e,this.tracks=n,this.duration=t,this.blendMode=r,this.uuid=J3(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,r=1/(e.fps||1);for(let a=0,c=n.length;a!==c;++a)t.push(zMe(n[a]).scale(r));const i=new this(e.name,e.duration,t,e.blendMode);return i.uuid=e.uuid,i}static toJSON(e){const t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let i=0,a=n.length;i!==a;++i)t.push(_f.toJSON(n[i]));return r}static CreateFromMorphTargetSequence(e,t,n,r){const i=t.length,a=[];for(let c=0;c<i;c++){let h=[],p=[];h.push((c+i-1)%i,c,(c+1)%i),p.push(0,1,0);const v=OMe(h);h=g1e(h,1,v),p=g1e(p,1,v),!r&&h[0]===0&&(h.push(i),p.push(p[0])),a.push(new bE(".morphTargetInfluences["+t[c].name+"]",h,p).scale(1/n))}return new this(e,-1,a)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const r=e;n=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<n.length;r++)if(n[r].name===t)return n[r];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const r={},i=/^([\w-]*?)([\d]+)$/;for(let c=0,h=e.length;c<h;c++){const p=e[c],v=p.name.match(i);if(v&&v.length>1){const x=v[1];let S=r[x];S||(r[x]=S=[]),S.push(p)}}const a=[];for(const c in r)a.push(this.CreateFromMorphTargetSequence(c,r[c],t,n));return a}static parseAnimation(e,t){if(console.warn("THREE.AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(x,S,C,I,L){if(C.length!==0){const U=[],R=[];z9e(C,U,R,I),U.length!==0&&L.push(new x(S,U,R))}},r=[],i=e.name||"default",a=e.fps||30,c=e.blendMode;let h=e.length||-1;const p=e.hierarchy||[];for(let x=0;x<p.length;x++){const S=p[x].keys;if(!(!S||S.length===0))if(S[0].morphTargets){const C={};let I;for(I=0;I<S.length;I++)if(S[I].morphTargets)for(let L=0;L<S[I].morphTargets.length;L++)C[S[I].morphTargets[L]]=-1;for(const L in C){const U=[],R=[];for(let $=0;$!==S[I].morphTargets.length;++$){const Z=S[I];U.push(Z.time),R.push(Z.morphTarget===L?1:0)}r.push(new bE(".morphTargetInfluence["+L+"]",U,R))}h=C.length*a}else{const C=".bones["+t[x].name+"]";n(SE,C+".position",S,"pos",r),n(L_,C+".quaternion",S,"rot",r),n(SE,C+".scale",S,"scl",r)}}return r.length===0?null:new this(i,h,r,c)}resetDuration(){const e=this.tracks;let t=0;for(let n=0,r=e.length;n!==r;++n){const i=this.tracks[n];t=Math.max(t,i.times[i.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function UMe(o){switch(o.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return bE;case"vector":case"vector2":case"vector3":case"vector4":return SE;case"color":return G9e;case"quaternion":return L_;case"bool":case"boolean":return Q_;case"string":return J_}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+o)}function zMe(o){if(o.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=UMe(o.type);if(o.times===void 0){const t=[],n=[];z9e(o.keys,t,n,"value"),o.times=t,o.values=n}return e.parse!==void 0?e.parse(o):new e(o.name,o.times,o.values,o.interpolation)}const Gk={enabled:!1,files:{},add:function(o,e){this.enabled!==!1&&(this.files[o]=e)},get:function(o){if(this.enabled!==!1)return this.files[o]},remove:function(o){delete this.files[o]},clear:function(){this.files={}}};class VMe{constructor(e,t,n){const r=this;let i=!1,a=0,c=0,h;const p=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(v){c++,i===!1&&r.onStart!==void 0&&r.onStart(v,a,c),i=!0},this.itemEnd=function(v){a++,r.onProgress!==void 0&&r.onProgress(v,a,c),a===c&&(i=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(v){r.onError!==void 0&&r.onError(v)},this.resolveURL=function(v){return h?h(v):v},this.setURLModifier=function(v){return h=v,this},this.addHandler=function(v,x){return p.push(v,x),this},this.removeHandler=function(v){const x=p.indexOf(v);return x!==-1&&p.splice(x,2),this},this.getHandler=function(v){for(let x=0,S=p.length;x<S;x+=2){const C=p[x],I=p[x+1];if(C.global&&(C.lastIndex=0),C.test(v))return I}return null}}}const GMe=new VMe;class q3{constructor(e){this.manager=e!==void 0?e:GMe,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(r,i){n.load(e,r,t,i)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}q3.DEFAULT_MATERIAL_NAME="__DEFAULT";const og={};class jMe extends Error{constructor(e,t){super(e),this.response=t}}class HMe extends q3{constructor(e){super(e),this.mimeType="",this.responseType=""}load(e,t,n,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const i=Gk.get(e);if(i!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(i),this.manager.itemEnd(e)},0),i;if(og[e]!==void 0){og[e].push({onLoad:t,onProgress:n,onError:r});return}og[e]=[],og[e].push({onLoad:t,onProgress:n,onError:r});const a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),c=this.mimeType,h=this.responseType;fetch(a).then(p=>{if(p.status===200||p.status===0){if(p.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||p.body===void 0||p.body.getReader===void 0)return p;const v=og[e],x=p.body.getReader(),S=p.headers.get("X-File-Size")||p.headers.get("Content-Length"),C=S?parseInt(S):0,I=C!==0;let L=0;const U=new ReadableStream({start(R){$();function $(){x.read().then(({done:Z,value:k})=>{if(Z)R.close();else{L+=k.byteLength;const ie=new ProgressEvent("progress",{lengthComputable:I,loaded:L,total:C});for(let ue=0,ce=v.length;ue<ce;ue++){const Q=v[ue];Q.onProgress&&Q.onProgress(ie)}R.enqueue(k),$()}},Z=>{R.error(Z)})}}});return new Response(U)}else throw new jMe(`fetch for "${p.url}" responded with ${p.status}: ${p.statusText}`,p)}).then(p=>{switch(h){case"arraybuffer":return p.arrayBuffer();case"blob":return p.blob();case"document":return p.text().then(v=>new DOMParser().parseFromString(v,c));case"json":return p.json();default:if(c==="")return p.text();{const x=/charset="?([^;"\s]*)"?/i.exec(c),S=x&&x[1]?x[1].toLowerCase():void 0,C=new TextDecoder(S);return p.arrayBuffer().then(I=>C.decode(I))}}}).then(p=>{Gk.add(e,p);const v=og[e];delete og[e];for(let x=0,S=v.length;x<S;x++){const C=v[x];C.onLoad&&C.onLoad(p)}}).catch(p=>{const v=og[e];if(v===void 0)throw this.manager.itemError(e),p;delete og[e];for(let x=0,S=v.length;x<S;x++){const C=v[x];C.onError&&C.onError(p)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class j9e extends q3{constructor(e){super(e)}load(e,t,n,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const i=this,a=Gk.get(e);if(a!==void 0)return i.manager.itemStart(e),setTimeout(function(){t&&t(a),i.manager.itemEnd(e)},0),a;const c=yE("img");function h(){v(),Gk.add(e,this),t&&t(this),i.manager.itemEnd(e)}function p(x){v(),r&&r(x),i.manager.itemError(e),i.manager.itemEnd(e)}function v(){c.removeEventListener("load",h,!1),c.removeEventListener("error",p,!1)}return c.addEventListener("load",h,!1),c.addEventListener("error",p,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(c.crossOrigin=this.crossOrigin),i.manager.itemStart(e),c.src=e,c}}class WMe extends q3{constructor(e){super(e)}load(e,t,n,r){const i=new IH;i.colorSpace=ys;const a=new j9e(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);let c=0;function h(p){a.load(e[p],function(v){i.images[p]=v,c++,c===6&&(i.needsUpdate=!0,t&&t(i))},void 0,r)}for(let p=0;p<e.length;++p)h(p);return i}}class H9e extends q3{constructor(e){super(e)}load(e,t,n,r){const i=new H0,a=new j9e(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(c){i.image=c,i.needsUpdate=!0,t!==void 0&&t(i)},n,r),i}}let ex=class extends Ci{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Vn(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(t.object.target=this.target.uuid),t}},$Me=class extends ex{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Ci.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Vn(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}};const Bz=new vr,y1e=new Ie,v1e=new Ie;let zH=class{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new mr(512,512),this.mapType=n1,this.map=null,this.mapPass=null,this.matrix=new vr,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new OH,this._frameExtents=new mr(1,1),this._viewportCount=1,this._viewports=[new Pi(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;y1e.setFromMatrixPosition(e.matrixWorld),t.position.copy(y1e),v1e.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(v1e),t.updateMatrixWorld(),Bz.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Bz),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(Bz)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}},qMe=class extends zH{constructor(){super(new La(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1,this.aspect=1}updateMatrices(e){const t=this.camera,n=D_*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height*this.aspect,i=e.distance||t.far;(n!==t.fov||r!==t.aspect||i!==t.far)&&(t.fov=n,t.aspect=r,t.far=i,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}},VH=class extends ex{constructor(e,t,n=0,r=Math.PI/3,i=0,a=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Ci.DEFAULT_UP),this.updateMatrix(),this.target=new Ci,this.distance=n,this.angle=r,this.penumbra=i,this.decay=a,this.map=null,this.shadow=new qMe}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}};const _1e=new vr,hw=new Ie,Uz=new Ie;let XMe=class extends zH{constructor(){super(new La(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new mr(4,2),this._viewportCount=6,this._viewports=[new Pi(2,1,1,1),new Pi(0,1,1,1),new Pi(3,1,1,1),new Pi(1,1,1,1),new Pi(3,0,1,1),new Pi(1,0,1,1)],this._cubeDirections=[new Ie(1,0,0),new Ie(-1,0,0),new Ie(0,0,1),new Ie(0,0,-1),new Ie(0,1,0),new Ie(0,-1,0)],this._cubeUps=[new Ie(0,1,0),new Ie(0,1,0),new Ie(0,1,0),new Ie(0,1,0),new Ie(0,0,1),new Ie(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,r=this.matrix,i=e.distance||n.far;i!==n.far&&(n.far=i,n.updateProjectionMatrix()),hw.setFromMatrixPosition(e.matrixWorld),n.position.copy(hw),Uz.copy(n.position),Uz.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(Uz),n.updateMatrixWorld(),r.makeTranslation(-hw.x,-hw.y,-hw.z),_1e.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(_1e)}},x1e=class extends ex{constructor(e,t,n=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new XMe}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}},wE=class extends kH{constructor(e=-1,t=1,n=1,r=-1,i=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=i,this.far=a,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,i,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let i=n-e,a=n+e,c=r+t,h=r-t;if(this.view!==null&&this.view.enabled){const p=(this.right-this.left)/this.view.fullWidth/this.zoom,v=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i+=p*this.view.offsetX,a=i+p*this.view.width,c-=v*this.view.offsetY,h=c-v*this.view.height}this.projectionMatrix.makeOrthographic(i,a,c,h,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}},YMe=class extends zH{constructor(){super(new wE(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},GH=class extends ex{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Ci.DEFAULT_UP),this.updateMatrix(),this.target=new Ci,this.shadow=new YMe}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},KMe=class extends ex{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}},ZMe=class extends ex{constructor(e,t,n=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}};class QMe{static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}let JMe=class extends La{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}};class W9e{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=b1e(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=b1e();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function b1e(){return performance.now()}class eCe{constructor(e,t,n){this.binding=e,this.valueSize=n;let r,i,a;switch(t){case"quaternion":r=this._slerp,i=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":r=this._select,i=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:r=this._lerp,i=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=i,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,r=this.valueSize,i=e*r+r;let a=this.cumulativeWeight;if(a===0){for(let c=0;c!==r;++c)n[i+c]=n[c];a=t}else{a+=t;const c=t/a;this._mixBufferRegion(n,i,0,c,r)}this.cumulativeWeight=a}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,r=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,r=e*t+t,i=this.cumulativeWeight,a=this.cumulativeWeightAdditive,c=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,i<1){const h=t*this._origIndex;this._mixBufferRegion(n,r,h,1-i,t)}a>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*t,1,t);for(let h=t,p=t+t;h!==p;++h)if(n[h]!==n[h+t]){c.setValue(n,r);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(t,r);for(let i=n,a=r;i!==a;++i)t[i]=t[r+i%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,r,i){if(r>=.5)for(let a=0;a!==i;++a)e[t+a]=e[n+a]}_slerp(e,t,n,r){os.slerpFlat(e,t,e,t,e,n,r)}_slerpAdditive(e,t,n,r,i){const a=this._workIndex*i;os.multiplyQuaternionsFlat(e,a,e,t,e,n),os.slerpFlat(e,t,e,t,e,a,r)}_lerp(e,t,n,r,i){const a=1-r;for(let c=0;c!==i;++c){const h=t+c;e[h]=e[h]*a+e[n+c]*r}}_lerpAdditive(e,t,n,r,i){for(let a=0;a!==i;++a){const c=t+a;e[c]=e[c]+e[n+a]*r}}}const jH="\\[\\]\\.:\\/",tCe=new RegExp("["+jH+"]","g"),HH="[^"+jH+"]",nCe="[^"+jH.replace("\\.","")+"]",rCe=/((?:WC+[\/:])*)/.source.replace("WC",HH),iCe=/(WCOD+)?/.source.replace("WCOD",nCe),sCe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",HH),oCe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",HH),aCe=new RegExp("^"+rCe+iCe+sCe+oCe+"$"),lCe=["material","materials","bones","map"];class cCe{constructor(e,t,n){const r=n||zi.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,r=this._bindings[n];r!==void 0&&r.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}class zi{constructor(e,t,n){this.path=t,this.parsedPath=n||zi.parseTrackName(t),this.node=zi.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new zi.Composite(e,t,n):new zi(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(tCe,"")}static parseTrackName(e){const t=aCe.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const i=n.nodeName.substring(r+1);lCe.indexOf(i)!==-1&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=i)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(n!==void 0)return n}if(e.children){const n=function(i){for(let a=0;a<i.length;a++){const c=i[a];if(c.name===t||c.uuid===t)return c;const h=n(c.children);if(h)return h}return null},r=n(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)e[t++]=n[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,r=t.propertyName;let i=t.propertyIndex;if(e||(e=zi.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(n){let p=t.objectIndex;switch(n){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let v=0;v<e.length;v++)if(e[v].name===p){p=v;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[n]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[n]}if(p!==void 0){if(e[p]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[p]}}const a=e[r];if(a===void 0){const p=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+p+"."+r+" but it wasn't found.",e);return}let c=this.Versioning.None;this.targetObject=e,e.isMaterial===!0?c=this.Versioning.NeedsUpdate:e.isObject3D===!0&&(c=this.Versioning.MatrixWorldNeedsUpdate);let h=this.BindingType.Direct;if(i!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[i]!==void 0&&(i=e.morphTargetDictionary[i])}h=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=i}else a.fromArray!==void 0&&a.toArray!==void 0?(h=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(h=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=r;this.getValue=this.GetterByBindingType[h],this.setValue=this.SetterByBindingTypeAndVersioning[h][c]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}zi.Composite=cCe;zi.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};zi.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};zi.prototype.GetterByBindingType=[zi.prototype._getValue_direct,zi.prototype._getValue_array,zi.prototype._getValue_arrayElement,zi.prototype._getValue_toArray];zi.prototype.SetterByBindingTypeAndVersioning=[[zi.prototype._setValue_direct,zi.prototype._setValue_direct_setNeedsUpdate,zi.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[zi.prototype._setValue_array,zi.prototype._setValue_array_setNeedsUpdate,zi.prototype._setValue_array_setMatrixWorldNeedsUpdate],[zi.prototype._setValue_arrayElement,zi.prototype._setValue_arrayElement_setNeedsUpdate,zi.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[zi.prototype._setValue_fromArray,zi.prototype._setValue_fromArray_setNeedsUpdate,zi.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class uCe{constructor(e,t,n=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=r;const i=t.tracks,a=i.length,c=new Array(a),h={endingStart:l_,endingEnd:l_};for(let p=0;p!==a;++p){const v=i[p].createInterpolant(null);c[p]=v,v.settings=h}this._interpolantSettings=h,this._interpolants=c,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=rTe,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n=!1){if(e.fadeOut(t),this.fadeIn(t),n===!0){const r=this._clip.duration,i=e._clip.duration,a=i/r,c=r/i;e.warp(1,a,t),this.warp(c,1,t)}return this}crossFadeTo(e,t,n=!1){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const r=this._mixer,i=r.time,a=this.timeScale;let c=this._timeScaleInterpolant;c===null&&(c=r._lendControlInterpolant(),this._timeScaleInterpolant=c);const h=c.parameterPositions,p=c.sampleValues;return h[0]=i,h[1]=i+n,p[0]=e/a,p[1]=t/a,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,r){if(!this.enabled){this._updateWeight(e);return}const i=this._startTime;if(i!==null){const h=(e-i)*n;h<0||n===0?t=0:(this._startTime=null,t=n*h)}t*=this._updateTimeScale(e);const a=this._updateTime(t),c=this._updateWeight(e);if(c>0){const h=this._interpolants,p=this._propertyBindings;switch(this.blendMode){case sTe:for(let v=0,x=h.length;v!==x;++v)h[v].evaluate(a),p[v].accumulateAdditive(c);break;case TH:default:for(let v=0,x=h.length;v!==x;++v)h[v].evaluate(a),p[v].accumulate(r,c)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(n!==null){const r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;if(n!==null){const r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let r=this.time+e,i=this._loopCount;const a=n===iTe;if(e===0)return i===-1?r:a&&(i&1)===1?t-r:r;if(n===nTe){i===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(i===-1&&(e>=0?(i=0,this._setEndings(!0,this.repetitions===0,a)):this._setEndings(this.repetitions===0,!0,a)),r>=t||r<0){const c=Math.floor(r/t);r-=t*c,i+=Math.abs(c);const h=this.repetitions-i;if(h<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(h===1){const p=e<0;this._setEndings(p,!p,a)}else this._setEndings(!1,!1,a);this._loopCount=i,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:c})}}else this.time=r;if(a&&(i&1)===1)return t-r}return r}_setEndings(e,t,n){const r=this._interpolantSettings;n?(r.endingStart=c_,r.endingEnd=c_):(e?r.endingStart=this.zeroSlopeAtStart?c_:l_:r.endingStart=Fk,t?r.endingEnd=this.zeroSlopeAtEnd?c_:l_:r.endingEnd=Fk)}_scheduleFading(e,t,n){const r=this._mixer,i=r.time;let a=this._weightInterpolant;a===null&&(a=r._lendControlInterpolant(),this._weightInterpolant=a);const c=a.parameterPositions,h=a.sampleValues;return c[0]=i,h[0]=t,c[1]=i+e,h[1]=n,this}}const hCe=new Float32Array(1);class dCe extends gf{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,r=e._clip.tracks,i=r.length,a=e._propertyBindings,c=e._interpolants,h=n.uuid,p=this._bindingsByRootAndName;let v=p[h];v===void 0&&(v={},p[h]=v);for(let x=0;x!==i;++x){const S=r[x],C=S.name;let I=v[C];if(I!==void 0)++I.referenceCount,a[x]=I;else{if(I=a[x],I!==void 0){I._cacheIndex===null&&(++I.referenceCount,this._addInactiveBinding(I,h,C));continue}const L=t&&t._propertyBindings[x].binding.parsedPath;I=new eCe(zi.create(n,C,L),S.ValueTypeName,S.getValueSize()),++I.referenceCount,this._addInactiveBinding(I,h,C),a[x]=I}c[x].resultBuffer=I.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const n=(e._localRoot||this._root).uuid,r=e._clip.uuid,i=this._actionsByClip[r];this._bindAction(e,i&&i.knownActions[0]),this._addInactiveAction(e,r,n)}const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const i=t[n];i.useCount++===0&&(this._lendBinding(i),i.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const i=t[n];--i.useCount===0&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,n){const r=this._actions,i=this._actionsByClip;let a=i[t];if(a===void 0)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=a;else{const c=a.knownActions;e._byClipCacheIndex=c.length,c.push(e)}e._cacheIndex=r.length,r.push(e),a.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;const i=e._clip.uuid,a=this._actionsByClip,c=a[i],h=c.knownActions,p=h[h.length-1],v=e._byClipCacheIndex;p._byClipCacheIndex=v,h[v]=p,h.pop(),e._byClipCacheIndex=null;const x=c.actionByRoot,S=(e._localRoot||this._root).uuid;delete x[S],h.length===0&&delete a[i],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const i=t[n];--i.referenceCount===0&&this._removeInactiveBinding(i)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_addInactiveBinding(e,t,n){const r=this._bindingsByRootAndName,i=this._bindings;let a=r[t];a===void 0&&(a={},r[t]=a),a[n]=e,e._cacheIndex=i.length,i.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,r=n.rootNode.uuid,i=n.path,a=this._bindingsByRootAndName,c=a[r],h=t[t.length-1],p=e._cacheIndex;h._cacheIndex=p,t[p]=h,t.pop(),delete c[i],Object.keys(c).length===0&&delete a[r]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return n===void 0&&(n=new V9e(new Float32Array(2),new Float32Array(2),1,hCe),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,i=t[r];e.__cacheIndex=r,t[r]=e,i.__cacheIndex=n,t[n]=i}clipAction(e,t,n){const r=t||this._root,i=r.uuid;let a=typeof e=="string"?mj.findByName(r,e):e;const c=a!==null?a.uuid:e,h=this._actionsByClip[c];let p=null;if(n===void 0&&(a!==null?n=a.blendMode:n=TH),h!==void 0){const x=h.actionByRoot[i];if(x!==void 0&&x.blendMode===n)return x;p=h.knownActions[0],a===null&&(a=p._clip)}if(a===null)return null;const v=new uCe(this,a,t,n);return this._bindAction(v,p),this._addInactiveAction(v,c,i),v}existingAction(e,t){const n=t||this._root,r=n.uuid,i=typeof e=="string"?mj.findByName(n,e):e,a=i?i.uuid:e,c=this._actionsByClip[a];return c!==void 0&&c.actionByRoot[r]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let n=t-1;n>=0;--n)e[n].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,r=this.time+=e,i=Math.sign(e),a=this._accuIndex^=1;for(let p=0;p!==n;++p)t[p]._update(r,e,i,a);const c=this._bindings,h=this._nActiveBindings;for(let p=0;p!==h;++p)c[p].apply(a);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,r=this._actionsByClip,i=r[n];if(i!==void 0){const a=i.knownActions;for(let c=0,h=a.length;c!==h;++c){const p=a[c];this._deactivateAction(p);const v=p._cacheIndex,x=t[t.length-1];p._cacheIndex=null,p._byClipCacheIndex=null,x._cacheIndex=v,t[v]=x,t.pop(),this._removeInactiveBindingsForAction(p)}delete r[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const a in n){const c=n[a].actionByRoot,h=c[t];h!==void 0&&(this._deactivateAction(h),this._removeInactiveAction(h))}const r=this._bindingsByRootAndName,i=r[t];if(i!==void 0)for(const a in i){const c=i[a];c.restoreOriginalState(),this._removeInactiveBinding(c)}}uncacheAction(e,t){const n=this.existingAction(e,t);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}const S1e=new vr;class jk{constructor(e,t,n=0,r=1/0){this.ray=new Z_(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new PH,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return S1e.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(S1e),this}intersectObject(e,t=!0,n=[]){return gj(e,this,n,t),n.sort(w1e),n}intersectObjects(e,t=!0,n=[]){for(let r=0,i=e.length;r<i;r++)gj(e[r],this,n,t);return n.sort(w1e),n}}function w1e(o,e){return o.distance-e.distance}function gj(o,e,t,n){let r=!0;if(o.layers.test(e.layers)&&o.raycast(e,t)===!1&&(r=!1),r===!0&&n===!0){const i=o.children;for(let a=0,c=i.length;a<c;a++)gj(i[a],e,t,!0)}}class yj{constructor(e=1,t=0,n=0){this.radius=e,this.phi=t,this.theta=n}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=oi(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(oi(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}const E1e=new Ie;class fCe extends Ci{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const n=new _s,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let a=0,c=1,h=32;a<h;a++,c++){const p=a/h*Math.PI*2,v=c/h*Math.PI*2;r.push(Math.cos(p),Math.sin(p),1,Math.cos(v),Math.sin(v),1)}n.setAttribute("position",new Ur(r,3));const i=new vf({fog:!1,toneMapped:!1});this.cone=new NE(n,i),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),E1e.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(E1e),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const T3=new Ie,yR=new vr,zz=new vr;class pCe extends NE{constructor(e){const t=$9e(e),n=new _s,r=[],i=[],a=new Vn(0,0,1),c=new Vn(0,1,0);for(let p=0;p<t.length;p++){const v=t[p];v.parent&&v.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(a.r,a.g,a.b),i.push(c.r,c.g,c.b))}n.setAttribute("position",new Ur(r,3)),n.setAttribute("color",new Ur(i,3));const h=new vf({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,h),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,n=this.geometry,r=n.getAttribute("position");zz.copy(this.root.matrixWorld).invert();for(let i=0,a=0;i<t.length;i++){const c=t[i];c.parent&&c.parent.isBone&&(yR.multiplyMatrices(zz,c.matrixWorld),T3.setFromMatrixPosition(yR),r.setXYZ(a,T3.x,T3.y,T3.z),yR.multiplyMatrices(zz,c.parent.matrixWorld),T3.setFromMatrixPosition(yR),r.setXYZ(a+1,T3.x,T3.y,T3.z),a+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function $9e(o){const e=[];o.isBone===!0&&e.push(o);for(let t=0;t<o.children.length;t++)e.push(...$9e(o.children[t]));return e}class mCe extends Mn{constructor(e,t,n){const r=new S6(t,4,2),i=new wu({wireframe:!0,fog:!1,toneMapped:!1});super(r,i),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const gCe=new Ie,T1e=new Vn,M1e=new Vn;class yCe extends Ci{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const r=new d6(t);r.rotateY(Math.PI*.5),this.material=new wu({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const i=r.getAttribute("position"),a=new Float32Array(i.count*3);r.setAttribute("color",new hf(a,3)),this.add(new Mn(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");T1e.copy(this.light.color),M1e.copy(this.light.groundColor);for(let n=0,r=t.count;n<r;n++){const i=n<r/2?T1e:M1e;t.setXYZ(n,i.r,i.g,i.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(gCe.setFromMatrixPosition(this.light.matrixWorld).negate())}}const C1e=new Ie,vR=new Ie,A1e=new Ie;class vCe extends Ci{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",t===void 0&&(t=1);let r=new _s;r.setAttribute("position",new Ur([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const i=new vf({fog:!1,toneMapped:!1});this.lightPlane=new _c(r,i),this.add(this.lightPlane),r=new _s,r.setAttribute("position",new Ur([0,0,0,0,0,1],3)),this.targetLine=new _c(r,i),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),C1e.setFromMatrixPosition(this.light.matrixWorld),vR.setFromMatrixPosition(this.light.target.matrixWorld),A1e.subVectors(vR,C1e),this.lightPlane.lookAt(vR),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(vR),this.targetLine.scale.z=A1e.length()}}const _R=new Ie,Po=new kH;class _Ce extends NE{constructor(e){const t=new _s,n=new vf({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],i=[],a={};c("n1","n2"),c("n2","n4"),c("n4","n3"),c("n3","n1"),c("f1","f2"),c("f2","f4"),c("f4","f3"),c("f3","f1"),c("n1","f1"),c("n2","f2"),c("n3","f3"),c("n4","f4"),c("p","n1"),c("p","n2"),c("p","n3"),c("p","n4"),c("u1","u2"),c("u2","u3"),c("u3","u1"),c("c","t"),c("p","c"),c("cn1","cn2"),c("cn3","cn4"),c("cf1","cf2"),c("cf3","cf4");function c(I,L){h(I),h(L)}function h(I){r.push(0,0,0),i.push(0,0,0),a[I]===void 0&&(a[I]=[]),a[I].push(r.length/3-1)}t.setAttribute("position",new Ur(r,3)),t.setAttribute("color",new Ur(i,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update();const p=new Vn(16755200),v=new Vn(16711680),x=new Vn(43775),S=new Vn(16777215),C=new Vn(3355443);this.setColors(p,v,x,S,C)}setColors(e,t,n,r,i){const c=this.geometry.getAttribute("color");c.setXYZ(0,e.r,e.g,e.b),c.setXYZ(1,e.r,e.g,e.b),c.setXYZ(2,e.r,e.g,e.b),c.setXYZ(3,e.r,e.g,e.b),c.setXYZ(4,e.r,e.g,e.b),c.setXYZ(5,e.r,e.g,e.b),c.setXYZ(6,e.r,e.g,e.b),c.setXYZ(7,e.r,e.g,e.b),c.setXYZ(8,e.r,e.g,e.b),c.setXYZ(9,e.r,e.g,e.b),c.setXYZ(10,e.r,e.g,e.b),c.setXYZ(11,e.r,e.g,e.b),c.setXYZ(12,e.r,e.g,e.b),c.setXYZ(13,e.r,e.g,e.b),c.setXYZ(14,e.r,e.g,e.b),c.setXYZ(15,e.r,e.g,e.b),c.setXYZ(16,e.r,e.g,e.b),c.setXYZ(17,e.r,e.g,e.b),c.setXYZ(18,e.r,e.g,e.b),c.setXYZ(19,e.r,e.g,e.b),c.setXYZ(20,e.r,e.g,e.b),c.setXYZ(21,e.r,e.g,e.b),c.setXYZ(22,e.r,e.g,e.b),c.setXYZ(23,e.r,e.g,e.b),c.setXYZ(24,t.r,t.g,t.b),c.setXYZ(25,t.r,t.g,t.b),c.setXYZ(26,t.r,t.g,t.b),c.setXYZ(27,t.r,t.g,t.b),c.setXYZ(28,t.r,t.g,t.b),c.setXYZ(29,t.r,t.g,t.b),c.setXYZ(30,t.r,t.g,t.b),c.setXYZ(31,t.r,t.g,t.b),c.setXYZ(32,n.r,n.g,n.b),c.setXYZ(33,n.r,n.g,n.b),c.setXYZ(34,n.r,n.g,n.b),c.setXYZ(35,n.r,n.g,n.b),c.setXYZ(36,n.r,n.g,n.b),c.setXYZ(37,n.r,n.g,n.b),c.setXYZ(38,r.r,r.g,r.b),c.setXYZ(39,r.r,r.g,r.b),c.setXYZ(40,i.r,i.g,i.b),c.setXYZ(41,i.r,i.g,i.b),c.setXYZ(42,i.r,i.g,i.b),c.setXYZ(43,i.r,i.g,i.b),c.setXYZ(44,i.r,i.g,i.b),c.setXYZ(45,i.r,i.g,i.b),c.setXYZ(46,i.r,i.g,i.b),c.setXYZ(47,i.r,i.g,i.b),c.setXYZ(48,i.r,i.g,i.b),c.setXYZ(49,i.r,i.g,i.b),c.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap,n=1,r=1;Po.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse);const i=this.camera.coordinateSystem===Qp?-1:0;Vo("c",t,e,Po,0,0,i),Vo("t",t,e,Po,0,0,1),Vo("n1",t,e,Po,-1,-1,i),Vo("n2",t,e,Po,n,-1,i),Vo("n3",t,e,Po,-1,r,i),Vo("n4",t,e,Po,n,r,i),Vo("f1",t,e,Po,-1,-1,1),Vo("f2",t,e,Po,n,-1,1),Vo("f3",t,e,Po,-1,r,1),Vo("f4",t,e,Po,n,r,1),Vo("u1",t,e,Po,n*.7,r*1.1,i),Vo("u2",t,e,Po,-1*.7,r*1.1,i),Vo("u3",t,e,Po,0,r*2,i),Vo("cf1",t,e,Po,-1,0,1),Vo("cf2",t,e,Po,n,0,1),Vo("cf3",t,e,Po,0,-1,1),Vo("cf4",t,e,Po,0,r,1),Vo("cn1",t,e,Po,-1,0,i),Vo("cn2",t,e,Po,n,0,i),Vo("cn3",t,e,Po,0,-1,i),Vo("cn4",t,e,Po,0,r,i),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Vo(o,e,t,n,r,i,a){_R.set(r,i,a).unproject(n);const c=e[o];if(c!==void 0){const h=t.getAttribute("position");for(let p=0,v=c.length;p<v;p++)h.setXYZ(c[p],_R.x,_R.y,_R.z)}}class xCe extends NE{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new _s;r.setAttribute("position",new Ur(t,3)),r.setAttribute("color",new Ur(n,3));const i=new vf({vertexColors:!0,toneMapped:!1});super(r,i),this.type="AxesHelper"}setColors(e,t,n){const r=new Vn,i=this.geometry.attributes.color.array;return r.set(e),r.toArray(i,0),r.toArray(i,3),r.set(t),r.toArray(i,6),r.toArray(i,9),r.set(n),r.toArray(i,12),r.toArray(i,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class q9e extends gf{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){if(e===void 0){console.warn("THREE.Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}}function P1e(o,e,t,n){const r=bCe(n);switch(t){case c9e:return o*e;case h9e:return o*e/r.components*r.byteLength;case SH:return o*e/r.components*r.byteLength;case d9e:return o*e*2/r.components*r.byteLength;case wH:return o*e*2/r.components*r.byteLength;case u9e:return o*e*3/r.components*r.byteLength;case V0:return o*e*4/r.components*r.byteLength;case EH:return o*e*4/r.components*r.byteLength;case pk:case mk:return Math.floor((o+3)/4)*Math.floor((e+3)/4)*8;case gk:case yk:return Math.floor((o+3)/4)*Math.floor((e+3)/4)*16;case LG:case UG:return Math.max(o,16)*Math.max(e,8)/4;case FG:case BG:return Math.max(o,8)*Math.max(e,8)/2;case zG:case VG:return Math.floor((o+3)/4)*Math.floor((e+3)/4)*8;case GG:return Math.floor((o+3)/4)*Math.floor((e+3)/4)*16;case jG:return Math.floor((o+3)/4)*Math.floor((e+3)/4)*16;case HG:return Math.floor((o+4)/5)*Math.floor((e+3)/4)*16;case WG:return Math.floor((o+4)/5)*Math.floor((e+4)/5)*16;case $G:return Math.floor((o+5)/6)*Math.floor((e+4)/5)*16;case qG:return Math.floor((o+5)/6)*Math.floor((e+5)/6)*16;case XG:return Math.floor((o+7)/8)*Math.floor((e+4)/5)*16;case YG:return Math.floor((o+7)/8)*Math.floor((e+5)/6)*16;case KG:return Math.floor((o+7)/8)*Math.floor((e+7)/8)*16;case ZG:return Math.floor((o+9)/10)*Math.floor((e+4)/5)*16;case QG:return Math.floor((o+9)/10)*Math.floor((e+5)/6)*16;case JG:return Math.floor((o+9)/10)*Math.floor((e+7)/8)*16;case ej:return Math.floor((o+9)/10)*Math.floor((e+9)/10)*16;case tj:return Math.floor((o+11)/12)*Math.floor((e+9)/10)*16;case nj:return Math.floor((o+11)/12)*Math.floor((e+11)/12)*16;case vk:case rj:case ij:return Math.ceil(o/4)*Math.ceil(e/4)*16;case f9e:case sj:return Math.ceil(o/4)*Math.ceil(e/4)*8;case oj:case aj:return Math.ceil(o/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function bCe(o){switch(o){case n1:case o9e:return{byteLength:1,components:1};case fE:case a9e:case v6:return{byteLength:2,components:1};case xH:case bH:return{byteLength:2,components:4};case y6:case _H:case Th:return{byteLength:4,components:1};case l9e:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${o}.`)}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:oH}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=oH);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */function X9e(){let o=null,e=!1,t=null,n=null;function r(i,a){t(i,a),n=o.requestAnimationFrame(r)}return{start:function(){e!==!0&&t!==null&&(n=o.requestAnimationFrame(r),e=!0)},stop:function(){o.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(i){t=i},setContext:function(i){o=i}}}function SCe(o){const e=new WeakMap;function t(c,h){const p=c.array,v=c.usage,x=p.byteLength,S=o.createBuffer();o.bindBuffer(h,S),o.bufferData(h,p,v),c.onUploadCallback();let C;if(p instanceof Float32Array)C=o.FLOAT;else if(p instanceof Uint16Array)c.isFloat16BufferAttribute?C=o.HALF_FLOAT:C=o.UNSIGNED_SHORT;else if(p instanceof Int16Array)C=o.SHORT;else if(p instanceof Uint32Array)C=o.UNSIGNED_INT;else if(p instanceof Int32Array)C=o.INT;else if(p instanceof Int8Array)C=o.BYTE;else if(p instanceof Uint8Array)C=o.UNSIGNED_BYTE;else if(p instanceof Uint8ClampedArray)C=o.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+p);return{buffer:S,type:C,bytesPerElement:p.BYTES_PER_ELEMENT,version:c.version,size:x}}function n(c,h,p){const v=h.array,x=h.updateRanges;if(o.bindBuffer(p,c),x.length===0)o.bufferSubData(p,0,v);else{x.sort((C,I)=>C.start-I.start);let S=0;for(let C=1;C<x.length;C++){const I=x[S],L=x[C];L.start<=I.start+I.count+1?I.count=Math.max(I.count,L.start+L.count-I.start):(++S,x[S]=L)}x.length=S+1;for(let C=0,I=x.length;C<I;C++){const L=x[C];o.bufferSubData(p,L.start*v.BYTES_PER_ELEMENT,v,L.start,L.count)}h.clearUpdateRanges()}h.onUploadCallback()}function r(c){return c.isInterleavedBufferAttribute&&(c=c.data),e.get(c)}function i(c){c.isInterleavedBufferAttribute&&(c=c.data);const h=e.get(c);h&&(o.deleteBuffer(h.buffer),e.delete(c))}function a(c,h){if(c.isInterleavedBufferAttribute&&(c=c.data),c.isGLBufferAttribute){const v=e.get(c);(!v||v.version<c.version)&&e.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}const p=e.get(c);if(p===void 0)e.set(c,t(c,h));else if(p.version<c.version){if(p.size!==c.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");n(p.buffer,c,h),p.version=c.version}}return{get:r,remove:i,update:a}}var wCe=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,ECe=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,TCe=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,MCe=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,CCe=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,ACe=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,PCe=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,RCe=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,kCe=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,ICe=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,NCe=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,DCe=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,OCe=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,FCe=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,LCe=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,BCe=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,UCe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,zCe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,VCe=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,GCe=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,jCe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,HCe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,WCe=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,$Ce=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,qCe=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,XCe=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,YCe=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,KCe=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,ZCe=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,QCe=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,JCe="gl_FragColor = linearToOutputTexel( gl_FragColor );",eAe=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,tAe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,nAe=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,rAe=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,iAe=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,sAe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,oAe=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,aAe=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,lAe=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,cAe=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,uAe=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,hAe=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,dAe=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,fAe=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,pAe=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,mAe=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,gAe=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,yAe=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,vAe=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,_Ae=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,xAe=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,bAe=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,SAe=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,wAe=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,EAe=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,TAe=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,MAe=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,CAe=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,AAe=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,PAe=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,RAe=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,kAe=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,IAe=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,NAe=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,DAe=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,OAe=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,FAe=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,LAe=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,BAe=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,UAe=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,zAe=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,VAe=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,GAe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,jAe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,HAe=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,WAe=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,$Ae=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,qAe=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,XAe=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,YAe=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,KAe=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,ZAe=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,QAe=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,JAe=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,ePe=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,tPe=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,nPe=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,rPe=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,iPe=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,sPe=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,oPe=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,aPe=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,lPe=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,cPe=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,uPe=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,hPe=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,dPe=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,fPe=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,pPe=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,mPe=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,gPe=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,yPe=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,vPe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,_Pe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,xPe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,bPe=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const SPe=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,wPe=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,EPe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,TPe=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,MPe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,CPe=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,APe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,PPe=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,RPe=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,kPe=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,IPe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,NPe=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,DPe=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,OPe=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,FPe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,LPe=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,BPe=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,UPe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,zPe=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,VPe=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,GPe=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,jPe=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,HPe=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,WPe=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,$Pe=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,qPe=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,XPe=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,YPe=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,KPe=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,ZPe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,QPe=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,JPe=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,eRe=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,tRe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,fi={alphahash_fragment:wCe,alphahash_pars_fragment:ECe,alphamap_fragment:TCe,alphamap_pars_fragment:MCe,alphatest_fragment:CCe,alphatest_pars_fragment:ACe,aomap_fragment:PCe,aomap_pars_fragment:RCe,batching_pars_vertex:kCe,batching_vertex:ICe,begin_vertex:NCe,beginnormal_vertex:DCe,bsdfs:OCe,iridescence_fragment:FCe,bumpmap_pars_fragment:LCe,clipping_planes_fragment:BCe,clipping_planes_pars_fragment:UCe,clipping_planes_pars_vertex:zCe,clipping_planes_vertex:VCe,color_fragment:GCe,color_pars_fragment:jCe,color_pars_vertex:HCe,color_vertex:WCe,common:$Ce,cube_uv_reflection_fragment:qCe,defaultnormal_vertex:XCe,displacementmap_pars_vertex:YCe,displacementmap_vertex:KCe,emissivemap_fragment:ZCe,emissivemap_pars_fragment:QCe,colorspace_fragment:JCe,colorspace_pars_fragment:eAe,envmap_fragment:tAe,envmap_common_pars_fragment:nAe,envmap_pars_fragment:rAe,envmap_pars_vertex:iAe,envmap_physical_pars_fragment:mAe,envmap_vertex:sAe,fog_vertex:oAe,fog_pars_vertex:aAe,fog_fragment:lAe,fog_pars_fragment:cAe,gradientmap_pars_fragment:uAe,lightmap_pars_fragment:hAe,lights_lambert_fragment:dAe,lights_lambert_pars_fragment:fAe,lights_pars_begin:pAe,lights_toon_fragment:gAe,lights_toon_pars_fragment:yAe,lights_phong_fragment:vAe,lights_phong_pars_fragment:_Ae,lights_physical_fragment:xAe,lights_physical_pars_fragment:bAe,lights_fragment_begin:SAe,lights_fragment_maps:wAe,lights_fragment_end:EAe,logdepthbuf_fragment:TAe,logdepthbuf_pars_fragment:MAe,logdepthbuf_pars_vertex:CAe,logdepthbuf_vertex:AAe,map_fragment:PAe,map_pars_fragment:RAe,map_particle_fragment:kAe,map_particle_pars_fragment:IAe,metalnessmap_fragment:NAe,metalnessmap_pars_fragment:DAe,morphinstance_vertex:OAe,morphcolor_vertex:FAe,morphnormal_vertex:LAe,morphtarget_pars_vertex:BAe,morphtarget_vertex:UAe,normal_fragment_begin:zAe,normal_fragment_maps:VAe,normal_pars_fragment:GAe,normal_pars_vertex:jAe,normal_vertex:HAe,normalmap_pars_fragment:WAe,clearcoat_normal_fragment_begin:$Ae,clearcoat_normal_fragment_maps:qAe,clearcoat_pars_fragment:XAe,iridescence_pars_fragment:YAe,opaque_fragment:KAe,packing:ZAe,premultiplied_alpha_fragment:QAe,project_vertex:JAe,dithering_fragment:ePe,dithering_pars_fragment:tPe,roughnessmap_fragment:nPe,roughnessmap_pars_fragment:rPe,shadowmap_pars_fragment:iPe,shadowmap_pars_vertex:sPe,shadowmap_vertex:oPe,shadowmask_pars_fragment:aPe,skinbase_vertex:lPe,skinning_pars_vertex:cPe,skinning_vertex:uPe,skinnormal_vertex:hPe,specularmap_fragment:dPe,specularmap_pars_fragment:fPe,tonemapping_fragment:pPe,tonemapping_pars_fragment:mPe,transmission_fragment:gPe,transmission_pars_fragment:yPe,uv_pars_fragment:vPe,uv_pars_vertex:_Pe,uv_vertex:xPe,worldpos_vertex:bPe,background_vert:SPe,background_frag:wPe,backgroundCube_vert:EPe,backgroundCube_frag:TPe,cube_vert:MPe,cube_frag:CPe,depth_vert:APe,depth_frag:PPe,distanceRGBA_vert:RPe,distanceRGBA_frag:kPe,equirect_vert:IPe,equirect_frag:NPe,linedashed_vert:DPe,linedashed_frag:OPe,meshbasic_vert:FPe,meshbasic_frag:LPe,meshlambert_vert:BPe,meshlambert_frag:UPe,meshmatcap_vert:zPe,meshmatcap_frag:VPe,meshnormal_vert:GPe,meshnormal_frag:jPe,meshphong_vert:HPe,meshphong_frag:WPe,meshphysical_vert:$Pe,meshphysical_frag:qPe,meshtoon_vert:XPe,meshtoon_frag:YPe,points_vert:KPe,points_frag:ZPe,shadow_vert:QPe,shadow_frag:JPe,sprite_vert:eRe,sprite_frag:tRe},Bn={common:{diffuse:{value:new Vn(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new ui},alphaMap:{value:null},alphaMapTransform:{value:new ui},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new ui}},envmap:{envMap:{value:null},envMapRotation:{value:new ui},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new ui}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new ui}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new ui},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new ui},normalScale:{value:new mr(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new ui},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new ui}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new ui}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new ui}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Vn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Vn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new ui},alphaTest:{value:0},uvTransform:{value:new ui}},sprite:{diffuse:{value:new Vn(16777215)},opacity:{value:1},center:{value:new mr(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new ui},alphaMap:{value:null},alphaMapTransform:{value:new ui},alphaTest:{value:0}}},Yp={basic:{uniforms:Ml([Bn.common,Bn.specularmap,Bn.envmap,Bn.aomap,Bn.lightmap,Bn.fog]),vertexShader:fi.meshbasic_vert,fragmentShader:fi.meshbasic_frag},lambert:{uniforms:Ml([Bn.common,Bn.specularmap,Bn.envmap,Bn.aomap,Bn.lightmap,Bn.emissivemap,Bn.bumpmap,Bn.normalmap,Bn.displacementmap,Bn.fog,Bn.lights,{emissive:{value:new Vn(0)}}]),vertexShader:fi.meshlambert_vert,fragmentShader:fi.meshlambert_frag},phong:{uniforms:Ml([Bn.common,Bn.specularmap,Bn.envmap,Bn.aomap,Bn.lightmap,Bn.emissivemap,Bn.bumpmap,Bn.normalmap,Bn.displacementmap,Bn.fog,Bn.lights,{emissive:{value:new Vn(0)},specular:{value:new Vn(1118481)},shininess:{value:30}}]),vertexShader:fi.meshphong_vert,fragmentShader:fi.meshphong_frag},standard:{uniforms:Ml([Bn.common,Bn.envmap,Bn.aomap,Bn.lightmap,Bn.emissivemap,Bn.bumpmap,Bn.normalmap,Bn.displacementmap,Bn.roughnessmap,Bn.metalnessmap,Bn.fog,Bn.lights,{emissive:{value:new Vn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:fi.meshphysical_vert,fragmentShader:fi.meshphysical_frag},toon:{uniforms:Ml([Bn.common,Bn.aomap,Bn.lightmap,Bn.emissivemap,Bn.bumpmap,Bn.normalmap,Bn.displacementmap,Bn.gradientmap,Bn.fog,Bn.lights,{emissive:{value:new Vn(0)}}]),vertexShader:fi.meshtoon_vert,fragmentShader:fi.meshtoon_frag},matcap:{uniforms:Ml([Bn.common,Bn.bumpmap,Bn.normalmap,Bn.displacementmap,Bn.fog,{matcap:{value:null}}]),vertexShader:fi.meshmatcap_vert,fragmentShader:fi.meshmatcap_frag},points:{uniforms:Ml([Bn.points,Bn.fog]),vertexShader:fi.points_vert,fragmentShader:fi.points_frag},dashed:{uniforms:Ml([Bn.common,Bn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:fi.linedashed_vert,fragmentShader:fi.linedashed_frag},depth:{uniforms:Ml([Bn.common,Bn.displacementmap]),vertexShader:fi.depth_vert,fragmentShader:fi.depth_frag},normal:{uniforms:Ml([Bn.common,Bn.bumpmap,Bn.normalmap,Bn.displacementmap,{opacity:{value:1}}]),vertexShader:fi.meshnormal_vert,fragmentShader:fi.meshnormal_frag},sprite:{uniforms:Ml([Bn.sprite,Bn.fog]),vertexShader:fi.sprite_vert,fragmentShader:fi.sprite_frag},background:{uniforms:{uvTransform:{value:new ui},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:fi.background_vert,fragmentShader:fi.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new ui}},vertexShader:fi.backgroundCube_vert,fragmentShader:fi.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:fi.cube_vert,fragmentShader:fi.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:fi.equirect_vert,fragmentShader:fi.equirect_frag},distanceRGBA:{uniforms:Ml([Bn.common,Bn.displacementmap,{referencePosition:{value:new Ie},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:fi.distanceRGBA_vert,fragmentShader:fi.distanceRGBA_frag},shadow:{uniforms:Ml([Bn.lights,Bn.fog,{color:{value:new Vn(0)},opacity:{value:1}}]),vertexShader:fi.shadow_vert,fragmentShader:fi.shadow_frag}};Yp.physical={uniforms:Ml([Yp.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new ui},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new ui},clearcoatNormalScale:{value:new mr(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new ui},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new ui},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new ui},sheen:{value:0},sheenColor:{value:new Vn(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new ui},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new ui},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new ui},transmissionSamplerSize:{value:new mr},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new ui},attenuationDistance:{value:0},attenuationColor:{value:new Vn(0)},specularColor:{value:new Vn(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new ui},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new ui},anisotropyVector:{value:new mr},anisotropyMap:{value:null},anisotropyMapTransform:{value:new ui}}]),vertexShader:fi.meshphysical_vert,fragmentShader:fi.meshphysical_frag};const xR={r:0,b:0,g:0},L8=new na,nRe=new vr;function rRe(o,e,t,n,r,i,a){const c=new Vn(0);let h=i===!0?0:1,p,v,x=null,S=0,C=null;function I(Z){let k=Z.isScene===!0?Z.background:null;return k&&k.isTexture&&(k=(Z.backgroundBlurriness>0?t:e).get(k)),k}function L(Z){let k=!1;const ie=I(Z);ie===null?R(c,h):ie&&ie.isColor&&(R(ie,1),k=!0);const ue=o.xr.getEnvironmentBlendMode();ue==="additive"?n.buffers.color.setClear(0,0,0,1,a):ue==="alpha-blend"&&n.buffers.color.setClear(0,0,0,0,a),(o.autoClear||k)&&(n.buffers.depth.setTest(!0),n.buffers.depth.setMask(!0),n.buffers.color.setMask(!0),o.clear(o.autoClearColor,o.autoClearDepth,o.autoClearStencil))}function U(Z,k){const ie=I(k);ie&&(ie.isCubeTexture||ie.mapping===yI)?(v===void 0&&(v=new Mn(new ma(1,1,1),new ff({name:"BackgroundCubeMaterial",uniforms:O_(Yp.backgroundCube.uniforms),vertexShader:Yp.backgroundCube.vertexShader,fragmentShader:Yp.backgroundCube.fragmentShader,side:u0,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),v.geometry.deleteAttribute("normal"),v.geometry.deleteAttribute("uv"),v.onBeforeRender=function(ue,ce,Q){this.matrixWorld.copyPosition(Q.matrixWorld)},Object.defineProperty(v.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(v)),L8.copy(k.backgroundRotation),L8.x*=-1,L8.y*=-1,L8.z*=-1,ie.isCubeTexture&&ie.isRenderTargetTexture===!1&&(L8.y*=-1,L8.z*=-1),v.material.uniforms.envMap.value=ie,v.material.uniforms.flipEnvMap.value=ie.isCubeTexture&&ie.isRenderTargetTexture===!1?-1:1,v.material.uniforms.backgroundBlurriness.value=k.backgroundBlurriness,v.material.uniforms.backgroundIntensity.value=k.backgroundIntensity,v.material.uniforms.backgroundRotation.value.setFromMatrix4(nRe.makeRotationFromEuler(L8)),v.material.toneMapped=Kr.getTransfer(ie.colorSpace)!==ms,(x!==ie||S!==ie.version||C!==o.toneMapping)&&(v.material.needsUpdate=!0,x=ie,S=ie.version,C=o.toneMapping),v.layers.enableAll(),Z.unshift(v,v.geometry,v.material,0,0,null)):ie&&ie.isTexture&&(p===void 0&&(p=new Mn(new b6(2,2),new ff({name:"BackgroundMaterial",uniforms:O_(Yp.background.uniforms),vertexShader:Yp.background.vertexShader,fragmentShader:Yp.background.fragmentShader,side:Rg,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),p.geometry.deleteAttribute("normal"),Object.defineProperty(p.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(p)),p.material.uniforms.t2D.value=ie,p.material.uniforms.backgroundIntensity.value=k.backgroundIntensity,p.material.toneMapped=Kr.getTransfer(ie.colorSpace)!==ms,ie.matrixAutoUpdate===!0&&ie.updateMatrix(),p.material.uniforms.uvTransform.value.copy(ie.matrix),(x!==ie||S!==ie.version||C!==o.toneMapping)&&(p.material.needsUpdate=!0,x=ie,S=ie.version,C=o.toneMapping),p.layers.enableAll(),Z.unshift(p,p.geometry,p.material,0,0,null))}function R(Z,k){Z.getRGB(xR,M9e(o)),n.buffers.color.setClear(xR.r,xR.g,xR.b,k,a)}function $(){v!==void 0&&(v.geometry.dispose(),v.material.dispose(),v=void 0),p!==void 0&&(p.geometry.dispose(),p.material.dispose(),p=void 0)}return{getClearColor:function(){return c},setClearColor:function(Z,k=1){c.set(Z),h=k,R(c,h)},getClearAlpha:function(){return h},setClearAlpha:function(Z){h=Z,R(c,h)},render:L,addToRenderList:U,dispose:$}}function iRe(o,e){const t=o.getParameter(o.MAX_VERTEX_ATTRIBS),n={},r=S(null);let i=r,a=!1;function c(le,J,Ue,je,rt){let at=!1;const Se=x(je,Ue,J);i!==Se&&(i=Se,p(i.object)),at=C(le,je,Ue,rt),at&&I(le,je,Ue,rt),rt!==null&&e.update(rt,o.ELEMENT_ARRAY_BUFFER),(at||a)&&(a=!1,k(le,J,Ue,je),rt!==null&&o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,e.get(rt).buffer))}function h(){return o.createVertexArray()}function p(le){return o.bindVertexArray(le)}function v(le){return o.deleteVertexArray(le)}function x(le,J,Ue){const je=Ue.wireframe===!0;let rt=n[le.id];rt===void 0&&(rt={},n[le.id]=rt);let at=rt[J.id];at===void 0&&(at={},rt[J.id]=at);let Se=at[je];return Se===void 0&&(Se=S(h()),at[je]=Se),Se}function S(le){const J=[],Ue=[],je=[];for(let rt=0;rt<t;rt++)J[rt]=0,Ue[rt]=0,je[rt]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:J,enabledAttributes:Ue,attributeDivisors:je,object:le,attributes:{},index:null}}function C(le,J,Ue,je){const rt=i.attributes,at=J.attributes;let Se=0;const gt=Ue.getAttributes();for(const Ae in gt)if(gt[Ae].location>=0){const pt=rt[Ae];let De=at[Ae];if(De===void 0&&(Ae==="instanceMatrix"&&le.instanceMatrix&&(De=le.instanceMatrix),Ae==="instanceColor"&&le.instanceColor&&(De=le.instanceColor)),pt===void 0||pt.attribute!==De||De&&pt.data!==De.data)return!0;Se++}return i.attributesNum!==Se||i.index!==je}function I(le,J,Ue,je){const rt={},at=J.attributes;let Se=0;const gt=Ue.getAttributes();for(const Ae in gt)if(gt[Ae].location>=0){let pt=at[Ae];pt===void 0&&(Ae==="instanceMatrix"&&le.instanceMatrix&&(pt=le.instanceMatrix),Ae==="instanceColor"&&le.instanceColor&&(pt=le.instanceColor));const De={};De.attribute=pt,pt&&pt.data&&(De.data=pt.data),rt[Ae]=De,Se++}i.attributes=rt,i.attributesNum=Se,i.index=je}function L(){const le=i.newAttributes;for(let J=0,Ue=le.length;J<Ue;J++)le[J]=0}function U(le){R(le,0)}function R(le,J){const Ue=i.newAttributes,je=i.enabledAttributes,rt=i.attributeDivisors;Ue[le]=1,je[le]===0&&(o.enableVertexAttribArray(le),je[le]=1),rt[le]!==J&&(o.vertexAttribDivisor(le,J),rt[le]=J)}function $(){const le=i.newAttributes,J=i.enabledAttributes;for(let Ue=0,je=J.length;Ue<je;Ue++)J[Ue]!==le[Ue]&&(o.disableVertexAttribArray(Ue),J[Ue]=0)}function Z(le,J,Ue,je,rt,at,Se){Se===!0?o.vertexAttribIPointer(le,J,Ue,rt,at):o.vertexAttribPointer(le,J,Ue,je,rt,at)}function k(le,J,Ue,je){L();const rt=je.attributes,at=Ue.getAttributes(),Se=J.defaultAttributeValues;for(const gt in at){const Ae=at[gt];if(Ae.location>=0){let lt=rt[gt];if(lt===void 0&&(gt==="instanceMatrix"&&le.instanceMatrix&&(lt=le.instanceMatrix),gt==="instanceColor"&&le.instanceColor&&(lt=le.instanceColor)),lt!==void 0){const pt=lt.normalized,De=lt.itemSize,_t=e.get(lt);if(_t===void 0)continue;const Jt=_t.buffer,dt=_t.type,Dt=_t.bytesPerElement,gn=dt===o.INT||dt===o.UNSIGNED_INT||lt.gpuType===_H;if(lt.isInterleavedBufferAttribute){const qt=lt.data,wn=qt.stride,nr=lt.offset;if(qt.isInstancedInterleavedBuffer){for(let qn=0;qn<Ae.locationSize;qn++)R(Ae.location+qn,qt.meshPerAttribute);le.isInstancedMesh!==!0&&je._maxInstanceCount===void 0&&(je._maxInstanceCount=qt.meshPerAttribute*qt.count)}else for(let qn=0;qn<Ae.locationSize;qn++)U(Ae.location+qn);o.bindBuffer(o.ARRAY_BUFFER,Jt);for(let qn=0;qn<Ae.locationSize;qn++)Z(Ae.location+qn,De/Ae.locationSize,dt,pt,wn*Dt,(nr+De/Ae.locationSize*qn)*Dt,gn)}else{if(lt.isInstancedBufferAttribute){for(let qt=0;qt<Ae.locationSize;qt++)R(Ae.location+qt,lt.meshPerAttribute);le.isInstancedMesh!==!0&&je._maxInstanceCount===void 0&&(je._maxInstanceCount=lt.meshPerAttribute*lt.count)}else for(let qt=0;qt<Ae.locationSize;qt++)U(Ae.location+qt);o.bindBuffer(o.ARRAY_BUFFER,Jt);for(let qt=0;qt<Ae.locationSize;qt++)Z(Ae.location+qt,De/Ae.locationSize,dt,pt,De*Dt,De/Ae.locationSize*qt*Dt,gn)}}else if(Se!==void 0){const pt=Se[gt];if(pt!==void 0)switch(pt.length){case 2:o.vertexAttrib2fv(Ae.location,pt);break;case 3:o.vertexAttrib3fv(Ae.location,pt);break;case 4:o.vertexAttrib4fv(Ae.location,pt);break;default:o.vertexAttrib1fv(Ae.location,pt)}}}}$()}function ie(){Q();for(const le in n){const J=n[le];for(const Ue in J){const je=J[Ue];for(const rt in je)v(je[rt].object),delete je[rt];delete J[Ue]}delete n[le]}}function ue(le){if(n[le.id]===void 0)return;const J=n[le.id];for(const Ue in J){const je=J[Ue];for(const rt in je)v(je[rt].object),delete je[rt];delete J[Ue]}delete n[le.id]}function ce(le){for(const J in n){const Ue=n[J];if(Ue[le.id]===void 0)continue;const je=Ue[le.id];for(const rt in je)v(je[rt].object),delete je[rt];delete Ue[le.id]}}function Q(){ae(),a=!0,i!==r&&(i=r,p(i.object))}function ae(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:c,reset:Q,resetDefaultState:ae,dispose:ie,releaseStatesOfGeometry:ue,releaseStatesOfProgram:ce,initAttributes:L,enableAttribute:U,disableUnusedAttributes:$}}function sRe(o,e,t){let n;function r(p){n=p}function i(p,v){o.drawArrays(n,p,v),t.update(v,n,1)}function a(p,v,x){x!==0&&(o.drawArraysInstanced(n,p,v,x),t.update(v,n,x))}function c(p,v,x){if(x===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(n,p,0,v,0,x);let C=0;for(let I=0;I<x;I++)C+=v[I];t.update(C,n,1)}function h(p,v,x,S){if(x===0)return;const C=e.get("WEBGL_multi_draw");if(C===null)for(let I=0;I<p.length;I++)a(p[I],v[I],S[I]);else{C.multiDrawArraysInstancedWEBGL(n,p,0,v,0,S,0,x);let I=0;for(let L=0;L<x;L++)I+=v[L]*S[L];t.update(I,n,1)}}this.setMode=r,this.render=i,this.renderInstances=a,this.renderMultiDraw=c,this.renderMultiDrawInstances=h}function oRe(o,e,t,n){let r;function i(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const ce=e.get("EXT_texture_filter_anisotropic");r=o.getParameter(ce.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function a(ce){return!(ce!==V0&&n.convert(ce)!==o.getParameter(o.IMPLEMENTATION_COLOR_READ_FORMAT))}function c(ce){const Q=ce===v6&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(ce!==n1&&n.convert(ce)!==o.getParameter(o.IMPLEMENTATION_COLOR_READ_TYPE)&&ce!==Th&&!Q)}function h(ce){if(ce==="highp"){if(o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.HIGH_FLOAT).precision>0&&o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.HIGH_FLOAT).precision>0)return"highp";ce="mediump"}return ce==="mediump"&&o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.MEDIUM_FLOAT).precision>0&&o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let p=t.precision!==void 0?t.precision:"highp";const v=h(p);v!==p&&(console.warn("THREE.WebGLRenderer:",p,"not supported, using",v,"instead."),p=v);const x=t.logarithmicDepthBuffer===!0,S=t.reverseDepthBuffer===!0&&e.has("EXT_clip_control"),C=o.getParameter(o.MAX_TEXTURE_IMAGE_UNITS),I=o.getParameter(o.MAX_VERTEX_TEXTURE_IMAGE_UNITS),L=o.getParameter(o.MAX_TEXTURE_SIZE),U=o.getParameter(o.MAX_CUBE_MAP_TEXTURE_SIZE),R=o.getParameter(o.MAX_VERTEX_ATTRIBS),$=o.getParameter(o.MAX_VERTEX_UNIFORM_VECTORS),Z=o.getParameter(o.MAX_VARYING_VECTORS),k=o.getParameter(o.MAX_FRAGMENT_UNIFORM_VECTORS),ie=I>0,ue=o.getParameter(o.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:i,getMaxPrecision:h,textureFormatReadable:a,textureTypeReadable:c,precision:p,logarithmicDepthBuffer:x,reverseDepthBuffer:S,maxTextures:C,maxVertexTextures:I,maxTextureSize:L,maxCubemapSize:U,maxAttributes:R,maxVertexUniforms:$,maxVaryings:Z,maxFragmentUniforms:k,vertexTextures:ie,maxSamples:ue}}function aRe(o){const e=this;let t=null,n=0,r=!1,i=!1;const a=new L3,c=new ui,h={value:null,needsUpdate:!1};this.uniform=h,this.numPlanes=0,this.numIntersection=0,this.init=function(x,S){const C=x.length!==0||S||n!==0||r;return r=S,n=x.length,C},this.beginShadows=function(){i=!0,v(null)},this.endShadows=function(){i=!1},this.setGlobalState=function(x,S){t=v(x,S,0)},this.setState=function(x,S,C){const I=x.clippingPlanes,L=x.clipIntersection,U=x.clipShadows,R=o.get(x);if(!r||I===null||I.length===0||i&&!U)i?v(null):p();else{const $=i?0:n,Z=$*4;let k=R.clippingState||null;h.value=k,k=v(I,S,Z,C);for(let ie=0;ie!==Z;++ie)k[ie]=t[ie];R.clippingState=k,this.numIntersection=L?this.numPlanes:0,this.numPlanes+=$}};function p(){h.value!==t&&(h.value=t,h.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function v(x,S,C,I){const L=x!==null?x.length:0;let U=null;if(L!==0){if(U=h.value,I!==!0||U===null){const R=C+L*4,$=S.matrixWorldInverse;c.getNormalMatrix($),(U===null||U.length<R)&&(U=new Float32Array(R));for(let Z=0,k=C;Z!==L;++Z,k+=4)a.copy(x[Z]).applyMatrix4($,c),a.normal.toArray(U,k),U[k+3]=a.constant}h.value=U,h.needsUpdate=!0}return e.numPlanes=L,e.numIntersection=0,U}}function lRe(o){let e=new WeakMap;function t(a,c){return c===Dk?a.mapping=I_:c===DG&&(a.mapping=N_),a}function n(a){if(a&&a.isTexture){const c=a.mapping;if(c===Dk||c===DG)if(e.has(a)){const h=e.get(a).texture;return t(h,a.mapping)}else{const h=a.image;if(h&&h.height>0){const p=new oMe(h.height);return p.fromEquirectangularTexture(o,a),e.set(a,p),a.addEventListener("dispose",r),t(p.texture,a.mapping)}else return null}}return a}function r(a){const c=a.target;c.removeEventListener("dispose",r);const h=e.get(c);h!==void 0&&(e.delete(c),h.dispose())}function i(){e=new WeakMap}return{get:n,dispose:i}}const h_=4,R1e=[.125,.215,.35,.446,.526,.582],s6=20,Vz=new wE,k1e=new Vn;let Gz=null,jz=0,Hz=0,Wz=!1;const Z8=(1+Math.sqrt(5))/2,I7=1/Z8,I1e=[new Ie(-Z8,I7,0),new Ie(Z8,I7,0),new Ie(-I7,0,Z8),new Ie(I7,0,Z8),new Ie(0,Z8,-I7),new Ie(0,Z8,I7),new Ie(-1,1,-1),new Ie(1,1,-1),new Ie(-1,1,1),new Ie(1,1,1)],cRe=new Ie;let N1e=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,r=100,i={}){const{size:a=256,position:c=cRe}=i;Gz=this._renderer.getRenderTarget(),jz=this._renderer.getActiveCubeFace(),Hz=this._renderer.getActiveMipmapLevel(),Wz=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(a);const h=this._allocateTargets();return h.depthBuffer=!0,this._sceneToCubeUV(e,n,r,h,c),t>0&&this._blur(h,0,0,t),this._applyPMREM(h),this._cleanup(h),h}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=F1e(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=O1e(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Gz,jz,Hz),this._renderer.xr.enabled=Wz,e.scissorTest=!1,bR(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===I_||e.mapping===N_?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),Gz=this._renderer.getRenderTarget(),jz=this._renderer.getActiveCubeFace(),Hz=this._renderer.getActiveMipmapLevel(),Wz=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:xc,minFilter:xc,generateMipmaps:!1,type:v6,format:V0,colorSpace:df,depthBuffer:!1},r=D1e(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=D1e(e,t,n);const{_lodMax:i}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=uRe(i)),this._blurMaterial=hRe(i,e,t)}return r}_compileMaterial(e){const t=new Mn(this._lodPlanes[0],e);this._renderer.compile(t,Vz)}_sceneToCubeUV(e,t,n,r,i){const h=new La(90,1,t,n),p=[1,-1,1,1,1,1],v=[1,1,1,-1,-1,-1],x=this._renderer,S=x.autoClear,C=x.toneMapping;x.getClearColor(k1e),x.toneMapping=Jp,x.autoClear=!1;const I=new wu({name:"PMREM.Background",side:u0,depthWrite:!1,depthTest:!1}),L=new Mn(new ma,I);let U=!1;const R=e.background;R?R.isColor&&(I.color.copy(R),e.background=null,U=!0):(I.color.copy(k1e),U=!0);for(let $=0;$<6;$++){const Z=$%3;Z===0?(h.up.set(0,p[$],0),h.position.set(i.x,i.y,i.z),h.lookAt(i.x+v[$],i.y,i.z)):Z===1?(h.up.set(0,0,p[$]),h.position.set(i.x,i.y,i.z),h.lookAt(i.x,i.y+v[$],i.z)):(h.up.set(0,p[$],0),h.position.set(i.x,i.y,i.z),h.lookAt(i.x,i.y,i.z+v[$]));const k=this._cubeSize;bR(r,Z*k,$>2?k:0,k,k),x.setRenderTarget(r),U&&x.render(L,h),x.render(e,h)}L.geometry.dispose(),L.material.dispose(),x.toneMapping=C,x.autoClear=S,e.background=R}_textureToCubeUV(e,t){const n=this._renderer,r=e.mapping===I_||e.mapping===N_;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=F1e()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=O1e());const i=r?this._cubemapMaterial:this._equirectMaterial,a=new Mn(this._lodPlanes[0],i),c=i.uniforms;c.envMap.value=e;const h=this._cubeSize;bR(t,0,0,3*h,2*h),n.setRenderTarget(t),n.render(a,Vz)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const r=this._lodPlanes.length;for(let i=1;i<r;i++){const a=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),c=I1e[(r-i-1)%I1e.length];this._blur(e,i-1,i,a,c)}t.autoClear=n}_blur(e,t,n,r,i){const a=this._pingPongRenderTarget;this._halfBlur(e,a,t,n,r,"latitudinal",i),this._halfBlur(a,e,n,n,r,"longitudinal",i)}_halfBlur(e,t,n,r,i,a,c){const h=this._renderer,p=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const v=3,x=new Mn(this._lodPlanes[r],p),S=p.uniforms,C=this._sizeLods[n]-1,I=isFinite(i)?Math.PI/(2*C):2*Math.PI/(2*s6-1),L=i/I,U=isFinite(i)?1+Math.floor(v*L):s6;U>s6&&console.warn(`sigmaRadians, ${i}, is too large and will clip, as it requested ${U} samples when the maximum is set to ${s6}`);const R=[];let $=0;for(let ce=0;ce<s6;++ce){const Q=ce/L,ae=Math.exp(-Q*Q/2);R.push(ae),ce===0?$+=ae:ce<U&&($+=2*ae)}for(let ce=0;ce<R.length;ce++)R[ce]=R[ce]/$;S.envMap.value=e.texture,S.samples.value=U,S.weights.value=R,S.latitudinal.value=a==="latitudinal",c&&(S.poleAxis.value=c);const{_lodMax:Z}=this;S.dTheta.value=I,S.mipInt.value=Z-n;const k=this._sizeLods[r],ie=3*k*(r>Z-h_?r-Z+h_:0),ue=4*(this._cubeSize-k);bR(t,ie,ue,3*k,2*k),h.setRenderTarget(t),h.render(x,Vz)}};function uRe(o){const e=[],t=[],n=[];let r=o;const i=o-h_+1+R1e.length;for(let a=0;a<i;a++){const c=Math.pow(2,r);t.push(c);let h=1/c;a>o-h_?h=R1e[a-o+h_-1]:a===0&&(h=0),n.push(h);const p=1/(c-2),v=-p,x=1+p,S=[v,v,x,v,x,x,v,v,x,x,v,x],C=6,I=6,L=3,U=2,R=1,$=new Float32Array(L*I*C),Z=new Float32Array(U*I*C),k=new Float32Array(R*I*C);for(let ue=0;ue<C;ue++){const ce=ue%3*2/3-1,Q=ue>2?0:-1,ae=[ce,Q,0,ce+2/3,Q,0,ce+2/3,Q+1,0,ce,Q,0,ce+2/3,Q+1,0,ce,Q+1,0];$.set(ae,L*I*ue),Z.set(S,U*I*ue);const le=[ue,ue,ue,ue,ue,ue];k.set(le,R*I*ue)}const ie=new _s;ie.setAttribute("position",new hf($,L)),ie.setAttribute("uv",new hf(Z,U)),ie.setAttribute("faceIndex",new hf(k,R)),e.push(ie),r>h_&&r--}return{lodPlanes:e,sizeLods:t,sigmas:n}}function D1e(o,e,t){const n=new _6(o,e,t);return n.texture.mapping=yI,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function bR(o,e,t,n,r){o.viewport.set(e,t,n,r),o.scissor.set(e,t,n,r)}function hRe(o,e,t){const n=new Float32Array(s6),r=new Ie(0,1,0);return new ff({name:"SphericalGaussianBlur",defines:{n:s6,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${o}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:WH(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:xg,depthTest:!1,depthWrite:!1})}function O1e(){return new ff({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:WH(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:xg,depthTest:!1,depthWrite:!1})}function F1e(){return new ff({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:WH(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:xg,depthTest:!1,depthWrite:!1})}function WH(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function dRe(o){let e=new WeakMap,t=null;function n(c){if(c&&c.isTexture){const h=c.mapping,p=h===Dk||h===DG,v=h===I_||h===N_;if(p||v){let x=e.get(c);const S=x!==void 0?x.texture.pmremVersion:0;if(c.isRenderTargetTexture&&c.pmremVersion!==S)return t===null&&(t=new N1e(o)),x=p?t.fromEquirectangular(c,x):t.fromCubemap(c,x),x.texture.pmremVersion=c.pmremVersion,e.set(c,x),x.texture;if(x!==void 0)return x.texture;{const C=c.image;return p&&C&&C.height>0||v&&C&&r(C)?(t===null&&(t=new N1e(o)),x=p?t.fromEquirectangular(c):t.fromCubemap(c),x.texture.pmremVersion=c.pmremVersion,e.set(c,x),c.addEventListener("dispose",i),x.texture):null}}}return c}function r(c){let h=0;const p=6;for(let v=0;v<p;v++)c[v]!==void 0&&h++;return h===p}function i(c){const h=c.target;h.removeEventListener("dispose",i);const p=e.get(h);p!==void 0&&(e.delete(h),p.dispose())}function a(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:n,dispose:a}}function fRe(o){const e={};function t(n){if(e[n]!==void 0)return e[n];let r;switch(n){case"WEBGL_depth_texture":r=o.getExtension("WEBGL_depth_texture")||o.getExtension("MOZ_WEBGL_depth_texture")||o.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=o.getExtension("WEBGL_compressed_texture_s3tc")||o.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||o.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=o.getExtension("WEBGL_compressed_texture_pvrtc")||o.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=o.getExtension(n)}return e[n]=r,r}return{has:function(n){return t(n)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(n){const r=t(n);return r===null&&x_("THREE.WebGLRenderer: "+n+" extension not supported."),r}}}function pRe(o,e,t,n){const r={},i=new WeakMap;function a(x){const S=x.target;S.index!==null&&e.remove(S.index);for(const I in S.attributes)e.remove(S.attributes[I]);S.removeEventListener("dispose",a),delete r[S.id];const C=i.get(S);C&&(e.remove(C),i.delete(S)),n.releaseStatesOfGeometry(S),S.isInstancedBufferGeometry===!0&&delete S._maxInstanceCount,t.memory.geometries--}function c(x,S){return r[S.id]===!0||(S.addEventListener("dispose",a),r[S.id]=!0,t.memory.geometries++),S}function h(x){const S=x.attributes;for(const C in S)e.update(S[C],o.ARRAY_BUFFER)}function p(x){const S=[],C=x.index,I=x.attributes.position;let L=0;if(C!==null){const $=C.array;L=C.version;for(let Z=0,k=$.length;Z<k;Z+=3){const ie=$[Z+0],ue=$[Z+1],ce=$[Z+2];S.push(ie,ue,ue,ce,ce,ie)}}else if(I!==void 0){const $=I.array;L=I.version;for(let Z=0,k=$.length/3-1;Z<k;Z+=3){const ie=Z+0,ue=Z+1,ce=Z+2;S.push(ie,ue,ue,ce,ce,ie)}}else return;const U=new(v9e(S)?w9e:RH)(S,1);U.version=L;const R=i.get(x);R&&e.remove(R),i.set(x,U)}function v(x){const S=i.get(x);if(S){const C=x.index;C!==null&&S.version<C.version&&p(x)}else p(x);return i.get(x)}return{get:c,update:h,getWireframeAttribute:v}}function mRe(o,e,t){let n;function r(S){n=S}let i,a;function c(S){i=S.type,a=S.bytesPerElement}function h(S,C){o.drawElements(n,C,i,S*a),t.update(C,n,1)}function p(S,C,I){I!==0&&(o.drawElementsInstanced(n,C,i,S*a,I),t.update(C,n,I))}function v(S,C,I){if(I===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(n,C,0,i,S,0,I);let U=0;for(let R=0;R<I;R++)U+=C[R];t.update(U,n,1)}function x(S,C,I,L){if(I===0)return;const U=e.get("WEBGL_multi_draw");if(U===null)for(let R=0;R<S.length;R++)p(S[R]/a,C[R],L[R]);else{U.multiDrawElementsInstancedWEBGL(n,C,0,i,S,0,L,0,I);let R=0;for(let $=0;$<I;$++)R+=C[$]*L[$];t.update(R,n,1)}}this.setMode=r,this.setIndex=c,this.render=h,this.renderInstances=p,this.renderMultiDraw=v,this.renderMultiDrawInstances=x}function gRe(o){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function n(i,a,c){switch(t.calls++,a){case o.TRIANGLES:t.triangles+=c*(i/3);break;case o.LINES:t.lines+=c*(i/2);break;case o.LINE_STRIP:t.lines+=c*(i-1);break;case o.LINE_LOOP:t.lines+=c*i;break;case o.POINTS:t.points+=c*i;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",a);break}}function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:r,update:n}}function yRe(o,e,t){const n=new WeakMap,r=new Pi;function i(a,c,h){const p=a.morphTargetInfluences,v=c.morphAttributes.position||c.morphAttributes.normal||c.morphAttributes.color,x=v!==void 0?v.length:0;let S=n.get(c);if(S===void 0||S.count!==x){let le=function(){Q.dispose(),n.delete(c),c.removeEventListener("dispose",le)};var C=le;S!==void 0&&S.texture.dispose();const I=c.morphAttributes.position!==void 0,L=c.morphAttributes.normal!==void 0,U=c.morphAttributes.color!==void 0,R=c.morphAttributes.position||[],$=c.morphAttributes.normal||[],Z=c.morphAttributes.color||[];let k=0;I===!0&&(k=1),L===!0&&(k=2),U===!0&&(k=3);let ie=c.attributes.position.count*k,ue=1;ie>e.maxTextureSize&&(ue=Math.ceil(ie/e.maxTextureSize),ie=e.maxTextureSize);const ce=new Float32Array(ie*ue*4*x),Q=new x9e(ce,ie,ue,x);Q.type=Th,Q.needsUpdate=!0;const ae=k*4;for(let J=0;J<x;J++){const Ue=R[J],je=$[J],rt=Z[J],at=ie*ue*4*J;for(let Se=0;Se<Ue.count;Se++){const gt=Se*ae;I===!0&&(r.fromBufferAttribute(Ue,Se),ce[at+gt+0]=r.x,ce[at+gt+1]=r.y,ce[at+gt+2]=r.z,ce[at+gt+3]=0),L===!0&&(r.fromBufferAttribute(je,Se),ce[at+gt+4]=r.x,ce[at+gt+5]=r.y,ce[at+gt+6]=r.z,ce[at+gt+7]=0),U===!0&&(r.fromBufferAttribute(rt,Se),ce[at+gt+8]=r.x,ce[at+gt+9]=r.y,ce[at+gt+10]=r.z,ce[at+gt+11]=rt.itemSize===4?r.w:1)}}S={count:x,texture:Q,size:new mr(ie,ue)},n.set(c,S),c.addEventListener("dispose",le)}if(a.isInstancedMesh===!0&&a.morphTexture!==null)h.getUniforms().setValue(o,"morphTexture",a.morphTexture,t);else{let I=0;for(let U=0;U<p.length;U++)I+=p[U];const L=c.morphTargetsRelative?1:1-I;h.getUniforms().setValue(o,"morphTargetBaseInfluence",L),h.getUniforms().setValue(o,"morphTargetInfluences",p)}h.getUniforms().setValue(o,"morphTargetsTexture",S.texture,t),h.getUniforms().setValue(o,"morphTargetsTextureSize",S.size)}return{update:i}}function vRe(o,e,t,n){let r=new WeakMap;function i(h){const p=n.render.frame,v=h.geometry,x=e.get(h,v);if(r.get(x)!==p&&(e.update(x),r.set(x,p)),h.isInstancedMesh&&(h.hasEventListener("dispose",c)===!1&&h.addEventListener("dispose",c),r.get(h)!==p&&(t.update(h.instanceMatrix,o.ARRAY_BUFFER),h.instanceColor!==null&&t.update(h.instanceColor,o.ARRAY_BUFFER),r.set(h,p))),h.isSkinnedMesh){const S=h.skeleton;r.get(S)!==p&&(S.update(),r.set(S,p))}return x}function a(){r=new WeakMap}function c(h){const p=h.target;p.removeEventListener("dispose",c),t.remove(p.instanceMatrix),p.instanceColor!==null&&t.remove(p.instanceColor)}return{update:i,dispose:a}}const Y9e=new H0,L1e=new A9e(1,1),K9e=new x9e,Z9e=new zTe,Q9e=new IH,B1e=[],U1e=[],z1e=new Float32Array(16),V1e=new Float32Array(9),G1e=new Float32Array(4);function tx(o,e,t){const n=o[0];if(n<=0||n>0)return o;const r=e*t;let i=B1e[r];if(i===void 0&&(i=new Float32Array(r),B1e[r]=i),e!==0){n.toArray(i,0);for(let a=1,c=0;a!==e;++a)c+=t,o[a].toArray(i,c)}return i}function _a(o,e){if(o.length!==e.length)return!1;for(let t=0,n=o.length;t<n;t++)if(o[t]!==e[t])return!1;return!0}function xa(o,e){for(let t=0,n=e.length;t<n;t++)o[t]=e[t]}function bI(o,e){let t=U1e[e];t===void 0&&(t=new Int32Array(e),U1e[e]=t);for(let n=0;n!==e;++n)t[n]=o.allocateTextureUnit();return t}function _Re(o,e){const t=this.cache;t[0]!==e&&(o.uniform1f(this.addr,e),t[0]=e)}function xRe(o,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(o.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(_a(t,e))return;o.uniform2fv(this.addr,e),xa(t,e)}}function bRe(o,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(o.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(o.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(_a(t,e))return;o.uniform3fv(this.addr,e),xa(t,e)}}function SRe(o,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(o.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(_a(t,e))return;o.uniform4fv(this.addr,e),xa(t,e)}}function wRe(o,e){const t=this.cache,n=e.elements;if(n===void 0){if(_a(t,e))return;o.uniformMatrix2fv(this.addr,!1,e),xa(t,e)}else{if(_a(t,n))return;G1e.set(n),o.uniformMatrix2fv(this.addr,!1,G1e),xa(t,n)}}function ERe(o,e){const t=this.cache,n=e.elements;if(n===void 0){if(_a(t,e))return;o.uniformMatrix3fv(this.addr,!1,e),xa(t,e)}else{if(_a(t,n))return;V1e.set(n),o.uniformMatrix3fv(this.addr,!1,V1e),xa(t,n)}}function TRe(o,e){const t=this.cache,n=e.elements;if(n===void 0){if(_a(t,e))return;o.uniformMatrix4fv(this.addr,!1,e),xa(t,e)}else{if(_a(t,n))return;z1e.set(n),o.uniformMatrix4fv(this.addr,!1,z1e),xa(t,n)}}function MRe(o,e){const t=this.cache;t[0]!==e&&(o.uniform1i(this.addr,e),t[0]=e)}function CRe(o,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(o.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(_a(t,e))return;o.uniform2iv(this.addr,e),xa(t,e)}}function ARe(o,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(o.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(_a(t,e))return;o.uniform3iv(this.addr,e),xa(t,e)}}function PRe(o,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(o.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(_a(t,e))return;o.uniform4iv(this.addr,e),xa(t,e)}}function RRe(o,e){const t=this.cache;t[0]!==e&&(o.uniform1ui(this.addr,e),t[0]=e)}function kRe(o,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(o.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(_a(t,e))return;o.uniform2uiv(this.addr,e),xa(t,e)}}function IRe(o,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(o.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(_a(t,e))return;o.uniform3uiv(this.addr,e),xa(t,e)}}function NRe(o,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(o.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(_a(t,e))return;o.uniform4uiv(this.addr,e),xa(t,e)}}function DRe(o,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(o.uniform1i(this.addr,r),n[0]=r);let i;this.type===o.SAMPLER_2D_SHADOW?(L1e.compareFunction=p9e,i=L1e):i=Y9e,t.setTexture2D(e||i,r)}function ORe(o,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(o.uniform1i(this.addr,r),n[0]=r),t.setTexture3D(e||Z9e,r)}function FRe(o,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(o.uniform1i(this.addr,r),n[0]=r),t.setTextureCube(e||Q9e,r)}function LRe(o,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(o.uniform1i(this.addr,r),n[0]=r),t.setTexture2DArray(e||K9e,r)}function BRe(o){switch(o){case 5126:return _Re;case 35664:return xRe;case 35665:return bRe;case 35666:return SRe;case 35674:return wRe;case 35675:return ERe;case 35676:return TRe;case 5124:case 35670:return MRe;case 35667:case 35671:return CRe;case 35668:case 35672:return ARe;case 35669:case 35673:return PRe;case 5125:return RRe;case 36294:return kRe;case 36295:return IRe;case 36296:return NRe;case 35678:case 36198:case 36298:case 36306:case 35682:return DRe;case 35679:case 36299:case 36307:return ORe;case 35680:case 36300:case 36308:case 36293:return FRe;case 36289:case 36303:case 36311:case 36292:return LRe}}function URe(o,e){o.uniform1fv(this.addr,e)}function zRe(o,e){const t=tx(e,this.size,2);o.uniform2fv(this.addr,t)}function VRe(o,e){const t=tx(e,this.size,3);o.uniform3fv(this.addr,t)}function GRe(o,e){const t=tx(e,this.size,4);o.uniform4fv(this.addr,t)}function jRe(o,e){const t=tx(e,this.size,4);o.uniformMatrix2fv(this.addr,!1,t)}function HRe(o,e){const t=tx(e,this.size,9);o.uniformMatrix3fv(this.addr,!1,t)}function WRe(o,e){const t=tx(e,this.size,16);o.uniformMatrix4fv(this.addr,!1,t)}function $Re(o,e){o.uniform1iv(this.addr,e)}function qRe(o,e){o.uniform2iv(this.addr,e)}function XRe(o,e){o.uniform3iv(this.addr,e)}function YRe(o,e){o.uniform4iv(this.addr,e)}function KRe(o,e){o.uniform1uiv(this.addr,e)}function ZRe(o,e){o.uniform2uiv(this.addr,e)}function QRe(o,e){o.uniform3uiv(this.addr,e)}function JRe(o,e){o.uniform4uiv(this.addr,e)}function eke(o,e,t){const n=this.cache,r=e.length,i=bI(t,r);_a(n,i)||(o.uniform1iv(this.addr,i),xa(n,i));for(let a=0;a!==r;++a)t.setTexture2D(e[a]||Y9e,i[a])}function tke(o,e,t){const n=this.cache,r=e.length,i=bI(t,r);_a(n,i)||(o.uniform1iv(this.addr,i),xa(n,i));for(let a=0;a!==r;++a)t.setTexture3D(e[a]||Z9e,i[a])}function nke(o,e,t){const n=this.cache,r=e.length,i=bI(t,r);_a(n,i)||(o.uniform1iv(this.addr,i),xa(n,i));for(let a=0;a!==r;++a)t.setTextureCube(e[a]||Q9e,i[a])}function rke(o,e,t){const n=this.cache,r=e.length,i=bI(t,r);_a(n,i)||(o.uniform1iv(this.addr,i),xa(n,i));for(let a=0;a!==r;++a)t.setTexture2DArray(e[a]||K9e,i[a])}function ike(o){switch(o){case 5126:return URe;case 35664:return zRe;case 35665:return VRe;case 35666:return GRe;case 35674:return jRe;case 35675:return HRe;case 35676:return WRe;case 5124:case 35670:return $Re;case 35667:case 35671:return qRe;case 35668:case 35672:return XRe;case 35669:case 35673:return YRe;case 5125:return KRe;case 36294:return ZRe;case 36295:return QRe;case 36296:return JRe;case 35678:case 36198:case 36298:case 36306:case 35682:return eke;case 35679:case 36299:case 36307:return tke;case 35680:case 36300:case 36308:case 36293:return nke;case 36289:case 36303:case 36311:case 36292:return rke}}class ske{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=BRe(t.type)}}class oke{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=ike(t.type)}}class ake{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const r=this.seq;for(let i=0,a=r.length;i!==a;++i){const c=r[i];c.setValue(e,t[c.id],n)}}}const $z=/(\w+)(\])?(\[|\.)?/g;function j1e(o,e){o.seq.push(e),o.map[e.id]=e}function lke(o,e,t){const n=o.name,r=n.length;for($z.lastIndex=0;;){const i=$z.exec(n),a=$z.lastIndex;let c=i[1];const h=i[2]==="]",p=i[3];if(h&&(c=c|0),p===void 0||p==="["&&a+2===r){j1e(t,p===void 0?new ske(c,o,e):new oke(c,o,e));break}else{let x=t.map[c];x===void 0&&(x=new ake(c),j1e(t,x)),t=x}}}class bk{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<n;++r){const i=e.getActiveUniform(t,r),a=e.getUniformLocation(t,i.name);lke(i,a,this)}}setValue(e,t,n,r){const i=this.map[t];i!==void 0&&i.setValue(e,n,r)}setOptional(e,t,n){const r=t[n];r!==void 0&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let i=0,a=t.length;i!==a;++i){const c=t[i],h=n[c.id];h.needsUpdate!==!1&&c.setValue(e,h.value,r)}}static seqWithValue(e,t){const n=[];for(let r=0,i=e.length;r!==i;++r){const a=e[r];a.id in t&&n.push(a)}return n}}function H1e(o,e,t){const n=o.createShader(e);return o.shaderSource(n,t),o.compileShader(n),n}const cke=37297;let uke=0;function hke(o,e){const t=o.split(`
`),n=[],r=Math.max(e-6,0),i=Math.min(e+6,t.length);for(let a=r;a<i;a++){const c=a+1;n.push(`${c===e?">":" "} ${c}: ${t[a]}`)}return n.join(`
`)}const W1e=new ui;function dke(o){Kr._getMatrix(W1e,Kr.workingColorSpace,o);const e=`mat3( ${W1e.elements.map(t=>t.toFixed(4))} )`;switch(Kr.getTransfer(o)){case Lk:return[e,"LinearTransferOETF"];case ms:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",o),[e,"LinearTransferOETF"]}}function $1e(o,e,t){const n=o.getShaderParameter(e,o.COMPILE_STATUS),r=o.getShaderInfoLog(e).trim();if(n&&r==="")return"";const i=/ERROR: 0:(\d+)/.exec(r);if(i){const a=parseInt(i[1]);return t.toUpperCase()+`

`+r+`

`+hke(o.getShaderSource(e),a)}else return r}function fke(o,e){const t=dke(e);return[`vec4 ${o}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}function pke(o,e){let t;switch(e){case J2e:t="Linear";break;case e9e:t="Reinhard";break;case t9e:t="Cineon";break;case n9e:t="ACESFilmic";break;case i9e:t="AgX";break;case s9e:t="Neutral";break;case r9e:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+o+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const SR=new Ie;function mke(){Kr.getLuminanceCoefficients(SR);const o=SR.x.toFixed(4),e=SR.y.toFixed(4),t=SR.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${o}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function gke(o){return[o.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",o.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Gw).join(`
`)}function yke(o){const e=[];for(const t in o){const n=o[t];n!==!1&&e.push("#define "+t+" "+n)}return e.join(`
`)}function vke(o,e){const t={},n=o.getProgramParameter(e,o.ACTIVE_ATTRIBUTES);for(let r=0;r<n;r++){const i=o.getActiveAttrib(e,r),a=i.name;let c=1;i.type===o.FLOAT_MAT2&&(c=2),i.type===o.FLOAT_MAT3&&(c=3),i.type===o.FLOAT_MAT4&&(c=4),t[a]={type:i.type,location:o.getAttribLocation(e,a),locationSize:c}}return t}function Gw(o){return o!==""}function q1e(o,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return o.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function X1e(o,e){return o.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const _ke=/^[ \t]*#include +<([\w\d./]+)>/gm;function vj(o){return o.replace(_ke,bke)}const xke=new Map;function bke(o,e){let t=fi[e];if(t===void 0){const n=xke.get(e);if(n!==void 0)t=fi[n],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n);else throw new Error("Can not resolve #include <"+e+">")}return vj(t)}const Ske=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Y1e(o){return o.replace(Ske,wke)}function wke(o,e,t,n){let r="";for(let i=parseInt(e);i<parseInt(t);i++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+i+" ]").replace(/UNROLLED_LOOP_INDEX/g,i);return r}function K1e(o){let e=`precision ${o.precision} float;
	precision ${o.precision} int;
	precision ${o.precision} sampler2D;
	precision ${o.precision} samplerCube;
	precision ${o.precision} sampler3D;
	precision ${o.precision} sampler2DArray;
	precision ${o.precision} sampler2DShadow;
	precision ${o.precision} samplerCubeShadow;
	precision ${o.precision} sampler2DArrayShadow;
	precision ${o.precision} isampler2D;
	precision ${o.precision} isampler3D;
	precision ${o.precision} isamplerCube;
	precision ${o.precision} isampler2DArray;
	precision ${o.precision} usampler2D;
	precision ${o.precision} usampler3D;
	precision ${o.precision} usamplerCube;
	precision ${o.precision} usampler2DArray;
	`;return o.precision==="highp"?e+=`
#define HIGH_PRECISION`:o.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:o.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function Eke(o){let e="SHADOWMAP_TYPE_BASIC";return o.shadowMapType===$2e?e="SHADOWMAP_TYPE_PCF":o.shadowMapType===ZEe?e="SHADOWMAP_TYPE_PCF_SOFT":o.shadowMapType===fg&&(e="SHADOWMAP_TYPE_VSM"),e}function Tke(o){let e="ENVMAP_TYPE_CUBE";if(o.envMap)switch(o.envMapMode){case I_:case N_:e="ENVMAP_TYPE_CUBE";break;case yI:e="ENVMAP_TYPE_CUBE_UV";break}return e}function Mke(o){let e="ENVMAP_MODE_REFLECTION";if(o.envMap)switch(o.envMapMode){case N_:e="ENVMAP_MODE_REFRACTION";break}return e}function Cke(o){let e="ENVMAP_BLENDING_NONE";if(o.envMap)switch(o.combine){case gI:e="ENVMAP_BLENDING_MULTIPLY";break;case QEe:e="ENVMAP_BLENDING_MIX";break;case JEe:e="ENVMAP_BLENDING_ADD";break}return e}function Ake(o){const e=o.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:n,maxMip:t}}function Pke(o,e,t,n){const r=o.getContext(),i=t.defines;let a=t.vertexShader,c=t.fragmentShader;const h=Eke(t),p=Tke(t),v=Mke(t),x=Cke(t),S=Ake(t),C=gke(t),I=yke(i),L=r.createProgram();let U,R,$=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(U=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,I].filter(Gw).join(`
`),U.length>0&&(U+=`
`),R=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,I].filter(Gw).join(`
`),R.length>0&&(R+=`
`)):(U=[K1e(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,I,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+v:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+h:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Gw).join(`
`),R=[K1e(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,I,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+p:"",t.envMap?"#define "+v:"",t.envMap?"#define "+x:"",S?"#define CUBEUV_TEXEL_WIDTH "+S.texelWidth:"",S?"#define CUBEUV_TEXEL_HEIGHT "+S.texelHeight:"",S?"#define CUBEUV_MAX_MIP "+S.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+h:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Jp?"#define TONE_MAPPING":"",t.toneMapping!==Jp?fi.tonemapping_pars_fragment:"",t.toneMapping!==Jp?pke("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",fi.colorspace_pars_fragment,fke("linearToOutputTexel",t.outputColorSpace),mke(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Gw).join(`
`)),a=vj(a),a=q1e(a,t),a=X1e(a,t),c=vj(c),c=q1e(c,t),c=X1e(c,t),a=Y1e(a),c=Y1e(c),t.isRawShaderMaterial!==!0&&($=`#version 300 es
`,U=[C,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+U,R=["#define varying in",t.glslVersion===cj?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===cj?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+R);const Z=$+U+a,k=$+R+c,ie=H1e(r,r.VERTEX_SHADER,Z),ue=H1e(r,r.FRAGMENT_SHADER,k);r.attachShader(L,ie),r.attachShader(L,ue),t.index0AttributeName!==void 0?r.bindAttribLocation(L,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(L,0,"position"),r.linkProgram(L);function ce(J){if(o.debug.checkShaderErrors){const Ue=r.getProgramInfoLog(L).trim(),je=r.getShaderInfoLog(ie).trim(),rt=r.getShaderInfoLog(ue).trim();let at=!0,Se=!0;if(r.getProgramParameter(L,r.LINK_STATUS)===!1)if(at=!1,typeof o.debug.onShaderError=="function")o.debug.onShaderError(r,L,ie,ue);else{const gt=$1e(r,ie,"vertex"),Ae=$1e(r,ue,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(L,r.VALIDATE_STATUS)+`

Material Name: `+J.name+`
Material Type: `+J.type+`

Program Info Log: `+Ue+`
`+gt+`
`+Ae)}else Ue!==""?console.warn("THREE.WebGLProgram: Program Info Log:",Ue):(je===""||rt==="")&&(Se=!1);Se&&(J.diagnostics={runnable:at,programLog:Ue,vertexShader:{log:je,prefix:U},fragmentShader:{log:rt,prefix:R}})}r.deleteShader(ie),r.deleteShader(ue),Q=new bk(r,L),ae=vke(r,L)}let Q;this.getUniforms=function(){return Q===void 0&&ce(this),Q};let ae;this.getAttributes=function(){return ae===void 0&&ce(this),ae};let le=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return le===!1&&(le=r.getProgramParameter(L,cke)),le},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(L),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=uke++,this.cacheKey=e,this.usedTimes=1,this.program=L,this.vertexShader=ie,this.fragmentShader=ue,this}let Rke=0;class kke{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(t),i=this._getShaderStage(n),a=this._getShaderCacheForMaterial(e);return a.has(r)===!1&&(a.add(r),r.usedTimes++),a.has(i)===!1&&(a.add(i),i.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return n===void 0&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return n===void 0&&(n=new Ike(e),t.set(e,n)),n}}class Ike{constructor(e){this.id=Rke++,this.code=e,this.usedTimes=0}}function Nke(o,e,t,n,r,i,a){const c=new PH,h=new kke,p=new Set,v=[],x=r.logarithmicDepthBuffer,S=r.vertexTextures;let C=r.precision;const I={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function L(ae){return p.add(ae),ae===0?"uv":`uv${ae}`}function U(ae,le,J,Ue,je){const rt=Ue.fog,at=je.geometry,Se=ae.isMeshStandardMaterial?Ue.environment:null,gt=(ae.isMeshStandardMaterial?t:e).get(ae.envMap||Se),Ae=gt&&gt.mapping===yI?gt.image.height:null,lt=I[ae.type];ae.precision!==null&&(C=r.getMaxPrecision(ae.precision),C!==ae.precision&&console.warn("THREE.WebGLProgram.getParameters:",ae.precision,"not supported, using",C,"instead."));const pt=at.morphAttributes.position||at.morphAttributes.normal||at.morphAttributes.color,De=pt!==void 0?pt.length:0;let _t=0;at.morphAttributes.position!==void 0&&(_t=1),at.morphAttributes.normal!==void 0&&(_t=2),at.morphAttributes.color!==void 0&&(_t=3);let Jt,dt,Dt,gn;if(lt){const Zr=Yp[lt];Jt=Zr.vertexShader,dt=Zr.fragmentShader}else Jt=ae.vertexShader,dt=ae.fragmentShader,h.update(ae),Dt=h.getVertexShaderID(ae),gn=h.getFragmentShaderID(ae);const qt=o.getRenderTarget(),wn=o.state.buffers.depth.getReversed(),nr=je.isInstancedMesh===!0,qn=je.isBatchedMesh===!0,ni=!!ae.map,ai=!!ae.matcap,qr=!!gt,$e=!!ae.aoMap,Ls=!!ae.lightMap,li=!!ae.bumpMap,Ti=!!ae.normalMap,Ln=!!ae.displacementMap,Pr=!!ae.emissiveMap,sr=!!ae.metalnessMap,dr=!!ae.roughnessMap,mi=ae.anisotropy>0,Oe=ae.clearcoat>0,_e=ae.dispersion>0,Ct=ae.iridescence>0,Kt=ae.sheen>0,Zt=ae.transmission>0,jt=mi&&!!ae.anisotropyMap,or=Oe&&!!ae.clearcoatMap,An=Oe&&!!ae.clearcoatNormalMap,Gn=Oe&&!!ae.clearcoatRoughnessMap,ar=Ct&&!!ae.iridescenceMap,Qt=Ct&&!!ae.iridescenceThicknessMap,jn=Kt&&!!ae.sheenColorMap,Cr=Kt&&!!ae.sheenRoughnessMap,gr=!!ae.specularMap,Pn=!!ae.specularColorMap,wr=!!ae.specularIntensityMap,Ze=Zt&&!!ae.transmissionMap,Tn=Zt&&!!ae.thicknessMap,nn=!!ae.gradientMap,Nn=!!ae.alphaMap,ln=ae.alphaTest>0,en=!!ae.alphaHash,Xn=!!ae.extensions;let Sr=Jp;ae.toneMapped&&(qt===null||qt.isXRRenderTarget===!0)&&(Sr=o.toneMapping);const _i={shaderID:lt,shaderType:ae.type,shaderName:ae.name,vertexShader:Jt,fragmentShader:dt,defines:ae.defines,customVertexShaderID:Dt,customFragmentShaderID:gn,isRawShaderMaterial:ae.isRawShaderMaterial===!0,glslVersion:ae.glslVersion,precision:C,batching:qn,batchingColor:qn&&je._colorsTexture!==null,instancing:nr,instancingColor:nr&&je.instanceColor!==null,instancingMorph:nr&&je.morphTexture!==null,supportsVertexTextures:S,outputColorSpace:qt===null?o.outputColorSpace:qt.isXRRenderTarget===!0?qt.texture.colorSpace:df,alphaToCoverage:!!ae.alphaToCoverage,map:ni,matcap:ai,envMap:qr,envMapMode:qr&&gt.mapping,envMapCubeUVHeight:Ae,aoMap:$e,lightMap:Ls,bumpMap:li,normalMap:Ti,displacementMap:S&&Ln,emissiveMap:Pr,normalMapObjectSpace:Ti&&ae.normalMapType===lTe,normalMapTangentSpace:Ti&&ae.normalMapType===K_,metalnessMap:sr,roughnessMap:dr,anisotropy:mi,anisotropyMap:jt,clearcoat:Oe,clearcoatMap:or,clearcoatNormalMap:An,clearcoatRoughnessMap:Gn,dispersion:_e,iridescence:Ct,iridescenceMap:ar,iridescenceThicknessMap:Qt,sheen:Kt,sheenColorMap:jn,sheenRoughnessMap:Cr,specularMap:gr,specularColorMap:Pn,specularIntensityMap:wr,transmission:Zt,transmissionMap:Ze,thicknessMap:Tn,gradientMap:nn,opaque:ae.transparent===!1&&ae.blending===p6&&ae.alphaToCoverage===!1,alphaMap:Nn,alphaTest:ln,alphaHash:en,combine:ae.combine,mapUv:ni&&L(ae.map.channel),aoMapUv:$e&&L(ae.aoMap.channel),lightMapUv:Ls&&L(ae.lightMap.channel),bumpMapUv:li&&L(ae.bumpMap.channel),normalMapUv:Ti&&L(ae.normalMap.channel),displacementMapUv:Ln&&L(ae.displacementMap.channel),emissiveMapUv:Pr&&L(ae.emissiveMap.channel),metalnessMapUv:sr&&L(ae.metalnessMap.channel),roughnessMapUv:dr&&L(ae.roughnessMap.channel),anisotropyMapUv:jt&&L(ae.anisotropyMap.channel),clearcoatMapUv:or&&L(ae.clearcoatMap.channel),clearcoatNormalMapUv:An&&L(ae.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Gn&&L(ae.clearcoatRoughnessMap.channel),iridescenceMapUv:ar&&L(ae.iridescenceMap.channel),iridescenceThicknessMapUv:Qt&&L(ae.iridescenceThicknessMap.channel),sheenColorMapUv:jn&&L(ae.sheenColorMap.channel),sheenRoughnessMapUv:Cr&&L(ae.sheenRoughnessMap.channel),specularMapUv:gr&&L(ae.specularMap.channel),specularColorMapUv:Pn&&L(ae.specularColorMap.channel),specularIntensityMapUv:wr&&L(ae.specularIntensityMap.channel),transmissionMapUv:Ze&&L(ae.transmissionMap.channel),thicknessMapUv:Tn&&L(ae.thicknessMap.channel),alphaMapUv:Nn&&L(ae.alphaMap.channel),vertexTangents:!!at.attributes.tangent&&(Ti||mi),vertexColors:ae.vertexColors,vertexAlphas:ae.vertexColors===!0&&!!at.attributes.color&&at.attributes.color.itemSize===4,pointsUvs:je.isPoints===!0&&!!at.attributes.uv&&(ni||Nn),fog:!!rt,useFog:ae.fog===!0,fogExp2:!!rt&&rt.isFogExp2,flatShading:ae.flatShading===!0,sizeAttenuation:ae.sizeAttenuation===!0,logarithmicDepthBuffer:x,reverseDepthBuffer:wn,skinning:je.isSkinnedMesh===!0,morphTargets:at.morphAttributes.position!==void 0,morphNormals:at.morphAttributes.normal!==void 0,morphColors:at.morphAttributes.color!==void 0,morphTargetsCount:De,morphTextureStride:_t,numDirLights:le.directional.length,numPointLights:le.point.length,numSpotLights:le.spot.length,numSpotLightMaps:le.spotLightMap.length,numRectAreaLights:le.rectArea.length,numHemiLights:le.hemi.length,numDirLightShadows:le.directionalShadowMap.length,numPointLightShadows:le.pointShadowMap.length,numSpotLightShadows:le.spotShadowMap.length,numSpotLightShadowsWithMaps:le.numSpotLightShadowsWithMaps,numLightProbes:le.numLightProbes,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:ae.dithering,shadowMapEnabled:o.shadowMap.enabled&&J.length>0,shadowMapType:o.shadowMap.type,toneMapping:Sr,decodeVideoTexture:ni&&ae.map.isVideoTexture===!0&&Kr.getTransfer(ae.map.colorSpace)===ms,decodeVideoTextureEmissive:Pr&&ae.emissiveMap.isVideoTexture===!0&&Kr.getTransfer(ae.emissiveMap.colorSpace)===ms,premultipliedAlpha:ae.premultipliedAlpha,doubleSided:ae.side===wh,flipSided:ae.side===u0,useDepthPacking:ae.depthPacking>=0,depthPacking:ae.depthPacking||0,index0AttributeName:ae.index0AttributeName,extensionClipCullDistance:Xn&&ae.extensions.clipCullDistance===!0&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Xn&&ae.extensions.multiDraw===!0||qn)&&n.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:ae.customProgramCacheKey()};return _i.vertexUv1s=p.has(1),_i.vertexUv2s=p.has(2),_i.vertexUv3s=p.has(3),p.clear(),_i}function R(ae){const le=[];if(ae.shaderID?le.push(ae.shaderID):(le.push(ae.customVertexShaderID),le.push(ae.customFragmentShaderID)),ae.defines!==void 0)for(const J in ae.defines)le.push(J),le.push(ae.defines[J]);return ae.isRawShaderMaterial===!1&&($(le,ae),Z(le,ae),le.push(o.outputColorSpace)),le.push(ae.customProgramCacheKey),le.join()}function $(ae,le){ae.push(le.precision),ae.push(le.outputColorSpace),ae.push(le.envMapMode),ae.push(le.envMapCubeUVHeight),ae.push(le.mapUv),ae.push(le.alphaMapUv),ae.push(le.lightMapUv),ae.push(le.aoMapUv),ae.push(le.bumpMapUv),ae.push(le.normalMapUv),ae.push(le.displacementMapUv),ae.push(le.emissiveMapUv),ae.push(le.metalnessMapUv),ae.push(le.roughnessMapUv),ae.push(le.anisotropyMapUv),ae.push(le.clearcoatMapUv),ae.push(le.clearcoatNormalMapUv),ae.push(le.clearcoatRoughnessMapUv),ae.push(le.iridescenceMapUv),ae.push(le.iridescenceThicknessMapUv),ae.push(le.sheenColorMapUv),ae.push(le.sheenRoughnessMapUv),ae.push(le.specularMapUv),ae.push(le.specularColorMapUv),ae.push(le.specularIntensityMapUv),ae.push(le.transmissionMapUv),ae.push(le.thicknessMapUv),ae.push(le.combine),ae.push(le.fogExp2),ae.push(le.sizeAttenuation),ae.push(le.morphTargetsCount),ae.push(le.morphAttributeCount),ae.push(le.numDirLights),ae.push(le.numPointLights),ae.push(le.numSpotLights),ae.push(le.numSpotLightMaps),ae.push(le.numHemiLights),ae.push(le.numRectAreaLights),ae.push(le.numDirLightShadows),ae.push(le.numPointLightShadows),ae.push(le.numSpotLightShadows),ae.push(le.numSpotLightShadowsWithMaps),ae.push(le.numLightProbes),ae.push(le.shadowMapType),ae.push(le.toneMapping),ae.push(le.numClippingPlanes),ae.push(le.numClipIntersection),ae.push(le.depthPacking)}function Z(ae,le){c.disableAll(),le.supportsVertexTextures&&c.enable(0),le.instancing&&c.enable(1),le.instancingColor&&c.enable(2),le.instancingMorph&&c.enable(3),le.matcap&&c.enable(4),le.envMap&&c.enable(5),le.normalMapObjectSpace&&c.enable(6),le.normalMapTangentSpace&&c.enable(7),le.clearcoat&&c.enable(8),le.iridescence&&c.enable(9),le.alphaTest&&c.enable(10),le.vertexColors&&c.enable(11),le.vertexAlphas&&c.enable(12),le.vertexUv1s&&c.enable(13),le.vertexUv2s&&c.enable(14),le.vertexUv3s&&c.enable(15),le.vertexTangents&&c.enable(16),le.anisotropy&&c.enable(17),le.alphaHash&&c.enable(18),le.batching&&c.enable(19),le.dispersion&&c.enable(20),le.batchingColor&&c.enable(21),ae.push(c.mask),c.disableAll(),le.fog&&c.enable(0),le.useFog&&c.enable(1),le.flatShading&&c.enable(2),le.logarithmicDepthBuffer&&c.enable(3),le.reverseDepthBuffer&&c.enable(4),le.skinning&&c.enable(5),le.morphTargets&&c.enable(6),le.morphNormals&&c.enable(7),le.morphColors&&c.enable(8),le.premultipliedAlpha&&c.enable(9),le.shadowMapEnabled&&c.enable(10),le.doubleSided&&c.enable(11),le.flipSided&&c.enable(12),le.useDepthPacking&&c.enable(13),le.dithering&&c.enable(14),le.transmission&&c.enable(15),le.sheen&&c.enable(16),le.opaque&&c.enable(17),le.pointsUvs&&c.enable(18),le.decodeVideoTexture&&c.enable(19),le.decodeVideoTextureEmissive&&c.enable(20),le.alphaToCoverage&&c.enable(21),ae.push(c.mask)}function k(ae){const le=I[ae.type];let J;if(le){const Ue=Yp[le];J=nMe.clone(Ue.uniforms)}else J=ae.uniforms;return J}function ie(ae,le){let J;for(let Ue=0,je=v.length;Ue<je;Ue++){const rt=v[Ue];if(rt.cacheKey===le){J=rt,++J.usedTimes;break}}return J===void 0&&(J=new Pke(o,le,ae,i),v.push(J)),J}function ue(ae){if(--ae.usedTimes===0){const le=v.indexOf(ae);v[le]=v[v.length-1],v.pop(),ae.destroy()}}function ce(ae){h.remove(ae)}function Q(){h.dispose()}return{getParameters:U,getProgramCacheKey:R,getUniforms:k,acquireProgram:ie,releaseProgram:ue,releaseShaderCache:ce,programs:v,dispose:Q}}function Dke(){let o=new WeakMap;function e(a){return o.has(a)}function t(a){let c=o.get(a);return c===void 0&&(c={},o.set(a,c)),c}function n(a){o.delete(a)}function r(a,c,h){o.get(a)[c]=h}function i(){o=new WeakMap}return{has:e,get:t,remove:n,update:r,dispose:i}}function Oke(o,e){return o.groupOrder!==e.groupOrder?o.groupOrder-e.groupOrder:o.renderOrder!==e.renderOrder?o.renderOrder-e.renderOrder:o.material.id!==e.material.id?o.material.id-e.material.id:o.z!==e.z?o.z-e.z:o.id-e.id}function Z1e(o,e){return o.groupOrder!==e.groupOrder?o.groupOrder-e.groupOrder:o.renderOrder!==e.renderOrder?o.renderOrder-e.renderOrder:o.z!==e.z?e.z-o.z:o.id-e.id}function Q1e(){const o=[];let e=0;const t=[],n=[],r=[];function i(){e=0,t.length=0,n.length=0,r.length=0}function a(x,S,C,I,L,U){let R=o[e];return R===void 0?(R={id:x.id,object:x,geometry:S,material:C,groupOrder:I,renderOrder:x.renderOrder,z:L,group:U},o[e]=R):(R.id=x.id,R.object=x,R.geometry=S,R.material=C,R.groupOrder=I,R.renderOrder=x.renderOrder,R.z=L,R.group=U),e++,R}function c(x,S,C,I,L,U){const R=a(x,S,C,I,L,U);C.transmission>0?n.push(R):C.transparent===!0?r.push(R):t.push(R)}function h(x,S,C,I,L,U){const R=a(x,S,C,I,L,U);C.transmission>0?n.unshift(R):C.transparent===!0?r.unshift(R):t.unshift(R)}function p(x,S){t.length>1&&t.sort(x||Oke),n.length>1&&n.sort(S||Z1e),r.length>1&&r.sort(S||Z1e)}function v(){for(let x=e,S=o.length;x<S;x++){const C=o[x];if(C.id===null)break;C.id=null,C.object=null,C.geometry=null,C.material=null,C.group=null}}return{opaque:t,transmissive:n,transparent:r,init:i,push:c,unshift:h,finish:v,sort:p}}function Fke(){let o=new WeakMap;function e(n,r){const i=o.get(n);let a;return i===void 0?(a=new Q1e,o.set(n,[a])):r>=i.length?(a=new Q1e,i.push(a)):a=i[r],a}function t(){o=new WeakMap}return{get:e,dispose:t}}function Lke(){const o={};return{get:function(e){if(o[e.id]!==void 0)return o[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new Ie,color:new Vn};break;case"SpotLight":t={position:new Ie,direction:new Ie,color:new Vn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new Ie,color:new Vn,distance:0,decay:0};break;case"HemisphereLight":t={direction:new Ie,skyColor:new Vn,groundColor:new Vn};break;case"RectAreaLight":t={color:new Vn,position:new Ie,halfWidth:new Ie,halfHeight:new Ie};break}return o[e.id]=t,t}}}function Bke(){const o={};return{get:function(e){if(o[e.id]!==void 0)return o[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new mr};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new mr};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new mr,shadowCameraNear:1,shadowCameraFar:1e3};break}return o[e.id]=t,t}}}let Uke=0;function zke(o,e){return(e.castShadow?2:0)-(o.castShadow?2:0)+(e.map?1:0)-(o.map?1:0)}function Vke(o){const e=new Lke,t=Bke(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let p=0;p<9;p++)n.probe.push(new Ie);const r=new Ie,i=new vr,a=new vr;function c(p){let v=0,x=0,S=0;for(let ae=0;ae<9;ae++)n.probe[ae].set(0,0,0);let C=0,I=0,L=0,U=0,R=0,$=0,Z=0,k=0,ie=0,ue=0,ce=0;p.sort(zke);for(let ae=0,le=p.length;ae<le;ae++){const J=p[ae],Ue=J.color,je=J.intensity,rt=J.distance,at=J.shadow&&J.shadow.map?J.shadow.map.texture:null;if(J.isAmbientLight)v+=Ue.r*je,x+=Ue.g*je,S+=Ue.b*je;else if(J.isLightProbe){for(let Se=0;Se<9;Se++)n.probe[Se].addScaledVector(J.sh.coefficients[Se],je);ce++}else if(J.isDirectionalLight){const Se=e.get(J);if(Se.color.copy(J.color).multiplyScalar(J.intensity),J.castShadow){const gt=J.shadow,Ae=t.get(J);Ae.shadowIntensity=gt.intensity,Ae.shadowBias=gt.bias,Ae.shadowNormalBias=gt.normalBias,Ae.shadowRadius=gt.radius,Ae.shadowMapSize=gt.mapSize,n.directionalShadow[C]=Ae,n.directionalShadowMap[C]=at,n.directionalShadowMatrix[C]=J.shadow.matrix,$++}n.directional[C]=Se,C++}else if(J.isSpotLight){const Se=e.get(J);Se.position.setFromMatrixPosition(J.matrixWorld),Se.color.copy(Ue).multiplyScalar(je),Se.distance=rt,Se.coneCos=Math.cos(J.angle),Se.penumbraCos=Math.cos(J.angle*(1-J.penumbra)),Se.decay=J.decay,n.spot[L]=Se;const gt=J.shadow;if(J.map&&(n.spotLightMap[ie]=J.map,ie++,gt.updateMatrices(J),J.castShadow&&ue++),n.spotLightMatrix[L]=gt.matrix,J.castShadow){const Ae=t.get(J);Ae.shadowIntensity=gt.intensity,Ae.shadowBias=gt.bias,Ae.shadowNormalBias=gt.normalBias,Ae.shadowRadius=gt.radius,Ae.shadowMapSize=gt.mapSize,n.spotShadow[L]=Ae,n.spotShadowMap[L]=at,k++}L++}else if(J.isRectAreaLight){const Se=e.get(J);Se.color.copy(Ue).multiplyScalar(je),Se.halfWidth.set(J.width*.5,0,0),Se.halfHeight.set(0,J.height*.5,0),n.rectArea[U]=Se,U++}else if(J.isPointLight){const Se=e.get(J);if(Se.color.copy(J.color).multiplyScalar(J.intensity),Se.distance=J.distance,Se.decay=J.decay,J.castShadow){const gt=J.shadow,Ae=t.get(J);Ae.shadowIntensity=gt.intensity,Ae.shadowBias=gt.bias,Ae.shadowNormalBias=gt.normalBias,Ae.shadowRadius=gt.radius,Ae.shadowMapSize=gt.mapSize,Ae.shadowCameraNear=gt.camera.near,Ae.shadowCameraFar=gt.camera.far,n.pointShadow[I]=Ae,n.pointShadowMap[I]=at,n.pointShadowMatrix[I]=J.shadow.matrix,Z++}n.point[I]=Se,I++}else if(J.isHemisphereLight){const Se=e.get(J);Se.skyColor.copy(J.color).multiplyScalar(je),Se.groundColor.copy(J.groundColor).multiplyScalar(je),n.hemi[R]=Se,R++}}U>0&&(o.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=Bn.LTC_FLOAT_1,n.rectAreaLTC2=Bn.LTC_FLOAT_2):(n.rectAreaLTC1=Bn.LTC_HALF_1,n.rectAreaLTC2=Bn.LTC_HALF_2)),n.ambient[0]=v,n.ambient[1]=x,n.ambient[2]=S;const Q=n.hash;(Q.directionalLength!==C||Q.pointLength!==I||Q.spotLength!==L||Q.rectAreaLength!==U||Q.hemiLength!==R||Q.numDirectionalShadows!==$||Q.numPointShadows!==Z||Q.numSpotShadows!==k||Q.numSpotMaps!==ie||Q.numLightProbes!==ce)&&(n.directional.length=C,n.spot.length=L,n.rectArea.length=U,n.point.length=I,n.hemi.length=R,n.directionalShadow.length=$,n.directionalShadowMap.length=$,n.pointShadow.length=Z,n.pointShadowMap.length=Z,n.spotShadow.length=k,n.spotShadowMap.length=k,n.directionalShadowMatrix.length=$,n.pointShadowMatrix.length=Z,n.spotLightMatrix.length=k+ie-ue,n.spotLightMap.length=ie,n.numSpotLightShadowsWithMaps=ue,n.numLightProbes=ce,Q.directionalLength=C,Q.pointLength=I,Q.spotLength=L,Q.rectAreaLength=U,Q.hemiLength=R,Q.numDirectionalShadows=$,Q.numPointShadows=Z,Q.numSpotShadows=k,Q.numSpotMaps=ie,Q.numLightProbes=ce,n.version=Uke++)}function h(p,v){let x=0,S=0,C=0,I=0,L=0;const U=v.matrixWorldInverse;for(let R=0,$=p.length;R<$;R++){const Z=p[R];if(Z.isDirectionalLight){const k=n.directional[x];k.direction.setFromMatrixPosition(Z.matrixWorld),r.setFromMatrixPosition(Z.target.matrixWorld),k.direction.sub(r),k.direction.transformDirection(U),x++}else if(Z.isSpotLight){const k=n.spot[C];k.position.setFromMatrixPosition(Z.matrixWorld),k.position.applyMatrix4(U),k.direction.setFromMatrixPosition(Z.matrixWorld),r.setFromMatrixPosition(Z.target.matrixWorld),k.direction.sub(r),k.direction.transformDirection(U),C++}else if(Z.isRectAreaLight){const k=n.rectArea[I];k.position.setFromMatrixPosition(Z.matrixWorld),k.position.applyMatrix4(U),a.identity(),i.copy(Z.matrixWorld),i.premultiply(U),a.extractRotation(i),k.halfWidth.set(Z.width*.5,0,0),k.halfHeight.set(0,Z.height*.5,0),k.halfWidth.applyMatrix4(a),k.halfHeight.applyMatrix4(a),I++}else if(Z.isPointLight){const k=n.point[S];k.position.setFromMatrixPosition(Z.matrixWorld),k.position.applyMatrix4(U),S++}else if(Z.isHemisphereLight){const k=n.hemi[L];k.direction.setFromMatrixPosition(Z.matrixWorld),k.direction.transformDirection(U),L++}}}return{setup:c,setupView:h,state:n}}function J1e(o){const e=new Vke(o),t=[],n=[];function r(v){p.camera=v,t.length=0,n.length=0}function i(v){t.push(v)}function a(v){n.push(v)}function c(){e.setup(t)}function h(v){e.setupView(t,v)}const p={lightsArray:t,shadowsArray:n,camera:null,lights:e,transmissionRenderTarget:{}};return{init:r,state:p,setupLights:c,setupLightsView:h,pushLight:i,pushShadow:a}}function Gke(o){let e=new WeakMap;function t(r,i=0){const a=e.get(r);let c;return a===void 0?(c=new J1e(o),e.set(r,[c])):i>=a.length?(c=new J1e(o),a.push(c)):c=a[i],c}function n(){e=new WeakMap}return{get:t,dispose:n}}const jke=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,Hke=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function Wke(o,e,t){let n=new OH;const r=new mr,i=new mr,a=new Pi,c=new B9e({depthPacking:aTe}),h=new NMe,p={},v=t.maxTextureSize,x={[Rg]:u0,[u0]:Rg,[wh]:wh},S=new ff({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new mr},radius:{value:4}},vertexShader:jke,fragmentShader:Hke}),C=S.clone();C.defines.HORIZONTAL_PASS=1;const I=new _s;I.setAttribute("position",new hf(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const L=new Mn(I,S),U=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=$2e;let R=this.type;this.render=function(ue,ce,Q){if(U.enabled===!1||U.autoUpdate===!1&&U.needsUpdate===!1||ue.length===0)return;const ae=o.getRenderTarget(),le=o.getActiveCubeFace(),J=o.getActiveMipmapLevel(),Ue=o.state;Ue.setBlending(xg),Ue.buffers.color.setClear(1,1,1,1),Ue.buffers.depth.setTest(!0),Ue.setScissorTest(!1);const je=R!==fg&&this.type===fg,rt=R===fg&&this.type!==fg;for(let at=0,Se=ue.length;at<Se;at++){const gt=ue[at],Ae=gt.shadow;if(Ae===void 0){console.warn("THREE.WebGLShadowMap:",gt,"has no shadow.");continue}if(Ae.autoUpdate===!1&&Ae.needsUpdate===!1)continue;r.copy(Ae.mapSize);const lt=Ae.getFrameExtents();if(r.multiply(lt),i.copy(Ae.mapSize),(r.x>v||r.y>v)&&(r.x>v&&(i.x=Math.floor(v/lt.x),r.x=i.x*lt.x,Ae.mapSize.x=i.x),r.y>v&&(i.y=Math.floor(v/lt.y),r.y=i.y*lt.y,Ae.mapSize.y=i.y)),Ae.map===null||je===!0||rt===!0){const De=this.type!==fg?{minFilter:c0,magFilter:c0}:{};Ae.map!==null&&Ae.map.dispose(),Ae.map=new _6(r.x,r.y,De),Ae.map.texture.name=gt.name+".shadowMap",Ae.camera.updateProjectionMatrix()}o.setRenderTarget(Ae.map),o.clear();const pt=Ae.getViewportCount();for(let De=0;De<pt;De++){const _t=Ae.getViewport(De);a.set(i.x*_t.x,i.y*_t.y,i.x*_t.z,i.y*_t.w),Ue.viewport(a),Ae.updateMatrices(gt,De),n=Ae.getFrustum(),k(ce,Q,Ae.camera,gt,this.type)}Ae.isPointLightShadow!==!0&&this.type===fg&&$(Ae,Q),Ae.needsUpdate=!1}R=this.type,U.needsUpdate=!1,o.setRenderTarget(ae,le,J)};function $(ue,ce){const Q=e.update(L);S.defines.VSM_SAMPLES!==ue.blurSamples&&(S.defines.VSM_SAMPLES=ue.blurSamples,C.defines.VSM_SAMPLES=ue.blurSamples,S.needsUpdate=!0,C.needsUpdate=!0),ue.mapPass===null&&(ue.mapPass=new _6(r.x,r.y)),S.uniforms.shadow_pass.value=ue.map.texture,S.uniforms.resolution.value=ue.mapSize,S.uniforms.radius.value=ue.radius,o.setRenderTarget(ue.mapPass),o.clear(),o.renderBufferDirect(ce,null,Q,S,L,null),C.uniforms.shadow_pass.value=ue.mapPass.texture,C.uniforms.resolution.value=ue.mapSize,C.uniforms.radius.value=ue.radius,o.setRenderTarget(ue.map),o.clear(),o.renderBufferDirect(ce,null,Q,C,L,null)}function Z(ue,ce,Q,ae){let le=null;const J=Q.isPointLight===!0?ue.customDistanceMaterial:ue.customDepthMaterial;if(J!==void 0)le=J;else if(le=Q.isPointLight===!0?h:c,o.localClippingEnabled&&ce.clipShadows===!0&&Array.isArray(ce.clippingPlanes)&&ce.clippingPlanes.length!==0||ce.displacementMap&&ce.displacementScale!==0||ce.alphaMap&&ce.alphaTest>0||ce.map&&ce.alphaTest>0||ce.alphaToCoverage===!0){const Ue=le.uuid,je=ce.uuid;let rt=p[Ue];rt===void 0&&(rt={},p[Ue]=rt);let at=rt[je];at===void 0&&(at=le.clone(),rt[je]=at,ce.addEventListener("dispose",ie)),le=at}if(le.visible=ce.visible,le.wireframe=ce.wireframe,ae===fg?le.side=ce.shadowSide!==null?ce.shadowSide:ce.side:le.side=ce.shadowSide!==null?ce.shadowSide:x[ce.side],le.alphaMap=ce.alphaMap,le.alphaTest=ce.alphaToCoverage===!0?.5:ce.alphaTest,le.map=ce.map,le.clipShadows=ce.clipShadows,le.clippingPlanes=ce.clippingPlanes,le.clipIntersection=ce.clipIntersection,le.displacementMap=ce.displacementMap,le.displacementScale=ce.displacementScale,le.displacementBias=ce.displacementBias,le.wireframeLinewidth=ce.wireframeLinewidth,le.linewidth=ce.linewidth,Q.isPointLight===!0&&le.isMeshDistanceMaterial===!0){const Ue=o.properties.get(le);Ue.light=Q}return le}function k(ue,ce,Q,ae,le){if(ue.visible===!1)return;if(ue.layers.test(ce.layers)&&(ue.isMesh||ue.isLine||ue.isPoints)&&(ue.castShadow||ue.receiveShadow&&le===fg)&&(!ue.frustumCulled||n.intersectsObject(ue))){ue.modelViewMatrix.multiplyMatrices(Q.matrixWorldInverse,ue.matrixWorld);const je=e.update(ue),rt=ue.material;if(Array.isArray(rt)){const at=je.groups;for(let Se=0,gt=at.length;Se<gt;Se++){const Ae=at[Se],lt=rt[Ae.materialIndex];if(lt&&lt.visible){const pt=Z(ue,lt,ae,le);ue.onBeforeShadow(o,ue,ce,Q,je,pt,Ae),o.renderBufferDirect(Q,null,je,pt,ue,Ae),ue.onAfterShadow(o,ue,ce,Q,je,pt,Ae)}}}else if(rt.visible){const at=Z(ue,rt,ae,le);ue.onBeforeShadow(o,ue,ce,Q,je,at,null),o.renderBufferDirect(Q,null,je,at,ue,null),ue.onAfterShadow(o,ue,ce,Q,je,at,null)}}const Ue=ue.children;for(let je=0,rt=Ue.length;je<rt;je++)k(Ue[je],ce,Q,ae,le)}function ie(ue){ue.target.removeEventListener("dispose",ie);for(const Q in p){const ae=p[Q],le=ue.target.uuid;le in ae&&(ae[le].dispose(),delete ae[le])}}}const $ke={[CG]:AG,[PG]:IG,[RG]:NG,[k_]:kG,[AG]:CG,[IG]:PG,[NG]:RG,[kG]:k_};function qke(o,e){function t(){let Ze=!1;const Tn=new Pi;let nn=null;const Nn=new Pi(0,0,0,0);return{setMask:function(ln){nn!==ln&&!Ze&&(o.colorMask(ln,ln,ln,ln),nn=ln)},setLocked:function(ln){Ze=ln},setClear:function(ln,en,Xn,Sr,_i){_i===!0&&(ln*=Sr,en*=Sr,Xn*=Sr),Tn.set(ln,en,Xn,Sr),Nn.equals(Tn)===!1&&(o.clearColor(ln,en,Xn,Sr),Nn.copy(Tn))},reset:function(){Ze=!1,nn=null,Nn.set(-1,0,0,0)}}}function n(){let Ze=!1,Tn=!1,nn=null,Nn=null,ln=null;return{setReversed:function(en){if(Tn!==en){const Xn=e.get("EXT_clip_control");en?Xn.clipControlEXT(Xn.LOWER_LEFT_EXT,Xn.ZERO_TO_ONE_EXT):Xn.clipControlEXT(Xn.LOWER_LEFT_EXT,Xn.NEGATIVE_ONE_TO_ONE_EXT),Tn=en;const Sr=ln;ln=null,this.setClear(Sr)}},getReversed:function(){return Tn},setTest:function(en){en?qt(o.DEPTH_TEST):wn(o.DEPTH_TEST)},setMask:function(en){nn!==en&&!Ze&&(o.depthMask(en),nn=en)},setFunc:function(en){if(Tn&&(en=$ke[en]),Nn!==en){switch(en){case CG:o.depthFunc(o.NEVER);break;case AG:o.depthFunc(o.ALWAYS);break;case PG:o.depthFunc(o.LESS);break;case k_:o.depthFunc(o.LEQUAL);break;case RG:o.depthFunc(o.EQUAL);break;case kG:o.depthFunc(o.GEQUAL);break;case IG:o.depthFunc(o.GREATER);break;case NG:o.depthFunc(o.NOTEQUAL);break;default:o.depthFunc(o.LEQUAL)}Nn=en}},setLocked:function(en){Ze=en},setClear:function(en){ln!==en&&(Tn&&(en=1-en),o.clearDepth(en),ln=en)},reset:function(){Ze=!1,nn=null,Nn=null,ln=null,Tn=!1}}}function r(){let Ze=!1,Tn=null,nn=null,Nn=null,ln=null,en=null,Xn=null,Sr=null,_i=null;return{setTest:function(Zr){Ze||(Zr?qt(o.STENCIL_TEST):wn(o.STENCIL_TEST))},setMask:function(Zr){Tn!==Zr&&!Ze&&(o.stencilMask(Zr),Tn=Zr)},setFunc:function(Zr,Bs,so){(nn!==Zr||Nn!==Bs||ln!==so)&&(o.stencilFunc(Zr,Bs,so),nn=Zr,Nn=Bs,ln=so)},setOp:function(Zr,Bs,so){(en!==Zr||Xn!==Bs||Sr!==so)&&(o.stencilOp(Zr,Bs,so),en=Zr,Xn=Bs,Sr=so)},setLocked:function(Zr){Ze=Zr},setClear:function(Zr){_i!==Zr&&(o.clearStencil(Zr),_i=Zr)},reset:function(){Ze=!1,Tn=null,nn=null,Nn=null,ln=null,en=null,Xn=null,Sr=null,_i=null}}}const i=new t,a=new n,c=new r,h=new WeakMap,p=new WeakMap;let v={},x={},S=new WeakMap,C=[],I=null,L=!1,U=null,R=null,$=null,Z=null,k=null,ie=null,ue=null,ce=new Vn(0,0,0),Q=0,ae=!1,le=null,J=null,Ue=null,je=null,rt=null;const at=o.getParameter(o.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let Se=!1,gt=0;const Ae=o.getParameter(o.VERSION);Ae.indexOf("WebGL")!==-1?(gt=parseFloat(/^WebGL (\d)/.exec(Ae)[1]),Se=gt>=1):Ae.indexOf("OpenGL ES")!==-1&&(gt=parseFloat(/^OpenGL ES (\d)/.exec(Ae)[1]),Se=gt>=2);let lt=null,pt={};const De=o.getParameter(o.SCISSOR_BOX),_t=o.getParameter(o.VIEWPORT),Jt=new Pi().fromArray(De),dt=new Pi().fromArray(_t);function Dt(Ze,Tn,nn,Nn){const ln=new Uint8Array(4),en=o.createTexture();o.bindTexture(Ze,en),o.texParameteri(Ze,o.TEXTURE_MIN_FILTER,o.NEAREST),o.texParameteri(Ze,o.TEXTURE_MAG_FILTER,o.NEAREST);for(let Xn=0;Xn<nn;Xn++)Ze===o.TEXTURE_3D||Ze===o.TEXTURE_2D_ARRAY?o.texImage3D(Tn,0,o.RGBA,1,1,Nn,0,o.RGBA,o.UNSIGNED_BYTE,ln):o.texImage2D(Tn+Xn,0,o.RGBA,1,1,0,o.RGBA,o.UNSIGNED_BYTE,ln);return en}const gn={};gn[o.TEXTURE_2D]=Dt(o.TEXTURE_2D,o.TEXTURE_2D,1),gn[o.TEXTURE_CUBE_MAP]=Dt(o.TEXTURE_CUBE_MAP,o.TEXTURE_CUBE_MAP_POSITIVE_X,6),gn[o.TEXTURE_2D_ARRAY]=Dt(o.TEXTURE_2D_ARRAY,o.TEXTURE_2D_ARRAY,1,1),gn[o.TEXTURE_3D]=Dt(o.TEXTURE_3D,o.TEXTURE_3D,1,1),i.setClear(0,0,0,1),a.setClear(1),c.setClear(0),qt(o.DEPTH_TEST),a.setFunc(k_),li(!1),Ti(kpe),qt(o.CULL_FACE),$e(xg);function qt(Ze){v[Ze]!==!0&&(o.enable(Ze),v[Ze]=!0)}function wn(Ze){v[Ze]!==!1&&(o.disable(Ze),v[Ze]=!1)}function nr(Ze,Tn){return x[Ze]!==Tn?(o.bindFramebuffer(Ze,Tn),x[Ze]=Tn,Ze===o.DRAW_FRAMEBUFFER&&(x[o.FRAMEBUFFER]=Tn),Ze===o.FRAMEBUFFER&&(x[o.DRAW_FRAMEBUFFER]=Tn),!0):!1}function qn(Ze,Tn){let nn=C,Nn=!1;if(Ze){nn=S.get(Tn),nn===void 0&&(nn=[],S.set(Tn,nn));const ln=Ze.textures;if(nn.length!==ln.length||nn[0]!==o.COLOR_ATTACHMENT0){for(let en=0,Xn=ln.length;en<Xn;en++)nn[en]=o.COLOR_ATTACHMENT0+en;nn.length=ln.length,Nn=!0}}else nn[0]!==o.BACK&&(nn[0]=o.BACK,Nn=!0);Nn&&o.drawBuffers(nn)}function ni(Ze){return I!==Ze?(o.useProgram(Ze),I=Ze,!0):!1}const ai={[V3]:o.FUNC_ADD,[X2e]:o.FUNC_SUBTRACT,[Y2e]:o.FUNC_REVERSE_SUBTRACT};ai[K2e]=o.MIN,ai[Z2e]=o.MAX;const qr={[aH]:o.ZERO,[lH]:o.ONE,[cH]:o.SRC_COLOR,[hE]:o.SRC_ALPHA,[Q2e]:o.SRC_ALPHA_SATURATE,[fH]:o.DST_COLOR,[hH]:o.DST_ALPHA,[uH]:o.ONE_MINUS_SRC_COLOR,[dE]:o.ONE_MINUS_SRC_ALPHA,[pH]:o.ONE_MINUS_DST_COLOR,[dH]:o.ONE_MINUS_DST_ALPHA,[mH]:o.CONSTANT_COLOR,[gH]:o.ONE_MINUS_CONSTANT_COLOR,[yH]:o.CONSTANT_ALPHA,[vH]:o.ONE_MINUS_CONSTANT_ALPHA};function $e(Ze,Tn,nn,Nn,ln,en,Xn,Sr,_i,Zr){if(Ze===xg){L===!0&&(wn(o.BLEND),L=!1);return}if(L===!1&&(qt(o.BLEND),L=!0),Ze!==q2e){if(Ze!==U||Zr!==ae){if((R!==V3||k!==V3)&&(o.blendEquation(o.FUNC_ADD),R=V3,k=V3),Zr)switch(Ze){case p6:o.blendFuncSeparate(o.ONE,o.ONE_MINUS_SRC_ALPHA,o.ONE,o.ONE_MINUS_SRC_ALPHA);break;case EG:o.blendFunc(o.ONE,o.ONE);break;case TG:o.blendFuncSeparate(o.ZERO,o.ONE_MINUS_SRC_COLOR,o.ZERO,o.ONE);break;case MG:o.blendFuncSeparate(o.ZERO,o.SRC_COLOR,o.ZERO,o.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",Ze);break}else switch(Ze){case p6:o.blendFuncSeparate(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA,o.ONE,o.ONE_MINUS_SRC_ALPHA);break;case EG:o.blendFunc(o.SRC_ALPHA,o.ONE);break;case TG:o.blendFuncSeparate(o.ZERO,o.ONE_MINUS_SRC_COLOR,o.ZERO,o.ONE);break;case MG:o.blendFunc(o.ZERO,o.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",Ze);break}$=null,Z=null,ie=null,ue=null,ce.set(0,0,0),Q=0,U=Ze,ae=Zr}return}ln=ln||Tn,en=en||nn,Xn=Xn||Nn,(Tn!==R||ln!==k)&&(o.blendEquationSeparate(ai[Tn],ai[ln]),R=Tn,k=ln),(nn!==$||Nn!==Z||en!==ie||Xn!==ue)&&(o.blendFuncSeparate(qr[nn],qr[Nn],qr[en],qr[Xn]),$=nn,Z=Nn,ie=en,ue=Xn),(Sr.equals(ce)===!1||_i!==Q)&&(o.blendColor(Sr.r,Sr.g,Sr.b,_i),ce.copy(Sr),Q=_i),U=Ze,ae=!1}function Ls(Ze,Tn){Ze.side===wh?wn(o.CULL_FACE):qt(o.CULL_FACE);let nn=Ze.side===u0;Tn&&(nn=!nn),li(nn),Ze.blending===p6&&Ze.transparent===!1?$e(xg):$e(Ze.blending,Ze.blendEquation,Ze.blendSrc,Ze.blendDst,Ze.blendEquationAlpha,Ze.blendSrcAlpha,Ze.blendDstAlpha,Ze.blendColor,Ze.blendAlpha,Ze.premultipliedAlpha),a.setFunc(Ze.depthFunc),a.setTest(Ze.depthTest),a.setMask(Ze.depthWrite),i.setMask(Ze.colorWrite);const Nn=Ze.stencilWrite;c.setTest(Nn),Nn&&(c.setMask(Ze.stencilWriteMask),c.setFunc(Ze.stencilFunc,Ze.stencilRef,Ze.stencilFuncMask),c.setOp(Ze.stencilFail,Ze.stencilZFail,Ze.stencilZPass)),Pr(Ze.polygonOffset,Ze.polygonOffsetFactor,Ze.polygonOffsetUnits),Ze.alphaToCoverage===!0?qt(o.SAMPLE_ALPHA_TO_COVERAGE):wn(o.SAMPLE_ALPHA_TO_COVERAGE)}function li(Ze){le!==Ze&&(Ze?o.frontFace(o.CW):o.frontFace(o.CCW),le=Ze)}function Ti(Ze){Ze!==YEe?(qt(o.CULL_FACE),Ze!==J&&(Ze===kpe?o.cullFace(o.BACK):Ze===KEe?o.cullFace(o.FRONT):o.cullFace(o.FRONT_AND_BACK))):wn(o.CULL_FACE),J=Ze}function Ln(Ze){Ze!==Ue&&(Se&&o.lineWidth(Ze),Ue=Ze)}function Pr(Ze,Tn,nn){Ze?(qt(o.POLYGON_OFFSET_FILL),(je!==Tn||rt!==nn)&&(o.polygonOffset(Tn,nn),je=Tn,rt=nn)):wn(o.POLYGON_OFFSET_FILL)}function sr(Ze){Ze?qt(o.SCISSOR_TEST):wn(o.SCISSOR_TEST)}function dr(Ze){Ze===void 0&&(Ze=o.TEXTURE0+at-1),lt!==Ze&&(o.activeTexture(Ze),lt=Ze)}function mi(Ze,Tn,nn){nn===void 0&&(lt===null?nn=o.TEXTURE0+at-1:nn=lt);let Nn=pt[nn];Nn===void 0&&(Nn={type:void 0,texture:void 0},pt[nn]=Nn),(Nn.type!==Ze||Nn.texture!==Tn)&&(lt!==nn&&(o.activeTexture(nn),lt=nn),o.bindTexture(Ze,Tn||gn[Ze]),Nn.type=Ze,Nn.texture=Tn)}function Oe(){const Ze=pt[lt];Ze!==void 0&&Ze.type!==void 0&&(o.bindTexture(Ze.type,null),Ze.type=void 0,Ze.texture=void 0)}function _e(){try{o.compressedTexImage2D(...arguments)}catch(Ze){console.error("THREE.WebGLState:",Ze)}}function Ct(){try{o.compressedTexImage3D(...arguments)}catch(Ze){console.error("THREE.WebGLState:",Ze)}}function Kt(){try{o.texSubImage2D(...arguments)}catch(Ze){console.error("THREE.WebGLState:",Ze)}}function Zt(){try{o.texSubImage3D(...arguments)}catch(Ze){console.error("THREE.WebGLState:",Ze)}}function jt(){try{o.compressedTexSubImage2D(...arguments)}catch(Ze){console.error("THREE.WebGLState:",Ze)}}function or(){try{o.compressedTexSubImage3D(...arguments)}catch(Ze){console.error("THREE.WebGLState:",Ze)}}function An(){try{o.texStorage2D(...arguments)}catch(Ze){console.error("THREE.WebGLState:",Ze)}}function Gn(){try{o.texStorage3D(...arguments)}catch(Ze){console.error("THREE.WebGLState:",Ze)}}function ar(){try{o.texImage2D(...arguments)}catch(Ze){console.error("THREE.WebGLState:",Ze)}}function Qt(){try{o.texImage3D(...arguments)}catch(Ze){console.error("THREE.WebGLState:",Ze)}}function jn(Ze){Jt.equals(Ze)===!1&&(o.scissor(Ze.x,Ze.y,Ze.z,Ze.w),Jt.copy(Ze))}function Cr(Ze){dt.equals(Ze)===!1&&(o.viewport(Ze.x,Ze.y,Ze.z,Ze.w),dt.copy(Ze))}function gr(Ze,Tn){let nn=p.get(Tn);nn===void 0&&(nn=new WeakMap,p.set(Tn,nn));let Nn=nn.get(Ze);Nn===void 0&&(Nn=o.getUniformBlockIndex(Tn,Ze.name),nn.set(Ze,Nn))}function Pn(Ze,Tn){const Nn=p.get(Tn).get(Ze);h.get(Tn)!==Nn&&(o.uniformBlockBinding(Tn,Nn,Ze.__bindingPointIndex),h.set(Tn,Nn))}function wr(){o.disable(o.BLEND),o.disable(o.CULL_FACE),o.disable(o.DEPTH_TEST),o.disable(o.POLYGON_OFFSET_FILL),o.disable(o.SCISSOR_TEST),o.disable(o.STENCIL_TEST),o.disable(o.SAMPLE_ALPHA_TO_COVERAGE),o.blendEquation(o.FUNC_ADD),o.blendFunc(o.ONE,o.ZERO),o.blendFuncSeparate(o.ONE,o.ZERO,o.ONE,o.ZERO),o.blendColor(0,0,0,0),o.colorMask(!0,!0,!0,!0),o.clearColor(0,0,0,0),o.depthMask(!0),o.depthFunc(o.LESS),a.setReversed(!1),o.clearDepth(1),o.stencilMask(4294967295),o.stencilFunc(o.ALWAYS,0,4294967295),o.stencilOp(o.KEEP,o.KEEP,o.KEEP),o.clearStencil(0),o.cullFace(o.BACK),o.frontFace(o.CCW),o.polygonOffset(0,0),o.activeTexture(o.TEXTURE0),o.bindFramebuffer(o.FRAMEBUFFER,null),o.bindFramebuffer(o.DRAW_FRAMEBUFFER,null),o.bindFramebuffer(o.READ_FRAMEBUFFER,null),o.useProgram(null),o.lineWidth(1),o.scissor(0,0,o.canvas.width,o.canvas.height),o.viewport(0,0,o.canvas.width,o.canvas.height),v={},lt=null,pt={},x={},S=new WeakMap,C=[],I=null,L=!1,U=null,R=null,$=null,Z=null,k=null,ie=null,ue=null,ce=new Vn(0,0,0),Q=0,ae=!1,le=null,J=null,Ue=null,je=null,rt=null,Jt.set(0,0,o.canvas.width,o.canvas.height),dt.set(0,0,o.canvas.width,o.canvas.height),i.reset(),a.reset(),c.reset()}return{buffers:{color:i,depth:a,stencil:c},enable:qt,disable:wn,bindFramebuffer:nr,drawBuffers:qn,useProgram:ni,setBlending:$e,setMaterial:Ls,setFlipSided:li,setCullFace:Ti,setLineWidth:Ln,setPolygonOffset:Pr,setScissorTest:sr,activeTexture:dr,bindTexture:mi,unbindTexture:Oe,compressedTexImage2D:_e,compressedTexImage3D:Ct,texImage2D:ar,texImage3D:Qt,updateUBOMapping:gr,uniformBlockBinding:Pn,texStorage2D:An,texStorage3D:Gn,texSubImage2D:Kt,texSubImage3D:Zt,compressedTexSubImage2D:jt,compressedTexSubImage3D:or,scissor:jn,viewport:Cr,reset:wr}}function Xke(o,e,t,n,r,i,a){const c=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,h=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),p=new mr,v=new WeakMap;let x;const S=new WeakMap;let C=!1;try{C=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function I(Oe,_e){return C?new OffscreenCanvas(Oe,_e):yE("canvas")}function L(Oe,_e,Ct){let Kt=1;const Zt=mi(Oe);if((Zt.width>Ct||Zt.height>Ct)&&(Kt=Ct/Math.max(Zt.width,Zt.height)),Kt<1)if(typeof HTMLImageElement<"u"&&Oe instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Oe instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Oe instanceof ImageBitmap||typeof VideoFrame<"u"&&Oe instanceof VideoFrame){const jt=Math.floor(Kt*Zt.width),or=Math.floor(Kt*Zt.height);x===void 0&&(x=I(jt,or));const An=_e?I(jt,or):x;return An.width=jt,An.height=or,An.getContext("2d").drawImage(Oe,0,0,jt,or),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Zt.width+"x"+Zt.height+") to ("+jt+"x"+or+")."),An}else return"data"in Oe&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Zt.width+"x"+Zt.height+")."),Oe;return Oe}function U(Oe){return Oe.generateMipmaps}function R(Oe){o.generateMipmap(Oe)}function $(Oe){return Oe.isWebGLCubeRenderTarget?o.TEXTURE_CUBE_MAP:Oe.isWebGL3DRenderTarget?o.TEXTURE_3D:Oe.isWebGLArrayRenderTarget||Oe.isCompressedArrayTexture?o.TEXTURE_2D_ARRAY:o.TEXTURE_2D}function Z(Oe,_e,Ct,Kt,Zt=!1){if(Oe!==null){if(o[Oe]!==void 0)return o[Oe];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Oe+"'")}let jt=_e;if(_e===o.RED&&(Ct===o.FLOAT&&(jt=o.R32F),Ct===o.HALF_FLOAT&&(jt=o.R16F),Ct===o.UNSIGNED_BYTE&&(jt=o.R8)),_e===o.RED_INTEGER&&(Ct===o.UNSIGNED_BYTE&&(jt=o.R8UI),Ct===o.UNSIGNED_SHORT&&(jt=o.R16UI),Ct===o.UNSIGNED_INT&&(jt=o.R32UI),Ct===o.BYTE&&(jt=o.R8I),Ct===o.SHORT&&(jt=o.R16I),Ct===o.INT&&(jt=o.R32I)),_e===o.RG&&(Ct===o.FLOAT&&(jt=o.RG32F),Ct===o.HALF_FLOAT&&(jt=o.RG16F),Ct===o.UNSIGNED_BYTE&&(jt=o.RG8)),_e===o.RG_INTEGER&&(Ct===o.UNSIGNED_BYTE&&(jt=o.RG8UI),Ct===o.UNSIGNED_SHORT&&(jt=o.RG16UI),Ct===o.UNSIGNED_INT&&(jt=o.RG32UI),Ct===o.BYTE&&(jt=o.RG8I),Ct===o.SHORT&&(jt=o.RG16I),Ct===o.INT&&(jt=o.RG32I)),_e===o.RGB_INTEGER&&(Ct===o.UNSIGNED_BYTE&&(jt=o.RGB8UI),Ct===o.UNSIGNED_SHORT&&(jt=o.RGB16UI),Ct===o.UNSIGNED_INT&&(jt=o.RGB32UI),Ct===o.BYTE&&(jt=o.RGB8I),Ct===o.SHORT&&(jt=o.RGB16I),Ct===o.INT&&(jt=o.RGB32I)),_e===o.RGBA_INTEGER&&(Ct===o.UNSIGNED_BYTE&&(jt=o.RGBA8UI),Ct===o.UNSIGNED_SHORT&&(jt=o.RGBA16UI),Ct===o.UNSIGNED_INT&&(jt=o.RGBA32UI),Ct===o.BYTE&&(jt=o.RGBA8I),Ct===o.SHORT&&(jt=o.RGBA16I),Ct===o.INT&&(jt=o.RGBA32I)),_e===o.RGB&&Ct===o.UNSIGNED_INT_5_9_9_9_REV&&(jt=o.RGB9_E5),_e===o.RGBA){const or=Zt?Lk:Kr.getTransfer(Kt);Ct===o.FLOAT&&(jt=o.RGBA32F),Ct===o.HALF_FLOAT&&(jt=o.RGBA16F),Ct===o.UNSIGNED_BYTE&&(jt=or===ms?o.SRGB8_ALPHA8:o.RGBA8),Ct===o.UNSIGNED_SHORT_4_4_4_4&&(jt=o.RGBA4),Ct===o.UNSIGNED_SHORT_5_5_5_1&&(jt=o.RGB5_A1)}return(jt===o.R16F||jt===o.R32F||jt===o.RG16F||jt===o.RG32F||jt===o.RGBA16F||jt===o.RGBA32F)&&e.get("EXT_color_buffer_float"),jt}function k(Oe,_e){let Ct;return Oe?_e===null||_e===y6||_e===pE?Ct=o.DEPTH24_STENCIL8:_e===Th?Ct=o.DEPTH32F_STENCIL8:_e===fE&&(Ct=o.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):_e===null||_e===y6||_e===pE?Ct=o.DEPTH_COMPONENT24:_e===Th?Ct=o.DEPTH_COMPONENT32F:_e===fE&&(Ct=o.DEPTH_COMPONENT16),Ct}function ie(Oe,_e){return U(Oe)===!0||Oe.isFramebufferTexture&&Oe.minFilter!==c0&&Oe.minFilter!==xc?Math.log2(Math.max(_e.width,_e.height))+1:Oe.mipmaps!==void 0&&Oe.mipmaps.length>0?Oe.mipmaps.length:Oe.isCompressedTexture&&Array.isArray(Oe.image)?_e.mipmaps.length:1}function ue(Oe){const _e=Oe.target;_e.removeEventListener("dispose",ue),Q(_e),_e.isVideoTexture&&v.delete(_e)}function ce(Oe){const _e=Oe.target;_e.removeEventListener("dispose",ce),le(_e)}function Q(Oe){const _e=n.get(Oe);if(_e.__webglInit===void 0)return;const Ct=Oe.source,Kt=S.get(Ct);if(Kt){const Zt=Kt[_e.__cacheKey];Zt.usedTimes--,Zt.usedTimes===0&&ae(Oe),Object.keys(Kt).length===0&&S.delete(Ct)}n.remove(Oe)}function ae(Oe){const _e=n.get(Oe);o.deleteTexture(_e.__webglTexture);const Ct=Oe.source,Kt=S.get(Ct);delete Kt[_e.__cacheKey],a.memory.textures--}function le(Oe){const _e=n.get(Oe);if(Oe.depthTexture&&(Oe.depthTexture.dispose(),n.remove(Oe.depthTexture)),Oe.isWebGLCubeRenderTarget)for(let Kt=0;Kt<6;Kt++){if(Array.isArray(_e.__webglFramebuffer[Kt]))for(let Zt=0;Zt<_e.__webglFramebuffer[Kt].length;Zt++)o.deleteFramebuffer(_e.__webglFramebuffer[Kt][Zt]);else o.deleteFramebuffer(_e.__webglFramebuffer[Kt]);_e.__webglDepthbuffer&&o.deleteRenderbuffer(_e.__webglDepthbuffer[Kt])}else{if(Array.isArray(_e.__webglFramebuffer))for(let Kt=0;Kt<_e.__webglFramebuffer.length;Kt++)o.deleteFramebuffer(_e.__webglFramebuffer[Kt]);else o.deleteFramebuffer(_e.__webglFramebuffer);if(_e.__webglDepthbuffer&&o.deleteRenderbuffer(_e.__webglDepthbuffer),_e.__webglMultisampledFramebuffer&&o.deleteFramebuffer(_e.__webglMultisampledFramebuffer),_e.__webglColorRenderbuffer)for(let Kt=0;Kt<_e.__webglColorRenderbuffer.length;Kt++)_e.__webglColorRenderbuffer[Kt]&&o.deleteRenderbuffer(_e.__webglColorRenderbuffer[Kt]);_e.__webglDepthRenderbuffer&&o.deleteRenderbuffer(_e.__webglDepthRenderbuffer)}const Ct=Oe.textures;for(let Kt=0,Zt=Ct.length;Kt<Zt;Kt++){const jt=n.get(Ct[Kt]);jt.__webglTexture&&(o.deleteTexture(jt.__webglTexture),a.memory.textures--),n.remove(Ct[Kt])}n.remove(Oe)}let J=0;function Ue(){J=0}function je(){const Oe=J;return Oe>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+Oe+" texture units while this GPU supports only "+r.maxTextures),J+=1,Oe}function rt(Oe){const _e=[];return _e.push(Oe.wrapS),_e.push(Oe.wrapT),_e.push(Oe.wrapR||0),_e.push(Oe.magFilter),_e.push(Oe.minFilter),_e.push(Oe.anisotropy),_e.push(Oe.internalFormat),_e.push(Oe.format),_e.push(Oe.type),_e.push(Oe.generateMipmaps),_e.push(Oe.premultiplyAlpha),_e.push(Oe.flipY),_e.push(Oe.unpackAlignment),_e.push(Oe.colorSpace),_e.join()}function at(Oe,_e){const Ct=n.get(Oe);if(Oe.isVideoTexture&&sr(Oe),Oe.isRenderTargetTexture===!1&&Oe.version>0&&Ct.__version!==Oe.version){const Kt=Oe.image;if(Kt===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Kt.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{gn(Ct,Oe,_e);return}}t.bindTexture(o.TEXTURE_2D,Ct.__webglTexture,o.TEXTURE0+_e)}function Se(Oe,_e){const Ct=n.get(Oe);if(Oe.version>0&&Ct.__version!==Oe.version){gn(Ct,Oe,_e);return}t.bindTexture(o.TEXTURE_2D_ARRAY,Ct.__webglTexture,o.TEXTURE0+_e)}function gt(Oe,_e){const Ct=n.get(Oe);if(Oe.version>0&&Ct.__version!==Oe.version){gn(Ct,Oe,_e);return}t.bindTexture(o.TEXTURE_3D,Ct.__webglTexture,o.TEXTURE0+_e)}function Ae(Oe,_e){const Ct=n.get(Oe);if(Oe.version>0&&Ct.__version!==Oe.version){qt(Ct,Oe,_e);return}t.bindTexture(o.TEXTURE_CUBE_MAP,Ct.__webglTexture,o.TEXTURE0+_e)}const lt={[kg]:o.REPEAT,[l0]:o.CLAMP_TO_EDGE,[OG]:o.MIRRORED_REPEAT},pt={[c0]:o.NEAREST,[tTe]:o.NEAREST_MIPMAP_NEAREST,[HP]:o.NEAREST_MIPMAP_LINEAR,[xc]:o.LINEAR,[lz]:o.LINEAR_MIPMAP_NEAREST,[u6]:o.LINEAR_MIPMAP_LINEAR},De={[cTe]:o.NEVER,[mTe]:o.ALWAYS,[uTe]:o.LESS,[p9e]:o.LEQUAL,[hTe]:o.EQUAL,[pTe]:o.GEQUAL,[dTe]:o.GREATER,[fTe]:o.NOTEQUAL};function _t(Oe,_e){if(_e.type===Th&&e.has("OES_texture_float_linear")===!1&&(_e.magFilter===xc||_e.magFilter===lz||_e.magFilter===HP||_e.magFilter===u6||_e.minFilter===xc||_e.minFilter===lz||_e.minFilter===HP||_e.minFilter===u6)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),o.texParameteri(Oe,o.TEXTURE_WRAP_S,lt[_e.wrapS]),o.texParameteri(Oe,o.TEXTURE_WRAP_T,lt[_e.wrapT]),(Oe===o.TEXTURE_3D||Oe===o.TEXTURE_2D_ARRAY)&&o.texParameteri(Oe,o.TEXTURE_WRAP_R,lt[_e.wrapR]),o.texParameteri(Oe,o.TEXTURE_MAG_FILTER,pt[_e.magFilter]),o.texParameteri(Oe,o.TEXTURE_MIN_FILTER,pt[_e.minFilter]),_e.compareFunction&&(o.texParameteri(Oe,o.TEXTURE_COMPARE_MODE,o.COMPARE_REF_TO_TEXTURE),o.texParameteri(Oe,o.TEXTURE_COMPARE_FUNC,De[_e.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(_e.magFilter===c0||_e.minFilter!==HP&&_e.minFilter!==u6||_e.type===Th&&e.has("OES_texture_float_linear")===!1)return;if(_e.anisotropy>1||n.get(_e).__currentAnisotropy){const Ct=e.get("EXT_texture_filter_anisotropic");o.texParameterf(Oe,Ct.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(_e.anisotropy,r.getMaxAnisotropy())),n.get(_e).__currentAnisotropy=_e.anisotropy}}}function Jt(Oe,_e){let Ct=!1;Oe.__webglInit===void 0&&(Oe.__webglInit=!0,_e.addEventListener("dispose",ue));const Kt=_e.source;let Zt=S.get(Kt);Zt===void 0&&(Zt={},S.set(Kt,Zt));const jt=rt(_e);if(jt!==Oe.__cacheKey){Zt[jt]===void 0&&(Zt[jt]={texture:o.createTexture(),usedTimes:0},a.memory.textures++,Ct=!0),Zt[jt].usedTimes++;const or=Zt[Oe.__cacheKey];or!==void 0&&(Zt[Oe.__cacheKey].usedTimes--,or.usedTimes===0&&ae(_e)),Oe.__cacheKey=jt,Oe.__webglTexture=Zt[jt].texture}return Ct}function dt(Oe,_e,Ct){return Math.floor(Math.floor(Oe/Ct)/_e)}function Dt(Oe,_e,Ct,Kt){const jt=Oe.updateRanges;if(jt.length===0)t.texSubImage2D(o.TEXTURE_2D,0,0,0,_e.width,_e.height,Ct,Kt,_e.data);else{jt.sort((Qt,jn)=>Qt.start-jn.start);let or=0;for(let Qt=1;Qt<jt.length;Qt++){const jn=jt[or],Cr=jt[Qt],gr=jn.start+jn.count,Pn=dt(Cr.start,_e.width,4),wr=dt(jn.start,_e.width,4);Cr.start<=gr+1&&Pn===wr&&dt(Cr.start+Cr.count-1,_e.width,4)===Pn?jn.count=Math.max(jn.count,Cr.start+Cr.count-jn.start):(++or,jt[or]=Cr)}jt.length=or+1;const An=o.getParameter(o.UNPACK_ROW_LENGTH),Gn=o.getParameter(o.UNPACK_SKIP_PIXELS),ar=o.getParameter(o.UNPACK_SKIP_ROWS);o.pixelStorei(o.UNPACK_ROW_LENGTH,_e.width);for(let Qt=0,jn=jt.length;Qt<jn;Qt++){const Cr=jt[Qt],gr=Math.floor(Cr.start/4),Pn=Math.ceil(Cr.count/4),wr=gr%_e.width,Ze=Math.floor(gr/_e.width),Tn=Pn,nn=1;o.pixelStorei(o.UNPACK_SKIP_PIXELS,wr),o.pixelStorei(o.UNPACK_SKIP_ROWS,Ze),t.texSubImage2D(o.TEXTURE_2D,0,wr,Ze,Tn,nn,Ct,Kt,_e.data)}Oe.clearUpdateRanges(),o.pixelStorei(o.UNPACK_ROW_LENGTH,An),o.pixelStorei(o.UNPACK_SKIP_PIXELS,Gn),o.pixelStorei(o.UNPACK_SKIP_ROWS,ar)}}function gn(Oe,_e,Ct){let Kt=o.TEXTURE_2D;(_e.isDataArrayTexture||_e.isCompressedArrayTexture)&&(Kt=o.TEXTURE_2D_ARRAY),_e.isData3DTexture&&(Kt=o.TEXTURE_3D);const Zt=Jt(Oe,_e),jt=_e.source;t.bindTexture(Kt,Oe.__webglTexture,o.TEXTURE0+Ct);const or=n.get(jt);if(jt.version!==or.__version||Zt===!0){t.activeTexture(o.TEXTURE0+Ct);const An=Kr.getPrimaries(Kr.workingColorSpace),Gn=_e.colorSpace===mg?null:Kr.getPrimaries(_e.colorSpace),ar=_e.colorSpace===mg||An===Gn?o.NONE:o.BROWSER_DEFAULT_WEBGL;o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,_e.flipY),o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,_e.premultiplyAlpha),o.pixelStorei(o.UNPACK_ALIGNMENT,_e.unpackAlignment),o.pixelStorei(o.UNPACK_COLORSPACE_CONVERSION_WEBGL,ar);let Qt=L(_e.image,!1,r.maxTextureSize);Qt=dr(_e,Qt);const jn=i.convert(_e.format,_e.colorSpace),Cr=i.convert(_e.type);let gr=Z(_e.internalFormat,jn,Cr,_e.colorSpace,_e.isVideoTexture);_t(Kt,_e);let Pn;const wr=_e.mipmaps,Ze=_e.isVideoTexture!==!0,Tn=or.__version===void 0||Zt===!0,nn=jt.dataReady,Nn=ie(_e,Qt);if(_e.isDepthTexture)gr=k(_e.format===gE,_e.type),Tn&&(Ze?t.texStorage2D(o.TEXTURE_2D,1,gr,Qt.width,Qt.height):t.texImage2D(o.TEXTURE_2D,0,gr,Qt.width,Qt.height,0,jn,Cr,null));else if(_e.isDataTexture)if(wr.length>0){Ze&&Tn&&t.texStorage2D(o.TEXTURE_2D,Nn,gr,wr[0].width,wr[0].height);for(let ln=0,en=wr.length;ln<en;ln++)Pn=wr[ln],Ze?nn&&t.texSubImage2D(o.TEXTURE_2D,ln,0,0,Pn.width,Pn.height,jn,Cr,Pn.data):t.texImage2D(o.TEXTURE_2D,ln,gr,Pn.width,Pn.height,0,jn,Cr,Pn.data);_e.generateMipmaps=!1}else Ze?(Tn&&t.texStorage2D(o.TEXTURE_2D,Nn,gr,Qt.width,Qt.height),nn&&Dt(_e,Qt,jn,Cr)):t.texImage2D(o.TEXTURE_2D,0,gr,Qt.width,Qt.height,0,jn,Cr,Qt.data);else if(_e.isCompressedTexture)if(_e.isCompressedArrayTexture){Ze&&Tn&&t.texStorage3D(o.TEXTURE_2D_ARRAY,Nn,gr,wr[0].width,wr[0].height,Qt.depth);for(let ln=0,en=wr.length;ln<en;ln++)if(Pn=wr[ln],_e.format!==V0)if(jn!==null)if(Ze){if(nn)if(_e.layerUpdates.size>0){const Xn=P1e(Pn.width,Pn.height,_e.format,_e.type);for(const Sr of _e.layerUpdates){const _i=Pn.data.subarray(Sr*Xn/Pn.data.BYTES_PER_ELEMENT,(Sr+1)*Xn/Pn.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(o.TEXTURE_2D_ARRAY,ln,0,0,Sr,Pn.width,Pn.height,1,jn,_i)}_e.clearLayerUpdates()}else t.compressedTexSubImage3D(o.TEXTURE_2D_ARRAY,ln,0,0,0,Pn.width,Pn.height,Qt.depth,jn,Pn.data)}else t.compressedTexImage3D(o.TEXTURE_2D_ARRAY,ln,gr,Pn.width,Pn.height,Qt.depth,0,Pn.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else Ze?nn&&t.texSubImage3D(o.TEXTURE_2D_ARRAY,ln,0,0,0,Pn.width,Pn.height,Qt.depth,jn,Cr,Pn.data):t.texImage3D(o.TEXTURE_2D_ARRAY,ln,gr,Pn.width,Pn.height,Qt.depth,0,jn,Cr,Pn.data)}else{Ze&&Tn&&t.texStorage2D(o.TEXTURE_2D,Nn,gr,wr[0].width,wr[0].height);for(let ln=0,en=wr.length;ln<en;ln++)Pn=wr[ln],_e.format!==V0?jn!==null?Ze?nn&&t.compressedTexSubImage2D(o.TEXTURE_2D,ln,0,0,Pn.width,Pn.height,jn,Pn.data):t.compressedTexImage2D(o.TEXTURE_2D,ln,gr,Pn.width,Pn.height,0,Pn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ze?nn&&t.texSubImage2D(o.TEXTURE_2D,ln,0,0,Pn.width,Pn.height,jn,Cr,Pn.data):t.texImage2D(o.TEXTURE_2D,ln,gr,Pn.width,Pn.height,0,jn,Cr,Pn.data)}else if(_e.isDataArrayTexture)if(Ze){if(Tn&&t.texStorage3D(o.TEXTURE_2D_ARRAY,Nn,gr,Qt.width,Qt.height,Qt.depth),nn)if(_e.layerUpdates.size>0){const ln=P1e(Qt.width,Qt.height,_e.format,_e.type);for(const en of _e.layerUpdates){const Xn=Qt.data.subarray(en*ln/Qt.data.BYTES_PER_ELEMENT,(en+1)*ln/Qt.data.BYTES_PER_ELEMENT);t.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,en,Qt.width,Qt.height,1,jn,Cr,Xn)}_e.clearLayerUpdates()}else t.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,0,Qt.width,Qt.height,Qt.depth,jn,Cr,Qt.data)}else t.texImage3D(o.TEXTURE_2D_ARRAY,0,gr,Qt.width,Qt.height,Qt.depth,0,jn,Cr,Qt.data);else if(_e.isData3DTexture)Ze?(Tn&&t.texStorage3D(o.TEXTURE_3D,Nn,gr,Qt.width,Qt.height,Qt.depth),nn&&t.texSubImage3D(o.TEXTURE_3D,0,0,0,0,Qt.width,Qt.height,Qt.depth,jn,Cr,Qt.data)):t.texImage3D(o.TEXTURE_3D,0,gr,Qt.width,Qt.height,Qt.depth,0,jn,Cr,Qt.data);else if(_e.isFramebufferTexture){if(Tn)if(Ze)t.texStorage2D(o.TEXTURE_2D,Nn,gr,Qt.width,Qt.height);else{let ln=Qt.width,en=Qt.height;for(let Xn=0;Xn<Nn;Xn++)t.texImage2D(o.TEXTURE_2D,Xn,gr,ln,en,0,jn,Cr,null),ln>>=1,en>>=1}}else if(wr.length>0){if(Ze&&Tn){const ln=mi(wr[0]);t.texStorage2D(o.TEXTURE_2D,Nn,gr,ln.width,ln.height)}for(let ln=0,en=wr.length;ln<en;ln++)Pn=wr[ln],Ze?nn&&t.texSubImage2D(o.TEXTURE_2D,ln,0,0,jn,Cr,Pn):t.texImage2D(o.TEXTURE_2D,ln,gr,jn,Cr,Pn);_e.generateMipmaps=!1}else if(Ze){if(Tn){const ln=mi(Qt);t.texStorage2D(o.TEXTURE_2D,Nn,gr,ln.width,ln.height)}nn&&t.texSubImage2D(o.TEXTURE_2D,0,0,0,jn,Cr,Qt)}else t.texImage2D(o.TEXTURE_2D,0,gr,jn,Cr,Qt);U(_e)&&R(Kt),or.__version=jt.version,_e.onUpdate&&_e.onUpdate(_e)}Oe.__version=_e.version}function qt(Oe,_e,Ct){if(_e.image.length!==6)return;const Kt=Jt(Oe,_e),Zt=_e.source;t.bindTexture(o.TEXTURE_CUBE_MAP,Oe.__webglTexture,o.TEXTURE0+Ct);const jt=n.get(Zt);if(Zt.version!==jt.__version||Kt===!0){t.activeTexture(o.TEXTURE0+Ct);const or=Kr.getPrimaries(Kr.workingColorSpace),An=_e.colorSpace===mg?null:Kr.getPrimaries(_e.colorSpace),Gn=_e.colorSpace===mg||or===An?o.NONE:o.BROWSER_DEFAULT_WEBGL;o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,_e.flipY),o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,_e.premultiplyAlpha),o.pixelStorei(o.UNPACK_ALIGNMENT,_e.unpackAlignment),o.pixelStorei(o.UNPACK_COLORSPACE_CONVERSION_WEBGL,Gn);const ar=_e.isCompressedTexture||_e.image[0].isCompressedTexture,Qt=_e.image[0]&&_e.image[0].isDataTexture,jn=[];for(let en=0;en<6;en++)!ar&&!Qt?jn[en]=L(_e.image[en],!0,r.maxCubemapSize):jn[en]=Qt?_e.image[en].image:_e.image[en],jn[en]=dr(_e,jn[en]);const Cr=jn[0],gr=i.convert(_e.format,_e.colorSpace),Pn=i.convert(_e.type),wr=Z(_e.internalFormat,gr,Pn,_e.colorSpace),Ze=_e.isVideoTexture!==!0,Tn=jt.__version===void 0||Kt===!0,nn=Zt.dataReady;let Nn=ie(_e,Cr);_t(o.TEXTURE_CUBE_MAP,_e);let ln;if(ar){Ze&&Tn&&t.texStorage2D(o.TEXTURE_CUBE_MAP,Nn,wr,Cr.width,Cr.height);for(let en=0;en<6;en++){ln=jn[en].mipmaps;for(let Xn=0;Xn<ln.length;Xn++){const Sr=ln[Xn];_e.format!==V0?gr!==null?Ze?nn&&t.compressedTexSubImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+en,Xn,0,0,Sr.width,Sr.height,gr,Sr.data):t.compressedTexImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+en,Xn,wr,Sr.width,Sr.height,0,Sr.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Ze?nn&&t.texSubImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+en,Xn,0,0,Sr.width,Sr.height,gr,Pn,Sr.data):t.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+en,Xn,wr,Sr.width,Sr.height,0,gr,Pn,Sr.data)}}}else{if(ln=_e.mipmaps,Ze&&Tn){ln.length>0&&Nn++;const en=mi(jn[0]);t.texStorage2D(o.TEXTURE_CUBE_MAP,Nn,wr,en.width,en.height)}for(let en=0;en<6;en++)if(Qt){Ze?nn&&t.texSubImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+en,0,0,0,jn[en].width,jn[en].height,gr,Pn,jn[en].data):t.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+en,0,wr,jn[en].width,jn[en].height,0,gr,Pn,jn[en].data);for(let Xn=0;Xn<ln.length;Xn++){const _i=ln[Xn].image[en].image;Ze?nn&&t.texSubImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+en,Xn+1,0,0,_i.width,_i.height,gr,Pn,_i.data):t.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+en,Xn+1,wr,_i.width,_i.height,0,gr,Pn,_i.data)}}else{Ze?nn&&t.texSubImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+en,0,0,0,gr,Pn,jn[en]):t.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+en,0,wr,gr,Pn,jn[en]);for(let Xn=0;Xn<ln.length;Xn++){const Sr=ln[Xn];Ze?nn&&t.texSubImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+en,Xn+1,0,0,gr,Pn,Sr.image[en]):t.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+en,Xn+1,wr,gr,Pn,Sr.image[en])}}}U(_e)&&R(o.TEXTURE_CUBE_MAP),jt.__version=Zt.version,_e.onUpdate&&_e.onUpdate(_e)}Oe.__version=_e.version}function wn(Oe,_e,Ct,Kt,Zt,jt){const or=i.convert(Ct.format,Ct.colorSpace),An=i.convert(Ct.type),Gn=Z(Ct.internalFormat,or,An,Ct.colorSpace),ar=n.get(_e),Qt=n.get(Ct);if(Qt.__renderTarget=_e,!ar.__hasExternalTextures){const jn=Math.max(1,_e.width>>jt),Cr=Math.max(1,_e.height>>jt);Zt===o.TEXTURE_3D||Zt===o.TEXTURE_2D_ARRAY?t.texImage3D(Zt,jt,Gn,jn,Cr,_e.depth,0,or,An,null):t.texImage2D(Zt,jt,Gn,jn,Cr,0,or,An,null)}t.bindFramebuffer(o.FRAMEBUFFER,Oe),Pr(_e)?c.framebufferTexture2DMultisampleEXT(o.FRAMEBUFFER,Kt,Zt,Qt.__webglTexture,0,Ln(_e)):(Zt===o.TEXTURE_2D||Zt>=o.TEXTURE_CUBE_MAP_POSITIVE_X&&Zt<=o.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&o.framebufferTexture2D(o.FRAMEBUFFER,Kt,Zt,Qt.__webglTexture,jt),t.bindFramebuffer(o.FRAMEBUFFER,null)}function nr(Oe,_e,Ct){if(o.bindRenderbuffer(o.RENDERBUFFER,Oe),_e.depthBuffer){const Kt=_e.depthTexture,Zt=Kt&&Kt.isDepthTexture?Kt.type:null,jt=k(_e.stencilBuffer,Zt),or=_e.stencilBuffer?o.DEPTH_STENCIL_ATTACHMENT:o.DEPTH_ATTACHMENT,An=Ln(_e);Pr(_e)?c.renderbufferStorageMultisampleEXT(o.RENDERBUFFER,An,jt,_e.width,_e.height):Ct?o.renderbufferStorageMultisample(o.RENDERBUFFER,An,jt,_e.width,_e.height):o.renderbufferStorage(o.RENDERBUFFER,jt,_e.width,_e.height),o.framebufferRenderbuffer(o.FRAMEBUFFER,or,o.RENDERBUFFER,Oe)}else{const Kt=_e.textures;for(let Zt=0;Zt<Kt.length;Zt++){const jt=Kt[Zt],or=i.convert(jt.format,jt.colorSpace),An=i.convert(jt.type),Gn=Z(jt.internalFormat,or,An,jt.colorSpace),ar=Ln(_e);Ct&&Pr(_e)===!1?o.renderbufferStorageMultisample(o.RENDERBUFFER,ar,Gn,_e.width,_e.height):Pr(_e)?c.renderbufferStorageMultisampleEXT(o.RENDERBUFFER,ar,Gn,_e.width,_e.height):o.renderbufferStorage(o.RENDERBUFFER,Gn,_e.width,_e.height)}}o.bindRenderbuffer(o.RENDERBUFFER,null)}function qn(Oe,_e){if(_e&&_e.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(o.FRAMEBUFFER,Oe),!(_e.depthTexture&&_e.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const Kt=n.get(_e.depthTexture);Kt.__renderTarget=_e,(!Kt.__webglTexture||_e.depthTexture.image.width!==_e.width||_e.depthTexture.image.height!==_e.height)&&(_e.depthTexture.image.width=_e.width,_e.depthTexture.image.height=_e.height,_e.depthTexture.needsUpdate=!0),at(_e.depthTexture,0);const Zt=Kt.__webglTexture,jt=Ln(_e);if(_e.depthTexture.format===mE)Pr(_e)?c.framebufferTexture2DMultisampleEXT(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.TEXTURE_2D,Zt,0,jt):o.framebufferTexture2D(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.TEXTURE_2D,Zt,0);else if(_e.depthTexture.format===gE)Pr(_e)?c.framebufferTexture2DMultisampleEXT(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.TEXTURE_2D,Zt,0,jt):o.framebufferTexture2D(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.TEXTURE_2D,Zt,0);else throw new Error("Unknown depthTexture format")}function ni(Oe){const _e=n.get(Oe),Ct=Oe.isWebGLCubeRenderTarget===!0;if(_e.__boundDepthTexture!==Oe.depthTexture){const Kt=Oe.depthTexture;if(_e.__depthDisposeCallback&&_e.__depthDisposeCallback(),Kt){const Zt=()=>{delete _e.__boundDepthTexture,delete _e.__depthDisposeCallback,Kt.removeEventListener("dispose",Zt)};Kt.addEventListener("dispose",Zt),_e.__depthDisposeCallback=Zt}_e.__boundDepthTexture=Kt}if(Oe.depthTexture&&!_e.__autoAllocateDepthBuffer){if(Ct)throw new Error("target.depthTexture not supported in Cube render targets");const Kt=Oe.texture.mipmaps;Kt&&Kt.length>0?qn(_e.__webglFramebuffer[0],Oe):qn(_e.__webglFramebuffer,Oe)}else if(Ct){_e.__webglDepthbuffer=[];for(let Kt=0;Kt<6;Kt++)if(t.bindFramebuffer(o.FRAMEBUFFER,_e.__webglFramebuffer[Kt]),_e.__webglDepthbuffer[Kt]===void 0)_e.__webglDepthbuffer[Kt]=o.createRenderbuffer(),nr(_e.__webglDepthbuffer[Kt],Oe,!1);else{const Zt=Oe.stencilBuffer?o.DEPTH_STENCIL_ATTACHMENT:o.DEPTH_ATTACHMENT,jt=_e.__webglDepthbuffer[Kt];o.bindRenderbuffer(o.RENDERBUFFER,jt),o.framebufferRenderbuffer(o.FRAMEBUFFER,Zt,o.RENDERBUFFER,jt)}}else{const Kt=Oe.texture.mipmaps;if(Kt&&Kt.length>0?t.bindFramebuffer(o.FRAMEBUFFER,_e.__webglFramebuffer[0]):t.bindFramebuffer(o.FRAMEBUFFER,_e.__webglFramebuffer),_e.__webglDepthbuffer===void 0)_e.__webglDepthbuffer=o.createRenderbuffer(),nr(_e.__webglDepthbuffer,Oe,!1);else{const Zt=Oe.stencilBuffer?o.DEPTH_STENCIL_ATTACHMENT:o.DEPTH_ATTACHMENT,jt=_e.__webglDepthbuffer;o.bindRenderbuffer(o.RENDERBUFFER,jt),o.framebufferRenderbuffer(o.FRAMEBUFFER,Zt,o.RENDERBUFFER,jt)}}t.bindFramebuffer(o.FRAMEBUFFER,null)}function ai(Oe,_e,Ct){const Kt=n.get(Oe);_e!==void 0&&wn(Kt.__webglFramebuffer,Oe,Oe.texture,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,0),Ct!==void 0&&ni(Oe)}function qr(Oe){const _e=Oe.texture,Ct=n.get(Oe),Kt=n.get(_e);Oe.addEventListener("dispose",ce);const Zt=Oe.textures,jt=Oe.isWebGLCubeRenderTarget===!0,or=Zt.length>1;if(or||(Kt.__webglTexture===void 0&&(Kt.__webglTexture=o.createTexture()),Kt.__version=_e.version,a.memory.textures++),jt){Ct.__webglFramebuffer=[];for(let An=0;An<6;An++)if(_e.mipmaps&&_e.mipmaps.length>0){Ct.__webglFramebuffer[An]=[];for(let Gn=0;Gn<_e.mipmaps.length;Gn++)Ct.__webglFramebuffer[An][Gn]=o.createFramebuffer()}else Ct.__webglFramebuffer[An]=o.createFramebuffer()}else{if(_e.mipmaps&&_e.mipmaps.length>0){Ct.__webglFramebuffer=[];for(let An=0;An<_e.mipmaps.length;An++)Ct.__webglFramebuffer[An]=o.createFramebuffer()}else Ct.__webglFramebuffer=o.createFramebuffer();if(or)for(let An=0,Gn=Zt.length;An<Gn;An++){const ar=n.get(Zt[An]);ar.__webglTexture===void 0&&(ar.__webglTexture=o.createTexture(),a.memory.textures++)}if(Oe.samples>0&&Pr(Oe)===!1){Ct.__webglMultisampledFramebuffer=o.createFramebuffer(),Ct.__webglColorRenderbuffer=[],t.bindFramebuffer(o.FRAMEBUFFER,Ct.__webglMultisampledFramebuffer);for(let An=0;An<Zt.length;An++){const Gn=Zt[An];Ct.__webglColorRenderbuffer[An]=o.createRenderbuffer(),o.bindRenderbuffer(o.RENDERBUFFER,Ct.__webglColorRenderbuffer[An]);const ar=i.convert(Gn.format,Gn.colorSpace),Qt=i.convert(Gn.type),jn=Z(Gn.internalFormat,ar,Qt,Gn.colorSpace,Oe.isXRRenderTarget===!0),Cr=Ln(Oe);o.renderbufferStorageMultisample(o.RENDERBUFFER,Cr,jn,Oe.width,Oe.height),o.framebufferRenderbuffer(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0+An,o.RENDERBUFFER,Ct.__webglColorRenderbuffer[An])}o.bindRenderbuffer(o.RENDERBUFFER,null),Oe.depthBuffer&&(Ct.__webglDepthRenderbuffer=o.createRenderbuffer(),nr(Ct.__webglDepthRenderbuffer,Oe,!0)),t.bindFramebuffer(o.FRAMEBUFFER,null)}}if(jt){t.bindTexture(o.TEXTURE_CUBE_MAP,Kt.__webglTexture),_t(o.TEXTURE_CUBE_MAP,_e);for(let An=0;An<6;An++)if(_e.mipmaps&&_e.mipmaps.length>0)for(let Gn=0;Gn<_e.mipmaps.length;Gn++)wn(Ct.__webglFramebuffer[An][Gn],Oe,_e,o.COLOR_ATTACHMENT0,o.TEXTURE_CUBE_MAP_POSITIVE_X+An,Gn);else wn(Ct.__webglFramebuffer[An],Oe,_e,o.COLOR_ATTACHMENT0,o.TEXTURE_CUBE_MAP_POSITIVE_X+An,0);U(_e)&&R(o.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(or){for(let An=0,Gn=Zt.length;An<Gn;An++){const ar=Zt[An],Qt=n.get(ar);t.bindTexture(o.TEXTURE_2D,Qt.__webglTexture),_t(o.TEXTURE_2D,ar),wn(Ct.__webglFramebuffer,Oe,ar,o.COLOR_ATTACHMENT0+An,o.TEXTURE_2D,0),U(ar)&&R(o.TEXTURE_2D)}t.unbindTexture()}else{let An=o.TEXTURE_2D;if((Oe.isWebGL3DRenderTarget||Oe.isWebGLArrayRenderTarget)&&(An=Oe.isWebGL3DRenderTarget?o.TEXTURE_3D:o.TEXTURE_2D_ARRAY),t.bindTexture(An,Kt.__webglTexture),_t(An,_e),_e.mipmaps&&_e.mipmaps.length>0)for(let Gn=0;Gn<_e.mipmaps.length;Gn++)wn(Ct.__webglFramebuffer[Gn],Oe,_e,o.COLOR_ATTACHMENT0,An,Gn);else wn(Ct.__webglFramebuffer,Oe,_e,o.COLOR_ATTACHMENT0,An,0);U(_e)&&R(An),t.unbindTexture()}Oe.depthBuffer&&ni(Oe)}function $e(Oe){const _e=Oe.textures;for(let Ct=0,Kt=_e.length;Ct<Kt;Ct++){const Zt=_e[Ct];if(U(Zt)){const jt=$(Oe),or=n.get(Zt).__webglTexture;t.bindTexture(jt,or),R(jt),t.unbindTexture()}}}const Ls=[],li=[];function Ti(Oe){if(Oe.samples>0){if(Pr(Oe)===!1){const _e=Oe.textures,Ct=Oe.width,Kt=Oe.height;let Zt=o.COLOR_BUFFER_BIT;const jt=Oe.stencilBuffer?o.DEPTH_STENCIL_ATTACHMENT:o.DEPTH_ATTACHMENT,or=n.get(Oe),An=_e.length>1;if(An)for(let ar=0;ar<_e.length;ar++)t.bindFramebuffer(o.FRAMEBUFFER,or.__webglMultisampledFramebuffer),o.framebufferRenderbuffer(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0+ar,o.RENDERBUFFER,null),t.bindFramebuffer(o.FRAMEBUFFER,or.__webglFramebuffer),o.framebufferTexture2D(o.DRAW_FRAMEBUFFER,o.COLOR_ATTACHMENT0+ar,o.TEXTURE_2D,null,0);t.bindFramebuffer(o.READ_FRAMEBUFFER,or.__webglMultisampledFramebuffer);const Gn=Oe.texture.mipmaps;Gn&&Gn.length>0?t.bindFramebuffer(o.DRAW_FRAMEBUFFER,or.__webglFramebuffer[0]):t.bindFramebuffer(o.DRAW_FRAMEBUFFER,or.__webglFramebuffer);for(let ar=0;ar<_e.length;ar++){if(Oe.resolveDepthBuffer&&(Oe.depthBuffer&&(Zt|=o.DEPTH_BUFFER_BIT),Oe.stencilBuffer&&Oe.resolveStencilBuffer&&(Zt|=o.STENCIL_BUFFER_BIT)),An){o.framebufferRenderbuffer(o.READ_FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.RENDERBUFFER,or.__webglColorRenderbuffer[ar]);const Qt=n.get(_e[ar]).__webglTexture;o.framebufferTexture2D(o.DRAW_FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,Qt,0)}o.blitFramebuffer(0,0,Ct,Kt,0,0,Ct,Kt,Zt,o.NEAREST),h===!0&&(Ls.length=0,li.length=0,Ls.push(o.COLOR_ATTACHMENT0+ar),Oe.depthBuffer&&Oe.resolveDepthBuffer===!1&&(Ls.push(jt),li.push(jt),o.invalidateFramebuffer(o.DRAW_FRAMEBUFFER,li)),o.invalidateFramebuffer(o.READ_FRAMEBUFFER,Ls))}if(t.bindFramebuffer(o.READ_FRAMEBUFFER,null),t.bindFramebuffer(o.DRAW_FRAMEBUFFER,null),An)for(let ar=0;ar<_e.length;ar++){t.bindFramebuffer(o.FRAMEBUFFER,or.__webglMultisampledFramebuffer),o.framebufferRenderbuffer(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0+ar,o.RENDERBUFFER,or.__webglColorRenderbuffer[ar]);const Qt=n.get(_e[ar]).__webglTexture;t.bindFramebuffer(o.FRAMEBUFFER,or.__webglFramebuffer),o.framebufferTexture2D(o.DRAW_FRAMEBUFFER,o.COLOR_ATTACHMENT0+ar,o.TEXTURE_2D,Qt,0)}t.bindFramebuffer(o.DRAW_FRAMEBUFFER,or.__webglMultisampledFramebuffer)}else if(Oe.depthBuffer&&Oe.resolveDepthBuffer===!1&&h){const _e=Oe.stencilBuffer?o.DEPTH_STENCIL_ATTACHMENT:o.DEPTH_ATTACHMENT;o.invalidateFramebuffer(o.DRAW_FRAMEBUFFER,[_e])}}}function Ln(Oe){return Math.min(r.maxSamples,Oe.samples)}function Pr(Oe){const _e=n.get(Oe);return Oe.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&_e.__useRenderToTexture!==!1}function sr(Oe){const _e=a.render.frame;v.get(Oe)!==_e&&(v.set(Oe,_e),Oe.update())}function dr(Oe,_e){const Ct=Oe.colorSpace,Kt=Oe.format,Zt=Oe.type;return Oe.isCompressedTexture===!0||Oe.isVideoTexture===!0||Ct!==df&&Ct!==mg&&(Kr.getTransfer(Ct)===ms?(Kt!==V0||Zt!==n1)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",Ct)),_e}function mi(Oe){return typeof HTMLImageElement<"u"&&Oe instanceof HTMLImageElement?(p.width=Oe.naturalWidth||Oe.width,p.height=Oe.naturalHeight||Oe.height):typeof VideoFrame<"u"&&Oe instanceof VideoFrame?(p.width=Oe.displayWidth,p.height=Oe.displayHeight):(p.width=Oe.width,p.height=Oe.height),p}this.allocateTextureUnit=je,this.resetTextureUnits=Ue,this.setTexture2D=at,this.setTexture2DArray=Se,this.setTexture3D=gt,this.setTextureCube=Ae,this.rebindTextures=ai,this.setupRenderTarget=qr,this.updateRenderTargetMipmap=$e,this.updateMultisampleRenderTarget=Ti,this.setupDepthRenderbuffer=ni,this.setupFrameBufferTexture=wn,this.useMultisampledRTT=Pr}function Yke(o,e){function t(n,r=mg){let i;const a=Kr.getTransfer(r);if(n===n1)return o.UNSIGNED_BYTE;if(n===xH)return o.UNSIGNED_SHORT_4_4_4_4;if(n===bH)return o.UNSIGNED_SHORT_5_5_5_1;if(n===l9e)return o.UNSIGNED_INT_5_9_9_9_REV;if(n===o9e)return o.BYTE;if(n===a9e)return o.SHORT;if(n===fE)return o.UNSIGNED_SHORT;if(n===_H)return o.INT;if(n===y6)return o.UNSIGNED_INT;if(n===Th)return o.FLOAT;if(n===v6)return o.HALF_FLOAT;if(n===c9e)return o.ALPHA;if(n===u9e)return o.RGB;if(n===V0)return o.RGBA;if(n===mE)return o.DEPTH_COMPONENT;if(n===gE)return o.DEPTH_STENCIL;if(n===h9e)return o.RED;if(n===SH)return o.RED_INTEGER;if(n===d9e)return o.RG;if(n===wH)return o.RG_INTEGER;if(n===EH)return o.RGBA_INTEGER;if(n===pk||n===mk||n===gk||n===yk)if(a===ms)if(i=e.get("WEBGL_compressed_texture_s3tc_srgb"),i!==null){if(n===pk)return i.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===mk)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===gk)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===yk)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(i=e.get("WEBGL_compressed_texture_s3tc"),i!==null){if(n===pk)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===mk)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===gk)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===yk)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===FG||n===LG||n===BG||n===UG)if(i=e.get("WEBGL_compressed_texture_pvrtc"),i!==null){if(n===FG)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===LG)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===BG)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===UG)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===zG||n===VG||n===GG)if(i=e.get("WEBGL_compressed_texture_etc"),i!==null){if(n===zG||n===VG)return a===ms?i.COMPRESSED_SRGB8_ETC2:i.COMPRESSED_RGB8_ETC2;if(n===GG)return a===ms?i.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:i.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(n===jG||n===HG||n===WG||n===$G||n===qG||n===XG||n===YG||n===KG||n===ZG||n===QG||n===JG||n===ej||n===tj||n===nj)if(i=e.get("WEBGL_compressed_texture_astc"),i!==null){if(n===jG)return a===ms?i.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:i.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===HG)return a===ms?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:i.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===WG)return a===ms?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:i.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===$G)return a===ms?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:i.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===qG)return a===ms?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:i.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===XG)return a===ms?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:i.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===YG)return a===ms?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:i.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===KG)return a===ms?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:i.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===ZG)return a===ms?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:i.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===QG)return a===ms?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:i.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===JG)return a===ms?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:i.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===ej)return a===ms?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:i.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===tj)return a===ms?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:i.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===nj)return a===ms?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:i.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===vk||n===rj||n===ij)if(i=e.get("EXT_texture_compression_bptc"),i!==null){if(n===vk)return a===ms?i.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:i.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===rj)return i.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===ij)return i.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(n===f9e||n===sj||n===oj||n===aj)if(i=e.get("EXT_texture_compression_rgtc"),i!==null){if(n===vk)return i.COMPRESSED_RED_RGTC1_EXT;if(n===sj)return i.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===oj)return i.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===aj)return i.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return n===pE?o.UNSIGNED_INT_24_8:o[n]!==void 0?o[n]:null}return{convert:t}}const Kke=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,Zke=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class Qke{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,n){if(this.texture===null){const r=new H0,i=e.properties.get(r);i.__webglTexture=t.texture,(t.depthNear!==n.depthNear||t.depthFar!==n.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=r}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,n=new ff({vertexShader:Kke,fragmentShader:Zke,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new Mn(new b6(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class Jke extends gf{constructor(e,t){super();const n=this;let r=null,i=1,a=null,c="local-floor",h=1,p=null,v=null,x=null,S=null,C=null,I=null;const L=new Qke,U=t.getContextAttributes();let R=null,$=null;const Z=[],k=[],ie=new mr;let ue=null;const ce=new La;ce.viewport=new Pi;const Q=new La;Q.viewport=new Pi;const ae=[ce,Q],le=new JMe;let J=null,Ue=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(dt){let Dt=Z[dt];return Dt===void 0&&(Dt=new Rz,Z[dt]=Dt),Dt.getTargetRaySpace()},this.getControllerGrip=function(dt){let Dt=Z[dt];return Dt===void 0&&(Dt=new Rz,Z[dt]=Dt),Dt.getGripSpace()},this.getHand=function(dt){let Dt=Z[dt];return Dt===void 0&&(Dt=new Rz,Z[dt]=Dt),Dt.getHandSpace()};function je(dt){const Dt=k.indexOf(dt.inputSource);if(Dt===-1)return;const gn=Z[Dt];gn!==void 0&&(gn.update(dt.inputSource,dt.frame,p||a),gn.dispatchEvent({type:dt.type,data:dt.inputSource}))}function rt(){r.removeEventListener("select",je),r.removeEventListener("selectstart",je),r.removeEventListener("selectend",je),r.removeEventListener("squeeze",je),r.removeEventListener("squeezestart",je),r.removeEventListener("squeezeend",je),r.removeEventListener("end",rt),r.removeEventListener("inputsourceschange",at);for(let dt=0;dt<Z.length;dt++){const Dt=k[dt];Dt!==null&&(k[dt]=null,Z[dt].disconnect(Dt))}J=null,Ue=null,L.reset(),e.setRenderTarget(R),C=null,S=null,x=null,r=null,$=null,Jt.stop(),n.isPresenting=!1,e.setPixelRatio(ue),e.setSize(ie.width,ie.height,!1),n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(dt){i=dt,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(dt){c=dt,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return p||a},this.setReferenceSpace=function(dt){p=dt},this.getBaseLayer=function(){return S!==null?S:C},this.getBinding=function(){return x},this.getFrame=function(){return I},this.getSession=function(){return r},this.setSession=async function(dt){if(r=dt,r!==null){if(R=e.getRenderTarget(),r.addEventListener("select",je),r.addEventListener("selectstart",je),r.addEventListener("selectend",je),r.addEventListener("squeeze",je),r.addEventListener("squeezestart",je),r.addEventListener("squeezeend",je),r.addEventListener("end",rt),r.addEventListener("inputsourceschange",at),U.xrCompatible!==!0&&await t.makeXRCompatible(),ue=e.getPixelRatio(),e.getSize(ie),typeof XRWebGLBinding<"u"&&"createProjectionLayer"in XRWebGLBinding.prototype){let gn=null,qt=null,wn=null;U.depth&&(wn=U.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,gn=U.stencil?gE:mE,qt=U.stencil?pE:y6);const nr={colorFormat:t.RGBA8,depthFormat:wn,scaleFactor:i};x=new XRWebGLBinding(r,t),S=x.createProjectionLayer(nr),r.updateRenderState({layers:[S]}),e.setPixelRatio(1),e.setSize(S.textureWidth,S.textureHeight,!1),$=new _6(S.textureWidth,S.textureHeight,{format:V0,type:n1,depthTexture:new A9e(S.textureWidth,S.textureHeight,qt,void 0,void 0,void 0,void 0,void 0,void 0,gn),stencilBuffer:U.stencil,colorSpace:e.outputColorSpace,samples:U.antialias?4:0,resolveDepthBuffer:S.ignoreDepthValues===!1,resolveStencilBuffer:S.ignoreDepthValues===!1})}else{const gn={antialias:U.antialias,alpha:!0,depth:U.depth,stencil:U.stencil,framebufferScaleFactor:i};C=new XRWebGLLayer(r,t,gn),r.updateRenderState({baseLayer:C}),e.setPixelRatio(1),e.setSize(C.framebufferWidth,C.framebufferHeight,!1),$=new _6(C.framebufferWidth,C.framebufferHeight,{format:V0,type:n1,colorSpace:e.outputColorSpace,stencilBuffer:U.stencil,resolveDepthBuffer:C.ignoreDepthValues===!1,resolveStencilBuffer:C.ignoreDepthValues===!1})}$.isXRRenderTarget=!0,this.setFoveation(h),p=null,a=await r.requestReferenceSpace(c),Jt.setContext(r),Jt.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode},this.getDepthTexture=function(){return L.getDepthTexture()};function at(dt){for(let Dt=0;Dt<dt.removed.length;Dt++){const gn=dt.removed[Dt],qt=k.indexOf(gn);qt>=0&&(k[qt]=null,Z[qt].disconnect(gn))}for(let Dt=0;Dt<dt.added.length;Dt++){const gn=dt.added[Dt];let qt=k.indexOf(gn);if(qt===-1){for(let nr=0;nr<Z.length;nr++)if(nr>=k.length){k.push(gn),qt=nr;break}else if(k[nr]===null){k[nr]=gn,qt=nr;break}if(qt===-1)break}const wn=Z[qt];wn&&wn.connect(gn)}}const Se=new Ie,gt=new Ie;function Ae(dt,Dt,gn){Se.setFromMatrixPosition(Dt.matrixWorld),gt.setFromMatrixPosition(gn.matrixWorld);const qt=Se.distanceTo(gt),wn=Dt.projectionMatrix.elements,nr=gn.projectionMatrix.elements,qn=wn[14]/(wn[10]-1),ni=wn[14]/(wn[10]+1),ai=(wn[9]+1)/wn[5],qr=(wn[9]-1)/wn[5],$e=(wn[8]-1)/wn[0],Ls=(nr[8]+1)/nr[0],li=qn*$e,Ti=qn*Ls,Ln=qt/(-$e+Ls),Pr=Ln*-$e;if(Dt.matrixWorld.decompose(dt.position,dt.quaternion,dt.scale),dt.translateX(Pr),dt.translateZ(Ln),dt.matrixWorld.compose(dt.position,dt.quaternion,dt.scale),dt.matrixWorldInverse.copy(dt.matrixWorld).invert(),wn[10]===-1)dt.projectionMatrix.copy(Dt.projectionMatrix),dt.projectionMatrixInverse.copy(Dt.projectionMatrixInverse);else{const sr=qn+Ln,dr=ni+Ln,mi=li-Pr,Oe=Ti+(qt-Pr),_e=ai*ni/dr*sr,Ct=qr*ni/dr*sr;dt.projectionMatrix.makePerspective(mi,Oe,_e,Ct,sr,dr),dt.projectionMatrixInverse.copy(dt.projectionMatrix).invert()}}function lt(dt,Dt){Dt===null?dt.matrixWorld.copy(dt.matrix):dt.matrixWorld.multiplyMatrices(Dt.matrixWorld,dt.matrix),dt.matrixWorldInverse.copy(dt.matrixWorld).invert()}this.updateCamera=function(dt){if(r===null)return;let Dt=dt.near,gn=dt.far;L.texture!==null&&(L.depthNear>0&&(Dt=L.depthNear),L.depthFar>0&&(gn=L.depthFar)),le.near=Q.near=ce.near=Dt,le.far=Q.far=ce.far=gn,(J!==le.near||Ue!==le.far)&&(r.updateRenderState({depthNear:le.near,depthFar:le.far}),J=le.near,Ue=le.far),ce.layers.mask=dt.layers.mask|2,Q.layers.mask=dt.layers.mask|4,le.layers.mask=ce.layers.mask|Q.layers.mask;const qt=dt.parent,wn=le.cameras;lt(le,qt);for(let nr=0;nr<wn.length;nr++)lt(wn[nr],qt);wn.length===2?Ae(le,ce,Q):le.projectionMatrix.copy(ce.projectionMatrix),pt(dt,le,qt)};function pt(dt,Dt,gn){gn===null?dt.matrix.copy(Dt.matrixWorld):(dt.matrix.copy(gn.matrixWorld),dt.matrix.invert(),dt.matrix.multiply(Dt.matrixWorld)),dt.matrix.decompose(dt.position,dt.quaternion,dt.scale),dt.updateMatrixWorld(!0),dt.projectionMatrix.copy(Dt.projectionMatrix),dt.projectionMatrixInverse.copy(Dt.projectionMatrixInverse),dt.isPerspectiveCamera&&(dt.fov=D_*2*Math.atan(1/dt.projectionMatrix.elements[5]),dt.zoom=1)}this.getCamera=function(){return le},this.getFoveation=function(){if(!(S===null&&C===null))return h},this.setFoveation=function(dt){h=dt,S!==null&&(S.fixedFoveation=dt),C!==null&&C.fixedFoveation!==void 0&&(C.fixedFoveation=dt)},this.hasDepthSensing=function(){return L.texture!==null},this.getDepthSensingMesh=function(){return L.getMesh(le)};let De=null;function _t(dt,Dt){if(v=Dt.getViewerPose(p||a),I=Dt,v!==null){const gn=v.views;C!==null&&(e.setRenderTargetFramebuffer($,C.framebuffer),e.setRenderTarget($));let qt=!1;gn.length!==le.cameras.length&&(le.cameras.length=0,qt=!0);for(let qn=0;qn<gn.length;qn++){const ni=gn[qn];let ai=null;if(C!==null)ai=C.getViewport(ni);else{const $e=x.getViewSubImage(S,ni);ai=$e.viewport,qn===0&&(e.setRenderTargetTextures($,$e.colorTexture,$e.depthStencilTexture),e.setRenderTarget($))}let qr=ae[qn];qr===void 0&&(qr=new La,qr.layers.enable(qn),qr.viewport=new Pi,ae[qn]=qr),qr.matrix.fromArray(ni.transform.matrix),qr.matrix.decompose(qr.position,qr.quaternion,qr.scale),qr.projectionMatrix.fromArray(ni.projectionMatrix),qr.projectionMatrixInverse.copy(qr.projectionMatrix).invert(),qr.viewport.set(ai.x,ai.y,ai.width,ai.height),qn===0&&(le.matrix.copy(qr.matrix),le.matrix.decompose(le.position,le.quaternion,le.scale)),qt===!0&&le.cameras.push(qr)}const wn=r.enabledFeatures;if(wn&&wn.includes("depth-sensing")&&r.depthUsage=="gpu-optimized"&&x){const qn=x.getDepthInformation(gn[0]);qn&&qn.isValid&&qn.texture&&L.init(e,qn,r.renderState)}}for(let gn=0;gn<Z.length;gn++){const qt=k[gn],wn=Z[gn];qt!==null&&wn!==void 0&&wn.update(qt,Dt,p||a)}De&&De(dt,Dt),Dt.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:Dt}),I=null}const Jt=new X9e;Jt.setAnimationLoop(_t),this.setAnimationLoop=function(dt){De=dt},this.dispose=function(){}}}const B8=new na,eIe=new vr;function tIe(o,e){function t(U,R){U.matrixAutoUpdate===!0&&U.updateMatrix(),R.value.copy(U.matrix)}function n(U,R){R.color.getRGB(U.fogColor.value,M9e(o)),R.isFog?(U.fogNear.value=R.near,U.fogFar.value=R.far):R.isFogExp2&&(U.fogDensity.value=R.density)}function r(U,R,$,Z,k){R.isMeshBasicMaterial||R.isMeshLambertMaterial?i(U,R):R.isMeshToonMaterial?(i(U,R),x(U,R)):R.isMeshPhongMaterial?(i(U,R),v(U,R)):R.isMeshStandardMaterial?(i(U,R),S(U,R),R.isMeshPhysicalMaterial&&C(U,R,k)):R.isMeshMatcapMaterial?(i(U,R),I(U,R)):R.isMeshDepthMaterial?i(U,R):R.isMeshDistanceMaterial?(i(U,R),L(U,R)):R.isMeshNormalMaterial?i(U,R):R.isLineBasicMaterial?(a(U,R),R.isLineDashedMaterial&&c(U,R)):R.isPointsMaterial?h(U,R,$,Z):R.isSpriteMaterial?p(U,R):R.isShadowMaterial?(U.color.value.copy(R.color),U.opacity.value=R.opacity):R.isShaderMaterial&&(R.uniformsNeedUpdate=!1)}function i(U,R){U.opacity.value=R.opacity,R.color&&U.diffuse.value.copy(R.color),R.emissive&&U.emissive.value.copy(R.emissive).multiplyScalar(R.emissiveIntensity),R.map&&(U.map.value=R.map,t(R.map,U.mapTransform)),R.alphaMap&&(U.alphaMap.value=R.alphaMap,t(R.alphaMap,U.alphaMapTransform)),R.bumpMap&&(U.bumpMap.value=R.bumpMap,t(R.bumpMap,U.bumpMapTransform),U.bumpScale.value=R.bumpScale,R.side===u0&&(U.bumpScale.value*=-1)),R.normalMap&&(U.normalMap.value=R.normalMap,t(R.normalMap,U.normalMapTransform),U.normalScale.value.copy(R.normalScale),R.side===u0&&U.normalScale.value.negate()),R.displacementMap&&(U.displacementMap.value=R.displacementMap,t(R.displacementMap,U.displacementMapTransform),U.displacementScale.value=R.displacementScale,U.displacementBias.value=R.displacementBias),R.emissiveMap&&(U.emissiveMap.value=R.emissiveMap,t(R.emissiveMap,U.emissiveMapTransform)),R.specularMap&&(U.specularMap.value=R.specularMap,t(R.specularMap,U.specularMapTransform)),R.alphaTest>0&&(U.alphaTest.value=R.alphaTest);const $=e.get(R),Z=$.envMap,k=$.envMapRotation;Z&&(U.envMap.value=Z,B8.copy(k),B8.x*=-1,B8.y*=-1,B8.z*=-1,Z.isCubeTexture&&Z.isRenderTargetTexture===!1&&(B8.y*=-1,B8.z*=-1),U.envMapRotation.value.setFromMatrix4(eIe.makeRotationFromEuler(B8)),U.flipEnvMap.value=Z.isCubeTexture&&Z.isRenderTargetTexture===!1?-1:1,U.reflectivity.value=R.reflectivity,U.ior.value=R.ior,U.refractionRatio.value=R.refractionRatio),R.lightMap&&(U.lightMap.value=R.lightMap,U.lightMapIntensity.value=R.lightMapIntensity,t(R.lightMap,U.lightMapTransform)),R.aoMap&&(U.aoMap.value=R.aoMap,U.aoMapIntensity.value=R.aoMapIntensity,t(R.aoMap,U.aoMapTransform))}function a(U,R){U.diffuse.value.copy(R.color),U.opacity.value=R.opacity,R.map&&(U.map.value=R.map,t(R.map,U.mapTransform))}function c(U,R){U.dashSize.value=R.dashSize,U.totalSize.value=R.dashSize+R.gapSize,U.scale.value=R.scale}function h(U,R,$,Z){U.diffuse.value.copy(R.color),U.opacity.value=R.opacity,U.size.value=R.size*$,U.scale.value=Z*.5,R.map&&(U.map.value=R.map,t(R.map,U.uvTransform)),R.alphaMap&&(U.alphaMap.value=R.alphaMap,t(R.alphaMap,U.alphaMapTransform)),R.alphaTest>0&&(U.alphaTest.value=R.alphaTest)}function p(U,R){U.diffuse.value.copy(R.color),U.opacity.value=R.opacity,U.rotation.value=R.rotation,R.map&&(U.map.value=R.map,t(R.map,U.mapTransform)),R.alphaMap&&(U.alphaMap.value=R.alphaMap,t(R.alphaMap,U.alphaMapTransform)),R.alphaTest>0&&(U.alphaTest.value=R.alphaTest)}function v(U,R){U.specular.value.copy(R.specular),U.shininess.value=Math.max(R.shininess,1e-4)}function x(U,R){R.gradientMap&&(U.gradientMap.value=R.gradientMap)}function S(U,R){U.metalness.value=R.metalness,R.metalnessMap&&(U.metalnessMap.value=R.metalnessMap,t(R.metalnessMap,U.metalnessMapTransform)),U.roughness.value=R.roughness,R.roughnessMap&&(U.roughnessMap.value=R.roughnessMap,t(R.roughnessMap,U.roughnessMapTransform)),R.envMap&&(U.envMapIntensity.value=R.envMapIntensity)}function C(U,R,$){U.ior.value=R.ior,R.sheen>0&&(U.sheenColor.value.copy(R.sheenColor).multiplyScalar(R.sheen),U.sheenRoughness.value=R.sheenRoughness,R.sheenColorMap&&(U.sheenColorMap.value=R.sheenColorMap,t(R.sheenColorMap,U.sheenColorMapTransform)),R.sheenRoughnessMap&&(U.sheenRoughnessMap.value=R.sheenRoughnessMap,t(R.sheenRoughnessMap,U.sheenRoughnessMapTransform))),R.clearcoat>0&&(U.clearcoat.value=R.clearcoat,U.clearcoatRoughness.value=R.clearcoatRoughness,R.clearcoatMap&&(U.clearcoatMap.value=R.clearcoatMap,t(R.clearcoatMap,U.clearcoatMapTransform)),R.clearcoatRoughnessMap&&(U.clearcoatRoughnessMap.value=R.clearcoatRoughnessMap,t(R.clearcoatRoughnessMap,U.clearcoatRoughnessMapTransform)),R.clearcoatNormalMap&&(U.clearcoatNormalMap.value=R.clearcoatNormalMap,t(R.clearcoatNormalMap,U.clearcoatNormalMapTransform),U.clearcoatNormalScale.value.copy(R.clearcoatNormalScale),R.side===u0&&U.clearcoatNormalScale.value.negate())),R.dispersion>0&&(U.dispersion.value=R.dispersion),R.iridescence>0&&(U.iridescence.value=R.iridescence,U.iridescenceIOR.value=R.iridescenceIOR,U.iridescenceThicknessMinimum.value=R.iridescenceThicknessRange[0],U.iridescenceThicknessMaximum.value=R.iridescenceThicknessRange[1],R.iridescenceMap&&(U.iridescenceMap.value=R.iridescenceMap,t(R.iridescenceMap,U.iridescenceMapTransform)),R.iridescenceThicknessMap&&(U.iridescenceThicknessMap.value=R.iridescenceThicknessMap,t(R.iridescenceThicknessMap,U.iridescenceThicknessMapTransform))),R.transmission>0&&(U.transmission.value=R.transmission,U.transmissionSamplerMap.value=$.texture,U.transmissionSamplerSize.value.set($.width,$.height),R.transmissionMap&&(U.transmissionMap.value=R.transmissionMap,t(R.transmissionMap,U.transmissionMapTransform)),U.thickness.value=R.thickness,R.thicknessMap&&(U.thicknessMap.value=R.thicknessMap,t(R.thicknessMap,U.thicknessMapTransform)),U.attenuationDistance.value=R.attenuationDistance,U.attenuationColor.value.copy(R.attenuationColor)),R.anisotropy>0&&(U.anisotropyVector.value.set(R.anisotropy*Math.cos(R.anisotropyRotation),R.anisotropy*Math.sin(R.anisotropyRotation)),R.anisotropyMap&&(U.anisotropyMap.value=R.anisotropyMap,t(R.anisotropyMap,U.anisotropyMapTransform))),U.specularIntensity.value=R.specularIntensity,U.specularColor.value.copy(R.specularColor),R.specularColorMap&&(U.specularColorMap.value=R.specularColorMap,t(R.specularColorMap,U.specularColorMapTransform)),R.specularIntensityMap&&(U.specularIntensityMap.value=R.specularIntensityMap,t(R.specularIntensityMap,U.specularIntensityMapTransform))}function I(U,R){R.matcap&&(U.matcap.value=R.matcap)}function L(U,R){const $=e.get(R).light;U.referencePosition.value.setFromMatrixPosition($.matrixWorld),U.nearDistance.value=$.shadow.camera.near,U.farDistance.value=$.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:r}}function nIe(o,e,t,n){let r={},i={},a=[];const c=o.getParameter(o.MAX_UNIFORM_BUFFER_BINDINGS);function h($,Z){const k=Z.program;n.uniformBlockBinding($,k)}function p($,Z){let k=r[$.id];k===void 0&&(I($),k=v($),r[$.id]=k,$.addEventListener("dispose",U));const ie=Z.program;n.updateUBOMapping($,ie);const ue=e.render.frame;i[$.id]!==ue&&(S($),i[$.id]=ue)}function v($){const Z=x();$.__bindingPointIndex=Z;const k=o.createBuffer(),ie=$.__size,ue=$.usage;return o.bindBuffer(o.UNIFORM_BUFFER,k),o.bufferData(o.UNIFORM_BUFFER,ie,ue),o.bindBuffer(o.UNIFORM_BUFFER,null),o.bindBufferBase(o.UNIFORM_BUFFER,Z,k),k}function x(){for(let $=0;$<c;$++)if(a.indexOf($)===-1)return a.push($),$;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function S($){const Z=r[$.id],k=$.uniforms,ie=$.__cache;o.bindBuffer(o.UNIFORM_BUFFER,Z);for(let ue=0,ce=k.length;ue<ce;ue++){const Q=Array.isArray(k[ue])?k[ue]:[k[ue]];for(let ae=0,le=Q.length;ae<le;ae++){const J=Q[ae];if(C(J,ue,ae,ie)===!0){const Ue=J.__offset,je=Array.isArray(J.value)?J.value:[J.value];let rt=0;for(let at=0;at<je.length;at++){const Se=je[at],gt=L(Se);typeof Se=="number"||typeof Se=="boolean"?(J.__data[0]=Se,o.bufferSubData(o.UNIFORM_BUFFER,Ue+rt,J.__data)):Se.isMatrix3?(J.__data[0]=Se.elements[0],J.__data[1]=Se.elements[1],J.__data[2]=Se.elements[2],J.__data[3]=0,J.__data[4]=Se.elements[3],J.__data[5]=Se.elements[4],J.__data[6]=Se.elements[5],J.__data[7]=0,J.__data[8]=Se.elements[6],J.__data[9]=Se.elements[7],J.__data[10]=Se.elements[8],J.__data[11]=0):(Se.toArray(J.__data,rt),rt+=gt.storage/Float32Array.BYTES_PER_ELEMENT)}o.bufferSubData(o.UNIFORM_BUFFER,Ue,J.__data)}}}o.bindBuffer(o.UNIFORM_BUFFER,null)}function C($,Z,k,ie){const ue=$.value,ce=Z+"_"+k;if(ie[ce]===void 0)return typeof ue=="number"||typeof ue=="boolean"?ie[ce]=ue:ie[ce]=ue.clone(),!0;{const Q=ie[ce];if(typeof ue=="number"||typeof ue=="boolean"){if(Q!==ue)return ie[ce]=ue,!0}else if(Q.equals(ue)===!1)return Q.copy(ue),!0}return!1}function I($){const Z=$.uniforms;let k=0;const ie=16;for(let ce=0,Q=Z.length;ce<Q;ce++){const ae=Array.isArray(Z[ce])?Z[ce]:[Z[ce]];for(let le=0,J=ae.length;le<J;le++){const Ue=ae[le],je=Array.isArray(Ue.value)?Ue.value:[Ue.value];for(let rt=0,at=je.length;rt<at;rt++){const Se=je[rt],gt=L(Se),Ae=k%ie,lt=Ae%gt.boundary,pt=Ae+lt;k+=lt,pt!==0&&ie-pt<gt.storage&&(k+=ie-pt),Ue.__data=new Float32Array(gt.storage/Float32Array.BYTES_PER_ELEMENT),Ue.__offset=k,k+=gt.storage}}}const ue=k%ie;return ue>0&&(k+=ie-ue),$.__size=k,$.__cache={},this}function L($){const Z={boundary:0,storage:0};return typeof $=="number"||typeof $=="boolean"?(Z.boundary=4,Z.storage=4):$.isVector2?(Z.boundary=8,Z.storage=8):$.isVector3||$.isColor?(Z.boundary=16,Z.storage=12):$.isVector4?(Z.boundary=16,Z.storage=16):$.isMatrix3?(Z.boundary=48,Z.storage=48):$.isMatrix4?(Z.boundary=64,Z.storage=64):$.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",$),Z}function U($){const Z=$.target;Z.removeEventListener("dispose",U);const k=a.indexOf(Z.__bindingPointIndex);a.splice(k,1),o.deleteBuffer(r[Z.id]),delete r[Z.id],delete i[Z.id]}function R(){for(const $ in r)o.deleteBuffer(r[$]);a=[],r={},i={}}return{bind:h,update:p,dispose:R}}class tE{constructor(e={}){const{canvas:t=ITe(),context:n=null,depth:r=!0,stencil:i=!1,alpha:a=!1,antialias:c=!1,premultipliedAlpha:h=!0,preserveDrawingBuffer:p=!1,powerPreference:v="default",failIfMajorPerformanceCaveat:x=!1,reverseDepthBuffer:S=!1}=e;this.isWebGLRenderer=!0;let C;if(n!==null){if(typeof WebGLRenderingContext<"u"&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");C=n.getContextAttributes().alpha}else C=a;const I=new Uint32Array(4),L=new Int32Array(4);let U=null,R=null;const $=[],Z=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=Jp,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const k=this;let ie=!1;this._outputColorSpace=ys;let ue=0,ce=0,Q=null,ae=-1,le=null;const J=new Pi,Ue=new Pi;let je=null;const rt=new Vn(0);let at=0,Se=t.width,gt=t.height,Ae=1,lt=null,pt=null;const De=new Pi(0,0,Se,gt),_t=new Pi(0,0,Se,gt);let Jt=!1;const dt=new OH;let Dt=!1,gn=!1;const qt=new vr,wn=new vr,nr=new Ie,qn=new Pi,ni={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let ai=!1;function qr(){return Q===null?Ae:1}let $e=n;function Ls(we,st){return t.getContext(we,st)}try{const we={alpha:!0,depth:r,stencil:i,antialias:c,premultipliedAlpha:h,preserveDrawingBuffer:p,powerPreference:v,failIfMajorPerformanceCaveat:x};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${oH}`),t.addEventListener("webglcontextlost",Nn,!1),t.addEventListener("webglcontextrestored",ln,!1),t.addEventListener("webglcontextcreationerror",en,!1),$e===null){const st="webgl2";if($e=Ls(st,we),$e===null)throw Ls(st)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(we){throw console.error("THREE.WebGLRenderer: "+we.message),we}let li,Ti,Ln,Pr,sr,dr,mi,Oe,_e,Ct,Kt,Zt,jt,or,An,Gn,ar,Qt,jn,Cr,gr,Pn,wr,Ze;function Tn(){li=new fRe($e),li.init(),Pn=new Yke($e,li),Ti=new oRe($e,li,e,Pn),Ln=new qke($e,li),Ti.reverseDepthBuffer&&S&&Ln.buffers.depth.setReversed(!0),Pr=new gRe($e),sr=new Dke,dr=new Xke($e,li,Ln,sr,Ti,Pn,Pr),mi=new lRe(k),Oe=new dRe(k),_e=new SCe($e),wr=new iRe($e,_e),Ct=new pRe($e,_e,Pr,wr),Kt=new vRe($e,Ct,_e,Pr),jn=new yRe($e,Ti,dr),Gn=new aRe(sr),Zt=new Nke(k,mi,Oe,li,Ti,wr,Gn),jt=new tIe(k,sr),or=new Fke,An=new Gke(li),Qt=new rRe(k,mi,Oe,Ln,Kt,C,h),ar=new Wke(k,Kt,Ti),Ze=new nIe($e,Pr,Ti,Ln),Cr=new sRe($e,li,Pr),gr=new mRe($e,li,Pr),Pr.programs=Zt.programs,k.capabilities=Ti,k.extensions=li,k.properties=sr,k.renderLists=or,k.shadowMap=ar,k.state=Ln,k.info=Pr}Tn();const nn=new Jke(k,$e);this.xr=nn,this.getContext=function(){return $e},this.getContextAttributes=function(){return $e.getContextAttributes()},this.forceContextLoss=function(){const we=li.get("WEBGL_lose_context");we&&we.loseContext()},this.forceContextRestore=function(){const we=li.get("WEBGL_lose_context");we&&we.restoreContext()},this.getPixelRatio=function(){return Ae},this.setPixelRatio=function(we){we!==void 0&&(Ae=we,this.setSize(Se,gt,!1))},this.getSize=function(we){return we.set(Se,gt)},this.setSize=function(we,st,Pt=!0){if(nn.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}Se=we,gt=st,t.width=Math.floor(we*Ae),t.height=Math.floor(st*Ae),Pt===!0&&(t.style.width=we+"px",t.style.height=st+"px"),this.setViewport(0,0,we,st)},this.getDrawingBufferSize=function(we){return we.set(Se*Ae,gt*Ae).floor()},this.setDrawingBufferSize=function(we,st,Pt){Se=we,gt=st,Ae=Pt,t.width=Math.floor(we*Pt),t.height=Math.floor(st*Pt),this.setViewport(0,0,we,st)},this.getCurrentViewport=function(we){return we.copy(J)},this.getViewport=function(we){return we.copy(De)},this.setViewport=function(we,st,Pt,bt){we.isVector4?De.set(we.x,we.y,we.z,we.w):De.set(we,st,Pt,bt),Ln.viewport(J.copy(De).multiplyScalar(Ae).round())},this.getScissor=function(we){return we.copy(_t)},this.setScissor=function(we,st,Pt,bt){we.isVector4?_t.set(we.x,we.y,we.z,we.w):_t.set(we,st,Pt,bt),Ln.scissor(Ue.copy(_t).multiplyScalar(Ae).round())},this.getScissorTest=function(){return Jt},this.setScissorTest=function(we){Ln.setScissorTest(Jt=we)},this.setOpaqueSort=function(we){lt=we},this.setTransparentSort=function(we){pt=we},this.getClearColor=function(we){return we.copy(Qt.getClearColor())},this.setClearColor=function(){Qt.setClearColor(...arguments)},this.getClearAlpha=function(){return Qt.getClearAlpha()},this.setClearAlpha=function(){Qt.setClearAlpha(...arguments)},this.clear=function(we=!0,st=!0,Pt=!0){let bt=0;if(we){let ht=!1;if(Q!==null){const yn=Q.texture.format;ht=yn===EH||yn===wH||yn===SH}if(ht){const yn=Q.texture.type,On=yn===n1||yn===y6||yn===fE||yn===pE||yn===xH||yn===bH,Un=Qt.getClearColor(),Hn=Qt.getClearAlpha(),lr=Un.r,yr=Un.g,Yn=Un.b;On?(I[0]=lr,I[1]=yr,I[2]=Yn,I[3]=Hn,$e.clearBufferuiv($e.COLOR,0,I)):(L[0]=lr,L[1]=yr,L[2]=Yn,L[3]=Hn,$e.clearBufferiv($e.COLOR,0,L))}else bt|=$e.COLOR_BUFFER_BIT}st&&(bt|=$e.DEPTH_BUFFER_BIT),Pt&&(bt|=$e.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),$e.clear(bt)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Nn,!1),t.removeEventListener("webglcontextrestored",ln,!1),t.removeEventListener("webglcontextcreationerror",en,!1),Qt.dispose(),or.dispose(),An.dispose(),sr.dispose(),mi.dispose(),Oe.dispose(),Kt.dispose(),wr.dispose(),Ze.dispose(),Zt.dispose(),nn.dispose(),nn.removeEventListener("sessionstart",Cc),nn.removeEventListener("sessionend",Ms),Us.stop()};function Nn(we){we.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),ie=!0}function ln(){console.log("THREE.WebGLRenderer: Context Restored."),ie=!1;const we=Pr.autoReset,st=ar.enabled,Pt=ar.autoUpdate,bt=ar.needsUpdate,ht=ar.type;Tn(),Pr.autoReset=we,ar.enabled=st,ar.autoUpdate=Pt,ar.needsUpdate=bt,ar.type=ht}function en(we){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",we.statusMessage)}function Xn(we){const st=we.target;st.removeEventListener("dispose",Xn),Sr(st)}function Sr(we){_i(we),sr.remove(we)}function _i(we){const st=sr.get(we).programs;st!==void 0&&(st.forEach(function(Pt){Zt.releaseProgram(Pt)}),we.isShaderMaterial&&Zt.releaseShaderCache(we))}this.renderBufferDirect=function(we,st,Pt,bt,ht,yn){st===null&&(st=ni);const On=ht.isMesh&&ht.matrixWorld.determinant()<0,Un=Dh(we,st,Pt,bt,ht);Ln.setMaterial(bt,On);let Hn=Pt.index,lr=1;if(bt.wireframe===!0){if(Hn=Ct.getWireframeAttribute(Pt),Hn===void 0)return;lr=2}const yr=Pt.drawRange,Yn=Pt.attributes.position;let Fr=yr.start*lr,Lr=(yr.start+yr.count)*lr;yn!==null&&(Fr=Math.max(Fr,yn.start*lr),Lr=Math.min(Lr,(yn.start+yn.count)*lr)),Hn!==null?(Fr=Math.max(Fr,0),Lr=Math.min(Lr,Hn.count)):Yn!=null&&(Fr=Math.max(Fr,0),Lr=Math.min(Lr,Yn.count));const Ii=Lr-Fr;if(Ii<0||Ii===1/0)return;wr.setup(ht,bt,Un,Pt,Hn);let Xi,ri=Cr;if(Hn!==null&&(Xi=_e.get(Hn),ri=gr,ri.setIndex(Xi)),ht.isMesh)bt.wireframe===!0?(Ln.setLineWidth(bt.wireframeLinewidth*qr()),ri.setMode($e.LINES)):ri.setMode($e.TRIANGLES);else if(ht.isLine){let Jn=bt.linewidth;Jn===void 0&&(Jn=1),Ln.setLineWidth(Jn*qr()),ht.isLineSegments?ri.setMode($e.LINES):ht.isLineLoop?ri.setMode($e.LINE_LOOP):ri.setMode($e.LINE_STRIP)}else ht.isPoints?ri.setMode($e.POINTS):ht.isSprite&&ri.setMode($e.TRIANGLES);if(ht.isBatchedMesh)if(ht._multiDrawInstances!==null)x_("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),ri.renderMultiDrawInstances(ht._multiDrawStarts,ht._multiDrawCounts,ht._multiDrawCount,ht._multiDrawInstances);else if(li.get("WEBGL_multi_draw"))ri.renderMultiDraw(ht._multiDrawStarts,ht._multiDrawCounts,ht._multiDrawCount);else{const Jn=ht._multiDrawStarts,Yi=ht._multiDrawCounts,Qr=ht._multiDrawCount,Cs=Hn?_e.get(Hn).bytesPerElement:1,Ba=sr.get(bt).currentProgram.getUniforms();for(let ko=0;ko<Qr;ko++)Ba.setValue($e,"_gl_DrawID",ko),ri.render(Jn[ko]/Cs,Yi[ko])}else if(ht.isInstancedMesh)ri.renderInstances(Fr,Ii,ht.count);else if(Pt.isInstancedBufferGeometry){const Jn=Pt._maxInstanceCount!==void 0?Pt._maxInstanceCount:1/0,Yi=Math.min(Pt.instanceCount,Jn);ri.renderInstances(Fr,Ii,Yi)}else ri.render(Fr,Ii)};function Zr(we,st,Pt){we.transparent===!0&&we.side===wh&&we.forceSinglePass===!1?(we.side=u0,we.needsUpdate=!0,Mu(we,st,Pt),we.side=Rg,we.needsUpdate=!0,Mu(we,st,Pt),we.side=wh):Mu(we,st,Pt)}this.compile=function(we,st,Pt=null){Pt===null&&(Pt=we),R=An.get(Pt),R.init(st),Z.push(R),Pt.traverseVisible(function(ht){ht.isLight&&ht.layers.test(st.layers)&&(R.pushLight(ht),ht.castShadow&&R.pushShadow(ht))}),we!==Pt&&we.traverseVisible(function(ht){ht.isLight&&ht.layers.test(st.layers)&&(R.pushLight(ht),ht.castShadow&&R.pushShadow(ht))}),R.setupLights();const bt=new Set;return we.traverse(function(ht){if(!(ht.isMesh||ht.isPoints||ht.isLine||ht.isSprite))return;const yn=ht.material;if(yn)if(Array.isArray(yn))for(let On=0;On<yn.length;On++){const Un=yn[On];Zr(Un,Pt,ht),bt.add(Un)}else Zr(yn,Pt,ht),bt.add(yn)}),R=Z.pop(),bt},this.compileAsync=function(we,st,Pt=null){const bt=this.compile(we,st,Pt);return new Promise(ht=>{function yn(){if(bt.forEach(function(On){sr.get(On).currentProgram.isReady()&&bt.delete(On)}),bt.size===0){ht(we);return}setTimeout(yn,10)}li.get("KHR_parallel_shader_compile")!==null?yn():setTimeout(yn,10)})};let Bs=null;function so(we){Bs&&Bs(we)}function Cc(){Us.stop()}function Ms(){Us.start()}const Us=new X9e;Us.setAnimationLoop(so),typeof self<"u"&&Us.setContext(self),this.setAnimationLoop=function(we){Bs=we,nn.setAnimationLoop(we),we===null?Us.stop():Us.start()},nn.addEventListener("sessionstart",Cc),nn.addEventListener("sessionend",Ms),this.render=function(we,st){if(st!==void 0&&st.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(ie===!0)return;if(we.matrixWorldAutoUpdate===!0&&we.updateMatrixWorld(),st.parent===null&&st.matrixWorldAutoUpdate===!0&&st.updateMatrixWorld(),nn.enabled===!0&&nn.isPresenting===!0&&(nn.cameraAutoUpdate===!0&&nn.updateCamera(st),st=nn.getCamera()),we.isScene===!0&&we.onBeforeRender(k,we,st,Q),R=An.get(we,Z.length),R.init(st),Z.push(R),wn.multiplyMatrices(st.projectionMatrix,st.matrixWorldInverse),dt.setFromProjectionMatrix(wn),gn=this.localClippingEnabled,Dt=Gn.init(this.clippingPlanes,gn),U=or.get(we,$.length),U.init(),$.push(U),nn.enabled===!0&&nn.isPresenting===!0){const yn=k.xr.getDepthSensingMesh();yn!==null&&h0(yn,st,-1/0,k.sortObjects)}h0(we,st,0,k.sortObjects),U.finish(),k.sortObjects===!0&&U.sort(lt,pt),ai=nn.enabled===!1||nn.isPresenting===!1||nn.hasDepthSensing()===!1,ai&&Qt.addToRenderList(U,we),this.info.render.frame++,Dt===!0&&Gn.beginShadows();const Pt=R.state.shadowsArray;ar.render(Pt,we,st),Dt===!0&&Gn.endShadows(),this.info.autoReset===!0&&this.info.reset();const bt=U.opaque,ht=U.transmissive;if(R.setupLights(),st.isArrayCamera){const yn=st.cameras;if(ht.length>0)for(let On=0,Un=yn.length;On<Un;On++){const Hn=yn[On];$0(bt,ht,we,Hn)}ai&&Qt.render(we);for(let On=0,Un=yn.length;On<Un;On++){const Hn=yn[On];Fl(U,we,Hn,Hn.viewport)}}else ht.length>0&&$0(bt,ht,we,st),ai&&Qt.render(we),Fl(U,we,st);Q!==null&&ce===0&&(dr.updateMultisampleRenderTarget(Q),dr.updateRenderTargetMipmap(Q)),we.isScene===!0&&we.onAfterRender(k,we,st),wr.resetDefaultState(),ae=-1,le=null,Z.pop(),Z.length>0?(R=Z[Z.length-1],Dt===!0&&Gn.setGlobalState(k.clippingPlanes,R.state.camera)):R=null,$.pop(),$.length>0?U=$[$.length-1]:U=null};function h0(we,st,Pt,bt){if(we.visible===!1)return;if(we.layers.test(st.layers)){if(we.isGroup)Pt=we.renderOrder;else if(we.isLOD)we.autoUpdate===!0&&we.update(st);else if(we.isLight)R.pushLight(we),we.castShadow&&R.pushShadow(we);else if(we.isSprite){if(!we.frustumCulled||dt.intersectsSprite(we)){bt&&qn.setFromMatrixPosition(we.matrixWorld).applyMatrix4(wn);const On=Kt.update(we),Un=we.material;Un.visible&&U.push(we,On,Un,Pt,qn.z,null)}}else if((we.isMesh||we.isLine||we.isPoints)&&(!we.frustumCulled||dt.intersectsObject(we))){const On=Kt.update(we),Un=we.material;if(bt&&(we.boundingSphere!==void 0?(we.boundingSphere===null&&we.computeBoundingSphere(),qn.copy(we.boundingSphere.center)):(On.boundingSphere===null&&On.computeBoundingSphere(),qn.copy(On.boundingSphere.center)),qn.applyMatrix4(we.matrixWorld).applyMatrix4(wn)),Array.isArray(Un)){const Hn=On.groups;for(let lr=0,yr=Hn.length;lr<yr;lr++){const Yn=Hn[lr],Fr=Un[Yn.materialIndex];Fr&&Fr.visible&&U.push(we,On,Fr,Pt,qn.z,Yn)}}else Un.visible&&U.push(we,On,Un,Pt,qn.z,null)}}const yn=we.children;for(let On=0,Un=yn.length;On<Un;On++)h0(yn[On],st,Pt,bt)}function Fl(we,st,Pt,bt){const ht=we.opaque,yn=we.transmissive,On=we.transparent;R.setupLightsView(Pt),Dt===!0&&Gn.setGlobalState(k.clippingPlanes,Pt),bt&&Ln.viewport(J.copy(bt)),ht.length>0&&Ro(ht,st,Pt),yn.length>0&&Ro(yn,st,Pt),On.length>0&&Ro(On,st,Pt),Ln.buffers.depth.setTest(!0),Ln.buffers.depth.setMask(!0),Ln.buffers.color.setMask(!0),Ln.setPolygonOffset(!1)}function $0(we,st,Pt,bt){if((Pt.isScene===!0?Pt.overrideMaterial:null)!==null)return;R.state.transmissionRenderTarget[bt.id]===void 0&&(R.state.transmissionRenderTarget[bt.id]=new _6(1,1,{generateMipmaps:!0,type:li.has("EXT_color_buffer_half_float")||li.has("EXT_color_buffer_float")?v6:n1,minFilter:u6,samples:4,stencilBuffer:i,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Kr.workingColorSpace}));const yn=R.state.transmissionRenderTarget[bt.id],On=bt.viewport||J;yn.setSize(On.z*k.transmissionResolutionScale,On.w*k.transmissionResolutionScale);const Un=k.getRenderTarget();k.setRenderTarget(yn),k.getClearColor(rt),at=k.getClearAlpha(),at<1&&k.setClearColor(16777215,.5),k.clear(),ai&&Qt.render(Pt);const Hn=k.toneMapping;k.toneMapping=Jp;const lr=bt.viewport;if(bt.viewport!==void 0&&(bt.viewport=void 0),R.setupLightsView(bt),Dt===!0&&Gn.setGlobalState(k.clippingPlanes,bt),Ro(we,Pt,bt),dr.updateMultisampleRenderTarget(yn),dr.updateRenderTargetMipmap(yn),li.has("WEBGL_multisampled_render_to_texture")===!1){let yr=!1;for(let Yn=0,Fr=st.length;Yn<Fr;Yn++){const Lr=st[Yn],Ii=Lr.object,Xi=Lr.geometry,ri=Lr.material,Jn=Lr.group;if(ri.side===wh&&Ii.layers.test(bt.layers)){const Yi=ri.side;ri.side=u0,ri.needsUpdate=!0,Tu(Ii,Pt,bt,Xi,ri,Jn),ri.side=Yi,ri.needsUpdate=!0,yr=!0}}yr===!0&&(dr.updateMultisampleRenderTarget(yn),dr.updateRenderTargetMipmap(yn))}k.setRenderTarget(Un),k.setClearColor(rt,at),lr!==void 0&&(bt.viewport=lr),k.toneMapping=Hn}function Ro(we,st,Pt){const bt=st.isScene===!0?st.overrideMaterial:null;for(let ht=0,yn=we.length;ht<yn;ht++){const On=we[ht],Un=On.object,Hn=On.geometry,lr=On.group;let yr=On.material;yr.allowOverride===!0&&bt!==null&&(yr=bt),Un.layers.test(Pt.layers)&&Tu(Un,st,Pt,Hn,yr,lr)}}function Tu(we,st,Pt,bt,ht,yn){we.onBeforeRender(k,st,Pt,bt,ht,yn),we.modelViewMatrix.multiplyMatrices(Pt.matrixWorldInverse,we.matrixWorld),we.normalMatrix.getNormalMatrix(we.modelViewMatrix),ht.onBeforeRender(k,st,Pt,bt,we,yn),ht.transparent===!0&&ht.side===wh&&ht.forceSinglePass===!1?(ht.side=u0,ht.needsUpdate=!0,k.renderBufferDirect(Pt,st,bt,ht,we,yn),ht.side=Rg,ht.needsUpdate=!0,k.renderBufferDirect(Pt,st,bt,ht,we,yn),ht.side=wh):k.renderBufferDirect(Pt,st,bt,ht,we,yn),we.onAfterRender(k,st,Pt,bt,ht,yn)}function Mu(we,st,Pt){st.isScene!==!0&&(st=ni);const bt=sr.get(we),ht=R.state.lights,yn=R.state.shadowsArray,On=ht.state.version,Un=Zt.getParameters(we,ht.state,yn,st,Pt),Hn=Zt.getProgramCacheKey(Un);let lr=bt.programs;bt.environment=we.isMeshStandardMaterial?st.environment:null,bt.fog=st.fog,bt.envMap=(we.isMeshStandardMaterial?Oe:mi).get(we.envMap||bt.environment),bt.envMapRotation=bt.environment!==null&&we.envMap===null?st.environmentRotation:we.envMapRotation,lr===void 0&&(we.addEventListener("dispose",Xn),lr=new Map,bt.programs=lr);let yr=lr.get(Hn);if(yr!==void 0){if(bt.currentProgram===yr&&bt.lightsStateVersion===On)return oo(we,Un),yr}else Un.uniforms=Zt.getUniforms(we),we.onBeforeCompile(Un,k),yr=Zt.acquireProgram(Un,Hn),lr.set(Hn,yr),bt.uniforms=Un.uniforms;const Yn=bt.uniforms;return(!we.isShaderMaterial&&!we.isRawShaderMaterial||we.clipping===!0)&&(Yn.clippingPlanes=Gn.uniform),oo(we,Un),bt.needsLights=Cu(we),bt.lightsStateVersion=On,bt.needsLights&&(Yn.ambientLightColor.value=ht.state.ambient,Yn.lightProbe.value=ht.state.probe,Yn.directionalLights.value=ht.state.directional,Yn.directionalLightShadows.value=ht.state.directionalShadow,Yn.spotLights.value=ht.state.spot,Yn.spotLightShadows.value=ht.state.spotShadow,Yn.rectAreaLights.value=ht.state.rectArea,Yn.ltc_1.value=ht.state.rectAreaLTC1,Yn.ltc_2.value=ht.state.rectAreaLTC2,Yn.pointLights.value=ht.state.point,Yn.pointLightShadows.value=ht.state.pointShadow,Yn.hemisphereLights.value=ht.state.hemi,Yn.directionalShadowMap.value=ht.state.directionalShadowMap,Yn.directionalShadowMatrix.value=ht.state.directionalShadowMatrix,Yn.spotShadowMap.value=ht.state.spotShadowMap,Yn.spotLightMatrix.value=ht.state.spotLightMatrix,Yn.spotLightMap.value=ht.state.spotLightMap,Yn.pointShadowMap.value=ht.state.pointShadowMap,Yn.pointShadowMatrix.value=ht.state.pointShadowMatrix),bt.currentProgram=yr,bt.uniformsList=null,yr}function bf(we){if(we.uniformsList===null){const st=we.currentProgram.getUniforms();we.uniformsList=bk.seqWithValue(st.seq,we.uniforms)}return we.uniformsList}function oo(we,st){const Pt=sr.get(we);Pt.outputColorSpace=st.outputColorSpace,Pt.batching=st.batching,Pt.batchingColor=st.batchingColor,Pt.instancing=st.instancing,Pt.instancingColor=st.instancingColor,Pt.instancingMorph=st.instancingMorph,Pt.skinning=st.skinning,Pt.morphTargets=st.morphTargets,Pt.morphNormals=st.morphNormals,Pt.morphColors=st.morphColors,Pt.morphTargetsCount=st.morphTargetsCount,Pt.numClippingPlanes=st.numClippingPlanes,Pt.numIntersection=st.numClipIntersection,Pt.vertexAlphas=st.vertexAlphas,Pt.vertexTangents=st.vertexTangents,Pt.toneMapping=st.toneMapping}function Dh(we,st,Pt,bt,ht){st.isScene!==!0&&(st=ni),dr.resetTextureUnits();const yn=st.fog,On=bt.isMeshStandardMaterial?st.environment:null,Un=Q===null?k.outputColorSpace:Q.isXRRenderTarget===!0?Q.texture.colorSpace:df,Hn=(bt.isMeshStandardMaterial?Oe:mi).get(bt.envMap||On),lr=bt.vertexColors===!0&&!!Pt.attributes.color&&Pt.attributes.color.itemSize===4,yr=!!Pt.attributes.tangent&&(!!bt.normalMap||bt.anisotropy>0),Yn=!!Pt.morphAttributes.position,Fr=!!Pt.morphAttributes.normal,Lr=!!Pt.morphAttributes.color;let Ii=Jp;bt.toneMapped&&(Q===null||Q.isXRRenderTarget===!0)&&(Ii=k.toneMapping);const Xi=Pt.morphAttributes.position||Pt.morphAttributes.normal||Pt.morphAttributes.color,ri=Xi!==void 0?Xi.length:0,Jn=sr.get(bt),Yi=R.state.lights;if(Dt===!0&&(gn===!0||we!==le)){const zs=we===le&&bt.id===ae;Gn.setState(bt,we,zs)}let Qr=!1;bt.version===Jn.__version?(Jn.needsLights&&Jn.lightsStateVersion!==Yi.state.version||Jn.outputColorSpace!==Un||ht.isBatchedMesh&&Jn.batching===!1||!ht.isBatchedMesh&&Jn.batching===!0||ht.isBatchedMesh&&Jn.batchingColor===!0&&ht.colorTexture===null||ht.isBatchedMesh&&Jn.batchingColor===!1&&ht.colorTexture!==null||ht.isInstancedMesh&&Jn.instancing===!1||!ht.isInstancedMesh&&Jn.instancing===!0||ht.isSkinnedMesh&&Jn.skinning===!1||!ht.isSkinnedMesh&&Jn.skinning===!0||ht.isInstancedMesh&&Jn.instancingColor===!0&&ht.instanceColor===null||ht.isInstancedMesh&&Jn.instancingColor===!1&&ht.instanceColor!==null||ht.isInstancedMesh&&Jn.instancingMorph===!0&&ht.morphTexture===null||ht.isInstancedMesh&&Jn.instancingMorph===!1&&ht.morphTexture!==null||Jn.envMap!==Hn||bt.fog===!0&&Jn.fog!==yn||Jn.numClippingPlanes!==void 0&&(Jn.numClippingPlanes!==Gn.numPlanes||Jn.numIntersection!==Gn.numIntersection)||Jn.vertexAlphas!==lr||Jn.vertexTangents!==yr||Jn.morphTargets!==Yn||Jn.morphNormals!==Fr||Jn.morphColors!==Lr||Jn.toneMapping!==Ii||Jn.morphTargetsCount!==ri)&&(Qr=!0):(Qr=!0,Jn.__version=bt.version);let Cs=Jn.currentProgram;Qr===!0&&(Cs=Mu(bt,st,ht));let Ba=!1,ko=!1,d0=!1;const Ni=Cs.getUniforms(),hs=Jn.uniforms;if(Ln.useProgram(Cs.program)&&(Ba=!0,ko=!0,d0=!0),bt.id!==ae&&(ae=bt.id,ko=!0),Ba||le!==we){Ln.buffers.depth.getReversed()?(qt.copy(we.projectionMatrix),DTe(qt),OTe(qt),Ni.setValue($e,"projectionMatrix",qt)):Ni.setValue($e,"projectionMatrix",we.projectionMatrix),Ni.setValue($e,"viewMatrix",we.matrixWorldInverse);const xs=Ni.map.cameraPosition;xs!==void 0&&xs.setValue($e,nr.setFromMatrixPosition(we.matrixWorld)),Ti.logarithmicDepthBuffer&&Ni.setValue($e,"logDepthBufFC",2/(Math.log(we.far+1)/Math.LN2)),(bt.isMeshPhongMaterial||bt.isMeshToonMaterial||bt.isMeshLambertMaterial||bt.isMeshBasicMaterial||bt.isMeshStandardMaterial||bt.isShaderMaterial)&&Ni.setValue($e,"isOrthographic",we.isOrthographicCamera===!0),le!==we&&(le=we,ko=!0,d0=!0)}if(ht.isSkinnedMesh){Ni.setOptional($e,ht,"bindMatrix"),Ni.setOptional($e,ht,"bindMatrixInverse");const zs=ht.skeleton;zs&&(zs.boneTexture===null&&zs.computeBoneTexture(),Ni.setValue($e,"boneTexture",zs.boneTexture,dr))}ht.isBatchedMesh&&(Ni.setOptional($e,ht,"batchingTexture"),Ni.setValue($e,"batchingTexture",ht._matricesTexture,dr),Ni.setOptional($e,ht,"batchingIdTexture"),Ni.setValue($e,"batchingIdTexture",ht._indirectTexture,dr),Ni.setOptional($e,ht,"batchingColorTexture"),ht._colorsTexture!==null&&Ni.setValue($e,"batchingColorTexture",ht._colorsTexture,dr));const As=Pt.morphAttributes;if((As.position!==void 0||As.normal!==void 0||As.color!==void 0)&&jn.update(ht,Pt,Cs),(ko||Jn.receiveShadow!==ht.receiveShadow)&&(Jn.receiveShadow=ht.receiveShadow,Ni.setValue($e,"receiveShadow",ht.receiveShadow)),bt.isMeshGouraudMaterial&&bt.envMap!==null&&(hs.envMap.value=Hn,hs.flipEnvMap.value=Hn.isCubeTexture&&Hn.isRenderTargetTexture===!1?-1:1),bt.isMeshStandardMaterial&&bt.envMap===null&&st.environment!==null&&(hs.envMapIntensity.value=st.environmentIntensity),ko&&(Ni.setValue($e,"toneMappingExposure",k.toneMappingExposure),Jn.needsLights&&Ll(hs,d0),yn&&bt.fog===!0&&jt.refreshFogUniforms(hs,yn),jt.refreshMaterialUniforms(hs,bt,Ae,gt,R.state.transmissionRenderTarget[we.id]),bk.upload($e,bf(Jn),hs,dr)),bt.isShaderMaterial&&bt.uniformsNeedUpdate===!0&&(bk.upload($e,bf(Jn),hs,dr),bt.uniformsNeedUpdate=!1),bt.isSpriteMaterial&&Ni.setValue($e,"center",ht.center),Ni.setValue($e,"modelViewMatrix",ht.modelViewMatrix),Ni.setValue($e,"normalMatrix",ht.normalMatrix),Ni.setValue($e,"modelMatrix",ht.matrixWorld),bt.isShaderMaterial||bt.isRawShaderMaterial){const zs=bt.uniformsGroups;for(let xs=0,hi=zs.length;xs<hi;xs++){const eo=zs[xs];Ze.update(eo,Cs),Ze.bind(eo,Cs)}}return Cs}function Ll(we,st){we.ambientLightColor.needsUpdate=st,we.lightProbe.needsUpdate=st,we.directionalLights.needsUpdate=st,we.directionalLightShadows.needsUpdate=st,we.pointLights.needsUpdate=st,we.pointLightShadows.needsUpdate=st,we.spotLights.needsUpdate=st,we.spotLightShadows.needsUpdate=st,we.rectAreaLights.needsUpdate=st,we.hemisphereLights.needsUpdate=st}function Cu(we){return we.isMeshLambertMaterial||we.isMeshToonMaterial||we.isMeshPhongMaterial||we.isMeshStandardMaterial||we.isShadowMaterial||we.isShaderMaterial&&we.lights===!0}this.getActiveCubeFace=function(){return ue},this.getActiveMipmapLevel=function(){return ce},this.getRenderTarget=function(){return Q},this.setRenderTargetTextures=function(we,st,Pt){const bt=sr.get(we);bt.__autoAllocateDepthBuffer=we.resolveDepthBuffer===!1,bt.__autoAllocateDepthBuffer===!1&&(bt.__useRenderToTexture=!1),sr.get(we.texture).__webglTexture=st,sr.get(we.depthTexture).__webglTexture=bt.__autoAllocateDepthBuffer?void 0:Pt,bt.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(we,st){const Pt=sr.get(we);Pt.__webglFramebuffer=st,Pt.__useDefaultFramebuffer=st===void 0};const Oh=$e.createFramebuffer();this.setRenderTarget=function(we,st=0,Pt=0){Q=we,ue=st,ce=Pt;let bt=!0,ht=null,yn=!1,On=!1;if(we){const Hn=sr.get(we);if(Hn.__useDefaultFramebuffer!==void 0)Ln.bindFramebuffer($e.FRAMEBUFFER,null),bt=!1;else if(Hn.__webglFramebuffer===void 0)dr.setupRenderTarget(we);else if(Hn.__hasExternalTextures)dr.rebindTextures(we,sr.get(we.texture).__webglTexture,sr.get(we.depthTexture).__webglTexture);else if(we.depthBuffer){const Yn=we.depthTexture;if(Hn.__boundDepthTexture!==Yn){if(Yn!==null&&sr.has(Yn)&&(we.width!==Yn.image.width||we.height!==Yn.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");dr.setupDepthRenderbuffer(we)}}const lr=we.texture;(lr.isData3DTexture||lr.isDataArrayTexture||lr.isCompressedArrayTexture)&&(On=!0);const yr=sr.get(we).__webglFramebuffer;we.isWebGLCubeRenderTarget?(Array.isArray(yr[st])?ht=yr[st][Pt]:ht=yr[st],yn=!0):we.samples>0&&dr.useMultisampledRTT(we)===!1?ht=sr.get(we).__webglMultisampledFramebuffer:Array.isArray(yr)?ht=yr[Pt]:ht=yr,J.copy(we.viewport),Ue.copy(we.scissor),je=we.scissorTest}else J.copy(De).multiplyScalar(Ae).floor(),Ue.copy(_t).multiplyScalar(Ae).floor(),je=Jt;if(Pt!==0&&(ht=Oh),Ln.bindFramebuffer($e.FRAMEBUFFER,ht)&&bt&&Ln.drawBuffers(we,ht),Ln.viewport(J),Ln.scissor(Ue),Ln.setScissorTest(je),yn){const Hn=sr.get(we.texture);$e.framebufferTexture2D($e.FRAMEBUFFER,$e.COLOR_ATTACHMENT0,$e.TEXTURE_CUBE_MAP_POSITIVE_X+st,Hn.__webglTexture,Pt)}else if(On){const Hn=sr.get(we.texture),lr=st;$e.framebufferTextureLayer($e.FRAMEBUFFER,$e.COLOR_ATTACHMENT0,Hn.__webglTexture,Pt,lr)}else if(we!==null&&Pt!==0){const Hn=sr.get(we.texture);$e.framebufferTexture2D($e.FRAMEBUFFER,$e.COLOR_ATTACHMENT0,$e.TEXTURE_2D,Hn.__webglTexture,Pt)}ae=-1},this.readRenderTargetPixels=function(we,st,Pt,bt,ht,yn,On,Un=0){if(!(we&&we.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Hn=sr.get(we).__webglFramebuffer;if(we.isWebGLCubeRenderTarget&&On!==void 0&&(Hn=Hn[On]),Hn){Ln.bindFramebuffer($e.FRAMEBUFFER,Hn);try{const lr=we.textures[Un],yr=lr.format,Yn=lr.type;if(!Ti.textureFormatReadable(yr)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!Ti.textureTypeReadable(Yn)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}st>=0&&st<=we.width-bt&&Pt>=0&&Pt<=we.height-ht&&(we.textures.length>1&&$e.readBuffer($e.COLOR_ATTACHMENT0+Un),$e.readPixels(st,Pt,bt,ht,Pn.convert(yr),Pn.convert(Yn),yn))}finally{const lr=Q!==null?sr.get(Q).__webglFramebuffer:null;Ln.bindFramebuffer($e.FRAMEBUFFER,lr)}}},this.readRenderTargetPixelsAsync=async function(we,st,Pt,bt,ht,yn,On,Un=0){if(!(we&&we.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Hn=sr.get(we).__webglFramebuffer;if(we.isWebGLCubeRenderTarget&&On!==void 0&&(Hn=Hn[On]),Hn)if(st>=0&&st<=we.width-bt&&Pt>=0&&Pt<=we.height-ht){Ln.bindFramebuffer($e.FRAMEBUFFER,Hn);const lr=we.textures[Un],yr=lr.format,Yn=lr.type;if(!Ti.textureFormatReadable(yr))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Ti.textureTypeReadable(Yn))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const Fr=$e.createBuffer();$e.bindBuffer($e.PIXEL_PACK_BUFFER,Fr),$e.bufferData($e.PIXEL_PACK_BUFFER,yn.byteLength,$e.STREAM_READ),we.textures.length>1&&$e.readBuffer($e.COLOR_ATTACHMENT0+Un),$e.readPixels(st,Pt,bt,ht,Pn.convert(yr),Pn.convert(Yn),0);const Lr=Q!==null?sr.get(Q).__webglFramebuffer:null;Ln.bindFramebuffer($e.FRAMEBUFFER,Lr);const Ii=$e.fenceSync($e.SYNC_GPU_COMMANDS_COMPLETE,0);return $e.flush(),await NTe($e,Ii,4),$e.bindBuffer($e.PIXEL_PACK_BUFFER,Fr),$e.getBufferSubData($e.PIXEL_PACK_BUFFER,0,yn),$e.deleteBuffer(Fr),$e.deleteSync(Ii),yn}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(we,st=null,Pt=0){const bt=Math.pow(2,-Pt),ht=Math.floor(we.image.width*bt),yn=Math.floor(we.image.height*bt),On=st!==null?st.x:0,Un=st!==null?st.y:0;dr.setTexture2D(we,0),$e.copyTexSubImage2D($e.TEXTURE_2D,Pt,0,0,On,Un,ht,yn),Ln.unbindTexture()};const Fh=$e.createFramebuffer(),Sf=$e.createFramebuffer();this.copyTextureToTexture=function(we,st,Pt=null,bt=null,ht=0,yn=null){yn===null&&(ht!==0?(x_("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),yn=ht,ht=0):yn=0);let On,Un,Hn,lr,yr,Yn,Fr,Lr,Ii;const Xi=we.isCompressedTexture?we.mipmaps[yn]:we.image;if(Pt!==null)On=Pt.max.x-Pt.min.x,Un=Pt.max.y-Pt.min.y,Hn=Pt.isBox3?Pt.max.z-Pt.min.z:1,lr=Pt.min.x,yr=Pt.min.y,Yn=Pt.isBox3?Pt.min.z:0;else{const As=Math.pow(2,-ht);On=Math.floor(Xi.width*As),Un=Math.floor(Xi.height*As),we.isDataArrayTexture?Hn=Xi.depth:we.isData3DTexture?Hn=Math.floor(Xi.depth*As):Hn=1,lr=0,yr=0,Yn=0}bt!==null?(Fr=bt.x,Lr=bt.y,Ii=bt.z):(Fr=0,Lr=0,Ii=0);const ri=Pn.convert(st.format),Jn=Pn.convert(st.type);let Yi;st.isData3DTexture?(dr.setTexture3D(st,0),Yi=$e.TEXTURE_3D):st.isDataArrayTexture||st.isCompressedArrayTexture?(dr.setTexture2DArray(st,0),Yi=$e.TEXTURE_2D_ARRAY):(dr.setTexture2D(st,0),Yi=$e.TEXTURE_2D),$e.pixelStorei($e.UNPACK_FLIP_Y_WEBGL,st.flipY),$e.pixelStorei($e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,st.premultiplyAlpha),$e.pixelStorei($e.UNPACK_ALIGNMENT,st.unpackAlignment);const Qr=$e.getParameter($e.UNPACK_ROW_LENGTH),Cs=$e.getParameter($e.UNPACK_IMAGE_HEIGHT),Ba=$e.getParameter($e.UNPACK_SKIP_PIXELS),ko=$e.getParameter($e.UNPACK_SKIP_ROWS),d0=$e.getParameter($e.UNPACK_SKIP_IMAGES);$e.pixelStorei($e.UNPACK_ROW_LENGTH,Xi.width),$e.pixelStorei($e.UNPACK_IMAGE_HEIGHT,Xi.height),$e.pixelStorei($e.UNPACK_SKIP_PIXELS,lr),$e.pixelStorei($e.UNPACK_SKIP_ROWS,yr),$e.pixelStorei($e.UNPACK_SKIP_IMAGES,Yn);const Ni=we.isDataArrayTexture||we.isData3DTexture,hs=st.isDataArrayTexture||st.isData3DTexture;if(we.isDepthTexture){const As=sr.get(we),zs=sr.get(st),xs=sr.get(As.__renderTarget),hi=sr.get(zs.__renderTarget);Ln.bindFramebuffer($e.READ_FRAMEBUFFER,xs.__webglFramebuffer),Ln.bindFramebuffer($e.DRAW_FRAMEBUFFER,hi.__webglFramebuffer);for(let eo=0;eo<Hn;eo++)Ni&&($e.framebufferTextureLayer($e.READ_FRAMEBUFFER,$e.COLOR_ATTACHMENT0,sr.get(we).__webglTexture,ht,Yn+eo),$e.framebufferTextureLayer($e.DRAW_FRAMEBUFFER,$e.COLOR_ATTACHMENT0,sr.get(st).__webglTexture,yn,Ii+eo)),$e.blitFramebuffer(lr,yr,On,Un,Fr,Lr,On,Un,$e.DEPTH_BUFFER_BIT,$e.NEAREST);Ln.bindFramebuffer($e.READ_FRAMEBUFFER,null),Ln.bindFramebuffer($e.DRAW_FRAMEBUFFER,null)}else if(ht!==0||we.isRenderTargetTexture||sr.has(we)){const As=sr.get(we),zs=sr.get(st);Ln.bindFramebuffer($e.READ_FRAMEBUFFER,Fh),Ln.bindFramebuffer($e.DRAW_FRAMEBUFFER,Sf);for(let xs=0;xs<Hn;xs++)Ni?$e.framebufferTextureLayer($e.READ_FRAMEBUFFER,$e.COLOR_ATTACHMENT0,As.__webglTexture,ht,Yn+xs):$e.framebufferTexture2D($e.READ_FRAMEBUFFER,$e.COLOR_ATTACHMENT0,$e.TEXTURE_2D,As.__webglTexture,ht),hs?$e.framebufferTextureLayer($e.DRAW_FRAMEBUFFER,$e.COLOR_ATTACHMENT0,zs.__webglTexture,yn,Ii+xs):$e.framebufferTexture2D($e.DRAW_FRAMEBUFFER,$e.COLOR_ATTACHMENT0,$e.TEXTURE_2D,zs.__webglTexture,yn),ht!==0?$e.blitFramebuffer(lr,yr,On,Un,Fr,Lr,On,Un,$e.COLOR_BUFFER_BIT,$e.NEAREST):hs?$e.copyTexSubImage3D(Yi,yn,Fr,Lr,Ii+xs,lr,yr,On,Un):$e.copyTexSubImage2D(Yi,yn,Fr,Lr,lr,yr,On,Un);Ln.bindFramebuffer($e.READ_FRAMEBUFFER,null),Ln.bindFramebuffer($e.DRAW_FRAMEBUFFER,null)}else hs?we.isDataTexture||we.isData3DTexture?$e.texSubImage3D(Yi,yn,Fr,Lr,Ii,On,Un,Hn,ri,Jn,Xi.data):st.isCompressedArrayTexture?$e.compressedTexSubImage3D(Yi,yn,Fr,Lr,Ii,On,Un,Hn,ri,Xi.data):$e.texSubImage3D(Yi,yn,Fr,Lr,Ii,On,Un,Hn,ri,Jn,Xi):we.isDataTexture?$e.texSubImage2D($e.TEXTURE_2D,yn,Fr,Lr,On,Un,ri,Jn,Xi.data):we.isCompressedTexture?$e.compressedTexSubImage2D($e.TEXTURE_2D,yn,Fr,Lr,Xi.width,Xi.height,ri,Xi.data):$e.texSubImage2D($e.TEXTURE_2D,yn,Fr,Lr,On,Un,ri,Jn,Xi);$e.pixelStorei($e.UNPACK_ROW_LENGTH,Qr),$e.pixelStorei($e.UNPACK_IMAGE_HEIGHT,Cs),$e.pixelStorei($e.UNPACK_SKIP_PIXELS,Ba),$e.pixelStorei($e.UNPACK_SKIP_ROWS,ko),$e.pixelStorei($e.UNPACK_SKIP_IMAGES,d0),yn===0&&st.generateMipmaps&&$e.generateMipmap(Yi),Ln.unbindTexture()},this.copyTextureToTexture3D=function(we,st,Pt=null,bt=null,ht=0){return x_('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(we,st,Pt,bt,ht)},this.initRenderTarget=function(we){sr.get(we).__webglFramebuffer===void 0&&dr.setupRenderTarget(we)},this.initTexture=function(we){we.isCubeTexture?dr.setTextureCube(we,0):we.isData3DTexture?dr.setTexture3D(we,0):we.isDataArrayTexture||we.isCompressedArrayTexture?dr.setTexture2DArray(we,0):dr.setTexture2D(we,0),Ln.unbindTexture()},this.resetState=function(){ue=0,ce=0,Q=null,Ln.reset(),wr.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Qp}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=Kr._getDrawingBufferColorSpace(e),t.unpackColorSpace=Kr._getUnpackColorSpace()}}const J9e=!0,_j=document.location.hash.search("editor")>-1;var X3=(o=>(o.LOAD_COMPLETE="Events::loadComplete",o))(X3||{});const w6=new gf;var br=(o=>(o.CUSTOM="ToolEvents::custom",o.SELECT_DROPDOWN="ToolEvents::selectDropdown",o.DRAG_UPDATE="ToolEvents::dragUpdate",o.ADD_SCENE="ToolEvents::addScene",o.REFRESH_SCENE="ToolEvents::refreshScene",o.REMOVE_SCENE="ToolEvents::removeScene",o.SET_SCENE="ToolEvents::setScene",o.GET_OBJECT="ToolEvents::getObject",o.SET_OBJECT="ToolEvents::setObject",o.UPDATE_OBJECT="ToolEvents::updateObject",o.CREATE_TEXTURE="ToolEvents::createTexture",o.REQUEST_METHOD="ToolEvents::requestMethod",o.ADD_CAMERA="ToolEvents::addCamera",o.REMOVE_CAMERA="ToolEvents::removeCamera",o.ADD_GROUP="ToolEvents::addGroup",o.REMOVE_GROUP="ToolEvents::removeGroup",o.ADD_SPLINE="ToolEvents::addSpline",o.ADD_RENDERER="ToolEvents::addRenderer",o.UPDATE_RENDERER="ToolEvents::updateRenderer",o))(br||{});class rIe extends gf{constructor(t,n,r,i=!0){super();et(this,"components",new Map);et(this,"appHandlers",[]);et(this,"editorHandlers",[]);et(this,"_appID","");et(this,"_debugEnabled");et(this,"_broadcastChannel");et(this,"_webSocket");et(this,"_mode","app");et(this,"_connected",!1);et(this,"_useBC",!1);et(this,"messageHandler",t=>{let n=t.data;this._useBC||(n=JSON.parse(t.data)),n.target==="editor"?this.handleEditorBroadcast(n):this.handleAppBroadcast(n)});et(this,"openHandler",()=>{this._connected=!0});et(this,"closeHandler",()=>{this._connected=!1});this._appID=t,this._debugEnabled=n,this.editor=r,n&&(this._useBC=i,i?(this._broadcastChannel=new BroadcastChannel(t),this._broadcastChannel.addEventListener("message",this.messageHandler)):(this._webSocket=new WebSocket(t),this._webSocket.addEventListener("open",this.openHandler),this._webSocket.addEventListener("close",this.closeHandler),this._webSocket.addEventListener("message",this.messageHandler)))}addComponent(t,n){this.components.set(t,n)}dispose(){this._broadcastChannel!==void 0&&this._broadcastChannel.removeEventListener("message",this.messageHandler),this._webSocket!==void 0&&(this._webSocket.removeEventListener("open",this.openHandler),this._webSocket.removeEventListener("close",this.closeHandler),this._webSocket.removeEventListener("message",this.messageHandler)),this.components.forEach(t=>{t.dispose()}),this.components.clear()}send(t){var n,r;this._mode!==t.target&&(this._useBC?(n=this._broadcastChannel)==null||n.postMessage(t):this._connected&&((r=this._webSocket)==null||r.send(JSON.stringify(t))))}handleAppBroadcast(t){switch(this.appHandlers.forEach(n=>{n.callback(t)}),t.event){case"custom":this.dispatchEvent({type:"ToolEvents::custom",value:t.data});break}}handleEditorBroadcast(t){switch(this.editorHandlers.forEach(n=>{n.callback(t)}),t.event){case"custom":this.dispatchEvent({type:"ToolEvents::custom",value:t.data});break}}get appID(){return this._appID}get connected(){return this._connected}get debugEnabled(){return this._debugEnabled}get mode(){return this._mode}get isApp(){return this._mode==="app"}get editor(){return this._mode==="editor"}set editor(t){t&&(this._mode="editor")}}class $H{constructor(e){et(this,"app");this.app=e,this.app.appHandlers.push({remote:this,callback:this.handleApp.bind(this)}),this.app.editorHandlers.push({remote:this,callback:this.handleEditor.bind(this)})}dispose(){const e=this.app.appHandlers.findIndex(t=>t.remote===this);e>-1&&(this.app.appHandlers.splice(e,1),this.app.editorHandlers.splice(e,1))}handleApp(e){}handleEditor(e){}}const e3e=()=>{};function Hk(o){return o.substring(0,1).toUpperCase()+o.substring(1)}function iIe(o){const e=JSON.stringify(o);return navigator.clipboard.writeText(e),e}function sIe(o){return o.r!==void 0&&o.g!==void 0&&o.b!==void 0}function eme(o){const e=Math.round(o.r*255),t=Math.round(o.g*255),n=Math.round(o.b*255),r=h=>{const p=h.toString(16);return p.length===1?"0"+p:p},i=r(e),a=r(t),c=r(n);return"#"+i+a+c}function oIe(o,e,t,n,r){const i=1-o;return i*i*i*e+3*i*i*o*t+3*i*o*o*n+o*o*o*r}function aIe(o,e,t){if(o.type!=="bezier"||o.handles.length!==4)throw new Error("Invalid keyframe data for Bzier interpolation.");const[n,r]=o.handles,i=(t-o.position)/(e.position-o.position);return oIe(i,o.value,o.value+n,e.value+r,e.value)}class lIe extends $H{constructor(t){super(t);et(this,"project");et(this,"sheets",new Map);et(this,"sheetObjects",new Map);et(this,"sheetObjectCBs",new Map);et(this,"sheetObjectUnsubscribe",new Map);et(this,"activeSheet");et(this,"studio");window.RemoteTheatre=this}dispose(){this.project=void 0,this.sheets=new Map,this.sheetObjects=new Map,this.sheetObjectCBs=new Map,this.sheetObjectUnsubscribe=new Map}getSheetInstance(t,n){return n!==void 0?`${t}-${n}`:t}sheet(t,n){var a;if(this.project===void 0){console.error("Theatre Project hasn't been created yet.");return}const r=this.getSheetInstance(t,n);let i=this.sheets.get(r);return i!==void 0||(i=(a=this.project)==null?void 0:a.sheet(t,n),this.sheets.set(r,i)),i}playSheet(t,n,r){return new Promise(i=>{var c;const a=n!==void 0?{...n}:{};(c=this.sheet(t,r))==null||c.sequence.play(a).then(h=>i(h)),this.app.send({event:"playSheet",target:"editor",data:{sheet:t,instance:r,value:n}})})}pauseSheet(t,n){var r;(r=this.sheet(t,n))==null||r.sequence.pause(),this.app.send({event:"pauseSheet",target:"editor",data:{sheet:t,instance:n}})}clearSheetObjects(t){this.sheetObjects.forEach((n,r)=>{r.search(`${t}_`)>-1&&this.unsubscribe(n)})}sheetObject(t,n,r,i,a){if(this.project===void 0){console.error("Theatre Project hasn't been created yet.");return}const c=this.sheet(t,a);if(c===void 0)return;const p=`${this.getSheetInstance(t,a)}_${n}`;let v=this.sheetObjects.get(p),x=r;v!==void 0&&(x={...r,...v.value}),v=c.object(n,x),this.sheetObjects.set(p,v),this.sheetObjectCBs.set(p,i!==void 0?i:e3e);const S=v.onValuesChange(C=>{if(this.app.editor){for(const L in C){const U=C[L];typeof U=="object"&&sIe(U)&&(C[L]={r:U.r,g:U.g,b:U.b,a:U.a})}this.app.send({event:"updateSheetObject",target:"app",data:{sheet:t,sheetObject:p,values:C}})}const I=this.sheetObjectCBs.get(p);I!==void 0&&I(C)});return this.sheetObjectUnsubscribe.set(p,S),v}getSheetObjectKeyframes(t,n,r){const i=this.sheet(t);if(i===void 0)return[];const a=`${t}_${n}`,c=this.sheetObjects.get(a);return c===void 0?[]:i.sequence.__experimental_getKeyframes(c.props[r])}getSheetObjectVectors(t,n){const r=this.sheet(t);if(r===void 0)return[];const i=`${t}_${n}`,a=this.sheetObjects.get(i);if(a===void 0)return[];const c=[],h=r.sequence.__experimental_getKeyframes(a.props.x),p=r.sequence.__experimental_getKeyframes(a.props.y),v=r.sequence.__experimental_getKeyframes(a.props.z),x=new Set;return h.forEach(C=>x.add(C.position)),p.forEach(C=>x.add(C.position)),v.forEach(C=>x.add(C.position)),Array.from(x).sort((C,I)=>C-I).forEach(C=>{const I=(L,U)=>{const R=L.find((k,ie)=>{var ue;return k.position<=U&&(((ue=L[ie+1])==null?void 0:ue.position)||1/0)>U}),$=L.find(k=>k.position>U);if(!R)return($==null?void 0:$.value)||0;if(!$||R.position===U)return R.value;if(R.type==="bezier")return aIe(R,$,U);const Z=(U-R.position)/($.position-R.position);return R.value+Z*($.value-R.value)};c.push({position:C,x:I(h,C),y:I(p,C),z:I(v,C)})}),c}unsubscribe(t){if(this.project===void 0){console.error("Theatre Project hasn't been created yet.");return}const n=t.address.sheetId,r=t.address.objectKey,i=this.sheets.get(n);i==null||i.detachObject(r);const a=`${n}_${r}`,c=this.sheetObjectUnsubscribe.get(a);c!==void 0&&(this.sheetObjects.delete(a),this.sheetObjectCBs.delete(a),this.sheetObjectUnsubscribe.delete(a),c())}handleApp(t){var r,i;let n;switch(t.event){case"setSheet":n=this.sheets.get(t.data.sheet),n!==void 0&&(this.activeSheet=n,(r=this.studio)==null||r.setSelection([n]));break;case"setSheetObject":n=this.sheetObjects.get(`${t.data.sheet}_${t.data.key}`),n!==void 0&&((i=this.studio)==null||i.setSelection([n]));break;case"updateSheetObject":n=this.sheets.get(t.data.sheet),n!==void 0&&n.sequence.pause(),n=this.sheetObjectCBs.get(t.data.sheetObject),n!==void 0&&n(t.data.values);break;case"updateTimeline":n=this.sheets.get(t.data.sheet),this.activeSheet!==void 0&&(this.activeSheet.sequence.position=t.data.position);break}}handleEditor(t){var n,r;if(this.app.editor)switch(t.event){case"playSheet":(n=this.sheet(t.data.sheet,t.data.instance))==null||n.sequence.play(t.data.value);break;case"pauseSheet":(r=this.sheet(t.data.sheet,t.data.instance))==null||r.sequence.pause();break}}handleEditorApp(){var t,n,r;if(this.app.editor){(t=this.studio)==null||t.ui.restore(),(n=this.studio)==null||n.onSelectionChange(h=>{h.length<1||h.forEach(p=>{let v=p.address.sheetId,x="setSheet",S={};switch(p.type){case"Theatre_Sheet_PublicAPI":x="setSheet",S={sheet:p.address.sheetId},this.activeSheet=this.sheets.get(p.address.sheetId);break;case"Theatre_SheetObject_PublicAPI":x="setSheetObject",v+=`_${p.address.objectKey}`,S={id:v,sheet:p.address.sheetId,key:p.address.objectKey},this.activeSheet=this.sheets.get(p.address.sheetId);break}this.app.send({event:x,target:"app",data:S})})});let i=-1;const a=()=>{if(this.activeSheet!==void 0&&i!==this.activeSheet.sequence.position){i=this.activeSheet.sequence.position;const h=this.activeSheet;this.app.send({event:"updateTimeline",target:"app",data:{position:i,sheet:h.address.sheetId}})}},c=()=>{a(),requestAnimationFrame(c)};a(),c()}else(r=this.studio)==null||r.ui.hide()}}const tme=o=>{o==null||o.dispose()},t3e=o=>{if(o)if(Array.isArray(o))o.forEach(e=>t3e(e));else{for(const e in o){const t=o[e];t!==null&&t instanceof H0&&tme(t)}if(o.isShaderMaterial===!0){const e=o;for(const t in e.uniforms){const n=e.uniforms[t];n.value!==null&&n.value instanceof H0&&tme(n.value)}}o.dispose()}},pf=o=>{var e;if(o){for(;o.children.length>0;){const t=o.children[0];t.type==="Audio"?(t.pause(),t.parent&&t.parent.remove(t)):pf(t)}if(o.parent&&o.parent.remove(o),o.isMesh){const t=o;(e=t.geometry)==null||e.dispose(),t3e(t.material)}o.dispose!==void 0&&o.dispose()}};let xj=0;const nme=()=>{xj=0},B_=o=>{if(!o)return;let e=o.name.replaceAll(" ","").replaceAll("/",".");if(e.length===0&&(e=`obj_${xj}`,xj++),o.parent!==null&&o.parent.uuid.length>0&&(e=`${o.parent.uuid}.${e}`),o.uuid=e,o.isMesh!==void 0){const t=o;if(Array.isArray(t.material))t.material.forEach((n,r)=>{n.uuid=`${e}.material.${r}`});else{const n=t.material;n.uuid=`${e}.material`}}o.children.forEach(t=>B_(t))};class vu{static init(){this.inited||(this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height,this.context=this.canvas.getContext("2d"),this.inited=!0)}static renderToBlob(e){this.init();const t=e.repeat.clone(),n=e.offset.clone();if(e.repeat.set(1,1),e.offset.set(0,0),this.context!==null){this.context.clearRect(0,0,this.width,this.height);const r=e.image;if(r!=null&&r.width>0){this.canvas.title=e.sourceFile;const i=this.canvas.width/r.width,a=this.renderToCanvas(e);this.context.drawImage(a,0,0,r.width*i,r.height*i)}}return e.repeat.copy(t),e.offset.copy(n),this.canvas.toDataURL("image/png")}static renderToCanvas(e){if(this.material===null){this.camera=new wE(-.5,.5,.5,-.5,0,100),this.scene=new vI,this.material=new wu;const t=new _s;t.setAttribute("position",new Ur([-.5,-.5,0,1.5,-.5,0,-.5,1.5,0],3)),t.setAttribute("normal",new Ur([0,0,1,0,0,1],3)),t.setAttribute("uv",new Ur([0,0,2,0,0,2],2));const n=new Mn(t,this.material);this.scene.add(n)}if(e.isRenderTargetTexture)this.material.map=e,this.renderer.render(this.scene,this.camera);else{const t=this.renderer.outputColorSpace,n=e.colorSpace;this.renderer.outputColorSpace=df,e.colorSpace=df,this.material.map=e,this.renderer.render(this.scene,this.camera),this.renderer.outputColorSpace=t,e.colorSpace=n}return this.renderer.domElement}}et(vu,"renderer"),et(vu,"canvas"),et(vu,"context",null),et(vu,"scene",null),et(vu,"camera",null),et(vu,"material",null),et(vu,"inited",!1),et(vu,"width",100),et(vu,"height",100);function cIe(o){if(o.name==="cameras")return"camera";if(o.name==="interactive")return"interactive";if(o.name==="lights")return"light";if(o.name==="ui")return"ui";if(o.name==="utils")return"utils";const e=o.type;return e.search("Helper")>-1?"icon_utils":e.search("Camera")>-1?"camera":e.search("Light")>-1?"light":"obj3D"}function i_(o){const e={name:o.name,type:o.type,uuid:o.uuid,children:[]};return o.children.forEach(t=>{e.children.push(i_(t))}),e}function uIe(o){const e={};for(const t in o){const n=o[t].value;e[t]={value:n},n===null?e[t].value={src:"",offset:[0,0],repeat:[1,1]}:n!==void 0&&n.isTexture&&(e[t].value={src:n.image.src,offset:[n.offset.x,n.offset.y],repeat:[n.repeat.x,n.repeat.y]})}return e}function hIe(o){switch(o){case"blendSrcAlpha":case"blendDstAlpha":case"blendEquationAlpha":case"clippingPlanes":case"shadowSide":case"precision":return!0}return!1}function N7(o){const e={};for(const t in o){if(t.substring(0,1)==="_"||t.substring(0,2)==="is"||hIe(t))continue;const n=typeof o[t],r=o[t];switch(n){case"boolean":case"number":case"string":e[t]=r;break;case"object":r!==null?(e[t]=r,r.isTexture?e[t]={src:vu.renderToBlob(r),offset:[r.offset.x,r.offset.y],repeat:[r.repeat.x,r.repeat.y]}:t==="uniforms"&&(e[t]=uIe(e[t]))):t==="glslVersion"?e[t]="":e[t]={src:"",offset:[0,0],repeat:[1,1]};break}}return o.anisotropy!==void 0&&(e.anisotropy=o.anisotropy),o.clearcoat!==void 0&&(e.clearcoat=o.clearcoat),o.iridescence!==void 0&&(e.iridescence=o.iridescence),o.dispersion!==void 0&&(e.dispersion=o.dispersion),o.sheen!==void 0&&(e.sheen=o.sheen),o.transmission!==void 0&&(e.transmission=o.transmission),o.transmission!==void 0&&(e.transmission=o.transmission),e}function qz(o){o.updateMatrix();const e={name:o.name,type:o.type,uuid:o.uuid,visible:o.visible,matrix:o.matrix.elements,animations:[],material:void 0,perspectiveCameraInfo:void 0,orthographicCameraInfo:void 0,lightInfo:void 0,children:[]};o.animations.forEach(n=>{e.animations.push({name:n.name,duration:n.duration,blendMode:n.blendMode})});const t=o.type.toLowerCase();if(t.search("mesh")>-1){const n=o;if(Array.isArray(n.material)){const r=[];n.material.forEach(i=>{r.push(N7(i))}),e.material=r}else e.material=N7(n.material)}else if(t.search("points")>-1){const n=o;if(Array.isArray(n.material)){const r=[];n.material.forEach(i=>{r.push(N7(i))}),e.material=r}else e.material=N7(n.material)}else if(t.search("line")>-1){const n=o;if(Array.isArray(n.material)){const r=[];n.material.forEach(i=>{r.push(N7(i))}),e.material=r}else e.material=N7(n.material)}else t.search("camera")>-1?o.type==="PerspectiveCamera"?e.perspectiveCameraInfo={fov:o.fov,zoom:o.zoom,near:o.near,far:o.far,focus:o.focus,aspect:o.aspect,filmGauge:o.filmGauge,filmOffset:o.filmOffset}:o.type==="OrthographicCamera"&&(e.orthographicCameraInfo={zoom:o.zoom,near:o.near,far:o.far,left:o.left,right:o.right,top:o.top,bottom:o.bottom}):t.search("light")>-1&&(e.lightInfo={color:o.color,intensity:o.intensity,decay:o.decay,distance:o.distance,angle:o.angle,penumbra:o.penumbra,groundColor:o.groundColor,width:o.width,height:o.height});return e}function dIe(o,e){const t=e.split(".");switch(t.length){case 1:return o[t[0]];case 2:return o[t[0]][t[1]];case 3:return o[t[0]][t[1]][t[2]];case 4:return o[t[0]][t[1]][t[2]][t[3]];case 5:return o[t[0]][t[1]][t[2]][t[3]][t[4]];case 6:return o[t[0]][t[1]][t[2]][t[3]][t[4]][t[5]]}}function fIe(o,e){for(const t in e)o[t]=e[t]}function jo(o,e,t){if(o===void 0)return;const n=e.split("."),r=n.length;if(typeof t!="object")switch(r){case 1:o[n[0]]=t;break;case 2:o[n[0]][n[1]]=t;break;case 3:o[n[0]][n[1]][n[2]]=t;break;case 4:o[n[0]][n[1]][n[2]][n[3]]=t;break;case 5:o[n[0]][n[1]][n[2]][n[3]][n[4]]=t;break}else{let a;switch(r){case 1:a=o[n[0]];break;case 2:a=o[n[0]][n[1]];break;case 3:a=o[n[0]][n[1]][n[2]];break;case 4:a=o[n[0]][n[1]][n[2]][n[3]];break;case 5:a=o[n[0]][n[1]][n[2]][n[3]][n[4]];break}a!=null&&fIe(a,t)}}function qH(o){return new Promise((e,t)=>{const n=new Image;n.onload=()=>{const r=new H0(n);r.wrapS=kg,r.wrapT=kg,r.needsUpdate=!0,e(r)},n.onerror=t,n.src=o})}function Q8(o,e,t){return Math.min(e,Math.max(o,t))}function rme(o,e,t){return(t-o)/(e-o)}function bj(o,e,t){return o*(1-t)+e*t}function sf(o,e=1){return Number(o.toFixed(e))}class pIe extends $H{constructor(t){super(t);et(this,"canvas",null);et(this,"inputElement",null);et(this,"scene");et(this,"scenes",new Map);et(this,"renderer");et(this,"renderTargets",new Map);et(this,"groups",new Map);window.RemoteThree=this}dispose(){var t;this.scenes.forEach(n=>{pf(n)}),this.scenes.clear(),this.scene&&pf(this.scene),this.renderTargets.forEach(n=>{n.dispose()}),this.renderTargets.clear(),(t=this.renderer)==null||t.dispose()}getObject(t){this.app.debugEnabled&&(this.renderer!==void 0&&(vu.renderer=this.renderer),this.app.send({event:"getObject",target:"app",data:t}))}setObject(t){this.renderer!==void 0&&(vu.renderer=this.renderer);const n=qz(t);this.app.send({event:"setObject",target:"editor",data:n})}requestMethod(t,n,r,i){this.app.send({event:"requestMethod",target:"app",data:{uuid:t,key:n,value:r,subitem:i}})}updateObject(t,n,r){this.app.send({event:"updateObject",target:"app",data:{uuid:t,key:n,value:r}})}createTexture(t,n,r){this.app.send({event:"createTexture",target:"app",data:{uuid:t,key:n,value:r}})}addGroup(t){this.groups.get(t.title)===void 0&&(this.groups.set(t.title,{title:t.title,onUpdate:t.onUpdate}),this.app.send({event:"addGroup",target:"editor",data:JSON.stringify(t)}))}removeGroup(t){this.groups.get(t)!==void 0&&(this.groups.delete(t),this.app.send({event:"removeGroup",target:"editor",data:t}))}updateGroup(t,n,r){this.app.send({event:"updateGroup",target:"app",data:JSON.stringify({group:t,prop:n,value:r})})}removeAllGroups(){this.groups.forEach(t=>{const n=t.title;this.groups.delete(n),this.app.send({event:"removeGroup",target:"editor",data:n})}),this.groups.clear()}addSpline(t){setTimeout(()=>{this.app.send({event:"addSpline",target:"editor",data:JSON.stringify(t.toJSON())})},1)}setRenderer(t,n=null){if(this.renderer=t,this.canvas=t.domElement,this.inputElement=n!==null?n:this.canvas,!this.app.debugEnabled)return;const r=`#${t.getClearColor(new Vn).getHexString()}`;this.app.send({event:"addRenderer",target:"editor",data:{autoClear:t.autoClear,autoClearColor:t.autoClearColor,autoClearDepth:t.autoClearDepth,autoClearStencil:t.autoClearStencil,outputColorSpace:t.outputColorSpace,localClippingEnabled:t.localClippingEnabled,clearColor:r,clearAlpha:t.getClearAlpha(),colorManagement:Kr.enabled,toneMapping:t.toneMapping,toneMappingExposure:t.toneMappingExposure,type:t.isWebGLRenderer?"WebGLRenderer":"WebGPURenderer"}})}updateRenderer(t){this.app.send({event:"updateRenderer",target:"app",data:t})}addScene(t){if(t===void 0||(this.scenes.set(t.name,t),!this.app.debugEnabled))return;nme(),B_(t);const n=i_(t);this.app.send({event:"addScene",target:"editor",data:n})}refreshScene(t){if(!this.app.debugEnabled)return;const n=this.scenes.get(t);if(n!==void 0){const r=i_(n);this.app.send({event:"refreshScene",target:"app",data:r})}}removeScene(t){if(t===void 0||(this.scenes.delete(t.name),!this.app.debugEnabled))return;const n=i_(t);this.app.send({event:"removeScene",target:"editor",data:n})}removeAllScenes(){this.scenes.forEach(t=>this.removeScene(t))}getScene(t){let n=null;return this.scenes.forEach((r,i)=>{t.search(i)>-1&&(n=r)}),n}setScene(t){if(t===void 0||(this.scene=t,!this.app.debugEnabled))return;this.renderer!==void 0&&(vu.renderer=this.renderer),nme(),B_(t);const n=i_(t);this.app.send({event:"setScene",target:"editor",data:n})}addCamera(t){if(!this.app.debugEnabled)return;const n=qz(t);this.app.send({event:"addCamera",target:"editor",data:n})}removeCamera(t){if(!this.app.debugEnabled)return;const n=qz(t);this.app.send({event:"removeCamera",target:"editor",data:n})}handleApp(t){switch(t.event){case"getObject":this.app.dispatchEvent({type:br.GET_OBJECT,value:t.data});break;case"updateObject":this.app.dispatchEvent({type:br.UPDATE_OBJECT,value:t.data});break;case"createTexture":this.app.dispatchEvent({type:br.CREATE_TEXTURE,value:t.data});break;case"requestMethod":this.app.dispatchEvent({type:br.REQUEST_METHOD,value:t.data});break;case"refreshScene":this.app.send({event:"refreshScene",target:"editor",data:i_(this.scenes.get(t.data.name))});break;case"updateRenderer":this.renderer&&(this.renderer.autoClear=t.data.autoClear,this.renderer.autoClearColor=t.data.autoClearColor,this.renderer.autoClearDepth=t.data.autoClearDepth,this.renderer.autoClearStencil=t.data.autoClearStencil,this.renderer.outputColorSpace=t.data.outputColorSpace,this.renderer.localClippingEnabled=t.data.localClippingEnabled,this.renderer.setClearColor(t.data.clearColor,t.data.clearAlpha),this.renderer.toneMapping=t.data.toneMapping,this.renderer.toneMappingExposure=t.data.toneMappingExposure,Kr.enabled=t.data.colorManagement);break}if(t.event==="updateGroup"){const n=JSON.parse(t.data),r=this.groups.get(n.group);r==null||r.onUpdate(n.prop,n.value)}}handleEditor(t){switch(t.event){case"setObject":this.app.dispatchEvent({type:br.SET_OBJECT,value:t.data});break;case"addScene":this.app.dispatchEvent({type:br.ADD_SCENE,value:t.data});break;case"refreshScene":this.app.dispatchEvent({type:br.REFRESH_SCENE,value:t.data});break;case"removeScene":this.app.dispatchEvent({type:br.REMOVE_SCENE,value:t.data});break;case"setScene":this.app.dispatchEvent({type:br.SET_SCENE,value:t.data});break;case"addCamera":this.app.dispatchEvent({type:br.ADD_CAMERA,value:t.data});break;case"removeCamera":this.app.dispatchEvent({type:br.REMOVE_CAMERA,value:t.data});break;case"addGroup":this.app.dispatchEvent({type:br.ADD_GROUP,value:t.data});break;case"removeGroup":this.app.dispatchEvent({type:br.REMOVE_GROUP,value:t.data});break;case"addSpline":this.app.dispatchEvent({type:br.ADD_SPLINE,value:t.data});break;case"addRenderer":this.app.dispatchEvent({type:br.ADD_RENDERER,value:t.data})}}addRT(t,n){const r=new AH(32,32,n);r.texture.name=t,this.renderTargets.set(t,r)}resize(t,n){var a,c;const r=this.dpr;this.renderTargets.forEach(h=>{h.setSize(t*r,n*r)});const i=!(((a=this.renderer)==null?void 0:a.domElement)instanceof OffscreenCanvas);(c=this.renderer)==null||c.setSize(t,n,i)}set dpr(t){var n;(n=this.renderer)==null||n.setPixelRatio(Q8(1,2,t))}get dpr(){var t;return this.renderer!==void 0?(t=this.renderer)==null?void 0:t.getPixelRatio():1}get width(){return this.renderer!==void 0?this.renderer.domElement.width/this.dpr:0}get height(){return this.renderer!==void 0?this.renderer.domElement.height/this.dpr:0}}class mIe extends $H{selectDropdown(e,t){this.app.send({event:"selectComponent",target:"app",data:{dropdown:e,value:t}})}updateDropdown(e,t){this.app.send({event:"draggableListUpdate",target:"app",data:{dropdown:e,value:t}})}handleApp(e){switch(e.event){case"selectComponent":this.app.dispatchEvent({type:br.SELECT_DROPDOWN,value:e.data});break;case"draggableListUpdate":this.app.dispatchEvent({type:br.DRAG_UPDATE,value:e.data});break}}}function gIe(o){o.app.addComponent("components",new mIe(o.app));const e=o.app.components.get("theatre");e.studio=W2e;const t=()=>{w6.removeEventListener(X3.LOAD_COMPLETE,t),e.handleEditorApp()};return w6.addEventListener(X3.LOAD_COMPLETE,t),null}function yIe(o){return Je.jsxs("div",{className:"editor",ref:o.ref,style:o.style,children:[Je.jsx("div",{className:"header",children:o.header}),o.children,Je.jsx("div",{className:"footer",children:o.footer})]})}class vIe{constructor(e,t){this.nodes=e,this.info=t,this._context=typeof self<"u"?self:null,this._animationLoop=null,this._requestId=null}start(){const e=(t,n)=>{this._requestId=this._context.requestAnimationFrame(e),this.info.autoReset===!0&&this.info.reset(),this.nodes.nodeFrame.update(),this.info.frame=this.nodes.nodeFrame.frameId,this._animationLoop!==null&&this._animationLoop(t,n)};e()}stop(){this._context.cancelAnimationFrame(this._requestId),this._requestId=null}getAnimationLoop(){return this._animationLoop}setAnimationLoop(e){this._animationLoop=e}getContext(){return this._context}setContext(e){this._context=e}dispose(){this.stop()}}class mf{constructor(){this.weakMap=new WeakMap}get(e){let t=this.weakMap;for(let n=0;n<e.length-1;n++)if(t=t.get(e[n]),t===void 0)return;return t.get(e[e.length-1])}set(e,t){let n=this.weakMap;for(let r=0;r<e.length-1;r++){const i=e[r];n.has(i)===!1&&n.set(i,new WeakMap),n=n.get(i)}return n.set(e[e.length-1],t),this}delete(e){let t=this.weakMap;for(let n=0;n<e.length-1;n++)if(t=t.get(e[n]),t===void 0)return!1;return t.delete(e[e.length-1])}}const O0=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let ime=1234567;const nE=Math.PI/180,U_=180/Math.PI;function Sg(){const o=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(O0[o&255]+O0[o>>8&255]+O0[o>>16&255]+O0[o>>24&255]+"-"+O0[e&255]+O0[e>>8&255]+"-"+O0[e>>16&15|64]+O0[e>>24&255]+"-"+O0[t&63|128]+O0[t>>8&255]+"-"+O0[t>>16&255]+O0[t>>24&255]+O0[n&255]+O0[n>>8&255]+O0[n>>16&255]+O0[n>>24&255]).toLowerCase()}function wi(o,e,t){return Math.max(e,Math.min(t,o))}function XH(o,e){return(o%e+e)%e}function J8(o,e,t,n,r){return n+(o-e)*(r-n)/(t-e)}function _Ie(o,e,t){return o!==e?(t-o)/(e-o):0}function of(o,e,t){return(1-t)*o+t*e}function xIe(o,e,t,n){return of(o,e,1-Math.exp(-t*n))}function bIe(o,e=1){return e-Math.abs(XH(o,e*2)-e)}function SIe(o,e,t){return o<=e?0:o>=t?1:(o=(o-e)/(t-e),o*o*(3-2*o))}function wIe(o,e,t){return o<=e?0:o>=t?1:(o=(o-e)/(t-e),o*o*o*(o*(o*6-15)+10))}function EIe(o,e){return o+Math.floor(Math.random()*(e-o+1))}function TIe(o,e){return o+Math.random()*(e-o)}function MIe(o){return o*(.5-Math.random())}function CIe(o){o!==void 0&&(ime=o);let e=ime+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function Wk(o){return o*nE}function n3e(o){return o*U_}function AIe(o){return(o&o-1)===0&&o!==0}function PIe(o){return Math.pow(2,Math.ceil(Math.log(o)/Math.LN2))}function RIe(o){return Math.pow(2,Math.floor(Math.log(o)/Math.LN2))}function kIe(o,e,t,n,r){const i=Math.cos,a=Math.sin,c=i(t/2),h=a(t/2),p=i((e+n)/2),v=a((e+n)/2),x=i((e-n)/2),S=a((e-n)/2),C=i((n-e)/2),I=a((n-e)/2);switch(r){case"XYX":o.set(c*v,h*x,h*S,c*p);break;case"YZY":o.set(h*S,c*v,h*x,c*p);break;case"ZXZ":o.set(h*x,h*S,c*v,c*p);break;case"XZX":o.set(c*v,h*I,h*C,c*p);break;case"YXY":o.set(h*C,c*v,h*I,c*p);break;case"ZYZ":o.set(h*I,h*C,c*v,c*p);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function kl(o,e){switch(e.constructor){case Float32Array:return o;case Uint32Array:return o/4294967295;case Uint16Array:return o/65535;case Uint8Array:return o/255;case Int32Array:return Math.max(o/2147483647,-1);case Int16Array:return Math.max(o/32767,-1);case Int8Array:return Math.max(o/127,-1);default:throw new Error("Invalid component type.")}}function si(o,e){switch(e.constructor){case Float32Array:return o;case Uint32Array:return Math.round(o*4294967295);case Uint16Array:return Math.round(o*65535);case Uint8Array:return Math.round(o*255);case Int32Array:return Math.round(o*2147483647);case Int16Array:return Math.round(o*32767);case Int8Array:return Math.round(o*127);default:throw new Error("Invalid component type.")}}const IIe={DEG2RAD:nE,RAD2DEG:U_,generateUUID:Sg,clamp:wi,euclideanModulo:XH,mapLinear:J8,inverseLerp:_Ie,lerp:of,damp:xIe,pingpong:bIe,smoothstep:SIe,smootherstep:wIe,randInt:EIe,randFloat:TIe,randFloatSpread:MIe,seededRandom:CIe,degToRad:Wk,radToDeg:n3e,isPowerOfTwo:AIe,ceilPowerOfTwo:PIe,floorPowerOfTwo:RIe,setQuaternionFromProperEuler:kIe,normalize:si,denormalize:kl},r3e="177",NIe=0,DIe=1,OIe=2,FIe=0,LIe=1,Sk=3,wg=0,Ec=1,S_=2,z_=0,Eg=1,$k=2,qk=3,Xk=4,rE=5,lf=100,i3e=101,s3e=102,BIe=103,UIe=104,B3=200,o3e=201,a3e=202,l3e=203,Yk=204,Kk=205,c3e=206,u3e=207,h3e=208,d3e=209,f3e=210,p3e=0,m3e=1,g3e=2,Zk=3,y3e=4,v3e=5,_3e=6,x3e=7,SI=0,zIe=1,VIe=2,w_=0,GIe=1,jIe=2,HIe=3,WIe=4,$Ie=6,qIe=7,YH=300,EE=301,Qk=302,KH=303,ZH=304,Sj=306,V_=1e3,W3=1001,G_=1002,ya=1003,b3e=1004,TE=1005,Eu=1006,wj=1007,Tg=1008,Il=1009,iE=1010,sE=1011,d_=1012,Pl=1013,Ho=1014,Su=1015,Mh=1016,XIe=1017,YIe=1018,$3=1020,S3e=35902,KIe=1021,QH=1022,Ch=1023,e1=1026,Mg=1027,JH=1028,eW=1029,f6=1030,tW=1031,ZIe=1032,nW=1033,Xz=33776,wk=33777,Ek=33778,Tk=33779,sme=35840,ome=35841,ame=35842,lme=35843,cme=36196,Ej=37492,Tj=37496,Mj=37808,Cj=37809,Aj=37810,Pj=37811,Rj=37812,kj=37813,Ij=37814,Nj=37815,Dj=37816,Oj=37817,Fj=37818,Lj=37819,Bj=37820,Uj=37821,Yz=36492,QIe=36283,ume=36284,hme=36285,dme=36286,Y3=0,JIe=1,Ig="",xu="srgb",E_="srgb-linear",Jk="linear",Yr="srgb",eNe=0,e6=7680,tNe=7681,nNe=7682,rNe=7683,iNe=34055,sNe=34056,oNe=5386,aNe=512,lNe=513,cNe=514,uNe=515,hNe=516,dNe=517,fNe=518,zj=519,w3e=512,rW=513,E3e=514,T3e=515,M3e=516,C3e=517,A3e=518,P3e=519,eI=35044,f_=35048,bc=2e3,K3=2001;class Mc{constructor(e,t,n,r,i,a,c,h,p){Mc.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,n,r,i,a,c,h,p)}set(e,t,n,r,i,a,c,h,p){const v=this.elements;return v[0]=e,v[1]=r,v[2]=c,v[3]=t,v[4]=i,v[5]=h,v[6]=n,v[7]=a,v[8]=p,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,i=this.elements,a=n[0],c=n[3],h=n[6],p=n[1],v=n[4],x=n[7],S=n[2],C=n[5],I=n[8],L=r[0],U=r[3],R=r[6],$=r[1],Z=r[4],k=r[7],ie=r[2],ue=r[5],ce=r[8];return i[0]=a*L+c*$+h*ie,i[3]=a*U+c*Z+h*ue,i[6]=a*R+c*k+h*ce,i[1]=p*L+v*$+x*ie,i[4]=p*U+v*Z+x*ue,i[7]=p*R+v*k+x*ce,i[2]=S*L+C*$+I*ie,i[5]=S*U+C*Z+I*ue,i[8]=S*R+C*k+I*ce,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],c=e[5],h=e[6],p=e[7],v=e[8];return t*a*v-t*c*p-n*i*v+n*c*h+r*i*p-r*a*h}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],c=e[5],h=e[6],p=e[7],v=e[8],x=v*a-c*p,S=c*h-v*i,C=p*i-a*h,I=t*x+n*S+r*C;if(I===0)return this.set(0,0,0,0,0,0,0,0,0);const L=1/I;return e[0]=x*L,e[1]=(r*p-v*n)*L,e[2]=(c*n-r*a)*L,e[3]=S*L,e[4]=(v*t-r*h)*L,e[5]=(r*i-c*t)*L,e[6]=C*L,e[7]=(n*h-p*t)*L,e[8]=(a*t-n*i)*L,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,i,a,c){const h=Math.cos(i),p=Math.sin(i);return this.set(n*h,n*p,-n*(h*a+p*c)+a+e,-r*p,r*h,-r*(-p*a+h*c)+c+t,0,0,1),this}scale(e,t){return this.premultiply(Kz.makeScale(e,t)),this}rotate(e){return this.premultiply(Kz.makeRotation(-e)),this}translate(e,t){return this.premultiply(Kz.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const Kz=new Mc;function R3e(o){for(let e=o.length-1;e>=0;--e)if(o[e]>=65535)return!0;return!1}function Vj(o){return document.createElementNS("http://www.w3.org/1999/xhtml",o)}function pNe(){const o=Vj("canvas");return o.style.display="block",o}const fme={};function Ng(o){o in fme||(fme[o]=!0,console.warn(o))}const pme=new Mc().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),mme=new Mc().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function mNe(){const o={enabled:!0,workingColorSpace:E_,spaces:{},convert:function(r,i,a){return this.enabled===!1||i===a||!i||!a||(this.spaces[i].transfer===Yr&&(r.r=Cg(r.r),r.g=Cg(r.g),r.b=Cg(r.b)),this.spaces[i].primaries!==this.spaces[a].primaries&&(r.applyMatrix3(this.spaces[i].toXYZ),r.applyMatrix3(this.spaces[a].fromXYZ)),this.spaces[a].transfer===Yr&&(r.r=T_(r.r),r.g=T_(r.g),r.b=T_(r.b))),r},workingToColorSpace:function(r,i){return this.convert(r,this.workingColorSpace,i)},colorSpaceToWorking:function(r,i){return this.convert(r,i,this.workingColorSpace)},getPrimaries:function(r){return this.spaces[r].primaries},getTransfer:function(r){return r===Ig?Jk:this.spaces[r].transfer},getLuminanceCoefficients:function(r,i=this.workingColorSpace){return r.fromArray(this.spaces[i].luminanceCoefficients)},define:function(r){Object.assign(this.spaces,r)},_getMatrix:function(r,i,a){return r.copy(this.spaces[i].toXYZ).multiply(this.spaces[a].fromXYZ)},_getDrawingBufferColorSpace:function(r){return this.spaces[r].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(r=this.workingColorSpace){return this.spaces[r].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(r,i){return Ng("THREE.ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),o.workingToColorSpace(r,i)},toWorkingColorSpace:function(r,i){return Ng("THREE.ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),o.colorSpaceToWorking(r,i)}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],n=[.3127,.329];return o.define({[E_]:{primaries:e,whitePoint:n,transfer:Jk,toXYZ:pme,fromXYZ:mme,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:xu},outputColorSpaceConfig:{drawingBufferColorSpace:xu}},[xu]:{primaries:e,whitePoint:n,transfer:Yr,toXYZ:pme,fromXYZ:mme,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:xu}}}),o}const Os=mNe();function Cg(o){return o<.04045?o*.0773993808:Math.pow(o*.9478672986+.0521327014,2.4)}function T_(o){return o<.0031308?o*12.92:1.055*Math.pow(o,.41666)-.055}const k3e={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},M3={h:0,s:0,l:0},wR={h:0,s:0,l:0};function Zz(o,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?o+(e-o)*6*t:t<1/2?e:t<2/3?o+(e-o)*6*(2/3-t):o}class qi{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=xu){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Os.colorSpaceToWorking(this,t),this}setRGB(e,t,n,r=Os.workingColorSpace){return this.r=e,this.g=t,this.b=n,Os.colorSpaceToWorking(this,r),this}setHSL(e,t,n,r=Os.workingColorSpace){if(e=XH(e,1),t=wi(t,0,1),n=wi(n,0,1),t===0)this.r=this.g=this.b=n;else{const i=n<=.5?n*(1+t):n+t-n*t,a=2*n-i;this.r=Zz(a,i,e+1/3),this.g=Zz(a,i,e),this.b=Zz(a,i,e-1/3)}return Os.colorSpaceToWorking(this,r),this}setStyle(e,t=xu){function n(i){i!==void 0&&parseFloat(i)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let i;const a=r[1],c=r[2];switch(a){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return n(i[4]),this.setRGB(Math.min(255,parseInt(i[1],10))/255,Math.min(255,parseInt(i[2],10))/255,Math.min(255,parseInt(i[3],10))/255,t);if(i=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return n(i[4]),this.setRGB(Math.min(100,parseInt(i[1],10))/100,Math.min(100,parseInt(i[2],10))/100,Math.min(100,parseInt(i[3],10))/100,t);break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return n(i[4]),this.setHSL(parseFloat(i[1])/360,parseFloat(i[2])/100,parseFloat(i[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const i=r[1],a=i.length;if(a===3)return this.setRGB(parseInt(i.charAt(0),16)/15,parseInt(i.charAt(1),16)/15,parseInt(i.charAt(2),16)/15,t);if(a===6)return this.setHex(parseInt(i,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=xu){const n=k3e[e.toLowerCase()];return n!==void 0?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Cg(e.r),this.g=Cg(e.g),this.b=Cg(e.b),this}copyLinearToSRGB(e){return this.r=T_(e.r),this.g=T_(e.g),this.b=T_(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=xu){return Os.workingToColorSpace(F0.copy(this),e),Math.round(wi(F0.r*255,0,255))*65536+Math.round(wi(F0.g*255,0,255))*256+Math.round(wi(F0.b*255,0,255))}getHexString(e=xu){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Os.workingColorSpace){Os.workingToColorSpace(F0.copy(this),t);const n=F0.r,r=F0.g,i=F0.b,a=Math.max(n,r,i),c=Math.min(n,r,i);let h,p;const v=(c+a)/2;if(c===a)h=0,p=0;else{const x=a-c;switch(p=v<=.5?x/(a+c):x/(2-a-c),a){case n:h=(r-i)/x+(r<i?6:0);break;case r:h=(i-n)/x+2;break;case i:h=(n-r)/x+4;break}h/=6}return e.h=h,e.s=p,e.l=v,e}getRGB(e,t=Os.workingColorSpace){return Os.workingToColorSpace(F0.copy(this),t),e.r=F0.r,e.g=F0.g,e.b=F0.b,e}getStyle(e=xu){Os.workingToColorSpace(F0.copy(this),e);const t=F0.r,n=F0.g,r=F0.b;return e!==xu?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(n*255)},${Math.round(r*255)})`}offsetHSL(e,t,n){return this.getHSL(M3),this.setHSL(M3.h+e,M3.s+t,M3.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(M3),e.getHSL(wR);const n=of(M3.h,wR.h,t),r=of(M3.s,wR.s,t),i=of(M3.l,wR.l,t);return this.setHSL(n,r,i),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,r=this.b,i=e.elements;return this.r=i[0]*t+i[3]*n+i[6]*r,this.g=i[1]*t+i[4]*n+i[7]*r,this.b=i[2]*t+i[5]*n+i[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const F0=new qi;qi.NAMES=k3e;class wI{constructor(e,t,n,r){wI.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,t,n,r)}identity(){return this.set(1,0,0,1),this}fromArray(e,t=0){for(let n=0;n<4;n++)this.elements[n]=e[n+t];return this}set(e,t,n,r){const i=this.elements;return i[0]=e,i[2]=t,i[1]=n,i[3]=r,this}}class nx{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,i,a,c){let h=n[r+0],p=n[r+1],v=n[r+2],x=n[r+3];const S=i[a+0],C=i[a+1],I=i[a+2],L=i[a+3];if(c===0){e[t+0]=h,e[t+1]=p,e[t+2]=v,e[t+3]=x;return}if(c===1){e[t+0]=S,e[t+1]=C,e[t+2]=I,e[t+3]=L;return}if(x!==L||h!==S||p!==C||v!==I){let U=1-c;const R=h*S+p*C+v*I+x*L,$=R>=0?1:-1,Z=1-R*R;if(Z>Number.EPSILON){const ie=Math.sqrt(Z),ue=Math.atan2(ie,R*$);U=Math.sin(U*ue)/ie,c=Math.sin(c*ue)/ie}const k=c*$;if(h=h*U+S*k,p=p*U+C*k,v=v*U+I*k,x=x*U+L*k,U===1-c){const ie=1/Math.sqrt(h*h+p*p+v*v+x*x);h*=ie,p*=ie,v*=ie,x*=ie}}e[t]=h,e[t+1]=p,e[t+2]=v,e[t+3]=x}static multiplyQuaternionsFlat(e,t,n,r,i,a){const c=n[r],h=n[r+1],p=n[r+2],v=n[r+3],x=i[a],S=i[a+1],C=i[a+2],I=i[a+3];return e[t]=c*I+v*x+h*C-p*S,e[t+1]=h*I+v*S+p*x-c*C,e[t+2]=p*I+v*C+c*S-h*x,e[t+3]=v*I-c*x-h*S-p*C,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const n=e._x,r=e._y,i=e._z,a=e._order,c=Math.cos,h=Math.sin,p=c(n/2),v=c(r/2),x=c(i/2),S=h(n/2),C=h(r/2),I=h(i/2);switch(a){case"XYZ":this._x=S*v*x+p*C*I,this._y=p*C*x-S*v*I,this._z=p*v*I+S*C*x,this._w=p*v*x-S*C*I;break;case"YXZ":this._x=S*v*x+p*C*I,this._y=p*C*x-S*v*I,this._z=p*v*I-S*C*x,this._w=p*v*x+S*C*I;break;case"ZXY":this._x=S*v*x-p*C*I,this._y=p*C*x+S*v*I,this._z=p*v*I+S*C*x,this._w=p*v*x-S*C*I;break;case"ZYX":this._x=S*v*x-p*C*I,this._y=p*C*x+S*v*I,this._z=p*v*I-S*C*x,this._w=p*v*x+S*C*I;break;case"YZX":this._x=S*v*x+p*C*I,this._y=p*C*x+S*v*I,this._z=p*v*I-S*C*x,this._w=p*v*x-S*C*I;break;case"XZY":this._x=S*v*x-p*C*I,this._y=p*C*x-S*v*I,this._z=p*v*I+S*C*x,this._w=p*v*x+S*C*I;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],i=t[8],a=t[1],c=t[5],h=t[9],p=t[2],v=t[6],x=t[10],S=n+c+x;if(S>0){const C=.5/Math.sqrt(S+1);this._w=.25/C,this._x=(v-h)*C,this._y=(i-p)*C,this._z=(a-r)*C}else if(n>c&&n>x){const C=2*Math.sqrt(1+n-c-x);this._w=(v-h)/C,this._x=.25*C,this._y=(r+a)/C,this._z=(i+p)/C}else if(c>x){const C=2*Math.sqrt(1+c-n-x);this._w=(i-p)/C,this._x=(r+a)/C,this._y=.25*C,this._z=(h+v)/C}else{const C=2*Math.sqrt(1+x-n-c);this._w=(a-r)/C,this._x=(i+p)/C,this._y=(h+v)/C,this._z=.25*C}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(wi(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,i=e._z,a=e._w,c=t._x,h=t._y,p=t._z,v=t._w;return this._x=n*v+a*c+r*p-i*h,this._y=r*v+a*h+i*c-n*p,this._z=i*v+a*p+n*h-r*c,this._w=a*v-n*c-r*h-i*p,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const n=this._x,r=this._y,i=this._z,a=this._w;let c=a*e._w+n*e._x+r*e._y+i*e._z;if(c<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,c=-c):this.copy(e),c>=1)return this._w=a,this._x=n,this._y=r,this._z=i,this;const h=1-c*c;if(h<=Number.EPSILON){const C=1-t;return this._w=C*a+t*this._w,this._x=C*n+t*this._x,this._y=C*r+t*this._y,this._z=C*i+t*this._z,this.normalize(),this}const p=Math.sqrt(h),v=Math.atan2(p,c),x=Math.sin((1-t)*v)/p,S=Math.sin(t*v)/p;return this._w=a*x+this._w*S,this._x=n*x+this._x*S,this._y=r*x+this._y*S,this._z=i*x+this._z*S,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),r=Math.sqrt(1-n),i=Math.sqrt(n);return this.set(r*Math.sin(e),r*Math.cos(e),i*Math.sin(t),i*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class yt{constructor(e=0,t=0,n=0){yt.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(gme.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(gme.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6]*r,this.y=i[1]*t+i[4]*n+i[7]*r,this.z=i[2]*t+i[5]*n+i[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,i=e.elements,a=1/(i[3]*t+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*a,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*a,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*a,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,i=e.x,a=e.y,c=e.z,h=e.w,p=2*(a*r-c*n),v=2*(c*t-i*r),x=2*(i*n-a*t);return this.x=t+h*p+a*x-c*v,this.y=n+h*v+c*p-i*x,this.z=r+h*x+i*v-a*p,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r,this.y=i[1]*t+i[5]*n+i[9]*r,this.z=i[2]*t+i[6]*n+i[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=wi(this.x,e.x,t.x),this.y=wi(this.y,e.y,t.y),this.z=wi(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=wi(this.x,e,t),this.y=wi(this.y,e,t),this.z=wi(this.z,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(wi(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,i=e.z,a=t.x,c=t.y,h=t.z;return this.x=r*h-i*c,this.y=i*a-n*h,this.z=n*c-r*a,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return Qz.copy(this).projectOnVector(e),this.sub(Qz)}reflect(e){return this.sub(Qz.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(wi(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Qz=new yt,gme=new nx;class Ts{constructor(e,t,n,r,i,a,c,h,p,v,x,S,C,I,L,U){Ts.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,n,r,i,a,c,h,p,v,x,S,C,I,L,U)}set(e,t,n,r,i,a,c,h,p,v,x,S,C,I,L,U){const R=this.elements;return R[0]=e,R[4]=t,R[8]=n,R[12]=r,R[1]=i,R[5]=a,R[9]=c,R[13]=h,R[2]=p,R[6]=v,R[10]=x,R[14]=S,R[3]=C,R[7]=I,R[11]=L,R[15]=U,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Ts().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,r=1/D7.setFromMatrixColumn(e,0).length(),i=1/D7.setFromMatrixColumn(e,1).length(),a=1/D7.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=0,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,r=e.y,i=e.z,a=Math.cos(n),c=Math.sin(n),h=Math.cos(r),p=Math.sin(r),v=Math.cos(i),x=Math.sin(i);if(e.order==="XYZ"){const S=a*v,C=a*x,I=c*v,L=c*x;t[0]=h*v,t[4]=-h*x,t[8]=p,t[1]=C+I*p,t[5]=S-L*p,t[9]=-c*h,t[2]=L-S*p,t[6]=I+C*p,t[10]=a*h}else if(e.order==="YXZ"){const S=h*v,C=h*x,I=p*v,L=p*x;t[0]=S+L*c,t[4]=I*c-C,t[8]=a*p,t[1]=a*x,t[5]=a*v,t[9]=-c,t[2]=C*c-I,t[6]=L+S*c,t[10]=a*h}else if(e.order==="ZXY"){const S=h*v,C=h*x,I=p*v,L=p*x;t[0]=S-L*c,t[4]=-a*x,t[8]=I+C*c,t[1]=C+I*c,t[5]=a*v,t[9]=L-S*c,t[2]=-a*p,t[6]=c,t[10]=a*h}else if(e.order==="ZYX"){const S=a*v,C=a*x,I=c*v,L=c*x;t[0]=h*v,t[4]=I*p-C,t[8]=S*p+L,t[1]=h*x,t[5]=L*p+S,t[9]=C*p-I,t[2]=-p,t[6]=c*h,t[10]=a*h}else if(e.order==="YZX"){const S=a*h,C=a*p,I=c*h,L=c*p;t[0]=h*v,t[4]=L-S*x,t[8]=I*x+C,t[1]=x,t[5]=a*v,t[9]=-c*v,t[2]=-p*v,t[6]=C*x+I,t[10]=S-L*x}else if(e.order==="XZY"){const S=a*h,C=a*p,I=c*h,L=c*p;t[0]=h*v,t[4]=-x,t[8]=p*v,t[1]=S*x+L,t[5]=a*v,t[9]=C*x-I,t[2]=I*x-C,t[6]=c*v,t[10]=L*x+S}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(gNe,e,yNe)}lookAt(e,t,n){const r=this.elements;return pu.subVectors(e,t),pu.lengthSq()===0&&(pu.z=1),pu.normalize(),C3.crossVectors(n,pu),C3.lengthSq()===0&&(Math.abs(n.z)===1?pu.x+=1e-4:pu.z+=1e-4,pu.normalize(),C3.crossVectors(n,pu)),C3.normalize(),ER.crossVectors(pu,C3),r[0]=C3.x,r[4]=ER.x,r[8]=pu.x,r[1]=C3.y,r[5]=ER.y,r[9]=pu.y,r[2]=C3.z,r[6]=ER.z,r[10]=pu.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,i=this.elements,a=n[0],c=n[4],h=n[8],p=n[12],v=n[1],x=n[5],S=n[9],C=n[13],I=n[2],L=n[6],U=n[10],R=n[14],$=n[3],Z=n[7],k=n[11],ie=n[15],ue=r[0],ce=r[4],Q=r[8],ae=r[12],le=r[1],J=r[5],Ue=r[9],je=r[13],rt=r[2],at=r[6],Se=r[10],gt=r[14],Ae=r[3],lt=r[7],pt=r[11],De=r[15];return i[0]=a*ue+c*le+h*rt+p*Ae,i[4]=a*ce+c*J+h*at+p*lt,i[8]=a*Q+c*Ue+h*Se+p*pt,i[12]=a*ae+c*je+h*gt+p*De,i[1]=v*ue+x*le+S*rt+C*Ae,i[5]=v*ce+x*J+S*at+C*lt,i[9]=v*Q+x*Ue+S*Se+C*pt,i[13]=v*ae+x*je+S*gt+C*De,i[2]=I*ue+L*le+U*rt+R*Ae,i[6]=I*ce+L*J+U*at+R*lt,i[10]=I*Q+L*Ue+U*Se+R*pt,i[14]=I*ae+L*je+U*gt+R*De,i[3]=$*ue+Z*le+k*rt+ie*Ae,i[7]=$*ce+Z*J+k*at+ie*lt,i[11]=$*Q+Z*Ue+k*Se+ie*pt,i[15]=$*ae+Z*je+k*gt+ie*De,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],a=e[1],c=e[5],h=e[9],p=e[13],v=e[2],x=e[6],S=e[10],C=e[14],I=e[3],L=e[7],U=e[11],R=e[15];return I*(+i*h*x-r*p*x-i*c*S+n*p*S+r*c*C-n*h*C)+L*(+t*h*C-t*p*S+i*a*S-r*a*C+r*p*v-i*h*v)+U*(+t*p*x-t*c*C-i*a*x+n*a*C+i*c*v-n*p*v)+R*(-r*c*v-t*h*x+t*c*S+r*a*x-n*a*S+n*h*v)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],c=e[5],h=e[6],p=e[7],v=e[8],x=e[9],S=e[10],C=e[11],I=e[12],L=e[13],U=e[14],R=e[15],$=x*U*p-L*S*p+L*h*C-c*U*C-x*h*R+c*S*R,Z=I*S*p-v*U*p-I*h*C+a*U*C+v*h*R-a*S*R,k=v*L*p-I*x*p+I*c*C-a*L*C-v*c*R+a*x*R,ie=I*x*h-v*L*h-I*c*S+a*L*S+v*c*U-a*x*U,ue=t*$+n*Z+r*k+i*ie;if(ue===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const ce=1/ue;return e[0]=$*ce,e[1]=(L*S*i-x*U*i-L*r*C+n*U*C+x*r*R-n*S*R)*ce,e[2]=(c*U*i-L*h*i+L*r*p-n*U*p-c*r*R+n*h*R)*ce,e[3]=(x*h*i-c*S*i-x*r*p+n*S*p+c*r*C-n*h*C)*ce,e[4]=Z*ce,e[5]=(v*U*i-I*S*i+I*r*C-t*U*C-v*r*R+t*S*R)*ce,e[6]=(I*h*i-a*U*i-I*r*p+t*U*p+a*r*R-t*h*R)*ce,e[7]=(a*S*i-v*h*i+v*r*p-t*S*p-a*r*C+t*h*C)*ce,e[8]=k*ce,e[9]=(I*x*i-v*L*i-I*n*C+t*L*C+v*n*R-t*x*R)*ce,e[10]=(a*L*i-I*c*i+I*n*p-t*L*p-a*n*R+t*c*R)*ce,e[11]=(v*c*i-a*x*i-v*n*p+t*x*p+a*n*C-t*c*C)*ce,e[12]=ie*ce,e[13]=(v*L*r-I*x*r+I*n*S-t*L*S-v*n*U+t*x*U)*ce,e[14]=(I*c*r-a*L*r-I*n*h+t*L*h+a*n*U-t*c*U)*ce,e[15]=(a*x*r-v*c*r+v*n*h-t*x*h-a*n*S+t*c*S)*ce,this}scale(e){const t=this.elements,n=e.x,r=e.y,i=e.z;return t[0]*=n,t[4]*=r,t[8]*=i,t[1]*=n,t[5]*=r,t[9]*=i,t[2]*=n,t[6]*=r,t[10]*=i,t[3]*=n,t[7]*=r,t[11]*=i,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),i=1-n,a=e.x,c=e.y,h=e.z,p=i*a,v=i*c;return this.set(p*a+n,p*c-r*h,p*h+r*c,0,p*c+r*h,v*c+n,v*h-r*a,0,p*h-r*c,v*h+r*a,i*h*h+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,i,a){return this.set(1,n,i,0,e,1,a,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,i=t._x,a=t._y,c=t._z,h=t._w,p=i+i,v=a+a,x=c+c,S=i*p,C=i*v,I=i*x,L=a*v,U=a*x,R=c*x,$=h*p,Z=h*v,k=h*x,ie=n.x,ue=n.y,ce=n.z;return r[0]=(1-(L+R))*ie,r[1]=(C+k)*ie,r[2]=(I-Z)*ie,r[3]=0,r[4]=(C-k)*ue,r[5]=(1-(S+R))*ue,r[6]=(U+$)*ue,r[7]=0,r[8]=(I+Z)*ce,r[9]=(U-$)*ce,r[10]=(1-(S+L))*ce,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;let i=D7.set(r[0],r[1],r[2]).length();const a=D7.set(r[4],r[5],r[6]).length(),c=D7.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],Yd.copy(this);const p=1/i,v=1/a,x=1/c;return Yd.elements[0]*=p,Yd.elements[1]*=p,Yd.elements[2]*=p,Yd.elements[4]*=v,Yd.elements[5]*=v,Yd.elements[6]*=v,Yd.elements[8]*=x,Yd.elements[9]*=x,Yd.elements[10]*=x,t.setFromRotationMatrix(Yd),n.x=i,n.y=a,n.z=c,this}makePerspective(e,t,n,r,i,a,c=bc){const h=this.elements,p=2*i/(t-e),v=2*i/(n-r),x=(t+e)/(t-e),S=(n+r)/(n-r);let C,I;if(c===bc)C=-(a+i)/(a-i),I=-2*a*i/(a-i);else if(c===K3)C=-a/(a-i),I=-a*i/(a-i);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+c);return h[0]=p,h[4]=0,h[8]=x,h[12]=0,h[1]=0,h[5]=v,h[9]=S,h[13]=0,h[2]=0,h[6]=0,h[10]=C,h[14]=I,h[3]=0,h[7]=0,h[11]=-1,h[15]=0,this}makeOrthographic(e,t,n,r,i,a,c=bc){const h=this.elements,p=1/(t-e),v=1/(n-r),x=1/(a-i),S=(t+e)*p,C=(n+r)*v;let I,L;if(c===bc)I=(a+i)*x,L=-2*x;else if(c===K3)I=i*x,L=-1*x;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+c);return h[0]=2*p,h[4]=0,h[8]=0,h[12]=-S,h[1]=0,h[5]=2*v,h[9]=0,h[13]=-C,h[2]=0,h[6]=0,h[10]=L,h[14]=-I,h[3]=0,h[7]=0,h[11]=0,h[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const D7=new yt,Yd=new Ts,gNe=new yt(0,0,0),yNe=new yt(1,1,1),C3=new yt,ER=new yt,pu=new yt;class pi{constructor(e=0,t=0){pi.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=wi(this.x,e.x,t.x),this.y=wi(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=wi(this.x,e,t),this.y=wi(this.y,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(wi(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(wi(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),i=this.x-e.x,a=this.y-e.y;return this.x=i*n-a*r+e.x,this.y=i*r+a*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Ri{constructor(e=0,t=0,n=0,r=1){Ri.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,i=this.w,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*r+a[12]*i,this.y=a[1]*t+a[5]*n+a[9]*r+a[13]*i,this.z=a[2]*t+a[6]*n+a[10]*r+a[14]*i,this.w=a[3]*t+a[7]*n+a[11]*r+a[15]*i,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,i;const h=e.elements,p=h[0],v=h[4],x=h[8],S=h[1],C=h[5],I=h[9],L=h[2],U=h[6],R=h[10];if(Math.abs(v-S)<.01&&Math.abs(x-L)<.01&&Math.abs(I-U)<.01){if(Math.abs(v+S)<.1&&Math.abs(x+L)<.1&&Math.abs(I+U)<.1&&Math.abs(p+C+R-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const Z=(p+1)/2,k=(C+1)/2,ie=(R+1)/2,ue=(v+S)/4,ce=(x+L)/4,Q=(I+U)/4;return Z>k&&Z>ie?Z<.01?(n=0,r=.707106781,i=.707106781):(n=Math.sqrt(Z),r=ue/n,i=ce/n):k>ie?k<.01?(n=.707106781,r=0,i=.707106781):(r=Math.sqrt(k),n=ue/r,i=Q/r):ie<.01?(n=.707106781,r=.707106781,i=0):(i=Math.sqrt(ie),n=ce/i,r=Q/i),this.set(n,r,i,t),this}let $=Math.sqrt((U-I)*(U-I)+(x-L)*(x-L)+(S-v)*(S-v));return Math.abs($)<.001&&($=1),this.x=(U-I)/$,this.y=(x-L)/$,this.z=(S-v)/$,this.w=Math.acos((p+C+R-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=wi(this.x,e.x,t.x),this.y=wi(this.y,e.y,t.y),this.z=wi(this.z,e.z,t.z),this.w=wi(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=wi(this.x,e,t),this.y=wi(this.y,e,t),this.z=wi(this.z,e,t),this.w=wi(this.w,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(wi(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}function ME(o,e=0){let t=3735928559^e,n=1103547991^e;if(o instanceof Array)for(let r=0,i;r<o.length;r++)i=o[r],t=Math.imul(t^i,2654435761),n=Math.imul(n^i,1597334677);else for(let r=0,i;r<o.length;r++)i=o.charCodeAt(r),t=Math.imul(t^i,2654435761),n=Math.imul(n^i,1597334677);return t=Math.imul(t^t>>>16,2246822507),t^=Math.imul(n^n>>>13,3266489909),n=Math.imul(n^n>>>16,2246822507),n^=Math.imul(t^t>>>13,3266489909),4294967296*(2097151&n)+(t>>>0)}const vNe=o=>ME(o),iW=o=>ME(o),tI=(...o)=>ME(o);function I3e(o,e=!1){const t=[];o.isNode===!0&&(t.push(o.id),o=o.getSelf());for(const{property:n,childNode:r}of nI(o))t.push(ME(n.slice(0,-4)),r.getCacheKey(e));return ME(t)}function*nI(o,e=!1){for(const t in o){if(t.startsWith("_")===!0)continue;const n=o[t];if(Array.isArray(n)===!0)for(let r=0;r<n.length;r++){const i=n[r];i&&(i.isNode===!0||e&&typeof i.toJSON=="function")&&(yield{property:t,index:r,childNode:i})}else if(n&&n.isNode===!0)yield{property:t,childNode:n};else if(typeof n=="object")for(const r in n){const i=n[r];i&&(i.isNode===!0||e&&typeof i.toJSON=="function")&&(yield{property:t,index:r,childNode:i})}}}const _Ne=new Map([[1,"float"],[2,"vec2"],[3,"vec3"],[4,"vec4"],[9,"mat3"],[16,"mat4"]]),yme=new WeakMap;function xNe(o){return _Ne.get(o)}function rI(o){if(o==null)return null;const e=typeof o;return o.isNode===!0?"node":e==="number"?"float":e==="boolean"?"bool":e==="string"?"string":e==="function"?"shader":o.isVector2===!0?"vec2":o.isVector3===!0?"vec3":o.isVector4===!0?"vec4":o.isMatrix2===!0?"mat2":o.isMatrix3===!0?"mat3":o.isMatrix4===!0?"mat4":o.isColor===!0?"color":o instanceof ArrayBuffer?"ArrayBuffer":null}function N3e(o,...e){const t=o?o.slice(-4):void 0;return e.length===1&&(t==="vec2"?e=[e[0],e[0]]:t==="vec3"?e=[e[0],e[0],e[0]]:t==="vec4"&&(e=[e[0],e[0],e[0],e[0]])),o==="color"?new qi(...e):t==="vec2"?new pi(...e):t==="vec3"?new yt(...e):t==="vec4"?new Ri(...e):t==="mat2"?new wI(...e):t==="mat3"?new Mc(...e):t==="mat4"?new Ts(...e):o==="bool"?e[0]||!1:o==="float"||o==="int"||o==="uint"?e[0]||0:o==="string"?e[0]||"":o==="ArrayBuffer"?SNe(e[0]):null}function D3e(o){let e=yme.get(o);return e===void 0&&(e={},yme.set(o,e)),e}function bNe(o){let e="";const t=new Uint8Array(o);for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return btoa(e)}function SNe(o){return Uint8Array.from(atob(o),e=>e.charCodeAt(0)).buffer}let wNe=0;function ENe(o){const e=Object.keys(o);let t=Object.getPrototypeOf(o);for(;t;){const n=Object.getOwnPropertyDescriptors(t);for(const r in n)if(n[r]!==void 0){const i=n[r];i&&typeof i.get=="function"&&e.push(r)}t=Object.getPrototypeOf(t)}return e}class TNe{constructor(e,t,n,r,i,a,c,h,p,v){this.id=wNe++,this._nodes=e,this._geometries=t,this.renderer=n,this.object=r,this.material=i,this.scene=a,this.camera=c,this.lightsNode=h,this.context=p,this.geometry=r.geometry,this.version=i.version,this.drawRange=null,this.attributes=null,this.pipeline=null,this.group=null,this.vertexBuffers=null,this.drawParams=null,this.bundle=null,this.clippingContext=v,this.clippingContextCacheKey=v!==null?v.cacheKey:"",this.initialNodesCacheKey=this.getDynamicCacheKey(),this.initialCacheKey=this.getCacheKey(),this._nodeBuilderState=null,this._bindings=null,this._monitor=null,this.onDispose=null,this.isRenderObject=!0,this.onMaterialDispose=()=>{this.dispose()},this.material.addEventListener("dispose",this.onMaterialDispose)}updateClipping(e){this.clippingContext=e}get clippingNeedsUpdate(){return this.clippingContext===null||this.clippingContext.cacheKey===this.clippingContextCacheKey?!1:(this.clippingContextCacheKey=this.clippingContext.cacheKey,!0)}get hardwareClippingPlanes(){return this.material.hardwareClipping===!0?this.clippingContext.unionClippingCount:0}getNodeBuilderState(){return this._nodeBuilderState||(this._nodeBuilderState=this._nodes.getForRender(this))}getMonitor(){return this._monitor||(this._monitor=this.getNodeBuilderState().observer)}getBindings(){return this._bindings||(this._bindings=this.getNodeBuilderState().createBindings())}getBindingGroup(e){for(const t of this.getBindings())if(t.name===e)return t}getIndex(){return this._geometries.getIndex(this)}getIndirect(){return this._geometries.getIndirect(this)}getChainArray(){return[this.object,this.material,this.context,this.lightsNode]}setGeometry(e){this.geometry=e,this.attributes=null}getAttributes(){if(this.attributes!==null)return this.attributes;const e=this.getNodeBuilderState().nodeAttributes,t=this.geometry,n=[],r=new Set;for(const i of e){const a=i.node&&i.node.attribute?i.node.attribute:t.getAttribute(i.name);if(a===void 0)continue;n.push(a);const c=a.isInterleavedBufferAttribute?a.data:a;r.add(c)}return this.attributes=n,this.vertexBuffers=Array.from(r.values()),n}getVertexBuffers(){return this.vertexBuffers===null&&this.getAttributes(),this.vertexBuffers}getDrawParameters(){const{object:e,material:t,geometry:n,group:r,drawRange:i}=this,a=this.drawParams||(this.drawParams={vertexCount:0,firstVertex:0,instanceCount:0,firstInstance:0}),c=this.getIndex(),h=c!==null;let p=1;if(n.isInstancedBufferGeometry===!0?p=n.instanceCount:e.count!==void 0&&(p=Math.max(0,e.count)),p===0)return null;if(a.instanceCount=p,e.isBatchedMesh===!0)return a;let v=1;t.wireframe===!0&&!e.isPoints&&!e.isLineSegments&&!e.isLine&&!e.isLineLoop&&(v=2);let x=i.start*v,S=(i.start+i.count)*v;r!==null&&(x=Math.max(x,r.start*v),S=Math.min(S,(r.start+r.count)*v));const C=n.attributes.position;let I=1/0;h?I=c.count:C!=null&&(I=C.count),x=Math.max(x,0),S=Math.min(S,I);const L=S-x;return L<0||L===1/0?null:(a.vertexCount=L,a.firstVertex=x,a)}getGeometryCacheKey(){const{geometry:e}=this;let t="";for(const n of Object.keys(e.attributes).sort()){const r=e.attributes[n];t+=n+",",r.data&&(t+=r.data.stride+","),r.offset&&(t+=r.offset+","),r.itemSize&&(t+=r.itemSize+","),r.normalized&&(t+="n,")}for(const n of Object.keys(e.morphAttributes).sort()){const r=e.morphAttributes[n];t+="morph-"+n+",";for(let i=0,a=r.length;i<a;i++){const c=r[i];t+=c.id+","}}return e.index&&(t+="index,"),t}getMaterialCacheKey(){const{object:e,material:t}=this;let n=t.customProgramCacheKey();for(const r of ENe(t)){if(/^(is[A-Z]|_)|^(visible|version|uuid|name|opacity|userData)$/.test(r))continue;const i=t[r];let a;if(i!==null){const c=typeof i;c==="number"?a=i!==0?"1":"0":c==="object"?(a="{",i.isTexture&&(a+=i.mapping),a+="}"):a=String(i)}else a=String(i);n+=a+","}return n+=this.clippingContextCacheKey+",",e.geometry&&(n+=this.getGeometryCacheKey()),e.skeleton&&(n+=e.skeleton.bones.length+","),e.isBatchedMesh&&(n+=e._matricesTexture.uuid+",",e._colorsTexture!==null&&(n+=e._colorsTexture.uuid+",")),e.count>1&&(n+=e.uuid+","),n+=e.receiveShadow+",",vNe(n)}get needsGeometryUpdate(){return this.geometry.id!==this.object.geometry.id}get needsUpdate(){return this.initialNodesCacheKey!==this.getDynamicCacheKey()||this.clippingNeedsUpdate}getDynamicCacheKey(){let e=0;return this.material.isShadowPassMaterial!==!0&&(e=this._nodes.getCacheKey(this.scene,this.lightsNode)),this.camera.isArrayCamera&&(e=tI(e,this.camera.cameras.length)),this.object.receiveShadow&&(e=tI(e,1)),e}getCacheKey(){return this.getMaterialCacheKey()+this.getDynamicCacheKey()}dispose(){this.material.removeEventListener("dispose",this.onMaterialDispose),this.onDispose()}}const U8=[];class MNe{constructor(e,t,n,r,i,a){this.renderer=e,this.nodes=t,this.geometries=n,this.pipelines=r,this.bindings=i,this.info=a,this.chainMaps={}}get(e,t,n,r,i,a,c,h){const p=this.getChainMap(h);U8[0]=e,U8[1]=t,U8[2]=a,U8[3]=i;let v=p.get(U8);return v===void 0?(v=this.createRenderObject(this.nodes,this.geometries,this.renderer,e,t,n,r,i,a,c,h),p.set(U8,v)):(v.updateClipping(c),v.needsGeometryUpdate&&v.setGeometry(e.geometry),(v.version!==t.version||v.needsUpdate)&&(v.initialCacheKey!==v.getCacheKey()?(v.dispose(),v=this.get(e,t,n,r,i,a,c,h)):v.version=t.version)),U8.length=0,v}getChainMap(e="default"){return this.chainMaps[e]||(this.chainMaps[e]=new mf)}dispose(){this.chainMaps={}}createRenderObject(e,t,n,r,i,a,c,h,p,v,x){const S=this.getChainMap(x),C=new TNe(e,t,n,r,i,a,c,h,p,v);return C.onDispose=()=>{this.pipelines.delete(C),this.bindings.delete(C),this.nodes.delete(C),S.delete(C.getChainArray())},C}}class t4{constructor(){this.data=new WeakMap}get(e){let t=this.data.get(e);return t===void 0&&(t={},this.data.set(e,t)),t}delete(e){let t=null;return this.data.has(e)&&(t=this.data.get(e),this.data.delete(e)),t}has(e){return this.data.has(e)}dispose(){this.data=new WeakMap}}const Ah={VERTEX:1,INDEX:2,STORAGE:3,INDIRECT:4},G3=16,CNe=211,ANe=212;class PNe extends t4{constructor(e){super(),this.backend=e}delete(e){const t=super.delete(e);return t!==null&&this.backend.destroyAttribute(e),t}update(e,t){const n=this.get(e);if(n.version===void 0)t===Ah.VERTEX?this.backend.createAttribute(e):t===Ah.INDEX?this.backend.createIndexAttribute(e):t===Ah.STORAGE?this.backend.createStorageAttribute(e):t===Ah.INDIRECT&&this.backend.createIndirectStorageAttribute(e),n.version=this._getBufferAttribute(e).version;else{const r=this._getBufferAttribute(e);(n.version<r.version||r.usage===f_)&&(this.backend.updateAttribute(e),n.version=r.version)}}_getBufferAttribute(e){return e.isInterleavedBufferAttribute&&(e=e.data),e}}const yg=RNe();function RNe(){const o=new ArrayBuffer(4),e=new Float32Array(o),t=new Uint32Array(o),n=new Uint32Array(512),r=new Uint32Array(512);for(let h=0;h<256;++h){const p=h-127;p<-27?(n[h]=0,n[h|256]=32768,r[h]=24,r[h|256]=24):p<-14?(n[h]=1024>>-p-14,n[h|256]=1024>>-p-14|32768,r[h]=-p-1,r[h|256]=-p-1):p<=15?(n[h]=p+15<<10,n[h|256]=p+15<<10|32768,r[h]=13,r[h|256]=13):p<128?(n[h]=31744,n[h|256]=64512,r[h]=24,r[h|256]=24):(n[h]=31744,n[h|256]=64512,r[h]=13,r[h|256]=13)}const i=new Uint32Array(2048),a=new Uint32Array(64),c=new Uint32Array(64);for(let h=1;h<1024;++h){let p=h<<13,v=0;for(;(p&8388608)===0;)p<<=1,v-=8388608;p&=-8388609,v+=947912704,i[h]=p|v}for(let h=1024;h<2048;++h)i[h]=939524096+(h-1024<<13);for(let h=1;h<31;++h)a[h]=h<<23;a[31]=1199570944,a[32]=2147483648;for(let h=33;h<63;++h)a[h]=2147483648+(h-32<<23);a[63]=3347054592;for(let h=1;h<64;++h)h!==32&&(c[h]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:r,mantissaTable:i,exponentTable:a,offsetTable:c}}function mu(o){Math.abs(o)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),o=wi(o,-65504,65504),yg.floatView[0]=o;const e=yg.uint32View[0],t=e>>23&511;return yg.baseTable[t]+((e&8388607)>>yg.shiftTable[t])}function TR(o){const e=o>>10;return yg.uint32View[0]=yg.mantissaTable[yg.offsetTable[e]+(o&1023)]+yg.exponentTable[e],yg.floatView[0]}const ea=new yt,MR=new pi;let kNe=0;class Ph{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:kNe++}),this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=eI,this.updateRanges=[],this.gpuType=Su,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)MR.fromBufferAttribute(this,t),MR.applyMatrix3(e),this.setXY(t,MR.x,MR.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)ea.fromBufferAttribute(this,t),ea.applyMatrix3(e),this.setXYZ(t,ea.x,ea.y,ea.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)ea.fromBufferAttribute(this,t),ea.applyMatrix4(e),this.setXYZ(t,ea.x,ea.y,ea.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)ea.fromBufferAttribute(this,t),ea.applyNormalMatrix(e),this.setXYZ(t,ea.x,ea.y,ea.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)ea.fromBufferAttribute(this,t),ea.transformDirection(e),this.setXYZ(t,ea.x,ea.y,ea.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=kl(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=si(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=kl(t,this.array)),t}setX(e,t){return this.normalized&&(t=si(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=kl(t,this.array)),t}setY(e,t){return this.normalized&&(t=si(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=kl(t,this.array)),t}setZ(e,t){return this.normalized&&(t=si(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=kl(t,this.array)),t}setW(e,t){return this.normalized&&(t=si(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=si(t,this.array),n=si(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=si(t,this.array),n=si(n,this.array),r=si(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,i){return e*=this.itemSize,this.normalized&&(t=si(t,this.array),n=si(n,this.array),r=si(r,this.array),i=si(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==eI&&(e.usage=this.usage),e}}class O3e extends Ph{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class F3e extends Ph{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class L3e extends Ph{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}getX(e){let t=TR(this.array[e*this.itemSize]);return this.normalized&&(t=kl(t,this.array)),t}setX(e,t){return this.normalized&&(t=si(t,this.array)),this.array[e*this.itemSize]=mu(t),this}getY(e){let t=TR(this.array[e*this.itemSize+1]);return this.normalized&&(t=kl(t,this.array)),t}setY(e,t){return this.normalized&&(t=si(t,this.array)),this.array[e*this.itemSize+1]=mu(t),this}getZ(e){let t=TR(this.array[e*this.itemSize+2]);return this.normalized&&(t=kl(t,this.array)),t}setZ(e,t){return this.normalized&&(t=si(t,this.array)),this.array[e*this.itemSize+2]=mu(t),this}getW(e){let t=TR(this.array[e*this.itemSize+3]);return this.normalized&&(t=kl(t,this.array)),t}setW(e,t){return this.normalized&&(t=si(t,this.array)),this.array[e*this.itemSize+3]=mu(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=si(t,this.array),n=si(n,this.array)),this.array[e+0]=mu(t),this.array[e+1]=mu(n),this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=si(t,this.array),n=si(n,this.array),r=si(r,this.array)),this.array[e+0]=mu(t),this.array[e+1]=mu(n),this.array[e+2]=mu(r),this}setXYZW(e,t,n,r,i){return e*=this.itemSize,this.normalized&&(t=si(t,this.array),n=si(n,this.array),r=si(r,this.array),i=si(i,this.array)),this.array[e+0]=mu(t),this.array[e+1]=mu(n),this.array[e+2]=mu(r),this.array[e+3]=mu(i),this}}class Nl extends Ph{constructor(e,t,n){super(new Float32Array(e),t,n)}}function B3e(o){return o.index!==null?o.index.version:o.attributes.position.version}function vme(o){const e=[],t=o.index,n=o.attributes.position;if(t!==null){const i=t.array;for(let a=0,c=i.length;a<c;a+=3){const h=i[a+0],p=i[a+1],v=i[a+2];e.push(h,p,p,v,v,h)}}else{const i=n.array;for(let a=0,c=i.length/3-1;a<c;a+=3){const h=a+0,p=a+1,v=a+2;e.push(h,p,p,v,v,h)}}const r=new(R3e(e)?F3e:O3e)(e,1);return r.version=B3e(o),r}class INe extends t4{constructor(e,t){super(),this.attributes=e,this.info=t,this.wireframes=new WeakMap,this.attributeCall=new WeakMap}has(e){const t=e.geometry;return super.has(t)&&this.get(t).initialized===!0}updateForRender(e){this.has(e)===!1&&this.initGeometry(e),this.updateAttributes(e)}initGeometry(e){const t=e.geometry,n=this.get(t);n.initialized=!0,this.info.memory.geometries++;const r=()=>{this.info.memory.geometries--;const i=t.index,a=e.getAttributes();i!==null&&this.attributes.delete(i);for(const h of a)this.attributes.delete(h);const c=this.wireframes.get(t);c!==void 0&&this.attributes.delete(c),t.removeEventListener("dispose",r)};t.addEventListener("dispose",r)}updateAttributes(e){const t=e.getAttributes();for(const i of t)i.isStorageBufferAttribute||i.isStorageInstancedBufferAttribute?this.updateAttribute(i,Ah.STORAGE):this.updateAttribute(i,Ah.VERTEX);const n=this.getIndex(e);n!==null&&this.updateAttribute(n,Ah.INDEX);const r=e.geometry.indirect;r!==null&&this.updateAttribute(r,Ah.INDIRECT)}updateAttribute(e,t){const n=this.info.render.calls;e.isInterleavedBufferAttribute?this.attributeCall.get(e)===void 0?(this.attributes.update(e,t),this.attributeCall.set(e,n)):this.attributeCall.get(e.data)!==n&&(this.attributes.update(e,t),this.attributeCall.set(e.data,n),this.attributeCall.set(e,n)):this.attributeCall.get(e)!==n&&(this.attributes.update(e,t),this.attributeCall.set(e,n))}getIndirect(e){return e.geometry.indirect}getIndex(e){const{geometry:t,material:n}=e;let r=t.index;if(n.wireframe===!0){const i=this.wireframes;let a=i.get(t);a===void 0?(a=vme(t),i.set(t,a)):a.version!==B3e(t)&&(this.attributes.delete(a),a=vme(t),i.set(t,a)),r=a}return r}}class NNe{constructor(){this.autoReset=!0,this.frame=0,this.calls=0,this.render={calls:0,frameCalls:0,drawCalls:0,triangles:0,points:0,lines:0,timestamp:0},this.compute={calls:0,frameCalls:0,timestamp:0},this.memory={geometries:0,textures:0}}update(e,t,n){this.render.drawCalls++,e.isMesh||e.isSprite?this.render.triangles+=n*(t/3):e.isPoints?this.render.points+=n*t:e.isLineSegments?this.render.lines+=n*(t/2):e.isLine?this.render.lines+=n*(t-1):console.error("THREE.WebGPUInfo: Unknown object type.")}reset(){this.render.drawCalls=0,this.render.frameCalls=0,this.compute.frameCalls=0,this.render.triangles=0,this.render.points=0,this.render.lines=0}dispose(){this.reset(),this.calls=0,this.render.calls=0,this.compute.calls=0,this.render.timestamp=0,this.compute.timestamp=0,this.memory.geometries=0,this.memory.textures=0}}class U3e{constructor(e){this.cacheKey=e,this.usedTimes=0}}class DNe extends U3e{constructor(e,t,n){super(e),this.vertexProgram=t,this.fragmentProgram=n}}class ONe extends U3e{constructor(e,t){super(e),this.computeProgram=t,this.isComputePipeline=!0}}let FNe=0;class Jz{constructor(e,t,n,r=null,i=null){this.id=FNe++,this.code=e,this.stage=t,this.name=n,this.transforms=r,this.attributes=i,this.usedTimes=0}}class LNe extends t4{constructor(e,t){super(),this.backend=e,this.nodes=t,this.bindings=null,this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}getForCompute(e,t){const{backend:n}=this,r=this.get(e);if(this._needsComputeUpdate(e)){const i=r.pipeline;i&&(i.usedTimes--,i.computeProgram.usedTimes--);const a=this.nodes.getForCompute(e);let c=this.programs.compute.get(a.computeShader);c===void 0&&(i&&i.computeProgram.usedTimes===0&&this._releaseProgram(i.computeProgram),c=new Jz(a.computeShader,"compute",e.name,a.transforms,a.nodeAttributes),this.programs.compute.set(a.computeShader,c),n.createProgram(c));const h=this._getComputeCacheKey(e,c);let p=this.caches.get(h);p===void 0&&(i&&i.usedTimes===0&&this._releasePipeline(i),p=this._getComputePipeline(e,c,h,t)),p.usedTimes++,c.usedTimes++,r.version=e.version,r.pipeline=p}return r.pipeline}getForRender(e,t=null){const{backend:n}=this,r=this.get(e);if(this._needsRenderUpdate(e)){const i=r.pipeline;i&&(i.usedTimes--,i.vertexProgram.usedTimes--,i.fragmentProgram.usedTimes--);const a=e.getNodeBuilderState(),c=e.material?e.material.name:"";let h=this.programs.vertex.get(a.vertexShader);h===void 0&&(i&&i.vertexProgram.usedTimes===0&&this._releaseProgram(i.vertexProgram),h=new Jz(a.vertexShader,"vertex",c),this.programs.vertex.set(a.vertexShader,h),n.createProgram(h));let p=this.programs.fragment.get(a.fragmentShader);p===void 0&&(i&&i.fragmentProgram.usedTimes===0&&this._releaseProgram(i.fragmentProgram),p=new Jz(a.fragmentShader,"fragment",c),this.programs.fragment.set(a.fragmentShader,p),n.createProgram(p));const v=this._getRenderCacheKey(e,h,p);let x=this.caches.get(v);x===void 0?(i&&i.usedTimes===0&&this._releasePipeline(i),x=this._getRenderPipeline(e,h,p,v,t)):e.pipeline=x,x.usedTimes++,h.usedTimes++,p.usedTimes++,r.pipeline=x}return r.pipeline}delete(e){const t=this.get(e).pipeline;return t&&(t.usedTimes--,t.usedTimes===0&&this._releasePipeline(t),t.isComputePipeline?(t.computeProgram.usedTimes--,t.computeProgram.usedTimes===0&&this._releaseProgram(t.computeProgram)):(t.fragmentProgram.usedTimes--,t.vertexProgram.usedTimes--,t.vertexProgram.usedTimes===0&&this._releaseProgram(t.vertexProgram),t.fragmentProgram.usedTimes===0&&this._releaseProgram(t.fragmentProgram))),super.delete(e)}dispose(){super.dispose(),this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}updateForRender(e){this.getForRender(e)}_getComputePipeline(e,t,n,r){n=n||this._getComputeCacheKey(e,t);let i=this.caches.get(n);return i===void 0&&(i=new ONe(n,t),this.caches.set(n,i),this.backend.createComputePipeline(i,r)),i}_getRenderPipeline(e,t,n,r,i){r=r||this._getRenderCacheKey(e,t,n);let a=this.caches.get(r);return a===void 0&&(a=new DNe(r,t,n),this.caches.set(r,a),e.pipeline=a,this.backend.createRenderPipeline(e,i)),a}_getComputeCacheKey(e,t){return e.id+","+t.id}_getRenderCacheKey(e,t,n){return t.id+","+n.id+","+this.backend.getRenderCacheKey(e)}_releasePipeline(e){this.caches.delete(e.cacheKey)}_releaseProgram(e){const t=e.code,n=e.stage;this.programs[n].delete(t)}_needsComputeUpdate(e){const t=this.get(e);return t.pipeline===void 0||t.version!==e.version}_needsRenderUpdate(e){return this.get(e).pipeline===void 0||this.backend.needsRenderUpdate(e)}}class BNe extends t4{constructor(e,t,n,r,i,a){super(),this.backend=e,this.textures=n,this.pipelines=i,this.attributes=r,this.nodes=t,this.info=a,this.pipelines.bindings=this}getForRender(e){const t=e.getBindings();for(const n of t){const r=this.get(n);r.bindGroup===void 0&&(this._init(n),this.backend.createBindings(n,t,0),r.bindGroup=n)}return t}getForCompute(e){const t=this.nodes.getForCompute(e).bindings;for(const n of t){const r=this.get(n);r.bindGroup===void 0&&(this._init(n),this.backend.createBindings(n,t,0),r.bindGroup=n)}return t}updateForCompute(e){this._updateBindings(this.getForCompute(e))}updateForRender(e){this._updateBindings(this.getForRender(e))}_updateBindings(e){for(const t of e)this._update(t,e)}_init(e){for(const t of e.bindings)if(t.isSampledTexture)this.textures.updateTexture(t.texture);else if(t.isStorageBuffer){const n=t.attribute,r=n.isIndirectStorageBufferAttribute?Ah.INDIRECT:Ah.STORAGE;this.attributes.update(n,r)}}_update(e,t){const{backend:n}=this;let r=!1,i=!0,a=0,c=0;for(const h of e.bindings)if(!(h.isNodeUniformsGroup&&this.nodes.updateGroup(h)===!1)){if(h.isStorageBuffer){const p=h.attribute,v=p.isIndirectStorageBufferAttribute?Ah.INDIRECT:Ah.STORAGE;this.attributes.update(p,v)}if(h.isUniformBuffer)h.update()&&n.updateBinding(h);else if(h.isSampler)h.update();else if(h.isSampledTexture){const p=this.textures.get(h.texture);h.needsBindingsUpdate(p.generation)&&(r=!0);const v=h.update(),x=h.texture;v&&this.textures.updateTexture(x);const S=n.get(x);if(S.externalTexture!==void 0||p.isDefaultTexture?i=!1:(a=a*10+x.id,c+=x.version),n.isWebGPUBackend===!0&&S.texture===void 0&&S.externalTexture===void 0&&(console.error("Bindings._update: binding should be available:",h,v,x,h.textureNode.value,r),this.textures.updateTexture(x),r=!0),x.isStorageTexture===!0){const C=this.get(x);h.store===!0?C.needsMipmap=!0:this.textures.needsMipmaps(x)&&C.needsMipmap===!0&&(this.backend.generateMipmaps(x),C.needsMipmap=!1)}}}r===!0&&this.backend.updateBindings(e,t,i?a:0,c)}}function UNe(o,e){return o.groupOrder!==e.groupOrder?o.groupOrder-e.groupOrder:o.renderOrder!==e.renderOrder?o.renderOrder-e.renderOrder:o.z!==e.z?o.z-e.z:o.id-e.id}function _me(o,e){return o.groupOrder!==e.groupOrder?o.groupOrder-e.groupOrder:o.renderOrder!==e.renderOrder?o.renderOrder-e.renderOrder:o.z!==e.z?e.z-o.z:o.id-e.id}function xme(o){return(o.transmission>0||o.transmissionNode)&&o.side===S_&&o.forceSinglePass===!1}class zNe{constructor(e,t,n){this.renderItems=[],this.renderItemsIndex=0,this.opaque=[],this.transparentDoublePass=[],this.transparent=[],this.bundles=[],this.lightsNode=e.getNode(t,n),this.lightsArray=[],this.scene=t,this.camera=n,this.occlusionQueryCount=0}begin(){return this.renderItemsIndex=0,this.opaque.length=0,this.transparentDoublePass.length=0,this.transparent.length=0,this.bundles.length=0,this.lightsArray.length=0,this.occlusionQueryCount=0,this}getNextRenderItem(e,t,n,r,i,a,c){let h=this.renderItems[this.renderItemsIndex];return h===void 0?(h={id:e.id,object:e,geometry:t,material:n,groupOrder:r,renderOrder:e.renderOrder,z:i,group:a,clippingContext:c},this.renderItems[this.renderItemsIndex]=h):(h.id=e.id,h.object=e,h.geometry=t,h.material=n,h.groupOrder=r,h.renderOrder=e.renderOrder,h.z=i,h.group=a,h.clippingContext=c),this.renderItemsIndex++,h}push(e,t,n,r,i,a,c){const h=this.getNextRenderItem(e,t,n,r,i,a,c);e.occlusionTest===!0&&this.occlusionQueryCount++,n.transparent===!0||n.transmission>0?(xme(n)&&this.transparentDoublePass.push(h),this.transparent.push(h)):this.opaque.push(h)}unshift(e,t,n,r,i,a,c){const h=this.getNextRenderItem(e,t,n,r,i,a,c);n.transparent===!0||n.transmission>0?(xme(n)&&this.transparentDoublePass.unshift(h),this.transparent.unshift(h)):this.opaque.unshift(h)}pushBundle(e){this.bundles.push(e)}pushLight(e){this.lightsArray.push(e)}sort(e,t){this.opaque.length>1&&this.opaque.sort(e||UNe),this.transparentDoublePass.length>1&&this.transparentDoublePass.sort(t||_me),this.transparent.length>1&&this.transparent.sort(t||_me)}finish(){this.lightsNode.setLights(this.lightsArray);for(let e=this.renderItemsIndex,t=this.renderItems.length;e<t;e++){const n=this.renderItems[e];if(n.id===null)break;n.id=null,n.object=null,n.geometry=null,n.material=null,n.groupOrder=null,n.renderOrder=null,n.z=null,n.group=null,n.clippingContext=null}}}const dw=[];class VNe{constructor(e){this.lighting=e,this.lists=new mf}get(e,t){const n=this.lists;dw[0]=e,dw[1]=t;let r=n.get(dw);return r===void 0&&(r=new zNe(this.lighting,e,t),n.set(dw,r)),dw.length=0,r}dispose(){this.lists=new mf}}let GNe=0;class jNe{constructor(){this.id=GNe++,this.color=!0,this.clearColor=!0,this.clearColorValue={r:0,g:0,b:0,a:1},this.depth=!0,this.clearDepth=!0,this.clearDepthValue=1,this.stencil=!1,this.clearStencil=!0,this.clearStencilValue=1,this.viewport=!1,this.viewportValue=new Ri,this.scissor=!1,this.scissorValue=new Ri,this.renderTarget=null,this.textures=null,this.depthTexture=null,this.activeCubeFace=0,this.activeMipmapLevel=0,this.sampleCount=1,this.width=0,this.height=0,this.occlusionQueryCount=0,this.clippingContext=null,this.isRenderContext=!0}getCacheKey(){return z3e(this)}}function z3e(o){const{textures:e,activeCubeFace:t}=o,n=[t];for(const r of e)n.push(r.id);return iW(n)}let M6=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return n===void 0?!1:n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){const n=this._listeners;if(n===void 0)return;const r=n[e];if(r!==void 0){const i=r.indexOf(t);i!==-1&&r.splice(i,1)}}dispatchEvent(e){const t=this._listeners;if(t===void 0)return;const n=t[e.type];if(n!==void 0){e.target=this;const r=n.slice(0);for(let i=0,a=r.length;i<a;i++)r[i].call(this,e);e.target=null}}};const bme=new Ts,Sme=new nx;class kh{constructor(e=0,t=0,n=0,r=kh.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,r=this._order){return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const r=e.elements,i=r[0],a=r[4],c=r[8],h=r[1],p=r[5],v=r[9],x=r[2],S=r[6],C=r[10];switch(t){case"XYZ":this._y=Math.asin(wi(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-v,C),this._z=Math.atan2(-a,i)):(this._x=Math.atan2(S,p),this._z=0);break;case"YXZ":this._x=Math.asin(-wi(v,-1,1)),Math.abs(v)<.9999999?(this._y=Math.atan2(c,C),this._z=Math.atan2(h,p)):(this._y=Math.atan2(-x,i),this._z=0);break;case"ZXY":this._x=Math.asin(wi(S,-1,1)),Math.abs(S)<.9999999?(this._y=Math.atan2(-x,C),this._z=Math.atan2(-a,p)):(this._y=0,this._z=Math.atan2(h,i));break;case"ZYX":this._y=Math.asin(-wi(x,-1,1)),Math.abs(x)<.9999999?(this._x=Math.atan2(S,C),this._z=Math.atan2(h,i)):(this._x=0,this._z=Math.atan2(-a,p));break;case"YZX":this._z=Math.asin(wi(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-v,p),this._y=Math.atan2(-x,i)):(this._x=0,this._y=Math.atan2(c,C));break;case"XZY":this._z=Math.asin(-wi(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(S,p),this._y=Math.atan2(c,i)):(this._x=Math.atan2(-v,C),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return bme.makeRotationFromQuaternion(e),this.setFromRotationMatrix(bme,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return Sme.setFromEuler(this),this.setFromQuaternion(Sme,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}kh.DEFAULT_ORDER="XYZ";class HNe{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let WNe=0;const wme=new yt,O7=new nx,ag=new Ts,CR=new yt,fw=new yt,$Ne=new yt,qNe=new nx,Eme=new yt(1,0,0),Tme=new yt(0,1,0),Mme=new yt(0,0,1),Cme={type:"added"},XNe={type:"removed"},F7={type:"childadded",child:null},eV={type:"childremoved",child:null};class va extends M6{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:WNe++}),this.uuid=Sg(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=va.DEFAULT_UP.clone();const e=new yt,t=new kh,n=new nx,r=new yt(1,1,1);function i(){n.setFromEuler(t,!1)}function a(){t.setFromQuaternion(n,void 0,!1)}t._onChange(i),n._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Ts},normalMatrix:{value:new Mc}}),this.matrix=new Ts,this.matrixWorld=new Ts,this.matrixAutoUpdate=va.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=va.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new HNe,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return O7.setFromAxisAngle(e,t),this.quaternion.multiply(O7),this}rotateOnWorldAxis(e,t){return O7.setFromAxisAngle(e,t),this.quaternion.premultiply(O7),this}rotateX(e){return this.rotateOnAxis(Eme,e)}rotateY(e){return this.rotateOnAxis(Tme,e)}rotateZ(e){return this.rotateOnAxis(Mme,e)}translateOnAxis(e,t){return wme.copy(e).applyQuaternion(this.quaternion),this.position.add(wme.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(Eme,e)}translateY(e){return this.translateOnAxis(Tme,e)}translateZ(e){return this.translateOnAxis(Mme,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(ag.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?CR.copy(e):CR.set(e,t,n);const r=this.parent;this.updateWorldMatrix(!0,!1),fw.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ag.lookAt(fw,CR,this.up):ag.lookAt(CR,fw,this.up),this.quaternion.setFromRotationMatrix(ag),r&&(ag.extractRotation(r.matrixWorld),O7.setFromRotationMatrix(ag),this.quaternion.premultiply(O7.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(Cme),F7.child=e,this.dispatchEvent(F7),F7.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(XNe),eV.child=e,this.dispatchEvent(eV),eV.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),ag.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),ag.multiply(e.parent.matrixWorld)),e.applyMatrix4(ag),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(Cme),F7.child=e,this.dispatchEvent(F7),F7.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,r=this.children.length;n<r;n++){const a=this.children[n].getObjectByProperty(e,t);if(a!==void 0)return a}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);const r=this.children;for(let i=0,a=r.length;i<a;i++)r[i].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(fw,e,$Ne),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(fw,qNe,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(e===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const r=this.children;for(let i=0,a=r.length;i<a;i++)r[i].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.geometryInfo=this._geometryInfo.map(c=>({...c,boundingBox:c.boundingBox?c.boundingBox.toJSON():void 0,boundingSphere:c.boundingSphere?c.boundingSphere.toJSON():void 0})),r.instanceInfo=this._instanceInfo.map(c=>({...c})),r.availableInstanceIds=this._availableInstanceIds.slice(),r.availableGeometryIds=this._availableGeometryIds.slice(),r.nextIndexStart=this._nextIndexStart,r.nextVertexStart=this._nextVertexStart,r.geometryCount=this._geometryCount,r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.matricesTexture=this._matricesTexture.toJSON(e),r.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(r.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(r.boundingSphere=this.boundingSphere.toJSON()),this.boundingBox!==null&&(r.boundingBox=this.boundingBox.toJSON()));function i(c,h){return c[h.uuid]===void 0&&(c[h.uuid]=h.toJSON(e)),h.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=i(e.geometries,this.geometry);const c=this.geometry.parameters;if(c!==void 0&&c.shapes!==void 0){const h=c.shapes;if(Array.isArray(h))for(let p=0,v=h.length;p<v;p++){const x=h[p];i(e.shapes,x)}else i(e.shapes,h)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(i(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const c=[];for(let h=0,p=this.material.length;h<p;h++)c.push(i(e.materials,this.material[h]));r.material=c}else r.material=i(e.materials,this.material);if(this.children.length>0){r.children=[];for(let c=0;c<this.children.length;c++)r.children.push(this.children[c].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let c=0;c<this.animations.length;c++){const h=this.animations[c];r.animations.push(i(e.animations,h))}}if(t){const c=a(e.geometries),h=a(e.materials),p=a(e.textures),v=a(e.images),x=a(e.shapes),S=a(e.skeletons),C=a(e.animations),I=a(e.nodes);c.length>0&&(n.geometries=c),h.length>0&&(n.materials=h),p.length>0&&(n.textures=p),v.length>0&&(n.images=v),x.length>0&&(n.shapes=x),S.length>0&&(n.skeletons=S),C.length>0&&(n.animations=C),I.length>0&&(n.nodes=I)}return n.object=r,n;function a(c){const h=[];for(const p in c){const v=c[p];delete v.metadata,h.push(v)}return h}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){const r=e.children[n];this.add(r.clone())}return this}}va.DEFAULT_UP=new yt(0,1,0);va.DEFAULT_MATRIX_AUTO_UPDATE=!0;va.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;class sW extends va{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new kh,this.environmentIntensity=1,this.environmentRotation=new kh,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class oW extends va{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Ts,this.projectionMatrix=new Ts,this.projectionMatrixInverse=new Ts,this.coordinateSystem=bc}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const pw=[],YNe=new sW,KNe=new oW;class ZNe{constructor(){this.chainMaps={}}get(e,t,n=null){pw[0]=e,pw[1]=t;let r;if(n===null)r="default";else{const c=n.texture.format;r=`${n.textures.length}:${c}:${n.samples}:${n.depthBuffer}:${n.stencilBuffer}`}const i=this._getChainMap(r);let a=i.get(pw);return a===void 0&&(a=new jNe,i.set(pw,a)),pw.length=0,n!==null&&(a.sampleCount=n.samples===0?1:n.samples),a}getForClear(e=null){return this.get(YNe,KNe,e)}_getChainMap(e){return this.chainMaps[e]||(this.chainMaps[e]=new mf)}dispose(){this.chainMaps={}}}let L7;class QNe{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{L7===void 0&&(L7=Vj("canvas")),L7.width=e.width,L7.height=e.height;const r=L7.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),n=L7}return n.toDataURL(t)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=Vj("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),i=r.data;for(let a=0;a<i.length;a++)i[a]=Cg(i[a]/255)*255;return n.putImageData(r,0,0),t}else if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(Cg(t[n]/255)*255):t[n]=Cg(t[n]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let JNe=0;class aW{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:JNe++}),this.uuid=Sg(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const t=this.data;return t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight):t!==null?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(r!==null){let i;if(Array.isArray(r)){i=[];for(let a=0,c=r.length;a<c;a++)r[a].isDataTexture?i.push(tV(r[a].image)):i.push(tV(r[a]))}else i=tV(r);n.url=i}return t||(e.images[this.uuid]=n),n}}function tV(o){return typeof HTMLImageElement<"u"&&o instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&o instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&o instanceof ImageBitmap?QNe.getDataURL(o):o.data?{data:Array.from(o.data),width:o.width,height:o.height,type:o.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let eDe=0;const nV=new yt;class j0 extends M6{constructor(e=j0.DEFAULT_IMAGE,t=j0.DEFAULT_MAPPING,n=W3,r=W3,i=Eu,a=Tg,c=Ch,h=Il,p=j0.DEFAULT_ANISOTROPY,v=Ig){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:eDe++}),this.uuid=Sg(),this.name="",this.source=new aW(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=r,this.magFilter=i,this.minFilter=a,this.anisotropy=p,this.format=c,this.internalFormat=null,this.type=h,this.offset=new pi(0,0),this.repeat=new pi(1,1),this.center=new pi(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Mc,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=v,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(nV).x}get height(){return this.source.getSize(nV).y}get depth(){return this.source.getSize(nV).z}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const t in e){const n=e[t];if(n===void 0){console.warn(`THREE.Texture.setValues(): parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){console.warn(`THREE.Texture.setValues(): property '${t}' does not exist.`);continue}r&&n&&r.isVector2&&n.isVector2||r&&n&&r.isVector3&&n.isVector3||r&&n&&r.isMatrix3&&n.isMatrix3?r.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==YH)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case V_:e.x=e.x-Math.floor(e.x);break;case W3:e.x=e.x<0?0:1;break;case G_:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case V_:e.y=e.y-Math.floor(e.y);break;case W3:e.y=e.y<0?0:1;break;case G_:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}j0.DEFAULT_IMAGE=null;j0.DEFAULT_MAPPING=YH;j0.DEFAULT_ANISOTROPY=1;class t1 extends j0{constructor(e,t,n=Ho,r,i,a,c=ya,h=ya,p,v=e1,x=1){if(v!==e1&&v!==Mg)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");const S={width:e,height:t,depth:x};super(S,r,i,a,c,h,v,n,p),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new aW(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}const tDe=new yt;class nDe extends t4{constructor(e,t,n){super(),this.renderer=e,this.backend=t,this.info=n}updateRenderTarget(e,t=0){const n=this.get(e),r=e.samples===0?1:e.samples,i=n.depthTextureMips||(n.depthTextureMips={}),a=e.textures,c=this.getSize(a[0]),h=c.width>>t,p=c.height>>t;let v=e.depthTexture||i[t];const x=e.depthBuffer===!0||e.stencilBuffer===!0;let S=!1;v===void 0&&x&&(v=new t1,v.format=e.stencilBuffer?Mg:e1,v.type=e.stencilBuffer?$3:Ho,v.image.width=h,v.image.height=p,v.image.depth=c.depth,v.isArrayTexture=e.multiview===!0&&c.depth>1,i[t]=v),(n.width!==c.width||c.height!==n.height)&&(S=!0,v&&(v.needsUpdate=!0,v.image.width=h,v.image.height=p,v.image.depth=v.isArrayTexture?v.image.depth:1)),n.width=c.width,n.height=c.height,n.textures=a,n.depthTexture=v||null,n.depth=e.depthBuffer,n.stencil=e.stencilBuffer,n.renderTarget=e,n.sampleCount!==r&&(S=!0,v&&(v.needsUpdate=!0),n.sampleCount=r);const C={sampleCount:r};if(e.isXRRenderTarget!==!0){for(let I=0;I<a.length;I++){const L=a[I];S&&(L.needsUpdate=!0),this.updateTexture(L,C)}v&&this.updateTexture(v,C)}if(n.initialized!==!0){n.initialized=!0;const I=()=>{e.removeEventListener("dispose",I);for(let L=0;L<a.length;L++)this._destroyTexture(a[L]);v&&this._destroyTexture(v),this.delete(e)};e.addEventListener("dispose",I)}}updateTexture(e,t={}){const n=this.get(e);if(n.initialized===!0&&n.version===e.version)return;const r=e.isRenderTargetTexture||e.isDepthTexture||e.isFramebufferTexture,i=this.backend;if(r&&n.initialized===!0&&(i.destroySampler(e),i.destroyTexture(e)),e.isFramebufferTexture){const p=this.renderer.getRenderTarget();p?e.type=p.texture.type:e.type=Il}const{width:a,height:c,depth:h}=this.getSize(e);if(t.width=a,t.height=c,t.depth=h,t.needsMipmaps=this.needsMipmaps(e),t.levels=t.needsMipmaps?this.getMipLevels(e,a,c):1,r||e.isStorageTexture===!0)i.createSampler(e),i.createTexture(e,t),n.generation=e.version;else if(n.initialized!==!0&&i.createSampler(e),e.version>0){const v=e.image;if(v===void 0)console.warn("THREE.Renderer: Texture marked for update but image is undefined.");else if(v.complete===!1)console.warn("THREE.Renderer: Texture marked for update but image is incomplete.");else{if(e.images){const x=[];for(const S of e.images)x.push(S);t.images=x}else t.image=v;(n.isDefaultTexture===void 0||n.isDefaultTexture===!0)&&(i.createTexture(e,t),n.isDefaultTexture=!1,n.generation=e.version),e.source.dataReady===!0&&i.updateTexture(e,t),t.needsMipmaps&&e.mipmaps.length===0&&i.generateMipmaps(e)}}else i.createDefaultTexture(e),n.isDefaultTexture=!0,n.generation=e.version;if(n.initialized!==!0){n.initialized=!0,n.generation=e.version,this.info.memory.textures++;const p=()=>{e.removeEventListener("dispose",p),this._destroyTexture(e)};e.addEventListener("dispose",p)}n.version=e.version}getSize(e,t=tDe){let n=e.images?e.images[0]:e.image;return n?(n.image!==void 0&&(n=n.image),t.width=n.width||1,t.height=n.height||1,t.depth=e.isCubeTexture?6:n.depth||1):t.width=t.height=t.depth=1,t}getMipLevels(e,t,n){let r;return e.isCompressedTexture?e.mipmaps?r=e.mipmaps.length:r=1:r=Math.floor(Math.log2(Math.max(t,n)))+1,r}needsMipmaps(e){return e.isCompressedTexture===!0||e.generateMipmaps}_destroyTexture(e){this.has(e)===!0&&(this.backend.destroySampler(e),this.backend.destroyTexture(e),this.delete(e),this.info.memory.textures--)}}class lW extends qi{constructor(e,t,n,r=1){super(e,t,n),this.a=r}set(e,t,n,r=1){return this.a=r,super.set(e,t,n)}copy(e){return e.a!==void 0&&(this.a=e.a),super.copy(e)}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}}const AR={VERTEX:"vertex"},vi={NONE:"none",FRAME:"frame",RENDER:"render",OBJECT:"object"},_g={READ_ONLY:"readOnly",WRITE_ONLY:"writeOnly",READ_WRITE:"readWrite"},rDe=["fragment","vertex"],Ame=["setup","analyze","generate"],Pme=[...rDe,"compute"],rx=["x","y","z","w"],iDe={analyze:"setup",generate:"analyze"};let sDe=0,ti=class extends M6{static get type(){return"Node"}constructor(e=null){super(),this.nodeType=e,this.updateType=vi.NONE,this.updateBeforeType=vi.NONE,this.updateAfterType=vi.NONE,this.uuid=IIe.generateUUID(),this.version=0,this.global=!1,this.parents=!1,this.isNode=!0,this._cacheKey=null,this._cacheKeyVersion=0,Object.defineProperty(this,"id",{value:sDe++})}set needsUpdate(e){e===!0&&this.version++}get type(){return this.constructor.type}onUpdate(e,t){return this.updateType=t,this.update=e.bind(this.getSelf()),this}onFrameUpdate(e){return this.onUpdate(e,vi.FRAME)}onRenderUpdate(e){return this.onUpdate(e,vi.RENDER)}onObjectUpdate(e){return this.onUpdate(e,vi.OBJECT)}onReference(e){return this.updateReference=e.bind(this.getSelf()),this}getSelf(){return this.self||this}updateReference(){return this}isGlobal(){return this.global}*getChildren(){for(const{childNode:e}of nI(this))yield e}dispose(){this.dispatchEvent({type:"dispose"})}traverse(e){e(this);for(const t of this.getChildren())t.traverse(e)}getCacheKey(e=!1){return e=e||this.version!==this._cacheKeyVersion,(e===!0||this._cacheKey===null)&&(this._cacheKey=tI(I3e(this,e),this.customCacheKey()),this._cacheKeyVersion=this.version),this._cacheKey}customCacheKey(){return 0}getScope(){return this}getHash(){return this.uuid}getUpdateType(){return this.updateType}getUpdateBeforeType(){return this.updateBeforeType}getUpdateAfterType(){return this.updateAfterType}getElementType(e){const t=this.getNodeType(e);return e.getElementType(t)}getMemberType(){return"void"}getNodeType(e){const t=e.getNodeProperties(this);return t.outputNode?t.outputNode.getNodeType(e):this.nodeType}getShared(e){const t=this.getHash(e);return e.getNodeFromHash(t)||this}setup(e){const t=e.getNodeProperties(this);let n=0;for(const r of this.getChildren())t["node"+n++]=r;return t.outputNode||null}analyze(e,t=null){const n=e.increaseUsage(this);if(this.parents===!0){const r=e.getDataFromNode(this,"any");r.stages=r.stages||{},r.stages[e.shaderStage]=r.stages[e.shaderStage]||[],r.stages[e.shaderStage].push(t)}if(n===1){const r=e.getNodeProperties(this);for(const i of Object.values(r))i&&i.isNode===!0&&i.build(e,this)}}generate(e,t){const{outputNode:n}=e.getNodeProperties(this);if(n&&n.isNode===!0)return n.build(e,t)}updateBefore(){console.warn("Abstract function.")}updateAfter(){console.warn("Abstract function.")}update(){console.warn("Abstract function.")}build(e,t=null){const n=this.getShared(e);if(this!==n)return n.build(e,t);const r=e.getDataFromNode(this);r.buildStages=r.buildStages||{},r.buildStages[e.buildStage]=!0;const i=iDe[e.buildStage];if(i&&r.buildStages[i]!==!0){const h=e.getBuildStage();e.setBuildStage(i),this.build(e),e.setBuildStage(h)}e.addNode(this),e.addChain(this);let a=null;const c=e.getBuildStage();if(c==="setup"){this.updateReference(e);const h=e.getNodeProperties(this);if(h.initialized!==!0){h.initialized=!0,h.outputNode=this.setup(e)||h.outputNode||null;for(const p of Object.values(h))if(p&&p.isNode===!0){if(p.parents===!0){const v=e.getNodeProperties(p);v.parents=v.parents||[],v.parents.push(this)}p.build(e)}}a=h.outputNode}else if(c==="analyze")this.analyze(e,t);else if(c==="generate")if(this.generate.length===1){const p=this.getNodeType(e),v=e.getDataFromNode(this);a=v.snippet,a===void 0?v.generated===void 0?(v.generated=!0,a=this.generate(e)||"",v.snippet=a):(console.warn("THREE.Node: Recursion detected.",this),a=""):v.flowCodes!==void 0&&e.context.nodeBlock!==void 0&&e.addFlowCodeHierarchy(this,e.context.nodeBlock),a=e.format(a,p,t)}else a=this.generate(e,t)||"";return e.removeChain(this),e.addSequentialNode(this),a}getSerializeChildren(){return nI(this)}serialize(e){const t=this.getSerializeChildren(),n={};for(const{property:r,index:i,childNode:a}of t)i!==void 0?(n[r]===void 0&&(n[r]=Number.isInteger(i)?[]:{}),n[r][i]=a.toJSON(e.meta).uuid):n[r]=a.toJSON(e.meta).uuid;Object.keys(n).length>0&&(e.inputNodes=n)}deserialize(e){if(e.inputNodes!==void 0){const t=e.meta.nodes;for(const n in e.inputNodes)if(Array.isArray(e.inputNodes[n])){const r=[];for(const i of e.inputNodes[n])r.push(t[i]);this[n]=r}else if(typeof e.inputNodes[n]=="object"){const r={};for(const i in e.inputNodes[n]){const a=e.inputNodes[n][i];r[i]=t[a]}this[n]=r}else{const r=e.inputNodes[n];this[n]=t[r]}}}toJSON(e){const{uuid:t,type:n}=this,r=e===void 0||typeof e=="string";r&&(e={textures:{},images:{},nodes:{}});let i=e.nodes[t];i===void 0&&(i={uuid:t,type:n,meta:e,metadata:{version:4.7,type:"Node",generator:"Node.toJSON"}},r!==!0&&(e.nodes[i.uuid]=i),this.serialize(i),delete i.meta);function a(c){const h=[];for(const p in c){const v=c[p];delete v.metadata,h.push(v)}return h}if(r){const c=a(e.textures),h=a(e.images),p=a(e.nodes);c.length>0&&(i.textures=c),h.length>0&&(i.images=h),p.length>0&&(i.nodes=p)}return i}};class oa extends ti{static get type(){return"TempNode"}constructor(e=null){super(e),this.isTempNode=!0}hasDependencies(e){return e.getDataFromNode(this).usageCount>1}build(e,t){if(e.getBuildStage()==="generate"){const r=e.getVectorType(this.getNodeType(e,t)),i=e.getDataFromNode(this);if(i.propertyName!==void 0)return e.format(i.propertyName,r,t);if(r!=="void"&&t!=="void"&&this.hasDependencies(e)){const a=super.build(e,r),c=e.getVarFromNode(this,null,r),h=e.getPropertyName(c);return e.addLineFlowCode(`${h} = ${a}`,this),i.snippet=a,i.propertyName=h,e.format(i.propertyName,r,t)}}return super.build(e,t)}}class DE extends ti{static get type(){return"ArrayElementNode"}constructor(e,t){super(),this.node=e,this.indexNode=t,this.isArrayElementNode=!0}getNodeType(e){return this.node.getElementType(e)}generate(e){const t=this.indexNode.getNodeType(e),n=this.node.build(e),r=this.indexNode.build(e,!e.isVector(t)&&e.isInteger(t)?t:"uint");return`${n}[ ${r} ]`}}class V3e extends ti{static get type(){return"ConvertNode"}constructor(e,t){super(),this.node=e,this.convertTo=t}getNodeType(e){const t=this.node.getNodeType(e);let n=null;for(const r of this.convertTo.split("|"))(n===null||e.getTypeLength(t)===e.getTypeLength(r))&&(n=r);return n}serialize(e){super.serialize(e),e.convertTo=this.convertTo}deserialize(e){super.deserialize(e),this.convertTo=e.convertTo}generate(e,t){const n=this.node,r=this.getNodeType(e),i=n.build(e,r);return e.format(i,r,t)}}class oDe extends oa{static get type(){return"JoinNode"}constructor(e=[],t=null){super(t),this.nodes=e}getNodeType(e){return this.nodeType!==null?e.getVectorType(this.nodeType):e.getTypeFromLength(this.nodes.reduce((t,n)=>t+e.getTypeLength(n.getNodeType(e)),0))}generate(e,t){const n=this.getNodeType(e),r=e.getTypeLength(n),i=this.nodes,a=e.getComponentType(n),c=[];let h=0;for(const v of i){if(h>=r){console.error(`THREE.TSL: Length of parameters exceeds maximum length of function '${n}()' type.`);break}let x=v.getNodeType(e),S=e.getTypeLength(x),C;h+S>r&&(console.error(`THREE.TSL: Length of '${n}()' data exceeds maximum length of output type.`),S=r-h,x=e.getTypeFromLength(S)),h+=S,C=v.build(e,x);const I=e.getComponentType(x);I!==a&&(C=e.format(C,I,a)),c.push(C)}const p=`${e.getType(n)}( ${c.join(", ")} )`;return e.format(p,n,t)}}const aDe=rx.join("");class Rme extends ti{static get type(){return"SplitNode"}constructor(e,t="x"){super(),this.node=e,this.components=t,this.isSplitNode=!0}getVectorLength(){let e=this.components.length;for(const t of this.components)e=Math.max(rx.indexOf(t)+1,e);return e}getComponentType(e){return e.getComponentType(this.node.getNodeType(e))}getNodeType(e){return e.getTypeFromLength(this.components.length,this.getComponentType(e))}generate(e,t){const n=this.node,r=e.getTypeLength(n.getNodeType(e));let i=null;if(r>1){let a=null;this.getVectorLength()>=r&&(a=e.getTypeFromLength(this.getVectorLength(),this.getComponentType(e)));const h=n.build(e,a);this.components.length===r&&this.components===aDe.slice(0,this.components.length)?i=e.format(h,a,t):i=e.format(`${h}.${this.components}`,this.getNodeType(e),t)}else i=n.build(e,t);return i}serialize(e){super.serialize(e),e.components=this.components}deserialize(e){super.deserialize(e),this.components=e.components}}class lDe extends oa{static get type(){return"SetNode"}constructor(e,t,n){super(),this.sourceNode=e,this.components=t,this.targetNode=n}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{sourceNode:t,components:n,targetNode:r}=this,i=this.getNodeType(e),a=e.getComponentType(r.getNodeType(e)),c=e.getTypeFromLength(n.length,a),h=r.build(e,c),p=t.build(e,i),v=e.getTypeLength(i),x=[];for(let S=0;S<v;S++){const C=rx[S];C===n[0]?(x.push(h),S+=n.length-1):x.push(p+"."+C)}return`${e.getType(i)}( ${x.join(", ")} )`}}class cDe extends oa{static get type(){return"FlipNode"}constructor(e,t){super(),this.sourceNode=e,this.components=t}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{components:t,sourceNode:n}=this,r=this.getNodeType(e),i=n.build(e),a=e.getVarFromNode(this),c=e.getPropertyName(a);e.addLineFlowCode(c+" = "+i,this);const h=e.getTypeLength(r),p=[];let v=0;for(let x=0;x<h;x++){const S=rx[x];S===t[v]?(p.push("1.0 - "+(c+"."+S)),v++):p.push(c+"."+S)}return`${e.getType(r)}( ${p.join(", ")} )`}}class cW extends ti{static get type(){return"InputNode"}constructor(e,t=null){super(t),this.isInputNode=!0,this.value=e,this.precision=null}getNodeType(){return this.nodeType===null?rI(this.value):this.nodeType}getInputType(e){return this.getNodeType(e)}setPrecision(e){return this.precision=e,this}serialize(e){super.serialize(e),e.value=this.value,this.value&&this.value.toArray&&(e.value=this.value.toArray()),e.valueType=rI(this.value),e.nodeType=this.nodeType,e.valueType==="ArrayBuffer"&&(e.value=bNe(e.value)),e.precision=this.precision}deserialize(e){super.deserialize(e),this.nodeType=e.nodeType,this.value=Array.isArray(e.value)?N3e(e.valueType,...e.value):e.value,this.precision=e.precision||null,this.value&&this.value.fromArray&&(this.value=this.value.fromArray(e.value))}generate(){console.warn("Abstract function.")}}const kme=/float|u?int/;class Fg extends cW{static get type(){return"ConstNode"}constructor(e,t=null){super(e,t),this.isConstNode=!0}generateConst(e){return e.generateConst(this.getNodeType(e),this.value)}generate(e,t){const n=this.getNodeType(e);return kme.test(n)&&kme.test(t)?e.generateConst(t,this.value):e.format(this.generateConst(e),n,t)}}class uDe extends ti{static get type(){return"MemberNode"}constructor(e,t){super(),this.node=e,this.property=t,this.isMemberNode=!0}getNodeType(e){return this.node.getMemberType(e,this.property)}generate(e){return this.node.build(e)+"."+this.property}}let j_=null;const p_=new Map;function Ht(o,e){if(p_.has(o)){console.warn(`THREE.TSL: Redefinition of method chaining '${o}'.`);return}if(typeof e!="function")throw new Error(`THREE.TSL: Node element ${o} is not a function`);p_.set(o,e)}const G3e=o=>o.replace(/r|s/g,"x").replace(/g|t/g,"y").replace(/b|p/g,"z").replace(/a|q/g,"w"),Ime=o=>G3e(o).split("").sort().join(""),j3e={setup(o,e){const t=e.shift();return o(MI(t),...e)},get(o,e,t){if(typeof e=="string"&&o[e]===void 0){if(o.isStackNode!==!0&&e==="assign")return(...n)=>(j_.assign(t,...n),t);if(p_.has(e)){const n=p_.get(e);return o.isStackNode?(...r)=>t.add(n(...r)):(...r)=>n(t,...r)}else{if(e==="self")return o;if(e.endsWith("Assign")&&p_.has(e.slice(0,e.length-6))){const n=p_.get(e.slice(0,e.length-6));return o.isStackNode?(...r)=>t.assign(r[0],n(...r)):(...r)=>t.assign(n(t,...r))}else{if(/^[xyzwrgbastpq]{1,4}$/.test(e)===!0)return e=G3e(e),hn(new Rme(t,e));if(/^set[XYZWRGBASTPQ]{1,4}$/.test(e)===!0)return e=Ime(e.slice(3).toLowerCase()),n=>hn(new lDe(o,e,hn(n)));if(/^flip[XYZWRGBASTPQ]{1,4}$/.test(e)===!0)return e=Ime(e.slice(4).toLowerCase()),()=>hn(new cDe(hn(o),e));if(e==="width"||e==="height"||e==="depth")return e==="width"?e="x":e==="height"?e="y":e==="depth"&&(e="z"),hn(new Rme(o,e));if(/^\d+$/.test(e)===!0)return hn(new DE(t,new Fg(Number(e),"uint")));if(/^get$/.test(e)===!0)return n=>hn(new uDe(t,n))}}}return Reflect.get(o,e,t)},set(o,e,t,n){return typeof e=="string"&&o[e]===void 0&&(/^[xyzwrgbastpq]{1,4}$/.test(e)===!0||e==="width"||e==="height"||e==="depth"||/^\d+$/.test(e)===!0)?(n[e].assign(t),!0):Reflect.set(o,e,t,n)}},rV=new WeakMap,Nme=new WeakMap,hDe=function(o,e=null){const t=rI(o);if(t==="node"){let n=rV.get(o);return n===void 0&&(n=new Proxy(o,j3e),rV.set(o,n),rV.set(n,n)),n}else{if(e===null&&(t==="float"||t==="boolean")||t&&t!=="shader"&&t!=="string")return hn(Gj(o,e));if(t==="shader")return cn(o)}return o},dDe=function(o,e=null){for(const t in o)o[t]=hn(o[t],e);return o},fDe=function(o,e=null){const t=o.length;for(let n=0;n<t;n++)o[n]=hn(o[n],e);return o},pDe=function(o,e=null,t=null,n=null){const r=v=>hn(n!==null?Object.assign(v,n):v);let i,a=e,c,h;function p(v){let x;return a?x=/[a-z]/i.test(a)?a+"()":a:x=o.type,c!==void 0&&v.length<c?(console.error(`THREE.TSL: "${x}" parameter length is less than minimum required.`),v.concat(new Array(c-v.length).fill(0))):h!==void 0&&v.length>h?(console.error(`THREE.TSL: "${x}" parameter length exceeds limit.`),v.slice(0,h)):v}return e===null?i=(...v)=>r(new o(...M_(p(v)))):t!==null?(t=hn(t),i=(...v)=>r(new o(e,...M_(p(v)),t))):i=(...v)=>r(new o(e,...M_(p(v)))),i.setParameterLength=(...v)=>(v.length===1?c=h=v[0]:v.length===2&&([c,h]=v),i),i.setName=v=>(a=v,i),i},mDe=function(o,...e){return hn(new o(...M_(e)))};class gDe extends ti{constructor(e,t){super(),this.shaderNode=e,this.inputNodes=t,this.isShaderCallNodeInternal=!0}getNodeType(e){return this.shaderNode.nodeType||this.getOutputNode(e).getNodeType(e)}getMemberType(e,t){return this.getOutputNode(e).getMemberType(e,t)}call(e){const{shaderNode:t,inputNodes:n}=this,r=e.getNodeProperties(t),i=t.namespace&&t.namespace===e.namespace?e.getNamespace("once"):"once";if(r[i])return r[i];let a=null;if(t.layout){let c=Nme.get(e.constructor);c===void 0&&(c=new WeakMap,Nme.set(e.constructor,c));let h=c.get(t);h===void 0&&(h=hn(e.buildFunctionNode(t)),c.set(t,h)),e.addInclude(h),a=hn(h.call(n))}else{const c=t.jsFunc,h=n!==null||c.length>1?c(n||[],e):c(e);a=hn(h)}return t.once&&(r[i]=a),a}setupOutput(e){return e.addStack(),e.stack.outputNode=this.call(e),e.removeStack()}getOutputNode(e){const t=e.getNodeProperties(this),n=e.getOutputNamespace();return t[n]=t[n]||this.setupOutput(e),t[n]}build(e,t=null){let n=null;const r=e.getBuildStage(),i=e.getNodeProperties(this),a=e.getOutputNamespace(),c=this.getOutputNode(e);if(r==="setup"){const h=e.getNamespace("initialized");i[h]!==!0&&(i[h]=!0,i[a]=this.getOutputNode(e),i[a].build(e)),n=i[a]}else r==="analyze"?c.build(e,t):r==="generate"&&(n=c.build(e,t)||"");return n}}class yDe extends ti{constructor(e,t){super(t),this.jsFunc=e,this.layout=null,this.global=!0,this.once=!1,this.namespace=null}setLayout(e){return this.layout=e,this}call(e=null){return MI(e),hn(new gDe(this,e))}setup(){return this.call()}}const vDe=[!1,!0],_De=[0,1,2,3],xDe=[-1,-2],H3e=[.5,1.5,1/3,1e-6,1e6,Math.PI,Math.PI*2,1/Math.PI,2/Math.PI,1/(Math.PI*2),Math.PI/2],uW=new Map;for(const o of vDe)uW.set(o,new Fg(o));const hW=new Map;for(const o of _De)hW.set(o,new Fg(o,"uint"));const dW=new Map([...hW].map(o=>new Fg(o.value,"int")));for(const o of xDe)dW.set(o,new Fg(o,"int"));const EI=new Map([...dW].map(o=>new Fg(o.value)));for(const o of H3e)EI.set(o,new Fg(o));for(const o of H3e)EI.set(-o,new Fg(-o));const TI={bool:uW,uint:hW,ints:dW,float:EI},Dme=new Map([...uW,...EI]),Gj=(o,e)=>Dme.has(o)?Dme.get(o):o.isNode===!0?o:new Fg(o,e),bDe=o=>{try{return o.getNodeType()}catch{return}},aa=function(o,e=null){return(...t)=>{if((t.length===0||!["bool","float","int","uint"].includes(o)&&t.every(r=>typeof r!="object"))&&(t=[N3e(o,...t)]),t.length===1&&e!==null&&e.has(t[0]))return hn(e.get(t[0]));if(t.length===1){const r=Gj(t[0],o);return bDe(r)===o?hn(r):hn(new V3e(r,o))}const n=t.map(r=>Gj(r));return hn(new oDe(n,o))}},Ome=o=>typeof o=="object"&&o!==null?o.value:o,SDe=o=>o!=null?o.nodeType||o.convertTo||(typeof o=="string"?o:null):null;function jw(o,e){return new Proxy(new yDe(o,e),j3e)}const hn=(o,e=null)=>hDe(o,e),MI=(o,e=null)=>new dDe(o,e),M_=(o,e=null)=>new fDe(o,e),un=(...o)=>new pDe(...o),kn=(...o)=>new mDe(...o);let wDe=0;const cn=(o,e=null)=>{let t=null;e!==null&&(typeof e=="object"?t=e.return:(typeof e=="string"?t=e:console.error("THREE.TSL: Invalid layout type."),e=null));const n=new jw(o,t),r=(...i)=>{let a;MI(i),i[0]&&(i[0].isNode||Object.getPrototypeOf(i[0])!==Object.prototype)?a=[...i]:a=i[0];const h=n.call(a);return t==="void"&&h.toStack(),h};if(r.shaderNode=n,r.id=n.id,r.getNodeType=(...i)=>n.getNodeType(...i),r.getCacheKey=(...i)=>n.getCacheKey(...i),r.setLayout=i=>(n.setLayout(i),r),r.once=(i=null)=>(n.once=!0,n.namespace=i,r),e!==null){if(typeof e.inputs!="object"){const i={name:"fn"+wDe++,type:t,inputs:[]};for(const a in e)a!=="return"&&i.inputs.push({name:a,type:e[a]});e=i}r.setLayout(e)}return r},iI=o=>{j_=o},W3e=()=>j_,Wo=(...o)=>j_.If(...o);function $3e(o){return j_&&j_.add(o),o}Ht("toStack",$3e);const EDe=new aa("color"),$t=new aa("float",TI.float),Fs=new aa("int",TI.ints),TDe=new aa("uint",TI.uint),fW=new aa("bool",TI.bool),In=new aa("vec2"),pg=new aa("ivec2"),MDe=new aa("uvec2"),CDe=new aa("bvec2"),Yt=new aa("vec3"),ADe=new aa("ivec3"),PDe=new aa("uvec3"),RDe=new aa("bvec3"),ei=new aa("vec4"),kDe=new aa("ivec4"),IDe=new aa("uvec4"),NDe=new aa("bvec4"),pW=new aa("mat2"),Dl=new aa("mat3"),C_=new aa("mat4");Ht("toColor",EDe);Ht("toFloat",$t);Ht("toInt",Fs);Ht("toUint",TDe);Ht("toBool",fW);Ht("toVec2",In);Ht("toIVec2",pg);Ht("toUVec2",MDe);Ht("toBVec2",CDe);Ht("toVec3",Yt);Ht("toIVec3",ADe);Ht("toUVec3",PDe);Ht("toBVec3",RDe);Ht("toVec4",ei);Ht("toIVec4",kDe);Ht("toUVec4",IDe);Ht("toBVec4",NDe);Ht("toMat2",pW);Ht("toMat3",Dl);Ht("toMat4",C_);const DDe=un(DE).setParameterLength(2),ODe=(o,e)=>hn(new V3e(hn(o),e));Ht("element",DDe);Ht("convert",ODe);Ht("append",o=>(console.warn("THREE.TSL: .append() has been renamed to .toStack()."),$3e(o)));class FDe extends oa{static get type(){return"AssignNode"}constructor(e,t){super(),this.targetNode=e,this.sourceNode=t,this.isAssignNode=!0}hasDependencies(){return!1}getNodeType(e,t){return t!=="void"?this.targetNode.getNodeType(e):"void"}needsSplitAssign(e){const{targetNode:t}=this;if(e.isAvailable("swizzleAssign")===!1&&t.isSplitNode&&t.components.length>1){const n=e.getTypeLength(t.node.getNodeType(e));return rx.join("").slice(0,n)!==t.components}return!1}setup(e){const{targetNode:t,sourceNode:n}=this,r=e.getNodeProperties(this);r.sourceNode=n,r.targetNode=t.context({assign:!0})}generate(e,t){const{targetNode:n,sourceNode:r}=e.getNodeProperties(this),i=this.needsSplitAssign(e),a=n.getNodeType(e),c=n.build(e),h=r.build(e,a),p=r.getNodeType(e),v=e.getDataFromNode(this);let x;if(v.initialized===!0)t!=="void"&&(x=c);else if(i){const S=e.getVarFromNode(this,null,a),C=e.getPropertyName(S);e.addLineFlowCode(`${C} = ${h}`,this);const I=n.node,U=I.node.context({assign:!0}).build(e);for(let R=0;R<I.components.length;R++){const $=I.components[R];e.addLineFlowCode(`${U}.${$} = ${C}[ ${R} ]`,this)}t!=="void"&&(x=c)}else x=`${c} = ${h}`,(t==="void"||p==="void")&&(e.addLineFlowCode(x,this),t!=="void"&&(x=c));return v.initialized=!0,e.format(x,a,t)}}const LDe=un(FDe).setParameterLength(2);Ht("assign",LDe);class Fme extends oa{static get type(){return"ArrayNode"}constructor(e,t,n=null){super(e),this.count=t,this.values=n,this.isArrayNode=!0}getNodeType(e){return this.nodeType===null&&(this.nodeType=this.values[0].getNodeType(e)),this.nodeType}getElementType(e){return this.getNodeType(e)}generate(e){const t=this.getNodeType(e);return e.generateArray(t,this.count,this.values)}}const BDe=(...o)=>{let e;if(o.length===1){const t=o[0];e=new Fme(null,t.length,t)}else{const t=o[0],n=o[1];e=new Fme(t,n)}return hn(e)};Ht("toArray",(o,e)=>BDe(Array(e).fill(o)));class q3e extends ti{static get type(){return"UniformGroupNode"}constructor(e,t=!1,n=1){super("string"),this.name=e,this.shared=t,this.order=n,this.isUniformGroup=!0}serialize(e){super.serialize(e),e.name=this.name,e.version=this.version,e.shared=this.shared}deserialize(e){super.deserialize(e),this.name=e.name,this.version=e.version,this.shared=e.shared}}const UDe=o=>new q3e(o),mW=(o,e=0)=>new q3e(o,!0,e),zDe=mW("frame"),Vr=mW("render"),X3e=UDe("object");class OE extends cW{static get type(){return"UniformNode"}constructor(e,t=null){super(e,t),this.isUniformNode=!0,this.name="",this.groupNode=X3e}label(e){return this.name=e,this}setGroup(e){return this.groupNode=e,this}getGroup(){return this.groupNode}getUniformHash(e){return this.getHash(e)}onUpdate(e,t){const n=this.getSelf();return e=e.bind(n),super.onUpdate(r=>{const i=e(r,n);i!==void 0&&(this.value=i)},t)}generate(e,t){const n=this.getNodeType(e),r=this.getUniformHash(e);let i=e.getNodeFromHash(r);i===void 0&&(e.setHashNode(this,r),i=this);const a=i.getInputType(e),c=e.getUniformFromNode(i,a,e.shaderStage,this.name||e.context.label),h=e.getPropertyName(c);return e.context.label!==void 0&&delete e.context.label,e.format(h,n,t)}}const Gr=(o,e)=>{const t=SDe(e||o),n=o&&o.isNode===!0?o.node&&o.node.value||o.value:o;return hn(new OE(n,t))};class as extends ti{static get type(){return"PropertyNode"}constructor(e,t=null,n=!1){super(e),this.name=t,this.varying=n,this.isPropertyNode=!0,this.global=!0}getHash(e){return this.name||super.getHash(e)}generate(e){let t;return this.varying===!0?(t=e.getVaryingFromNode(this,this.name),t.needsInterpolation=!0):t=e.getVarFromNode(this,this.name),e.getPropertyName(t)}}const Y3e=(o,e)=>hn(new as(o,e)),sI=(o,e)=>hn(new as(o,e,!0)),$i=kn(as,"vec4","DiffuseColor"),Lme=kn(as,"vec3","EmissiveColor"),vg=kn(as,"float","Roughness"),oI=kn(as,"float","Metalness"),jj=kn(as,"float","Clearcoat"),aI=kn(as,"float","ClearcoatRoughness"),m_=kn(as,"vec3","Sheen"),gW=kn(as,"float","SheenRoughness"),yW=kn(as,"float","Iridescence"),K3e=kn(as,"float","IridescenceIOR"),Z3e=kn(as,"float","IridescenceThickness"),Hj=kn(as,"float","AlphaT"),t6=kn(as,"float","Anisotropy"),Mk=kn(as,"vec3","AnisotropyT"),A_=kn(as,"vec3","AnisotropyB"),_u=kn(as,"color","SpecularColor"),lI=kn(as,"float","SpecularF90"),Wj=kn(as,"float","Shininess"),oE=kn(as,"vec4","Output"),iV=kn(as,"float","dashSize"),Bme=kn(as,"float","gapSize"),Ck=kn(as,"float","IOR"),$j=kn(as,"float","Transmission"),Q3e=kn(as,"float","Thickness"),J3e=kn(as,"float","AttenuationDistance"),e4e=kn(as,"color","AttenuationColor"),t4e=kn(as,"float","Dispersion");class VDe extends oa{static get type(){return"FunctionCallNode"}constructor(e=null,t={}){super(),this.functionNode=e,this.parameters=t}setParameters(e){return this.parameters=e,this}getParameters(){return this.parameters}getNodeType(e){return this.functionNode.getNodeType(e)}generate(e){const t=[],n=this.functionNode,r=n.getInputs(e),i=this.parameters,a=(h,p)=>{const v=p.type,x=v==="pointer";let S;return x?S="&"+h.build(e):S=h.build(e,v),S};if(Array.isArray(i)){if(i.length>r.length)console.error("THREE.TSL: The number of provided parameters exceeds the expected number of inputs in 'Fn()'."),i.length=r.length;else if(i.length<r.length)for(console.error("THREE.TSL: The number of provided parameters is less than the expected number of inputs in 'Fn()'.");i.length<r.length;)i.push($t(0));for(let h=0;h<i.length;h++)t.push(a(i[h],r[h]))}else for(const h of r){const p=i[h.name];p!==void 0?t.push(a(p,h)):(console.error(`THREE.TSL: Input '${h.name}' not found in 'Fn()'.`),t.push(a($t(0),h)))}return`${n.build(e,"property")}( ${t.join(", ")} )`}}const GDe=(o,...e)=>(e=e.length>1||e[0]&&e[0].isNode===!0?M_(e):MI(e[0]),hn(new VDe(hn(o),e)));Ht("call",GDe);const jDe={"==":"equal","!=":"notEqual","<":"lessThan",">":"greaterThan","<=":"lessThanEqual",">=":"greaterThanEqual","%":"mod"};class io extends oa{static get type(){return"OperatorNode"}constructor(e,t,n,...r){if(super(),r.length>0){let i=new io(e,t,n);for(let a=0;a<r.length-1;a++)i=new io(e,i,r[a]);t=i,n=r[r.length-1]}this.op=e,this.aNode=t,this.bNode=n,this.isOperatorNode=!0}getOperatorMethod(e,t){return e.getMethod(jDe[this.op],t)}getNodeType(e){const t=this.op,n=this.aNode,r=this.bNode,i=n.getNodeType(e),a=r?r.getNodeType(e):null;if(i==="void"||a==="void")return"void";if(t==="%")return i;if(t==="~"||t==="&"||t==="|"||t==="^"||t===">>"||t==="<<")return e.getIntegerType(i);if(t==="!"||t==="&&"||t==="||"||t==="^^")return"bool";if(t==="=="||t==="!="||t==="<"||t===">"||t==="<="||t===">="){const c=Math.max(e.getTypeLength(i),e.getTypeLength(a));return c>1?`bvec${c}`:"bool"}else{if(e.isMatrix(i)){if(a==="float")return i;if(e.isVector(a))return e.getVectorFromMatrix(i);if(e.isMatrix(a))return i}else if(e.isMatrix(a)){if(i==="float")return a;if(e.isVector(i))return e.getVectorFromMatrix(a)}return e.getTypeLength(a)>e.getTypeLength(i)?a:i}}generate(e,t){const n=this.op,{aNode:r,bNode:i}=this,a=this.getNodeType(e);let c=null,h=null;a!=="void"?(c=r.getNodeType(e),h=i?i.getNodeType(e):null,n==="<"||n===">"||n==="<="||n===">="||n==="=="||n==="!="?e.isVector(c)?h=c:e.isVector(h)?c=h:c!==h&&(c=h="float"):n===">>"||n==="<<"?(c=a,h=e.changeComponentType(h,"uint")):n==="%"?(c=a,h=e.isInteger(c)&&e.isInteger(h)?h:c):e.isMatrix(c)?h==="float"?h="float":e.isVector(h)?h=e.getVectorFromMatrix(c):e.isMatrix(h)||(c=h=a):e.isMatrix(h)?c==="float"?c="float":e.isVector(c)?c=e.getVectorFromMatrix(h):c=h=a:c=h=a):c=h=a;const p=r.build(e,c),v=i?i.build(e,h):null,x=e.getFunctionOperator(n);if(t!=="void"){const S=e.renderer.coordinateSystem===bc;if(n==="=="||n==="!="||n==="<"||n===">"||n==="<="||n===">=")return S?e.isVector(c)?e.format(`${this.getOperatorMethod(e,t)}( ${p}, ${v} )`,a,t):e.format(`( ${p} ${n} ${v} )`,a,t):e.format(`( ${p} ${n} ${v} )`,a,t);if(n==="%")return e.isInteger(h)?e.format(`( ${p} % ${v} )`,a,t):e.format(`${this.getOperatorMethod(e,a)}( ${p}, ${v} )`,a,t);if(n==="!"||n==="~")return e.format(`(${n}${p})`,c,t);if(x)return e.format(`${x}( ${p}, ${v} )`,a,t);if(e.isMatrix(c)&&h==="float")return e.format(`( ${v} ${n} ${p} )`,a,t);if(c==="float"&&e.isMatrix(h))return e.format(`${p} ${n} ${v}`,a,t);{let C=`( ${p} ${n} ${v} )`;return!S&&a==="bool"&&e.isVector(c)&&e.isVector(h)&&(C=`all${C}`),e.format(C,a,t)}}else if(c!=="void")return x?e.format(`${x}( ${p}, ${v} )`,a,t):e.isMatrix(c)&&h==="float"?e.format(`${v} ${n} ${p}`,a,t):e.format(`${p} ${n} ${v}`,a,t)}serialize(e){super.serialize(e),e.op=this.op}deserialize(e){super.deserialize(e),this.op=e.op}}const Ol=un(io,"+").setParameterLength(2,1/0).setName("add"),Rl=un(io,"-").setParameterLength(2,1/0).setName("sub"),Ei=un(io,"*").setParameterLength(2,1/0).setName("mul"),r1=un(io,"/").setParameterLength(2,1/0).setName("div"),CI=un(io,"%").setParameterLength(2).setName("mod"),n4e=un(io,"==").setParameterLength(2).setName("equal"),HDe=un(io,"!=").setParameterLength(2).setName("notEqual"),WDe=un(io,"<").setParameterLength(2).setName("lessThan"),$De=un(io,">").setParameterLength(2).setName("greaterThan"),qDe=un(io,"<=").setParameterLength(2).setName("lessThanEqual"),XDe=un(io,">=").setParameterLength(2).setName("greaterThanEqual"),YDe=un(io,"&&").setParameterLength(2,1/0).setName("and"),KDe=un(io,"||").setParameterLength(2,1/0).setName("or"),ZDe=un(io,"!").setParameterLength(1).setName("not"),QDe=un(io,"^^").setParameterLength(2).setName("xor"),JDe=un(io,"&").setParameterLength(2).setName("bitAnd"),eOe=un(io,"~").setParameterLength(2).setName("bitNot"),tOe=un(io,"|").setParameterLength(2).setName("bitOr"),nOe=un(io,"^").setParameterLength(2).setName("bitXor"),rOe=un(io,"<<").setParameterLength(2).setName("shiftLeft"),iOe=un(io,">>").setParameterLength(2).setName("shiftRight"),sOe=cn(([o])=>(o.addAssign(1),o)),oOe=cn(([o])=>(o.subAssign(1),o)),aOe=cn(([o])=>{const e=Fs(o).toConst();return o.addAssign(1),e}),lOe=cn(([o])=>{const e=Fs(o).toConst();return o.subAssign(1),e});Ht("add",Ol);Ht("sub",Rl);Ht("mul",Ei);Ht("div",r1);Ht("mod",CI);Ht("equal",n4e);Ht("notEqual",HDe);Ht("lessThan",WDe);Ht("greaterThan",$De);Ht("lessThanEqual",qDe);Ht("greaterThanEqual",XDe);Ht("and",YDe);Ht("or",KDe);Ht("not",ZDe);Ht("xor",QDe);Ht("bitAnd",JDe);Ht("bitNot",eOe);Ht("bitOr",tOe);Ht("bitXor",nOe);Ht("shiftLeft",rOe);Ht("shiftRight",iOe);Ht("incrementBefore",sOe);Ht("decrementBefore",oOe);Ht("increment",aOe);Ht("decrement",lOe);const cOe=(o,e)=>(console.warn('THREE.TSL: "remainder()" is deprecated. Use "mod( int( ... ) )" instead.'),CI(o,e)),uOe=(o,e)=>(console.warn('THREE.TSL: "modInt()" is deprecated. Use "mod( int( ... ) )" instead.'),CI(Fs(o),Fs(e)));Ht("remainder",cOe);Ht("modInt",uOe);class mt extends oa{static get type(){return"MathNode"}constructor(e,t,n=null,r=null){if(super(),(e===mt.MAX||e===mt.MIN)&&arguments.length>3){let i=new mt(e,t,n);for(let a=2;a<arguments.length-1;a++)i=new mt(e,i,arguments[a]);t=i,n=arguments[arguments.length-1],r=null}this.method=e,this.aNode=t,this.bNode=n,this.cNode=r,this.isMathNode=!0}getInputType(e){const t=this.aNode.getNodeType(e),n=this.bNode?this.bNode.getNodeType(e):null,r=this.cNode?this.cNode.getNodeType(e):null,i=e.isMatrix(t)?0:e.getTypeLength(t),a=e.isMatrix(n)?0:e.getTypeLength(n),c=e.isMatrix(r)?0:e.getTypeLength(r);return i>a&&i>c?t:a>c?n:c>i?r:t}getNodeType(e){const t=this.method;return t===mt.LENGTH||t===mt.DISTANCE||t===mt.DOT?"float":t===mt.CROSS?"vec3":t===mt.ALL||t===mt.ANY?"bool":t===mt.EQUALS?e.changeComponentType(this.aNode.getNodeType(e),"bool"):this.getInputType(e)}setup(e){const{aNode:t,bNode:n,method:r}=this;let i=null;if(r===mt.ONE_MINUS)i=Rl(1,t);else if(r===mt.RECIPROCAL)i=r1(1,t);else if(r===mt.DIFFERENCE)i=Sh(Rl(t,n));else if(r===mt.TRANSFORM_DIRECTION){let a=t,c=n;e.isMatrix(a.getNodeType(e))?c=ei(Yt(c),0):a=ei(Yt(a),0);const h=Ei(a,c).xyz;i=AE(h)}return i!==null?i:super.setup(e)}generate(e,t){if(e.getNodeProperties(this).outputNode)return super.generate(e,t);let r=this.method;const i=this.getNodeType(e),a=this.getInputType(e),c=this.aNode,h=this.bNode,p=this.cNode,v=e.renderer.coordinateSystem;if(r===mt.NEGATE)return e.format("( - "+c.build(e,a)+" )",i,t);{const x=[];return r===mt.CROSS?x.push(c.build(e,i),h.build(e,i)):v===bc&&r===mt.STEP?x.push(c.build(e,e.getTypeLength(c.getNodeType(e))===1?"float":a),h.build(e,a)):v===bc&&(r===mt.MIN||r===mt.MAX)?x.push(c.build(e,a),h.build(e,e.getTypeLength(h.getNodeType(e))===1?"float":a)):r===mt.REFRACT?x.push(c.build(e,a),h.build(e,a),p.build(e,"float")):r===mt.MIX?x.push(c.build(e,a),h.build(e,a),p.build(e,e.getTypeLength(p.getNodeType(e))===1?"float":a)):(v===K3&&r===mt.ATAN&&h!==null&&(r="atan2"),e.shaderStage!=="fragment"&&(r===mt.DFDX||r===mt.DFDY)&&(console.warn(`THREE.TSL: '${r}' is not supported in the ${e.shaderStage} stage.`),r="/*"+r+"*/"),x.push(c.build(e,a)),h!==null&&x.push(h.build(e,a)),p!==null&&x.push(p.build(e,a))),e.format(`${e.getMethod(r,i)}( ${x.join(", ")} )`,i,t)}}serialize(e){super.serialize(e),e.method=this.method}deserialize(e){super.deserialize(e),this.method=e.method}}mt.ALL="all";mt.ANY="any";mt.RADIANS="radians";mt.DEGREES="degrees";mt.EXP="exp";mt.EXP2="exp2";mt.LOG="log";mt.LOG2="log2";mt.SQRT="sqrt";mt.INVERSE_SQRT="inversesqrt";mt.FLOOR="floor";mt.CEIL="ceil";mt.NORMALIZE="normalize";mt.FRACT="fract";mt.SIN="sin";mt.COS="cos";mt.TAN="tan";mt.ASIN="asin";mt.ACOS="acos";mt.ATAN="atan";mt.ABS="abs";mt.SIGN="sign";mt.LENGTH="length";mt.NEGATE="negate";mt.ONE_MINUS="oneMinus";mt.DFDX="dFdx";mt.DFDY="dFdy";mt.ROUND="round";mt.RECIPROCAL="reciprocal";mt.TRUNC="trunc";mt.FWIDTH="fwidth";mt.TRANSPOSE="transpose";mt.BITCAST="bitcast";mt.EQUALS="equals";mt.MIN="min";mt.MAX="max";mt.STEP="step";mt.REFLECT="reflect";mt.DISTANCE="distance";mt.DIFFERENCE="difference";mt.DOT="dot";mt.CROSS="cross";mt.POW="pow";mt.TRANSFORM_DIRECTION="transformDirection";mt.MIX="mix";mt.CLAMP="clamp";mt.REFRACT="refract";mt.SMOOTHSTEP="smoothstep";mt.FACEFORWARD="faceforward";const hOe=$t(1e-6),dOe=$t(Math.PI),fOe=un(mt,mt.ALL).setParameterLength(1),pOe=un(mt,mt.ANY).setParameterLength(1),mOe=un(mt,mt.RADIANS).setParameterLength(1),gOe=un(mt,mt.DEGREES).setParameterLength(1),r4e=un(mt,mt.EXP).setParameterLength(1),CE=un(mt,mt.EXP2).setParameterLength(1),i4e=un(mt,mt.LOG).setParameterLength(1),Ag=un(mt,mt.LOG2).setParameterLength(1),vW=un(mt,mt.SQRT).setParameterLength(1),yOe=un(mt,mt.INVERSE_SQRT).setParameterLength(1),m6=un(mt,mt.FLOOR).setParameterLength(1),_W=un(mt,mt.CEIL).setParameterLength(1),AE=un(mt,mt.NORMALIZE).setParameterLength(1),n4=un(mt,mt.FRACT).setParameterLength(1),af=un(mt,mt.SIN).setParameterLength(1),U3=un(mt,mt.COS).setParameterLength(1),vOe=un(mt,mt.TAN).setParameterLength(1),_Oe=un(mt,mt.ASIN).setParameterLength(1),s4e=un(mt,mt.ACOS).setParameterLength(1),o4e=un(mt,mt.ATAN).setParameterLength(1,2),Sh=un(mt,mt.ABS).setParameterLength(1),cI=un(mt,mt.SIGN).setParameterLength(1),Pg=un(mt,mt.LENGTH).setParameterLength(1),xOe=un(mt,mt.NEGATE).setParameterLength(1),bOe=un(mt,mt.ONE_MINUS).setParameterLength(1),a4e=un(mt,mt.DFDX).setParameterLength(1),l4e=un(mt,mt.DFDY).setParameterLength(1),SOe=un(mt,mt.ROUND).setParameterLength(1),wOe=un(mt,mt.RECIPROCAL).setParameterLength(1),EOe=un(mt,mt.TRUNC).setParameterLength(1),TOe=un(mt,mt.FWIDTH).setParameterLength(1),MOe=un(mt,mt.TRANSPOSE).setParameterLength(1),COe=(o,e)=>(console.warn('THREE.TSL: "equals" is deprecated. Use "equal" inside a vector instead, like: "bvec*( equal( ... ) )"'),n4e(o,e)),H_=un(mt,mt.MIN).setParameterLength(2,1/0),W0=un(mt,mt.MAX).setParameterLength(2,1/0),c4e=un(mt,mt.STEP).setParameterLength(2),AOe=un(mt,mt.REFLECT).setParameterLength(2),POe=un(mt,mt.DISTANCE).setParameterLength(2),ROe=un(mt,mt.DIFFERENCE).setParameterLength(2),xW=un(mt,mt.DOT).setParameterLength(2),u4e=un(mt,mt.CROSS).setParameterLength(2),AI=un(mt,mt.POW).setParameterLength(2),h4e=un(mt,mt.POW,2).setParameterLength(1),kOe=un(mt,mt.POW,3).setParameterLength(1),IOe=un(mt,mt.POW,4).setParameterLength(1),NOe=un(mt,mt.TRANSFORM_DIRECTION).setParameterLength(2),DOe=o=>Ei(cI(o),AI(Sh(o),1/3)),d4e=o=>xW(o,o),Zs=un(mt,mt.MIX).setParameterLength(3),Dg=(o,e=0,t=1)=>hn(new mt(mt.CLAMP,hn(o),hn(e),hn(t))),f4e=o=>Dg(o),p4e=un(mt,mt.REFRACT).setParameterLength(3),Z3=un(mt,mt.SMOOTHSTEP).setParameterLength(3),OOe=un(mt,mt.FACEFORWARD).setParameterLength(3),FOe=cn(([o])=>{const n=43758.5453,r=xW(o.xy,In(12.9898,78.233)),i=CI(r,dOe);return n4(af(i).mul(n))}),LOe=(o,e,t)=>Zs(e,t,o),BOe=(o,e,t)=>Z3(e,t,o),UOe=(o,e)=>(console.warn('THREE.TSL: "atan2" is overloaded. Use "atan" instead.'),o4e(o,e));Ht("all",fOe);Ht("any",pOe);Ht("equals",COe);Ht("radians",mOe);Ht("degrees",gOe);Ht("exp",r4e);Ht("exp2",CE);Ht("log",i4e);Ht("log2",Ag);Ht("sqrt",vW);Ht("inverseSqrt",yOe);Ht("floor",m6);Ht("ceil",_W);Ht("normalize",AE);Ht("fract",n4);Ht("sin",af);Ht("cos",U3);Ht("tan",vOe);Ht("asin",_Oe);Ht("acos",s4e);Ht("atan",o4e);Ht("abs",Sh);Ht("sign",cI);Ht("length",Pg);Ht("lengthSq",d4e);Ht("negate",xOe);Ht("oneMinus",bOe);Ht("dFdx",a4e);Ht("dFdy",l4e);Ht("round",SOe);Ht("reciprocal",wOe);Ht("trunc",EOe);Ht("fwidth",TOe);Ht("atan2",UOe);Ht("min",H_);Ht("max",W0);Ht("step",c4e);Ht("reflect",AOe);Ht("distance",POe);Ht("dot",xW);Ht("cross",u4e);Ht("pow",AI);Ht("pow2",h4e);Ht("pow3",kOe);Ht("pow4",IOe);Ht("transformDirection",NOe);Ht("mix",LOe);Ht("clamp",Dg);Ht("refract",p4e);Ht("smoothstep",BOe);Ht("faceForward",OOe);Ht("difference",ROe);Ht("saturate",f4e);Ht("cbrt",DOe);Ht("transpose",MOe);Ht("rand",FOe);class zOe extends ti{static get type(){return"ConditionalNode"}constructor(e,t,n=null){super(),this.condNode=e,this.ifNode=t,this.elseNode=n}getNodeType(e){const{ifNode:t,elseNode:n}=e.getNodeProperties(this);if(t===void 0)return this.setup(e),this.getNodeType(e);const r=t.getNodeType(e);if(n!==null){const i=n.getNodeType(e);if(e.getTypeLength(i)>e.getTypeLength(r))return i}return r}setup(e){const t=this.condNode.cache(),n=this.ifNode.cache(),r=this.elseNode?this.elseNode.cache():null,i=e.context.nodeBlock;e.getDataFromNode(n).parentNodeBlock=i,r!==null&&(e.getDataFromNode(r).parentNodeBlock=i);const a=e.getNodeProperties(this);a.condNode=t,a.ifNode=n.context({nodeBlock:n}),a.elseNode=r?r.context({nodeBlock:r}):null}generate(e,t){const n=this.getNodeType(e),r=e.getDataFromNode(this);if(r.nodeProperty!==void 0)return r.nodeProperty;const{condNode:i,ifNode:a,elseNode:c}=e.getNodeProperties(this),h=e.currentFunctionNode,p=t!=="void",v=p?Y3e(n).build(e):"";r.nodeProperty=v;const x=i.build(e,"bool");e.addFlowCode(`
${e.tab}if ( ${x} ) {

`).addFlowTab();let S=a.build(e,n);if(S&&(p?S=v+" = "+S+";":(S="return "+S+";",h===null&&(console.warn("THREE.TSL: Return statement used in an inline 'Fn()'. Define a layout struct to allow return values."),S="// "+S))),e.removeFlowTab().addFlowCode(e.tab+"	"+S+`

`+e.tab+"}"),c!==null){e.addFlowCode(` else {

`).addFlowTab();let C=c.build(e,n);C&&(p?C=v+" = "+C+";":(C="return "+C+";",h===null&&(console.warn("THREE.TSL: Return statement used in an inline 'Fn()'. Define a layout struct to allow return values."),C="// "+C))),e.removeFlowTab().addFlowCode(e.tab+"	"+C+`

`+e.tab+`}

`)}else e.addFlowCode(`

`);return e.format(v,n,t)}}const G0=un(zOe).setParameterLength(2,3);Ht("select",G0);const VOe=(...o)=>(console.warn("THREE.TSL: cond() has been renamed to select()."),G0(...o));Ht("cond",VOe);class m4e extends ti{static get type(){return"ContextNode"}constructor(e,t={}){super(),this.isContextNode=!0,this.node=e,this.value=t}getScope(){return this.node.getScope()}getNodeType(e){return this.node.getNodeType(e)}analyze(e){const t=e.getContext();e.setContext({...e.context,...this.value}),this.node.build(e),e.setContext(t)}setup(e){const t=e.getContext();e.setContext({...e.context,...this.value}),this.node.build(e),e.setContext(t)}generate(e,t){const n=e.getContext();e.setContext({...e.context,...this.value});const r=this.node.build(e,t);return e.setContext(n),r}}const bW=un(m4e).setParameterLength(1,2),GOe=(o,e)=>bW(o,{label:e});Ht("context",bW);Ht("label",GOe);class Ak extends ti{static get type(){return"VarNode"}constructor(e,t=null,n=!1){super(),this.node=e,this.name=t,this.global=!0,this.isVarNode=!0,this.readOnly=n,this.parents=!0}getMemberType(e,t){return this.node.getMemberType(e,t)}getElementType(e){return this.node.getElementType(e)}getNodeType(e){return this.node.getNodeType(e)}generate(e){const{node:t,name:n,readOnly:r}=this,{renderer:i}=e,a=i.backend.isWebGPUBackend===!0;let c=!1,h=!1;r&&(c=e.isDeterministic(t),h=a?r:c);const p=e.getVectorType(this.getNodeType(e)),v=t.build(e,p),x=e.getVarFromNode(this,n,p,void 0,h),S=e.getPropertyName(x);let C=S;if(h)if(a)C=c?`const ${S}`:`let ${S}`;else{const I=e.getArrayCount(t);C=`const ${e.getVar(x.type,S,I)}`}return e.addLineFlowCode(`${C} = ${v}`,this),S}}const SW=un(Ak),jOe=(o,e=null)=>SW(o,e).toStack(),HOe=(o,e=null)=>SW(o,e,!0).toStack();Ht("toVar",jOe);Ht("toConst",HOe);const WOe=o=>(console.warn('TSL: "temp( node )" is deprecated. Use "Var( node )" or "node.toVar()" instead.'),SW(o));Ht("temp",WOe);class $Oe extends ti{static get type(){return"VaryingNode"}constructor(e,t=null){super(),this.node=e,this.name=t,this.isVaryingNode=!0,this.interpolationType=null,this.interpolationSampling=null,this.global=!0}setInterpolation(e,t=null){return this.interpolationType=e,this.interpolationSampling=t,this}getHash(e){return this.name||super.getHash(e)}getNodeType(e){return this.node.getNodeType(e)}setupVarying(e){const t=e.getNodeProperties(this);let n=t.varying;if(n===void 0){const r=this.name,i=this.getNodeType(e),a=this.interpolationType,c=this.interpolationSampling;t.varying=n=e.getVaryingFromNode(this,r,i,a,c),t.node=this.node}return n.needsInterpolation||(n.needsInterpolation=e.shaderStage==="fragment"),n}setup(e){this.setupVarying(e),e.flowNodeFromShaderStage(AR.VERTEX,this.node)}analyze(e){this.setupVarying(e),e.flowNodeFromShaderStage(AR.VERTEX,this.node)}generate(e){const t=e.getNodeProperties(this),n=this.setupVarying(e);if(t.propertyName===void 0){const r=this.getNodeType(e),i=e.getPropertyName(n,AR.VERTEX);e.flowNodeFromShaderStage(AR.VERTEX,this.node,r,i),t.propertyName=i}return e.getPropertyName(n)}}const xf=un($Oe).setParameterLength(1,2),qOe=o=>xf(o);Ht("toVarying",xf);Ht("toVertexStage",qOe);Ht("varying",(...o)=>(console.warn("THREE.TSL: .varying() has been renamed to .toVarying()."),xf(...o)));Ht("vertexStage",(...o)=>(console.warn("THREE.TSL: .vertexStage() has been renamed to .toVertexStage()."),xf(...o)));const XOe=cn(([o])=>{const e=o.mul(.9478672986).add(.0521327014).pow(2.4),t=o.mul(.0773993808),n=o.lessThanEqual(.04045);return Zs(e,t,n)}).setLayout({name:"sRGBTransferEOTF",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),YOe=cn(([o])=>{const e=o.pow(.41666).mul(1.055).sub(.055),t=o.mul(12.92),n=o.lessThanEqual(.0031308);return Zs(e,t,n)}).setLayout({name:"sRGBTransferOETF",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),wW="WorkingColorSpace",KOe="OutputColorSpace";class g4e extends oa{static get type(){return"ColorSpaceNode"}constructor(e,t,n){super("vec4"),this.colorNode=e,this.source=t,this.target=n}resolveColorSpace(e,t){return t===wW?Os.workingColorSpace:t===KOe?e.context.outputColorSpace||e.renderer.outputColorSpace:t}setup(e){const{colorNode:t}=this,n=this.resolveColorSpace(e,this.source),r=this.resolveColorSpace(e,this.target);let i=t;return Os.enabled===!1||n===r||!n||!r||(Os.getTransfer(n)===Yr&&(i=ei(XOe(i.rgb),i.a)),Os.getPrimaries(n)!==Os.getPrimaries(r)&&(i=ei(Dl(Os._getMatrix(new Mc,n,r)).mul(i.rgb),i.a)),Os.getTransfer(r)===Yr&&(i=ei(YOe(i.rgb),i.a))),i}}const ZOe=(o,e)=>hn(new g4e(hn(o),wW,e)),EW=(o,e)=>hn(new g4e(hn(o),e,wW));Ht("workingToColorSpace",ZOe);Ht("colorSpaceToWorking",EW);let QOe=class extends DE{static get type(){return"ReferenceElementNode"}constructor(e,t){super(e,t),this.referenceNode=e,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(e){const t=super.generate(e),n=this.referenceNode.getNodeType(),r=this.getNodeType();return e.format(t,n,r)}};class y4e extends ti{static get type(){return"ReferenceBaseNode"}constructor(e,t,n=null,r=null){super(),this.property=e,this.uniformType=t,this.object=n,this.count=r,this.properties=e.split("."),this.reference=n,this.node=null,this.group=null,this.updateType=vi.OBJECT}setGroup(e){return this.group=e,this}element(e){return hn(new QOe(this,hn(e)))}setNodeType(e){const t=Gr(null,e).getSelf();this.group!==null&&t.setGroup(this.group),this.node=t}getNodeType(e){return this.node===null&&(this.updateReference(e),this.updateValue()),this.node.getNodeType(e)}getValueFromReference(e=this.reference){const{properties:t}=this;let n=e[t[0]];for(let r=1;r<t.length;r++)n=n[t[r]];return n}updateReference(e){return this.reference=this.object!==null?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){this.node===null&&this.setNodeType(this.uniformType);const e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}const JOe=(o,e,t)=>hn(new y4e(o,e,t));class eFe extends y4e{static get type(){return"RendererReferenceNode"}constructor(e,t,n=null){super(e,t,n),this.renderer=n,this.setGroup(Vr)}updateReference(e){return this.reference=this.renderer!==null?this.renderer:e.renderer,this.reference}}const tFe=(o,e,t=null)=>hn(new eFe(o,e,t));class nFe extends oa{static get type(){return"ToneMappingNode"}constructor(e,t=iFe,n=null){super("vec3"),this.toneMapping=e,this.exposureNode=t,this.colorNode=n}customCacheKey(){return tI(this.toneMapping)}setup(e){const t=this.colorNode||e.context.color,n=this.toneMapping;if(n===w_)return t;let r=null;const i=e.renderer.library.getToneMappingFunction(n);return i!==null?r=ei(i(t.rgb,this.exposureNode),t.a):(console.error("ToneMappingNode: Unsupported Tone Mapping configuration.",n),r=t),r}}const rFe=(o,e,t)=>hn(new nFe(o,hn(e),hn(t))),iFe=tFe("toneMappingExposure","float");Ht("toneMapping",(o,e,t)=>rFe(e,t,o));const El=new yt;class TW{constructor(e,t,n,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)El.fromBufferAttribute(this,t),El.applyMatrix4(e),this.setXYZ(t,El.x,El.y,El.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)El.fromBufferAttribute(this,t),El.applyNormalMatrix(e),this.setXYZ(t,El.x,El.y,El.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)El.fromBufferAttribute(this,t),El.transformDirection(e),this.setXYZ(t,El.x,El.y,El.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=kl(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=si(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=si(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=si(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=si(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=si(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=kl(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=kl(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=kl(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=kl(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=si(t,this.array),n=si(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=si(t,this.array),n=si(n,this.array),r=si(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}setXYZW(e,t,n,r,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=si(t,this.array),n=si(n,this.array),r=si(r,this.array),i=si(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=i,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let i=0;i<this.itemSize;i++)t.push(this.data.array[r+i])}return new Ph(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new TW(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let i=0;i<this.itemSize;i++)t.push(this.data.array[r+i])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class v4e{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=eI,this.updateRanges=[],this.version=0,this.uuid=Sg()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let r=0,i=this.stride;r<i;r++)this.array[e+r]=t.array[n+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Sg()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Sg()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}class sFe extends cW{static get type(){return"BufferAttributeNode"}constructor(e,t=null,n=0,r=0){super(e,t),this.isBufferNode=!0,this.bufferType=t,this.bufferStride=n,this.bufferOffset=r,this.usage=eI,this.instanced=!1,this.attribute=null,this.global=!0,e&&e.isBufferAttribute===!0&&(this.attribute=e,this.usage=e.usage,this.instanced=e.isInstancedBufferAttribute)}getHash(e){if(this.bufferStride===0&&this.bufferOffset===0){let t=e.globalCache.getData(this.value);return t===void 0&&(t={node:this},e.globalCache.setData(this.value,t)),t.node.uuid}return this.uuid}getNodeType(e){return this.bufferType===null&&(this.bufferType=e.getTypeFromAttribute(this.attribute)),this.bufferType}setup(e){if(this.attribute!==null)return;const t=this.getNodeType(e),n=this.value,r=e.getTypeLength(t),i=this.bufferStride||r,a=this.bufferOffset,c=n.isInterleavedBuffer===!0?n:new v4e(n,i),h=new TW(c,r,a);c.setUsage(this.usage),this.attribute=h,this.attribute.isInstancedBufferAttribute=this.instanced}generate(e){const t=this.getNodeType(e),n=e.getBufferAttributeFromNode(this,t),r=e.getPropertyName(n);let i=null;return e.shaderStage==="vertex"||e.shaderStage==="compute"?(this.name=r,i=r):i=xf(this).build(e,t),i}getInputType(){return"bufferAttribute"}setUsage(e){return this.usage=e,this.attribute&&this.attribute.isBufferAttribute===!0&&(this.attribute.usage=e),this}setInstanced(e){return this.instanced=e,this}}const MW=(o,e=null,t=0,n=0)=>hn(new sFe(o,e,t,n)),oFe=(o,e=null,t=0,n=0)=>MW(o,e,t,n).setUsage(f_),Ume=(o,e=null,t=0,n=0)=>MW(o,e,t,n).setInstanced(!0),zme=(o,e=null,t=0,n=0)=>oFe(o,e,t,n).setInstanced(!0);Ht("toAttribute",o=>MW(o.value));class aFe extends ti{static get type(){return"ComputeNode"}constructor(e,t,n=[64]){super("void"),this.isComputeNode=!0,this.computeNode=e,this.count=t,this.workgroupSize=n,this.dispatchCount=0,this.version=1,this.name="",this.updateBeforeType=vi.OBJECT,this.onInitFunction=null,this.updateDispatchCount()}dispose(){this.dispatchEvent({type:"dispose"})}label(e){return this.name=e,this}updateDispatchCount(){const{count:e,workgroupSize:t}=this;let n=t[0];for(let r=1;r<t.length;r++)n*=t[r];this.dispatchCount=Math.ceil(e/n)}onInit(e){return this.onInitFunction=e,this}updateBefore({renderer:e}){e.compute(this)}setup(e){const t=this.computeNode.build(e);if(t){const n=e.getNodeProperties(this);n.outputComputeNode=t.outputNode,t.outputNode=null}return t}generate(e,t){const{shaderStage:n}=e;if(n==="compute"){const r=this.computeNode.build(e,"void");r!==""&&e.addLineFlowCode(r,this)}else{const i=e.getNodeProperties(this).outputComputeNode;if(i)return i.build(e,t)}}}const lFe=(o,e,t)=>hn(new aFe(hn(o),e,t));Ht("compute",lFe);class cFe extends ti{static get type(){return"CacheNode"}constructor(e,t=!0){super(),this.node=e,this.parent=t,this.isCacheNode=!0}getNodeType(e){const t=e.getCache(),n=e.getCacheFromNode(this,this.parent);e.setCache(n);const r=this.node.getNodeType(e);return e.setCache(t),r}build(e,...t){const n=e.getCache(),r=e.getCacheFromNode(this,this.parent);e.setCache(r);const i=this.node.build(e,...t);return e.setCache(n),i}}const Pk=(o,e)=>hn(new cFe(hn(o),e)),uFe=(o,e)=>o.context({namespace:e});Ht("cache",Pk);class hFe extends ti{static get type(){return"BypassNode"}constructor(e,t){super(),this.isBypassNode=!0,this.outputNode=e,this.callNode=t}getNodeType(e){return this.outputNode.getNodeType(e)}generate(e){const t=this.callNode.build(e,"void");return t!==""&&e.addLineFlowCode(t,this),this.outputNode.build(e)}}const dFe=un(hFe).setParameterLength(2);Ht("bypass",dFe);class _4e extends ti{static get type(){return"RemapNode"}constructor(e,t,n,r=$t(0),i=$t(1)){super(),this.node=e,this.inLowNode=t,this.inHighNode=n,this.outLowNode=r,this.outHighNode=i,this.doClamp=!0}setup(){const{node:e,inLowNode:t,inHighNode:n,outLowNode:r,outHighNode:i,doClamp:a}=this;let c=e.sub(t).div(n.sub(t));return a===!0&&(c=c.clamp()),c.mul(i.sub(r)).add(r)}}const fFe=un(_4e,null,null,{doClamp:!1}).setParameterLength(3,5),pFe=un(_4e).setParameterLength(3,5);Ht("remap",fFe);Ht("remapClamp",pFe);class Rk extends ti{static get type(){return"ExpressionNode"}constructor(e="",t="void"){super(t),this.snippet=e}generate(e,t){const n=this.getNodeType(e),r=this.snippet;if(n==="void")e.addLineFlowCode(r,this);else return e.format(r,n,t)}}const W_=un(Rk).setParameterLength(1,2),mFe=o=>(o?G0(o,W_("discard")):W_("discard")).toStack();Ht("discard",mFe);class gFe extends oa{static get type(){return"RenderOutputNode"}constructor(e,t,n){super("vec4"),this.colorNode=e,this.toneMapping=t,this.outputColorSpace=n,this.isRenderOutputNode=!0}setup({context:e}){let t=this.colorNode||e.color;const n=(this.toneMapping!==null?this.toneMapping:e.toneMapping)||w_,r=(this.outputColorSpace!==null?this.outputColorSpace:e.outputColorSpace)||Ig;return n!==w_&&(t=t.toneMapping(n)),r!==Ig&&r!==Os.workingColorSpace&&(t=t.workingToColorSpace(r)),t}}const yFe=(o,e=null,t=null)=>hn(new gFe(hn(o),e,t));Ht("renderOutput",yFe);class vFe extends oa{static get type(){return"DebugNode"}constructor(e,t=null){super(),this.node=e,this.callback=t}getNodeType(e){return this.node.getNodeType(e)}setup(e){return this.node.build(e)}analyze(e){return this.node.build(e)}generate(e){const t=this.callback,n=this.node.build(e),r="--- TSL debug - "+e.shaderStage+" shader ---",i="-".repeat(r.length);let a="";return a+="// #"+r+`#
`,a+=e.flow.code.replace(/^\t/mg,"")+`
`,a+="/* ... */ "+n+` /* ... */
`,a+="// #"+i+`#
`,t!==null?t(e,a):console.log(a),n}}const _Fe=(o,e=null)=>hn(new vFe(hn(o),e));Ht("debug",_Fe);class x4e extends ti{static get type(){return"AttributeNode"}constructor(e,t=null){super(t),this.global=!0,this._attributeName=e}getHash(e){return this.getAttributeName(e)}getNodeType(e){let t=this.nodeType;if(t===null){const n=this.getAttributeName(e);if(e.hasGeometryAttribute(n)){const r=e.geometry.getAttribute(n);t=e.getTypeFromAttribute(r)}else t="float"}return t}setAttributeName(e){return this._attributeName=e,this}getAttributeName(){return this._attributeName}generate(e){const t=this.getAttributeName(e),n=this.getNodeType(e);if(e.hasGeometryAttribute(t)===!0){const i=e.geometry.getAttribute(t),a=e.getTypeFromAttribute(i),c=e.getAttribute(t,a);return e.shaderStage==="vertex"?e.format(c.name,a,n):xf(this).build(e,n)}else return console.warn(`AttributeNode: Vertex attribute "${t}" not found on geometry.`),e.generateConst(n)}serialize(e){super.serialize(e),e.global=this.global,e._attributeName=this._attributeName}deserialize(e){super.deserialize(e),this.global=e.global,this._attributeName=e._attributeName}}const Q3=(o,e=null)=>hn(new x4e(o,e));class Qs extends ti{static get type(){return"IndexNode"}constructor(e){super("uint"),this.scope=e,this.isIndexNode=!0}generate(e){const t=this.getNodeType(e),n=this.scope;let r;if(n===Qs.VERTEX)r=e.getVertexIndex();else if(n===Qs.INSTANCE)r=e.getInstanceIndex();else if(n===Qs.DRAW)r=e.getDrawIndex();else if(n===Qs.INVOCATION_LOCAL)r=e.getInvocationLocalIndex();else if(n===Qs.INVOCATION_SUBGROUP)r=e.getInvocationSubgroupIndex();else if(n===Qs.SUBGROUP)r=e.getSubgroupIndex();else throw new Error("THREE.IndexNode: Unknown scope: "+n);let i;return e.shaderStage==="vertex"||e.shaderStage==="compute"?i=r:i=xf(this).build(e,t),i}}Qs.VERTEX="vertex";Qs.INSTANCE="instance";Qs.SUBGROUP="subgroup";Qs.INVOCATION_LOCAL="invocationLocal";Qs.INVOCATION_SUBGROUP="invocationSubgroup";Qs.DRAW="draw";const xFe=kn(Qs,Qs.VERTEX),CW=kn(Qs,Qs.INSTANCE);Qs.SUBGROUP;Qs.INVOCATION_SUBGROUP;Qs.INVOCATION_LOCAL;const bFe=kn(Qs,Qs.DRAW);class SFe extends as{static get type(){return"ParameterNode"}constructor(e,t=null){super(e,t),this.isParameterNode=!0}getHash(){return this.uuid}generate(){return this.name}}class wFe extends ti{static get type(){return"StackNode"}constructor(e=null){super(),this.nodes=[],this.outputNode=null,this.parent=e,this._currentCond=null,this._expressionNode=null,this.isStackNode=!0}getNodeType(e){return this.outputNode?this.outputNode.getNodeType(e):"void"}getMemberType(e,t){return this.outputNode?this.outputNode.getMemberType(e,t):"void"}add(e){return this.nodes.push(e),this}If(e,t){const n=new jw(t);return this._currentCond=G0(e,n),this.add(this._currentCond)}ElseIf(e,t){const n=new jw(t),r=G0(e,n);return this._currentCond.elseNode=r,this._currentCond=r,this}Else(e){return this._currentCond.elseNode=new jw(e),this}Switch(e){return this._expressionNode=hn(e),this}Case(...e){const t=[];if(e.length>=2)for(let c=0;c<e.length-1;c++)t.push(this._expressionNode.equal(hn(e[c])));else throw new Error("TSL: Invalid parameter length. Case() requires at least two parameters.");const n=e[e.length-1],r=new jw(n);let i=t[0];for(let c=1;c<t.length;c++)i=i.or(t[c]);const a=G0(i,r);return this._currentCond===null?(this._currentCond=a,this.add(this._currentCond)):(this._currentCond.elseNode=a,this._currentCond=a,this)}Default(e){return this.Else(e),this}build(e,...t){const n=W3e();iI(this);const r=e.buildStage;for(const i of this.nodes)if(r==="setup")i.build(e);else if(r==="analyze")i.build(e,this);else if(r==="generate"){const a=e.getDataFromNode(i,"any").stages,c=a&&a[e.shaderStage];if(i.isVarNode&&c&&c.length===1&&c[0]&&c[0].isStackNode)continue;i.build(e,"void")}return iI(n),this.outputNode?this.outputNode.build(e,...t):super.build(e,...t)}else(...e){return console.warn("THREE.TSL: .else() has been renamed to .Else()."),this.Else(...e)}elseif(...e){return console.warn("THREE.TSL: .elseif() has been renamed to .ElseIf()."),this.ElseIf(...e)}}const sV=un(wFe).setParameterLength(0,1);class EFe extends ti{static get type(){return"LoopNode"}constructor(e=[]){super(),this.params=e}getVarName(e){return String.fromCharCode(105+e)}getProperties(e){const t=e.getNodeProperties(this);if(t.stackNode!==void 0)return t;const n={};for(let a=0,c=this.params.length-1;a<c;a++){const h=this.params[a],p=h.isNode!==!0&&h.name||this.getVarName(a),v=h.isNode!==!0&&h.type||"int";n[p]=W_(p,v)}const r=e.addStack();t.returnsNode=this.params[this.params.length-1](n,e),t.stackNode=r;const i=this.params[0];return i.isNode!==!0&&typeof i.update=="function"&&(t.updateNode=cn(this.params[0].update)(n)),e.removeStack(),t}getNodeType(e){const{returnsNode:t}=this.getProperties(e);return t?t.getNodeType(e):"void"}setup(e){this.getProperties(e)}generate(e){const t=this.getProperties(e),n=this.params,r=t.stackNode;for(let c=0,h=n.length-1;c<h;c++){const p=n[c];let v=!1,x=null,S=null,C=null,I=null,L=null,U=null;p.isNode?p.getNodeType(e)==="bool"?(v=!0,I="bool",S=p.build(e,I)):(I="int",C=this.getVarName(c),x="0",S=p.build(e,I),L="<"):(I=p.type||"int",C=p.name||this.getVarName(c),x=p.start,S=p.end,L=p.condition,U=p.update,typeof x=="number"?x=e.generateConst(I,x):x&&x.isNode&&(x=x.build(e,I)),typeof S=="number"?S=e.generateConst(I,S):S&&S.isNode&&(S=S.build(e,I)),x!==void 0&&S===void 0?(x=x+" - 1",S="0",L=">="):S!==void 0&&x===void 0&&(x="0",L="<"),L===void 0&&(Number(x)>Number(S)?L=">=":L="<"));let R;if(v)R=`while ( ${S} )`;else{const $={start:x,end:S},Z=$.start,k=$.end;let ie;const ue=()=>L.includes("<")?"+=":"-=";if(U!=null)switch(typeof U){case"function":ie=e.flowStagesNode(t.updateNode,"void").code.replace(/\t|;/g,"");break;case"number":ie=C+" "+ue()+" "+e.generateConst(I,U);break;case"string":ie=C+" "+U;break;default:U.isNode?ie=C+" "+ue()+" "+U.build(e):(console.error("THREE.TSL: 'Loop( { update: ... } )' is not a function, string or number."),ie="break /* invalid update */")}else I==="int"||I==="uint"?U=L.includes("<")?"++":"--":U=ue()+" 1.",ie=C+" "+U;const ce=e.getVar(I,C)+" = "+Z,Q=C+" "+L+" "+k;R=`for ( ${ce}; ${Q}; ${ie} )`}e.addFlowCode((c===0?`
`:"")+e.tab+R+` {

`).addFlowTab()}const i=r.build(e,"void"),a=t.returnsNode?t.returnsNode.build(e):"";e.removeFlowTab().addFlowCode(`
`+e.tab+i);for(let c=0,h=this.params.length-1;c<h;c++)e.addFlowCode((c===0?"":e.tab)+`}

`).removeFlowTab();return e.addFlowTab(),a}}const cf=(...o)=>hn(new EFe(M_(o,"int"))).toStack(),TFe=()=>W_("break").toStack();class FE{constructor(e=new yt(1/0,1/0,1/0),t=new yt(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(Kd.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(Kd.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Kd.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0){const i=n.getAttribute("position");if(t===!0&&i!==void 0&&e.isInstancedMesh!==!0)for(let a=0,c=i.count;a<c;a++)e.isMesh===!0?e.getVertexPosition(a,Kd):Kd.fromBufferAttribute(i,a),Kd.applyMatrix4(e.matrixWorld),this.expandByPoint(Kd);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),PR.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),PR.copy(n.boundingBox)),PR.applyMatrix4(e.matrixWorld),this.union(PR)}const r=e.children;for(let i=0,a=r.length;i<a;i++)this.expandByObject(r[i],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Kd),Kd.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(mw),RR.subVectors(this.max,mw),B7.subVectors(e.a,mw),U7.subVectors(e.b,mw),z7.subVectors(e.c,mw),A3.subVectors(U7,B7),P3.subVectors(z7,U7),z8.subVectors(B7,z7);let t=[0,-A3.z,A3.y,0,-P3.z,P3.y,0,-z8.z,z8.y,A3.z,0,-A3.x,P3.z,0,-P3.x,z8.z,0,-z8.x,-A3.y,A3.x,0,-P3.y,P3.x,0,-z8.y,z8.x,0];return!oV(t,B7,U7,z7,RR)||(t=[1,0,0,0,1,0,0,0,1],!oV(t,B7,U7,z7,RR))?!1:(kR.crossVectors(A3,P3),t=[kR.x,kR.y,kR.z],oV(t,B7,U7,z7,RR))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Kd).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Kd).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(lg[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),lg[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),lg[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),lg[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),lg[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),lg[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),lg[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),lg[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(lg),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}}const lg=[new yt,new yt,new yt,new yt,new yt,new yt,new yt,new yt],Kd=new yt,PR=new FE,B7=new yt,U7=new yt,z7=new yt,A3=new yt,P3=new yt,z8=new yt,mw=new yt,RR=new yt,kR=new yt,V8=new yt;function oV(o,e,t,n,r){for(let i=0,a=o.length-3;i<=a;i+=3){V8.fromArray(o,i);const c=r.x*Math.abs(V8.x)+r.y*Math.abs(V8.y)+r.z*Math.abs(V8.z),h=e.dot(V8),p=t.dot(V8),v=n.dot(V8);if(Math.max(-Math.max(h,p,v),Math.min(h,p,v))>c)return!1}return!0}const MFe=new FE,gw=new yt,aV=new yt;class PI{constructor(e=new yt,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):MFe.setFromPoints(e).getCenter(n);let r=0;for(let i=0,a=e.length;i<a;i++)r=Math.max(r,n.distanceToSquared(e[i]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;gw.subVectors(e,this.center);const t=gw.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),r=(n-this.radius)*.5;this.center.addScaledVector(gw,r/n),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(aV.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(gw.copy(e.center).add(aV)),this.expandByPoint(gw.copy(e.center).sub(aV))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}}const Vme=new PI;class gs extends ti{static get type(){return"Object3DNode"}constructor(e,t=null){super(),this.scope=e,this.object3d=t,this.updateType=vi.OBJECT,this.uniformNode=new OE(null)}getNodeType(){const e=this.scope;if(e===gs.WORLD_MATRIX)return"mat4";if(e===gs.POSITION||e===gs.VIEW_POSITION||e===gs.DIRECTION||e===gs.SCALE)return"vec3";if(e===gs.RADIUS)return"float"}update(e){const t=this.object3d,n=this.uniformNode,r=this.scope;if(r===gs.WORLD_MATRIX)n.value=t.matrixWorld;else if(r===gs.POSITION)n.value=n.value||new yt,n.value.setFromMatrixPosition(t.matrixWorld);else if(r===gs.SCALE)n.value=n.value||new yt,n.value.setFromMatrixScale(t.matrixWorld);else if(r===gs.DIRECTION)n.value=n.value||new yt,t.getWorldDirection(n.value);else if(r===gs.VIEW_POSITION){const i=e.camera;n.value=n.value||new yt,n.value.setFromMatrixPosition(t.matrixWorld),n.value.applyMatrix4(i.matrixWorldInverse)}else if(r===gs.RADIUS){const i=e.object.geometry;i.boundingSphere===null&&i.computeBoundingSphere(),Vme.copy(i.boundingSphere).applyMatrix4(t.matrixWorld),n.value=Vme.radius}}generate(e){const t=this.scope;return t===gs.WORLD_MATRIX?this.uniformNode.nodeType="mat4":t===gs.POSITION||t===gs.VIEW_POSITION||t===gs.DIRECTION||t===gs.SCALE?this.uniformNode.nodeType="vec3":t===gs.RADIUS&&(this.uniformNode.nodeType="float"),this.uniformNode.build(e)}serialize(e){super.serialize(e),e.scope=this.scope}deserialize(e){super.deserialize(e),this.scope=e.scope}}gs.WORLD_MATRIX="worldMatrix";gs.POSITION="position";gs.SCALE="scale";gs.VIEW_POSITION="viewPosition";gs.DIRECTION="direction";gs.RADIUS="radius";const CFe=un(gs,gs.POSITION).setParameterLength(1);class b4e extends OE{static get type(){return"BufferNode"}constructor(e,t,n=0){super(e,t),this.isBufferNode=!0,this.bufferType=t,this.bufferCount=n}getElementType(e){return this.getNodeType(e)}getInputType(){return"buffer"}}const S4e=(o,e,t)=>hn(new b4e(o,e,t));class AFe extends DE{static get type(){return"UniformArrayElementNode"}constructor(e,t){super(e,t),this.isArrayBufferElementNode=!0}generate(e){const t=super.generate(e),n=this.getNodeType(),r=this.node.getPaddedType();return e.format(t,r,n)}}class PFe extends b4e{static get type(){return"UniformArrayNode"}constructor(e,t=null){super(null),this.array=e,this.elementType=t===null?rI(e[0]):t,this.paddedType=this.getPaddedType(),this.updateType=vi.RENDER,this.isArrayBufferNode=!0}getNodeType(){return this.paddedType}getElementType(){return this.elementType}getPaddedType(){const e=this.elementType;let t="vec4";return e==="mat2"?t="mat2":/mat/.test(e)===!0?t="mat4":e.charAt(0)==="i"?t="ivec4":e.charAt(0)==="u"&&(t="uvec4"),t}update(){const{array:e,value:t}=this,n=this.elementType;if(n==="float"||n==="int"||n==="uint")for(let r=0;r<e.length;r++){const i=r*4;t[i]=e[r]}else if(n==="color")for(let r=0;r<e.length;r++){const i=r*4,a=e[r];t[i]=a.r,t[i+1]=a.g,t[i+2]=a.b||0}else if(n==="mat2")for(let r=0;r<e.length;r++){const i=r*4,a=e[r];t[i]=a.elements[0],t[i+1]=a.elements[1],t[i+2]=a.elements[2],t[i+3]=a.elements[3]}else if(n==="mat3")for(let r=0;r<e.length;r++){const i=r*16,a=e[r];t[i]=a.elements[0],t[i+1]=a.elements[1],t[i+2]=a.elements[2],t[i+4]=a.elements[3],t[i+5]=a.elements[4],t[i+6]=a.elements[5],t[i+8]=a.elements[6],t[i+9]=a.elements[7],t[i+10]=a.elements[8],t[i+15]=1}else if(n==="mat4")for(let r=0;r<e.length;r++){const i=r*16,a=e[r];for(let c=0;c<a.elements.length;c++)t[i+c]=a.elements[c]}else for(let r=0;r<e.length;r++){const i=r*4,a=e[r];t[i]=a.x,t[i+1]=a.y,t[i+2]=a.z||0,t[i+3]=a.w||0}}setup(e){const t=this.array.length,n=this.elementType;let r=Float32Array;const i=this.paddedType,a=e.getTypeLength(i);return n.charAt(0)==="i"&&(r=Int32Array),n.charAt(0)==="u"&&(r=Uint32Array),this.value=new r(t*a),this.bufferCount=t,this.bufferType=i,super.setup(e)}element(e){return hn(new AFe(this,hn(e)))}}const Kp=(o,e)=>hn(new PFe(o,e));class RFe extends ti{constructor(e){super("float"),this.name=e,this.isBuiltinNode=!0}generate(){return this.name}}const RI=un(RFe).setParameterLength(1),w4e=Gr(0,"uint").label("u_cameraIndex").setGroup(mW("cameraIndex")).toVarying("v_cameraIndex"),o6=Gr("float").label("cameraNear").setGroup(Vr).onRenderUpdate(({camera:o})=>o.near),a6=Gr("float").label("cameraFar").setGroup(Vr).onRenderUpdate(({camera:o})=>o.far),AW=cn(({camera:o})=>{let e;if(o.isArrayCamera&&o.cameras.length>0){const t=[];for(const r of o.cameras)t.push(r.projectionMatrix);e=Kp(t).setGroup(Vr).label("cameraProjectionMatrices").element(o.isMultiViewCamera?RI("gl_ViewID_OVR"):w4e).toVar("cameraProjectionMatrix")}else e=Gr("mat4").label("cameraProjectionMatrix").setGroup(Vr).onRenderUpdate(({camera:t})=>t.projectionMatrix);return e}).once()(),Lg=cn(({camera:o})=>{let e;if(o.isArrayCamera&&o.cameras.length>0){const t=[];for(const r of o.cameras)t.push(r.matrixWorldInverse);e=Kp(t).setGroup(Vr).label("cameraViewMatrices").element(o.isMultiViewCamera?RI("gl_ViewID_OVR"):w4e).toVar("cameraViewMatrix")}else e=Gr("mat4").label("cameraViewMatrix").setGroup(Vr).onRenderUpdate(({camera:t})=>t.matrixWorldInverse);return e}).once()(),kFe=Gr(new yt).label("cameraPosition").setGroup(Vr).onRenderUpdate(({camera:o},e)=>e.value.setFromMatrixPosition(o.matrixWorld));class Ih extends gs{static get type(){return"ModelNode"}constructor(e){super(e)}update(e){this.object3d=e.object,super.update(e)}}Ih.DIRECTION;const E6=kn(Ih,Ih.WORLD_MATRIX);Ih.POSITION;Ih.SCALE;Ih.VIEW_POSITION;Ih.RADIUS;const IFe=Gr(new Mc).onObjectUpdate(({object:o},e)=>e.value.getNormalMatrix(o.matrixWorld)),kI=cn(o=>o.renderer.overrideNodes.modelViewMatrix||NFe).once()().toVar("modelViewMatrix"),NFe=Lg.mul(E6),Gme=cn(o=>(o.context.isHighPrecisionModelViewMatrix=!0,Gr("mat4").onObjectUpdate(({object:e,camera:t})=>e.modelViewMatrix.multiplyMatrices(t.matrixWorldInverse,e.matrixWorld)))).once()().toVar("highpModelViewMatrix"),jme=cn(o=>{const e=o.context.isHighPrecisionModelViewMatrix;return Gr("mat3").onObjectUpdate(({object:t,camera:n})=>(e!==!0&&t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix)))}).once()().toVar("highpModelNormalViewMatrix"),II=Q3("position","vec3"),z0=II.toVarying("positionLocal"),Hme=II.toVarying("positionPrevious"),PE=cn(o=>E6.mul(z0).xyz.toVarying(o.getNamespace("v_positionWorld")),"vec3").once("POSITION")(),E4e=cn(o=>z0.transformDirection(E6).toVarying(o.getNamespace("v_positionWorldDirection")).normalize().toVar("positionWorldDirection"),"vec3").once("POSITION")(),ia=cn(o=>o.context.setupPositionView().toVarying(o.getNamespace("v_positionView")),"vec3").once("POSITION")(),_o=ia.negate().toVarying("v_positionViewDirection").normalize().toVar("positionViewDirection");class DFe extends oa{static get type(){return"EquirectUVNode"}constructor(e=E4e){super("vec2"),this.dirNode=e}setup(){const e=this.dirNode,t=e.z.atan(e.x).mul(1/(Math.PI*2)).add(.5),n=e.y.clamp(-1,1).asin().mul(1/Math.PI).add(.5);return In(t,n)}}const T4e=un(DFe).setParameterLength(0,1);class OFe extends ti{static get type(){return"FrontFacingNode"}constructor(){super("bool"),this.isFrontFacingNode=!0}generate(e){const{renderer:t,material:n}=e;return t.coordinateSystem===bc&&n.side===Ec?"false":e.getFrontFacing()}}const FFe=kn(OFe),NI=$t(FFe).mul(2).sub(1),M4e=Q3("normal","vec3"),i1=cn(o=>o.geometry.hasAttribute("normal")===!1?(console.warn('THREE.TSL: Vertex attribute "normal" not found on geometry.'),Yt(0,1,0)):M4e,"vec3").once()().toVar("normalLocal"),LFe=ia.dFdx().cross(ia.dFdy()).normalize().toVar("normalFlat"),s1=cn(o=>{let e;return o.material.flatShading===!0?e=LFe:e=xf(C4e(i1),"v_normalView").normalize(),e},"vec3").once()().toVar("normalView"),PW=cn(o=>{let e=s1.transformDirection(Lg);return o.material.flatShading!==!0&&(e=xf(e,"v_normalWorld")),e},"vec3").once()().normalize().toVar("normalWorld"),ra=cn(o=>{let e=o.context.setupNormal().context({getUV:null});return o.material.flatShading!==!0&&(e=e.mul(NI)),e},"vec3").once()().toVar("transformedNormalView"),RW=ra.transformDirection(Lg).toVar("transformedNormalWorld"),Hw=cn(o=>{let e=o.context.setupClearcoatNormal().context({getUV:null});return o.material.flatShading!==!0&&(e=e.mul(NI)),e},"vec3").once()().toVar("transformedClearcoatNormalView"),BFe=cn(([o,e=E6])=>{const t=Dl(e),n=o.div(Yt(t[0].dot(t[0]),t[1].dot(t[1]),t[2].dot(t[2])));return t.mul(n).xyz}),C4e=cn(([o],e)=>{const t=e.renderer.overrideNodes.modelNormalViewMatrix;if(t!==null)return t.transformDirection(o);const n=IFe.mul(o);return Lg.transformDirection(n)});class UFe extends oa{static get type(){return"MatcapUVNode"}constructor(){super("vec2")}setup(){const e=Yt(_o.z,0,_o.x.negate()).normalize(),t=_o.cross(e);return In(e.dot(ra),t.dot(ra)).mul(.495).add(.5)}}const zFe=kn(UFe);class VFe extends OE{static get type(){return"MaxMipLevelNode"}constructor(e){super(0),this._textureNode=e,this.updateType=vi.FRAME}get textureNode(){return this._textureNode}get texture(){return this._textureNode.value}update(){const e=this.texture,t=e.images,n=t&&t.length>0?t[0]&&t[0].image||t[0]:e.image;if(n&&n.width!==void 0){const{width:r,height:i}=n;this.value=Math.log2(Math.max(r,i))}}}const GFe=un(VFe).setParameterLength(1),jFe=o=>hn(o).mul(.5).add(.5);class HFe extends oa{static get type(){return"RotateNode"}constructor(e,t){super(),this.positionNode=e,this.rotationNode=t}getNodeType(e){return this.positionNode.getNodeType(e)}setup(e){const{rotationNode:t,positionNode:n}=this;if(this.getNodeType(e)==="vec2"){const i=t.cos(),a=t.sin();return pW(i,a,a.negate(),i).mul(n)}else{const i=t,a=C_(ei(1,0,0,0),ei(0,U3(i.x),af(i.x).negate(),0),ei(0,af(i.x),U3(i.x),0),ei(0,0,0,1)),c=C_(ei(U3(i.y),0,af(i.y),0),ei(0,1,0,0),ei(af(i.y).negate(),0,U3(i.y),0),ei(0,0,0,1)),h=C_(ei(U3(i.z),af(i.z).negate(),0,0),ei(af(i.z),U3(i.z),0,0),ei(0,0,1,0),ei(0,0,0,1));return a.mul(c).mul(h).mul(ei(n,1)).xyz}}}const A4e=un(HFe).setParameterLength(2);let yw,vw;class ta extends ti{static get type(){return"ScreenNode"}constructor(e){super(),this.scope=e,this.isViewportNode=!0}getNodeType(){return this.scope===ta.VIEWPORT?"vec4":"vec2"}getUpdateType(){let e=vi.NONE;return(this.scope===ta.SIZE||this.scope===ta.VIEWPORT)&&(e=vi.RENDER),this.updateType=e,e}update({renderer:e}){const t=e.getRenderTarget();this.scope===ta.VIEWPORT?t!==null?vw.copy(t.viewport):(e.getViewport(vw),vw.multiplyScalar(e.getPixelRatio())):t!==null?(yw.width=t.width,yw.height=t.height):e.getDrawingBufferSize(yw)}setup(){const e=this.scope;let t=null;return e===ta.SIZE?t=Gr(yw||(yw=new pi)):e===ta.VIEWPORT?t=Gr(vw||(vw=new Ri)):t=In(DI.div(qj)),t}generate(e){if(this.scope===ta.COORDINATE){let t=e.getFragCoord();if(e.isFlipY()){const n=e.getNodeProperties(qj).outputNode.build(e);t=`${e.getType("vec2")}( ${t}.x, ${n}.y - ${t}.y )`}return t}return super.generate(e)}}ta.COORDINATE="coordinate";ta.VIEWPORT="viewport";ta.SIZE="size";ta.UV="uv";const P_=kn(ta,ta.UV),qj=kn(ta,ta.SIZE),DI=kn(ta,ta.COORDINATE),aE=kn(ta,ta.VIEWPORT);aE.zw;aE.xy;const LE=(o=0)=>Q3("uv"+(o>0?o:""),"vec2");class WFe extends ti{static get type(){return"TextureSizeNode"}constructor(e,t=null){super("uvec2"),this.isTextureSizeNode=!0,this.textureNode=e,this.levelNode=t}generate(e,t){const n=this.textureNode.build(e,"property"),r=this.levelNode===null?"0":this.levelNode.build(e,"int");return e.format(`${e.getMethod("textureDimensions")}( ${n}, ${r} )`,this.getNodeType(e),t)}}const R_=un(WFe).setParameterLength(1,2),P4e=new j0;class ix extends OE{static get type(){return"TextureNode"}constructor(e=P4e,t=null,n=null,r=null){super(e),this.isTextureNode=!0,this.uvNode=t,this.levelNode=n,this.biasNode=r,this.compareNode=null,this.depthNode=null,this.gradNode=null,this.sampler=!0,this.updateMatrix=!1,this.updateType=vi.NONE,this.referenceNode=null,this._value=e,this._matrixUniform=null,this.setUpdateMatrix(t===null)}set value(e){this.referenceNode?this.referenceNode.value=e:this._value=e}get value(){return this.referenceNode?this.referenceNode.value:this._value}getUniformHash(){return this.value.uuid}getNodeType(){return this.value.isDepthTexture===!0?"float":this.value.type===Ho?"uvec4":this.value.type===Pl?"ivec4":"vec4"}getInputType(){return"texture"}getDefaultUV(){return LE(this.value.channel)}updateReference(){return this.value}getTransformedUV(e){return this._matrixUniform===null&&(this._matrixUniform=Gr(this.value.matrix)),this._matrixUniform.mul(Yt(e,1)).xy}setUpdateMatrix(e){return this.updateMatrix=e,this.updateType=e?vi.OBJECT:vi.NONE,this}setupUV(e,t){const n=this.value;return e.isFlipY()&&(n.image instanceof ImageBitmap&&n.flipY===!0||n.isRenderTargetTexture===!0||n.isFramebufferTexture===!0||n.isDepthTexture===!0)&&(this.sampler?t=t.flipY():t=t.setY(Fs(R_(this,this.levelNode).y).sub(t.y).sub(1))),t}setup(e){const t=e.getNodeProperties(this);t.referenceNode=this.referenceNode;const n=this.value;if(!n||n.isTexture!==!0)throw new Error("THREE.TSL: `texture( value )` function expects a valid instance of THREE.Texture().");let r=this.uvNode;(r===null||e.context.forceUVContext===!0)&&e.context.getUV&&(r=e.context.getUV(this,e)),r||(r=this.getDefaultUV()),this.updateMatrix===!0&&(r=this.getTransformedUV(r)),r=this.setupUV(e,r);let i=this.levelNode;i===null&&e.context.getTextureLevel&&(i=e.context.getTextureLevel(this)),t.uvNode=r,t.levelNode=i,t.biasNode=this.biasNode,t.compareNode=this.compareNode,t.gradNode=this.gradNode,t.depthNode=this.depthNode}generateUV(e,t){return t.build(e,this.sampler===!0?"vec2":"ivec2")}generateSnippet(e,t,n,r,i,a,c,h){const p=this.value;let v;return r?v=e.generateTextureLevel(p,t,n,r,a):i?v=e.generateTextureBias(p,t,n,i,a):h?v=e.generateTextureGrad(p,t,n,h,a):c?v=e.generateTextureCompare(p,t,n,c,a):this.sampler===!1?v=e.generateTextureLoad(p,t,n,a):v=e.generateTexture(p,t,n,a),v}generate(e,t){const n=this.value,r=e.getNodeProperties(this),i=super.generate(e,"property");if(/^sampler/.test(t))return i+"_sampler";if(e.isReference(t))return i;{const a=e.getDataFromNode(this);let c=a.propertyName;if(c===void 0){const{uvNode:v,levelNode:x,biasNode:S,compareNode:C,depthNode:I,gradNode:L}=r,U=this.generateUV(e,v),R=x?x.build(e,"float"):null,$=S?S.build(e,"float"):null,Z=I?I.build(e,"int"):null,k=C?C.build(e,"float"):null,ie=L?[L[0].build(e,"vec2"),L[1].build(e,"vec2")]:null,ue=e.getVarFromNode(this);c=e.getPropertyName(ue);const ce=this.generateSnippet(e,i,U,R,$,Z,k,ie);e.addLineFlowCode(`${c} = ${ce}`,this),a.snippet=ce,a.propertyName=c}let h=c;const p=this.getNodeType(e);return e.needsToWorkingColorSpace(n)&&(h=EW(W_(h,p),n.colorSpace).setup(e).build(e,p)),e.format(h,p,t)}}setSampler(e){return this.sampler=e,this}getSampler(){return this.sampler}uv(e){return console.warn("THREE.TextureNode: .uv() has been renamed. Use .sample() instead."),this.sample(e)}sample(e){const t=this.clone();return t.uvNode=hn(e),t.referenceNode=this.getSelf(),hn(t)}blur(e){const t=this.clone();t.biasNode=hn(e).mul(GFe(t)),t.referenceNode=this.getSelf();const n=t.value;return t.generateMipmaps===!1&&(n&&n.generateMipmaps===!1||n.minFilter===ya||n.magFilter===ya)&&(console.warn("THREE.TSL: texture().blur() requires mipmaps and sampling. Use .generateMipmaps=true and .minFilter/.magFilter=THREE.LinearFilter in the Texture."),t.biasNode=null),hn(t)}level(e){const t=this.clone();return t.levelNode=hn(e),t.referenceNode=this.getSelf(),hn(t)}size(e){return R_(this,e)}bias(e){const t=this.clone();return t.biasNode=hn(e),t.referenceNode=this.getSelf(),hn(t)}compare(e){const t=this.clone();return t.compareNode=hn(e),t.referenceNode=this.getSelf(),hn(t)}grad(e,t){const n=this.clone();return n.gradNode=[hn(e),hn(t)],n.referenceNode=this.getSelf(),hn(n)}depth(e){const t=this.clone();return t.depthNode=hn(e),t.referenceNode=this.getSelf(),hn(t)}serialize(e){super.serialize(e),e.value=this.value.toJSON(e.meta).uuid,e.sampler=this.sampler,e.updateMatrix=this.updateMatrix,e.updateType=this.updateType}deserialize(e){super.deserialize(e),this.value=e.meta.textures[e.value],this.sampler=e.sampler,this.updateMatrix=e.updateMatrix,this.updateType=e.updateType}update(){const e=this.value,t=this._matrixUniform;t!==null&&(t.value=e.matrix),e.matrixAutoUpdate===!0&&e.updateMatrix()}clone(){const e=new this.constructor(this.value,this.uvNode,this.levelNode,this.biasNode);return e.sampler=this.sampler,e.depthNode=this.depthNode,e.compareNode=this.compareNode,e.gradNode=this.gradNode,e}}const $Fe=un(ix).setParameterLength(1,4).setName("texture"),Vi=(o=P4e,e=null,t=null,n=null)=>{let r;return o&&o.isTextureNode===!0?(r=hn(o.clone()),r.referenceNode=o.getSelf(),e!==null&&(r.uvNode=hn(e)),t!==null&&(r.levelNode=hn(t)),n!==null&&(r.biasNode=hn(n))):r=$Fe(o,e,t,n),r},tf=(...o)=>Vi(...o).setSampler(!1);class qFe extends j0{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=ya,this.minFilter=ya,this.generateMipmaps=!1,this.needsUpdate=!0}}const _w=new pi;class R4e extends ix{static get type(){return"ViewportTextureNode"}constructor(e=P_,t=null,n=null){n===null&&(n=new qFe,n.minFilter=Tg),super(n,e,t),this.generateMipmaps=!1,this.isOutputTextureNode=!0,this.updateBeforeType=vi.FRAME}updateBefore(e){const t=e.renderer;t.getDrawingBufferSize(_w);const n=this.value;(n.image.width!==_w.width||n.image.height!==_w.height)&&(n.image.width=_w.width,n.image.height=_w.height,n.needsUpdate=!0);const r=n.generateMipmaps;n.generateMipmaps=this.generateMipmaps,t.copyFramebufferToTexture(n),n.generateMipmaps=r}clone(){const e=new this.constructor(this.uvNode,this.levelNode,this.value);return e.generateMipmaps=this.generateMipmaps,e}}const k4e=un(R4e,null,null,{generateMipmaps:!0}).setParameterLength(0,3);let lV=null;class XFe extends R4e{static get type(){return"ViewportDepthTextureNode"}constructor(e=P_,t=null){lV===null&&(lV=new t1),super(e,t,lV)}}const YFe=un(XFe).setParameterLength(0,2);class Sc extends ti{static get type(){return"ViewportDepthNode"}constructor(e,t=null){super("float"),this.scope=e,this.valueNode=t,this.isViewportDepthNode=!0}generate(e){const{scope:t}=this;return t===Sc.DEPTH_BASE?e.getFragDepth():super.generate(e)}setup({camera:e}){const{scope:t}=this,n=this.valueNode;let r=null;if(t===Sc.DEPTH_BASE)n!==null&&(r=D4e().assign(n));else if(t===Sc.DEPTH)e.isPerspectiveCamera?r=KFe(ia.z,o6,a6):r=lE(ia.z,o6,a6);else if(t===Sc.LINEAR_DEPTH)if(n!==null)if(e.isPerspectiveCamera){const i=I4e(n,o6,a6);r=lE(i,o6,a6)}else r=n;else r=lE(ia.z,o6,a6);return r}}Sc.DEPTH_BASE="depthBase";Sc.DEPTH="depth";Sc.LINEAR_DEPTH="linearDepth";const lE=(o,e,t)=>o.add(e).div(e.sub(t)),KFe=(o,e,t)=>e.add(o).mul(t).div(t.sub(e).mul(o)),I4e=(o,e,t)=>e.mul(t).div(t.sub(e).mul(o).sub(t)),N4e=(o,e,t)=>{e=e.max(1e-6).toVar();const n=Ag(o.negate().div(e)),r=Ag(t.div(e));return n.div(r)},D4e=un(Sc,Sc.DEPTH_BASE),O4e=kn(Sc,Sc.DEPTH),ZFe=un(Sc,Sc.LINEAR_DEPTH).setParameterLength(0,1);YFe();O4e.assign=o=>D4e(o);const cV=new yt,QFe=new yt,JFe=new Mc;class z3{constructor(e=new yt(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const r=cV.subVectors(n,t).cross(QFe.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(cV),r=this.normal.dot(n);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const i=-(e.start.dot(this.normal)+this.constant)/r;return i<0||i>1?null:t.copy(e.start).addScaledVector(n,i)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||JFe.getNormalMatrix(e),r=this.coplanarPoint(cV).applyMatrix4(e),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}class C6 extends M6{constructor(e=1,t=1,n={}){super(),n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Eu,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},n),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=n.depth,this.scissor=new Ri(0,0,e,t),this.scissorTest=!1,this.viewport=new Ri(0,0,e,t);const r={width:e,height:t,depth:n.depth},i=new j0(r);this.textures=[];const a=n.count;for(let c=0;c<a;c++)this.textures[c]=i.clone(),this.textures[c].isRenderTargetTexture=!0,this.textures[c].renderTarget=this;this._setTextureOptions(n),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=n.depthTexture,this.samples=n.samples,this.multiview=n.multiview}_setTextureOptions(e={}){const t={minFilter:Eu,generateMipmaps:!1,flipY:!1,internalFormat:null};e.mapping!==void 0&&(t.mapping=e.mapping),e.wrapS!==void 0&&(t.wrapS=e.wrapS),e.wrapT!==void 0&&(t.wrapT=e.wrapT),e.wrapR!==void 0&&(t.wrapR=e.wrapR),e.magFilter!==void 0&&(t.magFilter=e.magFilter),e.minFilter!==void 0&&(t.minFilter=e.minFilter),e.format!==void 0&&(t.format=e.format),e.type!==void 0&&(t.type=e.type),e.anisotropy!==void 0&&(t.anisotropy=e.anisotropy),e.colorSpace!==void 0&&(t.colorSpace=e.colorSpace),e.flipY!==void 0&&(t.flipY=e.flipY),e.generateMipmaps!==void 0&&(t.generateMipmaps=e.generateMipmaps),e.internalFormat!==void 0&&(t.internalFormat=e.internalFormat);for(let n=0;n<this.textures.length;n++)this.textures[n].setValues(t)}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,i=this.textures.length;r<i;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=n,this.textures[r].isArrayTexture=this.textures[r].image.depth>1;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,n=e.textures.length;t<n;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const r=Object.assign({},e.textures[t].image);this.textures[t].source=new aW(r)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}new z3;new yt;new yt;new yt;new Ts;new yt(0,0,-1);new Ri;new yt;new yt;new Ri;new pi;const eLe=new C6;P_.flipX();eLe.depthTexture=new t1(1,1);let tLe=0;class Tc extends M6{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:tLe++}),this.uuid=Sg(),this.name="",this.type="Material",this.blending=Eg,this.side=wg,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=Yk,this.blendDst=Kk,this.blendEquation=lf,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new qi(0,0,0),this.blendAlpha=0,this.depthFunc=Zk,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=zj,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=e6,this.stencilZFail=e6,this.stencilZPass=e6,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Eg&&(n.blending=this.blending),this.side!==wg&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==Yk&&(n.blendSrc=this.blendSrc),this.blendDst!==Kk&&(n.blendDst=this.blendDst),this.blendEquation!==lf&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==Zk&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==zj&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==e6&&(n.stencilFail=this.stencilFail),this.stencilZFail!==e6&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==e6&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function r(i){const a=[];for(const c in i){const h=i[c];delete h.metadata,a.push(h)}return a}if(t){const i=r(e.textures),a=r(e.images);i.length>0&&(n.textures=i),a.length>0&&(n.images=a)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const r=t.length;n=new Array(r);for(let i=0;i!==r;++i)n[i]=t[i].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}const Wme=new kh,uV=new Ts,nLe=Gr(0).onReference(({material:o})=>o).onObjectUpdate(({material:o})=>o.refractionRatio),hV=Gr(1).onReference(({material:o})=>o).onObjectUpdate(function({material:o,scene:e}){return o.envMap?o.envMapIntensity:e.environmentIntensity}),F4e=Gr(new Ts).onReference(function(o){return o.material}).onObjectUpdate(function({material:o,scene:e}){const t=e.environment!==null&&o.envMap===null?e.environmentRotation:o.envMapRotation;return t?(Wme.copy(t),uV.makeRotationFromEuler(Wme)):uV.identity(),uV}),rLe=_o.negate().reflect(ra),iLe=_o.negate().refract(ra,nLe),sLe=rLe.transformDirection(Lg).toVar("reflectVector"),oLe=iLe.transformDirection(Lg).toVar("reflectVector");class OI extends j0{constructor(e=[],t=EE,n,r,i,a,c,h,p,v){super(e,t,n,r,i,a,c,h,p,v),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}const aLe=new OI;class lLe extends ix{static get type(){return"CubeTextureNode"}constructor(e,t=null,n=null,r=null){super(e,t,n,r),this.isCubeTextureNode=!0}getInputType(){return"cubeTexture"}getDefaultUV(){const e=this.value;return e.mapping===EE?sLe:e.mapping===Qk?oLe:(console.error('THREE.CubeTextureNode: Mapping "%s" not supported.',e.mapping),Yt(0,0,0))}setUpdateMatrix(){}setupUV(e,t){const n=this.value;return(e.renderer.coordinateSystem===K3||!n.isRenderTargetTexture)&&(t=Yt(t.x.negate(),t.yz)),F4e.mul(t)}generateUV(e,t){return t.build(e,"vec3")}}const cLe=un(lLe).setParameterLength(1,4).setName("cubeTexture"),RE=(o=aLe,e=null,t=null,n=null)=>{let r;return o&&o.isCubeTextureNode===!0?(r=hn(o.clone()),r.referenceNode=o.getSelf(),e!==null&&(r.uvNode=hn(e)),t!==null&&(r.levelNode=hn(t)),n!==null&&(r.biasNode=hn(n))):r=cLe(o,e,t,n),r};class uLe extends DE{static get type(){return"ReferenceElementNode"}constructor(e,t){super(e,t),this.referenceNode=e,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(e){const t=super.generate(e),n=this.referenceNode.getNodeType(),r=this.getNodeType();return e.format(t,n,r)}}class kW extends ti{static get type(){return"ReferenceNode"}constructor(e,t,n=null,r=null){super(),this.property=e,this.uniformType=t,this.object=n,this.count=r,this.properties=e.split("."),this.reference=n,this.node=null,this.group=null,this.name=null,this.updateType=vi.OBJECT}element(e){return hn(new uLe(this,hn(e)))}setGroup(e){return this.group=e,this}label(e){return this.name=e,this}setNodeType(e){let t=null;this.count!==null?t=S4e(null,e,this.count):Array.isArray(this.getValueFromReference())?t=Kp(null,e):e==="texture"?t=Vi(null):e==="cubeTexture"?t=RE(null):t=Gr(null,e),this.group!==null&&t.setGroup(this.group),this.name!==null&&t.label(this.name),this.node=t.getSelf()}getNodeType(e){return this.node===null&&(this.updateReference(e),this.updateValue()),this.node.getNodeType(e)}getValueFromReference(e=this.reference){const{properties:t}=this;let n=e[t[0]];for(let r=1;r<t.length;r++)n=n[t[r]];return n}updateReference(e){return this.reference=this.object!==null?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){this.node===null&&this.setNodeType(this.uniformType);const e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}const Es=(o,e,t)=>hn(new kW(o,e,t)),$me=(o,e,t,n)=>hn(new kW(o,e,n,t));class hLe extends kW{static get type(){return"MaterialReferenceNode"}constructor(e,t,n=null){super(e,t,n),this.material=n,this.isMaterialReferenceNode=!0}updateReference(e){return this.reference=this.material!==null?this.material:e.material,this.reference}}const j3=(o,e,t=null)=>hn(new hLe(o,e,t)),L4e=cn(o=>(o.geometry.hasAttribute("tangent")===!1&&o.geometry.computeTangents(),Q3("tangent","vec4")))(),IW=L4e.xyz.toVar("tangentLocal"),B4e=kI.mul(ei(IW,0)).xyz.toVarying("v_tangentView").normalize().toVar("tangentView"),dLe=cn(([o,e],t)=>{let n=o.mul(L4e.w).xyz;return t.material.flatShading!==!0&&(n=xf(n,e)),n}).once(),fLe=dLe(s1.cross(B4e),"v_bitangentView").normalize().toVar("bitangentView"),Ww=Dl(B4e,fLe,s1),pLe=(()=>{let o=A_.cross(_o);return o=o.cross(A_).normalize(),o=Zs(o,ra,t6.mul(vg.oneMinus()).oneMinus().pow2().pow2()).normalize(),o})(),mLe=cn(o=>{const{eye_pos:e,surf_norm:t,mapN:n,uv:r}=o,i=e.dFdx(),a=e.dFdy(),c=r.dFdx(),h=r.dFdy(),p=t,v=a.cross(p),x=p.cross(i),S=v.mul(c.x).add(x.mul(h.x)),C=v.mul(c.y).add(x.mul(h.y)),I=S.dot(S).max(C.dot(C)),L=NI.mul(I.inverseSqrt());return Ol(S.mul(n.x,L),C.mul(n.y,L),p.mul(n.z)).normalize()});class gLe extends oa{static get type(){return"NormalMapNode"}constructor(e,t=null){super("vec3"),this.node=e,this.scaleNode=t,this.normalMapType=Y3}setup(e){const{normalMapType:t,scaleNode:n}=this;let r=this.node.mul(2).sub(1);n!==null&&(r=Yt(r.xy.mul(n),r.z));let i=null;return t===JIe?i=C4e(r):t===Y3&&(e.hasGeometryAttribute("tangent")===!0?i=Ww.mul(r).normalize():i=mLe({eye_pos:ia,surf_norm:s1,mapN:r,uv:LE()})),i}}const qme=un(gLe).setParameterLength(1,2),yLe=cn(({textureNode:o,bumpScale:e})=>{const t=r=>o.cache().context({getUV:i=>r(i.uvNode||LE()),forceUVContext:!0}),n=$t(t(r=>r));return In($t(t(r=>r.add(r.dFdx()))).sub(n),$t(t(r=>r.add(r.dFdy()))).sub(n)).mul(e)}),vLe=cn(o=>{const{surf_pos:e,surf_norm:t,dHdxy:n}=o,r=e.dFdx().normalize(),i=e.dFdy().normalize(),a=t,c=i.cross(a),h=a.cross(r),p=r.dot(c).mul(NI),v=p.sign().mul(n.x.mul(c).add(n.y.mul(h)));return p.abs().mul(t).sub(v).normalize()});class _Le extends oa{static get type(){return"BumpMapNode"}constructor(e,t=null){super("vec3"),this.textureNode=e,this.scaleNode=t}setup(){const e=this.scaleNode!==null?this.scaleNode:1,t=yLe({textureNode:this.textureNode,bumpScale:e});return vLe({surf_pos:ia,surf_norm:s1,dHdxy:t})}}const xLe=un(_Le).setParameterLength(1,2),Xme=new Map;class Gt extends ti{static get type(){return"MaterialNode"}constructor(e){super(),this.scope=e}getCache(e,t){let n=Xme.get(e);return n===void 0&&(n=j3(e,t),Xme.set(e,n)),n}getFloat(e){return this.getCache(e,"float")}getColor(e){return this.getCache(e,"color")}getTexture(e){return this.getCache(e==="map"?"map":e+"Map","texture")}setup(e){const t=e.context.material,n=this.scope;let r=null;if(n===Gt.COLOR){const i=t.color!==void 0?this.getColor(n):Yt();t.map&&t.map.isTexture===!0?r=i.mul(this.getTexture("map")):r=i}else if(n===Gt.OPACITY){const i=this.getFloat(n);t.alphaMap&&t.alphaMap.isTexture===!0?r=i.mul(this.getTexture("alpha")):r=i}else if(n===Gt.SPECULAR_STRENGTH)t.specularMap&&t.specularMap.isTexture===!0?r=this.getTexture("specular").r:r=$t(1);else if(n===Gt.SPECULAR_INTENSITY){const i=this.getFloat(n);t.specularIntensityMap&&t.specularIntensityMap.isTexture===!0?r=i.mul(this.getTexture(n).a):r=i}else if(n===Gt.SPECULAR_COLOR){const i=this.getColor(n);t.specularColorMap&&t.specularColorMap.isTexture===!0?r=i.mul(this.getTexture(n).rgb):r=i}else if(n===Gt.ROUGHNESS){const i=this.getFloat(n);t.roughnessMap&&t.roughnessMap.isTexture===!0?r=i.mul(this.getTexture(n).g):r=i}else if(n===Gt.METALNESS){const i=this.getFloat(n);t.metalnessMap&&t.metalnessMap.isTexture===!0?r=i.mul(this.getTexture(n).b):r=i}else if(n===Gt.EMISSIVE){const i=this.getFloat("emissiveIntensity"),a=this.getColor(n).mul(i);t.emissiveMap&&t.emissiveMap.isTexture===!0?r=a.mul(this.getTexture(n)):r=a}else if(n===Gt.NORMAL)t.normalMap?(r=qme(this.getTexture("normal"),this.getCache("normalScale","vec2")),r.normalMapType=t.normalMapType):t.bumpMap?r=xLe(this.getTexture("bump").r,this.getFloat("bumpScale")):r=s1;else if(n===Gt.CLEARCOAT){const i=this.getFloat(n);t.clearcoatMap&&t.clearcoatMap.isTexture===!0?r=i.mul(this.getTexture(n).r):r=i}else if(n===Gt.CLEARCOAT_ROUGHNESS){const i=this.getFloat(n);t.clearcoatRoughnessMap&&t.clearcoatRoughnessMap.isTexture===!0?r=i.mul(this.getTexture(n).r):r=i}else if(n===Gt.CLEARCOAT_NORMAL)t.clearcoatNormalMap?r=qme(this.getTexture(n),this.getCache(n+"Scale","vec2")):r=s1;else if(n===Gt.SHEEN){const i=this.getColor("sheenColor").mul(this.getFloat("sheen"));t.sheenColorMap&&t.sheenColorMap.isTexture===!0?r=i.mul(this.getTexture("sheenColor").rgb):r=i}else if(n===Gt.SHEEN_ROUGHNESS){const i=this.getFloat(n);t.sheenRoughnessMap&&t.sheenRoughnessMap.isTexture===!0?r=i.mul(this.getTexture(n).a):r=i,r=r.clamp(.07,1)}else if(n===Gt.ANISOTROPY)if(t.anisotropyMap&&t.anisotropyMap.isTexture===!0){const i=this.getTexture(n);r=pW(xw.x,xw.y,xw.y.negate(),xw.x).mul(i.rg.mul(2).sub(In(1)).normalize().mul(i.b))}else r=xw;else if(n===Gt.IRIDESCENCE_THICKNESS){const i=Es("1","float",t.iridescenceThicknessRange);if(t.iridescenceThicknessMap){const a=Es("0","float",t.iridescenceThicknessRange);r=i.sub(a).mul(this.getTexture(n).g).add(a)}else r=i}else if(n===Gt.TRANSMISSION){const i=this.getFloat(n);t.transmissionMap?r=i.mul(this.getTexture(n).r):r=i}else if(n===Gt.THICKNESS){const i=this.getFloat(n);t.thicknessMap?r=i.mul(this.getTexture(n).g):r=i}else if(n===Gt.IOR)r=this.getFloat(n);else if(n===Gt.LIGHT_MAP)r=this.getTexture(n).rgb.mul(this.getFloat("lightMapIntensity"));else if(n===Gt.AO)r=this.getTexture(n).r.sub(1).mul(this.getFloat("aoMapIntensity")).add(1);else if(n===Gt.LINE_DASH_OFFSET)r=t.dashOffset?this.getFloat(n):$t(0);else{const i=this.getNodeType(e);r=this.getCache(n,i)}return r}}Gt.ALPHA_TEST="alphaTest";Gt.COLOR="color";Gt.OPACITY="opacity";Gt.SHININESS="shininess";Gt.SPECULAR="specular";Gt.SPECULAR_STRENGTH="specularStrength";Gt.SPECULAR_INTENSITY="specularIntensity";Gt.SPECULAR_COLOR="specularColor";Gt.REFLECTIVITY="reflectivity";Gt.ROUGHNESS="roughness";Gt.METALNESS="metalness";Gt.NORMAL="normal";Gt.CLEARCOAT="clearcoat";Gt.CLEARCOAT_ROUGHNESS="clearcoatRoughness";Gt.CLEARCOAT_NORMAL="clearcoatNormal";Gt.EMISSIVE="emissive";Gt.ROTATION="rotation";Gt.SHEEN="sheen";Gt.SHEEN_ROUGHNESS="sheenRoughness";Gt.ANISOTROPY="anisotropy";Gt.IRIDESCENCE="iridescence";Gt.IRIDESCENCE_IOR="iridescenceIOR";Gt.IRIDESCENCE_THICKNESS="iridescenceThickness";Gt.IOR="ior";Gt.TRANSMISSION="transmission";Gt.THICKNESS="thickness";Gt.ATTENUATION_DISTANCE="attenuationDistance";Gt.ATTENUATION_COLOR="attenuationColor";Gt.LINE_SCALE="scale";Gt.LINE_DASH_SIZE="dashSize";Gt.LINE_GAP_SIZE="gapSize";Gt.LINE_WIDTH="linewidth";Gt.LINE_DASH_OFFSET="dashOffset";Gt.POINT_SIZE="size";Gt.DISPERSION="dispersion";Gt.LIGHT_MAP="light";Gt.AO="ao";const bLe=kn(Gt,Gt.ALPHA_TEST),SLe=kn(Gt,Gt.COLOR),wLe=kn(Gt,Gt.SHININESS),ELe=kn(Gt,Gt.EMISSIVE),U4e=kn(Gt,Gt.OPACITY),TLe=kn(Gt,Gt.SPECULAR),Yme=kn(Gt,Gt.SPECULAR_INTENSITY),MLe=kn(Gt,Gt.SPECULAR_COLOR),kk=kn(Gt,Gt.SPECULAR_STRENGTH),dV=kn(Gt,Gt.REFLECTIVITY),CLe=kn(Gt,Gt.ROUGHNESS),ALe=kn(Gt,Gt.METALNESS),PLe=kn(Gt,Gt.NORMAL),RLe=kn(Gt,Gt.CLEARCOAT),kLe=kn(Gt,Gt.CLEARCOAT_ROUGHNESS),ILe=kn(Gt,Gt.CLEARCOAT_NORMAL),NLe=kn(Gt,Gt.ROTATION),DLe=kn(Gt,Gt.SHEEN),OLe=kn(Gt,Gt.SHEEN_ROUGHNESS),FLe=kn(Gt,Gt.ANISOTROPY),LLe=kn(Gt,Gt.IRIDESCENCE),BLe=kn(Gt,Gt.IRIDESCENCE_IOR),ULe=kn(Gt,Gt.IRIDESCENCE_THICKNESS),zLe=kn(Gt,Gt.TRANSMISSION),VLe=kn(Gt,Gt.THICKNESS),GLe=kn(Gt,Gt.IOR),jLe=kn(Gt,Gt.ATTENUATION_DISTANCE),HLe=kn(Gt,Gt.ATTENUATION_COLOR),WLe=kn(Gt,Gt.LINE_SCALE),$Le=kn(Gt,Gt.LINE_DASH_SIZE),qLe=kn(Gt,Gt.LINE_GAP_SIZE);Gt.LINE_WIDTH;const XLe=kn(Gt,Gt.LINE_DASH_OFFSET),YLe=kn(Gt,Gt.POINT_SIZE),KLe=kn(Gt,Gt.DISPERSION),z4e=kn(Gt,Gt.LIGHT_MAP),ZLe=kn(Gt,Gt.AO),xw=Gr(new pi).onReference(function(o){return o.material}).onRenderUpdate(function({material:o}){this.value.set(o.anisotropy*Math.cos(o.anisotropyRotation),o.anisotropy*Math.sin(o.anisotropyRotation))}),V4e=cn(o=>o.context.setupModelViewProjection(),"vec4").once()().toVarying("v_modelViewProjection");class QLe extends v4e{constructor(e,t,n=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class JLe extends Ph{constructor(e,t,n,r=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}class eBe extends ti{static get type(){return"InstanceNode"}constructor(e,t,n=null){super("void"),this.count=e,this.instanceMatrix=t,this.instanceColor=n,this.instanceMatrixNode=null,this.instanceColorNode=null,this.updateType=vi.FRAME,this.buffer=null,this.bufferColor=null}setup(e){const{count:t,instanceMatrix:n,instanceColor:r}=this;let{instanceMatrixNode:i,instanceColorNode:a}=this;if(i===null){if(t<=1e3)i=S4e(n.array,"mat4",Math.max(t,1)).element(CW);else{const h=new QLe(n.array,16,1);this.buffer=h;const p=n.usage===f_?zme:Ume,v=[p(h,"vec4",16,0),p(h,"vec4",16,4),p(h,"vec4",16,8),p(h,"vec4",16,12)];i=C_(...v)}this.instanceMatrixNode=i}if(r&&a===null){const h=new JLe(r.array,3),p=r.usage===f_?zme:Ume;this.bufferColor=h,a=Yt(p(h,"vec3",3,0)),this.instanceColorNode=a}const c=i.mul(z0).xyz;if(z0.assign(c),e.hasGeometryAttribute("normal")){const h=BFe(i1,i);i1.assign(h)}this.instanceColorNode!==null&&sI("vec3","vInstanceColor").assign(this.instanceColorNode)}update(){this.instanceMatrix.usage!==f_&&this.buffer!==null&&this.instanceMatrix.version!==this.buffer.version&&(this.buffer.version=this.instanceMatrix.version),this.instanceColor&&this.instanceColor.usage!==f_&&this.bufferColor!==null&&this.instanceColor.version!==this.bufferColor.version&&(this.bufferColor.version=this.instanceColor.version)}}class tBe extends eBe{static get type(){return"InstancedMeshNode"}constructor(e){const{count:t,instanceMatrix:n,instanceColor:r}=e;super(t,n,r),this.instancedMesh=e}}const nBe=un(tBe).setParameterLength(1);class rBe extends ti{static get type(){return"BatchNode"}constructor(e){super("void"),this.batchMesh=e,this.batchingIdNode=null}setup(e){this.batchingIdNode===null&&(e.getDrawIndex()===null?this.batchingIdNode=CW:this.batchingIdNode=bFe);const n=cn(([I])=>{const L=Fs(R_(tf(this.batchMesh._indirectTexture),0).x),U=Fs(I).mod(L),R=Fs(I).div(L);return tf(this.batchMesh._indirectTexture,pg(U,R)).x}).setLayout({name:"getIndirectIndex",type:"uint",inputs:[{name:"id",type:"int"}]})(Fs(this.batchingIdNode)),r=this.batchMesh._matricesTexture,i=Fs(R_(tf(r),0).x),a=$t(n).mul(4).toInt().toVar(),c=a.mod(i),h=a.div(i),p=C_(tf(r,pg(c,h)),tf(r,pg(c.add(1),h)),tf(r,pg(c.add(2),h)),tf(r,pg(c.add(3),h))),v=this.batchMesh._colorsTexture;if(v!==null){const L=cn(([U])=>{const R=Fs(R_(tf(v),0).x),$=U,Z=$.mod(R),k=$.div(R);return tf(v,pg(Z,k)).rgb}).setLayout({name:"getBatchingColor",type:"vec3",inputs:[{name:"id",type:"int"}]})(n);sI("vec3","vBatchColor").assign(L)}const x=Dl(p);z0.assign(p.mul(z0));const S=i1.div(Yt(x[0].dot(x[0]),x[1].dot(x[1]),x[2].dot(x[2]))),C=x.mul(S).xyz;i1.assign(C),e.hasGeometryAttribute("tangent")&&IW.mulAssign(x)}}const iBe=un(rBe).setParameterLength(1),Kme=new WeakMap;class sBe extends ti{static get type(){return"SkinningNode"}constructor(e){super("void"),this.skinnedMesh=e,this.updateType=vi.OBJECT,this.skinIndexNode=Q3("skinIndex","uvec4"),this.skinWeightNode=Q3("skinWeight","vec4"),this.bindMatrixNode=Es("bindMatrix","mat4"),this.bindMatrixInverseNode=Es("bindMatrixInverse","mat4"),this.boneMatricesNode=$me("skeleton.boneMatrices","mat4",e.skeleton.bones.length),this.positionNode=z0,this.toPositionNode=z0,this.previousBoneMatricesNode=null}getSkinnedPosition(e=this.boneMatricesNode,t=this.positionNode){const{skinIndexNode:n,skinWeightNode:r,bindMatrixNode:i,bindMatrixInverseNode:a}=this,c=e.element(n.x),h=e.element(n.y),p=e.element(n.z),v=e.element(n.w),x=i.mul(t),S=Ol(c.mul(r.x).mul(x),h.mul(r.y).mul(x),p.mul(r.z).mul(x),v.mul(r.w).mul(x));return a.mul(S).xyz}getSkinnedNormal(e=this.boneMatricesNode,t=i1){const{skinIndexNode:n,skinWeightNode:r,bindMatrixNode:i,bindMatrixInverseNode:a}=this,c=e.element(n.x),h=e.element(n.y),p=e.element(n.z),v=e.element(n.w);let x=Ol(r.x.mul(c),r.y.mul(h),r.z.mul(p),r.w.mul(v));return x=a.mul(x).mul(i),x.transformDirection(t).xyz}getPreviousSkinnedPosition(e){const t=e.object;return this.previousBoneMatricesNode===null&&(t.skeleton.previousBoneMatrices=new Float32Array(t.skeleton.boneMatrices),this.previousBoneMatricesNode=$me("skeleton.previousBoneMatrices","mat4",t.skeleton.bones.length)),this.getSkinnedPosition(this.previousBoneMatricesNode,Hme)}needsPreviousBoneMatrices(e){const t=e.renderer.getMRT();return t&&t.has("velocity")||D3e(e.object).useVelocity===!0}setup(e){this.needsPreviousBoneMatrices(e)&&Hme.assign(this.getPreviousSkinnedPosition(e));const t=this.getSkinnedPosition();if(this.toPositionNode&&this.toPositionNode.assign(t),e.hasGeometryAttribute("normal")){const n=this.getSkinnedNormal();i1.assign(n),e.hasGeometryAttribute("tangent")&&IW.assign(n)}return t}generate(e,t){if(t!=="void")return super.generate(e,t)}update(e){const t=e.object&&e.object.skeleton?e.object.skeleton:this.skinnedMesh.skeleton;Kme.get(t)!==e.frameId&&(Kme.set(t,e.frameId),this.previousBoneMatricesNode!==null&&t.previousBoneMatrices.set(t.boneMatrices),t.update())}}const oBe=o=>hn(new sBe(o));class aBe extends j0{constructor(e=null,t=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=ya,this.minFilter=ya,this.wrapR=W3,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}const fV=new WeakMap,gu=new Ri,Zme=cn(({bufferMap:o,influence:e,stride:t,width:n,depth:r,offset:i})=>{const a=Fs(xFe).mul(t).add(i),c=a.div(n),h=a.sub(c.mul(n));return tf(o,pg(h,c)).depth(r).xyz.mul(e)});function lBe(o){const e=o.morphAttributes.position!==void 0,t=o.morphAttributes.normal!==void 0,n=o.morphAttributes.color!==void 0,r=o.morphAttributes.position||o.morphAttributes.normal||o.morphAttributes.color,i=r!==void 0?r.length:0;let a=fV.get(o);if(a===void 0||a.count!==i){let $=function(){U.dispose(),fV.delete(o),o.removeEventListener("dispose",$)};var c=$;a!==void 0&&a.texture.dispose();const h=o.morphAttributes.position||[],p=o.morphAttributes.normal||[],v=o.morphAttributes.color||[];let x=0;e===!0&&(x=1),t===!0&&(x=2),n===!0&&(x=3);let S=o.attributes.position.count*x,C=1;const I=4096;S>I&&(C=Math.ceil(S/I),S=I);const L=new Float32Array(S*C*4*i),U=new aBe(L,S,C,i);U.type=Su,U.needsUpdate=!0;const R=x*4;for(let Z=0;Z<i;Z++){const k=h[Z],ie=p[Z],ue=v[Z],ce=S*C*4*Z;for(let Q=0;Q<k.count;Q++){const ae=Q*R;e===!0&&(gu.fromBufferAttribute(k,Q),L[ce+ae+0]=gu.x,L[ce+ae+1]=gu.y,L[ce+ae+2]=gu.z,L[ce+ae+3]=0),t===!0&&(gu.fromBufferAttribute(ie,Q),L[ce+ae+4]=gu.x,L[ce+ae+5]=gu.y,L[ce+ae+6]=gu.z,L[ce+ae+7]=0),n===!0&&(gu.fromBufferAttribute(ue,Q),L[ce+ae+8]=gu.x,L[ce+ae+9]=gu.y,L[ce+ae+10]=gu.z,L[ce+ae+11]=ue.itemSize===4?gu.w:1)}}a={count:i,texture:U,stride:x,size:new pi(S,C)},fV.set(o,a),o.addEventListener("dispose",$)}return a}class cBe extends ti{static get type(){return"MorphNode"}constructor(e){super("void"),this.mesh=e,this.morphBaseInfluence=Gr(1),this.updateType=vi.OBJECT}setup(e){const{geometry:t}=e,n=t.morphAttributes.position!==void 0,r=t.hasAttribute("normal")&&t.morphAttributes.normal!==void 0,i=t.morphAttributes.position||t.morphAttributes.normal||t.morphAttributes.color,a=i!==void 0?i.length:0,{texture:c,stride:h,size:p}=lBe(t);n===!0&&z0.mulAssign(this.morphBaseInfluence),r===!0&&i1.mulAssign(this.morphBaseInfluence);const v=Fs(p.width);cf(a,({i:x})=>{const S=$t(0).toVar();this.mesh.count>1&&this.mesh.morphTexture!==null&&this.mesh.morphTexture!==void 0?S.assign(tf(this.mesh.morphTexture,pg(Fs(x).add(1),Fs(CW))).r):S.assign(Es("morphTargetInfluences","float").element(x).toVar()),Wo(S.notEqual(0),()=>{n===!0&&z0.addAssign(Zme({bufferMap:c,influence:S,stride:h,width:v,depth:x,offset:Fs(0)})),r===!0&&i1.addAssign(Zme({bufferMap:c,influence:S,stride:h,width:v,depth:x,offset:Fs(1)}))})})}update(){const e=this.morphBaseInfluence;this.mesh.geometry.morphTargetsRelative?e.value=1:e.value=1-this.mesh.morphTargetInfluences.reduce((t,n)=>t+n,0)}}const uBe=un(cBe).setParameterLength(1);class sx extends ti{static get type(){return"LightingNode"}constructor(){super("vec3"),this.isLightingNode=!0}}class hBe extends sx{static get type(){return"AONode"}constructor(e=null){super(),this.aoNode=e}setup(e){e.context.ambientOcclusion.mulAssign(this.aoNode)}}class dBe extends m4e{static get type(){return"LightingContextNode"}constructor(e,t=null,n=null,r=null){super(e),this.lightingModel=t,this.backdropNode=n,this.backdropAlphaNode=r,this._value=null}getContext(){const{backdropNode:e,backdropAlphaNode:t}=this,n=Yt().toVar("directDiffuse"),r=Yt().toVar("directSpecular"),i=Yt().toVar("indirectDiffuse"),a=Yt().toVar("indirectSpecular"),c={directDiffuse:n,directSpecular:r,indirectDiffuse:i,indirectSpecular:a};return{radiance:Yt().toVar("radiance"),irradiance:Yt().toVar("irradiance"),iblIrradiance:Yt().toVar("iblIrradiance"),ambientOcclusion:$t(1).toVar("ambientOcclusion"),reflectedLight:c,backdrop:e,backdropAlpha:t}}setup(e){return this.value=this._value||(this._value=this.getContext()),this.value.lightingModel=this.lightingModel||e.context.lightingModel,super.setup(e)}}const fBe=un(dBe);class pBe extends sx{static get type(){return"IrradianceNode"}constructor(e){super(),this.node=e}setup(e){e.context.irradiance.addAssign(this.node)}}class Rh extends ti{static get type(){return"ClippingNode"}constructor(e=Rh.DEFAULT){super(),this.scope=e}setup(e){super.setup(e);const t=e.clippingContext,{intersectionPlanes:n,unionPlanes:r}=t;return this.hardwareClipping=e.material.hardwareClipping,this.scope===Rh.ALPHA_TO_COVERAGE?this.setupAlphaToCoverage(n,r):this.scope===Rh.HARDWARE?this.setupHardwareClipping(r,e):this.setupDefault(n,r)}setupAlphaToCoverage(e,t){return cn(()=>{const n=$t().toVar("distanceToPlane"),r=$t().toVar("distanceToGradient"),i=$t(1).toVar("clipOpacity"),a=t.length;if(this.hardwareClipping===!1&&a>0){const h=Kp(t);cf(a,({i:p})=>{const v=h.element(p);n.assign(ia.dot(v.xyz).negate().add(v.w)),r.assign(n.fwidth().div(2)),i.mulAssign(Z3(r.negate(),r,n))})}const c=e.length;if(c>0){const h=Kp(e),p=$t(1).toVar("intersectionClipOpacity");cf(c,({i:v})=>{const x=h.element(v);n.assign(ia.dot(x.xyz).negate().add(x.w)),r.assign(n.fwidth().div(2)),p.mulAssign(Z3(r.negate(),r,n).oneMinus())}),i.mulAssign(p.oneMinus())}$i.a.mulAssign(i),$i.a.equal(0).discard()})()}setupDefault(e,t){return cn(()=>{const n=t.length;if(this.hardwareClipping===!1&&n>0){const i=Kp(t);cf(n,({i:a})=>{const c=i.element(a);ia.dot(c.xyz).greaterThan(c.w).discard()})}const r=e.length;if(r>0){const i=Kp(e),a=fW(!0).toVar("clipped");cf(r,({i:c})=>{const h=i.element(c);a.assign(ia.dot(h.xyz).greaterThan(h.w).and(a))}),a.discard()}})()}setupHardwareClipping(e,t){const n=e.length;return t.enableHardwareClipping(n),cn(()=>{const r=Kp(e),i=RI(t.getClipDistance());cf(n,({i:a})=>{const c=r.element(a),h=ia.dot(c.xyz).sub(c.w).negate();i.element(a).assign(h)})})()}}Rh.ALPHA_TO_COVERAGE="alphaToCoverage";Rh.DEFAULT="default";Rh.HARDWARE="hardware";const mBe=()=>hn(new Rh),gBe=()=>hn(new Rh(Rh.ALPHA_TO_COVERAGE)),yBe=()=>hn(new Rh(Rh.HARDWARE)),vBe=["alphaMap","alphaTest","anisotropy","anisotropyMap","anisotropyRotation","aoMap","aoMapIntensity","attenuationColor","attenuationDistance","bumpMap","clearcoat","clearcoatMap","clearcoatNormalMap","clearcoatNormalScale","clearcoatRoughness","color","dispersion","displacementMap","emissive","emissiveIntensity","emissiveMap","envMap","envMapIntensity","gradientMap","ior","iridescence","iridescenceIOR","iridescenceMap","iridescenceThicknessMap","lightMap","lightMapIntensity","map","matcap","metalness","metalnessMap","normalMap","normalScale","opacity","roughness","roughnessMap","sheen","sheenColor","sheenColorMap","sheenRoughnessMap","shininess","specular","specularColor","specularColorMap","specularIntensity","specularIntensityMap","specularMap","thickness","transmission","transmissionMap"];class _Be{constructor(e){this.renderObjects=new WeakMap,this.hasNode=this.containsNode(e),this.hasAnimation=e.object.isSkinnedMesh===!0,this.refreshUniforms=vBe,this.renderId=0}firstInitialization(e){return this.renderObjects.has(e)===!1?(this.getRenderObjectData(e),!0):!1}needsVelocity(e){const t=e.getMRT();return t!==null&&t.has("velocity")}getRenderObjectData(e){let t=this.renderObjects.get(e);if(t===void 0){const{geometry:n,material:r,object:i}=e;if(t={material:this.getMaterialData(r),geometry:{id:n.id,attributes:this.getAttributesData(n.attributes),indexVersion:n.index?n.index.version:null,drawRange:{start:n.drawRange.start,count:n.drawRange.count}},worldMatrix:i.matrixWorld.clone()},i.center&&(t.center=i.center.clone()),i.morphTargetInfluences&&(t.morphTargetInfluences=i.morphTargetInfluences.slice()),e.bundle!==null&&(t.version=e.bundle.version),t.material.transmission>0){const{width:a,height:c}=e.context;t.bufferWidth=a,t.bufferHeight=c}this.renderObjects.set(e,t)}return t}getAttributesData(e){const t={};for(const n in e){const r=e[n];t[n]={version:r.version}}return t}containsNode(e){const t=e.material;for(const n in t)if(t[n]&&t[n].isNode)return!0;return e.renderer.overrideNodes.modelViewMatrix!==null||e.renderer.overrideNodes.modelNormalViewMatrix!==null}getMaterialData(e){const t={};for(const n of this.refreshUniforms){const r=e[n];r!=null&&(typeof r=="object"&&r.clone!==void 0?r.isTexture===!0?t[n]={id:r.id,version:r.version}:t[n]=r.clone():t[n]=r)}return t}equals(e){const{object:t,material:n,geometry:r}=e,i=this.getRenderObjectData(e);if(i.worldMatrix.equals(t.matrixWorld)!==!0)return i.worldMatrix.copy(t.matrixWorld),!1;const a=i.material;for(const L in a){const U=a[L],R=n[L];if(U.equals!==void 0){if(U.equals(R)===!1)return U.copy(R),!1}else if(R.isTexture===!0){if(U.id!==R.id||U.version!==R.version)return U.id=R.id,U.version=R.version,!1}else if(U!==R)return a[L]=R,!1}if(a.transmission>0){const{width:L,height:U}=e.context;if(i.bufferWidth!==L||i.bufferHeight!==U)return i.bufferWidth=L,i.bufferHeight=U,!1}const c=i.geometry,h=r.attributes,p=c.attributes,v=Object.keys(p),x=Object.keys(h);if(c.id!==r.id)return c.id=r.id,!1;if(v.length!==x.length)return i.geometry.attributes=this.getAttributesData(h),!1;for(const L of v){const U=p[L],R=h[L];if(R===void 0)return delete p[L],!1;if(U.version!==R.version)return U.version=R.version,!1}const S=r.index,C=c.indexVersion,I=S?S.version:null;if(C!==I)return c.indexVersion=I,!1;if(c.drawRange.start!==r.drawRange.start||c.drawRange.count!==r.drawRange.count)return c.drawRange.start=r.drawRange.start,c.drawRange.count=r.drawRange.count,!1;if(i.morphTargetInfluences){let L=!1;for(let U=0;U<i.morphTargetInfluences.length;U++)i.morphTargetInfluences[U]!==t.morphTargetInfluences[U]&&(L=!0);if(L)return!0}return i.center&&i.center.equals(t.center)===!1?(i.center.copy(t.center),!0):(e.bundle!==null&&(i.version=e.bundle.version),!0)}needsRefresh(e,t){if(this.hasNode||this.hasAnimation||this.firstInitialization(e)||this.needsVelocity(t.renderer))return!0;const{renderId:n}=t;if(this.renderId!==n)return this.renderId=n,!0;const r=e.object.static===!0,i=e.bundle!==null&&e.bundle.static===!0&&this.getRenderObjectData(e).version===e.bundle.version;return r||i?!1:this.equals(e)!==!0}}const xBe=.05,Qme=cn(([o])=>n4(Ei(1e4,af(Ei(17,o.x).add(Ei(.1,o.y)))).mul(Ol(.1,Sh(af(Ei(13,o.y).add(o.x))))))),Jme=cn(([o])=>Qme(In(Qme(o.xy),o.z))),bBe=cn(([o])=>{const e=W0(Pg(a4e(o.xyz)),Pg(l4e(o.xyz))),t=$t(1).div($t(xBe).mul(e)).toVar("pixScale"),n=In(CE(m6(Ag(t))),CE(_W(Ag(t)))),r=In(Jme(m6(n.x.mul(o.xyz))),Jme(m6(n.y.mul(o.xyz)))),i=n4(Ag(t)),a=Ol(Ei(i.oneMinus(),r.x),Ei(i,r.y)),c=H_(i,i.oneMinus()),h=Yt(a.mul(a).div(Ei(2,c).mul(Rl(1,c))),a.sub(Ei(.5,c)).div(Rl(1,c)),Rl(1,Rl(1,a).mul(Rl(1,a)).div(Ei(2,c).mul(Rl(1,c))))),p=a.lessThan(c.oneMinus()).select(a.lessThan(c).select(h.x,h.y),h.z);return Dg(p,1e-6,1)}).setLayout({name:"getAlphaHashThreshold",type:"float",inputs:[{name:"position",type:"vec3"}]});class SBe extends x4e{static get type(){return"VertexColorNode"}constructor(e){super(null,"vec4"),this.isVertexColorNode=!0,this.index=e}getAttributeName(){const e=this.index;return"color"+(e>0?e:"")}generate(e){const t=this.getAttributeName(e),n=e.hasGeometryAttribute(t);let r;return n===!0?r=super.generate(e):r=e.generateConst(this.nodeType,new Ri(1,1,1,1)),r}serialize(e){super.serialize(e),e.index=this.index}deserialize(e){super.deserialize(e),this.index=e.index}}const wBe=(o=0)=>hn(new SBe(o));class sa extends Tc{static get type(){return"NodeMaterial"}get type(){return this.constructor.type}set type(e){}constructor(){super(),this.isNodeMaterial=!0,this.fog=!0,this.lights=!1,this.hardwareClipping=!1,this.lightsNode=null,this.envNode=null,this.aoNode=null,this.colorNode=null,this.normalNode=null,this.opacityNode=null,this.backdropNode=null,this.backdropAlphaNode=null,this.alphaTestNode=null,this.maskNode=null,this.positionNode=null,this.geometryNode=null,this.depthNode=null,this.receivedShadowPositionNode=null,this.castShadowPositionNode=null,this.receivedShadowNode=null,this.castShadowNode=null,this.outputNode=null,this.mrtNode=null,this.fragmentNode=null,this.vertexNode=null,Object.defineProperty(this,"shadowPositionNode",{get:()=>this.receivedShadowPositionNode,set:e=>{console.warn('THREE.NodeMaterial: ".shadowPositionNode" was renamed to ".receivedShadowPositionNode".'),this.receivedShadowPositionNode=e}})}customProgramCacheKey(){return this.type+I3e(this)}build(e){this.setup(e)}setupObserver(e){return new _Be(e)}setup(e){e.context.setupNormal=()=>this.setupNormal(e),e.context.setupPositionView=()=>this.setupPositionView(e),e.context.setupModelViewProjection=()=>this.setupModelViewProjection(e);const t=e.renderer,n=t.getRenderTarget();e.addStack();const r=this.setupVertex(e),i=this.vertexNode||r;e.stack.outputNode=i,this.setupHardwareClipping(e),this.geometryNode!==null&&(e.stack.outputNode=e.stack.outputNode.bypass(this.geometryNode)),e.addFlow("vertex",e.removeStack()),e.addStack();let a;const c=this.setupClipping(e);if((this.depthWrite===!0||this.depthTest===!0)&&(n!==null?n.depthBuffer===!0&&this.setupDepth(e):t.depth===!0&&this.setupDepth(e)),this.fragmentNode===null){this.setupDiffuseColor(e),this.setupVariants(e);const h=this.setupLighting(e);c!==null&&e.stack.add(c);const p=ei(h,$i.a).max(0);a=this.setupOutput(e,p),oE.assign(a);const v=this.outputNode!==null;if(v&&(a=this.outputNode),n!==null){const x=t.getMRT(),S=this.mrtNode;x!==null?(v&&oE.assign(a),a=x,S!==null&&(a=x.merge(S))):S!==null&&(a=S)}}else{let h=this.fragmentNode;h.isOutputStructNode!==!0&&(h=ei(h)),a=this.setupOutput(e,h)}e.stack.outputNode=a,e.addFlow("fragment",e.removeStack()),e.observer=this.setupObserver(e)}setupClipping(e){if(e.clippingContext===null)return null;const{unionPlanes:t,intersectionPlanes:n}=e.clippingContext;let r=null;if(t.length>0||n.length>0){const i=e.renderer.samples;this.alphaToCoverage&&i>1?r=gBe():e.stack.add(mBe())}return r}setupHardwareClipping(e){if(this.hardwareClipping=!1,e.clippingContext===null)return;const t=e.clippingContext.unionPlanes.length;t>0&&t<=8&&e.isAvailable("clipDistance")&&(e.stack.add(yBe()),this.hardwareClipping=!0)}setupDepth(e){const{renderer:t,camera:n}=e;let r=this.depthNode;if(r===null){const i=t.getMRT();i&&i.has("depth")?r=i.get("depth"):t.logarithmicDepthBuffer===!0&&(n.isPerspectiveCamera?r=N4e(ia.z,o6,a6):r=lE(ia.z,o6,a6))}r!==null&&O4e.assign(r).toStack()}setupPositionView(){return kI.mul(z0).xyz}setupModelViewProjection(){return AW.mul(ia)}setupVertex(e){return e.addStack(),this.setupPosition(e),e.context.vertex=e.removeStack(),V4e}setupPosition(e){const{object:t,geometry:n}=e;if((n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color)&&uBe(t).toStack(),t.isSkinnedMesh===!0&&oBe(t).toStack(),this.displacementMap){const r=j3("displacementMap","texture"),i=j3("displacementScale","float"),a=j3("displacementBias","float");z0.addAssign(i1.normalize().mul(r.x.mul(i).add(a)))}return t.isBatchedMesh&&iBe(t).toStack(),t.isInstancedMesh&&t.instanceMatrix&&t.instanceMatrix.isInstancedBufferAttribute===!0&&nBe(t).toStack(),this.positionNode!==null&&z0.assign(uFe(this.positionNode,"POSITION")),z0}setupDiffuseColor({object:e,geometry:t}){this.maskNode!==null&&fW(this.maskNode).not().discard();let n=this.colorNode?ei(this.colorNode):SLe;this.vertexColors===!0&&t.hasAttribute("color")&&(n=n.mul(wBe())),e.instanceColor&&(n=sI("vec3","vInstanceColor").mul(n)),e.isBatchedMesh&&e._colorsTexture&&(n=sI("vec3","vBatchColor").mul(n)),$i.assign(n);const r=this.opacityNode?$t(this.opacityNode):U4e;$i.a.assign($i.a.mul(r));let i=null;(this.alphaTestNode!==null||this.alphaTest>0)&&(i=this.alphaTestNode!==null?$t(this.alphaTestNode):bLe,$i.a.lessThanEqual(i).discard()),this.alphaHash===!0&&$i.a.lessThan(bBe(z0)).discard(),this.transparent===!1&&this.blending===Eg&&this.alphaToCoverage===!1?$i.a.assign(1):i===null&&$i.a.lessThanEqual(0).discard()}setupVariants(){}setupOutgoingLight(){return this.lights===!0?Yt(0):$i.rgb}setupNormal(){return this.normalNode?Yt(this.normalNode):PLe}setupEnvironment(){let e=null;return this.envNode?e=this.envNode:this.envMap&&(e=this.envMap.isCubeTexture?j3("envMap","cubeTexture"):j3("envMap","texture")),e}setupLightMap(e){let t=null;return e.material.lightMap&&(t=new pBe(z4e)),t}setupLights(e){const t=[],n=this.setupEnvironment(e);n&&n.isLightingNode&&t.push(n);const r=this.setupLightMap(e);if(r&&r.isLightingNode&&t.push(r),this.aoNode!==null||e.material.aoMap){const a=this.aoNode!==null?this.aoNode:ZLe;t.push(new hBe(a))}let i=this.lightsNode||e.lightsNode;return t.length>0&&(i=e.renderer.lighting.createNode([...i.getLights(),...t])),i}setupLightingModel(){}setupLighting(e){const{material:t}=e,{backdropNode:n,backdropAlphaNode:r,emissiveNode:i}=this,c=this.lights===!0||this.lightsNode!==null?this.setupLights(e):null;let h=this.setupOutgoingLight(e);if(c&&c.getScope().hasLights){const p=this.setupLightingModel(e)||null;h=fBe(c,p,n,r)}else n!==null&&(h=Yt(r!==null?Zs(h,n,r):n));return(i&&i.isNode===!0||t.emissive&&t.emissive.isColor===!0)&&(Lme.assign(Yt(i||ELe)),h=h.add(Lme)),h}setupFog(e,t){const n=e.fogNode;return n&&(oE.assign(t),t=ei(n)),t}setupOutput(e,t){return this.fog===!0&&(t=this.setupFog(e,t)),t}setDefaultValues(e){for(const n in e){const r=e[n];this[n]===void 0&&(this[n]=r,r&&r.clone&&(this[n]=r.clone()))}const t=Object.getOwnPropertyDescriptors(e.constructor.prototype);for(const n in t)Object.getOwnPropertyDescriptor(this.constructor.prototype,n)===void 0&&t[n].get!==void 0&&Object.defineProperty(this.constructor.prototype,n,t[n])}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{},nodes:{}});const n=Tc.prototype.toJSON.call(this,e),r=nI(this);n.inputNodes={};for(const{property:a,childNode:c}of r)n.inputNodes[a]=c.toJSON(e).uuid;function i(a){const c=[];for(const h in a){const p=a[h];delete p.metadata,c.push(p)}return c}if(t){const a=i(e.textures),c=i(e.images),h=i(e.nodes);a.length>0&&(n.textures=a),c.length>0&&(n.images=c),h.length>0&&(n.nodes=h)}return n}copy(e){return this.lightsNode=e.lightsNode,this.envNode=e.envNode,this.colorNode=e.colorNode,this.normalNode=e.normalNode,this.opacityNode=e.opacityNode,this.backdropNode=e.backdropNode,this.backdropAlphaNode=e.backdropAlphaNode,this.alphaTestNode=e.alphaTestNode,this.maskNode=e.maskNode,this.positionNode=e.positionNode,this.geometryNode=e.geometryNode,this.depthNode=e.depthNode,this.receivedShadowPositionNode=e.receivedShadowPositionNode,this.castShadowPositionNode=e.castShadowPositionNode,this.receivedShadowNode=e.receivedShadowNode,this.castShadowNode=e.castShadowNode,this.outputNode=e.outputNode,this.mrtNode=e.mrtNode,this.fragmentNode=e.fragmentNode,this.vertexNode=e.vertexNode,super.copy(e)}}let EBe=0;const _h=new Ts,pV=new va,V7=new yt,yu=new FE,bw=new FE,Oa=new yt;class Bg extends M6{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:EBe++}),this.uuid=Sg(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(R3e(e)?F3e:O3e)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const i=new Mc().getNormalMatrix(e);n.applyNormalMatrix(i),n.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return _h.makeRotationFromQuaternion(e),this.applyMatrix4(_h),this}rotateX(e){return _h.makeRotationX(e),this.applyMatrix4(_h),this}rotateY(e){return _h.makeRotationY(e),this.applyMatrix4(_h),this}rotateZ(e){return _h.makeRotationZ(e),this.applyMatrix4(_h),this}translate(e,t,n){return _h.makeTranslation(e,t,n),this.applyMatrix4(_h),this}scale(e,t,n){return _h.makeScale(e,t,n),this.applyMatrix4(_h),this}lookAt(e){return pV.lookAt(e),pV.updateMatrix(),this.applyMatrix4(pV.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(V7).negate(),this.translate(V7.x,V7.y,V7.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const n=[];for(let r=0,i=e.length;r<i;r++){const a=e[r];n.push(a.x,a.y,a.z||0)}this.setAttribute("position",new Nl(n,3))}else{const n=Math.min(e.length,t.count);for(let r=0;r<n;r++){const i=e[r];t.setXYZ(r,i.x,i.y,i.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new FE);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new yt(-1/0,-1/0,-1/0),new yt(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++){const i=t[n];yu.setFromBufferAttribute(i),this.morphTargetsRelative?(Oa.addVectors(this.boundingBox.min,yu.min),this.boundingBox.expandByPoint(Oa),Oa.addVectors(this.boundingBox.max,yu.max),this.boundingBox.expandByPoint(Oa)):(this.boundingBox.expandByPoint(yu.min),this.boundingBox.expandByPoint(yu.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new PI);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new yt,1/0);return}if(e){const n=this.boundingSphere.center;if(yu.setFromBufferAttribute(e),t)for(let i=0,a=t.length;i<a;i++){const c=t[i];bw.setFromBufferAttribute(c),this.morphTargetsRelative?(Oa.addVectors(yu.min,bw.min),yu.expandByPoint(Oa),Oa.addVectors(yu.max,bw.max),yu.expandByPoint(Oa)):(yu.expandByPoint(bw.min),yu.expandByPoint(bw.max))}yu.getCenter(n);let r=0;for(let i=0,a=e.count;i<a;i++)Oa.fromBufferAttribute(e,i),r=Math.max(r,n.distanceToSquared(Oa));if(t)for(let i=0,a=t.length;i<a;i++){const c=t[i],h=this.morphTargetsRelative;for(let p=0,v=c.count;p<v;p++)Oa.fromBufferAttribute(c,p),h&&(V7.fromBufferAttribute(e,p),Oa.add(V7)),r=Math.max(r,n.distanceToSquared(Oa))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=t.position,r=t.normal,i=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Ph(new Float32Array(4*n.count),4));const a=this.getAttribute("tangent"),c=[],h=[];for(let Q=0;Q<n.count;Q++)c[Q]=new yt,h[Q]=new yt;const p=new yt,v=new yt,x=new yt,S=new pi,C=new pi,I=new pi,L=new yt,U=new yt;function R(Q,ae,le){p.fromBufferAttribute(n,Q),v.fromBufferAttribute(n,ae),x.fromBufferAttribute(n,le),S.fromBufferAttribute(i,Q),C.fromBufferAttribute(i,ae),I.fromBufferAttribute(i,le),v.sub(p),x.sub(p),C.sub(S),I.sub(S);const J=1/(C.x*I.y-I.x*C.y);isFinite(J)&&(L.copy(v).multiplyScalar(I.y).addScaledVector(x,-C.y).multiplyScalar(J),U.copy(x).multiplyScalar(C.x).addScaledVector(v,-I.x).multiplyScalar(J),c[Q].add(L),c[ae].add(L),c[le].add(L),h[Q].add(U),h[ae].add(U),h[le].add(U))}let $=this.groups;$.length===0&&($=[{start:0,count:e.count}]);for(let Q=0,ae=$.length;Q<ae;++Q){const le=$[Q],J=le.start,Ue=le.count;for(let je=J,rt=J+Ue;je<rt;je+=3)R(e.getX(je+0),e.getX(je+1),e.getX(je+2))}const Z=new yt,k=new yt,ie=new yt,ue=new yt;function ce(Q){ie.fromBufferAttribute(r,Q),ue.copy(ie);const ae=c[Q];Z.copy(ae),Z.sub(ie.multiplyScalar(ie.dot(ae))).normalize(),k.crossVectors(ue,ae);const J=k.dot(h[Q])<0?-1:1;a.setXYZW(Q,Z.x,Z.y,Z.z,J)}for(let Q=0,ae=$.length;Q<ae;++Q){const le=$[Q],J=le.start,Ue=le.count;for(let je=J,rt=J+Ue;je<rt;je+=3)ce(e.getX(je+0)),ce(e.getX(je+1)),ce(e.getX(je+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new Ph(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let S=0,C=n.count;S<C;S++)n.setXYZ(S,0,0,0);const r=new yt,i=new yt,a=new yt,c=new yt,h=new yt,p=new yt,v=new yt,x=new yt;if(e)for(let S=0,C=e.count;S<C;S+=3){const I=e.getX(S+0),L=e.getX(S+1),U=e.getX(S+2);r.fromBufferAttribute(t,I),i.fromBufferAttribute(t,L),a.fromBufferAttribute(t,U),v.subVectors(a,i),x.subVectors(r,i),v.cross(x),c.fromBufferAttribute(n,I),h.fromBufferAttribute(n,L),p.fromBufferAttribute(n,U),c.add(v),h.add(v),p.add(v),n.setXYZ(I,c.x,c.y,c.z),n.setXYZ(L,h.x,h.y,h.z),n.setXYZ(U,p.x,p.y,p.z)}else for(let S=0,C=t.count;S<C;S+=3)r.fromBufferAttribute(t,S+0),i.fromBufferAttribute(t,S+1),a.fromBufferAttribute(t,S+2),v.subVectors(a,i),x.subVectors(r,i),v.cross(x),n.setXYZ(S+0,v.x,v.y,v.z),n.setXYZ(S+1,v.x,v.y,v.z),n.setXYZ(S+2,v.x,v.y,v.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Oa.fromBufferAttribute(e,t),Oa.normalize(),e.setXYZ(t,Oa.x,Oa.y,Oa.z)}toNonIndexed(){function e(c,h){const p=c.array,v=c.itemSize,x=c.normalized,S=new p.constructor(h.length*v);let C=0,I=0;for(let L=0,U=h.length;L<U;L++){c.isInterleavedBufferAttribute?C=h[L]*c.data.stride+c.offset:C=h[L]*v;for(let R=0;R<v;R++)S[I++]=p[C++]}return new Ph(S,v,x)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Bg,n=this.index.array,r=this.attributes;for(const c in r){const h=r[c],p=e(h,n);t.setAttribute(c,p)}const i=this.morphAttributes;for(const c in i){const h=[],p=i[c];for(let v=0,x=p.length;v<x;v++){const S=p[v],C=e(S,n);h.push(C)}t.morphAttributes[c]=h}t.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let c=0,h=a.length;c<h;c++){const p=a[c];t.addGroup(p.start,p.count,p.materialIndex)}return t}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const h=this.parameters;for(const p in h)h[p]!==void 0&&(e[p]=h[p]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const h in n){const p=n[h];e.data.attributes[h]=p.toJSON(e.data)}const r={};let i=!1;for(const h in this.morphAttributes){const p=this.morphAttributes[h],v=[];for(let x=0,S=p.length;x<S;x++){const C=p[x];v.push(C.toJSON(e.data))}v.length>0&&(r[h]=v,i=!0)}i&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const c=this.boundingSphere;return c!==null&&(e.data.boundingSphere=c.toJSON()),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone());const r=e.attributes;for(const p in r){const v=r[p];this.setAttribute(p,v.clone(t))}const i=e.morphAttributes;for(const p in i){const v=[],x=i[p];for(let S=0,C=x.length;S<C;S++)v.push(x[S].clone(t));this.morphAttributes[p]=v}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let p=0,v=a.length;p<v;p++){const x=a[p];this.addGroup(x.start,x.count,x.materialIndex)}const c=e.boundingBox;c!==null&&(this.boundingBox=c.clone());const h=e.boundingSphere;return h!==null&&(this.boundingSphere=h.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const cg=new yt,mV=new yt,IR=new yt,R3=new yt,gV=new yt,NR=new yt,yV=new yt;class TBe{constructor(e=new yt,t=new yt(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,cg)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=cg.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(cg.copy(this.origin).addScaledVector(this.direction,t),cg.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){mV.copy(e).add(t).multiplyScalar(.5),IR.copy(t).sub(e).normalize(),R3.copy(this.origin).sub(mV);const i=e.distanceTo(t)*.5,a=-this.direction.dot(IR),c=R3.dot(this.direction),h=-R3.dot(IR),p=R3.lengthSq(),v=Math.abs(1-a*a);let x,S,C,I;if(v>0)if(x=a*h-c,S=a*c-h,I=i*v,x>=0)if(S>=-I)if(S<=I){const L=1/v;x*=L,S*=L,C=x*(x+a*S+2*c)+S*(a*x+S+2*h)+p}else S=i,x=Math.max(0,-(a*S+c)),C=-x*x+S*(S+2*h)+p;else S=-i,x=Math.max(0,-(a*S+c)),C=-x*x+S*(S+2*h)+p;else S<=-I?(x=Math.max(0,-(-a*i+c)),S=x>0?-i:Math.min(Math.max(-i,-h),i),C=-x*x+S*(S+2*h)+p):S<=I?(x=0,S=Math.min(Math.max(-i,-h),i),C=S*(S+2*h)+p):(x=Math.max(0,-(a*i+c)),S=x>0?i:Math.min(Math.max(-i,-h),i),C=-x*x+S*(S+2*h)+p);else S=a>0?-i:i,x=Math.max(0,-(a*S+c)),C=-x*x+S*(S+2*h)+p;return n&&n.copy(this.origin).addScaledVector(this.direction,x),r&&r.copy(mV).addScaledVector(IR,S),C}intersectSphere(e,t){cg.subVectors(e.center,this.origin);const n=cg.dot(this.direction),r=cg.dot(cg)-n*n,i=e.radius*e.radius;if(r>i)return null;const a=Math.sqrt(i-r),c=n-a,h=n+a;return h<0?null:c<0?this.at(h,t):this.at(c,t)}intersectsSphere(e){return e.radius<0?!1:this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,i,a,c,h;const p=1/this.direction.x,v=1/this.direction.y,x=1/this.direction.z,S=this.origin;return p>=0?(n=(e.min.x-S.x)*p,r=(e.max.x-S.x)*p):(n=(e.max.x-S.x)*p,r=(e.min.x-S.x)*p),v>=0?(i=(e.min.y-S.y)*v,a=(e.max.y-S.y)*v):(i=(e.max.y-S.y)*v,a=(e.min.y-S.y)*v),n>a||i>r||((i>n||isNaN(n))&&(n=i),(a<r||isNaN(r))&&(r=a),x>=0?(c=(e.min.z-S.z)*x,h=(e.max.z-S.z)*x):(c=(e.max.z-S.z)*x,h=(e.min.z-S.z)*x),n>h||c>r)||((c>n||n!==n)&&(n=c),(h<r||r!==r)&&(r=h),r<0)?null:this.at(n>=0?n:r,t)}intersectsBox(e){return this.intersectBox(e,cg)!==null}intersectTriangle(e,t,n,r,i){gV.subVectors(t,e),NR.subVectors(n,e),yV.crossVectors(gV,NR);let a=this.direction.dot(yV),c;if(a>0){if(r)return null;c=1}else if(a<0)c=-1,a=-a;else return null;R3.subVectors(this.origin,e);const h=c*this.direction.dot(NR.crossVectors(R3,NR));if(h<0)return null;const p=c*this.direction.dot(gV.cross(R3));if(p<0||h+p>a)return null;const v=-c*R3.dot(yV);return v<0?null:this.at(v/a,i)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}const Zd=new yt,ug=new yt,vV=new yt,hg=new yt,G7=new yt,j7=new yt,ege=new yt,_V=new yt,xV=new yt,bV=new yt,SV=new Ri,wV=new Ri,EV=new Ri;class uf{constructor(e=new yt,t=new yt,n=new yt){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),Zd.subVectors(e,t),r.cross(Zd);const i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}static getBarycoord(e,t,n,r,i){Zd.subVectors(r,t),ug.subVectors(n,t),vV.subVectors(e,t);const a=Zd.dot(Zd),c=Zd.dot(ug),h=Zd.dot(vV),p=ug.dot(ug),v=ug.dot(vV),x=a*p-c*c;if(x===0)return i.set(0,0,0),null;const S=1/x,C=(p*h-c*v)*S,I=(a*v-c*h)*S;return i.set(1-C-I,I,C)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,hg)===null?!1:hg.x>=0&&hg.y>=0&&hg.x+hg.y<=1}static getInterpolation(e,t,n,r,i,a,c,h){return this.getBarycoord(e,t,n,r,hg)===null?(h.x=0,h.y=0,"z"in h&&(h.z=0),"w"in h&&(h.w=0),null):(h.setScalar(0),h.addScaledVector(i,hg.x),h.addScaledVector(a,hg.y),h.addScaledVector(c,hg.z),h)}static getInterpolatedAttribute(e,t,n,r,i,a){return SV.setScalar(0),wV.setScalar(0),EV.setScalar(0),SV.fromBufferAttribute(e,t),wV.fromBufferAttribute(e,n),EV.fromBufferAttribute(e,r),a.setScalar(0),a.addScaledVector(SV,i.x),a.addScaledVector(wV,i.y),a.addScaledVector(EV,i.z),a}static isFrontFacing(e,t,n,r){return Zd.subVectors(n,t),ug.subVectors(e,t),Zd.cross(ug).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Zd.subVectors(this.c,this.b),ug.subVectors(this.a,this.b),Zd.cross(ug).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return uf.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return uf.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,r,i){return uf.getInterpolation(e,this.a,this.b,this.c,t,n,r,i)}containsPoint(e){return uf.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return uf.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,i=this.c;let a,c;G7.subVectors(r,n),j7.subVectors(i,n),_V.subVectors(e,n);const h=G7.dot(_V),p=j7.dot(_V);if(h<=0&&p<=0)return t.copy(n);xV.subVectors(e,r);const v=G7.dot(xV),x=j7.dot(xV);if(v>=0&&x<=v)return t.copy(r);const S=h*x-v*p;if(S<=0&&h>=0&&v<=0)return a=h/(h-v),t.copy(n).addScaledVector(G7,a);bV.subVectors(e,i);const C=G7.dot(bV),I=j7.dot(bV);if(I>=0&&C<=I)return t.copy(i);const L=C*p-h*I;if(L<=0&&p>=0&&I<=0)return c=p/(p-I),t.copy(n).addScaledVector(j7,c);const U=v*I-C*x;if(U<=0&&x-v>=0&&C-I>=0)return ege.subVectors(i,r),c=(x-v)/(x-v+(C-I)),t.copy(r).addScaledVector(ege,c);const R=1/(U+L+S);return a=L*R,c=S*R,t.copy(n).addScaledVector(G7,a).addScaledVector(j7,c)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}class H3 extends Tc{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new qi(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new kh,this.combine=SI,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const tge=new Ts,G8=new TBe,DR=new PI,nge=new yt,OR=new yt,FR=new yt,LR=new yt,TV=new yt,BR=new yt,rge=new yt,UR=new yt;class Og extends va{constructor(e=new Bg,t=new H3){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,a=r.length;i<a;i++){const c=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=i}}}}getVertexPosition(e,t){const n=this.geometry,r=n.attributes.position,i=n.morphAttributes.position,a=n.morphTargetsRelative;t.fromBufferAttribute(r,e);const c=this.morphTargetInfluences;if(i&&c){BR.set(0,0,0);for(let h=0,p=i.length;h<p;h++){const v=c[h],x=i[h];v!==0&&(TV.fromBufferAttribute(x,e),a?BR.addScaledVector(TV,v):BR.addScaledVector(TV.sub(t),v))}t.add(BR)}return t}raycast(e,t){const n=this.geometry,r=this.material,i=this.matrixWorld;r!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),DR.copy(n.boundingSphere),DR.applyMatrix4(i),G8.copy(e.ray).recast(e.near),!(DR.containsPoint(G8.origin)===!1&&(G8.intersectSphere(DR,nge)===null||G8.origin.distanceToSquared(nge)>(e.far-e.near)**2))&&(tge.copy(i).invert(),G8.copy(e.ray).applyMatrix4(tge),!(n.boundingBox!==null&&G8.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,t,G8)))}_computeIntersections(e,t,n){let r;const i=this.geometry,a=this.material,c=i.index,h=i.attributes.position,p=i.attributes.uv,v=i.attributes.uv1,x=i.attributes.normal,S=i.groups,C=i.drawRange;if(c!==null)if(Array.isArray(a))for(let I=0,L=S.length;I<L;I++){const U=S[I],R=a[U.materialIndex],$=Math.max(U.start,C.start),Z=Math.min(c.count,Math.min(U.start+U.count,C.start+C.count));for(let k=$,ie=Z;k<ie;k+=3){const ue=c.getX(k),ce=c.getX(k+1),Q=c.getX(k+2);r=zR(this,R,e,n,p,v,x,ue,ce,Q),r&&(r.faceIndex=Math.floor(k/3),r.face.materialIndex=U.materialIndex,t.push(r))}}else{const I=Math.max(0,C.start),L=Math.min(c.count,C.start+C.count);for(let U=I,R=L;U<R;U+=3){const $=c.getX(U),Z=c.getX(U+1),k=c.getX(U+2);r=zR(this,a,e,n,p,v,x,$,Z,k),r&&(r.faceIndex=Math.floor(U/3),t.push(r))}}else if(h!==void 0)if(Array.isArray(a))for(let I=0,L=S.length;I<L;I++){const U=S[I],R=a[U.materialIndex],$=Math.max(U.start,C.start),Z=Math.min(h.count,Math.min(U.start+U.count,C.start+C.count));for(let k=$,ie=Z;k<ie;k+=3){const ue=k,ce=k+1,Q=k+2;r=zR(this,R,e,n,p,v,x,ue,ce,Q),r&&(r.faceIndex=Math.floor(k/3),r.face.materialIndex=U.materialIndex,t.push(r))}}else{const I=Math.max(0,C.start),L=Math.min(h.count,C.start+C.count);for(let U=I,R=L;U<R;U+=3){const $=U,Z=U+1,k=U+2;r=zR(this,a,e,n,p,v,x,$,Z,k),r&&(r.faceIndex=Math.floor(U/3),t.push(r))}}}}function MBe(o,e,t,n,r,i,a,c){let h;if(e.side===Ec?h=n.intersectTriangle(a,i,r,!0,c):h=n.intersectTriangle(r,i,a,e.side===wg,c),h===null)return null;UR.copy(c),UR.applyMatrix4(o.matrixWorld);const p=t.ray.origin.distanceTo(UR);return p<t.near||p>t.far?null:{distance:p,point:UR.clone(),object:o}}function zR(o,e,t,n,r,i,a,c,h,p){o.getVertexPosition(c,OR),o.getVertexPosition(h,FR),o.getVertexPosition(p,LR);const v=MBe(o,e,t,n,OR,FR,LR,rge);if(v){const x=new yt;uf.getBarycoord(rge,OR,FR,LR,x),r&&(v.uv=uf.getInterpolatedAttribute(r,c,h,p,x,new pi)),i&&(v.uv1=uf.getInterpolatedAttribute(i,c,h,p,x,new pi)),a&&(v.normal=uf.getInterpolatedAttribute(a,c,h,p,x,new yt),v.normal.dot(n.direction)>0&&v.normal.multiplyScalar(-1));const S={a:c,b:h,c:p,normal:new yt,materialIndex:0};uf.getNormal(OR,FR,LR,S.normal),v.face=S,v.barycoord=x}return v}class NW extends oW{constructor(e=-1,t=1,n=1,r=-1,i=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=i,this.far=a,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,i,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let i=n-e,a=n+e,c=r+t,h=r-t;if(this.view!==null&&this.view.enabled){const p=(this.right-this.left)/this.view.fullWidth/this.zoom,v=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i+=p*this.view.offsetX,a=i+p*this.view.width,c-=v*this.view.offsetY,h=c-v*this.view.height}this.projectionMatrix.makeOrthographic(i,a,c,h,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const MV=new NW(-1,1,1,-1,0,1);class CBe extends Bg{constructor(e=!1){super();const t=e===!1?[0,-1,0,1,2,1]:[0,2,0,0,2,0];this.setAttribute("position",new Nl([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new Nl(t,2))}}const ABe=new CBe;class DW extends Og{constructor(e=null){super(ABe,e),this.camera=MV,this.isQuadMesh=!0}async renderAsync(e){return e.renderAsync(this,MV)}render(e){e.render(this,MV)}}const FI=1/6,G4e=o=>Ei(FI,Ei(o,Ei(o,o.negate().add(3)).sub(3)).add(1)),Xj=o=>Ei(FI,Ei(o,Ei(o,Ei(3,o).sub(6))).add(4)),j4e=o=>Ei(FI,Ei(o,Ei(o,Ei(-3,o).add(3)).add(3)).add(1)),Yj=o=>Ei(FI,AI(o,3)),ige=o=>G4e(o).add(Xj(o)),sge=o=>j4e(o).add(Yj(o)),oge=o=>Ol(-1,Xj(o).div(G4e(o).add(Xj(o)))),age=o=>Ol(1,Yj(o).div(j4e(o).add(Yj(o)))),lge=(o,e,t)=>{const n=o.uvNode,r=Ei(n,e.zw).add(.5),i=m6(r),a=n4(r),c=ige(a.x),h=sge(a.x),p=oge(a.x),v=age(a.x),x=oge(a.y),S=age(a.y),C=In(i.x.add(p),i.y.add(x)).sub(.5).mul(e.xy),I=In(i.x.add(v),i.y.add(x)).sub(.5).mul(e.xy),L=In(i.x.add(p),i.y.add(S)).sub(.5).mul(e.xy),U=In(i.x.add(v),i.y.add(S)).sub(.5).mul(e.xy),R=ige(a.y).mul(Ol(c.mul(o.sample(C).level(t)),h.mul(o.sample(I).level(t)))),$=sge(a.y).mul(Ol(c.mul(o.sample(L).level(t)),h.mul(o.sample(U).level(t))));return R.add($)},PBe=cn(([o,e=$t(3)])=>{const t=In(o.size(Fs(e))),n=In(o.size(Fs(e.add(1)))),r=r1(1,t),i=r1(1,n),a=lge(o,ei(r,t),m6(e)),c=lge(o,ei(i,n),_W(e));return n4(e).mix(a,c)}),Sw=new kh,CV=new Ts;class wc extends ti{static get type(){return"SceneNode"}constructor(e=wc.BACKGROUND_BLURRINESS,t=null){super(),this.scope=e,this.scene=t}setup(e){const t=this.scope,n=this.scene!==null?this.scene:e.scene;let r;return t===wc.BACKGROUND_BLURRINESS?r=Es("backgroundBlurriness","float",n):t===wc.BACKGROUND_INTENSITY?r=Es("backgroundIntensity","float",n):t===wc.BACKGROUND_ROTATION?r=Gr("mat4").label("backgroundRotation").setGroup(Vr).onRenderUpdate(()=>{const i=n.background;return i!==null&&i.isTexture&&i.mapping!==YH?(Sw.copy(n.backgroundRotation),Sw.x*=-1,Sw.y*=-1,Sw.z*=-1,CV.makeRotationFromEuler(Sw)):CV.identity(),CV}):console.error("THREE.SceneNode: Unknown scope:",t),r}}wc.BACKGROUND_BLURRINESS="backgroundBlurriness";wc.BACKGROUND_INTENSITY="backgroundIntensity";wc.BACKGROUND_ROTATION="backgroundRotation";const RBe=kn(wc,wc.BACKGROUND_BLURRINESS),cge=kn(wc,wc.BACKGROUND_INTENSITY),kBe=kn(wc,wc.BACKGROUND_ROTATION),IBe=cn(({texture:o,uv:e})=>{const n=Yt().toVar();return Wo(e.x.lessThan(1e-4),()=>{n.assign(Yt(1,0,0))}).ElseIf(e.y.lessThan(1e-4),()=>{n.assign(Yt(0,1,0))}).ElseIf(e.z.lessThan(1e-4),()=>{n.assign(Yt(0,0,1))}).ElseIf(e.x.greaterThan(1-1e-4),()=>{n.assign(Yt(-1,0,0))}).ElseIf(e.y.greaterThan(1-1e-4),()=>{n.assign(Yt(0,-1,0))}).ElseIf(e.z.greaterThan(1-1e-4),()=>{n.assign(Yt(0,0,-1))}).Else(()=>{const i=o.sample(e.add(Yt(-.01,0,0))).r.sub(o.sample(e.add(Yt(.01,0,0))).r),a=o.sample(e.add(Yt(0,-.01,0))).r.sub(o.sample(e.add(Yt(0,.01,0))).r),c=o.sample(e.add(Yt(0,0,-.01))).r.sub(o.sample(e.add(Yt(0,0,.01))).r);n.assign(Yt(i,a,c))}),n.normalize()});class NBe extends ix{static get type(){return"Texture3DNode"}constructor(e,t=null,n=null){super(e,t,n),this.isTexture3DNode=!0}getInputType(){return"texture3D"}getDefaultUV(){return Yt(.5,.5,.5)}setUpdateMatrix(){}setupUV(e,t){const n=this.value;return e.isFlipY()&&(n.isRenderTargetTexture===!0||n.isFramebufferTexture===!0)&&(this.sampler?t=t.flipY():t=t.setY(Fs(R_(this,this.levelNode).y).sub(t.y).sub(1))),t}generateUV(e,t){return t.build(e,"vec3")}normal(e){return IBe({texture:this,uv:e})}}const DBe=un(NBe).setParameterLength(1,3),VR=new pi;class OBe extends ix{static get type(){return"PassTextureNode"}constructor(e,t){super(t),this.passNode=e,this.setUpdateMatrix(!1)}setup(e){return e.object.isQuadMesh&&this.passNode.build(e),super.setup(e)}clone(){return new this.constructor(this.passNode,this.value)}}class uge extends OBe{static get type(){return"PassMultipleTextureNode"}constructor(e,t,n=!1){super(e,null),this.textureName=t,this.previousTexture=n}updateTexture(){this.value=this.previousTexture?this.passNode.getPreviousTexture(this.textureName):this.passNode.getTexture(this.textureName)}setup(e){return this.updateTexture(),super.setup(e)}clone(){return new this.constructor(this.passNode,this.textureName,this.previousTexture)}}class LI extends oa{static get type(){return"PassNode"}constructor(e,t,n,r={}){super("vec4"),this.scope=e,this.scene=t,this.camera=n,this.options=r,this._pixelRatio=1,this._width=1,this._height=1;const i=new t1;i.isRenderTargetTexture=!0,i.name="depth";const a=new C6(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:Mh,...r});a.texture.name="output",a.depthTexture=i,this.renderTarget=a,this._textures={output:a.texture,depth:i},this._textureNodes={},this._linearDepthNodes={},this._viewZNodes={},this._previousTextures={},this._previousTextureNodes={},this._cameraNear=Gr(0),this._cameraFar=Gr(0),this._mrt=null,this._layers=null,this._resolution=1,this.isPassNode=!0,this.updateBeforeType=vi.FRAME,this.global=!0}setResolution(e){return this._resolution=e,this}getResolution(){return this._resolution}setLayers(e){return this._layers=e,this}getLayers(){return this._layers}setMRT(e){return this._mrt=e,this}getMRT(){return this._mrt}getTexture(e){let t=this._textures[e];return t===void 0&&(t=this.renderTarget.texture.clone(),t.name=e,this._textures[e]=t,this.renderTarget.textures.push(t)),t}getPreviousTexture(e){let t=this._previousTextures[e];return t===void 0&&(t=this.getTexture(e).clone(),this._previousTextures[e]=t),t}toggleTexture(e){const t=this._previousTextures[e];if(t!==void 0){const n=this._textures[e],r=this.renderTarget.textures.indexOf(n);this.renderTarget.textures[r]=t,this._textures[e]=t,this._previousTextures[e]=n,this._textureNodes[e].updateTexture(),this._previousTextureNodes[e].updateTexture()}}getTextureNode(e="output"){let t=this._textureNodes[e];return t===void 0&&(t=hn(new uge(this,e)),t.updateTexture(),this._textureNodes[e]=t),t}getPreviousTextureNode(e="output"){let t=this._previousTextureNodes[e];return t===void 0&&(this._textureNodes[e]===void 0&&this.getTextureNode(e),t=hn(new uge(this,e,!0)),t.updateTexture(),this._previousTextureNodes[e]=t),t}getViewZNode(e="depth"){let t=this._viewZNodes[e];if(t===void 0){const n=this._cameraNear,r=this._cameraFar;this._viewZNodes[e]=t=I4e(this.getTextureNode(e),n,r)}return t}getLinearDepthNode(e="depth"){let t=this._linearDepthNodes[e];if(t===void 0){const n=this._cameraNear,r=this._cameraFar,i=this.getViewZNode(e);this._linearDepthNodes[e]=t=lE(i,n,r)}return t}setup({renderer:e}){return this.renderTarget.samples=this.options.samples===void 0?e.samples:this.options.samples,e.backend.isWebGLBackend===!0&&(this.renderTarget.samples=0),this.renderTarget.texture.type=e.getColorBufferType(),this.scope===LI.COLOR?this.getTextureNode():this.getLinearDepthNode()}updateBefore(e){const{renderer:t}=e,{scene:n}=this;let r,i;const a=t.getOutputRenderTarget();a&&a.isXRRenderTarget===!0?(i=1,r=t.xr.getCamera(),t.xr.updateCamera(r),VR.set(a.width,a.height)):(r=this.camera,i=t.getPixelRatio(),t.getSize(VR)),this._pixelRatio=i,this.setSize(VR.width,VR.height);const c=t.getRenderTarget(),h=t.getMRT(),p=r.layers.mask;this._cameraNear.value=r.near,this._cameraFar.value=r.far,this._layers!==null&&(r.layers.mask=this._layers.mask);for(const v in this._previousTextures)this.toggleTexture(v);t.setRenderTarget(this.renderTarget),t.setMRT(this._mrt),t.render(n,r),t.setRenderTarget(c),t.setMRT(h),r.layers.mask=p}setSize(e,t){this._width=e,this._height=t;const n=this._width*this._pixelRatio*this._resolution,r=this._height*this._pixelRatio*this._resolution;this.renderTarget.setSize(n,r)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget.dispose()}}LI.COLOR="color";LI.DEPTH="depth";const FBe=cn(([o,e])=>o.mul(e).clamp()).setLayout({name:"linearToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),LBe=cn(([o,e])=>(o=o.mul(e),o.div(o.add(1)).clamp())).setLayout({name:"reinhardToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),BBe=cn(([o,e])=>{o=o.mul(e),o=o.sub(.004).max(0);const t=o.mul(o.mul(6.2).add(.5)),n=o.mul(o.mul(6.2).add(1.7)).add(.06);return t.div(n).pow(2.2)}).setLayout({name:"cineonToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),UBe=cn(([o])=>{const e=o.mul(o.add(.0245786)).sub(90537e-9),t=o.mul(o.add(.432951).mul(.983729)).add(.238081);return e.div(t)}),zBe=cn(([o,e])=>{const t=Dl(.59719,.35458,.04823,.076,.90834,.01566,.0284,.13383,.83777),n=Dl(1.60475,-.53108,-.07367,-.10208,1.10813,-.00605,-.00327,-.07276,1.07602);return o=o.mul(e).div(.6),o=t.mul(o),o=UBe(o),o=n.mul(o),o.clamp()}).setLayout({name:"acesFilmicToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),VBe=Dl(Yt(1.6605,-.1246,-.0182),Yt(-.5876,1.1329,-.1006),Yt(-.0728,-.0083,1.1187)),GBe=Dl(Yt(.6274,.0691,.0164),Yt(.3293,.9195,.088),Yt(.0433,.0113,.8956)),jBe=cn(([o])=>{const e=Yt(o).toVar(),t=Yt(e.mul(e)).toVar(),n=Yt(t.mul(t)).toVar();return $t(15.5).mul(n.mul(t)).sub(Ei(40.14,n.mul(e))).add(Ei(31.96,n).sub(Ei(6.868,t.mul(e))).add(Ei(.4298,t).add(Ei(.1191,e).sub(.00232))))}),HBe=cn(([o,e])=>{const t=Yt(o).toVar(),n=Dl(Yt(.856627153315983,.137318972929847,.11189821299995),Yt(.0951212405381588,.761241990602591,.0767994186031903),Yt(.0482516061458583,.101439036467562,.811302368396859)),r=Dl(Yt(1.1271005818144368,-.1413297634984383,-.14132976349843826),Yt(-.11060664309660323,1.157823702216272,-.11060664309660294),Yt(-.016493938717834573,-.016493938717834257,1.2519364065950405)),i=$t(-12.47393),a=$t(4.026069);return t.mulAssign(e),t.assign(GBe.mul(t)),t.assign(n.mul(t)),t.assign(W0(t,1e-10)),t.assign(Ag(t)),t.assign(t.sub(i).div(a.sub(i))),t.assign(Dg(t,0,1)),t.assign(jBe(t)),t.assign(r.mul(t)),t.assign(AI(W0(Yt(0),t),Yt(2.2))),t.assign(VBe.mul(t)),t.assign(Dg(t,0,1)),t}).setLayout({name:"agxToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),WBe=cn(([o,e])=>{const t=$t(.76),n=$t(.15);o=o.mul(e);const r=H_(o.r,H_(o.g,o.b)),i=G0(r.lessThan(.08),r.sub(Ei(6.25,r.mul(r))),.04);o.subAssign(i);const a=W0(o.r,W0(o.g,o.b));Wo(a.lessThan(t),()=>o);const c=Rl(1,t),h=Rl(1,c.mul(c).div(a.add(c.sub(t))));o.mulAssign(h.div(a));const p=Rl(1,r1(1,n.mul(a.sub(h)).add(1)));return Zs(o,Yt(h),p)}).setLayout({name:"neutralToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]});class ga extends ti{static get type(){return"CodeNode"}constructor(e="",t=[],n=""){super("code"),this.isCodeNode=!0,this.global=!0,this.code=e,this.includes=t,this.language=n}setIncludes(e){return this.includes=e,this}getIncludes(){return this.includes}generate(e){const t=this.getIncludes(e);for(const r of t)r.build(e);const n=e.getCodeFromNode(this,this.getNodeType(e));return n.code=this.code,n.code}serialize(e){super.serialize(e),e.code=this.code,e.language=this.language}deserialize(e){super.deserialize(e),this.code=e.code,this.language=e.language}}class $Be extends ga{static get type(){return"FunctionNode"}constructor(e="",t=[],n=""){super(e,t,n)}getNodeType(e){return this.getNodeFunction(e).type}getInputs(e){return this.getNodeFunction(e).inputs}getNodeFunction(e){const t=e.getDataFromNode(this);let n=t.nodeFunction;return n===void 0&&(n=e.parser.parseFunction(this.code),t.nodeFunction=n),n}generate(e,t){super.generate(e);const n=this.getNodeFunction(e),r=n.name,i=n.type,a=e.getCodeFromNode(this,i);r!==""&&(a.name=r);const c=e.getPropertyName(a),h=this.getNodeFunction(e).getCode(c);return a.code=h+`
`,t==="property"?c:e.format(`${c}()`,i,t)}}function H4e(o){let e;const t=o.context.getViewZ;return t!==void 0&&(e=t(this)),(e||ia.z).negate()}const qBe=cn(([o,e],t)=>{const n=H4e(t);return Z3(o,e,n)}),XBe=cn(([o],e)=>{const t=H4e(e);return o.mul(o,t,t).negate().exp().oneMinus()}),hge=cn(([o,e])=>ei(e.toFloat().mix(oE.rgb,o.toVec3()),oE.a));class YBe extends ti{constructor(e){super(),this.scope=e}generate(e){const{scope:t}=this,{renderer:n}=e;n.backend.isWebGLBackend===!0?e.addFlowCode(`	// ${t}Barrier 
`):e.addLineFlowCode(`${t}Barrier()`,this)}}un(YBe);class o1 extends ti{static get type(){return"AtomicFunctionNode"}constructor(e,t,n){super("uint"),this.method=e,this.pointerNode=t,this.valueNode=n,this.parents=!0}getInputType(e){return this.pointerNode.getNodeType(e)}getNodeType(e){return this.getInputType(e)}generate(e){const t=e.getNodeProperties(this),n=t.parents,r=this.method,i=this.getNodeType(e),a=this.getInputType(e),c=this.pointerNode,h=this.valueNode,p=[];p.push(`&${c.build(e,a)}`),h!==null&&p.push(h.build(e,a));const v=`${e.getMethod(r,i)}( ${p.join(", ")} )`;if(n.length===1&&n[0].isStackNode===!0)e.addLineFlowCode(v,this);else return t.constNode===void 0&&(t.constNode=W_(v,i).toConst()),t.constNode.build(e)}}o1.ATOMIC_LOAD="atomicLoad";o1.ATOMIC_STORE="atomicStore";o1.ATOMIC_ADD="atomicAdd";o1.ATOMIC_SUB="atomicSub";o1.ATOMIC_MAX="atomicMax";o1.ATOMIC_MIN="atomicMin";o1.ATOMIC_AND="atomicAnd";o1.ATOMIC_OR="atomicOr";o1.ATOMIC_XOR="atomicXor";un(o1);let GR;function BI(o){GR=GR||new WeakMap;let e=GR.get(o);return e===void 0&&GR.set(o,e={}),e}function W4e(o){const e=BI(o);return e.shadowMatrix||(e.shadowMatrix=Gr("mat4").setGroup(Vr).onRenderUpdate(t=>((o.castShadow!==!0||t.renderer.shadowMap.enabled===!1)&&o.shadow.updateMatrices(o),o.shadow.matrix)))}function KBe(o,e=PE){const t=W4e(o).mul(e);return t.xyz.div(t.w)}function $4e(o){const e=BI(o);return e.position||(e.position=Gr(new yt).setGroup(Vr).onRenderUpdate((t,n)=>n.value.setFromMatrixPosition(o.matrixWorld)))}function ZBe(o){const e=BI(o);return e.targetPosition||(e.targetPosition=Gr(new yt).setGroup(Vr).onRenderUpdate((t,n)=>n.value.setFromMatrixPosition(o.target.matrixWorld)))}function q4e(o){const e=BI(o);return e.viewPosition||(e.viewPosition=Gr(new yt).setGroup(Vr).onRenderUpdate(({camera:t},n)=>{n.value=n.value||new yt,n.value.setFromMatrixPosition(o.matrixWorld),n.value.applyMatrix4(t.matrixWorldInverse)}))}const X4e=o=>Lg.transformDirection($4e(o).sub(ZBe(o))),QBe=o=>o.sort((e,t)=>e.id-t.id),JBe=(o,e)=>{for(const t of e)if(t.isAnalyticLightNode&&t.light.id===o)return t;return null},AV=new WeakMap,ww=[];class Y4e extends ti{static get type(){return"LightsNode"}constructor(){super("vec3"),this.totalDiffuseNode=Yt().toVar(),this.totalSpecularNode=Yt().toVar(),this.outgoingLightNode=Yt().toVar(),this._lights=[],this._lightNodes=null,this._lightNodesHash=null,this.global=!0}customCacheKey(){const e=this._lights;for(let n=0;n<e.length;n++){const r=e[n];if(ww.push(r.id),ww.push(r.castShadow?1:0),r.isSpotLight===!0){const i=r.map!==null?r.map.id:-1,a=r.colorNode?r.colorNode.getCacheKey():-1;ww.push(i,a)}}const t=iW(ww);return ww.length=0,t}getHash(e){if(this._lightNodesHash===null){this._lightNodes===null&&this.setupLightsNode(e);const t=[];for(const n of this._lightNodes)t.push(n.getSelf().getHash());this._lightNodesHash="lights-"+t.join(",")}return this._lightNodesHash}analyze(e){const t=e.getNodeProperties(this);for(const n of t.nodes)n.build(e);t.outputNode.build(e)}setupLightsNode(e){const t=[],n=this._lightNodes,r=QBe(this._lights),i=e.renderer.library;for(const a of r)if(a.isNode)t.push(hn(a));else{let c=null;if(n!==null&&(c=JBe(a.id,n)),c===null){const h=i.getLightNodeClass(a.constructor);if(h===null){console.warn(`LightsNode.setupNodeLights: Light node not found for ${a.constructor.name}`);continue}let p=null;AV.has(a)?p=AV.get(a):(p=hn(new h(a)),AV.set(a,p)),t.push(p)}}this._lightNodes=t}setupDirectLight(e,t,n){const{lightingModel:r,reflectedLight:i}=e.context;r.direct({...n,lightNode:t,reflectedLight:i},e)}setupDirectRectAreaLight(e,t,n){const{lightingModel:r,reflectedLight:i}=e.context;r.directRectArea({...n,lightNode:t,reflectedLight:i},e)}setupLights(e,t){for(const n of t)n.build(e)}getLightNodes(e){return this._lightNodes===null&&this.setupLightsNode(e),this._lightNodes}setup(e){const t=e.lightsNode;e.lightsNode=this;let n=this.outgoingLightNode;const r=e.context,i=r.lightingModel,a=e.getNodeProperties(this);if(i){const{totalDiffuseNode:c,totalSpecularNode:h}=this;r.outgoingLight=n;const p=e.addStack();a.nodes=p.nodes,i.start(e);const{backdrop:v,backdropAlpha:x}=r,{directDiffuse:S,directSpecular:C,indirectDiffuse:I,indirectSpecular:L}=r.reflectedLight;let U=S.add(I);v!==null&&(x!==null?U=Yt(x.mix(U,v)):U=Yt(v),r.material.transparent=!0),c.assign(U),h.assign(C.add(L)),n.assign(c.add(h)),i.finish(e),n=n.bypass(e.removeStack())}else a.nodes=[];return e.lightsNode=t,n}setLights(e){return this._lights=e,this._lightNodes=null,this._lightNodesHash=null,this}getLights(){return this._lights}get hasLights(){return this._lights.length>0}}class eUe extends ti{static get type(){return"ShadowBaseNode"}constructor(e){super(),this.light=e,this.updateBeforeType=vi.RENDER,this.isShadowBaseNode=!0}setupShadowPosition({context:e,material:t}){K4e.assign(t.receivedShadowPositionNode||e.shadowPositionWorld||PE)}}const K4e=Y3e("vec3","shadowPositionWorld");function tUe(o,e={}){return e.toneMapping=o.toneMapping,e.toneMappingExposure=o.toneMappingExposure,e.outputColorSpace=o.outputColorSpace,e.renderTarget=o.getRenderTarget(),e.activeCubeFace=o.getActiveCubeFace(),e.activeMipmapLevel=o.getActiveMipmapLevel(),e.renderObjectFunction=o.getRenderObjectFunction(),e.pixelRatio=o.getPixelRatio(),e.mrt=o.getMRT(),e.clearColor=o.getClearColor(e.clearColor||new qi),e.clearAlpha=o.getClearAlpha(),e.autoClear=o.autoClear,e.scissorTest=o.getScissorTest(),e}function nUe(o,e){return e=tUe(o,e),o.setMRT(null),o.setRenderObjectFunction(null),o.setClearColor(0,1),o.autoClear=!0,e}function rUe(o,e){o.toneMapping=e.toneMapping,o.toneMappingExposure=e.toneMappingExposure,o.outputColorSpace=e.outputColorSpace,o.setRenderTarget(e.renderTarget,e.activeCubeFace,e.activeMipmapLevel),o.setRenderObjectFunction(e.renderObjectFunction),o.setPixelRatio(e.pixelRatio),o.setMRT(e.mrt),o.setClearColor(e.clearColor,e.clearAlpha),o.autoClear=e.autoClear,o.setScissorTest(e.scissorTest)}function iUe(o,e={}){return e.background=o.background,e.backgroundNode=o.backgroundNode,e.overrideMaterial=o.overrideMaterial,e}function sUe(o,e){return e=iUe(o,e),o.background=null,o.backgroundNode=null,o.overrideMaterial=null,e}function oUe(o,e){o.background=e.background,o.backgroundNode=e.backgroundNode,o.overrideMaterial=e.overrideMaterial}function aUe(o,e,t){return t=nUe(o,t),t=sUe(e,t),t}function lUe(o,e,t){rUe(o,t),oUe(e,t)}const dge=new WeakMap,cUe=cn(({depthTexture:o,shadowCoord:e,depthLayer:t})=>{let n=Vi(o,e.xy).label("t_basic");return o.isArrayTexture&&(n=n.depth(t)),n.compare(e.z)}),uUe=cn(({depthTexture:o,shadowCoord:e,shadow:t,depthLayer:n})=>{const r=(U,R)=>{let $=Vi(o,U);return o.isArrayTexture&&($=$.depth(n)),$.compare(R)},i=Es("mapSize","vec2",t).setGroup(Vr),a=Es("radius","float",t).setGroup(Vr),c=In(1).div(i),h=c.x.negate().mul(a),p=c.y.negate().mul(a),v=c.x.mul(a),x=c.y.mul(a),S=h.div(2),C=p.div(2),I=v.div(2),L=x.div(2);return Ol(r(e.xy.add(In(h,p)),e.z),r(e.xy.add(In(0,p)),e.z),r(e.xy.add(In(v,p)),e.z),r(e.xy.add(In(S,C)),e.z),r(e.xy.add(In(0,C)),e.z),r(e.xy.add(In(I,C)),e.z),r(e.xy.add(In(h,0)),e.z),r(e.xy.add(In(S,0)),e.z),r(e.xy,e.z),r(e.xy.add(In(I,0)),e.z),r(e.xy.add(In(v,0)),e.z),r(e.xy.add(In(S,L)),e.z),r(e.xy.add(In(0,L)),e.z),r(e.xy.add(In(I,L)),e.z),r(e.xy.add(In(h,x)),e.z),r(e.xy.add(In(0,x)),e.z),r(e.xy.add(In(v,x)),e.z)).mul(1/17)}),hUe=cn(({depthTexture:o,shadowCoord:e,shadow:t,depthLayer:n})=>{const r=(x,S)=>{let C=Vi(o,x);return o.isArrayTexture&&(C=C.depth(n)),C.compare(S)},i=Es("mapSize","vec2",t).setGroup(Vr),a=In(1).div(i),c=a.x,h=a.y,p=e.xy,v=n4(p.mul(i).add(.5));return p.subAssign(v.mul(a)),Ol(r(p,e.z),r(p.add(In(c,0)),e.z),r(p.add(In(0,h)),e.z),r(p.add(a),e.z),Zs(r(p.add(In(c.negate(),0)),e.z),r(p.add(In(c.mul(2),0)),e.z),v.x),Zs(r(p.add(In(c.negate(),h)),e.z),r(p.add(In(c.mul(2),h)),e.z),v.x),Zs(r(p.add(In(0,h.negate())),e.z),r(p.add(In(0,h.mul(2))),e.z),v.y),Zs(r(p.add(In(c,h.negate())),e.z),r(p.add(In(c,h.mul(2))),e.z),v.y),Zs(Zs(r(p.add(In(c.negate(),h.negate())),e.z),r(p.add(In(c.mul(2),h.negate())),e.z),v.x),Zs(r(p.add(In(c.negate(),h.mul(2))),e.z),r(p.add(In(c.mul(2),h.mul(2))),e.z),v.x),v.y)).mul(1/9)}),dUe=cn(({depthTexture:o,shadowCoord:e,depthLayer:t})=>{const n=$t(1).toVar();let r=Vi(o).sample(e.xy);o.isArrayTexture&&(r=r.depth(t)),r=r.rg;const i=c4e(e.z,r.x);return Wo(i.notEqual($t(1)),()=>{const a=e.z.sub(r.x),c=W0(0,r.y.mul(r.y));let h=c.div(c.add(a.mul(a)));h=Dg(Rl(h,.3).div(.95-.3)),n.assign(Dg(W0(i,h)))}),n}),fUe=cn(([o,e,t])=>{let n=PE.sub(o).length();return n=n.sub(e).div(t.sub(e)),n=n.saturate(),n}),pUe=o=>{const e=o.shadow.camera,t=Es("near","float",e).setGroup(Vr),n=Es("far","float",e).setGroup(Vr),r=CFe(o);return fUe(r,t,n)},mUe=o=>{let e=dge.get(o);if(e===void 0){const t=o.isPointLight?pUe(o):null;e=new sa,e.colorNode=ei(0,0,0,1),e.depthNode=t,e.isShadowPassMaterial=!0,e.name="ShadowMaterial",e.fog=!1,dge.set(o,e)}return e},fge=new mf,H7=[],gUe=(o,e,t,n)=>{H7[0]=o,H7[1]=e;let r=fge.get(H7);return(r===void 0||r.shadowType!==t||r.useVelocity!==n)&&(r=(i,a,c,h,p,v,...x)=>{(i.castShadow===!0||i.receiveShadow&&t===Sk)&&(n&&(D3e(i).useVelocity=!0),i.onBeforeShadow(o,i,c,e.camera,h,a.overrideMaterial,v),o.renderObject(i,a,c,h,p,v,...x),i.onAfterShadow(o,i,c,e.camera,h,a.overrideMaterial,v))},r.shadowType=t,r.useVelocity=n,fge.set(H7,r)),H7[0]=null,H7[1]=null,r},yUe=cn(({samples:o,radius:e,size:t,shadowPass:n,depthLayer:r})=>{const i=$t(0).toVar("meanVertical"),a=$t(0).toVar("squareMeanVertical"),c=o.lessThanEqual($t(1)).select($t(0),$t(2).div(o.sub(1))),h=o.lessThanEqual($t(1)).select($t(0),$t(-1));cf({start:Fs(0),end:Fs(o),type:"int",condition:"<"},({i:v})=>{const x=h.add($t(v).mul(c));let S=n.sample(Ol(DI.xy,In(0,x).mul(e)).div(t));n.value.isArrayTexture&&(S=S.depth(r)),S=S.x,i.addAssign(S),a.addAssign(S.mul(S))}),i.divAssign(o),a.divAssign(o);const p=vW(a.sub(i.mul(i)));return In(i,p)}),vUe=cn(({samples:o,radius:e,size:t,shadowPass:n,depthLayer:r})=>{const i=$t(0).toVar("meanHorizontal"),a=$t(0).toVar("squareMeanHorizontal"),c=o.lessThanEqual($t(1)).select($t(0),$t(2).div(o.sub(1))),h=o.lessThanEqual($t(1)).select($t(0),$t(-1));cf({start:Fs(0),end:Fs(o),type:"int",condition:"<"},({i:v})=>{const x=h.add($t(v).mul(c));let S=n.sample(Ol(DI.xy,In(x,0).mul(e)).div(t));n.value.isArrayTexture&&(S=S.depth(r)),i.addAssign(S.x),a.addAssign(Ol(S.y.mul(S.y),S.x.mul(S.x)))}),i.divAssign(o),a.divAssign(o);const p=vW(a.sub(i.mul(i)));return In(i,p)}),_Ue=[cUe,uUe,hUe,dUe];let PV;const jR=new DW;class Z4e extends eUe{static get type(){return"ShadowNode"}constructor(e,t=null){super(e),this.shadow=t||e.shadow,this.shadowMap=null,this.vsmShadowMapVertical=null,this.vsmShadowMapHorizontal=null,this.vsmMaterialVertical=null,this.vsmMaterialHorizontal=null,this._node=null,this._cameraFrameId=new WeakMap,this.isShadowNode=!0,this.depthLayer=0}setupShadowFilter(e,{filterFn:t,depthTexture:n,shadowCoord:r,shadow:i,depthLayer:a}){const c=r.x.greaterThanEqual(0).and(r.x.lessThanEqual(1)).and(r.y.greaterThanEqual(0)).and(r.y.lessThanEqual(1)).and(r.z.lessThanEqual(1)),h=t({depthTexture:n,shadowCoord:r,shadow:i,depthLayer:a});return c.select(h,$t(1))}setupShadowCoord(e,t){const{shadow:n}=this,{renderer:r}=e,i=Es("bias","float",n).setGroup(Vr);let a=t,c;if(n.camera.isOrthographicCamera||r.logarithmicDepthBuffer!==!0)a=a.xyz.div(a.w),c=a.z,r.coordinateSystem===K3&&(c=c.mul(2).sub(1));else{const h=a.w;a=a.xy.div(h);const p=Es("near","float",n.camera).setGroup(Vr),v=Es("far","float",n.camera).setGroup(Vr);c=N4e(h.negate(),p,v)}return a=Yt(a.x,a.y.oneMinus(),c.add(i)),a}getShadowFilterFn(e){return _Ue[e]}setupRenderTarget(e,t){const n=new t1(e.mapSize.width,e.mapSize.height);n.name="ShadowDepthTexture",n.compareFunction=rW;const r=t.createRenderTarget(e.mapSize.width,e.mapSize.height);return r.texture.name="ShadowMap",r.texture.type=e.mapType,r.depthTexture=n,{shadowMap:r,depthTexture:n}}setupShadow(e){const{renderer:t}=e,{light:n,shadow:r}=this,i=t.shadowMap.type,{depthTexture:a,shadowMap:c}=this.setupRenderTarget(r,e);if(r.camera.updateProjectionMatrix(),i===Sk&&r.isPointLightShadow!==!0){a.compareFunction=null,c.depth>1?(c._vsmShadowMapVertical||(c._vsmShadowMapVertical=e.createRenderTarget(r.mapSize.width,r.mapSize.height,{format:f6,type:Mh,depth:c.depth,depthBuffer:!1}),c._vsmShadowMapVertical.texture.name="VSMVertical"),this.vsmShadowMapVertical=c._vsmShadowMapVertical,c._vsmShadowMapHorizontal||(c._vsmShadowMapHorizontal=e.createRenderTarget(r.mapSize.width,r.mapSize.height,{format:f6,type:Mh,depth:c.depth,depthBuffer:!1}),c._vsmShadowMapHorizontal.texture.name="VSMHorizontal"),this.vsmShadowMapHorizontal=c._vsmShadowMapHorizontal):(this.vsmShadowMapVertical=e.createRenderTarget(r.mapSize.width,r.mapSize.height,{format:f6,type:Mh,depthBuffer:!1}),this.vsmShadowMapHorizontal=e.createRenderTarget(r.mapSize.width,r.mapSize.height,{format:f6,type:Mh,depthBuffer:!1}));let R=Vi(a);a.isArrayTexture&&(R=R.depth(this.depthLayer));let $=Vi(this.vsmShadowMapVertical.texture);a.isArrayTexture&&($=$.depth(this.depthLayer));const Z=Es("blurSamples","float",r).setGroup(Vr),k=Es("radius","float",r).setGroup(Vr),ie=Es("mapSize","vec2",r).setGroup(Vr);let ue=this.vsmMaterialVertical||(this.vsmMaterialVertical=new sa);ue.fragmentNode=yUe({samples:Z,radius:k,size:ie,shadowPass:R,depthLayer:this.depthLayer}).context(e.getSharedContext()),ue.name="VSMVertical",ue=this.vsmMaterialHorizontal||(this.vsmMaterialHorizontal=new sa),ue.fragmentNode=vUe({samples:Z,radius:k,size:ie,shadowPass:$,depthLayer:this.depthLayer}).context(e.getSharedContext()),ue.name="VSMHorizontal"}const h=Es("intensity","float",r).setGroup(Vr),p=Es("normalBias","float",r).setGroup(Vr),v=W4e(n).mul(K4e.add(RW.mul(p))),x=this.setupShadowCoord(e,v),S=r.filterNode||this.getShadowFilterFn(t.shadowMap.type)||null;if(S===null)throw new Error("THREE.WebGPURenderer: Shadow map type not supported yet.");const C=i===Sk&&r.isPointLightShadow!==!0?this.vsmShadowMapHorizontal.texture:a,I=this.setupShadowFilter(e,{filterFn:S,shadowTexture:c.texture,depthTexture:C,shadowCoord:x,shadow:r,depthLayer:this.depthLayer});let L=Vi(c.texture,x);a.isArrayTexture&&(L=L.depth(this.depthLayer));const U=Zs(1,I.rgb.mix(L,1),h.mul(L.a)).toVar();return this.shadowMap=c,this.shadow.map=c,U}setup(e){if(e.renderer.shadowMap.enabled!==!1)return cn(()=>{let t=this._node;return this.setupShadowPosition(e),t===null&&(this._node=t=this.setupShadow(e)),e.material.shadowNode&&console.warn('THREE.NodeMaterial: ".shadowNode" is deprecated. Use ".castShadowNode" instead.'),e.material.receivedShadowNode&&(t=e.material.receivedShadowNode(t)),t})()}renderShadow(e){const{shadow:t,shadowMap:n,light:r}=this,{renderer:i,scene:a}=e;t.updateMatrices(r),n.setSize(t.mapSize.width,t.mapSize.height,n.depth),i.render(a,t.camera)}updateShadow(e){const{shadowMap:t,light:n,shadow:r}=this,{renderer:i,scene:a,camera:c}=e,h=i.shadowMap.type,p=t.depthTexture.version;this._depthVersionCached=p;const v=r.camera.layers.mask;(r.camera.layers.mask&4294967294)===0&&(r.camera.layers.mask=c.layers.mask);const x=i.getRenderObjectFunction(),S=i.getMRT(),C=S?S.has("velocity"):!1;PV=aUe(i,a,PV),a.overrideMaterial=mUe(n),i.setRenderObjectFunction(gUe(i,r,h,C)),i.setClearColor(0,0),i.setRenderTarget(t),this.renderShadow(e),i.setRenderObjectFunction(x),h===Sk&&r.isPointLightShadow!==!0&&this.vsmPass(i),r.camera.layers.mask=v,lUe(i,a,PV)}vsmPass(e){const{shadow:t}=this,n=this.shadowMap.depth;this.vsmShadowMapVertical.setSize(t.mapSize.width,t.mapSize.height,n),this.vsmShadowMapHorizontal.setSize(t.mapSize.width,t.mapSize.height,n),e.setRenderTarget(this.vsmShadowMapVertical),jR.material=this.vsmMaterialVertical,jR.render(e),e.setRenderTarget(this.vsmShadowMapHorizontal),jR.material=this.vsmMaterialHorizontal,jR.render(e)}dispose(){this.shadowMap.dispose(),this.shadowMap=null,this.vsmShadowMapVertical!==null&&(this.vsmShadowMapVertical.dispose(),this.vsmShadowMapVertical=null,this.vsmMaterialVertical.dispose(),this.vsmMaterialVertical=null),this.vsmShadowMapHorizontal!==null&&(this.vsmShadowMapHorizontal.dispose(),this.vsmShadowMapHorizontal=null,this.vsmMaterialHorizontal.dispose(),this.vsmMaterialHorizontal=null),super.dispose()}updateBefore(e){const{shadow:t}=this;let n=t.needsUpdate||t.autoUpdate;n&&(this._cameraFrameId[e.camera]===e.frameId&&(n=!1),this._cameraFrameId[e.camera]=e.frameId),n&&(this.updateShadow(e),this.shadowMap.depthTexture.version===this._depthVersionCached&&(t.needsUpdate=!1))}}const xUe=(o,e)=>hn(new Z4e(o,e)),bUe=new qi,$p=cn(([o,e])=>{const t=o.toVar(),n=Sh(t),r=r1(1,W0(n.x,W0(n.y,n.z)));n.mulAssign(r),t.mulAssign(r.mul(e.mul(2).oneMinus()));const i=In(t.xy).toVar(),c=e.mul(1.5).oneMinus();return Wo(n.z.greaterThanEqual(c),()=>{Wo(t.z.greaterThan(0),()=>{i.x.assign(Rl(4,t.x))})}).ElseIf(n.x.greaterThanEqual(c),()=>{const h=cI(t.x);i.x.assign(t.z.mul(h).add(h.mul(2)))}).ElseIf(n.y.greaterThanEqual(c),()=>{const h=cI(t.y);i.x.assign(t.x.add(h.mul(2)).add(2)),i.y.assign(t.z.mul(h).sub(2))}),In(.125,.25).mul(i).add(In(.375,.75)).flipY()}).setLayout({name:"cubeToUV",type:"vec2",inputs:[{name:"pos",type:"vec3"},{name:"texelSizeY",type:"float"}]}),SUe=cn(({depthTexture:o,bd3D:e,dp:t,texelSize:n})=>Vi(o,$p(e,n.y)).compare(t)),wUe=cn(({depthTexture:o,bd3D:e,dp:t,texelSize:n,shadow:r})=>{const i=Es("radius","float",r).setGroup(Vr),a=In(-1,1).mul(i).mul(n.y);return Vi(o,$p(e.add(a.xyy),n.y)).compare(t).add(Vi(o,$p(e.add(a.yyy),n.y)).compare(t)).add(Vi(o,$p(e.add(a.xyx),n.y)).compare(t)).add(Vi(o,$p(e.add(a.yyx),n.y)).compare(t)).add(Vi(o,$p(e,n.y)).compare(t)).add(Vi(o,$p(e.add(a.xxy),n.y)).compare(t)).add(Vi(o,$p(e.add(a.yxy),n.y)).compare(t)).add(Vi(o,$p(e.add(a.xxx),n.y)).compare(t)).add(Vi(o,$p(e.add(a.yxx),n.y)).compare(t)).mul(1/9)}),EUe=cn(({filterFn:o,depthTexture:e,shadowCoord:t,shadow:n})=>{const r=t.xyz.toVar(),i=r.length(),a=Gr("float").setGroup(Vr).onRenderUpdate(()=>n.camera.near),c=Gr("float").setGroup(Vr).onRenderUpdate(()=>n.camera.far),h=Es("bias","float",n).setGroup(Vr),p=Gr(n.mapSize).setGroup(Vr),v=$t(1).toVar();return Wo(i.sub(c).lessThanEqual(0).and(i.sub(a).greaterThanEqual(0)),()=>{const x=i.sub(a).div(c.sub(a)).toVar();x.addAssign(h);const S=r.normalize(),C=In(1).div(p.mul(In(4,2)));v.assign(o({depthTexture:e,bd3D:S,dp:x,texelSize:C,shadow:n}))}),v}),pge=new Ri,W7=new pi,Ew=new pi;class TUe extends Z4e{static get type(){return"PointShadowNode"}constructor(e,t=null){super(e,t)}getShadowFilterFn(e){return e===FIe?SUe:wUe}setupShadowCoord(e,t){return t}setupShadowFilter(e,{filterFn:t,shadowTexture:n,depthTexture:r,shadowCoord:i,shadow:a}){return EUe({filterFn:t,shadowTexture:n,depthTexture:r,shadowCoord:i,shadow:a})}renderShadow(e){const{shadow:t,shadowMap:n,light:r}=this,{renderer:i,scene:a}=e,c=t.getFrameExtents();Ew.copy(t.mapSize),Ew.multiply(c),n.setSize(Ew.width,Ew.height),W7.copy(t.mapSize);const h=i.autoClear,p=i.getClearColor(bUe),v=i.getClearAlpha();i.autoClear=!1,i.setClearColor(t.clearColor,t.clearAlpha),i.clear();const x=t.getViewportCount();for(let S=0;S<x;S++){const C=t.getViewport(S),I=W7.x*C.x,L=Ew.y-W7.y-W7.y*C.y;pge.set(I,L,W7.x*C.z,W7.y*C.w),n.viewport.copy(pge),t.updateMatrices(r,S),i.render(a,t.camera)}i.autoClear=h,i.setClearColor(p,v)}}const MUe=(o,e)=>hn(new TUe(o,e));class A6 extends sx{static get type(){return"AnalyticLightNode"}constructor(e=null){super(),this.light=e,this.color=new qi,this.colorNode=e&&e.colorNode||Gr(this.color).setGroup(Vr),this.baseColorNode=null,this.shadowNode=null,this.shadowColorNode=null,this.isAnalyticLightNode=!0,this.updateType=vi.FRAME}getHash(){return this.light.uuid}getLightVector(e){return q4e(this.light).sub(e.context.positionView||ia)}setupDirect(){}setupDirectRectArea(){}setupShadowNode(){return xUe(this.light)}setupShadow(e){const{renderer:t}=e;if(t.shadowMap.enabled===!1)return;let n=this.shadowColorNode;if(n===null){const r=this.light.shadow.shadowNode;let i;r!==void 0?i=hn(r):i=this.setupShadowNode(),this.shadowNode=i,this.shadowColorNode=n=this.colorNode.mul(i),this.baseColorNode=this.colorNode}this.colorNode=n}setup(e){this.colorNode=this.baseColorNode||this.colorNode,this.light.castShadow?e.object.receiveShadow&&this.setupShadow(e):this.shadowNode!==null&&(this.shadowNode.dispose(),this.shadowNode=null,this.shadowColorNode=null);const t=this.setupDirect(e),n=this.setupDirectRectArea(e);t&&e.lightsNode.setupDirectLight(e,this,t),n&&e.lightsNode.setupDirectRectAreaLight(e,this,n)}update(){const{light:e}=this;this.color.copy(e.color).multiplyScalar(e.intensity)}}const Q4e=cn(({lightDistance:o,cutoffDistance:e,decayExponent:t})=>{const n=o.pow(t).max(.01).reciprocal();return e.greaterThan(0).select(n.mul(o.div(e).pow4().oneMinus().clamp().pow2()),n)}),CUe=({color:o,lightVector:e,cutoffDistance:t,decayExponent:n})=>{const r=e.normalize(),i=e.length(),a=Q4e({lightDistance:i,cutoffDistance:t,decayExponent:n}),c=o.mul(a);return{lightDirection:r,lightColor:c}};class AUe extends A6{static get type(){return"PointLightNode"}constructor(e=null){super(e),this.cutoffDistanceNode=Gr(0).setGroup(Vr),this.decayExponentNode=Gr(2).setGroup(Vr)}update(e){const{light:t}=this;super.update(e),this.cutoffDistanceNode.value=t.distance,this.decayExponentNode.value=t.decay}setupShadowNode(){return MUe(this.light)}setupDirect(e){return CUe({color:this.colorNode,lightVector:this.getLightVector(e),cutoffDistance:this.cutoffDistanceNode,decayExponent:this.decayExponentNode})}}const mge=$t(1),Kj=$t(-2),HR=$t(.8),RV=$t(-1),WR=$t(.4),kV=$t(2),$R=$t(.305),IV=$t(3),gge=$t(.21),PUe=$t(4),yge=$t(4),RUe=$t(16),kUe=cn(([o])=>{const e=Yt(Sh(o)).toVar(),t=$t(-1).toVar();return Wo(e.x.greaterThan(e.z),()=>{Wo(e.x.greaterThan(e.y),()=>{t.assign(G0(o.x.greaterThan(0),0,3))}).Else(()=>{t.assign(G0(o.y.greaterThan(0),1,4))})}).Else(()=>{Wo(e.z.greaterThan(e.y),()=>{t.assign(G0(o.z.greaterThan(0),2,5))}).Else(()=>{t.assign(G0(o.y.greaterThan(0),1,4))})}),t}).setLayout({name:"getFace",type:"float",inputs:[{name:"direction",type:"vec3"}]}),IUe=cn(([o,e])=>{const t=In().toVar();return Wo(e.equal(0),()=>{t.assign(In(o.z,o.y).div(Sh(o.x)))}).ElseIf(e.equal(1),()=>{t.assign(In(o.x.negate(),o.z.negate()).div(Sh(o.y)))}).ElseIf(e.equal(2),()=>{t.assign(In(o.x.negate(),o.y).div(Sh(o.z)))}).ElseIf(e.equal(3),()=>{t.assign(In(o.z.negate(),o.y).div(Sh(o.x)))}).ElseIf(e.equal(4),()=>{t.assign(In(o.x.negate(),o.z).div(Sh(o.y)))}).Else(()=>{t.assign(In(o.x,o.y).div(Sh(o.z)))}),Ei(.5,t.add(1))}).setLayout({name:"getUV",type:"vec2",inputs:[{name:"direction",type:"vec3"},{name:"face",type:"float"}]}),NUe=cn(([o])=>{const e=$t(0).toVar();return Wo(o.greaterThanEqual(HR),()=>{e.assign(mge.sub(o).mul(RV.sub(Kj)).div(mge.sub(HR)).add(Kj))}).ElseIf(o.greaterThanEqual(WR),()=>{e.assign(HR.sub(o).mul(kV.sub(RV)).div(HR.sub(WR)).add(RV))}).ElseIf(o.greaterThanEqual($R),()=>{e.assign(WR.sub(o).mul(IV.sub(kV)).div(WR.sub($R)).add(kV))}).ElseIf(o.greaterThanEqual(gge),()=>{e.assign($R.sub(o).mul(PUe.sub(IV)).div($R.sub(gge)).add(IV))}).Else(()=>{e.assign($t(-2).mul(Ag(Ei(1.16,o))))}),e}).setLayout({name:"roughnessToMip",type:"float",inputs:[{name:"roughness",type:"float"}]}),DUe=cn(([o,e])=>{const t=o.toVar();t.assign(Ei(2,t).sub(1));const n=Yt(t,1).toVar();return Wo(e.equal(0),()=>{n.assign(n.zyx)}).ElseIf(e.equal(1),()=>{n.assign(n.xzy),n.xz.mulAssign(-1)}).ElseIf(e.equal(2),()=>{n.x.mulAssign(-1)}).ElseIf(e.equal(3),()=>{n.assign(n.zyx),n.xz.mulAssign(-1)}).ElseIf(e.equal(4),()=>{n.assign(n.xzy),n.xy.mulAssign(-1)}).ElseIf(e.equal(5),()=>{n.z.mulAssign(-1)}),n}).setLayout({name:"getDirection",type:"vec3",inputs:[{name:"uv",type:"vec2"},{name:"face",type:"float"}]}),OUe=cn(([o,e,t,n,r,i])=>{const a=$t(t),c=Yt(e),h=Dg(NUe(a),Kj,i),p=n4(h),v=m6(h),x=Yt(Zj(o,c,v,n,r,i)).toVar();return Wo(p.notEqual(0),()=>{const S=Yt(Zj(o,c,v.add(1),n,r,i)).toVar();x.assign(Zs(x,S,p))}),x}),Zj=cn(([o,e,t,n,r,i])=>{const a=$t(t).toVar(),c=Yt(e),h=$t(kUe(c)).toVar(),p=$t(W0(yge.sub(a),0)).toVar();a.assign(W0(a,yge));const v=$t(CE(a)).toVar(),x=In(IUe(c,h).mul(v.sub(2)).add(1)).toVar();return Wo(h.greaterThan(2),()=>{x.y.addAssign(v),h.subAssign(3)}),x.x.addAssign(h.mul(v)),x.x.addAssign(p.mul(Ei(3,RUe))),x.y.addAssign(Ei(4,CE(i).sub(v))),x.x.mulAssign(n),x.y.mulAssign(r),o.sample(x).grad(In(),In())}),NV=cn(({envMap:o,mipInt:e,outputDirection:t,theta:n,axis:r,CUBEUV_TEXEL_WIDTH:i,CUBEUV_TEXEL_HEIGHT:a,CUBEUV_MAX_MIP:c})=>{const h=U3(n),p=t.mul(h).add(r.cross(t).mul(af(n))).add(r.mul(r.dot(t).mul(h.oneMinus())));return Zj(o,p,e,i,a,c)}),FUe=cn(({n:o,latitudinal:e,poleAxis:t,outputDirection:n,weights:r,samples:i,dTheta:a,mipInt:c,envMap:h,CUBEUV_TEXEL_WIDTH:p,CUBEUV_TEXEL_HEIGHT:v,CUBEUV_MAX_MIP:x})=>{const S=Yt(G0(e,t,u4e(t,n))).toVar();Wo(S.equal(Yt(0)),()=>{S.assign(Yt(n.z,0,n.x.negate()))}),S.assign(AE(S));const C=Yt().toVar();return C.addAssign(r.element(0).mul(NV({theta:0,axis:S,outputDirection:n,mipInt:c,envMap:h,CUBEUV_TEXEL_WIDTH:p,CUBEUV_TEXEL_HEIGHT:v,CUBEUV_MAX_MIP:x}))),cf({start:Fs(1),end:o},({i:I})=>{Wo(I.greaterThanEqual(i),()=>{TFe()});const L=$t(a.mul($t(I))).toVar();C.addAssign(r.element(I).mul(NV({theta:L.mul(-1),axis:S,outputDirection:n,mipInt:c,envMap:h,CUBEUV_TEXEL_WIDTH:p,CUBEUV_TEXEL_HEIGHT:v,CUBEUV_MAX_MIP:x}))),C.addAssign(r.element(I).mul(NV({theta:L,axis:S,outputDirection:n,mipInt:c,envMap:h,CUBEUV_TEXEL_WIDTH:p,CUBEUV_TEXEL_HEIGHT:v,CUBEUV_MAX_MIP:x})))}),ei(C,1)}),k3=new yt,vge=new pi,_ge=new pi;class bu extends oW{constructor(e=50,t=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=U_*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(nE*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return U_*2*Math.atan(Math.tan(nE*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){k3.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(k3.x,k3.y).multiplyScalar(-e/k3.z),k3.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(k3.x,k3.y).multiplyScalar(-e/k3.z)}getViewSize(e,t){return this.getViewBounds(e,vge,_ge),t.subVectors(_ge,vge)}setViewOffset(e,t,n,r,i,a){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(nE*.5*this.fov)/this.zoom,n=2*t,r=this.aspect*n,i=-.5*r;const a=this.view;if(this.view!==null&&this.view.enabled){const h=a.fullWidth,p=a.fullHeight;i+=a.offsetX*r/h,t-=a.offsetY*n/p,r*=a.width/h,n*=a.height/p}const c=this.filmOffset;c!==0&&(i+=e*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,t,t-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class BE extends Bg{constructor(e=1,t=1,n=1,r=1,i=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:i,depthSegments:a};const c=this;r=Math.floor(r),i=Math.floor(i),a=Math.floor(a);const h=[],p=[],v=[],x=[];let S=0,C=0;I("z","y","x",-1,-1,n,t,e,a,i,0),I("z","y","x",1,-1,n,t,-e,a,i,1),I("x","z","y",1,1,e,n,t,r,a,2),I("x","z","y",1,-1,e,n,-t,r,a,3),I("x","y","z",1,-1,e,t,n,r,i,4),I("x","y","z",-1,-1,e,t,-n,r,i,5),this.setIndex(h),this.setAttribute("position",new Nl(p,3)),this.setAttribute("normal",new Nl(v,3)),this.setAttribute("uv",new Nl(x,2));function I(L,U,R,$,Z,k,ie,ue,ce,Q,ae){const le=k/ce,J=ie/Q,Ue=k/2,je=ie/2,rt=ue/2,at=ce+1,Se=Q+1;let gt=0,Ae=0;const lt=new yt;for(let pt=0;pt<Se;pt++){const De=pt*J-je;for(let _t=0;_t<at;_t++){const Jt=_t*le-Ue;lt[L]=Jt*$,lt[U]=De*Z,lt[R]=rt,p.push(lt.x,lt.y,lt.z),lt[L]=0,lt[U]=0,lt[R]=ue>0?1:-1,v.push(lt.x,lt.y,lt.z),x.push(_t/ce),x.push(1-pt/Q),gt+=1}}for(let pt=0;pt<Q;pt++)for(let De=0;De<ce;De++){const _t=S+De+at*pt,Jt=S+De+at*(pt+1),dt=S+(De+1)+at*(pt+1),Dt=S+(De+1)+at*pt;h.push(_t,Jt,Dt),h.push(Jt,dt,Dt),Ae+=6}c.addGroup(C,Ae,ae),C+=Ae,S+=gt}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new BE(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}const g_=4,xge=[.125,.215,.35,.446,.526,.582],l6=20,DV=new NW(-1,1,1,-1,0,1),LUe=new bu(90,1),bge=new qi;let OV=null,FV=0,LV=0;const n6=(1+Math.sqrt(5))/2,$7=1/n6,Sge=[new yt(-n6,$7,0),new yt(n6,$7,0),new yt(-$7,0,n6),new yt($7,0,n6),new yt(0,n6,-$7),new yt(0,n6,$7),new yt(-1,1,-1),new yt(1,1,-1),new yt(-1,1,1),new yt(1,1,1)],BUe=new yt,J4e=new WeakMap,UUe=[3,1,5,0,4,2],BV=DUe(LE(),Q3("faceIndex")).normalize(),OW=Yt(BV.x,BV.y,BV.z);class zUe{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._backgroundBox=null}get _hasInitialized(){return this._renderer.hasInitialized()}fromScene(e,t=0,n=.1,r=100,i={}){const{size:a=256,position:c=BUe,renderTarget:h=null}=i;if(this._setSize(a),this._hasInitialized===!1){console.warn("THREE.PMREMGenerator: .fromScene() called before the backend is initialized. Try using .fromSceneAsync() instead.");const v=h||this._allocateTarget();return i.renderTarget=v,this.fromSceneAsync(e,t,n,r,i),v}OV=this._renderer.getRenderTarget(),FV=this._renderer.getActiveCubeFace(),LV=this._renderer.getActiveMipmapLevel();const p=h||this._allocateTarget();return p.depthBuffer=!0,this._init(p),this._sceneToCubeUV(e,n,r,p,c),t>0&&this._blur(p,0,0,t),this._applyPMREM(p),this._cleanup(p),p}async fromSceneAsync(e,t=0,n=.1,r=100,i={}){return this._hasInitialized===!1&&await this._renderer.init(),this.fromScene(e,t,n,r,i)}fromEquirectangular(e,t=null){if(this._hasInitialized===!1){console.warn("THREE.PMREMGenerator: .fromEquirectangular() called before the backend is initialized. Try using .fromEquirectangularAsync() instead."),this._setSizeFromTexture(e);const n=t||this._allocateTarget();return this.fromEquirectangularAsync(e,n),n}return this._fromTexture(e,t)}async fromEquirectangularAsync(e,t=null){return this._hasInitialized===!1&&await this._renderer.init(),this._fromTexture(e,t)}fromCubemap(e,t=null){if(this._hasInitialized===!1){console.warn("THREE.PMREMGenerator: .fromCubemap() called before the backend is initialized. Try using .fromCubemapAsync() instead."),this._setSizeFromTexture(e);const n=t||this._allocateTarget();return this.fromCubemapAsync(e,t),n}return this._fromTexture(e,t)}async fromCubemapAsync(e,t=null){return this._hasInitialized===!1&&await this._renderer.init(),this._fromTexture(e,t)}async compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=Ege(),await this._compileMaterial(this._cubemapMaterial))}async compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=Tge(),await this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose(),this._backgroundBox!==null&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSizeFromTexture(e){e.mapping===EE||e.mapping===Qk?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4)}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(OV,FV,LV),e.scissorTest=!1,qR(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSizeFromTexture(e),OV=this._renderer.getRenderTarget(),FV=this._renderer.getActiveCubeFace(),LV=this._renderer.getActiveMipmapLevel();const n=t||this._allocateTarget();return this._init(n),this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTarget(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize;return wge(e,t)}_init(e){if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e.width||this._pingPongRenderTarget.height!==e.height){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=wge(e.width,e.height);const{_lodMax:t}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas,lodMeshes:this._lodMeshes}=VUe(t)),this._blurMaterial=GUe(t,e.width,e.height)}}async _compileMaterial(e){const t=new Og(this._lodPlanes[0],e);await this._renderer.compile(t,DV)}_sceneToCubeUV(e,t,n,r,i){const a=LUe;a.near=t,a.far=n;const c=[1,1,1,1,-1,1],h=[1,-1,1,-1,1,-1],p=this._renderer,v=p.autoClear;p.getClearColor(bge),p.autoClear=!1;let x=this._backgroundBox;if(x===null){const I=new H3({name:"PMREM.Background",side:Ec,depthWrite:!1,depthTest:!1});x=new Og(new BE,I)}let S=!1;const C=e.background;C?C.isColor&&(x.material.color.copy(C),e.background=null,S=!0):(x.material.color.copy(bge),S=!0),p.setRenderTarget(r),p.clear(),S&&p.render(x,a);for(let I=0;I<6;I++){const L=I%3;L===0?(a.up.set(0,c[I],0),a.position.set(i.x,i.y,i.z),a.lookAt(i.x+h[I],i.y,i.z)):L===1?(a.up.set(0,0,c[I]),a.position.set(i.x,i.y,i.z),a.lookAt(i.x,i.y+h[I],i.z)):(a.up.set(0,c[I],0),a.position.set(i.x,i.y,i.z),a.lookAt(i.x,i.y,i.z+h[I]));const U=this._cubeSize;qR(r,L*U,I>2?U:0,U,U),p.render(e,a)}p.autoClear=v,e.background=C}_textureToCubeUV(e,t){const n=this._renderer,r=e.mapping===EE||e.mapping===Qk;r?this._cubemapMaterial===null&&(this._cubemapMaterial=Ege(e)):this._equirectMaterial===null&&(this._equirectMaterial=Tge(e));const i=r?this._cubemapMaterial:this._equirectMaterial;i.fragmentNode.value=e;const a=this._lodMeshes[0];a.material=i;const c=this._cubeSize;qR(t,0,0,3*c,2*c),n.setRenderTarget(t),n.render(a,DV)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const r=this._lodPlanes.length;for(let i=1;i<r;i++){const a=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),c=Sge[(r-i-1)%Sge.length];this._blur(e,i-1,i,a,c)}t.autoClear=n}_blur(e,t,n,r,i){const a=this._pingPongRenderTarget;this._halfBlur(e,a,t,n,r,"latitudinal",i),this._halfBlur(a,e,n,n,r,"longitudinal",i)}_halfBlur(e,t,n,r,i,a,c){const h=this._renderer,p=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const v=3,x=this._lodMeshes[r];x.material=p;const S=J4e.get(p),C=this._sizeLods[n]-1,I=isFinite(i)?Math.PI/(2*C):2*Math.PI/(2*l6-1),L=i/I,U=isFinite(i)?1+Math.floor(v*L):l6;U>l6&&console.warn(`sigmaRadians, ${i}, is too large and will clip, as it requested ${U} samples when the maximum is set to ${l6}`);const R=[];let $=0;for(let ce=0;ce<l6;++ce){const Q=ce/L,ae=Math.exp(-Q*Q/2);R.push(ae),ce===0?$+=ae:ce<U&&($+=2*ae)}for(let ce=0;ce<R.length;ce++)R[ce]=R[ce]/$;e.texture.frame=(e.texture.frame||0)+1,S.envMap.value=e.texture,S.samples.value=U,S.weights.array=R,S.latitudinal.value=a==="latitudinal"?1:0,c&&(S.poleAxis.value=c);const{_lodMax:Z}=this;S.dTheta.value=I,S.mipInt.value=Z-n;const k=this._sizeLods[r],ie=3*k*(r>Z-g_?r-Z+g_:0),ue=4*(this._cubeSize-k);qR(t,ie,ue,3*k,2*k),h.setRenderTarget(t),h.render(x,DV)}}function VUe(o){const e=[],t=[],n=[],r=[];let i=o;const a=o-g_+1+xge.length;for(let c=0;c<a;c++){const h=Math.pow(2,i);t.push(h);let p=1/h;c>o-g_?p=xge[c-o+g_-1]:c===0&&(p=0),n.push(p);const v=1/(h-2),x=-v,S=1+v,C=[x,x,S,x,S,S,x,x,S,S,x,S],I=6,L=6,U=3,R=2,$=1,Z=new Float32Array(U*L*I),k=new Float32Array(R*L*I),ie=new Float32Array($*L*I);for(let ce=0;ce<I;ce++){const Q=ce%3*2/3-1,ae=ce>2?0:-1,le=[Q,ae,0,Q+2/3,ae,0,Q+2/3,ae+1,0,Q,ae,0,Q+2/3,ae+1,0,Q,ae+1,0],J=UUe[ce];Z.set(le,U*L*J),k.set(C,R*L*J);const Ue=[J,J,J,J,J,J];ie.set(Ue,$*L*J)}const ue=new Bg;ue.setAttribute("position",new Ph(Z,U)),ue.setAttribute("uv",new Ph(k,R)),ue.setAttribute("faceIndex",new Ph(ie,$)),e.push(ue),r.push(new Og(ue,null)),i>g_&&i--}return{lodPlanes:e,sizeLods:t,sigmas:n,lodMeshes:r}}function wge(o,e){const t={magFilter:Eu,minFilter:Eu,generateMipmaps:!1,type:Mh,format:Ch,colorSpace:E_},n=new C6(o,e,t);return n.texture.mapping=Sj,n.texture.name="PMREM.cubeUv",n.texture.isPMREMTexture=!0,n.scissorTest=!0,n}function qR(o,e,t,n,r){o.viewport.set(e,t,n,r),o.scissor.set(e,t,n,r)}function FW(o){const e=new sa;return e.depthTest=!1,e.depthWrite=!1,e.blending=z_,e.name=`PMREM_${o}`,e}function GUe(o,e,t){const n=Kp(new Array(l6).fill(0)),r=Gr(new yt(0,1,0)),i=Gr(0),a=$t(l6),c=Gr(0),h=Gr(1),p=Vi(null),v=Gr(0),x=$t(1/e),S=$t(1/t),C=$t(o),I={n:a,latitudinal:c,weights:n,poleAxis:r,outputDirection:OW,dTheta:i,samples:h,envMap:p,mipInt:v,CUBEUV_TEXEL_WIDTH:x,CUBEUV_TEXEL_HEIGHT:S,CUBEUV_MAX_MIP:C},L=FW("blur");return L.fragmentNode=FUe({...I,latitudinal:c.equal(1)}),J4e.set(L,I),L}function Ege(o){const e=FW("cubemap");return e.fragmentNode=RE(o,OW),e}function Tge(o){const e=FW("equirect");return e.fragmentNode=Vi(o,T4e(OW),0),e}const Mge=new WeakMap;function jUe(o){const e=Math.log2(o)-2,t=1/o;return{texelWidth:1/(3*Math.max(Math.pow(2,e),7*16)),texelHeight:t,maxMip:e}}function HUe(o,e,t){const n=WUe(e);let r=n.get(o);if((r!==void 0?r.pmremVersion:-1)!==o.pmremVersion){const a=o.image;if(o.isCubeTexture)if(qUe(a))r=t.fromCubemap(o,r);else return null;else if(XUe(a))r=t.fromEquirectangular(o,r);else return null;r.pmremVersion=o.pmremVersion,n.set(o,r)}return r.texture}function WUe(o){let e=Mge.get(o);return e===void 0&&(e=new WeakMap,Mge.set(o,e)),e}class $Ue extends oa{static get type(){return"PMREMNode"}constructor(e,t=null,n=null){super("vec3"),this._value=e,this._pmrem=null,this.uvNode=t,this.levelNode=n,this._generator=null;const r=new j0;r.isRenderTargetTexture=!0,this._texture=Vi(r),this._width=Gr(0),this._height=Gr(0),this._maxMip=Gr(0),this.updateBeforeType=vi.RENDER}set value(e){this._value=e,this._pmrem=null}get value(){return this._value}updateFromTexture(e){const t=jUe(e.image.height);this._texture.value=e,this._width.value=t.texelWidth,this._height.value=t.texelHeight,this._maxMip.value=t.maxMip}updateBefore(e){let t=this._pmrem;const n=t?t.pmremVersion:-1,r=this._value;n!==r.pmremVersion&&(r.isPMREMTexture===!0?t=r:t=HUe(r,e.renderer,this._generator),t!==null&&(this._pmrem=t,this.updateFromTexture(t)))}setup(e){this._generator===null&&(this._generator=new zUe(e.renderer)),this.updateBefore(e);let t=this.uvNode;t===null&&e.context.getUV&&(t=e.context.getUV(this)),t=F4e.mul(Yt(t.x,t.y.negate(),t.z));let n=this.levelNode;return n===null&&e.context.getTextureLevel&&(n=e.context.getTextureLevel(this)),OUe(this._texture,t,n,this._width,this._height,this._maxMip)}dispose(){super.dispose(),this._generator!==null&&this._generator.dispose()}}function qUe(o){if(o==null)return!1;let e=0;const t=6;for(let n=0;n<t;n++)o[n]!==void 0&&e++;return e===t}function XUe(o){return o==null?!1:o.height>0}const e5e=un($Ue).setParameterLength(1,3);cn(([o=LE()],{renderer:e,material:t})=>{const n=d4e(o.mul(2).sub(1));let r;if(t.alphaToCoverage&&e.samples>1){const i=$t(n.fwidth()).toVar();r=Z3(i.oneMinus(),i.add(1),n).oneMinus()}else r=G0(n.greaterThan(1),0,1);return r});const kE=cn(({f0:o,f90:e,dotVH:t})=>{const n=t.mul(-5.55473).sub(6.98316).mul(t).exp2();return o.mul(n.oneMinus()).add(e.mul(n))}),YUe=cn(({alpha:o,dotNL:e,dotNV:t})=>{const n=o.pow2(),r=e.mul(n.add(n.oneMinus().mul(t.pow2())).sqrt()),i=t.mul(n.add(n.oneMinus().mul(e.pow2())).sqrt());return r1(.5,r.add(i).max(hOe))}).setLayout({name:"V_GGX_SmithCorrelated",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNL",type:"float"},{name:"dotNV",type:"float"}]}),KUe=cn(({alphaT:o,alphaB:e,dotTV:t,dotBV:n,dotTL:r,dotBL:i,dotNV:a,dotNL:c})=>{const h=c.mul(Yt(o.mul(t),e.mul(n),a).length()),p=a.mul(Yt(o.mul(r),e.mul(i),c).length());return r1(.5,h.add(p)).saturate()}).setLayout({name:"V_GGX_SmithCorrelated_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotTV",type:"float",qualifier:"in"},{name:"dotBV",type:"float",qualifier:"in"},{name:"dotTL",type:"float",qualifier:"in"},{name:"dotBL",type:"float",qualifier:"in"},{name:"dotNV",type:"float",qualifier:"in"},{name:"dotNL",type:"float",qualifier:"in"}]}),ZUe=cn(({alpha:o,dotNH:e})=>{const t=o.pow2(),n=e.pow2().mul(t.oneMinus()).oneMinus();return t.div(n.pow2()).mul(1/Math.PI)}).setLayout({name:"D_GGX",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNH",type:"float"}]}),QUe=$t(1/Math.PI),JUe=cn(({alphaT:o,alphaB:e,dotNH:t,dotTH:n,dotBH:r})=>{const i=o.mul(e),a=Yt(e.mul(n),o.mul(r),i.mul(t)),c=a.dot(a),h=i.div(c);return QUe.mul(i.mul(h.pow2()))}).setLayout({name:"D_GGX_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotNH",type:"float",qualifier:"in"},{name:"dotTH",type:"float",qualifier:"in"},{name:"dotBH",type:"float",qualifier:"in"}]}),Cge=cn(o=>{const{lightDirection:e,f0:t,f90:n,roughness:r,f:i,USE_IRIDESCENCE:a,USE_ANISOTROPY:c}=o,h=o.normalView||ra,p=r.pow2(),v=e.add(_o).normalize(),x=h.dot(e).clamp(),S=h.dot(_o).clamp(),C=h.dot(v).clamp(),I=_o.dot(v).clamp();let L=kE({f0:t,f90:n,dotVH:I}),U,R;if(Ome(a)&&(L=yW.mix(L,i)),Ome(c)){const $=Mk.dot(e),Z=Mk.dot(_o),k=Mk.dot(v),ie=A_.dot(e),ue=A_.dot(_o),ce=A_.dot(v);U=KUe({alphaT:Hj,alphaB:p,dotTV:Z,dotBV:ue,dotTL:$,dotBL:ie,dotNV:S,dotNL:x}),R=JUe({alphaT:Hj,alphaB:p,dotNH:C,dotTH:k,dotBH:ce})}else U=YUe({alpha:p,dotNL:x,dotNV:S}),R=ZUe({alpha:p,dotNH:C});return L.mul(U).mul(R)}),$_=cn(o=>o.diffuseColor.mul(1/Math.PI)),t5e=cn(({roughness:o,dotNV:e})=>{const t=ei(-1,-.0275,-.572,.022),n=ei(1,.0425,1.04,-.04),r=o.mul(t).add(n),i=r.x.mul(r.x).min(e.mul(-9.28).exp2()).mul(r.x).add(r.y);return In(-1.04,1.04).mul(i).add(r.zw)}).setLayout({name:"DFGApprox",type:"vec2",inputs:[{name:"roughness",type:"float"},{name:"dotNV",type:"vec3"}]}),eze=cn(({f:o,f90:e,dotVH:t})=>{const n=t.oneMinus().saturate(),r=n.mul(n),i=n.mul(r,r).clamp(0,.9999);return o.sub(Yt(e).mul(i)).div(i.oneMinus())}).setLayout({name:"Schlick_to_F0",type:"vec3",inputs:[{name:"f",type:"vec3"},{name:"f90",type:"float"},{name:"dotVH",type:"float"}]}),tze=cn(o=>{if(o.geometry.hasAttribute("normal")===!1)return $t(0);const e=s1.dFdx().abs().max(s1.dFdy().abs());return e.x.max(e.y).max(e.z)}),n5e=cn(o=>{const{roughness:e}=o,t=tze();let n=e.max(.0525);return n=n.add(t),n=n.min(1),n}),nze=cn(([o,e])=>{const t=o.x,n=o.y,r=o.z;let i=e.element(0).mul(.886227);return i=i.add(e.element(1).mul(2*.511664).mul(n)),i=i.add(e.element(2).mul(2*.511664).mul(r)),i=i.add(e.element(3).mul(2*.511664).mul(t)),i=i.add(e.element(4).mul(2*.429043).mul(t).mul(n)),i=i.add(e.element(5).mul(2*.429043).mul(n).mul(r)),i=i.add(e.element(6).mul(r.mul(r).mul(.743125).sub(.247708))),i=i.add(e.element(7).mul(2*.429043).mul(t).mul(r)),i=i.add(e.element(8).mul(.429043).mul(Ei(t,t).sub(Ei(n,n)))),i});class LW extends Bg{constructor(e=1,t=32,n=16,r=0,i=Math.PI*2,a=0,c=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:i,thetaStart:a,thetaLength:c},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const h=Math.min(a+c,Math.PI);let p=0;const v=[],x=new yt,S=new yt,C=[],I=[],L=[],U=[];for(let R=0;R<=n;R++){const $=[],Z=R/n;let k=0;R===0&&a===0?k=.5/t:R===n&&h===Math.PI&&(k=-.5/t);for(let ie=0;ie<=t;ie++){const ue=ie/t;x.x=-e*Math.cos(r+ue*i)*Math.sin(a+Z*c),x.y=e*Math.cos(a+Z*c),x.z=e*Math.sin(r+ue*i)*Math.sin(a+Z*c),I.push(x.x,x.y,x.z),S.copy(x).normalize(),L.push(S.x,S.y,S.z),U.push(ue+k,1-Z),$.push(p++)}v.push($)}for(let R=0;R<n;R++)for(let $=0;$<t;$++){const Z=v[R][$+1],k=v[R][$],ie=v[R+1][$],ue=v[R+1][$+1];(R!==0||a>0)&&C.push(Z,k,ue),(R!==n-1||h<Math.PI)&&C.push(k,ie,ue)}this.setIndex(C),this.setAttribute("position",new Nl(I,3)),this.setAttribute("normal",new Nl(L,3)),this.setAttribute("uv",new Nl(U,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new LW(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}const Qd=new lW;class rze extends t4{constructor(e,t){super(),this.renderer=e,this.nodes=t}update(e,t,n){const r=this.renderer,i=this.nodes.getBackgroundNode(e)||e.background;let a=!1;if(i===null)r._clearColor.getRGB(Qd),Qd.a=r._clearColor.a;else if(i.isColor===!0)i.getRGB(Qd),Qd.a=1,a=!0;else if(i.isNode===!0){const p=this.get(e),v=i;Qd.copy(r._clearColor);let x=p.backgroundMesh;if(x===void 0){let U=function(){i.removeEventListener("dispose",U),x.material.dispose(),x.geometry.dispose()};var h=U;const C=bW(ei(v).mul(cge),{getUV:()=>kBe.mul(PW),getTextureLevel:()=>RBe});let I=V4e;I=I.setZ(I.w);const L=new sa;L.name="Background.material",L.side=Ec,L.depthTest=!1,L.depthWrite=!1,L.allowOverride=!1,L.fog=!1,L.lights=!1,L.vertexNode=I,L.colorNode=C,p.backgroundMeshNode=C,p.backgroundMesh=x=new Og(new LW(1,32,32),L),x.frustumCulled=!1,x.name="Background.mesh",x.onBeforeRender=function(R,$,Z){this.matrixWorld.copyPosition(Z.matrixWorld)},i.addEventListener("dispose",U)}const S=v.getCacheKey();p.backgroundCacheKey!==S&&(p.backgroundMeshNode.node=ei(v).mul(cge),p.backgroundMeshNode.needsUpdate=!0,x.material.needsUpdate=!0,p.backgroundCacheKey=S),t.unshift(x,x.geometry,x.material,0,0,null,null)}else console.error("THREE.Renderer: Unsupported background configuration.",i);const c=r.xr.getEnvironmentBlendMode();if(c==="additive"?Qd.set(0,0,0,1):c==="alpha-blend"&&Qd.set(0,0,0,0),r.autoClear===!0||a===!0){const p=n.clearColorValue;p.r=Qd.r,p.g=Qd.g,p.b=Qd.b,p.a=Qd.a,(r.backend.isWebGLBackend===!0||r.alpha===!0)&&(p.r*=p.a,p.g*=p.a,p.b*=p.a),n.depthClearValue=r._clearDepth,n.stencilClearValue=r._clearStencil,n.clearColor=r.autoClearColor===!0,n.clearDepth=r.autoClearDepth===!0,n.clearStencil=r.autoClearStencil===!0}else n.clearColor=!1,n.clearDepth=!1,n.clearStencil=!1}}let ize=0;class Qj{constructor(e="",t=[],n=0,r=[]){this.name=e,this.bindings=t,this.index=n,this.bindingsReference=r,this.id=ize++}}class sze{constructor(e,t,n,r,i,a,c,h,p,v=[]){this.vertexShader=e,this.fragmentShader=t,this.computeShader=n,this.transforms=v,this.nodeAttributes=r,this.bindings=i,this.updateNodes=a,this.updateBeforeNodes=c,this.updateAfterNodes=h,this.observer=p,this.usedTimes=0}createBindings(){const e=[];for(const t of this.bindings)if(t.bindings[0].groupNode.shared!==!0){const r=new Qj(t.name,[],t.index,t);e.push(r);for(const i of t.bindings)r.bindings.push(i.clone())}else e.push(t);return e}}function r5e(o){const e={};for(const t in o){e[t]={};for(const n in o[t]){const r=o[t][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=r.clone():Array.isArray(r)?e[t][n]=r.slice():e[t][n]=r}}return e}function oze(o){const e=[];for(let t=0;t<o.length;t++)e.push(o[t].clone());return e}const aze=`
void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}
`,lze=`
void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}
`;class cze extends Tc{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=aze,this.fragmentShader=lze,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=r5e(e.uniforms),this.uniformsGroups=oze(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const a=this.uniforms[r].value;a&&a.isTexture?t.uniforms[r]={type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?t.uniforms[r]={type:"c",value:a.getHex()}:a&&a.isVector2?t.uniforms[r]={type:"v2",value:a.toArray()}:a&&a.isVector3?t.uniforms[r]={type:"v3",value:a.toArray()}:a&&a.isVector4?t.uniforms[r]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?t.uniforms[r]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?t.uniforms[r]={type:"m4",value:a.toArray()}:t.uniforms[r]={value:a}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const r in this.extensions)this.extensions[r]===!0&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class uze extends C6{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}}const q7=-90,X7=1;class i5e extends va{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new bu(q7,X7,e,t);r.layers=this.layers,this.add(r);const i=new bu(q7,X7,e,t);i.layers=this.layers,this.add(i);const a=new bu(q7,X7,e,t);a.layers=this.layers,this.add(a);const c=new bu(q7,X7,e,t);c.layers=this.layers,this.add(c);const h=new bu(q7,X7,e,t);h.layers=this.layers,this.add(h);const p=new bu(q7,X7,e,t);p.layers=this.layers,this.add(p)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,r,i,a,c,h]=t;for(const p of t)this.remove(p);if(e===bc)n.up.set(0,1,0),n.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),i.up.set(0,0,-1),i.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),c.up.set(0,1,0),c.lookAt(0,0,1),h.up.set(0,1,0),h.lookAt(0,0,-1);else if(e===K3)n.up.set(0,-1,0),n.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),i.up.set(0,0,1),i.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),c.up.set(0,-1,0),c.lookAt(0,0,1),h.up.set(0,-1,0),h.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const p of t)this.add(p),p.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[i,a,c,h,p,v]=this.children,x=e.getRenderTarget(),S=e.getActiveCubeFace(),C=e.getActiveMipmapLevel(),I=e.xr.enabled;e.xr.enabled=!1;const L=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,r),e.render(t,i),e.setRenderTarget(n,1,r),e.render(t,a),e.setRenderTarget(n,2,r),e.render(t,c),e.setRenderTarget(n,3,r),e.render(t,h),e.setRenderTarget(n,4,r),e.render(t,p),n.texture.generateMipmaps=L,e.setRenderTarget(n,5,r),e.render(t,v),e.setRenderTarget(x,S,C),e.xr.enabled=I,n.texture.needsPMREMUpdate=!0}}class hze extends uze{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},r=[n,n,n,n,n,n];this.texture=new OI(r),this._setTextureOptions(t),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new BE(5,5,5),i=new cze({name:"CubemapFromEquirect",uniforms:r5e(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:Ec,blending:z_});i.uniforms.tEquirect.value=t;const a=new Og(r,i),c=t.minFilter;return t.minFilter===Tg&&(t.minFilter=Eu),new i5e(1,10,this).update(e,a),t.minFilter=c,a.geometry.dispose(),a.material.dispose(),this}clear(e,t=!0,n=!0,r=!0){const i=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,n,r);e.setRenderTarget(i)}}class s5e extends hze{constructor(e=1,t={}){super(e,t),this.isCubeRenderTarget=!0}fromEquirectangularTexture(e,t){const n=t.minFilter,r=t.generateMipmaps;t.generateMipmaps=!0,this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i=new BE(5,5,5),a=T4e(E4e),c=new sa;c.colorNode=Vi(t,a,0),c.side=Ec,c.blending=z_;const h=new Og(i,c),p=new sW;p.add(h),t.minFilter===Tg&&(t.minFilter=Eu);const v=new i5e(1,10,this),x=e.getMRT();return e.setMRT(null),v.update(e,p),e.setMRT(x),t.minFilter=n,t.currentGenerateMipmaps=r,h.geometry.dispose(),h.material.dispose(),this}}const cE=new WeakMap;class dze extends oa{static get type(){return"CubeMapNode"}constructor(e){super("vec3"),this.envNode=e,this._cubeTexture=null,this._cubeTextureNode=RE(null);const t=new OI;t.isRenderTargetTexture=!0,this._defaultTexture=t,this.updateBeforeType=vi.RENDER}updateBefore(e){const{renderer:t,material:n}=e,r=this.envNode;if(r.isTextureNode||r.isMaterialReferenceNode){const i=r.isTextureNode?r.value:n[r.property];if(i&&i.isTexture){const a=i.mapping;if(a===KH||a===ZH){if(cE.has(i)){const c=cE.get(i);Age(c,i.mapping),this._cubeTexture=c}else{const c=i.image;if(fze(c)){const h=new s5e(c.height);h.fromEquirectangularTexture(t,i),Age(h.texture,i.mapping),this._cubeTexture=h.texture,cE.set(i,h.texture),i.addEventListener("dispose",o5e)}else this._cubeTexture=this._defaultTexture}this._cubeTextureNode.value=this._cubeTexture}else this._cubeTextureNode=this.envNode}}}setup(e){return this.updateBefore(e),this._cubeTextureNode}}function fze(o){return o==null?!1:o.height>0}function o5e(o){const e=o.target;e.removeEventListener("dispose",o5e);const t=cE.get(e);t!==void 0&&(cE.delete(e),t.dispose())}function Age(o,e){e===KH?o.mapping=EE:e===ZH&&(o.mapping=Qk)}const a5e=un(dze).setParameterLength(1);class UI{start(e){e.lightsNode.setupLights(e,e.lightsNode.getLightNodes(e)),this.indirect(e)}finish(){}direct(){}directRectArea(){}indirect(){}ambientOcclusion(){}}class Pge{constructor(e,t,n=null){this.isNodeAttribute=!0,this.name=e,this.type=t,this.node=n}}class pze{constructor(e,t,n){this.isNodeUniform=!0,this.name=e,this.type=t,this.node=n.getSelf()}get value(){return this.node.value}set value(e){this.node.value=e}get id(){return this.node.id}get groupNode(){return this.node.groupNode}}class l5e{constructor(e,t,n=!1,r=null){this.isNodeVar=!0,this.name=e,this.type=t,this.readOnly=n,this.count=r}}class mze extends l5e{constructor(e,t,n=null,r=null){super(e,t),this.needsInterpolation=!1,this.isNodeVarying=!0,this.interpolationType=n,this.interpolationSampling=r}}class gze{constructor(e,t,n=""){this.name=e,this.type=t,this.code=n,Object.defineProperty(this,"isNodeCode",{value:!0})}}let yze=0;class UV{constructor(e=null){this.id=yze++,this.nodesData=new WeakMap,this.parent=e}getData(e){let t=this.nodesData.get(e);return t===void 0&&this.parent!==null&&(t=this.parent.getData(e)),t}setData(e,t){this.nodesData.set(e,t)}}class vze{constructor(e,t){this.name=e,this.members=t,this.output=!1}}class r4{constructor(e,t){this.name=e,this.value=t,this.boundary=0,this.itemSize=0,this.offset=0}setValue(e){this.value=e}getValue(){return this.value}}class _ze extends r4{constructor(e,t=0){super(e,t),this.isNumberUniform=!0,this.boundary=4,this.itemSize=1}}class xze extends r4{constructor(e,t=new pi){super(e,t),this.isVector2Uniform=!0,this.boundary=8,this.itemSize=2}}class bze extends r4{constructor(e,t=new yt){super(e,t),this.isVector3Uniform=!0,this.boundary=16,this.itemSize=3}}class Sze extends r4{constructor(e,t=new Ri){super(e,t),this.isVector4Uniform=!0,this.boundary=16,this.itemSize=4}}class wze extends r4{constructor(e,t=new qi){super(e,t),this.isColorUniform=!0,this.boundary=16,this.itemSize=3}}class Eze extends r4{constructor(e,t=new wI){super(e,t),this.isMatrix2Uniform=!0,this.boundary=8,this.itemSize=4}}class Tze extends r4{constructor(e,t=new Mc){super(e,t),this.isMatrix3Uniform=!0,this.boundary=48,this.itemSize=12}}class Mze extends r4{constructor(e,t=new Ts){super(e,t),this.isMatrix4Uniform=!0,this.boundary=64,this.itemSize=16}}class Cze extends _ze{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class Aze extends xze{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class Pze extends bze{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class Rze extends Sze{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class kze extends wze{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class Ize extends Eze{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class Nze extends Tze{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class Dze extends Mze{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}const Rge=new WeakMap,Oze=new Map([[Int8Array,"int"],[Int16Array,"int"],[Int32Array,"int"],[Uint8Array,"uint"],[Uint16Array,"uint"],[Uint32Array,"uint"],[Float32Array,"float"]]),XR=o=>/e/g.test(o)?String(o).replace(/\+/g,""):(o=Number(o),o+(o%1?"":".0"));class c5e{constructor(e,t,n){this.object=e,this.material=e&&e.material||null,this.geometry=e&&e.geometry||null,this.renderer=t,this.parser=n,this.scene=null,this.camera=null,this.nodes=[],this.sequentialNodes=[],this.updateNodes=[],this.updateBeforeNodes=[],this.updateAfterNodes=[],this.hashNodes={},this.observer=null,this.lightsNode=null,this.environmentNode=null,this.fogNode=null,this.clippingContext=null,this.vertexShader=null,this.fragmentShader=null,this.computeShader=null,this.flowNodes={vertex:[],fragment:[],compute:[]},this.flowCode={vertex:"",fragment:"",compute:""},this.uniforms={vertex:[],fragment:[],compute:[],index:0},this.structs={vertex:[],fragment:[],compute:[],index:0},this.bindings={vertex:{},fragment:{},compute:{}},this.bindingsIndexes={},this.bindGroups=null,this.attributes=[],this.bufferAttributes=[],this.varyings=[],this.codes={},this.vars={},this.declarations={},this.flow={code:""},this.chaining=[],this.stack=sV(),this.stacks=[],this.tab="	",this.currentFunctionNode=null,this.context={material:this.material},this.cache=new UV,this.globalCache=this.cache,this.flowsData=new WeakMap,this.shaderStage=null,this.buildStage=null}getBindGroupsCache(){let e=Rge.get(this.renderer);return e===void 0&&(e=new mf,Rge.set(this.renderer,e)),e}createRenderTarget(e,t,n){return new C6(e,t,n)}createCubeRenderTarget(e,t){return new s5e(e,t)}includes(e){return this.nodes.includes(e)}getOutputStructName(){}_getBindGroup(e,t){const n=this.getBindGroupsCache(),r=[];let i=!0;for(const c of t)r.push(c),i=i&&c.groupNode.shared!==!0;let a;return i?(a=n.get(r),a===void 0&&(a=new Qj(e,r,this.bindingsIndexes[e].group,r),n.set(r,a))):a=new Qj(e,r,this.bindingsIndexes[e].group,r),a}getBindGroupArray(e,t){const n=this.bindings[t];let r=n[e];return r===void 0&&(this.bindingsIndexes[e]===void 0&&(this.bindingsIndexes[e]={binding:0,group:Object.keys(this.bindingsIndexes).length}),n[e]=r=[]),r}getBindings(){let e=this.bindGroups;if(e===null){const t={},n=this.bindings;for(const r of Pme)for(const i in n[r]){const a=n[r][i];(t[i]||(t[i]=[])).push(...a)}e=[];for(const r in t){const i=t[r],a=this._getBindGroup(r,i);e.push(a)}this.bindGroups=e}return e}sortBindingGroups(){const e=this.getBindings();e.sort((t,n)=>t.bindings[0].groupNode.order-n.bindings[0].groupNode.order);for(let t=0;t<e.length;t++){const n=e[t];this.bindingsIndexes[n.name].group=t,n.index=t}}setHashNode(e,t){this.hashNodes[t]=e}addNode(e){this.nodes.includes(e)===!1&&(this.nodes.push(e),this.setHashNode(e,e.getHash(this)))}addSequentialNode(e){this.sequentialNodes.includes(e)===!1&&this.sequentialNodes.push(e)}buildUpdateNodes(){for(const e of this.nodes)e.getUpdateType()!==vi.NONE&&this.updateNodes.push(e.getSelf());for(const e of this.sequentialNodes){const t=e.getUpdateBeforeType(),n=e.getUpdateAfterType();t!==vi.NONE&&this.updateBeforeNodes.push(e.getSelf()),n!==vi.NONE&&this.updateAfterNodes.push(e.getSelf())}}get currentNode(){return this.chaining[this.chaining.length-1]}isFilteredTexture(e){return e.magFilter===Eu||e.magFilter===wj||e.magFilter===TE||e.magFilter===Tg||e.minFilter===Eu||e.minFilter===wj||e.minFilter===TE||e.minFilter===Tg}addChain(e){this.chaining.push(e)}removeChain(e){if(this.chaining.pop()!==e)throw new Error("NodeBuilder: Invalid node chaining!")}getMethod(e){return e}getNodeFromHash(e){return this.hashNodes[e]}addFlow(e,t){return this.flowNodes[e].push(t),t}setContext(e){this.context=e}getContext(){return this.context}getSharedContext(){return{...this.context},this.context}setCache(e){this.cache=e}getCache(){return this.cache}getCacheFromNode(e,t=!0){const n=this.getDataFromNode(e);return n.cache===void 0&&(n.cache=new UV(t?this.getCache():null)),n.cache}isAvailable(){return!1}getVertexIndex(){console.warn("Abstract function.")}getInstanceIndex(){console.warn("Abstract function.")}getDrawIndex(){console.warn("Abstract function.")}getFrontFacing(){console.warn("Abstract function.")}getFragCoord(){console.warn("Abstract function.")}isFlipY(){return!1}increaseUsage(e){const t=this.getDataFromNode(e);return t.usageCount=t.usageCount===void 0?1:t.usageCount+1,t.usageCount}generateTexture(){console.warn("Abstract function.")}generateTextureLod(){console.warn("Abstract function.")}generateArrayDeclaration(e,t){return this.getType(e)+"[ "+t+" ]"}generateArray(e,t,n=null){let r=this.generateArrayDeclaration(e,t)+"( ";for(let i=0;i<t;i++){const a=n?n[i]:null;a!==null?r+=a.build(this,e):r+=this.generateConst(e),i<t-1&&(r+=", ")}return r+=" )",r}generateStruct(e,t,n=null){const r=[];for(const i of t){const{name:a,type:c}=i;n&&n[a]&&n[a].isNode?r.push(n[a].build(this,c)):r.push(this.generateConst(c))}return e+"( "+r.join(", ")+" )"}generateConst(e,t=null){if(t===null&&(e==="float"||e==="int"||e==="uint"?t=0:e==="bool"?t=!1:e==="color"?t=new qi:e==="vec2"?t=new pi:e==="vec3"?t=new yt:e==="vec4"&&(t=new Ri)),e==="float")return XR(t);if(e==="int")return`${Math.round(t)}`;if(e==="uint")return t>=0?`${Math.round(t)}u`:"0u";if(e==="bool")return t?"true":"false";if(e==="color")return`${this.getType("vec3")}( ${XR(t.r)}, ${XR(t.g)}, ${XR(t.b)} )`;const n=this.getTypeLength(e),r=this.getComponentType(e),i=a=>this.generateConst(r,a);if(n===2)return`${this.getType(e)}( ${i(t.x)}, ${i(t.y)} )`;if(n===3)return`${this.getType(e)}( ${i(t.x)}, ${i(t.y)}, ${i(t.z)} )`;if(n===4&&e!=="mat2")return`${this.getType(e)}( ${i(t.x)}, ${i(t.y)}, ${i(t.z)}, ${i(t.w)} )`;if(n>=4&&t&&(t.isMatrix2||t.isMatrix3||t.isMatrix4))return`${this.getType(e)}( ${t.elements.map(i).join(", ")} )`;if(n>4)return`${this.getType(e)}()`;throw new Error(`NodeBuilder: Type '${e}' not found in generate constant attempt.`)}getType(e){return e==="color"?"vec3":e}hasGeometryAttribute(e){return this.geometry&&this.geometry.getAttribute(e)!==void 0}getAttribute(e,t){const n=this.attributes;for(const i of n)if(i.name===e)return i;const r=new Pge(e,t);return this.registerDeclaration(r),n.push(r),r}getPropertyName(e){return e.name}isVector(e){return/vec\d/.test(e)}isMatrix(e){return/mat\d/.test(e)}isReference(e){return e==="void"||e==="property"||e==="sampler"||e==="samplerComparison"||e==="texture"||e==="cubeTexture"||e==="storageTexture"||e==="depthTexture"||e==="texture3D"}needsToWorkingColorSpace(){return!1}getComponentTypeFromTexture(e){const t=e.type;if(e.isDataTexture){if(t===Pl)return"int";if(t===Ho)return"uint"}return"float"}getElementType(e){return e==="mat2"?"vec2":e==="mat3"?"vec3":e==="mat4"?"vec4":this.getComponentType(e)}getComponentType(e){if(e=this.getVectorType(e),e==="float"||e==="bool"||e==="int"||e==="uint")return e;const t=/(b|i|u|)(vec|mat)([2-4])/.exec(e);return t===null?null:t[1]==="b"?"bool":t[1]==="i"?"int":t[1]==="u"?"uint":"float"}getVectorType(e){return e==="color"?"vec3":e==="texture"||e==="cubeTexture"||e==="storageTexture"||e==="texture3D"?"vec4":e}getTypeFromLength(e,t="float"){if(e===1)return t;let n=xNe(e);const r=t==="float"?"":t[0];return/mat2/.test(t)===!0&&(n=n.replace("vec","mat")),r+n}getTypeFromArray(e){return Oze.get(e.constructor)}isInteger(e){return/int|uint|(i|u)vec/.test(e)}getTypeFromAttribute(e){let t=e;e.isInterleavedBufferAttribute&&(t=e.data);const n=t.array,r=e.itemSize,i=e.normalized;let a;return!(e instanceof L3e)&&i!==!0&&(a=this.getTypeFromArray(n)),this.getTypeFromLength(r,a)}getTypeLength(e){const t=this.getVectorType(e),n=/vec([2-4])/.exec(t);return n!==null?Number(n[1]):t==="float"||t==="bool"||t==="int"||t==="uint"?1:/mat2/.test(e)===!0?4:/mat3/.test(e)===!0?9:/mat4/.test(e)===!0?16:0}getVectorFromMatrix(e){return e.replace("mat","vec")}changeComponentType(e,t){return this.getTypeFromLength(this.getTypeLength(e),t)}getIntegerType(e){const t=this.getComponentType(e);return t==="int"||t==="uint"?e:this.changeComponentType(e,"int")}addStack(){return this.stack=sV(this.stack),this.stacks.push(W3e()||this.stack),iI(this.stack),this.stack}removeStack(){const e=this.stack;return this.stack=e.parent,iI(this.stacks.pop()),e}getDataFromNode(e,t=this.shaderStage,n=null){n=n===null?e.isGlobal(this)?this.globalCache:this.cache:n;let r=n.getData(e);return r===void 0&&(r={},n.setData(e,r)),r[t]===void 0&&(r[t]={}),r[t]}getNodeProperties(e,t="any"){const n=this.getDataFromNode(e,t);return n.properties||(n.properties={outputNode:null})}getBufferAttributeFromNode(e,t){const n=this.getDataFromNode(e);let r=n.bufferAttribute;if(r===void 0){const i=this.uniforms.index++;r=new Pge("nodeAttribute"+i,t,e),this.bufferAttributes.push(r),n.bufferAttribute=r}return r}getStructTypeFromNode(e,t,n=null,r=this.shaderStage){const i=this.getDataFromNode(e,r,this.globalCache);let a=i.structType;if(a===void 0){const c=this.structs.index++;n===null&&(n="StructType"+c),a=new vze(n,t),this.structs[r].push(a),i.structType=a}return a}getOutputStructTypeFromNode(e,t){const n=this.getStructTypeFromNode(e,t,"OutputType","fragment");return n.output=!0,n}getUniformFromNode(e,t,n=this.shaderStage,r=null){const i=this.getDataFromNode(e,n,this.globalCache);let a=i.uniform;if(a===void 0){const c=this.uniforms.index++;a=new pze(r||"nodeUniform"+c,t,e),this.uniforms[n].push(a),this.registerDeclaration(a),i.uniform=a}return a}getArrayCount(e){let t=null;return e.isArrayNode?t=e.count:e.isVarNode&&e.node.isArrayNode&&(t=e.node.count),t}getVarFromNode(e,t=null,n=e.getNodeType(this),r=this.shaderStage,i=!1){const a=this.getDataFromNode(e,r);let c=a.variable;if(c===void 0){const h=i?"_const":"_var",p=this.vars[r]||(this.vars[r]=[]),v=this.vars[h]||(this.vars[h]=0);t===null&&(t=(i?"nodeConst":"nodeVar")+v,this.vars[h]++);const x=this.getArrayCount(e);c=new l5e(t,n,i,x),i||p.push(c),this.registerDeclaration(c),a.variable=c}return c}isDeterministic(e){if(e.isMathNode)return this.isDeterministic(e.aNode)&&(e.bNode?this.isDeterministic(e.bNode):!0)&&(e.cNode?this.isDeterministic(e.cNode):!0);if(e.isOperatorNode)return this.isDeterministic(e.aNode)&&(e.bNode?this.isDeterministic(e.bNode):!0);if(e.isArrayNode){if(e.values!==null){for(const t of e.values)if(!this.isDeterministic(t))return!1}return!0}else if(e.isConstNode)return!0;return!1}getVaryingFromNode(e,t=null,n=e.getNodeType(this),r=null,i=null){const a=this.getDataFromNode(e,"any");let c=a.varying;if(c===void 0){const h=this.varyings,p=h.length;t===null&&(t="nodeVarying"+p),c=new mze(t,n,r,i),h.push(c),this.registerDeclaration(c),a.varying=c}return c}get namespace(){return this.context.namespace}getOutputNamespace(){return this.getNamespace("outputNode")}getNamespace(e=""){const t=this.namespace;let n;return t?n=e?t+"_"+e:t:n=e,n}registerDeclaration(e){const t=this.shaderStage,n=this.declarations[t]||(this.declarations[t]={}),r=this.getPropertyName(e);let i=1,a=r;for(;n[a]!==void 0;)a=r+"_"+i++;i>1&&(e.name=a,console.warn(`THREE.TSL: Declaration name '${r}' of '${e.type}' already in use. Renamed to '${a}'.`)),n[a]=e}getCodeFromNode(e,t,n=this.shaderStage){const r=this.getDataFromNode(e);let i=r.code;if(i===void 0){const a=this.codes[n]||(this.codes[n]=[]),c=a.length;i=new gze("nodeCode"+c,t),a.push(i),r.code=i}return i}addFlowCodeHierarchy(e,t){const{flowCodes:n,flowCodeBlock:r}=this.getDataFromNode(e);let i=!0,a=t;for(;a;){if(r.get(a)===!0){i=!1;break}a=this.getDataFromNode(a).parentNodeBlock}if(i)for(const c of n)this.addLineFlowCode(c)}addLineFlowCodeBlock(e,t,n){const r=this.getDataFromNode(e),i=r.flowCodes||(r.flowCodes=[]),a=r.flowCodeBlock||(r.flowCodeBlock=new WeakMap);i.push(t),a.set(n,!0)}addLineFlowCode(e,t=null){return e===""?this:(t!==null&&this.context.nodeBlock&&this.addLineFlowCodeBlock(t,e,this.context.nodeBlock),e=this.tab+e,/;\s*$/.test(e)||(e=e+`;
`),this.flow.code+=e,this)}addFlowCode(e){return this.flow.code+=e,this}addFlowTab(){return this.tab+="	",this}removeFlowTab(){return this.tab=this.tab.slice(0,-1),this}getFlowData(e){return this.flowsData.get(e)}flowNode(e){const t=e.getNodeType(this),n=this.flowChildNode(e,t);return this.flowsData.set(e,n),n}addInclude(e){this.currentFunctionNode!==null&&this.currentFunctionNode.includes.push(e)}buildFunctionNode(e){const t=new $Be,n=this.currentFunctionNode;return this.currentFunctionNode=t,t.code=this.buildFunctionCode(e),this.currentFunctionNode=n,t}flowShaderNode(e){const t=e.layout,n={[Symbol.iterator](){let a=0;const c=Object.values(this);return{next:()=>({value:c[a],done:a++>=c.length})}}};for(const a of t.inputs)n[a.name]=new SFe(a.type,a.name);e.layout=null;const r=e.call(n),i=this.flowStagesNode(r,t.type);return e.layout=t,i}flowStagesNode(e,t=null){const n=this.flow,r=this.vars,i=this.declarations,a=this.cache,c=this.buildStage,h=this.stack,p={code:""};this.flow=p,this.vars={},this.declarations={},this.cache=new UV,this.stack=sV();for(const v of Ame)this.setBuildStage(v),p.result=e.build(this,t);return p.vars=this.getVars(this.shaderStage),this.flow=n,this.vars=r,this.declarations=i,this.cache=a,this.stack=h,this.setBuildStage(c),p}getFunctionOperator(){return null}buildFunctionCode(){console.warn("Abstract function.")}flowChildNode(e,t=null){const n=this.flow,r={code:""};return this.flow=r,r.result=e.build(this,t),this.flow=n,r}flowNodeFromShaderStage(e,t,n=null,r=null){const i=this.tab,a=this.cache,c=this.shaderStage,h=this.context;this.setShaderStage(e);const p={...this.context};delete p.nodeBlock,this.cache=this.globalCache,this.tab="	",this.context=p;let v=null;if(this.buildStage==="generate"){const x=this.flowChildNode(t,n);r!==null&&(x.code+=`${this.tab+r} = ${x.result};
`),this.flowCode[e]=this.flowCode[e]+x.code,v=x}else v=t.build(this);return this.setShaderStage(c),this.cache=a,this.tab=i,this.context=h,v}getAttributesArray(){return this.attributes.concat(this.bufferAttributes)}getAttributes(){console.warn("Abstract function.")}getVaryings(){console.warn("Abstract function.")}getVar(e,t,n=null){return`${n!==null?this.generateArrayDeclaration(e,n):this.getType(e)} ${t}`}getVars(e){let t="";const n=this.vars[e];if(n!==void 0)for(const r of n)t+=`${this.getVar(r.type,r.name)}; `;return t}getUniforms(){console.warn("Abstract function.")}getCodes(e){const t=this.codes[e];let n="";if(t!==void 0)for(const r of t)n+=r.code+`
`;return n}getHash(){return this.vertexShader+this.fragmentShader+this.computeShader}setShaderStage(e){this.shaderStage=e}getShaderStage(){return this.shaderStage}setBuildStage(e){this.buildStage=e}getBuildStage(){return this.buildStage}buildCode(){console.warn("Abstract function.")}build(){const{object:e,material:t,renderer:n}=this;if(t!==null){let r=n.library.fromMaterial(t);r===null&&(console.error(`NodeMaterial: Material "${t.type}" is not compatible.`),r=new sa),r.build(this)}else this.addFlow("compute",e);for(const r of Ame){this.setBuildStage(r),this.context.vertex&&this.context.vertex.isNode&&this.flowNodeFromShaderStage("vertex",this.context.vertex);for(const i of Pme){this.setShaderStage(i);const a=this.flowNodes[i];for(const c of a)r==="generate"?this.flowNode(c):c.build(this)}}return this.setBuildStage(null),this.setShaderStage(null),this.buildCode(),this.buildUpdateNodes(),this}getNodeUniform(e,t){if(t==="float"||t==="int"||t==="uint")return new Cze(e);if(t==="vec2"||t==="ivec2"||t==="uvec2")return new Aze(e);if(t==="vec3"||t==="ivec3"||t==="uvec3")return new Pze(e);if(t==="vec4"||t==="ivec4"||t==="uvec4")return new Rze(e);if(t==="color")return new kze(e);if(t==="mat2")return new Ize(e);if(t==="mat3")return new Nze(e);if(t==="mat4")return new Dze(e);throw new Error(`Uniform "${t}" not declared.`)}format(e,t,n){if(t=this.getVectorType(t),n=this.getVectorType(n),t===n||n===null||this.isReference(n))return e;const r=this.getTypeLength(t),i=this.getTypeLength(n);return r===16&&i===9?`${this.getType(n)}( ${e}[ 0 ].xyz, ${e}[ 1 ].xyz, ${e}[ 2 ].xyz )`:r===9&&i===4?`${this.getType(n)}( ${e}[ 0 ].xy, ${e}[ 1 ].xy )`:r>4||i>4||i===0?e:r===i?`${this.getType(n)}( ${e} )`:r>i?(e=n==="bool"?`all( ${e} )`:`${e}.${"xyz".slice(0,i)}`,this.format(e,this.getTypeFromLength(i,this.getComponentType(t)),n)):i===4&&r>1?`${this.getType(n)}( ${this.format(e,t,"vec3")}, 1.0 )`:r===2?`${this.getType(n)}( ${this.format(e,t,"vec2")}, 0.0 )`:(r===1&&i>1&&t!==this.getComponentType(n)&&(e=`${this.getType(this.getComponentType(n))}( ${e} )`),`${this.getType(n)}( ${e} )`)}getSignature(){return`// Three.js r${r3e} - Node System
`}*[Symbol.iterator](){}createNodeMaterial(e="NodeMaterial"){throw new Error(`THREE.NodeBuilder: createNodeMaterial() was deprecated. Use new ${e}() instead.`)}}class kge{constructor(){this.time=0,this.deltaTime=0,this.frameId=0,this.renderId=0,this.updateMap=new WeakMap,this.updateBeforeMap=new WeakMap,this.updateAfterMap=new WeakMap,this.renderer=null,this.material=null,this.camera=null,this.object=null,this.scene=null}_getMaps(e,t){let n=e.get(t);return n===void 0&&(n={renderMap:new WeakMap,frameMap:new WeakMap},e.set(t,n)),n}updateBeforeNode(e){const t=e.getUpdateBeforeType(),n=e.updateReference(this);if(t===vi.FRAME){const{frameMap:r}=this._getMaps(this.updateBeforeMap,n);r.get(n)!==this.frameId&&e.updateBefore(this)!==!1&&r.set(n,this.frameId)}else if(t===vi.RENDER){const{renderMap:r}=this._getMaps(this.updateBeforeMap,n);r.get(n)!==this.renderId&&e.updateBefore(this)!==!1&&r.set(n,this.renderId)}else t===vi.OBJECT&&e.updateBefore(this)}updateAfterNode(e){const t=e.getUpdateAfterType(),n=e.updateReference(this);if(t===vi.FRAME){const{frameMap:r}=this._getMaps(this.updateAfterMap,n);r.get(n)!==this.frameId&&e.updateAfter(this)!==!1&&r.set(n,this.frameId)}else if(t===vi.RENDER){const{renderMap:r}=this._getMaps(this.updateAfterMap,n);r.get(n)!==this.renderId&&e.updateAfter(this)!==!1&&r.set(n,this.renderId)}else t===vi.OBJECT&&e.updateAfter(this)}updateNode(e){const t=e.getUpdateType(),n=e.updateReference(this);if(t===vi.FRAME){const{frameMap:r}=this._getMaps(this.updateMap,n);r.get(n)!==this.frameId&&e.update(this)!==!1&&r.set(n,this.frameId)}else if(t===vi.RENDER){const{renderMap:r}=this._getMaps(this.updateMap,n);r.get(n)!==this.renderId&&e.update(this)!==!1&&r.set(n,this.renderId)}else t===vi.OBJECT&&e.update(this)}update(){this.frameId++,this.lastTime===void 0&&(this.lastTime=performance.now()),this.deltaTime=(performance.now()-this.lastTime)/1e3,this.lastTime=performance.now(),this.time+=this.deltaTime}}class BW{constructor(e,t,n=null,r="",i=!1){this.type=e,this.name=t,this.count=n,this.qualifier=r,this.isConst=i}}BW.isNodeFunctionInput=!0;class Fze extends A6{static get type(){return"DirectionalLightNode"}constructor(e=null){super(e)}setupDirect(){const e=this.colorNode;return{lightDirection:X4e(this.light),lightColor:e}}}const zV=new Ts,YR=new Ts;let Tw=null;class Lze extends A6{static get type(){return"RectAreaLightNode"}constructor(e=null){super(e),this.halfHeight=Gr(new yt).setGroup(Vr),this.halfWidth=Gr(new yt).setGroup(Vr),this.updateType=vi.RENDER}update(e){super.update(e);const{light:t}=this,n=e.camera.matrixWorldInverse;YR.identity(),zV.copy(t.matrixWorld),zV.premultiply(n),YR.extractRotation(zV),this.halfWidth.value.set(t.width*.5,0,0),this.halfHeight.value.set(0,t.height*.5,0),this.halfWidth.value.applyMatrix4(YR),this.halfHeight.value.applyMatrix4(YR)}setupDirectRectArea(e){let t,n;e.isAvailable("float32Filterable")?(t=Vi(Tw.LTC_FLOAT_1),n=Vi(Tw.LTC_FLOAT_2)):(t=Vi(Tw.LTC_HALF_1),n=Vi(Tw.LTC_HALF_2));const{colorNode:r,light:i}=this,a=q4e(i);return{lightColor:r,lightPosition:a,halfWidth:this.halfWidth,halfHeight:this.halfHeight,ltc_1:t,ltc_2:n}}static setLTC(e){Tw=e}}class UW extends A6{static get type(){return"SpotLightNode"}constructor(e=null){super(e),this.coneCosNode=Gr(0).setGroup(Vr),this.penumbraCosNode=Gr(0).setGroup(Vr),this.cutoffDistanceNode=Gr(0).setGroup(Vr),this.decayExponentNode=Gr(0).setGroup(Vr),this.colorNode=Gr(this.color).setGroup(Vr)}update(e){super.update(e);const{light:t}=this;this.coneCosNode.value=Math.cos(t.angle),this.penumbraCosNode.value=Math.cos(t.angle*(1-t.penumbra)),this.cutoffDistanceNode.value=t.distance,this.decayExponentNode.value=t.decay}getSpotAttenuation(e,t){const{coneCosNode:n,penumbraCosNode:r}=this;return Z3(n,r,t)}getLightCoord(e){const t=e.getNodeProperties(this);let n=t.projectionUV;return n===void 0&&(n=KBe(this.light,e.context.positionWorld),t.projectionUV=n),n}setupDirect(e){const{colorNode:t,cutoffDistanceNode:n,decayExponentNode:r,light:i}=this,a=this.getLightVector(e),c=a.normalize(),h=c.dot(X4e(i)),p=this.getSpotAttenuation(e,h),v=a.length(),x=Q4e({lightDistance:v,cutoffDistance:n,decayExponent:r});let S=t.mul(p).mul(x),C,I;return i.colorNode?(I=this.getLightCoord(e),C=i.colorNode(I)):i.map&&(I=this.getLightCoord(e),C=Vi(i.map,I.xy).onRenderUpdate(()=>i.map)),C&&(S=I.mul(2).sub(1).abs().lessThan(1).all().select(S.mul(C),S)),{lightColor:S,lightDirection:c}}}class Bze extends UW{static get type(){return"IESSpotLightNode"}getSpotAttenuation(e,t){const n=this.light.iesMap;let r=null;if(n&&n.isTexture===!0){const i=t.acos().mul(1/Math.PI);r=Vi(n,In(i,0),0).r}else r=super.getSpotAttenuation(t);return r}}const Uze=cn(([o,e])=>{const t=o.abs().sub(e);return Pg(W0(t,0)).add(H_(W0(t.x,t.y),0))});class zze extends UW{static get type(){return"ProjectorLightNode"}update(e){super.update(e);const t=this.light;if(this.penumbraCosNode.value=Math.min(Math.cos(t.angle*(1-t.penumbra)),.99999),t.aspect===null){let n=1;t.map!==null&&(n=t.map.width/t.map.height),t.shadow.aspect=n}else t.shadow.aspect=t.aspect}getSpotAttenuation(e){const t=this.penumbraCosNode,n=this.getLightCoord(e),r=n.xyz.div(n.w),i=Uze(r.xy.sub(In(.5)),In(.5)),a=r1(-1,Rl(1,s4e(t)).sub(1));return f4e(i.mul(-2).mul(a))}}class Vze extends A6{static get type(){return"AmbientLightNode"}constructor(e=null){super(e)}setup({context:e}){e.irradiance.addAssign(this.colorNode)}}class Gze extends A6{static get type(){return"HemisphereLightNode"}constructor(e=null){super(e),this.lightPositionNode=$4e(e),this.lightDirectionNode=this.lightPositionNode.normalize(),this.groundColorNode=Gr(new qi).setGroup(Vr)}update(e){const{light:t}=this;super.update(e),this.lightPositionNode.object3d=t,this.groundColorNode.value.copy(t.groundColor).multiplyScalar(t.intensity)}setup(e){const{colorNode:t,groundColorNode:n,lightDirectionNode:r}=this,a=PW.dot(r).mul(.5).add(.5),c=Zs(n,t,a);e.context.irradiance.addAssign(c)}}class jze extends A6{static get type(){return"LightProbeNode"}constructor(e=null){super(e);const t=[];for(let n=0;n<9;n++)t.push(new yt);this.lightProbe=Kp(t)}update(e){const{light:t}=this;super.update(e);for(let n=0;n<9;n++)this.lightProbe.array[n].copy(t.sh.coefficients[n]).multiplyScalar(t.intensity)}setup(e){const t=nze(PW,this.lightProbe);e.context.irradiance.addAssign(t)}}const Ige=new WeakMap;class Hze extends sx{static get type(){return"EnvironmentNode"}constructor(e=null){super(),this.envNode=e}setup(e){const{material:t}=e;let n=this.envNode;if(n.isTextureNode||n.isMaterialReferenceNode){const x=n.isTextureNode?n.value:t[n.property];let S=Ige.get(x);S===void 0&&(S=e5e(x),Ige.set(x,S)),n=S}const i=t.useAnisotropy===!0||t.anisotropy>0?pLe:ra,a=n.context(Nge(vg,i)).mul(hV),c=n.context(Wze(RW)).mul(Math.PI).mul(hV),h=Pk(a),p=Pk(c);e.context.radiance.addAssign(h),e.context.iblIrradiance.addAssign(p);const v=e.context.lightingModel.clearcoatRadiance;if(v){const x=n.context(Nge(aI,Hw)).mul(hV),S=Pk(x);v.addAssign(S)}}}const Nge=(o,e)=>{let t=null;return{getUV:()=>(t===null&&(t=_o.negate().reflect(e),t=o.mul(o).mix(t,e).normalize(),t=t.transformDirection(Lg)),t),getTextureLevel:()=>o}},Wze=o=>({getUV:()=>o,getTextureLevel:()=>$t(1)});class zW extends sx{static get type(){return"BasicEnvironmentNode"}constructor(e=null){super(),this.envNode=e}setup(e){e.context.environment=a5e(this.envNode)}}class u5e{parseFunction(){console.warn("Abstract function.")}}class VW{constructor(e,t,n="",r=""){this.type=e,this.inputs=t,this.name=n,this.precision=r}getCode(){console.warn("Abstract function.")}}VW.isNodeFunction=!0;const $ze=/^\s*(highp|mediump|lowp)?\s*([a-z_0-9]+)\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)/i,qze=/[a-z_0-9]+/ig,Dge="#pragma main",Xze=o=>{o=o.trim();const e=o.indexOf(Dge),t=e!==-1?o.slice(e+Dge.length):o,n=t.match($ze);if(n!==null&&n.length===5){const r=n[4],i=[];let a=null;for(;(a=qze.exec(r))!==null;)i.push(a);const c=[];let h=0;for(;h<i.length;){const I=i[h][0]==="const";I===!0&&h++;let L=i[h][0];L==="in"||L==="out"||L==="inout"?h++:L="";const U=i[h++][0];let R=Number.parseInt(i[h][0]);Number.isNaN(R)===!1?h++:R=null;const $=i[h++][0];c.push(new BW(U,$,R,L,I))}const p=t.substring(n[0].length),v=n[3]!==void 0?n[3]:"",x=n[2],S=n[1]!==void 0?n[1]:"",C=e!==-1?o.slice(0,e):"";return{type:x,inputs:c,name:v,precision:S,inputsCode:r,blockCode:p,headerCode:C}}else throw new Error("FunctionNode: Function is not a GLSL code.")};class Yze extends VW{constructor(e){const{type:t,inputs:n,name:r,precision:i,inputsCode:a,blockCode:c,headerCode:h}=Xze(e);super(t,n,r,i),this.inputsCode=a,this.blockCode=c,this.headerCode=h}getCode(e=this.name){let t;const n=this.blockCode;if(n!==""){const{type:r,inputsCode:i,headerCode:a,precision:c}=this;let h=`${r} ${e} ( ${i.trim()} )`;c!==""&&(h=`${c} ${h}`),t=a+h+n}else t="";return t}}class Kze extends u5e{parseFunction(e){return new Yze(e)}}class h5e extends UI{constructor(){super()}indirect({context:e}){const t=e.ambientOcclusion,n=e.reflectedLight,r=e.irradianceLightMap;n.indirectDiffuse.assign(ei(0)),r?n.indirectDiffuse.addAssign(r):n.indirectDiffuse.addAssign(ei(1,1,1,0)),n.indirectDiffuse.mulAssign(t),n.indirectDiffuse.mulAssign($i.rgb)}finish(e){const{material:t,context:n}=e,r=n.outgoingLight,i=e.context.environment;if(i)switch(t.combine){case SI:r.rgb.assign(Zs(r.rgb,r.rgb.mul(i.rgb),kk.mul(dV)));break;case zIe:r.rgb.assign(Zs(r.rgb,i.rgb,kk.mul(dV)));break;case VIe:r.rgb.addAssign(i.rgb.mul(kk.mul(dV)));break;default:console.warn("THREE.BasicLightingModel: Unsupported .combine value:",t.combine);break}}}const Zze=()=>$t(.25),Qze=cn(({dotNH:o})=>Wj.mul($t(.5)).add(1).mul($t(1/Math.PI)).mul(o.pow(Wj))),Jze=cn(({lightDirection:o})=>{const e=o.add(_o).normalize(),t=ra.dot(e).clamp(),n=_o.dot(e).clamp(),r=kE({f0:_u,f90:1,dotVH:n}),i=Zze(),a=Qze({dotNH:t});return r.mul(i).mul(a)});class d5e extends h5e{constructor(e=!0){super(),this.specular=e}direct({lightDirection:e,lightColor:t,reflectedLight:n}){const i=ra.dot(e).clamp().mul(t);n.directDiffuse.addAssign(i.mul($_({diffuseColor:$i.rgb}))),this.specular===!0&&n.directSpecular.addAssign(i.mul(Jze({lightDirection:e})).mul(kk))}indirect(e){const{ambientOcclusion:t,irradiance:n,reflectedLight:r}=e.context;r.indirectDiffuse.addAssign(n.mul($_({diffuseColor:$i}))),r.indirectDiffuse.mulAssign(t)}}const f5e=cn(o=>{const{dotNV:e,specularColor:t,specularF90:n,roughness:r}=o,i=t5e({dotNV:e,roughness:r});return t.mul(i.x).add(n.mul(i.y))}),eVe=cn(({roughness:o,dotNH:e})=>{const t=o.pow2(),n=$t(1).div(t),i=e.pow2().oneMinus().max(.0078125);return $t(2).add(n).mul(i.pow(n.mul(.5))).div(2*Math.PI)}).setLayout({name:"D_Charlie",type:"float",inputs:[{name:"roughness",type:"float"},{name:"dotNH",type:"float"}]}),tVe=cn(({dotNV:o,dotNL:e})=>$t(1).div($t(4).mul(e.add(o).sub(e.mul(o))))).setLayout({name:"V_Neubelt",type:"float",inputs:[{name:"dotNV",type:"float"},{name:"dotNL",type:"float"}]}),nVe=cn(({lightDirection:o})=>{const e=o.add(_o).normalize(),t=ra.dot(o).clamp(),n=ra.dot(_o).clamp(),r=ra.dot(e).clamp(),i=eVe({roughness:gW,dotNH:r}),a=tVe({dotNV:n,dotNL:t});return m_.mul(i).mul(a)}),rVe=cn(({N:o,V:e,roughness:t})=>{const i=.0078125,a=o.dot(e).saturate(),c=In(t,a.oneMinus().sqrt());return c.assign(c.mul(.984375).add(i)),c}).setLayout({name:"LTC_Uv",type:"vec2",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"roughness",type:"float"}]}),iVe=cn(({f:o})=>{const e=o.length();return W0(e.mul(e).add(o.z).div(e.add(1)),0)}).setLayout({name:"LTC_ClippedSphereFormFactor",type:"float",inputs:[{name:"f",type:"vec3"}]}),KR=cn(({v1:o,v2:e})=>{const t=o.dot(e),n=t.abs().toVar(),r=n.mul(.0145206).add(.4965155).mul(n).add(.8543985).toVar(),i=n.add(4.1616724).mul(n).add(3.417594).toVar(),a=r.div(i),c=t.greaterThan(0).select(a,W0(t.mul(t).oneMinus(),1e-7).inverseSqrt().mul(.5).sub(a));return o.cross(e).mul(c)}).setLayout({name:"LTC_EdgeVectorFormFactor",type:"vec3",inputs:[{name:"v1",type:"vec3"},{name:"v2",type:"vec3"}]}),Oge=cn(({N:o,V:e,P:t,mInv:n,p0:r,p1:i,p2:a,p3:c})=>{const h=i.sub(r).toVar(),p=c.sub(r).toVar(),v=h.cross(p),x=Yt().toVar();return Wo(v.dot(t.sub(r)).greaterThanEqual(0),()=>{const S=e.sub(o.mul(e.dot(o))).normalize(),C=o.cross(S).negate(),I=n.mul(Dl(S,C,o).transpose()).toVar(),L=I.mul(r.sub(t)).normalize().toVar(),U=I.mul(i.sub(t)).normalize().toVar(),R=I.mul(a.sub(t)).normalize().toVar(),$=I.mul(c.sub(t)).normalize().toVar(),Z=Yt(0).toVar();Z.addAssign(KR({v1:L,v2:U})),Z.addAssign(KR({v1:U,v2:R})),Z.addAssign(KR({v1:R,v2:$})),Z.addAssign(KR({v1:$,v2:L})),x.assign(Yt(iVe({f:Z})))}),x}).setLayout({name:"LTC_Evaluate",type:"vec3",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"P",type:"vec3"},{name:"mInv",type:"mat3"},{name:"p0",type:"vec3"},{name:"p1",type:"vec3"},{name:"p2",type:"vec3"},{name:"p3",type:"vec3"}]}),Fge=cn(([o,e,t,n,r])=>{const i=Yt(p4e(e.negate(),AE(o),r1(1,n))),a=Yt(Pg(r[0].xyz),Pg(r[1].xyz),Pg(r[2].xyz));return AE(i).mul(t.mul(a))}).setLayout({name:"getVolumeTransmissionRay",type:"vec3",inputs:[{name:"n",type:"vec3"},{name:"v",type:"vec3"},{name:"thickness",type:"float"},{name:"ior",type:"float"},{name:"modelMatrix",type:"mat4"}]}),sVe=cn(([o,e])=>o.mul(Dg(e.mul(2).sub(2),0,1))).setLayout({name:"applyIorToRoughness",type:"float",inputs:[{name:"roughness",type:"float"},{name:"ior",type:"float"}]}),oVe=k4e(),aVe=k4e(),Lge=cn(([o,e,t],{material:n})=>{const i=(n.side===Ec?oVe:aVe).sample(o),a=Ag(qj.x).mul(sVe(e,t));return PBe(i,a)}),Bge=cn(([o,e,t])=>(Wo(t.notEqual(0),()=>{const n=i4e(e).negate().div(t);return r4e(n.negate().mul(o))}),Yt(1))).setLayout({name:"volumeAttenuation",type:"vec3",inputs:[{name:"transmissionDistance",type:"float"},{name:"attenuationColor",type:"vec3"},{name:"attenuationDistance",type:"float"}]}),lVe=cn(([o,e,t,n,r,i,a,c,h,p,v,x,S,C,I])=>{let L,U;if(I){L=ei().toVar(),U=Yt().toVar();const ie=v.sub(1).mul(I.mul(.025)),ue=Yt(v.sub(ie),v,v.add(ie));cf({start:0,end:3},({i:ce})=>{const Q=ue.element(ce),ae=Fge(o,e,x,Q,c),le=a.add(ae),J=p.mul(h.mul(ei(le,1))),Ue=In(J.xy.div(J.w)).toVar();Ue.addAssign(1),Ue.divAssign(2),Ue.assign(In(Ue.x,Ue.y.oneMinus()));const je=Lge(Ue,t,Q);L.element(ce).assign(je.element(ce)),L.a.addAssign(je.a),U.element(ce).assign(n.element(ce).mul(Bge(Pg(ae),S,C).element(ce)))}),L.a.divAssign(3)}else{const ie=Fge(o,e,x,v,c),ue=a.add(ie),ce=p.mul(h.mul(ei(ue,1))),Q=In(ce.xy.div(ce.w)).toVar();Q.addAssign(1),Q.divAssign(2),Q.assign(In(Q.x,Q.y.oneMinus())),L=Lge(Q,t,v),U=n.mul(Bge(Pg(ie),S,C))}const R=U.rgb.mul(L.rgb),$=o.dot(e).clamp(),Z=Yt(f5e({dotNV:$,specularColor:r,specularF90:i,roughness:t})),k=U.r.add(U.g,U.b).div(3);return ei(Z.oneMinus().mul(R),L.a.oneMinus().mul(k).oneMinus())}),cVe=Dl(3.2404542,-.969266,.0556434,-1.5371385,1.8760108,-.2040259,-.4985314,.041556,1.0572252),uVe=o=>{const e=o.sqrt();return Yt(1).add(e).div(Yt(1).sub(e))},Uge=(o,e)=>o.sub(e).div(o.add(e)).pow2(),hVe=(o,e)=>{const t=o.mul(2*Math.PI*1e-9),n=Yt(54856e-17,44201e-17,52481e-17),r=Yt(1681e3,1795300,2208400),i=Yt(43278e5,93046e5,66121e5),a=$t(9747e-17*Math.sqrt(2*Math.PI*45282e5)).mul(t.mul(2239900).add(e.x).cos()).mul(t.pow2().mul(-45282e5).exp());let c=n.mul(i.mul(2*Math.PI).sqrt()).mul(r.mul(t).add(e).cos()).mul(t.pow2().negate().mul(i).exp());return c=Yt(c.x.add(a),c.y,c.z).div(10685e-11),cVe.mul(c)},dVe=cn(({outsideIOR:o,eta2:e,cosTheta1:t,thinFilmThickness:n,baseF0:r})=>{const i=Zs(o,e,Z3(0,.03,n)),c=o.div(i).pow2().mul(t.pow2().oneMinus()).oneMinus();Wo(c.lessThan(0),()=>Yt(1));const h=c.sqrt(),p=Uge(i,o),v=kE({f0:p,f90:1,dotVH:t}),x=v.oneMinus(),S=i.lessThan(o).select(Math.PI,0),C=$t(Math.PI).sub(S),I=uVe(r.clamp(0,.9999)),L=Uge(I,i.toVec3()),U=kE({f0:L,f90:1,dotVH:h}),R=Yt(I.x.lessThan(i).select(Math.PI,0),I.y.lessThan(i).select(Math.PI,0),I.z.lessThan(i).select(Math.PI,0)),$=i.mul(n,h,2),Z=Yt(C).add(R),k=v.mul(U).clamp(1e-5,.9999),ie=k.sqrt(),ue=x.pow2().mul(U).div(Yt(1).sub(k)),Q=v.add(ue).toVar(),ae=ue.sub(x).toVar();return cf({start:1,end:2,condition:"<=",name:"m"},({m:le})=>{ae.mulAssign(ie);const J=hVe($t(le).mul($),$t(le).mul(Z)).mul(2);Q.addAssign(ae.mul(J))}),Q.max(Yt(0))}).setLayout({name:"evalIridescence",type:"vec3",inputs:[{name:"outsideIOR",type:"float"},{name:"eta2",type:"float"},{name:"cosTheta1",type:"float"},{name:"thinFilmThickness",type:"float"},{name:"baseF0",type:"vec3"}]}),fVe=cn(({normal:o,viewDir:e,roughness:t})=>{const n=o.dot(e).saturate(),r=t.pow2(),i=G0(t.lessThan(.25),$t(-339.2).mul(r).add($t(161.4).mul(t)).sub(25.9),$t(-8.48).mul(r).add($t(14.3).mul(t)).sub(9.95)),a=G0(t.lessThan(.25),$t(44).mul(r).sub($t(23.7).mul(t)).add(3.26),$t(1.97).mul(r).sub($t(3.27).mul(t)).add(.72));return G0(t.lessThan(.25),0,$t(.1).mul(t).sub(.025)).add(i.mul(n).add(a).exp()).mul(1/Math.PI).saturate()}),VV=Yt(.04),GV=$t(1);class p5e extends UI{constructor(e=!1,t=!1,n=!1,r=!1,i=!1,a=!1){super(),this.clearcoat=e,this.sheen=t,this.iridescence=n,this.anisotropy=r,this.transmission=i,this.dispersion=a,this.clearcoatRadiance=null,this.clearcoatSpecularDirect=null,this.clearcoatSpecularIndirect=null,this.sheenSpecularDirect=null,this.sheenSpecularIndirect=null,this.iridescenceFresnel=null,this.iridescenceF0=null}start(e){if(this.clearcoat===!0&&(this.clearcoatRadiance=Yt().toVar("clearcoatRadiance"),this.clearcoatSpecularDirect=Yt().toVar("clearcoatSpecularDirect"),this.clearcoatSpecularIndirect=Yt().toVar("clearcoatSpecularIndirect")),this.sheen===!0&&(this.sheenSpecularDirect=Yt().toVar("sheenSpecularDirect"),this.sheenSpecularIndirect=Yt().toVar("sheenSpecularIndirect")),this.iridescence===!0){const t=ra.dot(_o).clamp();this.iridescenceFresnel=dVe({outsideIOR:$t(1),eta2:K3e,cosTheta1:t,thinFilmThickness:Z3e,baseF0:_u}),this.iridescenceF0=eze({f:this.iridescenceFresnel,f90:1,dotVH:t})}if(this.transmission===!0){const t=PE,n=kFe.sub(PE).normalize(),r=RW,i=e.context;i.backdrop=lVe(r,n,vg,$i,_u,lI,t,E6,Lg,AW,Ck,Q3e,e4e,J3e,this.dispersion?t4e:null),i.backdropAlpha=$j,$i.a.mulAssign(Zs(1,i.backdrop.a,$j))}super.start(e)}computeMultiscattering(e,t,n){const r=ra.dot(_o).clamp(),i=t5e({roughness:vg,dotNV:r}),c=(this.iridescenceF0?yW.mix(_u,this.iridescenceF0):_u).mul(i.x).add(n.mul(i.y)),p=i.x.add(i.y).oneMinus(),v=_u.add(_u.oneMinus().mul(.047619)),x=c.mul(v).div(p.mul(v).oneMinus());e.addAssign(c),t.addAssign(x.mul(p))}direct({lightDirection:e,lightColor:t,reflectedLight:n}){const i=ra.dot(e).clamp().mul(t);if(this.sheen===!0&&this.sheenSpecularDirect.addAssign(i.mul(nVe({lightDirection:e}))),this.clearcoat===!0){const c=Hw.dot(e).clamp().mul(t);this.clearcoatSpecularDirect.addAssign(c.mul(Cge({lightDirection:e,f0:VV,f90:GV,roughness:aI,normalView:Hw})))}n.directDiffuse.addAssign(i.mul($_({diffuseColor:$i.rgb}))),n.directSpecular.addAssign(i.mul(Cge({lightDirection:e,f0:_u,f90:1,roughness:vg,iridescence:this.iridescence,f:this.iridescenceFresnel,USE_IRIDESCENCE:this.iridescence,USE_ANISOTROPY:this.anisotropy})))}directRectArea({lightColor:e,lightPosition:t,halfWidth:n,halfHeight:r,reflectedLight:i,ltc_1:a,ltc_2:c}){const h=t.add(n).sub(r),p=t.sub(n).sub(r),v=t.sub(n).add(r),x=t.add(n).add(r),S=ra,C=_o,I=ia.toVar(),L=rVe({N:S,V:C,roughness:vg}),U=a.sample(L).toVar(),R=c.sample(L).toVar(),$=Dl(Yt(U.x,0,U.y),Yt(0,1,0),Yt(U.z,0,U.w)).toVar(),Z=_u.mul(R.x).add(_u.oneMinus().mul(R.y)).toVar();i.directSpecular.addAssign(e.mul(Z).mul(Oge({N:S,V:C,P:I,mInv:$,p0:h,p1:p,p2:v,p3:x}))),i.directDiffuse.addAssign(e.mul($i).mul(Oge({N:S,V:C,P:I,mInv:Dl(1,0,0,0,1,0,0,0,1),p0:h,p1:p,p2:v,p3:x})))}indirect(e){this.indirectDiffuse(e),this.indirectSpecular(e),this.ambientOcclusion(e)}indirectDiffuse(e){const{irradiance:t,reflectedLight:n}=e.context;n.indirectDiffuse.addAssign(t.mul($_({diffuseColor:$i})))}indirectSpecular(e){const{radiance:t,iblIrradiance:n,reflectedLight:r}=e.context;if(this.sheen===!0&&this.sheenSpecularIndirect.addAssign(n.mul(m_,fVe({normal:ra,viewDir:_o,roughness:gW}))),this.clearcoat===!0){const v=Hw.dot(_o).clamp(),x=f5e({dotNV:v,specularColor:VV,specularF90:GV,roughness:aI});this.clearcoatSpecularIndirect.addAssign(this.clearcoatRadiance.mul(x))}const i=Yt().toVar("singleScattering"),a=Yt().toVar("multiScattering"),c=n.mul(1/Math.PI);this.computeMultiscattering(i,a,lI);const h=i.add(a),p=$i.mul(h.r.max(h.g).max(h.b).oneMinus());r.indirectSpecular.addAssign(t.mul(i)),r.indirectSpecular.addAssign(a.mul(c)),r.indirectDiffuse.addAssign(p.mul(c))}ambientOcclusion(e){const{ambientOcclusion:t,reflectedLight:n}=e.context,i=ra.dot(_o).clamp().add(t),a=vg.mul(-16).oneMinus().negate().exp2(),c=t.sub(i.pow(a).oneMinus()).clamp();this.clearcoat===!0&&this.clearcoatSpecularIndirect.mulAssign(t),this.sheen===!0&&this.sheenSpecularIndirect.mulAssign(t),n.indirectDiffuse.mulAssign(t),n.indirectSpecular.mulAssign(c)}finish({context:e}){const{outgoingLight:t}=e;if(this.clearcoat===!0){const n=Hw.dot(_o).clamp(),r=kE({dotVH:n,f0:VV,f90:GV}),i=t.mul(jj.mul(r).oneMinus()).add(this.clearcoatSpecularDirect.add(this.clearcoatSpecularIndirect).mul(jj));t.assign(i)}if(this.sheen===!0){const n=m_.r.max(m_.g).max(m_.b).mul(.157).oneMinus(),r=t.mul(n).add(this.sheenSpecularDirect,this.sheenSpecularIndirect);t.assign(r)}}}const zge=new WeakMap,zp=[],j8=[];class pVe extends t4{constructor(e,t){super(),this.renderer=e,this.backend=t,this.nodeFrame=new kge,this.nodeBuilderCache=new Map,this.callHashCache=new mf,this.groupsData=new mf,this.cacheLib={}}updateGroup(e){const t=e.groupNode,n=t.name;if(n===X3e.name)return!0;if(n===Vr.name){const i=this.get(e),a=this.nodeFrame.renderId;return i.renderId!==a?(i.renderId=a,!0):!1}if(n===zDe.name){const i=this.get(e),a=this.nodeFrame.frameId;return i.frameId!==a?(i.frameId=a,!0):!1}zp[0]=t,zp[1]=e;let r=this.groupsData.get(zp);return r===void 0&&this.groupsData.set(zp,r={}),zp.length=0,r.version!==t.version?(r.version=t.version,!0):!1}getForRenderCacheKey(e){return e.initialCacheKey}getForRender(e){const t=this.get(e);let n=t.nodeBuilderState;if(n===void 0){const{nodeBuilderCache:r}=this,i=this.getForRenderCacheKey(e);if(n=r.get(i),n===void 0){const a=this.backend.createNodeBuilder(e.object,this.renderer);a.scene=e.scene,a.material=e.material,a.camera=e.camera,a.context.material=e.material,a.lightsNode=e.lightsNode,a.environmentNode=this.getEnvironmentNode(e.scene),a.fogNode=this.getFogNode(e.scene),a.clippingContext=e.clippingContext,this.renderer.getOutputRenderTarget()&&this.renderer.getOutputRenderTarget().multiview&&a.enableMultiview(),a.build(),n=this._createNodeBuilderState(a),r.set(i,n)}n.usedTimes++,t.nodeBuilderState=n}return n}delete(e){if(e.isRenderObject){const t=this.get(e).nodeBuilderState;t.usedTimes--,t.usedTimes===0&&this.nodeBuilderCache.delete(this.getForRenderCacheKey(e))}return super.delete(e)}getForCompute(e){const t=this.get(e);let n=t.nodeBuilderState;if(n===void 0){const r=this.backend.createNodeBuilder(e,this.renderer);r.build(),n=this._createNodeBuilderState(r),t.nodeBuilderState=n}return n}_createNodeBuilderState(e){return new sze(e.vertexShader,e.fragmentShader,e.computeShader,e.getAttributesArray(),e.getBindings(),e.updateNodes,e.updateBeforeNodes,e.updateAfterNodes,e.observer,e.transforms)}getEnvironmentNode(e){this.updateEnvironment(e);let t=null;if(e.environmentNode&&e.environmentNode.isNode)t=e.environmentNode;else{const n=this.get(e);n.environmentNode&&(t=n.environmentNode)}return t}getBackgroundNode(e){this.updateBackground(e);let t=null;if(e.backgroundNode&&e.backgroundNode.isNode)t=e.backgroundNode;else{const n=this.get(e);n.backgroundNode&&(t=n.backgroundNode)}return t}getFogNode(e){return this.updateFog(e),e.fogNode||this.get(e).fogNode||null}getCacheKey(e,t){zp[0]=e,zp[1]=t;const n=this.renderer.info.calls,r=this.callHashCache.get(zp)||{};if(r.callId!==n){const i=this.getEnvironmentNode(e),a=this.getFogNode(e);t&&j8.push(t.getCacheKey(!0)),i&&j8.push(i.getCacheKey()),a&&j8.push(a.getCacheKey()),j8.push(this.renderer.getOutputRenderTarget()&&this.renderer.getOutputRenderTarget().multiview?1:0),j8.push(this.renderer.shadowMap.enabled?1:0),r.callId=n,r.cacheKey=iW(j8),this.callHashCache.set(zp,r),j8.length=0}return zp.length=0,r.cacheKey}get isToneMappingState(){return!this.renderer.getRenderTarget()}updateBackground(e){const t=this.get(e),n=e.background;if(n){const r=e.backgroundBlurriness===0&&t.backgroundBlurriness>0||e.backgroundBlurriness>0&&t.backgroundBlurriness===0;if(t.background!==n||r){const i=this.getCacheNode("background",n,()=>{if(n.isCubeTexture===!0||n.mapping===KH||n.mapping===ZH||n.mapping===Sj){if(e.backgroundBlurriness>0||n.mapping===Sj)return e5e(n);{let a;return n.isCubeTexture===!0?a=RE(n):a=Vi(n),a5e(a)}}else{if(n.isTexture===!0)return Vi(n,P_.flipY()).setUpdateMatrix(!0);n.isColor!==!0&&console.error("WebGPUNodes: Unsupported background configuration.",n)}},r);t.backgroundNode=i,t.background=n,t.backgroundBlurriness=e.backgroundBlurriness}}else t.backgroundNode&&(delete t.backgroundNode,delete t.background)}getCacheNode(e,t,n,r=!1){const i=this.cacheLib[e]||(this.cacheLib[e]=new WeakMap);let a=i.get(t);return(a===void 0||r)&&(a=n(),i.set(t,a)),a}updateFog(e){const t=this.get(e),n=e.fog;if(n){if(t.fog!==n){const r=this.getCacheNode("fog",n,()=>{if(n.isFogExp2){const i=Es("color","color",n).setGroup(Vr),a=Es("density","float",n).setGroup(Vr);return hge(i,XBe(a))}else if(n.isFog){const i=Es("color","color",n).setGroup(Vr),a=Es("near","float",n).setGroup(Vr),c=Es("far","float",n).setGroup(Vr);return hge(i,qBe(a,c))}else console.error("THREE.Renderer: Unsupported fog configuration.",n)});t.fogNode=r,t.fog=n}}else delete t.fogNode,delete t.fog}updateEnvironment(e){const t=this.get(e),n=e.environment;if(n){if(t.environment!==n){const r=this.getCacheNode("environment",n,()=>{if(n.isCubeTexture===!0)return RE(n);if(n.isTexture===!0)return Vi(n);console.error("Nodes: Unsupported environment configuration.",n)});t.environmentNode=r,t.environment=n}}else t.environmentNode&&(delete t.environmentNode,delete t.environment)}getNodeFrame(e=this.renderer,t=null,n=null,r=null,i=null){const a=this.nodeFrame;return a.renderer=e,a.scene=t,a.object=n,a.camera=r,a.material=i,a}getNodeFrameForRender(e){return this.getNodeFrame(e.renderer,e.scene,e.object,e.camera,e.material)}getOutputCacheKey(){const e=this.renderer;return e.toneMapping+","+e.currentColorSpace+","+e.xr.isPresenting}hasOutputChange(e){return zge.get(e)!==this.getOutputCacheKey()}getOutputNode(e){const t=this.renderer,n=this.getOutputCacheKey(),r=e.isArrayTexture?DBe(e,Yt(P_,RI("gl_ViewID_OVR"))).renderOutput(t.toneMapping,t.currentColorSpace):Vi(e,P_).renderOutput(t.toneMapping,t.currentColorSpace);return zge.set(e,n),r}updateBefore(e){const t=e.getNodeBuilderState();for(const n of t.updateBeforeNodes)this.getNodeFrameForRender(e).updateBeforeNode(n)}updateAfter(e){const t=e.getNodeBuilderState();for(const n of t.updateAfterNodes)this.getNodeFrameForRender(e).updateAfterNode(n)}updateForCompute(e){const t=this.getNodeFrame(),n=this.getForCompute(e);for(const r of n.updateNodes)t.updateNode(r)}updateForRender(e){const t=this.getNodeFrameForRender(e),n=e.getNodeBuilderState();for(const r of n.updateNodes)t.updateNode(r)}needsRefresh(e){const t=this.getNodeFrameForRender(e);return e.getMonitor().needsRefresh(e,t)}dispose(){super.dispose(),this.nodeFrame=new kge,this.nodeBuilderCache=new Map,this.cacheLib={}}}const jV=new z3;class uI{constructor(e=null){this.version=0,this.clipIntersection=null,this.cacheKey="",this.shadowPass=!1,this.viewNormalMatrix=new Mc,this.clippingGroupContexts=new WeakMap,this.intersectionPlanes=[],this.unionPlanes=[],this.parentVersion=null,e!==null&&(this.viewNormalMatrix=e.viewNormalMatrix,this.clippingGroupContexts=e.clippingGroupContexts,this.shadowPass=e.shadowPass,this.viewMatrix=e.viewMatrix)}projectPlanes(e,t,n){const r=e.length;for(let i=0;i<r;i++){jV.copy(e[i]).applyMatrix4(this.viewMatrix,this.viewNormalMatrix);const a=t[n+i],c=jV.normal;a.x=-c.x,a.y=-c.y,a.z=-c.z,a.w=jV.constant}}updateGlobal(e,t){this.shadowPass=e.overrideMaterial!==null&&e.overrideMaterial.isShadowPassMaterial,this.viewMatrix=t.matrixWorldInverse,this.viewNormalMatrix.getNormalMatrix(this.viewMatrix)}update(e,t){let n=!1;e.version!==this.parentVersion&&(this.intersectionPlanes=Array.from(e.intersectionPlanes),this.unionPlanes=Array.from(e.unionPlanes),this.parentVersion=e.version),this.clipIntersection!==t.clipIntersection&&(this.clipIntersection=t.clipIntersection,this.clipIntersection?this.unionPlanes.length=e.unionPlanes.length:this.intersectionPlanes.length=e.intersectionPlanes.length);const r=t.clippingPlanes,i=r.length;let a,c;if(this.clipIntersection?(a=this.intersectionPlanes,c=e.intersectionPlanes.length):(a=this.unionPlanes,c=e.unionPlanes.length),a.length!==c+i){a.length=c+i;for(let h=0;h<i;h++)a[c+h]=new Ri;n=!0}this.projectPlanes(r,a,c),n&&(this.version++,this.cacheKey=`${this.intersectionPlanes.length}:${this.unionPlanes.length}`)}getGroupContext(e){if(this.shadowPass&&!e.clipShadows)return this;let t=this.clippingGroupContexts.get(e);return t===void 0&&(t=new uI(this),this.clippingGroupContexts.set(e,t)),t.update(this,e),t}get unionClippingCount(){return this.unionPlanes.length}}class mVe{constructor(e,t){this.bundleGroup=e,this.camera=t}}const Mw=[];class gVe{constructor(){this.bundles=new mf}get(e,t){const n=this.bundles;Mw[0]=e,Mw[1]=t;let r=n.get(Mw);return r===void 0&&(r=new mVe(e,t),n.set(Mw,r)),Mw.length=0,r}dispose(){this.bundles=new mf}}class m5e{constructor(){this.lightNodes=new WeakMap,this.materialNodes=new Map,this.toneMappingNodes=new Map}fromMaterial(e){if(e.isNodeMaterial)return e;let t=null;const n=this.getMaterialNodeClass(e.type);if(n!==null){t=new n;for(const r in e)t[r]=e[r]}return t}addToneMapping(e,t){this.addType(e,t,this.toneMappingNodes)}getToneMappingFunction(e){return this.toneMappingNodes.get(e)||null}getMaterialNodeClass(e){return this.materialNodes.get(e)||null}addMaterial(e,t){this.addType(e,t,this.materialNodes)}getLightNodeClass(e){return this.lightNodes.get(e)||null}addLight(e,t){this.addClass(e,t,this.lightNodes)}addType(e,t,n){if(n.has(t)){console.warn(`Redefinition of node ${t}`);return}if(typeof e!="function")throw new Error(`Node class ${e.name} is not a class.`);if(typeof t=="function"||typeof t=="object")throw new Error(`Base class ${t} is not a class.`);n.set(t,e)}addClass(e,t,n){if(n.has(t)){console.warn(`Redefinition of node ${t.name}`);return}if(typeof e!="function")throw new Error(`Node class ${e.name} is not a class.`);if(typeof t!="function")throw new Error(`Base class ${t.name} is not a class.`);n.set(t,e)}}const yVe=new Y4e,Cw=[];class vVe extends mf{constructor(){super()}createNode(e=[]){return new Y4e().setLights(e)}getNode(e,t){if(e.isQuadMesh)return yVe;Cw[0]=e,Cw[1]=t;let n=this.get(Cw);return n===void 0&&(n=this.createNode(),this.set(Cw,n)),Cw.length=0,n}}class _Ve extends bu{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}class ZR extends va{constructor(){super(),this.isGroup=!0,this.type="Group"}}const xVe={type:"move"};class bVe{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new ZR,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new ZR,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new yt,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new yt),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new ZR,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new yt,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new yt),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let r=null,i=null,a=null;const c=this._targetRay,h=this._grip,p=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(p&&e.hand){a=!0;for(const L of e.hand.values()){const U=t.getJointPose(L,n),R=this._getHandJoint(p,L);U!==null&&(R.matrix.fromArray(U.transform.matrix),R.matrix.decompose(R.position,R.rotation,R.scale),R.matrixWorldNeedsUpdate=!0,R.jointRadius=U.radius),R.visible=U!==null}const v=p.joints["index-finger-tip"],x=p.joints["thumb-tip"],S=v.position.distanceTo(x.position),C=.02,I=.005;p.inputState.pinching&&S>C+I?(p.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!p.inputState.pinching&&S<=C-I&&(p.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else h!==null&&e.gripSpace&&(i=t.getPose(e.gripSpace,n),i!==null&&(h.matrix.fromArray(i.transform.matrix),h.matrix.decompose(h.position,h.rotation,h.scale),h.matrixWorldNeedsUpdate=!0,i.linearVelocity?(h.hasLinearVelocity=!0,h.linearVelocity.copy(i.linearVelocity)):h.hasLinearVelocity=!1,i.angularVelocity?(h.hasAngularVelocity=!0,h.angularVelocity.copy(i.angularVelocity)):h.hasAngularVelocity=!1));c!==null&&(r=t.getPose(e.targetRaySpace,n),r===null&&i!==null&&(r=i),r!==null&&(c.matrix.fromArray(r.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),c.matrixWorldNeedsUpdate=!0,r.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(r.linearVelocity)):c.hasLinearVelocity=!1,r.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(r.angularVelocity)):c.hasAngularVelocity=!1,this.dispatchEvent(xVe)))}return c!==null&&(c.visible=r!==null),h!==null&&(h.visible=i!==null),p!==null&&(p.visible=a!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const n=new ZR;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class $w extends C6{constructor(e=1,t=1,n={}){super(e,t,n),this.isXRRenderTarget=!0,this.hasExternalTextures=!1,this.autoAllocateDepthBuffer=!0}copy(e){return super.copy(e),this.hasExternalTextures=e.hasExternalTextures,this.autoAllocateDepthBuffer=e.autoAllocateDepthBuffer,this}}class GW extends Bg{constructor(e=1,t=1,n=1,r=32,i=1,a=!1,c=0,h=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:i,openEnded:a,thetaStart:c,thetaLength:h};const p=this;r=Math.floor(r),i=Math.floor(i);const v=[],x=[],S=[],C=[];let I=0;const L=[],U=n/2;let R=0;$(),a===!1&&(e>0&&Z(!0),t>0&&Z(!1)),this.setIndex(v),this.setAttribute("position",new Nl(x,3)),this.setAttribute("normal",new Nl(S,3)),this.setAttribute("uv",new Nl(C,2));function $(){const k=new yt,ie=new yt;let ue=0;const ce=(t-e)/n;for(let Q=0;Q<=i;Q++){const ae=[],le=Q/i,J=le*(t-e)+e;for(let Ue=0;Ue<=r;Ue++){const je=Ue/r,rt=je*h+c,at=Math.sin(rt),Se=Math.cos(rt);ie.x=J*at,ie.y=-le*n+U,ie.z=J*Se,x.push(ie.x,ie.y,ie.z),k.set(at,ce,Se).normalize(),S.push(k.x,k.y,k.z),C.push(je,1-le),ae.push(I++)}L.push(ae)}for(let Q=0;Q<r;Q++)for(let ae=0;ae<i;ae++){const le=L[ae][Q],J=L[ae+1][Q],Ue=L[ae+1][Q+1],je=L[ae][Q+1];(e>0||ae!==0)&&(v.push(le,J,je),ue+=3),(t>0||ae!==i-1)&&(v.push(J,Ue,je),ue+=3)}p.addGroup(R,ue,0),R+=ue}function Z(k){const ie=I,ue=new pi,ce=new yt;let Q=0;const ae=k===!0?e:t,le=k===!0?1:-1;for(let Ue=1;Ue<=r;Ue++)x.push(0,U*le,0),S.push(0,le,0),C.push(.5,.5),I++;const J=I;for(let Ue=0;Ue<=r;Ue++){const rt=Ue/r*h+c,at=Math.cos(rt),Se=Math.sin(rt);ce.x=ae*Se,ce.y=U*le,ce.z=ae*at,x.push(ce.x,ce.y,ce.z),S.push(0,le,0),ue.x=at*.5+.5,ue.y=Se*.5*le+.5,C.push(ue.x,ue.y),I++}for(let Ue=0;Ue<r;Ue++){const je=ie+Ue,rt=J+Ue;k===!0?v.push(rt,rt+1,je):v.push(rt+1,rt,je),Q+=3}p.addGroup(R,Q,k===!0?1:2),R+=Q}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new GW(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class jW extends Bg{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};const i=e/2,a=t/2,c=Math.floor(n),h=Math.floor(r),p=c+1,v=h+1,x=e/c,S=t/h,C=[],I=[],L=[],U=[];for(let R=0;R<v;R++){const $=R*S-a;for(let Z=0;Z<p;Z++){const k=Z*x-i;I.push(k,-$,0),L.push(0,0,1),U.push(Z/c),U.push(1-R/h)}}for(let R=0;R<h;R++)for(let $=0;$<c;$++){const Z=$+p*R,k=$+p*(R+1),ie=$+1+p*(R+1),ue=$+1+p*R;C.push(Z,k,ue),C.push(k,ie,ue)}this.setIndex(C),this.setAttribute("position",new Nl(I,3)),this.setAttribute("normal",new Nl(L,3)),this.setAttribute("uv",new Nl(U,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new jW(e.width,e.height,e.widthSegments,e.heightSegments)}}const Vge=new yt,Gge=new yt;class SVe extends M6{constructor(e,t=!1){super(),this.enabled=!1,this.isPresenting=!1,this.cameraAutoUpdate=!0,this._renderer=e,this._cameraL=new bu,this._cameraL.viewport=new Ri,this._cameraR=new bu,this._cameraR.viewport=new Ri,this._cameras=[this._cameraL,this._cameraR],this._cameraXR=new _Ve,this._currentDepthNear=null,this._currentDepthFar=null,this._controllers=[],this._controllerInputSources=[],this._xrRenderTarget=null,this._layers=[],this._supportsLayers=!1,this._frameBufferTargets=null,this._createXRLayer=AVe.bind(this),this._gl=null,this._currentAnimationContext=null,this._currentAnimationLoop=null,this._currentPixelRatio=null,this._currentSize=new pi,this._onSessionEvent=TVe.bind(this),this._onSessionEnd=MVe.bind(this),this._onInputSourcesChange=CVe.bind(this),this._onAnimationFrame=PVe.bind(this),this._referenceSpace=null,this._referenceSpaceType="local-floor",this._customReferenceSpace=null,this._framebufferScaleFactor=1,this._foveation=1,this._session=null,this._glBaseLayer=null,this._glBinding=null,this._glProjLayer=null,this._xrFrame=null,this._useLayers=typeof XRWebGLBinding<"u"&&"createProjectionLayer"in XRWebGLBinding.prototype,this._useMultiviewIfPossible=t,this._useMultiview=!1}getController(e){return this._getController(e).getTargetRaySpace()}getControllerGrip(e){return this._getController(e).getGripSpace()}getHand(e){return this._getController(e).getHandSpace()}getFoveation(){if(!(this._glProjLayer===null&&this._glBaseLayer===null))return this._foveation}setFoveation(e){this._foveation=e,this._glProjLayer!==null&&(this._glProjLayer.fixedFoveation=e),this._glBaseLayer!==null&&this._glBaseLayer.fixedFoveation!==void 0&&(this._glBaseLayer.fixedFoveation=e)}getFramebufferScaleFactor(){return this._framebufferScaleFactor}setFramebufferScaleFactor(e){this._framebufferScaleFactor=e,this.isPresenting===!0&&console.warn("THREE.XRManager: Cannot change framebuffer scale while presenting.")}getReferenceSpaceType(){return this._referenceSpaceType}setReferenceSpaceType(e){this._referenceSpaceType=e,this.isPresenting===!0&&console.warn("THREE.XRManager: Cannot change reference space type while presenting.")}getReferenceSpace(){return this._customReferenceSpace||this._referenceSpace}setReferenceSpace(e){this._customReferenceSpace=e}getCamera(){return this._cameraXR}getEnvironmentBlendMode(){if(this._session!==null)return this._session.environmentBlendMode}getFrame(){return this._xrFrame}useMultiview(){return this._useMultiview}createQuadLayer(e,t,n,r,i,a,c,h={}){const p=new jW(e,t),v=new $w(i,a,{format:Ch,type:Il,depthTexture:new t1(i,a,h.stencil?$3:Ho,void 0,void 0,void 0,void 0,void 0,void 0,h.stencil?Mg:e1),stencilBuffer:h.stencil,resolveDepthBuffer:!1,resolveStencilBuffer:!1});v.autoAllocateDepthBuffer=!0;const x=new H3({color:16777215,side:wg});x.map=v.texture,x.map.offset.y=1,x.map.repeat.y=-1;const S=new Og(p,x);S.position.copy(n),S.quaternion.copy(r);const C={type:"quad",width:e,height:t,translation:n,quaternion:r,pixelwidth:i,pixelheight:a,plane:S,material:x,rendercall:c,renderTarget:v};if(this._layers.push(C),this._session!==null){C.plane.material=new H3({color:16777215,side:wg}),C.plane.material.blending=rE,C.plane.material.blendEquation=lf,C.plane.material.blendSrc=B3,C.plane.material.blendDst=B3,C.xrlayer=this._createXRLayer(C);const I=this._session.renderState.layers;I.unshift(C.xrlayer),this._session.updateRenderState({layers:I})}else v.isXRRenderTarget=!1;return S}createCylinderLayer(e,t,n,r,i,a,c,h,p={}){const v=new GW(e,e,e*t/n,64,64,!0,Math.PI-t/2,t),x=new $w(a,c,{format:Ch,type:Il,depthTexture:new t1(a,c,p.stencil?$3:Ho,void 0,void 0,void 0,void 0,void 0,void 0,p.stencil?Mg:e1),stencilBuffer:p.stencil,resolveDepthBuffer:!1,resolveStencilBuffer:!1});x.autoAllocateDepthBuffer=!0;const S=new H3({color:16777215,side:Ec});S.map=x.texture,S.map.offset.y=1,S.map.repeat.y=-1;const C=new Og(v,S);C.position.copy(r),C.quaternion.copy(i);const I={type:"cylinder",radius:e,centralAngle:t,aspectratio:n,translation:r,quaternion:i,pixelwidth:a,pixelheight:c,plane:C,material:S,rendercall:h,renderTarget:x};if(this._layers.push(I),this._session!==null){I.plane.material=new H3({color:16777215,side:Ec}),I.plane.material.blending=rE,I.plane.material.blendEquation=lf,I.plane.material.blendSrc=B3,I.plane.material.blendDst=B3,I.xrlayer=this._createXRLayer(I);const L=this._session.renderState.layers;L.unshift(I.xrlayer),this._session.updateRenderState({layers:L})}else x.isXRRenderTarget=!1;return C}renderLayers(){const e=new yt,t=new nx,n=this._renderer,r=this.isPresenting,i=n.getOutputRenderTarget(),a=n._frameBufferTarget;this.isPresenting=!1;const c=new pi;n.getSize(c);const h=n._quad;for(const p of this._layers)if(p.renderTarget.isXRRenderTarget=this._session!==null,p.renderTarget.hasExternalTextures=p.renderTarget.isXRRenderTarget,p.renderTarget.isXRRenderTarget&&this._supportsLayers){p.xrlayer.transform=new XRRigidTransform(p.plane.getWorldPosition(e),p.plane.getWorldQuaternion(t));const v=this._glBinding.getSubImage(p.xrlayer,this._xrFrame);n.backend.setXRRenderTargetTextures(p.renderTarget,v.colorTexture,void 0),n._setXRLayerSize(p.renderTarget.width,p.renderTarget.height),n.setOutputRenderTarget(p.renderTarget),n.setRenderTarget(null),n._frameBufferTarget=null,this._frameBufferTargets||(this._frameBufferTargets=new WeakMap);const{frameBufferTarget:x,quad:S}=this._frameBufferTargets.get(p.renderTarget)||{frameBufferTarget:null,quad:null};x?(n._frameBufferTarget=x,n._quad=S):(n._quad=new DW(new sa),this._frameBufferTargets.set(p.renderTarget,{frameBufferTarget:n._getFrameBufferTarget(),quad:n._quad})),p.rendercall(),n._frameBufferTarget=null}else n.setRenderTarget(p.renderTarget),p.rendercall();n.setRenderTarget(null),n.setOutputRenderTarget(i),n._frameBufferTarget=a,n._setXRLayerSize(c.x,c.y),n._quad=h,this.isPresenting=r}getSession(){return this._session}async setSession(e){const t=this._renderer,n=t.backend;this._gl=t.getContext();const r=this._gl,i=r.getContextAttributes();if(this._session=e,e!==null){if(n.isWebGPUBackend===!0)throw new Error('THREE.XRManager: XR is currently not supported with a WebGPU backend. Use WebGL by passing "{ forceWebGL: true }" to the constructor of the renderer.');if(e.addEventListener("select",this._onSessionEvent),e.addEventListener("selectstart",this._onSessionEvent),e.addEventListener("selectend",this._onSessionEvent),e.addEventListener("squeeze",this._onSessionEvent),e.addEventListener("squeezestart",this._onSessionEvent),e.addEventListener("squeezeend",this._onSessionEvent),e.addEventListener("end",this._onSessionEnd),e.addEventListener("inputsourceschange",this._onInputSourcesChange),await n.makeXRCompatible(),this._currentPixelRatio=t.getPixelRatio(),t.getSize(this._currentSize),this._currentAnimationContext=t._animation.getContext(),this._currentAnimationLoop=t._animation.getAnimationLoop(),t._animation.stop(),this._useLayers===!0){let a=null,c=null,h=null;t.depth&&(h=t.stencil?r.DEPTH24_STENCIL8:r.DEPTH_COMPONENT24,a=t.stencil?Mg:e1,c=t.stencil?$3:Ho);const p={colorFormat:r.RGBA8,depthFormat:h,scaleFactor:this._framebufferScaleFactor,clearOnAccess:!1};this._useMultiviewIfPossible&&t.hasFeature("OVR_multiview2")&&(p.textureType="texture-array",this._useMultiview=!0);const v=new XRWebGLBinding(e,r),x=v.createProjectionLayer(p),S=[x];this._glBinding=v,this._glProjLayer=x,t.setPixelRatio(1),t._setXRLayerSize(x.textureWidth,x.textureHeight);const C=this._useMultiview?2:1,I=new t1(x.textureWidth,x.textureHeight,c,void 0,void 0,void 0,void 0,void 0,void 0,a,C);if(this._xrRenderTarget=new $w(x.textureWidth,x.textureHeight,{format:Ch,type:Il,colorSpace:t.outputColorSpace,depthTexture:I,stencilBuffer:t.stencil,samples:i.antialias?4:0,resolveDepthBuffer:x.ignoreDepthValues===!1,resolveStencilBuffer:x.ignoreDepthValues===!1,depth:this._useMultiview?2:1,multiview:this._useMultiview}),this._xrRenderTarget.hasExternalTextures=!0,this._xrRenderTarget.depth=this._useMultiview?2:1,this._supportsLayers=e.enabledFeatures.includes("layers"),this._referenceSpace=await e.requestReferenceSpace(this.getReferenceSpaceType()),this._supportsLayers)for(const L of this._layers)L.plane.material=new H3({color:16777215,side:L.type==="cylinder"?Ec:wg}),L.plane.material.blending=rE,L.plane.material.blendEquation=lf,L.plane.material.blendSrc=B3,L.plane.material.blendDst=B3,L.xrlayer=this._createXRLayer(L),S.unshift(L.xrlayer);e.updateRenderState({layers:S})}else{const a={antialias:t.samples>0,alpha:!0,depth:t.depth,stencil:t.stencil,framebufferScaleFactor:this.getFramebufferScaleFactor()},c=new XRWebGLLayer(e,r,a);this._glBaseLayer=c,e.updateRenderState({baseLayer:c}),t.setPixelRatio(1),t._setXRLayerSize(c.framebufferWidth,c.framebufferHeight),this._xrRenderTarget=new $w(c.framebufferWidth,c.framebufferHeight,{format:Ch,type:Il,colorSpace:t.outputColorSpace,stencilBuffer:t.stencil,resolveDepthBuffer:c.ignoreDepthValues===!1,resolveStencilBuffer:c.ignoreDepthValues===!1}),this._referenceSpace=await e.requestReferenceSpace(this.getReferenceSpaceType())}this.setFoveation(this.getFoveation()),t._animation.setAnimationLoop(this._onAnimationFrame),t._animation.setContext(e),t._animation.start(),this.isPresenting=!0,this.dispatchEvent({type:"sessionstart"})}}updateCamera(e){const t=this._session;if(t===null)return;const n=e.near,r=e.far,i=this._cameraXR,a=this._cameraL,c=this._cameraR;i.near=c.near=a.near=n,i.far=c.far=a.far=r,i.isMultiViewCamera=this._useMultiview,(this._currentDepthNear!==i.near||this._currentDepthFar!==i.far)&&(t.updateRenderState({depthNear:i.near,depthFar:i.far}),this._currentDepthNear=i.near,this._currentDepthFar=i.far),a.layers.mask=e.layers.mask|2,c.layers.mask=e.layers.mask|4,i.layers.mask=a.layers.mask|c.layers.mask;const h=e.parent,p=i.cameras;jge(i,h);for(let v=0;v<p.length;v++)jge(p[v],h);p.length===2?wVe(i,a,c):i.projectionMatrix.copy(a.projectionMatrix),EVe(e,i,h)}_getController(e){let t=this._controllers[e];return t===void 0&&(t=new bVe,this._controllers[e]=t),t}}function wVe(o,e,t){Vge.setFromMatrixPosition(e.matrixWorld),Gge.setFromMatrixPosition(t.matrixWorld);const n=Vge.distanceTo(Gge),r=e.projectionMatrix.elements,i=t.projectionMatrix.elements,a=r[14]/(r[10]-1),c=r[14]/(r[10]+1),h=(r[9]+1)/r[5],p=(r[9]-1)/r[5],v=(r[8]-1)/r[0],x=(i[8]+1)/i[0],S=a*v,C=a*x,I=n/(-v+x),L=I*-v;if(e.matrixWorld.decompose(o.position,o.quaternion,o.scale),o.translateX(L),o.translateZ(I),o.matrixWorld.compose(o.position,o.quaternion,o.scale),o.matrixWorldInverse.copy(o.matrixWorld).invert(),r[10]===-1)o.projectionMatrix.copy(e.projectionMatrix),o.projectionMatrixInverse.copy(e.projectionMatrixInverse);else{const U=a+I,R=c+I,$=S-L,Z=C+(n-L),k=h*c/R*U,ie=p*c/R*U;o.projectionMatrix.makePerspective($,Z,k,ie,U,R),o.projectionMatrixInverse.copy(o.projectionMatrix).invert()}}function jge(o,e){e===null?o.matrixWorld.copy(o.matrix):o.matrixWorld.multiplyMatrices(e.matrixWorld,o.matrix),o.matrixWorldInverse.copy(o.matrixWorld).invert()}function EVe(o,e,t){t===null?o.matrix.copy(e.matrixWorld):(o.matrix.copy(t.matrixWorld),o.matrix.invert(),o.matrix.multiply(e.matrixWorld)),o.matrix.decompose(o.position,o.quaternion,o.scale),o.updateMatrixWorld(!0),o.projectionMatrix.copy(e.projectionMatrix),o.projectionMatrixInverse.copy(e.projectionMatrixInverse),o.isPerspectiveCamera&&(o.fov=U_*2*Math.atan(1/o.projectionMatrix.elements[5]),o.zoom=1)}function TVe(o){const e=this._controllerInputSources.indexOf(o.inputSource);if(e===-1)return;const t=this._controllers[e];if(t!==void 0){const n=this.getReferenceSpace();t.update(o.inputSource,o.frame,n),t.dispatchEvent({type:o.type,data:o.inputSource})}}function MVe(){const o=this._session,e=this._renderer;o.removeEventListener("select",this._onSessionEvent),o.removeEventListener("selectstart",this._onSessionEvent),o.removeEventListener("selectend",this._onSessionEvent),o.removeEventListener("squeeze",this._onSessionEvent),o.removeEventListener("squeezestart",this._onSessionEvent),o.removeEventListener("squeezeend",this._onSessionEvent),o.removeEventListener("end",this._onSessionEnd),o.removeEventListener("inputsourceschange",this._onInputSourcesChange);for(let t=0;t<this._controllers.length;t++){const n=this._controllerInputSources[t];n!==null&&(this._controllerInputSources[t]=null,this._controllers[t].disconnect(n))}if(this._currentDepthNear=null,this._currentDepthFar=null,e._resetXRState(),this._session=null,this._xrRenderTarget=null,this._supportsLayers===!0)for(const t of this._layers)t.renderTarget=new $w(t.pixelwidth,t.pixelheight,{format:Ch,type:Il,depthTexture:new t1(t.pixelwidth,t.pixelheight,t.stencilBuffer?$3:Ho,void 0,void 0,void 0,void 0,void 0,void 0,t.stencilBuffer?Mg:e1),stencilBuffer:t.stencilBuffer,resolveDepthBuffer:!1,resolveStencilBuffer:!1}),t.renderTarget.isXRRenderTarget=!1,t.plane.material=t.material,t.material.map=t.renderTarget.texture,t.material.map.offset.y=1,t.material.map.repeat.y=-1,delete t.xrlayer;this.isPresenting=!1,this._useMultiview=!1,e._animation.stop(),e._animation.setAnimationLoop(this._currentAnimationLoop),e._animation.setContext(this._currentAnimationContext),e._animation.start(),e.setPixelRatio(this._currentPixelRatio),e.setSize(this._currentSize.width,this._currentSize.height,!1),this.dispatchEvent({type:"sessionend"})}function CVe(o){const e=this._controllers,t=this._controllerInputSources;for(let n=0;n<o.removed.length;n++){const r=o.removed[n],i=t.indexOf(r);i>=0&&(t[i]=null,e[i].disconnect(r))}for(let n=0;n<o.added.length;n++){const r=o.added[n];let i=t.indexOf(r);if(i===-1){for(let c=0;c<e.length;c++)if(c>=t.length){t.push(r),i=c;break}else if(t[c]===null){t[c]=r,i=c;break}if(i===-1)break}const a=e[i];a&&a.connect(r)}}function AVe(o){return o.type==="quad"?this._glBinding.createQuadLayer({transform:new XRRigidTransform(o.translation,o.quaternion),width:o.width/2,height:o.height/2,space:this._referenceSpace,viewPixelWidth:o.pixelwidth,viewPixelHeight:o.pixelheight,clearOnAccess:!1}):this._glBinding.createCylinderLayer({transform:new XRRigidTransform(o.translation,o.quaternion),radius:o.radius,centralAngle:o.centralAngle,aspectRatio:o.aspectRatio,space:this._referenceSpace,viewPixelWidth:o.pixelwidth,viewPixelHeight:o.pixelheight,clearOnAccess:!1})}function PVe(o,e){if(e===void 0)return;const t=this._cameraXR,n=this._renderer,r=n.backend,i=this._glBaseLayer,a=this.getReferenceSpace(),c=e.getViewerPose(a);if(this._xrFrame=e,c!==null){const h=c.views;this._glBaseLayer!==null&&r.setXRTarget(i.framebuffer);let p=!1;h.length!==t.cameras.length&&(t.cameras.length=0,p=!0);for(let v=0;v<h.length;v++){const x=h[v];let S;if(this._useLayers===!0){const I=this._glBinding.getViewSubImage(this._glProjLayer,x);S=I.viewport,v===0&&r.setXRRenderTargetTextures(this._xrRenderTarget,I.colorTexture,this._glProjLayer.ignoreDepthValues&&!this._useMultiview?void 0:I.depthStencilTexture)}else S=i.getViewport(x);let C=this._cameras[v];C===void 0&&(C=new bu,C.layers.enable(v),C.viewport=new Ri,this._cameras[v]=C),C.matrix.fromArray(x.transform.matrix),C.matrix.decompose(C.position,C.quaternion,C.scale),C.projectionMatrix.fromArray(x.projectionMatrix),C.projectionMatrixInverse.copy(C.projectionMatrix).invert(),C.viewport.set(S.x,S.y,S.width,S.height),v===0&&(t.matrix.copy(C.matrix),t.matrix.decompose(t.position,t.quaternion,t.scale)),p===!0&&t.cameras.push(C)}n.setOutputRenderTarget(this._xrRenderTarget)}for(let h=0;h<this._controllers.length;h++){const p=this._controllerInputSources[h],v=this._controllers[h];p!==null&&v!==void 0&&v.update(p,e,a)}this._currentAnimationLoop&&this._currentAnimationLoop(o,e),e.detectedPlanes&&this.dispatchEvent({type:"planesdetected",data:e}),this._xrFrame=null}const H8=new PI,QR=new yt;class HW{constructor(e=new z3,t=new z3,n=new z3,r=new z3,i=new z3,a=new z3){this.planes=[e,t,n,r,i,a]}set(e,t,n,r,i,a){const c=this.planes;return c[0].copy(e),c[1].copy(t),c[2].copy(n),c[3].copy(r),c[4].copy(i),c[5].copy(a),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=bc){const n=this.planes,r=e.elements,i=r[0],a=r[1],c=r[2],h=r[3],p=r[4],v=r[5],x=r[6],S=r[7],C=r[8],I=r[9],L=r[10],U=r[11],R=r[12],$=r[13],Z=r[14],k=r[15];if(n[0].setComponents(h-i,S-p,U-C,k-R).normalize(),n[1].setComponents(h+i,S+p,U+C,k+R).normalize(),n[2].setComponents(h+a,S+v,U+I,k+$).normalize(),n[3].setComponents(h-a,S-v,U-I,k-$).normalize(),n[4].setComponents(h-c,S-x,U-L,k-Z).normalize(),t===bc)n[5].setComponents(h+c,S+x,U+L,k+Z).normalize();else if(t===K3)n[5].setComponents(c,x,L,Z).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),H8.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),H8.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(H8)}intersectsSprite(e){return H8.center.set(0,0,0),H8.radius=.7071067811865476,H8.applyMatrix4(e.matrixWorld),this.intersectsSphere(H8)}intersectsSphere(e){const t=this.planes,n=e.center,r=-e.radius;for(let i=0;i<6;i++)if(t[i].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];if(QR.x=r.normal.x>0?e.max.x:e.min.x,QR.y=r.normal.y>0?e.max.y:e.min.y,QR.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(QR)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}const Vp=new Ts,Gp=new HW;class WW{constructor(){this.coordinateSystem=bc}intersectsObject(e,t){if(!t.isArrayCamera||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(Vp.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Gp.setFromProjectionMatrix(Vp,this.coordinateSystem),Gp.intersectsObject(e))return!0}return!1}intersectsSprite(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(Vp.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Gp.setFromProjectionMatrix(Vp,this.coordinateSystem),Gp.intersectsSprite(e))return!0}return!1}intersectsSphere(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(Vp.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Gp.setFromProjectionMatrix(Vp,this.coordinateSystem),Gp.intersectsSphere(e))return!0}return!1}intersectsBox(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(Vp.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Gp.setFromProjectionMatrix(Vp,this.coordinateSystem),Gp.intersectsBox(e))return!0}return!1}containsPoint(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(Vp.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Gp.setFromProjectionMatrix(Vp,this.coordinateSystem),Gp.containsPoint(e))return!0}return!1}clone(){return new WW}}const Hge=new sW,JR=new pi,HV=new Ri,WV=new HW,$V=new WW,ek=new Ts,I3=new Ri;class RVe{constructor(e,t={}){this.isRenderer=!0;const{logarithmicDepthBuffer:n=!1,alpha:r=!0,depth:i=!0,stencil:a=!1,antialias:c=!1,samples:h=0,getFallback:p=null,colorBufferType:v=Mh,multiview:x=!1}=t;this.domElement=e.getDomElement(),this.backend=e,this.samples=h||c===!0?4:0,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.alpha=r,this.logarithmicDepthBuffer=n,this.outputColorSpace=xu,this.toneMapping=w_,this.toneMappingExposure=1,this.sortObjects=!0,this.depth=i,this.stencil=a,this.info=new NNe,this.overrideNodes={modelViewMatrix:null,modelNormalViewMatrix:null},this.library=new m5e,this.lighting=new vVe,this._getFallback=p,this._pixelRatio=1,this._width=this.domElement.width,this._height=this.domElement.height,this._viewport=new Ri(0,0,this._width,this._height),this._scissor=new Ri(0,0,this._width,this._height),this._scissorTest=!1,this._attributes=null,this._geometries=null,this._nodes=null,this._animation=null,this._bindings=null,this._objects=null,this._pipelines=null,this._bundles=null,this._renderLists=null,this._renderContexts=null,this._textures=null,this._background=null,this._quad=new DW(new sa),this._quad.material.name="Renderer_output",this._currentRenderContext=null,this._opaqueSort=null,this._transparentSort=null,this._frameBufferTarget=null;const S=this.alpha===!0?0:1;this._clearColor=new lW(0,0,0,S),this._clearDepth=1,this._clearStencil=0,this._renderTarget=null,this._activeCubeFace=0,this._activeMipmapLevel=0,this._outputRenderTarget=null,this._mrt=null,this._renderObjectFunction=null,this._currentRenderObjectFunction=null,this._currentRenderBundle=null,this._handleObjectFunction=this._renderObjectDirect,this._isDeviceLost=!1,this.onDeviceLost=this._onDeviceLost,this._colorBufferType=v,this._initialized=!1,this._initPromise=null,this._compilationPromises=null,this.transparent=!0,this.opaque=!0,this.shadowMap={enabled:!1,type:LIe},this.xr=new SVe(this,x),this.debug={checkShaderErrors:!0,onShaderError:null,getShaderAsync:async(C,I,L)=>{await this.compileAsync(C,I);const U=this._renderLists.get(C,I),R=this._renderContexts.get(C,I,this._renderTarget),$=C.overrideMaterial||L.material,Z=this._objects.get(L,$,C,I,U.lightsNode,R,R.clippingContext),{fragmentShader:k,vertexShader:ie}=Z.getNodeBuilderState();return{fragmentShader:k,vertexShader:ie}}}}async init(){if(this._initialized)throw new Error("Renderer: Backend has already been initialized.");return this._initPromise!==null?this._initPromise:(this._initPromise=new Promise(async(e,t)=>{let n=this.backend;try{await n.init(this)}catch(r){if(this._getFallback!==null)try{this.backend=n=this._getFallback(r),await n.init(this)}catch(i){t(i);return}else{t(r);return}}this._nodes=new pVe(this,n),this._animation=new vIe(this._nodes,this.info),this._attributes=new PNe(n),this._background=new rze(this,this._nodes),this._geometries=new INe(this._attributes,this.info),this._textures=new nDe(this,n,this.info),this._pipelines=new LNe(n,this._nodes),this._bindings=new BNe(n,this._nodes,this._textures,this._attributes,this._pipelines,this.info),this._objects=new MNe(this,this._nodes,this._geometries,this._pipelines,this._bindings,this.info),this._renderLists=new VNe(this.lighting),this._bundles=new gVe,this._renderContexts=new ZNe,this._animation.start(),this._initialized=!0,e(this)}),this._initPromise)}get coordinateSystem(){return this.backend.coordinateSystem}async compileAsync(e,t,n=null){if(this._isDeviceLost===!0)return;this._initialized===!1&&await this.init();const r=this._nodes.nodeFrame,i=r.renderId,a=this._currentRenderContext,c=this._currentRenderObjectFunction,h=this._compilationPromises,p=e.isScene===!0?e:Hge;n===null&&(n=e);const v=this._renderTarget,x=this._renderContexts.get(n,t,v),S=this._activeMipmapLevel,C=[];this._currentRenderContext=x,this._currentRenderObjectFunction=this.renderObject,this._handleObjectFunction=this._createObjectPipeline,this._compilationPromises=C,r.renderId++,r.update(),x.depth=this.depth,x.stencil=this.stencil,x.clippingContext||(x.clippingContext=new uI),x.clippingContext.updateGlobal(p,t),p.onBeforeRender(this,e,t,v);const I=this._renderLists.get(e,t);if(I.begin(),this._projectObject(e,t,0,I,x.clippingContext),n!==e&&n.traverseVisible(function(Z){Z.isLight&&Z.layers.test(t.layers)&&I.pushLight(Z)}),I.finish(),v!==null){this._textures.updateRenderTarget(v,S);const Z=this._textures.get(v);x.textures=Z.textures,x.depthTexture=Z.depthTexture}else x.textures=null,x.depthTexture=null;this._background.update(p,I,x);const L=I.opaque,U=I.transparent,R=I.transparentDoublePass,$=I.lightsNode;this.opaque===!0&&L.length>0&&this._renderObjects(L,t,p,$),this.transparent===!0&&U.length>0&&this._renderTransparents(U,R,t,p,$),r.renderId=i,this._currentRenderContext=a,this._currentRenderObjectFunction=c,this._compilationPromises=h,this._handleObjectFunction=this._renderObjectDirect,await Promise.all(C)}async renderAsync(e,t){this._initialized===!1&&await this.init(),this._renderScene(e,t)}async waitForGPU(){await this.backend.waitForGPU()}set highPrecision(e){e===!0?(this.overrideNodes.modelViewMatrix=Gme,this.overrideNodes.modelNormalViewMatrix=jme):this.highPrecision&&(this.overrideNodes.modelViewMatrix=null,this.overrideNodes.modelNormalViewMatrix=null)}get highPrecision(){return this.overrideNodes.modelViewMatrix===Gme&&this.overrideNodes.modelNormalViewMatrix===jme}setMRT(e){return this._mrt=e,this}getMRT(){return this._mrt}getColorBufferType(){return this._colorBufferType}_onDeviceLost(e){let t=`THREE.WebGPURenderer: ${e.api} Device Lost:

Message: ${e.message}`;e.reason&&(t+=`
Reason: ${e.reason}`),console.error(t),this._isDeviceLost=!0}_renderBundle(e,t,n){const{bundleGroup:r,camera:i,renderList:a}=e,c=this._currentRenderContext,h=this._bundles.get(r,i),p=this.backend.get(h);p.renderContexts===void 0&&(p.renderContexts=new Set);const v=r.version!==p.version,x=p.renderContexts.has(c)===!1||v;if(p.renderContexts.add(c),x){this.backend.beginBundle(c),(p.renderObjects===void 0||v)&&(p.renderObjects=[]),this._currentRenderBundle=h;const{transparentDoublePass:S,transparent:C,opaque:I}=a;this.opaque===!0&&I.length>0&&this._renderObjects(I,i,t,n),this.transparent===!0&&C.length>0&&this._renderTransparents(C,S,i,t,n),this._currentRenderBundle=null,this.backend.finishBundle(c,h),p.version=r.version}else{const{renderObjects:S}=p;for(let C=0,I=S.length;C<I;C++){const L=S[C];this._nodes.needsRefresh(L)&&(this._nodes.updateBefore(L),this._nodes.updateForRender(L),this._bindings.updateForRender(L),this._nodes.updateAfter(L))}}this.backend.addBundle(c,h)}render(e,t){if(this._initialized===!1)return console.warn("THREE.Renderer: .render() called before the backend is initialized. Try using .renderAsync() instead."),this.renderAsync(e,t);this._renderScene(e,t)}_getFrameBufferTarget(){const{currentToneMapping:e,currentColorSpace:t}=this;if(e!==w_===!1&&t!==E_===!1)return null;const{width:i,height:a}=this.getDrawingBufferSize(JR),{depth:c,stencil:h}=this;let p=this._frameBufferTarget;p===null&&(p=new C6(i,a,{depthBuffer:c,stencilBuffer:h,type:this._colorBufferType,format:Ch,colorSpace:E_,generateMipmaps:!1,minFilter:Eu,magFilter:Eu,samples:this.samples}),p.isPostProcessingRenderTarget=!0,this._frameBufferTarget=p);const v=this.getOutputRenderTarget();return p.depthBuffer=c,p.stencilBuffer=h,v!==null?p.setSize(v.width,v.height,v.depth):p.setSize(i,a,1),p.viewport.copy(this._viewport),p.scissor.copy(this._scissor),p.viewport.multiplyScalar(this._pixelRatio),p.scissor.multiplyScalar(this._pixelRatio),p.scissorTest=this._scissorTest,p.multiview=v!==null?v.multiview:!1,p.resolveDepthBuffer=v!==null?v.resolveDepthBuffer:!0,p.autoAllocateDepthBuffer=v!==null?v.autoAllocateDepthBuffer:!1,p}_renderScene(e,t,n=!0){if(this._isDeviceLost===!0)return;const r=n?this._getFrameBufferTarget():null,i=this._nodes.nodeFrame,a=i.renderId,c=this._currentRenderContext,h=this._currentRenderObjectFunction,p=e.isScene===!0?e:Hge,v=this._renderTarget||this._outputRenderTarget,x=this._activeCubeFace,S=this._activeMipmapLevel;let C;r!==null?(C=r,this.setRenderTarget(C)):C=v;const I=this._renderContexts.get(e,t,C);this._currentRenderContext=I,this._currentRenderObjectFunction=this._renderObjectFunction||this.renderObject,this.info.calls++,this.info.render.calls++,this.info.render.frameCalls++,i.renderId=this.info.calls;const L=this.coordinateSystem,U=this.xr;if(t.coordinateSystem!==L&&U.isPresenting===!1&&(t.coordinateSystem=L,t.updateProjectionMatrix(),t.isArrayCamera))for(const je of t.cameras)je.coordinateSystem=L,je.updateProjectionMatrix();e.matrixWorldAutoUpdate===!0&&e.updateMatrixWorld(),t.parent===null&&t.matrixWorldAutoUpdate===!0&&t.updateMatrixWorld(),U.enabled===!0&&U.isPresenting===!0&&(U.cameraAutoUpdate===!0&&U.updateCamera(t),t=U.getCamera());let R=this._viewport,$=this._scissor,Z=this._pixelRatio;C!==null&&(R=C.viewport,$=C.scissor,Z=1),this.getDrawingBufferSize(JR),HV.set(0,0,JR.width,JR.height);const k=R.minDepth===void 0?0:R.minDepth,ie=R.maxDepth===void 0?1:R.maxDepth;I.viewportValue.copy(R).multiplyScalar(Z).floor(),I.viewportValue.width>>=S,I.viewportValue.height>>=S,I.viewportValue.minDepth=k,I.viewportValue.maxDepth=ie,I.viewport=I.viewportValue.equals(HV)===!1,I.scissorValue.copy($).multiplyScalar(Z).floor(),I.scissor=this._scissorTest&&I.scissorValue.equals(HV)===!1,I.scissorValue.width>>=S,I.scissorValue.height>>=S,I.clippingContext||(I.clippingContext=new uI),I.clippingContext.updateGlobal(p,t),p.onBeforeRender(this,e,t,C);const ue=t.isArrayCamera?$V:WV;t.isArrayCamera||(ek.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),ue.setFromProjectionMatrix(ek,L));const ce=this._renderLists.get(e,t);if(ce.begin(),this._projectObject(e,t,0,ce,I.clippingContext),ce.finish(),this.sortObjects===!0&&ce.sort(this._opaqueSort,this._transparentSort),C!==null){this._textures.updateRenderTarget(C,S);const je=this._textures.get(C);I.textures=je.textures,I.depthTexture=je.depthTexture,I.width=je.width,I.height=je.height,I.renderTarget=C,I.depth=C.depthBuffer,I.stencil=C.stencilBuffer}else I.textures=null,I.depthTexture=null,I.width=this.domElement.width,I.height=this.domElement.height,I.depth=this.depth,I.stencil=this.stencil;I.width>>=S,I.height>>=S,I.activeCubeFace=x,I.activeMipmapLevel=S,I.occlusionQueryCount=ce.occlusionQueryCount,this._background.update(p,ce,I),I.camera=t,this.backend.beginRender(I);const{bundles:Q,lightsNode:ae,transparentDoublePass:le,transparent:J,opaque:Ue}=ce;return Q.length>0&&this._renderBundles(Q,p,ae),this.opaque===!0&&Ue.length>0&&this._renderObjects(Ue,t,p,ae),this.transparent===!0&&J.length>0&&this._renderTransparents(J,le,t,p,ae),this.backend.finishRender(I),i.renderId=a,this._currentRenderContext=c,this._currentRenderObjectFunction=h,r!==null&&(this.setRenderTarget(v,x,S),this._renderOutput(C)),p.onAfterRender(this,e,t,C),I}_setXRLayerSize(e,t){this._width=e,this._height=t,this.setViewport(0,0,e,t)}_renderOutput(e){const t=this._quad;this._nodes.hasOutputChange(e.texture)&&(t.material.fragmentNode=this._nodes.getOutputNode(e.texture),t.material.needsUpdate=!0);const n=this.autoClear,r=this.xr.enabled;this.autoClear=!1,this.xr.enabled=!1,this._renderScene(t,t.camera,!1),this.autoClear=n,this.xr.enabled=r}getMaxAnisotropy(){return this.backend.getMaxAnisotropy()}getActiveCubeFace(){return this._activeCubeFace}getActiveMipmapLevel(){return this._activeMipmapLevel}async setAnimationLoop(e){this._initialized===!1&&await this.init(),this._animation.setAnimationLoop(e)}async getArrayBufferAsync(e){return await this.backend.getArrayBufferAsync(e)}getContext(){return this.backend.getContext()}getPixelRatio(){return this._pixelRatio}getDrawingBufferSize(e){return e.set(this._width*this._pixelRatio,this._height*this._pixelRatio).floor()}getSize(e){return e.set(this._width,this._height)}setPixelRatio(e=1){this._pixelRatio!==e&&(this._pixelRatio=e,this.setSize(this._width,this._height,!1))}setDrawingBufferSize(e,t,n){this.xr&&this.xr.isPresenting||(this._width=e,this._height=t,this._pixelRatio=n,this.domElement.width=Math.floor(e*n),this.domElement.height=Math.floor(t*n),this.setViewport(0,0,e,t),this._initialized&&this.backend.updateSize())}setSize(e,t,n=!0){this.xr&&this.xr.isPresenting||(this._width=e,this._height=t,this.domElement.width=Math.floor(e*this._pixelRatio),this.domElement.height=Math.floor(t*this._pixelRatio),n===!0&&(this.domElement.style.width=e+"px",this.domElement.style.height=t+"px"),this.setViewport(0,0,e,t),this._initialized&&this.backend.updateSize())}setOpaqueSort(e){this._opaqueSort=e}setTransparentSort(e){this._transparentSort=e}getScissor(e){const t=this._scissor;return e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height,e}setScissor(e,t,n,r){const i=this._scissor;e.isVector4?i.copy(e):i.set(e,t,n,r)}getScissorTest(){return this._scissorTest}setScissorTest(e){this._scissorTest=e,this.backend.setScissorTest(e)}getViewport(e){return e.copy(this._viewport)}setViewport(e,t,n,r,i=0,a=1){const c=this._viewport;e.isVector4?c.copy(e):c.set(e,t,n,r),c.minDepth=i,c.maxDepth=a}getClearColor(e){return e.copy(this._clearColor)}setClearColor(e,t=1){this._clearColor.set(e),this._clearColor.a=t}getClearAlpha(){return this._clearColor.a}setClearAlpha(e){this._clearColor.a=e}getClearDepth(){return this._clearDepth}setClearDepth(e){this._clearDepth=e}getClearStencil(){return this._clearStencil}setClearStencil(e){this._clearStencil=e}isOccluded(e){const t=this._currentRenderContext;return t&&this.backend.isOccluded(t,e)}clear(e=!0,t=!0,n=!0){if(this._initialized===!1)return console.warn("THREE.Renderer: .clear() called before the backend is initialized. Try using .clearAsync() instead."),this.clearAsync(e,t,n);const r=this._renderTarget||this._getFrameBufferTarget();let i=null;if(r!==null){this._textures.updateRenderTarget(r);const a=this._textures.get(r);i=this._renderContexts.getForClear(r),i.textures=a.textures,i.depthTexture=a.depthTexture,i.width=a.width,i.height=a.height,i.renderTarget=r,i.depth=r.depthBuffer,i.stencil=r.stencilBuffer,i.clearColorValue=this.backend.getClearColor(),i.activeCubeFace=this.getActiveCubeFace(),i.activeMipmapLevel=this.getActiveMipmapLevel()}this.backend.clear(e,t,n,i),r!==null&&this._renderTarget===null&&this._renderOutput(r)}clearColor(){return this.clear(!0,!1,!1)}clearDepth(){return this.clear(!1,!0,!1)}clearStencil(){return this.clear(!1,!1,!0)}async clearAsync(e=!0,t=!0,n=!0){this._initialized===!1&&await this.init(),this.clear(e,t,n)}async clearColorAsync(){this.clearAsync(!0,!1,!1)}async clearDepthAsync(){this.clearAsync(!1,!0,!1)}async clearStencilAsync(){this.clearAsync(!1,!1,!0)}get currentToneMapping(){return this.isOutputTarget?this.toneMapping:w_}get currentColorSpace(){return this.isOutputTarget?this.outputColorSpace:E_}get isOutputTarget(){return this._renderTarget===this._outputRenderTarget||this._renderTarget===null}dispose(){this.info.dispose(),this.backend.dispose(),this._animation.dispose(),this._objects.dispose(),this._pipelines.dispose(),this._nodes.dispose(),this._bindings.dispose(),this._renderLists.dispose(),this._renderContexts.dispose(),this._textures.dispose(),this._frameBufferTarget!==null&&this._frameBufferTarget.dispose(),Object.values(this.backend.timestampQueryPool).forEach(e=>{e!==null&&e.dispose()}),this.setRenderTarget(null),this.setAnimationLoop(null)}setRenderTarget(e,t=0,n=0){this._renderTarget=e,this._activeCubeFace=t,this._activeMipmapLevel=n}getRenderTarget(){return this._renderTarget}setOutputRenderTarget(e){this._outputRenderTarget=e}getOutputRenderTarget(){return this._outputRenderTarget}_resetXRState(){this.backend.setXRTarget(null),this.setOutputRenderTarget(null),this.setRenderTarget(null),this._frameBufferTarget.dispose(),this._frameBufferTarget=null}setRenderObjectFunction(e){this._renderObjectFunction=e}getRenderObjectFunction(){return this._renderObjectFunction}compute(e){if(this._isDeviceLost===!0)return;if(this._initialized===!1)return console.warn("THREE.Renderer: .compute() called before the backend is initialized. Try using .computeAsync() instead."),this.computeAsync(e);const t=this._nodes.nodeFrame,n=t.renderId;this.info.calls++,this.info.compute.calls++,this.info.compute.frameCalls++,t.renderId=this.info.calls;const r=this.backend,i=this._pipelines,a=this._bindings,c=this._nodes,h=Array.isArray(e)?e:[e];if(h[0]===void 0||h[0].isComputeNode!==!0)throw new Error("THREE.Renderer: .compute() expects a ComputeNode.");r.beginCompute(e);for(const p of h){if(i.has(p)===!1){const S=()=>{p.removeEventListener("dispose",S),i.delete(p),a.delete(p),c.delete(p)};p.addEventListener("dispose",S);const C=p.onInitFunction;C!==null&&C.call(p,{renderer:this})}c.updateForCompute(p),a.updateForCompute(p);const v=a.getForCompute(p),x=i.getForCompute(p,v);r.compute(e,p,v,x)}r.finishCompute(e),t.renderId=n}async computeAsync(e){this._initialized===!1&&await this.init(),this.compute(e)}async hasFeatureAsync(e){return this._initialized===!1&&await this.init(),this.backend.hasFeature(e)}async resolveTimestampsAsync(e="render"){return this._initialized===!1&&await this.init(),this.backend.resolveTimestampsAsync(e)}hasFeature(e){return this._initialized===!1?(console.warn("THREE.Renderer: .hasFeature() called before the backend is initialized. Try using .hasFeatureAsync() instead."),!1):this.backend.hasFeature(e)}hasInitialized(){return this._initialized}async initTextureAsync(e){this._initialized===!1&&await this.init(),this._textures.updateTexture(e)}initTexture(e){this._initialized===!1&&console.warn("THREE.Renderer: .initTexture() called before the backend is initialized. Try using .initTextureAsync() instead."),this._textures.updateTexture(e)}copyFramebufferToTexture(e,t=null){if(t!==null)if(t.isVector2)t=I3.set(t.x,t.y,e.image.width,e.image.height).floor();else if(t.isVector4)t=I3.copy(t).floor();else{console.error("THREE.Renderer.copyFramebufferToTexture: Invalid rectangle.");return}else t=I3.set(0,0,e.image.width,e.image.height);let n=this._currentRenderContext,r;n!==null?r=n.renderTarget:(r=this._renderTarget||this._getFrameBufferTarget(),r!==null&&(this._textures.updateRenderTarget(r),n=this._textures.get(r))),this._textures.updateTexture(e,{renderTarget:r}),this.backend.copyFramebufferToTexture(e,n,t)}copyTextureToTexture(e,t,n=null,r=null,i=0,a=0){this._textures.updateTexture(e),this._textures.updateTexture(t),this.backend.copyTextureToTexture(e,t,n,r,i,a)}async readRenderTargetPixelsAsync(e,t,n,r,i,a=0,c=0){return this.backend.copyTextureToBuffer(e.textures[a],t,n,r,i,c)}_projectObject(e,t,n,r,i){if(e.visible===!1)return;if(e.layers.test(t.layers)){if(e.isGroup)n=e.renderOrder,e.isClippingGroup&&e.enabled&&(i=i.getGroupContext(e));else if(e.isLOD)e.autoUpdate===!0&&e.update(t);else if(e.isLight)r.pushLight(e);else if(e.isSprite){const h=t.isArrayCamera?$V:WV;if(!e.frustumCulled||h.intersectsSprite(e,t)){this.sortObjects===!0&&I3.setFromMatrixPosition(e.matrixWorld).applyMatrix4(ek);const{geometry:p,material:v}=e;v.visible&&r.push(e,p,v,n,I3.z,null,i)}}else if(e.isLineLoop)console.error("THREE.Renderer: Objects of type THREE.LineLoop are not supported. Please use THREE.Line or THREE.LineSegments.");else if(e.isMesh||e.isLine||e.isPoints){const h=t.isArrayCamera?$V:WV;if(!e.frustumCulled||h.intersectsObject(e,t)){const{geometry:p,material:v}=e;if(this.sortObjects===!0&&(p.boundingSphere===null&&p.computeBoundingSphere(),I3.copy(p.boundingSphere.center).applyMatrix4(e.matrixWorld).applyMatrix4(ek)),Array.isArray(v)){const x=p.groups;for(let S=0,C=x.length;S<C;S++){const I=x[S],L=v[I.materialIndex];L&&L.visible&&r.push(e,p,L,n,I3.z,I,i)}}else v.visible&&r.push(e,p,v,n,I3.z,null,i)}}}if(e.isBundleGroup===!0&&this.backend.beginBundle!==void 0){const h=r;r=this._renderLists.get(e,t),r.begin(),h.pushBundle({bundleGroup:e,camera:t,renderList:r}),r.finish()}const c=e.children;for(let h=0,p=c.length;h<p;h++)this._projectObject(c[h],t,n,r,i)}_renderBundles(e,t,n){for(const r of e)this._renderBundle(r,t,n)}_renderTransparents(e,t,n,r,i){if(t.length>0){for(const{material:a}of t)a.side=Ec;this._renderObjects(t,n,r,i,"backSide");for(const{material:a}of t)a.side=wg;this._renderObjects(e,n,r,i);for(const{material:a}of t)a.side=S_}else this._renderObjects(e,n,r,i)}_renderObjects(e,t,n,r,i=null){for(let a=0,c=e.length;a<c;a++){const{object:h,geometry:p,material:v,group:x,clippingContext:S}=e[a];this._currentRenderObjectFunction(h,n,t,p,v,x,r,S,i)}}renderObject(e,t,n,r,i,a,c,h=null,p=null){let v,x,S;if(e.onBeforeRender(this,t,n,r,i,a),i.allowOverride===!0&&t.overrideMaterial!==null){const C=t.overrideMaterial;i.positionNode&&i.positionNode.isNode&&(v=C.positionNode,C.positionNode=i.positionNode),C.alphaTest=i.alphaTest,C.alphaMap=i.alphaMap,C.transparent=i.transparent||i.transmission>0,C.isShadowPassMaterial&&(C.side=i.shadowSide===null?i.side:i.shadowSide,i.depthNode&&i.depthNode.isNode&&(S=C.depthNode,C.depthNode=i.depthNode),i.castShadowNode&&i.castShadowNode.isNode&&(x=C.colorNode,C.colorNode=i.castShadowNode),i.castShadowPositionNode&&i.castShadowPositionNode.isNode&&(v=C.positionNode,C.positionNode=i.castShadowPositionNode)),i=C}i.transparent===!0&&i.side===S_&&i.forceSinglePass===!1?(i.side=Ec,this._handleObjectFunction(e,i,t,n,c,a,h,"backSide"),i.side=wg,this._handleObjectFunction(e,i,t,n,c,a,h,p),i.side=S_):this._handleObjectFunction(e,i,t,n,c,a,h,p),v!==void 0&&(t.overrideMaterial.positionNode=v),S!==void 0&&(t.overrideMaterial.depthNode=S),x!==void 0&&(t.overrideMaterial.colorNode=x),e.onAfterRender(this,t,n,r,i,a)}_renderObjectDirect(e,t,n,r,i,a,c,h){const p=this._objects.get(e,t,n,r,i,this._currentRenderContext,c,h);p.drawRange=e.geometry.drawRange,p.group=a;const v=this._nodes.needsRefresh(p);v&&(this._nodes.updateBefore(p),this._geometries.updateForRender(p),this._nodes.updateForRender(p),this._bindings.updateForRender(p)),this._pipelines.updateForRender(p),this._currentRenderBundle!==null&&(this.backend.get(this._currentRenderBundle).renderObjects.push(p),p.bundle=this._currentRenderBundle.bundleGroup),this.backend.draw(p,this.info),v&&this._nodes.updateAfter(p)}_createObjectPipeline(e,t,n,r,i,a,c,h){const p=this._objects.get(e,t,n,r,i,this._currentRenderContext,c,h);p.drawRange=e.geometry.drawRange,p.group=a,this._nodes.updateBefore(p),this._geometries.updateForRender(p),this._nodes.updateForRender(p),this._bindings.updateForRender(p),this._pipelines.getForRender(p,this._compilationPromises),this._nodes.updateAfter(p)}get compile(){return this.compileAsync}}class $W{constructor(e=""){this.name=e,this.visibility=0}setVisibility(e){this.visibility|=e}clone(){return Object.assign(new this.constructor,this)}}function kVe(o){return o+(G3-o%G3)%G3}let g5e=class extends $W{constructor(e,t=null){super(e),this.isBuffer=!0,this.bytesPerElement=Float32Array.BYTES_PER_ELEMENT,this._buffer=t}get byteLength(){return kVe(this._buffer.byteLength)}get buffer(){return this._buffer}update(){return!0}};class y5e extends g5e{constructor(e,t=null){super(e,t),this.isUniformBuffer=!0}}let IVe=0;class v5e extends y5e{constructor(e,t){super("UniformBuffer_"+IVe++,e?e.value:null),this.nodeUniform=e,this.groupNode=t}get buffer(){return this.nodeUniform.value}}class NVe extends y5e{constructor(e){super(e),this.isUniformsGroup=!0,this._values=null,this.uniforms=[]}addUniform(e){return this.uniforms.push(e),this}removeUniform(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}get values(){return this._values===null&&(this._values=Array.from(this.buffer)),this._values}get buffer(){let e=this._buffer;if(e===null){const t=this.byteLength;e=new Float32Array(new ArrayBuffer(t)),this._buffer=e}return e}get byteLength(){const e=this.bytesPerElement;let t=0;for(let n=0,r=this.uniforms.length;n<r;n++){const i=this.uniforms[n],a=i.boundary,c=i.itemSize*e,h=t%G3,p=h%a,v=h+p;t+=p,v!==0&&G3-v<c&&(t+=G3-v),i.offset=t/e,t+=c}return Math.ceil(t/G3)*G3}update(){let e=!1;for(const t of this.uniforms)this.updateByType(t)===!0&&(e=!0);return e}updateByType(e){if(e.isNumberUniform)return this.updateNumber(e);if(e.isVector2Uniform)return this.updateVector2(e);if(e.isVector3Uniform)return this.updateVector3(e);if(e.isVector4Uniform)return this.updateVector4(e);if(e.isColorUniform)return this.updateColor(e);if(e.isMatrix3Uniform)return this.updateMatrix3(e);if(e.isMatrix4Uniform)return this.updateMatrix4(e);console.error("THREE.WebGPUUniformsGroup: Unsupported uniform type.",e)}updateNumber(e){let t=!1;const n=this.values,r=e.getValue(),i=e.offset,a=e.getType();if(n[i]!==r){const c=this._getBufferForType(a);c[i]=n[i]=r,t=!0}return t}updateVector2(e){let t=!1;const n=this.values,r=e.getValue(),i=e.offset,a=e.getType();if(n[i+0]!==r.x||n[i+1]!==r.y){const c=this._getBufferForType(a);c[i+0]=n[i+0]=r.x,c[i+1]=n[i+1]=r.y,t=!0}return t}updateVector3(e){let t=!1;const n=this.values,r=e.getValue(),i=e.offset,a=e.getType();if(n[i+0]!==r.x||n[i+1]!==r.y||n[i+2]!==r.z){const c=this._getBufferForType(a);c[i+0]=n[i+0]=r.x,c[i+1]=n[i+1]=r.y,c[i+2]=n[i+2]=r.z,t=!0}return t}updateVector4(e){let t=!1;const n=this.values,r=e.getValue(),i=e.offset,a=e.getType();if(n[i+0]!==r.x||n[i+1]!==r.y||n[i+2]!==r.z||n[i+4]!==r.w){const c=this._getBufferForType(a);c[i+0]=n[i+0]=r.x,c[i+1]=n[i+1]=r.y,c[i+2]=n[i+2]=r.z,c[i+3]=n[i+3]=r.w,t=!0}return t}updateColor(e){let t=!1;const n=this.values,r=e.getValue(),i=e.offset;if(n[i+0]!==r.r||n[i+1]!==r.g||n[i+2]!==r.b){const a=this.buffer;a[i+0]=n[i+0]=r.r,a[i+1]=n[i+1]=r.g,a[i+2]=n[i+2]=r.b,t=!0}return t}updateMatrix3(e){let t=!1;const n=this.values,r=e.getValue().elements,i=e.offset;if(n[i+0]!==r[0]||n[i+1]!==r[1]||n[i+2]!==r[2]||n[i+4]!==r[3]||n[i+5]!==r[4]||n[i+6]!==r[5]||n[i+8]!==r[6]||n[i+9]!==r[7]||n[i+10]!==r[8]){const a=this.buffer;a[i+0]=n[i+0]=r[0],a[i+1]=n[i+1]=r[1],a[i+2]=n[i+2]=r[2],a[i+4]=n[i+4]=r[3],a[i+5]=n[i+5]=r[4],a[i+6]=n[i+6]=r[5],a[i+8]=n[i+8]=r[6],a[i+9]=n[i+9]=r[7],a[i+10]=n[i+10]=r[8],t=!0}return t}updateMatrix4(e){let t=!1;const n=this.values,r=e.getValue().elements,i=e.offset;return OVe(n,r,i)===!1&&(this.buffer.set(r,i),DVe(n,r,i),t=!0),t}_getBufferForType(e){return e==="int"||e==="ivec2"||e==="ivec3"||e==="ivec4"?new Int32Array(this.buffer.buffer):e==="uint"||e==="uvec2"||e==="uvec3"||e==="uvec4"?new Uint32Array(this.buffer.buffer):this.buffer}}function DVe(o,e,t){for(let n=0,r=e.length;n<r;n++)o[t+n]=e[n]}function OVe(o,e,t){for(let n=0,r=e.length;n<r;n++)if(o[t+n]!==e[n])return!1;return!0}let FVe=0;class _5e extends NVe{constructor(e,t){super(e),this.id=FVe++,this.groupNode=t,this.isNodeUniformsGroup=!0}}let LVe=0;class BVe extends $W{constructor(e,t){super(e),this.id=LVe++,this.texture=t,this.version=t?t.version:0,this.store=!1,this.generation=null,this.isSampledTexture=!0}needsBindingsUpdate(e){const{texture:t}=this;return e!==this.generation?(this.generation=e,!0):t.isVideoTexture}update(){const{texture:e,version:t}=this;return t!==e.version?(this.version=e.version,!0):!1}}class zI extends BVe{constructor(e,t,n,r=null){super(e,t?t.value:null),this.textureNode=t,this.groupNode=n,this.access=r}needsBindingsUpdate(e){return this.textureNode.value!==this.texture||super.needsBindingsUpdate(e)}update(){const{textureNode:e}=this;return this.texture!==e.value?(this.texture=e.value,!0):super.update()}}class x5e extends zI{constructor(e,t,n,r=null){super(e,t,n,r),this.isSampledCubeTexture=!0}}class b5e extends zI{constructor(e,t,n,r=null){super(e,t,n,r),this.isSampledTexture3D=!0}}class UVe extends j0{constructor(e=null,t=1,n=1,r,i,a,c,h,p=ya,v=ya,x,S){super(null,a,c,h,p,v,r,i,x,S),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const zVe={textureDimensions:"textureSize",equals:"equal"},VVe={low:"lowp",medium:"mediump",high:"highp"},Wge={swizzleAssign:!0,storageBuffer:!1},$ge={perspective:"smooth",linear:"noperspective"},qge={centroid:"centroid","flat first":"flat","flat either":"flat"},Xge=`
precision highp float;
precision highp int;
precision highp sampler2D;
precision highp sampler3D;
precision highp samplerCube;
precision highp sampler2DArray;

precision highp usampler2D;
precision highp usampler3D;
precision highp usamplerCube;
precision highp usampler2DArray;

precision highp isampler2D;
precision highp isampler3D;
precision highp isamplerCube;
precision highp isampler2DArray;

precision lowp sampler2DShadow;
precision lowp sampler2DArrayShadow;
precision lowp samplerCubeShadow;
`;class GVe extends c5e{constructor(e,t){super(e,t,new Kze),this.uniformGroups={},this.transforms=[],this.extensions={},this.builtins={vertex:[],fragment:[],compute:[]}}needsToWorkingColorSpace(e){return e.isVideoTexture===!0&&e.colorSpace!==Ig}getMethod(e){return zVe[e]||e}getOutputStructName(){return""}buildFunctionCode(e){const t=e.layout,n=this.flowShaderNode(e),r=[];for(const a of t.inputs)r.push(this.getType(a.type)+" "+a.name);return`${this.getType(t.type)} ${t.name}( ${r.join(", ")} ) {

	${n.vars}

${n.code}
	return ${n.result};

}`}setupPBO(e){const t=e.value;if(t.pbo===void 0){const n=t.array,r=t.count*t.itemSize,{itemSize:i}=t,a=t.array.constructor.name.toLowerCase().includes("int");let c=a?eW:JH;i===2?c=a?tW:f6:i===3?c=a?ZIe:QH:i===4&&(c=a?nW:Ch);const h={Float32Array:Su,Uint8Array:Il,Uint16Array:d_,Uint32Array:Ho,Int8Array:iE,Int16Array:sE,Int32Array:Pl,Uint8ClampedArray:Il},p=Math.pow(2,Math.ceil(Math.log2(Math.sqrt(r/i))));let v=Math.ceil(r/i/p);p*v*i<r&&v++;const x=p*v*i,S=new n.constructor(x);S.set(n,0),t.array=S;const C=new UVe(t.array,p,v,c,h[t.array.constructor.name]||Su);C.needsUpdate=!0,C.isPBOTexture=!0;const I=new ix(C,null,null);I.setPrecision("high"),t.pboNode=I,t.pbo=I.value,this.getUniformFromNode(t.pboNode,"texture",this.shaderStage,this.context.label)}}getPropertyName(e,t=this.shaderStage){return e.isNodeUniform&&e.node.isTextureNode!==!0&&e.node.isBufferNode!==!0?t.charAt(0)+"_"+e.name:super.getPropertyName(e,t)}generatePBO(e){const{node:t,indexNode:n}=e,r=t.value;if(this.renderer.backend.has(r)){const v=this.renderer.backend.get(r);v.pbo=r.pbo}const i=this.getUniformFromNode(r.pboNode,"texture",this.shaderStage,this.context.label),a=this.getPropertyName(i);this.increaseUsage(n);const c=n.build(this,"uint"),h=this.getDataFromNode(e);let p=h.propertyName;if(p===void 0){const v=this.getVarFromNode(e);p=this.getPropertyName(v);const x=this.getDataFromNode(t);let S=x.propertySizeName;S===void 0&&(S=p+"Size",this.getVarFromNode(t,S,"uint"),this.addLineFlowCode(`${S} = uint( textureSize( ${a}, 0 ).x )`,e),x.propertySizeName=S);const{itemSize:C}=r,I="."+rx.join("").slice(0,C),L=`ivec2(${c} % ${S}, ${c} / ${S})`,U=this.generateTextureLoad(null,a,L,null,"0");let R="vec4";r.pbo.type===Ho?R="uvec4":r.pbo.type===Pl&&(R="ivec4"),this.addLineFlowCode(`${p} = ${R}(${U})${I}`,e),h.propertyName=p}return p}generateTextureLoad(e,t,n,r,i="0"){return r?`texelFetch( ${t}, ivec3( ${n}, ${r} ), ${i} )`:`texelFetch( ${t}, ${n}, ${i} )`}generateTexture(e,t,n,r){return e.isDepthTexture?(r&&(n=`vec4( ${n}, ${r} )`),`texture( ${t}, ${n} ).x`):(r&&(n=`vec3( ${n}, ${r} )`),`texture( ${t}, ${n} )`)}generateTextureLevel(e,t,n,r){return`textureLod( ${t}, ${n}, ${r} )`}generateTextureBias(e,t,n,r){return`texture( ${t}, ${n}, ${r} )`}generateTextureGrad(e,t,n,r){return`textureGrad( ${t}, ${n}, ${r[0]}, ${r[1]} )`}generateTextureCompare(e,t,n,r,i,a=this.shaderStage){if(a==="fragment")return i?`texture( ${t}, vec4( ${n}, ${i}, ${r} ) )`:`texture( ${t}, vec3( ${n}, ${r} ) )`;console.error(`WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ${a} shader.`)}getVars(e){const t=[],n=this.vars[e];if(n!==void 0)for(const r of n)t.push(`${this.getVar(r.type,r.name,r.count)};`);return t.join(`
	`)}getUniforms(e){const t=this.uniforms[e],n=[],r={};for(const a of t){let c=null,h=!1;if(a.type==="texture"||a.type==="texture3D"){const v=a.node.value;let x="";(v.isDataTexture===!0||v.isData3DTexture===!0)&&(v.type===Ho?x="u":v.type===Pl&&(x="i")),a.type==="texture3D"&&v.isArrayTexture===!1?c=`${x}sampler3D ${a.name};`:v.compareFunction?v.isArrayTexture===!0?c=`sampler2DArrayShadow ${a.name};`:c=`sampler2DShadow ${a.name};`:v.isArrayTexture===!0||v.isDataArrayTexture===!0||v.isCompressedArrayTexture===!0?c=`${x}sampler2DArray ${a.name};`:c=`${x}sampler2D ${a.name};`}else if(a.type==="cubeTexture")c=`samplerCube ${a.name};`;else if(a.type==="buffer"){const v=a.node,x=this.getType(v.bufferType),S=v.bufferCount,C=S>0?S:"";c=`${v.name} {
	${x} ${a.name}[${C}];
};
`}else c=`${this.getVectorType(a.type)} ${this.getPropertyName(a,e)};`,h=!0;const p=a.node.precision;if(p!==null&&(c=VVe[p]+" "+c),h){c="	"+c;const v=a.groupNode.name;(r[v]||(r[v]=[])).push(c)}else c="uniform "+c,n.push(c)}let i="";for(const a in r){const c=r[a];i+=this._getGLSLUniformStruct(e+"_"+a,c.join(`
`))+`
`}return i+=n.join(`
`),i}getTypeFromAttribute(e){let t=super.getTypeFromAttribute(e);if(/^[iu]/.test(t)&&e.gpuType!==Pl){let n=e;e.isInterleavedBufferAttribute&&(n=e.data);const r=n.array;r instanceof Uint32Array||r instanceof Int32Array||(t=t.slice(1))}return t}getAttributes(e){let t="";if(e==="vertex"||e==="compute"){const n=this.getAttributesArray();let r=0;for(const i of n)t+=`layout( location = ${r++} ) in ${i.type} ${i.name};
`}return t}getStructMembers(e){const t=[];for(const n of e.members)t.push(`	${n.type} ${n.name};`);return t.join(`
`)}getStructs(e){const t=[],n=this.structs[e],r=[];for(const i of n)if(i.output)for(const a of i.members)r.push(`layout( location = ${a.index} ) out ${a.type} ${a.name};`);else{let a="struct "+i.name+` {
`;a+=this.getStructMembers(i),a+=`
};
`,t.push(a)}return r.length===0&&r.push("layout( location = 0 ) out vec4 fragColor;"),`
`+r.join(`
`)+`

`+t.join(`
`)}getVaryings(e){let t="";const n=this.varyings;if(e==="vertex"||e==="compute")for(const r of n){e==="compute"&&(r.needsInterpolation=!0);const i=this.getType(r.type);if(r.needsInterpolation)if(r.interpolationType){const a=$ge[r.interpolationType]||r.interpolationType,c=qge[r.interpolationSampling]||"";t+=`${a} ${c} out ${i} ${r.name};
`}else{const a=i.includes("int")||i.includes("uv")||i.includes("iv")?"flat ":"";t+=`${a}out ${i} ${r.name};
`}else t+=`${i} ${r.name};
`}else if(e==="fragment"){for(const r of n)if(r.needsInterpolation){const i=this.getType(r.type);if(r.interpolationType){const a=$ge[r.interpolationType]||r.interpolationType,c=qge[r.interpolationSampling]||"";t+=`${a} ${c} in ${i} ${r.name};
`}else{const a=i.includes("int")||i.includes("uv")||i.includes("iv")?"flat ":"";t+=`${a}in ${i} ${r.name};
`}}}for(const r of this.builtins[e])t+=`${r};
`;return t}getVertexIndex(){return"uint( gl_VertexID )"}getInstanceIndex(){return"uint( gl_InstanceID )"}getInvocationLocalIndex(){return`uint( gl_InstanceID ) % ${this.object.workgroupSize.reduce((n,r)=>n*r,1)}u`}getDrawIndex(){return this.renderer.backend.extensions.has("WEBGL_multi_draw")?"uint( gl_DrawID )":null}getFrontFacing(){return"gl_FrontFacing"}getFragCoord(){return"gl_FragCoord.xy"}getFragDepth(){return"gl_FragDepth"}enableExtension(e,t,n=this.shaderStage){const r=this.extensions[n]||(this.extensions[n]=new Map);r.has(e)===!1&&r.set(e,{name:e,behavior:t})}getExtensions(e){const t=[];if(e==="vertex"){const r=this.renderer.backend.extensions;this.object.isBatchedMesh&&r.has("WEBGL_multi_draw")&&this.enableExtension("GL_ANGLE_multi_draw","require",e)}const n=this.extensions[e];if(n!==void 0)for(const{name:r,behavior:i}of n.values())t.push(`#extension ${r} : ${i}`);return t.join(`
`)}getClipDistance(){return"gl_ClipDistance"}isAvailable(e){let t=Wge[e];if(t===void 0){let n;switch(t=!1,e){case"float32Filterable":n="OES_texture_float_linear";break;case"clipDistance":n="WEBGL_clip_cull_distance";break}if(n!==void 0){const r=this.renderer.backend.extensions;r.has(n)&&(r.get(n),t=!0)}Wge[e]=t}return t}isFlipY(){return!0}enableHardwareClipping(e){this.enableExtension("GL_ANGLE_clip_cull_distance","require"),this.builtins.vertex.push(`out float gl_ClipDistance[ ${e} ]`)}enableMultiview(){this.enableExtension("GL_OVR_multiview2","require","fragment"),this.enableExtension("GL_OVR_multiview2","require","vertex"),this.builtins.vertex.push("layout(num_views = 2) in")}registerTransform(e,t){this.transforms.push({varyingName:e,attributeNode:t})}getTransforms(){const e=this.transforms;let t="";for(let n=0;n<e.length;n++){const r=e[n],i=this.getPropertyName(r.attributeNode);i&&(t+=`${r.varyingName} = ${i};
	`)}return t}_getGLSLUniformStruct(e,t){return`
layout( std140 ) uniform ${e} {
${t}
};`}_getGLSLVertexCode(e){return`#version 300 es

${this.getSignature()}

// extensions
${e.extensions}

// precision
${Xge}

// uniforms
${e.uniforms}

// varyings
${e.varyings}

// attributes
${e.attributes}

// codes
${e.codes}

void main() {

	// vars
	${e.vars}

	// transforms
	${e.transforms}

	// flow
	${e.flow}

	gl_PointSize = 1.0;

}
`}_getGLSLFragmentCode(e){return`#version 300 es

${this.getSignature()}

// extensions
${e.extensions}

// precision
${Xge}

// uniforms
${e.uniforms}

// varyings
${e.varyings}

// codes
${e.codes}

// structs
${e.structs}

void main() {

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}buildCode(){const e=this.material!==null?{fragment:{},vertex:{}}:{compute:{}};this.sortBindingGroups();for(const t in e){let n=`// code

`;n+=this.flowCode[t];const r=this.flowNodes[t],i=r[r.length-1];for(const c of r){const h=this.getFlowData(c),p=c.name;p&&(n.length>0&&(n+=`
`),n+=`	// flow -> ${p}
	`),n+=`${h.code}
	`,c===i&&t!=="compute"&&(n+=`// result
	`,t==="vertex"?(n+="gl_Position = ",n+=`${h.result};`):t==="fragment"&&(c.outputNode.isOutputStructNode||(n+="fragColor = ",n+=`${h.result};`)))}const a=e[t];a.extensions=this.getExtensions(t),a.uniforms=this.getUniforms(t),a.attributes=this.getAttributes(t),a.varyings=this.getVaryings(t),a.vars=this.getVars(t),a.structs=this.getStructs(t),a.codes=this.getCodes(t),a.transforms=this.getTransforms(t),a.flow=n}this.material!==null?(this.vertexShader=this._getGLSLVertexCode(e.vertex),this.fragmentShader=this._getGLSLFragmentCode(e.fragment)):this.computeShader=this._getGLSLVertexCode(e.compute)}getUniformFromNode(e,t,n,r=null){const i=super.getUniformFromNode(e,t,n,r),a=this.getDataFromNode(e,n,this.globalCache);let c=a.uniformGPU;if(c===void 0){const h=e.groupNode,p=h.name,v=this.getBindGroupArray(p,n);if(t==="texture")c=new zI(i.name,i.node,h),v.push(c);else if(t==="cubeTexture")c=new x5e(i.name,i.node,h),v.push(c);else if(t==="texture3D")c=new b5e(i.name,i.node,h),v.push(c);else if(t==="buffer"){e.name=`NodeBuffer_${e.id}`,i.name=`buffer${e.id}`;const x=new v5e(e,h);x.name=e.name,v.push(x),c=x}else{const x=this.uniformGroups[n]||(this.uniformGroups[n]={});let S=x[p];S===void 0&&(S=new _5e(n+"_"+p,h),x[p]=S,v.push(S)),c=this.getNodeUniform(i,t),S.addUniform(c)}a.uniformGPU=c}return i}}let qV=null,Y7=null;class S5e{constructor(e={}){this.parameters=Object.assign({},e),this.data=new WeakMap,this.renderer=null,this.domElement=null,this.timestampQueryPool={render:null,compute:null},this.trackTimestamp=e.trackTimestamp===!0}async init(e){this.renderer=e}get coordinateSystem(){}beginRender(){}finishRender(){}beginCompute(){}finishCompute(){}draw(){}compute(){}createProgram(){}destroyProgram(){}createBindings(){}updateBindings(){}updateBinding(){}createRenderPipeline(){}createComputePipeline(){}needsRenderUpdate(){}getRenderCacheKey(){}createNodeBuilder(){}createSampler(){}destroySampler(){}createDefaultTexture(){}createTexture(){}updateTexture(){}generateMipmaps(){}destroyTexture(){}async copyTextureToBuffer(){}copyTextureToTexture(){}copyFramebufferToTexture(){}createAttribute(){}createIndexAttribute(){}createStorageAttribute(){}updateAttribute(){}destroyAttribute(){}getContext(){}updateSize(){}updateViewport(){}isOccluded(){}async resolveTimestampsAsync(e="render"){if(!this.trackTimestamp){Ng("WebGPURenderer: Timestamp tracking is disabled.");return}const t=this.timestampQueryPool[e];if(!t){Ng(`WebGPURenderer: No timestamp query pool for type '${e}' found.`);return}const n=await t.resolveQueriesAsync();return this.renderer.info[e].timestamp=n,n}async waitForGPU(){}async getArrayBufferAsync(){}async hasFeatureAsync(){}hasFeature(){}getMaxAnisotropy(){}getDrawingBufferSize(){return qV=qV||new pi,this.renderer.getDrawingBufferSize(qV)}setScissorTest(){}getClearColor(){const e=this.renderer;return Y7=Y7||new lW,e.getClearColor(Y7),Y7.getRGB(Y7),Y7}getDomElement(){let e=this.domElement;return e===null&&(e=this.parameters.canvas!==void 0?this.parameters.canvas:pNe(),"setAttribute"in e&&e.setAttribute("data-engine",`three.js r${r3e} webgpu`),this.domElement=e),e}set(e,t){this.data.set(e,t)}get(e){let t=this.data.get(e);return t===void 0&&(t={},this.data.set(e,t)),t}has(e){return this.data.has(e)}delete(e){this.data.delete(e)}dispose(){}}let jVe=0;class HVe{constructor(e,t){this.buffers=[e.bufferGPU,t],this.type=e.type,this.bufferType=e.bufferType,this.pbo=e.pbo,this.byteLength=e.byteLength,this.bytesPerElement=e.BYTES_PER_ELEMENT,this.version=e.version,this.isInteger=e.isInteger,this.activeBufferIndex=0,this.baseId=e.id}get id(){return`${this.baseId}|${this.activeBufferIndex}`}get bufferGPU(){return this.buffers[this.activeBufferIndex]}get transformBuffer(){return this.buffers[this.activeBufferIndex^1]}switchBuffers(){this.activeBufferIndex^=1}}class WVe{constructor(e){this.backend=e}createAttribute(e,t){const n=this.backend,{gl:r}=n,i=e.array,a=e.usage||r.STATIC_DRAW,c=e.isInterleavedBufferAttribute?e.data:e,h=n.get(c);let p=h.bufferGPU;p===void 0&&(p=this._createBuffer(r,t,i,a),h.bufferGPU=p,h.bufferType=t,h.version=c.version);let v;if(i instanceof Float32Array)v=r.FLOAT;else if(i instanceof Uint16Array)e.isFloat16BufferAttribute?v=r.HALF_FLOAT:v=r.UNSIGNED_SHORT;else if(i instanceof Int16Array)v=r.SHORT;else if(i instanceof Uint32Array)v=r.UNSIGNED_INT;else if(i instanceof Int32Array)v=r.INT;else if(i instanceof Int8Array)v=r.BYTE;else if(i instanceof Uint8Array)v=r.UNSIGNED_BYTE;else if(i instanceof Uint8ClampedArray)v=r.UNSIGNED_BYTE;else throw new Error("THREE.WebGLBackend: Unsupported buffer data format: "+i);let x={bufferGPU:p,bufferType:t,type:v,byteLength:i.byteLength,bytesPerElement:i.BYTES_PER_ELEMENT,version:e.version,pbo:e.pbo,isInteger:v===r.INT||v===r.UNSIGNED_INT||e.gpuType===Pl,id:jVe++};if(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute){const S=this._createBuffer(r,t,i,a);x=new HVe(x,S)}n.set(e,x)}updateAttribute(e){const t=this.backend,{gl:n}=t,r=e.array,i=e.isInterleavedBufferAttribute?e.data:e,a=t.get(i),c=a.bufferType,h=e.isInterleavedBufferAttribute?e.data.updateRanges:e.updateRanges;if(n.bindBuffer(c,a.bufferGPU),h.length===0)n.bufferSubData(c,0,r);else{for(let p=0,v=h.length;p<v;p++){const x=h[p];n.bufferSubData(c,x.start*r.BYTES_PER_ELEMENT,r,x.start,x.count)}i.clearUpdateRanges()}n.bindBuffer(c,null),a.version=i.version}destroyAttribute(e){const t=this.backend,{gl:n}=t;e.isInterleavedBufferAttribute&&t.delete(e.data);const r=t.get(e);n.deleteBuffer(r.bufferGPU),t.delete(e)}async getArrayBufferAsync(e){const t=this.backend,{gl:n}=t,r=e.isInterleavedBufferAttribute?e.data:e,{bufferGPU:i}=t.get(r),a=e.array,c=a.byteLength;n.bindBuffer(n.COPY_READ_BUFFER,i);const h=n.createBuffer();n.bindBuffer(n.COPY_WRITE_BUFFER,h),n.bufferData(n.COPY_WRITE_BUFFER,c,n.STREAM_READ),n.copyBufferSubData(n.COPY_READ_BUFFER,n.COPY_WRITE_BUFFER,0,0,c),await t.utils._clientWaitAsync();const p=new e.array.constructor(a.length);return n.bindBuffer(n.COPY_WRITE_BUFFER,h),n.getBufferSubData(n.COPY_WRITE_BUFFER,0,p),n.deleteBuffer(h),n.bindBuffer(n.COPY_READ_BUFFER,null),n.bindBuffer(n.COPY_WRITE_BUFFER,null),p.buffer}_createBuffer(e,t,n,r){const i=e.createBuffer();return e.bindBuffer(t,i),e.bufferData(t,n,r),e.bindBuffer(t,null),i}}let XV,Aw;class $Ve{constructor(e){this.backend=e,this.gl=this.backend.gl,this.enabled={},this.currentFlipSided=null,this.currentCullFace=null,this.currentProgram=null,this.currentBlendingEnabled=!1,this.currentBlending=null,this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentPremultipledAlpha=null,this.currentPolygonOffsetFactor=null,this.currentPolygonOffsetUnits=null,this.currentColorMask=null,this.currentDepthFunc=null,this.currentDepthMask=null,this.currentStencilFunc=null,this.currentStencilRef=null,this.currentStencilFuncMask=null,this.currentStencilFail=null,this.currentStencilZFail=null,this.currentStencilZPass=null,this.currentStencilMask=null,this.currentLineWidth=null,this.currentClippingPlanes=0,this.currentVAO=null,this.currentIndex=null,this.currentBoundFramebuffers={},this.currentDrawbuffers=new WeakMap,this.maxTextures=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),this.currentTextureSlot=null,this.currentBoundTextures={},this.currentBoundBufferBases={},this._init()}_init(){const e=this.gl;XV={[lf]:e.FUNC_ADD,[i3e]:e.FUNC_SUBTRACT,[s3e]:e.FUNC_REVERSE_SUBTRACT},Aw={[B3]:e.ZERO,[o3e]:e.ONE,[a3e]:e.SRC_COLOR,[Yk]:e.SRC_ALPHA,[f3e]:e.SRC_ALPHA_SATURATE,[h3e]:e.DST_COLOR,[c3e]:e.DST_ALPHA,[l3e]:e.ONE_MINUS_SRC_COLOR,[Kk]:e.ONE_MINUS_SRC_ALPHA,[d3e]:e.ONE_MINUS_DST_COLOR,[u3e]:e.ONE_MINUS_DST_ALPHA};const t=e.getParameter(e.SCISSOR_BOX),n=e.getParameter(e.VIEWPORT);this.currentScissor=new Ri().fromArray(t),this.currentViewport=new Ri().fromArray(n),this._tempVec4=new Ri}enable(e){const{enabled:t}=this;t[e]!==!0&&(this.gl.enable(e),t[e]=!0)}disable(e){const{enabled:t}=this;t[e]!==!1&&(this.gl.disable(e),t[e]=!1)}setFlipSided(e){if(this.currentFlipSided!==e){const{gl:t}=this;e?t.frontFace(t.CW):t.frontFace(t.CCW),this.currentFlipSided=e}}setCullFace(e){const{gl:t}=this;e!==NIe?(this.enable(t.CULL_FACE),e!==this.currentCullFace&&(e===DIe?t.cullFace(t.BACK):e===OIe?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):this.disable(t.CULL_FACE),this.currentCullFace=e}setLineWidth(e){const{currentLineWidth:t,gl:n}=this;e!==t&&(n.lineWidth(e),this.currentLineWidth=e)}setBlending(e,t,n,r,i,a,c,h){const{gl:p}=this;if(e===z_){this.currentBlendingEnabled===!0&&(this.disable(p.BLEND),this.currentBlendingEnabled=!1);return}if(this.currentBlendingEnabled===!1&&(this.enable(p.BLEND),this.currentBlendingEnabled=!0),e!==rE){if(e!==this.currentBlending||h!==this.currentPremultipledAlpha){if((this.currentBlendEquation!==lf||this.currentBlendEquationAlpha!==lf)&&(p.blendEquation(p.FUNC_ADD),this.currentBlendEquation=lf,this.currentBlendEquationAlpha=lf),h)switch(e){case Eg:p.blendFuncSeparate(p.ONE,p.ONE_MINUS_SRC_ALPHA,p.ONE,p.ONE_MINUS_SRC_ALPHA);break;case $k:p.blendFunc(p.ONE,p.ONE);break;case qk:p.blendFuncSeparate(p.ZERO,p.ONE_MINUS_SRC_COLOR,p.ZERO,p.ONE);break;case Xk:p.blendFuncSeparate(p.ZERO,p.SRC_COLOR,p.ZERO,p.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",e);break}else switch(e){case Eg:p.blendFuncSeparate(p.SRC_ALPHA,p.ONE_MINUS_SRC_ALPHA,p.ONE,p.ONE_MINUS_SRC_ALPHA);break;case $k:p.blendFunc(p.SRC_ALPHA,p.ONE);break;case qk:p.blendFuncSeparate(p.ZERO,p.ONE_MINUS_SRC_COLOR,p.ZERO,p.ONE);break;case Xk:p.blendFunc(p.ZERO,p.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",e);break}this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentBlending=e,this.currentPremultipledAlpha=h}return}i=i||t,a=a||n,c=c||r,(t!==this.currentBlendEquation||i!==this.currentBlendEquationAlpha)&&(p.blendEquationSeparate(XV[t],XV[i]),this.currentBlendEquation=t,this.currentBlendEquationAlpha=i),(n!==this.currentBlendSrc||r!==this.currentBlendDst||a!==this.currentBlendSrcAlpha||c!==this.currentBlendDstAlpha)&&(p.blendFuncSeparate(Aw[n],Aw[r],Aw[a],Aw[c]),this.currentBlendSrc=n,this.currentBlendDst=r,this.currentBlendSrcAlpha=a,this.currentBlendDstAlpha=c),this.currentBlending=e,this.currentPremultipledAlpha=!1}setColorMask(e){this.currentColorMask!==e&&(this.gl.colorMask(e,e,e,e),this.currentColorMask=e)}setDepthTest(e){const{gl:t}=this;e?this.enable(t.DEPTH_TEST):this.disable(t.DEPTH_TEST)}setDepthMask(e){this.currentDepthMask!==e&&(this.gl.depthMask(e),this.currentDepthMask=e)}setDepthFunc(e){if(this.currentDepthFunc!==e){const{gl:t}=this;switch(e){case p3e:t.depthFunc(t.NEVER);break;case m3e:t.depthFunc(t.ALWAYS);break;case g3e:t.depthFunc(t.LESS);break;case Zk:t.depthFunc(t.LEQUAL);break;case y3e:t.depthFunc(t.EQUAL);break;case v3e:t.depthFunc(t.GEQUAL);break;case _3e:t.depthFunc(t.GREATER);break;case x3e:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}this.currentDepthFunc=e}}scissor(e,t,n,r){const i=this._tempVec4.set(e,t,n,r);if(this.currentScissor.equals(i)===!1){const{gl:a}=this;a.scissor(i.x,i.y,i.z,i.w),this.currentScissor.copy(i)}}viewport(e,t,n,r){const i=this._tempVec4.set(e,t,n,r);if(this.currentViewport.equals(i)===!1){const{gl:a}=this;a.viewport(i.x,i.y,i.z,i.w),this.currentViewport.copy(i)}}setScissorTest(e){const t=this.gl;e?t.enable(t.SCISSOR_TEST):t.disable(t.SCISSOR_TEST)}setStencilTest(e){const{gl:t}=this;e?this.enable(t.STENCIL_TEST):this.disable(t.STENCIL_TEST)}setStencilMask(e){this.currentStencilMask!==e&&(this.gl.stencilMask(e),this.currentStencilMask=e)}setStencilFunc(e,t,n){(this.currentStencilFunc!==e||this.currentStencilRef!==t||this.currentStencilFuncMask!==n)&&(this.gl.stencilFunc(e,t,n),this.currentStencilFunc=e,this.currentStencilRef=t,this.currentStencilFuncMask=n)}setStencilOp(e,t,n){(this.currentStencilFail!==e||this.currentStencilZFail!==t||this.currentStencilZPass!==n)&&(this.gl.stencilOp(e,t,n),this.currentStencilFail=e,this.currentStencilZFail=t,this.currentStencilZPass=n)}setMaterial(e,t,n){const{gl:r}=this;e.side===S_?this.disable(r.CULL_FACE):this.enable(r.CULL_FACE);let i=e.side===Ec;t&&(i=!i),this.setFlipSided(i),e.blending===Eg&&e.transparent===!1?this.setBlending(z_):this.setBlending(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),this.setDepthFunc(e.depthFunc),this.setDepthTest(e.depthTest),this.setDepthMask(e.depthWrite),this.setColorMask(e.colorWrite);const a=e.stencilWrite;if(this.setStencilTest(a),a&&(this.setStencilMask(e.stencilWriteMask),this.setStencilFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),this.setStencilOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),this.setPolygonOffset(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),e.alphaToCoverage===!0&&this.backend.renderer.samples>1?this.enable(r.SAMPLE_ALPHA_TO_COVERAGE):this.disable(r.SAMPLE_ALPHA_TO_COVERAGE),n>0&&this.currentClippingPlanes!==n)for(let h=0;h<8;h++)h<n?this.enable(12288+h):this.disable(12288+h)}setPolygonOffset(e,t,n){const{gl:r}=this;e?(this.enable(r.POLYGON_OFFSET_FILL),(this.currentPolygonOffsetFactor!==t||this.currentPolygonOffsetUnits!==n)&&(r.polygonOffset(t,n),this.currentPolygonOffsetFactor=t,this.currentPolygonOffsetUnits=n)):this.disable(r.POLYGON_OFFSET_FILL)}useProgram(e){return this.currentProgram!==e?(this.gl.useProgram(e),this.currentProgram=e,!0):!1}setVertexState(e,t=null){const n=this.gl;return this.currentVAO!==e||this.currentIndex!==t?(n.bindVertexArray(e),t!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t),this.currentVAO=e,this.currentIndex=t,!0):!1}resetVertexState(){const e=this.gl;e.bindVertexArray(null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),this.currentVAO=null,this.currentIndex=null}bindFramebuffer(e,t){const{gl:n,currentBoundFramebuffers:r}=this;return r[e]!==t?(n.bindFramebuffer(e,t),r[e]=t,e===n.DRAW_FRAMEBUFFER&&(r[n.FRAMEBUFFER]=t),e===n.FRAMEBUFFER&&(r[n.DRAW_FRAMEBUFFER]=t),!0):!1}drawBuffers(e,t){const{gl:n}=this;let r=[],i=!1;if(e.textures!==null){r=this.currentDrawbuffers.get(t),r===void 0&&(r=[],this.currentDrawbuffers.set(t,r));const a=e.textures;if(r.length!==a.length||r[0]!==n.COLOR_ATTACHMENT0){for(let c=0,h=a.length;c<h;c++)r[c]=n.COLOR_ATTACHMENT0+c;r.length=a.length,i=!0}}else r[0]!==n.BACK&&(r[0]=n.BACK,i=!0);i&&n.drawBuffers(r)}activeTexture(e){const{gl:t,currentTextureSlot:n,maxTextures:r}=this;e===void 0&&(e=t.TEXTURE0+r-1),n!==e&&(t.activeTexture(e),this.currentTextureSlot=e)}bindTexture(e,t,n){const{gl:r,currentTextureSlot:i,currentBoundTextures:a,maxTextures:c}=this;n===void 0&&(i===null?n=r.TEXTURE0+c-1:n=i);let h=a[n];h===void 0&&(h={type:void 0,texture:void 0},a[n]=h),(h.type!==e||h.texture!==t)&&(i!==n&&(r.activeTexture(n),this.currentTextureSlot=n),r.bindTexture(e,t),h.type=e,h.texture=t)}bindBufferBase(e,t,n){const{gl:r}=this,i=`${e}-${t}`;return this.currentBoundBufferBases[i]!==n?(r.bindBufferBase(e,t,n),this.currentBoundBufferBases[i]=n,!0):!1}unbindTexture(){const{gl:e,currentTextureSlot:t,currentBoundTextures:n}=this,r=n[t];r!==void 0&&r.type!==void 0&&(e.bindTexture(r.type,null),r.type=void 0,r.texture=void 0)}}class qVe{constructor(e){this.backend=e,this.gl=this.backend.gl,this.extensions=e.extensions}convert(e,t=Ig){const{gl:n,extensions:r}=this;let i;const a=Os.getTransfer(t);if(e===Il)return n.UNSIGNED_BYTE;if(e===XIe)return n.UNSIGNED_SHORT_4_4_4_4;if(e===YIe)return n.UNSIGNED_SHORT_5_5_5_1;if(e===S3e)return n.UNSIGNED_INT_5_9_9_9_REV;if(e===iE)return n.BYTE;if(e===sE)return n.SHORT;if(e===d_)return n.UNSIGNED_SHORT;if(e===Pl)return n.INT;if(e===Ho)return n.UNSIGNED_INT;if(e===Su)return n.FLOAT;if(e===Mh)return n.HALF_FLOAT;if(e===KIe)return n.ALPHA;if(e===QH)return n.RGB;if(e===Ch)return n.RGBA;if(e===e1)return n.DEPTH_COMPONENT;if(e===Mg)return n.DEPTH_STENCIL;if(e===JH)return n.RED;if(e===eW)return n.RED_INTEGER;if(e===f6)return n.RG;if(e===tW)return n.RG_INTEGER;if(e===nW)return n.RGBA_INTEGER;if(e===Xz||e===wk||e===Ek||e===Tk)if(a===Yr)if(i=r.get("WEBGL_compressed_texture_s3tc_srgb"),i!==null){if(e===Xz)return i.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(e===wk)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(e===Ek)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(e===Tk)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(i=r.get("WEBGL_compressed_texture_s3tc"),i!==null){if(e===Xz)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===wk)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===Ek)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===Tk)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(e===sme||e===ome||e===ame||e===lme)if(i=r.get("WEBGL_compressed_texture_pvrtc"),i!==null){if(e===sme)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===ome)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===ame)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===lme)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(e===cme||e===Ej||e===Tj)if(i=r.get("WEBGL_compressed_texture_etc"),i!==null){if(e===cme||e===Ej)return a===Yr?i.COMPRESSED_SRGB8_ETC2:i.COMPRESSED_RGB8_ETC2;if(e===Tj)return a===Yr?i.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:i.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(e===Mj||e===Cj||e===Aj||e===Pj||e===Rj||e===kj||e===Ij||e===Nj||e===Dj||e===Oj||e===Fj||e===Lj||e===Bj||e===Uj)if(i=r.get("WEBGL_compressed_texture_astc"),i!==null){if(e===Mj)return a===Yr?i.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:i.COMPRESSED_RGBA_ASTC_4x4_KHR;if(e===Cj)return a===Yr?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:i.COMPRESSED_RGBA_ASTC_5x4_KHR;if(e===Aj)return a===Yr?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:i.COMPRESSED_RGBA_ASTC_5x5_KHR;if(e===Pj)return a===Yr?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:i.COMPRESSED_RGBA_ASTC_6x5_KHR;if(e===Rj)return a===Yr?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:i.COMPRESSED_RGBA_ASTC_6x6_KHR;if(e===kj)return a===Yr?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:i.COMPRESSED_RGBA_ASTC_8x5_KHR;if(e===Ij)return a===Yr?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:i.COMPRESSED_RGBA_ASTC_8x6_KHR;if(e===Nj)return a===Yr?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:i.COMPRESSED_RGBA_ASTC_8x8_KHR;if(e===Dj)return a===Yr?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:i.COMPRESSED_RGBA_ASTC_10x5_KHR;if(e===Oj)return a===Yr?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:i.COMPRESSED_RGBA_ASTC_10x6_KHR;if(e===Fj)return a===Yr?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:i.COMPRESSED_RGBA_ASTC_10x8_KHR;if(e===Lj)return a===Yr?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:i.COMPRESSED_RGBA_ASTC_10x10_KHR;if(e===Bj)return a===Yr?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:i.COMPRESSED_RGBA_ASTC_12x10_KHR;if(e===Uj)return a===Yr?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:i.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(e===Yz)if(i=r.get("EXT_texture_compression_bptc"),i!==null){if(e===Yz)return a===Yr?i.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:i.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(e===QIe||e===ume||e===hme||e===dme)if(i=r.get("EXT_texture_compression_rgtc"),i!==null){if(e===Yz)return i.COMPRESSED_RED_RGTC1_EXT;if(e===ume)return i.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(e===hme)return i.COMPRESSED_RED_GREEN_RGTC2_EXT;if(e===dme)return i.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return e===$3?n.UNSIGNED_INT_24_8:n[e]!==void 0?n[e]:null}_clientWaitAsync(){const{gl:e}=this,t=e.fenceSync(e.SYNC_GPU_COMMANDS_COMPLETE,0);return e.flush(),new Promise((n,r)=>{function i(){const a=e.clientWaitSync(t,e.SYNC_FLUSH_COMMANDS_BIT,0);if(a===e.WAIT_FAILED){e.deleteSync(t),r();return}if(a===e.TIMEOUT_EXPIRED){requestAnimationFrame(i);return}e.deleteSync(t),n()}i()})}}let Yge=!1,tk,YV,Kge;class XVe{constructor(e){this.backend=e,this.gl=e.gl,this.extensions=e.extensions,this.defaultTextures={},Yge===!1&&(this._init(),Yge=!0)}_init(){const e=this.gl;tk={[V_]:e.REPEAT,[W3]:e.CLAMP_TO_EDGE,[G_]:e.MIRRORED_REPEAT},YV={[ya]:e.NEAREST,[b3e]:e.NEAREST_MIPMAP_NEAREST,[TE]:e.NEAREST_MIPMAP_LINEAR,[Eu]:e.LINEAR,[wj]:e.LINEAR_MIPMAP_NEAREST,[Tg]:e.LINEAR_MIPMAP_LINEAR},Kge={[w3e]:e.NEVER,[P3e]:e.ALWAYS,[rW]:e.LESS,[T3e]:e.LEQUAL,[E3e]:e.EQUAL,[A3e]:e.GEQUAL,[M3e]:e.GREATER,[C3e]:e.NOTEQUAL}}getGLTextureType(e){const{gl:t}=this;let n;return e.isCubeTexture===!0?n=t.TEXTURE_CUBE_MAP:e.isArrayTexture===!0||e.isDataArrayTexture===!0||e.isCompressedArrayTexture===!0?n=t.TEXTURE_2D_ARRAY:e.isData3DTexture===!0?n=t.TEXTURE_3D:n=t.TEXTURE_2D,n}getInternalFormat(e,t,n,r,i=!1){const{gl:a,extensions:c}=this;if(e!==null){if(a[e]!==void 0)return a[e];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+e+"'")}let h=t;if(t===a.RED&&(n===a.FLOAT&&(h=a.R32F),n===a.HALF_FLOAT&&(h=a.R16F),n===a.UNSIGNED_BYTE&&(h=a.R8),n===a.UNSIGNED_SHORT&&(h=a.R16),n===a.UNSIGNED_INT&&(h=a.R32UI),n===a.BYTE&&(h=a.R8I),n===a.SHORT&&(h=a.R16I),n===a.INT&&(h=a.R32I)),t===a.RED_INTEGER&&(n===a.UNSIGNED_BYTE&&(h=a.R8UI),n===a.UNSIGNED_SHORT&&(h=a.R16UI),n===a.UNSIGNED_INT&&(h=a.R32UI),n===a.BYTE&&(h=a.R8I),n===a.SHORT&&(h=a.R16I),n===a.INT&&(h=a.R32I)),t===a.RG&&(n===a.FLOAT&&(h=a.RG32F),n===a.HALF_FLOAT&&(h=a.RG16F),n===a.UNSIGNED_BYTE&&(h=a.RG8),n===a.UNSIGNED_SHORT&&(h=a.RG16),n===a.UNSIGNED_INT&&(h=a.RG32UI),n===a.BYTE&&(h=a.RG8I),n===a.SHORT&&(h=a.RG16I),n===a.INT&&(h=a.RG32I)),t===a.RG_INTEGER&&(n===a.UNSIGNED_BYTE&&(h=a.RG8UI),n===a.UNSIGNED_SHORT&&(h=a.RG16UI),n===a.UNSIGNED_INT&&(h=a.RG32UI),n===a.BYTE&&(h=a.RG8I),n===a.SHORT&&(h=a.RG16I),n===a.INT&&(h=a.RG32I)),t===a.RGB){const p=i?Jk:Os.getTransfer(r);n===a.FLOAT&&(h=a.RGB32F),n===a.HALF_FLOAT&&(h=a.RGB16F),n===a.UNSIGNED_BYTE&&(h=a.RGB8),n===a.UNSIGNED_SHORT&&(h=a.RGB16),n===a.UNSIGNED_INT&&(h=a.RGB32UI),n===a.BYTE&&(h=a.RGB8I),n===a.SHORT&&(h=a.RGB16I),n===a.INT&&(h=a.RGB32I),n===a.UNSIGNED_BYTE&&(h=p===Yr?a.SRGB8:a.RGB8),n===a.UNSIGNED_SHORT_5_6_5&&(h=a.RGB565),n===a.UNSIGNED_SHORT_5_5_5_1&&(h=a.RGB5_A1),n===a.UNSIGNED_SHORT_4_4_4_4&&(h=a.RGB4),n===a.UNSIGNED_INT_5_9_9_9_REV&&(h=a.RGB9_E5)}if(t===a.RGB_INTEGER&&(n===a.UNSIGNED_BYTE&&(h=a.RGB8UI),n===a.UNSIGNED_SHORT&&(h=a.RGB16UI),n===a.UNSIGNED_INT&&(h=a.RGB32UI),n===a.BYTE&&(h=a.RGB8I),n===a.SHORT&&(h=a.RGB16I),n===a.INT&&(h=a.RGB32I)),t===a.RGBA){const p=i?Jk:Os.getTransfer(r);n===a.FLOAT&&(h=a.RGBA32F),n===a.HALF_FLOAT&&(h=a.RGBA16F),n===a.UNSIGNED_BYTE&&(h=a.RGBA8),n===a.UNSIGNED_SHORT&&(h=a.RGBA16),n===a.UNSIGNED_INT&&(h=a.RGBA32UI),n===a.BYTE&&(h=a.RGBA8I),n===a.SHORT&&(h=a.RGBA16I),n===a.INT&&(h=a.RGBA32I),n===a.UNSIGNED_BYTE&&(h=p===Yr?a.SRGB8_ALPHA8:a.RGBA8),n===a.UNSIGNED_SHORT_4_4_4_4&&(h=a.RGBA4),n===a.UNSIGNED_SHORT_5_5_5_1&&(h=a.RGB5_A1)}return t===a.RGBA_INTEGER&&(n===a.UNSIGNED_BYTE&&(h=a.RGBA8UI),n===a.UNSIGNED_SHORT&&(h=a.RGBA16UI),n===a.UNSIGNED_INT&&(h=a.RGBA32UI),n===a.BYTE&&(h=a.RGBA8I),n===a.SHORT&&(h=a.RGBA16I),n===a.INT&&(h=a.RGBA32I)),t===a.DEPTH_COMPONENT&&(n===a.UNSIGNED_SHORT&&(h=a.DEPTH_COMPONENT16),n===a.UNSIGNED_INT&&(h=a.DEPTH_COMPONENT24),n===a.FLOAT&&(h=a.DEPTH_COMPONENT32F)),t===a.DEPTH_STENCIL&&n===a.UNSIGNED_INT_24_8&&(h=a.DEPTH24_STENCIL8),(h===a.R16F||h===a.R32F||h===a.RG16F||h===a.RG32F||h===a.RGBA16F||h===a.RGBA32F)&&c.get("EXT_color_buffer_float"),h}setTextureParameters(e,t){const{gl:n,extensions:r,backend:i}=this,a=Os.getPrimaries(Os.workingColorSpace),c=t.colorSpace===Ig?null:Os.getPrimaries(t.colorSpace),h=t.colorSpace===Ig||a===c?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,t.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,t.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,h),n.texParameteri(e,n.TEXTURE_WRAP_S,tk[t.wrapS]),n.texParameteri(e,n.TEXTURE_WRAP_T,tk[t.wrapT]),(e===n.TEXTURE_3D||e===n.TEXTURE_2D_ARRAY)&&(t.isArrayTexture||n.texParameteri(e,n.TEXTURE_WRAP_R,tk[t.wrapR])),n.texParameteri(e,n.TEXTURE_MAG_FILTER,YV[t.magFilter]);const p=t.mipmaps!==void 0&&t.mipmaps.length>0,v=t.minFilter===Eu&&p?Tg:t.minFilter;if(n.texParameteri(e,n.TEXTURE_MIN_FILTER,YV[v]),t.compareFunction&&(n.texParameteri(e,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(e,n.TEXTURE_COMPARE_FUNC,Kge[t.compareFunction])),r.has("EXT_texture_filter_anisotropic")===!0){if(t.magFilter===ya||t.minFilter!==TE&&t.minFilter!==Tg||t.type===Su&&r.has("OES_texture_float_linear")===!1)return;if(t.anisotropy>1){const x=r.get("EXT_texture_filter_anisotropic");n.texParameterf(e,x.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(t.anisotropy,i.getMaxAnisotropy()))}}}createDefaultTexture(e){const{gl:t,backend:n,defaultTextures:r}=this,i=this.getGLTextureType(e);let a=r[i];a===void 0&&(a=t.createTexture(),n.state.bindTexture(i,a),t.texParameteri(i,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(i,t.TEXTURE_MAG_FILTER,t.NEAREST),r[i]=a),n.set(e,{textureGPU:a,glTextureType:i,isDefault:!0})}createTexture(e,t){const{gl:n,backend:r}=this,{levels:i,width:a,height:c,depth:h}=t,p=r.utils.convert(e.format,e.colorSpace),v=r.utils.convert(e.type),x=this.getInternalFormat(e.internalFormat,p,v,e.colorSpace,e.isVideoTexture),S=n.createTexture(),C=this.getGLTextureType(e);r.state.bindTexture(C,S),this.setTextureParameters(C,e),e.isArrayTexture||e.isDataArrayTexture||e.isCompressedArrayTexture?n.texStorage3D(n.TEXTURE_2D_ARRAY,i,x,a,c,h):e.isData3DTexture?n.texStorage3D(n.TEXTURE_3D,i,x,a,c,h):e.isVideoTexture||n.texStorage2D(C,i,x,a,c),r.set(e,{textureGPU:S,glTextureType:C,glFormat:p,glType:v,glInternalFormat:x})}copyBufferToTexture(e,t){const{gl:n,backend:r}=this,{textureGPU:i,glTextureType:a,glFormat:c,glType:h}=r.get(t),{width:p,height:v}=t.source.data;n.bindBuffer(n.PIXEL_UNPACK_BUFFER,e),r.state.bindTexture(a,i),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),n.texSubImage2D(a,0,0,0,p,v,c,h,0),n.bindBuffer(n.PIXEL_UNPACK_BUFFER,null),r.state.unbindTexture()}updateTexture(e,t){const{gl:n}=this,{width:r,height:i}=t,{textureGPU:a,glTextureType:c,glFormat:h,glType:p,glInternalFormat:v}=this.backend.get(e);if(!(e.isRenderTargetTexture||a===void 0))if(this.backend.state.bindTexture(c,a),this.setTextureParameters(c,e),e.isCompressedTexture){const x=e.mipmaps,S=t.image;for(let C=0;C<x.length;C++){const I=x[C];e.isCompressedArrayTexture?e.format!==n.RGBA?h!==null?n.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,C,0,0,0,I.width,I.height,S.depth,h,I.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texSubImage3D(n.TEXTURE_2D_ARRAY,C,0,0,0,I.width,I.height,S.depth,h,p,I.data):h!==null?n.compressedTexSubImage2D(n.TEXTURE_2D,C,0,0,I.width,I.height,h,I.data):console.warn("Unsupported compressed texture format")}}else if(e.isCubeTexture){const x=t.images;for(let S=0;S<6;S++){const C=Zge(x[S]);n.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+S,0,0,0,r,i,h,p,C)}}else if(e.isDataArrayTexture||e.isArrayTexture){const x=t.image;n.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,x.width,x.height,x.depth,h,p,x.data)}else if(e.isData3DTexture){const x=t.image;n.texSubImage3D(n.TEXTURE_3D,0,0,0,0,x.width,x.height,x.depth,h,p,x.data)}else if(e.isVideoTexture)e.update(),n.texImage2D(c,0,v,h,p,t.image);else{const x=Zge(t.image);n.texSubImage2D(c,0,0,0,r,i,h,p,x)}}generateMipmaps(e){const{gl:t,backend:n}=this,{textureGPU:r,glTextureType:i}=n.get(e);n.state.bindTexture(i,r),t.generateMipmap(i)}deallocateRenderBuffers(e){const{gl:t,backend:n}=this;if(e){const r=n.get(e);if(r.renderBufferStorageSetup=void 0,r.framebuffers){for(const i in r.framebuffers)t.deleteFramebuffer(r.framebuffers[i]);delete r.framebuffers}if(r.depthRenderbuffer&&(t.deleteRenderbuffer(r.depthRenderbuffer),delete r.depthRenderbuffer),r.stencilRenderbuffer&&(t.deleteRenderbuffer(r.stencilRenderbuffer),delete r.stencilRenderbuffer),r.msaaFrameBuffer&&(t.deleteFramebuffer(r.msaaFrameBuffer),delete r.msaaFrameBuffer),r.msaaRenderbuffers){for(let i=0;i<r.msaaRenderbuffers.length;i++)t.deleteRenderbuffer(r.msaaRenderbuffers[i]);delete r.msaaRenderbuffers}}}destroyTexture(e){const{gl:t,backend:n}=this,{textureGPU:r,renderTarget:i}=n.get(e);this.deallocateRenderBuffers(i),t.deleteTexture(r),n.delete(e)}copyTextureToTexture(e,t,n=null,r=null,i=0,a=0){const{gl:c,backend:h}=this,{state:p}=this.backend,{textureGPU:v,glTextureType:x,glType:S,glFormat:C}=h.get(t);p.bindTexture(x,v);let I,L,U,R,$,Z,k,ie,ue;const ce=e.isCompressedTexture?e.mipmaps[a]:e.image;if(n!==null)I=n.max.x-n.min.x,L=n.max.y-n.min.y,U=n.isBox3?n.max.z-n.min.z:1,R=n.min.x,$=n.min.y,Z=n.isBox3?n.min.z:0;else{const rt=Math.pow(2,-i);I=Math.floor(ce.width*rt),L=Math.floor(ce.height*rt),e.isDataArrayTexture||e.isArrayTexture?U=ce.depth:e.isData3DTexture?U=Math.floor(ce.depth*rt):U=1,R=0,$=0,Z=0}r!==null?(k=r.x,ie=r.y,ue=r.z):(k=0,ie=0,ue=0),c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,t.flipY),c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),c.pixelStorei(c.UNPACK_ALIGNMENT,t.unpackAlignment);const Q=c.getParameter(c.UNPACK_ROW_LENGTH),ae=c.getParameter(c.UNPACK_IMAGE_HEIGHT),le=c.getParameter(c.UNPACK_SKIP_PIXELS),J=c.getParameter(c.UNPACK_SKIP_ROWS),Ue=c.getParameter(c.UNPACK_SKIP_IMAGES);c.pixelStorei(c.UNPACK_ROW_LENGTH,ce.width),c.pixelStorei(c.UNPACK_IMAGE_HEIGHT,ce.height),c.pixelStorei(c.UNPACK_SKIP_PIXELS,R),c.pixelStorei(c.UNPACK_SKIP_ROWS,$),c.pixelStorei(c.UNPACK_SKIP_IMAGES,Z);const je=t.isDataArrayTexture||t.isData3DTexture||t.isArrayTexture;if(e.isRenderTargetTexture||e.isDepthTexture){const rt=h.get(e),at=h.get(t),Se=h.get(rt.renderTarget),gt=h.get(at.renderTarget),Ae=Se.framebuffers[rt.cacheKey],lt=gt.framebuffers[at.cacheKey];p.bindFramebuffer(c.READ_FRAMEBUFFER,Ae),p.bindFramebuffer(c.DRAW_FRAMEBUFFER,lt);let pt=c.COLOR_BUFFER_BIT;e.isDepthTexture&&(pt=c.DEPTH_BUFFER_BIT),c.blitFramebuffer(R,$,I,L,k,ie,I,L,pt,c.NEAREST),p.bindFramebuffer(c.READ_FRAMEBUFFER,null),p.bindFramebuffer(c.DRAW_FRAMEBUFFER,null)}else je?e.isDataTexture||e.isData3DTexture?c.texSubImage3D(x,a,k,ie,ue,I,L,U,C,S,ce.data):t.isCompressedArrayTexture?c.compressedTexSubImage3D(x,a,k,ie,ue,I,L,U,C,ce.data):c.texSubImage3D(x,a,k,ie,ue,I,L,U,C,S,ce):e.isDataTexture?c.texSubImage2D(x,a,k,ie,I,L,C,S,ce.data):e.isCompressedTexture?c.compressedTexSubImage2D(x,a,k,ie,ce.width,ce.height,C,ce.data):c.texSubImage2D(x,a,k,ie,I,L,C,S,ce);c.pixelStorei(c.UNPACK_ROW_LENGTH,Q),c.pixelStorei(c.UNPACK_IMAGE_HEIGHT,ae),c.pixelStorei(c.UNPACK_SKIP_PIXELS,le),c.pixelStorei(c.UNPACK_SKIP_ROWS,J),c.pixelStorei(c.UNPACK_SKIP_IMAGES,Ue),a===0&&t.generateMipmaps&&c.generateMipmap(x),p.unbindTexture()}copyFramebufferToTexture(e,t,n){const{gl:r}=this,{state:i}=this.backend,{textureGPU:a}=this.backend.get(e),{x:c,y:h,z:p,w:v}=n,x=e.isDepthTexture===!0||t.renderTarget&&t.renderTarget.samples>0,S=t.renderTarget?t.renderTarget.height:this.backend.getDrawingBufferSize().y;if(x){const C=c!==0||h!==0;let I,L;if(e.isDepthTexture===!0?(I=r.DEPTH_BUFFER_BIT,L=r.DEPTH_ATTACHMENT,t.stencil&&(I|=r.STENCIL_BUFFER_BIT)):(I=r.COLOR_BUFFER_BIT,L=r.COLOR_ATTACHMENT0),C){const U=this.backend.get(t.renderTarget),R=U.framebuffers[t.getCacheKey()],$=U.msaaFrameBuffer;i.bindFramebuffer(r.DRAW_FRAMEBUFFER,R),i.bindFramebuffer(r.READ_FRAMEBUFFER,$);const Z=S-h-v;r.blitFramebuffer(c,Z,c+p,Z+v,c,Z,c+p,Z+v,I,r.NEAREST),i.bindFramebuffer(r.READ_FRAMEBUFFER,R),i.bindTexture(r.TEXTURE_2D,a),r.copyTexSubImage2D(r.TEXTURE_2D,0,0,0,c,Z,p,v),i.unbindTexture()}else{const U=r.createFramebuffer();i.bindFramebuffer(r.DRAW_FRAMEBUFFER,U),r.framebufferTexture2D(r.DRAW_FRAMEBUFFER,L,r.TEXTURE_2D,a,0),r.blitFramebuffer(0,0,p,v,0,0,p,v,I,r.NEAREST),r.deleteFramebuffer(U)}}else i.bindTexture(r.TEXTURE_2D,a),r.copyTexSubImage2D(r.TEXTURE_2D,0,0,0,c,S-v-h,p,v),i.unbindTexture();e.generateMipmaps&&this.generateMipmaps(e),this.backend._setFramebuffer(t)}setupRenderBufferStorage(e,t,n,r=!1){const{gl:i}=this,a=t.renderTarget,{depthTexture:c,depthBuffer:h,stencilBuffer:p,width:v,height:x}=a;if(i.bindRenderbuffer(i.RENDERBUFFER,e),h&&!p){let S=i.DEPTH_COMPONENT24;r===!0?this.extensions.get("WEBGL_multisampled_render_to_texture").renderbufferStorageMultisampleEXT(i.RENDERBUFFER,a.samples,S,v,x):n>0?(c&&c.isDepthTexture&&c.type===i.FLOAT&&(S=i.DEPTH_COMPONENT32F),i.renderbufferStorageMultisample(i.RENDERBUFFER,n,S,v,x)):i.renderbufferStorage(i.RENDERBUFFER,S,v,x),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.RENDERBUFFER,e)}else h&&p&&(n>0?i.renderbufferStorageMultisample(i.RENDERBUFFER,n,i.DEPTH24_STENCIL8,v,x):i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,v,x),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,e))}async copyTextureToBuffer(e,t,n,r,i,a){const{backend:c,gl:h}=this,{textureGPU:p,glFormat:v,glType:x}=this.backend.get(e),S=h.createFramebuffer();h.bindFramebuffer(h.READ_FRAMEBUFFER,S);const C=e.isCubeTexture?h.TEXTURE_CUBE_MAP_POSITIVE_X+a:h.TEXTURE_2D;h.framebufferTexture2D(h.READ_FRAMEBUFFER,h.COLOR_ATTACHMENT0,C,p,0);const I=this._getTypedArrayType(x),L=this._getBytesPerTexel(x,v),R=r*i*L,$=h.createBuffer();h.bindBuffer(h.PIXEL_PACK_BUFFER,$),h.bufferData(h.PIXEL_PACK_BUFFER,R,h.STREAM_READ),h.readPixels(t,n,r,i,v,x,0),h.bindBuffer(h.PIXEL_PACK_BUFFER,null),await c.utils._clientWaitAsync();const Z=new I(R/I.BYTES_PER_ELEMENT);return h.bindBuffer(h.PIXEL_PACK_BUFFER,$),h.getBufferSubData(h.PIXEL_PACK_BUFFER,0,Z),h.bindBuffer(h.PIXEL_PACK_BUFFER,null),h.deleteFramebuffer(S),Z}_getTypedArrayType(e){const{gl:t}=this;if(e===t.UNSIGNED_BYTE)return Uint8Array;if(e===t.UNSIGNED_SHORT_4_4_4_4||e===t.UNSIGNED_SHORT_5_5_5_1||e===t.UNSIGNED_SHORT_5_6_5||e===t.UNSIGNED_SHORT)return Uint16Array;if(e===t.UNSIGNED_INT)return Uint32Array;if(e===t.HALF_FLOAT)return Uint16Array;if(e===t.FLOAT)return Float32Array;throw new Error(`Unsupported WebGL type: ${e}`)}_getBytesPerTexel(e,t){const{gl:n}=this;let r=0;if(e===n.UNSIGNED_BYTE&&(r=1),(e===n.UNSIGNED_SHORT_4_4_4_4||e===n.UNSIGNED_SHORT_5_5_5_1||e===n.UNSIGNED_SHORT_5_6_5||e===n.UNSIGNED_SHORT||e===n.HALF_FLOAT)&&(r=2),(e===n.UNSIGNED_INT||e===n.FLOAT)&&(r=4),t===n.RGBA)return r*4;if(t===n.RGB)return r*3;if(t===n.ALPHA)return r}}function Zge(o){return o.isDataTexture?o.image.data:typeof HTMLImageElement<"u"&&o instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&o instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&o instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&o instanceof OffscreenCanvas?o:o.data}class YVe{constructor(e){this.backend=e,this.gl=this.backend.gl,this.availableExtensions=this.gl.getSupportedExtensions(),this.extensions={}}get(e){let t=this.extensions[e];return t===void 0&&(t=this.gl.getExtension(e),this.extensions[e]=t),t}has(e){return this.availableExtensions.includes(e)}}class KVe{constructor(e){this.backend=e,this.maxAnisotropy=null}getMaxAnisotropy(){if(this.maxAnisotropy!==null)return this.maxAnisotropy;const e=this.backend.gl,t=this.backend.extensions;if(t.has("EXT_texture_filter_anisotropic")===!0){const n=t.get("EXT_texture_filter_anisotropic");this.maxAnisotropy=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else this.maxAnisotropy=0;return this.maxAnisotropy}}const Qge={WEBGL_multi_draw:"WEBGL_multi_draw",WEBGL_compressed_texture_astc:"texture-compression-astc",WEBGL_compressed_texture_etc:"texture-compression-etc2",WEBGL_compressed_texture_etc1:"texture-compression-etc1",WEBGL_compressed_texture_pvrtc:"texture-compression-pvrtc",WEBKIT_WEBGL_compressed_texture_pvrtc:"texture-compression-pvrtc",WEBGL_compressed_texture_s3tc:"texture-compression-bc",EXT_texture_compression_bptc:"texture-compression-bptc",EXT_disjoint_timer_query_webgl2:"timestamp-query",OVR_multiview2:"OVR_multiview2"};class ZVe{constructor(e){this.gl=e.gl,this.extensions=e.extensions,this.info=e.renderer.info,this.mode=null,this.index=0,this.type=null,this.object=null}render(e,t){const{gl:n,mode:r,object:i,type:a,info:c,index:h}=this;h!==0?n.drawElements(r,t,a,e):n.drawArrays(r,e,t),c.update(i,t,1)}renderInstances(e,t,n){const{gl:r,mode:i,type:a,index:c,object:h,info:p}=this;n!==0&&(c!==0?r.drawElementsInstanced(i,t,a,e,n):r.drawArraysInstanced(i,e,t,n),p.update(h,t,n))}renderMultiDraw(e,t,n){const{extensions:r,mode:i,object:a,info:c}=this;if(n===0)return;const h=r.get("WEBGL_multi_draw");if(h===null)for(let p=0;p<n;p++)this.render(e[p],t[p]);else{this.index!==0?h.multiDrawElementsWEBGL(i,t,0,this.type,e,0,n):h.multiDrawArraysWEBGL(i,e,0,t,0,n);let p=0;for(let v=0;v<n;v++)p+=t[v];c.update(a,p,1)}}renderMultiDrawInstances(e,t,n,r){const{extensions:i,mode:a,object:c,info:h}=this;if(n===0)return;const p=i.get("WEBGL_multi_draw");if(p===null)for(let v=0;v<n;v++)this.renderInstances(e[v],t[v],r[v]);else{this.index!==0?p.multiDrawElementsInstancedWEBGL(a,t,0,this.type,e,0,r,0,n):p.multiDrawArraysInstancedWEBGL(a,e,0,t,0,r,0,n);let v=0;for(let x=0;x<n;x++)v+=t[x]*r[x];h.update(c,v,1)}}}class w5e{constructor(e=256){this.trackTimestamp=!0,this.maxQueries=e,this.currentQueryIndex=0,this.queryOffsets=new Map,this.isDisposed=!1,this.lastValue=0,this.pendingResolve=!1}allocateQueriesForContext(){}async resolveQueriesAsync(){}dispose(){}}class QVe extends w5e{constructor(e,t,n=2048){if(super(n),this.gl=e,this.type=t,this.ext=e.getExtension("EXT_disjoint_timer_query_webgl2")||e.getExtension("EXT_disjoint_timer_query"),!this.ext){console.warn("EXT_disjoint_timer_query not supported; timestamps will be disabled."),this.trackTimestamp=!1;return}this.queries=[];for(let r=0;r<this.maxQueries;r++)this.queries.push(e.createQuery());this.activeQuery=null,this.queryStates=new Map}allocateQueriesForContext(e){if(!this.trackTimestamp)return null;if(this.currentQueryIndex+2>this.maxQueries)return Ng(`WebGPUTimestampQueryPool [${this.type}]: Maximum number of queries exceeded, when using trackTimestamp it is necessary to resolves the queries via renderer.resolveTimestampsAsync( THREE.TimestampQuery.${this.type.toUpperCase()} ).`),null;const t=this.currentQueryIndex;return this.currentQueryIndex+=2,this.queryStates.set(t,"inactive"),this.queryOffsets.set(e.id,t),t}beginQuery(e){if(!this.trackTimestamp||this.isDisposed)return;const t=this.queryOffsets.get(e.id);if(t==null||this.activeQuery!==null)return;const n=this.queries[t];if(n)try{this.queryStates.get(t)==="inactive"&&(this.gl.beginQuery(this.ext.TIME_ELAPSED_EXT,n),this.activeQuery=t,this.queryStates.set(t,"started"))}catch(r){console.error("Error in beginQuery:",r),this.activeQuery=null,this.queryStates.set(t,"inactive")}}endQuery(e){if(!this.trackTimestamp||this.isDisposed)return;const t=this.queryOffsets.get(e.id);if(t!=null&&this.activeQuery===t)try{this.gl.endQuery(this.ext.TIME_ELAPSED_EXT),this.queryStates.set(t,"ended"),this.activeQuery=null}catch(n){console.error("Error in endQuery:",n),this.queryStates.set(t,"inactive"),this.activeQuery=null}}async resolveQueriesAsync(){if(!this.trackTimestamp||this.pendingResolve)return this.lastValue;this.pendingResolve=!0;try{const e=[];for(const[r,i]of this.queryStates)if(i==="ended"){const a=this.queries[r];e.push(this.resolveQuery(a))}if(e.length===0)return this.lastValue;const n=(await Promise.all(e)).reduce((r,i)=>r+i,0);return this.lastValue=n,this.currentQueryIndex=0,this.queryOffsets.clear(),this.queryStates.clear(),this.activeQuery=null,n}catch(e){return console.error("Error resolving queries:",e),this.lastValue}finally{this.pendingResolve=!1}}async resolveQuery(e){return new Promise(t=>{if(this.isDisposed){t(this.lastValue);return}let n,r=!1;const i=()=>{n&&(clearTimeout(n),n=null)},a=h=>{r||(r=!0,i(),t(h))},c=()=>{if(this.isDisposed){a(this.lastValue);return}try{if(this.gl.getParameter(this.ext.GPU_DISJOINT_EXT)){a(this.lastValue);return}if(!this.gl.getQueryParameter(e,this.gl.QUERY_RESULT_AVAILABLE)){n=setTimeout(c,1);return}const v=this.gl.getQueryParameter(e,this.gl.QUERY_RESULT);t(Number(v)/1e6)}catch(h){console.error("Error checking query:",h),t(this.lastValue)}};c()})}dispose(){if(!this.isDisposed&&(this.isDisposed=!0,!!this.trackTimestamp)){for(const e of this.queries)this.gl.deleteQuery(e);this.queries=[],this.queryStates.clear(),this.queryOffsets.clear(),this.lastValue=0,this.activeQuery=null}}}const Jge=new pi;class e2e extends S5e{constructor(e={}){super(e),this.isWebGLBackend=!0,this.attributeUtils=null,this.extensions=null,this.capabilities=null,this.textureUtils=null,this.bufferRenderer=null,this.gl=null,this.state=null,this.utils=null,this.vaoCache={},this.transformFeedbackCache={},this.discard=!1,this.disjoint=null,this.parallel=null,this._currentContext=null,this._knownBindings=new WeakSet,this._supportsInvalidateFramebuffer=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),this._xrFramebuffer=null}init(e){super.init(e);const t=this.parameters,n={antialias:e.samples>0,alpha:!0,depth:e.depth,stencil:e.stencil},r=t.context!==void 0?t.context:e.domElement.getContext("webgl2",n);function i(a){a.preventDefault();const c={api:"WebGL",message:a.statusMessage||"Unknown reason",reason:null,originalEvent:a};e.onDeviceLost(c)}this._onContextLost=i,e.domElement.addEventListener("webglcontextlost",i,!1),this.gl=r,this.extensions=new YVe(this),this.capabilities=new KVe(this),this.attributeUtils=new WVe(this),this.textureUtils=new XVe(this),this.bufferRenderer=new ZVe(this),this.state=new $Ve(this),this.utils=new qVe(this),this.extensions.get("EXT_color_buffer_float"),this.extensions.get("WEBGL_clip_cull_distance"),this.extensions.get("OES_texture_float_linear"),this.extensions.get("EXT_color_buffer_half_float"),this.extensions.get("WEBGL_multisampled_render_to_texture"),this.extensions.get("WEBGL_render_shared_exponent"),this.extensions.get("WEBGL_multi_draw"),this.extensions.get("OVR_multiview2"),this.disjoint=this.extensions.get("EXT_disjoint_timer_query_webgl2"),this.parallel=this.extensions.get("KHR_parallel_shader_compile")}get coordinateSystem(){return bc}async getArrayBufferAsync(e){return await this.attributeUtils.getArrayBufferAsync(e)}async waitForGPU(){await this.utils._clientWaitAsync()}async makeXRCompatible(){this.gl.getContextAttributes().xrCompatible!==!0&&await this.gl.makeXRCompatible()}setXRTarget(e){this._xrFramebuffer=e}setXRRenderTargetTextures(e,t,n=null){const r=this.gl;if(this.set(e.texture,{textureGPU:t,glInternalFormat:r.RGBA8}),n!==null){const i=e.stencilBuffer?r.DEPTH24_STENCIL8:r.DEPTH_COMPONENT24;this.set(e.depthTexture,{textureGPU:n,glInternalFormat:i}),this.extensions.has("WEBGL_multisampled_render_to_texture")===!0&&e.autoAllocateDepthBuffer===!0&&e.multiview===!1&&console.warn("THREE.WebGLBackend: Render-to-texture extension was disabled because an external texture was provided"),e.autoAllocateDepthBuffer=!1}}initTimestampQuery(e){if(!this.disjoint||!this.trackTimestamp)return;const t=e.isComputeNode?"compute":"render";this.timestampQueryPool[t]||(this.timestampQueryPool[t]=new QVe(this.gl,t,2048));const n=this.timestampQueryPool[t];n.allocateQueriesForContext(e)!==null&&n.beginQuery(e)}prepareTimestampBuffer(e){if(!this.disjoint||!this.trackTimestamp)return;const t=e.isComputeNode?"compute":"render";this.timestampQueryPool[t].endQuery(e)}getContext(){return this.gl}beginRender(e){const{state:t}=this,n=this.get(e);if(e.viewport)this.updateViewport(e);else{const{width:i,height:a}=this.getDrawingBufferSize(Jge);t.viewport(0,0,i,a)}if(e.scissor){const{x:i,y:a,width:c,height:h}=e.scissorValue;t.scissor(i,e.height-h-a,c,h)}this.initTimestampQuery(e),n.previousContext=this._currentContext,this._currentContext=e,this._setFramebuffer(e),this.clear(e.clearColor,e.clearDepth,e.clearStencil,e,!1);const r=e.occlusionQueryCount;r>0&&(n.currentOcclusionQueries=n.occlusionQueries,n.currentOcclusionQueryObjects=n.occlusionQueryObjects,n.lastOcclusionObject=null,n.occlusionQueries=new Array(r),n.occlusionQueryObjects=new Array(r),n.occlusionQueryIndex=0)}finishRender(e){const{gl:t,state:n}=this,r=this.get(e),i=r.previousContext;n.resetVertexState();const a=e.occlusionQueryCount;a>0&&(a>r.occlusionQueryIndex&&t.endQuery(t.ANY_SAMPLES_PASSED),this.resolveOccludedAsync(e));const c=e.textures;if(c!==null)for(let h=0;h<c.length;h++){const p=c[h];p.generateMipmaps&&this.generateMipmaps(p)}if(this._currentContext=i,e.textures!==null&&e.renderTarget){const h=this.get(e.renderTarget),{resolveDepthBuffer:p,samples:v}=e.renderTarget;if(v>0&&this._useMultisampledExtension(e.renderTarget)===!1){const x=h.framebuffers[e.getCacheKey()],S=t.COLOR_BUFFER_BIT,C=h.msaaFrameBuffer,I=e.textures;n.bindFramebuffer(t.READ_FRAMEBUFFER,C),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,x);for(let L=0;L<I.length;L++)if(e.scissor){const{x:U,y:R,width:$,height:Z}=e.scissorValue,k=e.height-Z-R;t.blitFramebuffer(U,k,U+$,k+Z,U,k,U+$,k+Z,S,t.NEAREST),this._supportsInvalidateFramebuffer===!0&&t.invalidateSubFramebuffer(t.READ_FRAMEBUFFER,h.invalidationArray,U,k,$,Z)}else t.blitFramebuffer(0,0,e.width,e.height,0,0,e.width,e.height,S,t.NEAREST),this._supportsInvalidateFramebuffer===!0&&t.invalidateFramebuffer(t.READ_FRAMEBUFFER,h.invalidationArray)}else if(p===!1&&h.framebuffers){const x=h.framebuffers[e.getCacheKey()];n.bindFramebuffer(t.DRAW_FRAMEBUFFER,x),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,h.depthInvalidationArray)}}if(i!==null)if(this._setFramebuffer(i),i.viewport)this.updateViewport(i);else{const{width:h,height:p}=this.getDrawingBufferSize(Jge);n.viewport(0,0,h,p)}this.prepareTimestampBuffer(e)}resolveOccludedAsync(e){const t=this.get(e),{currentOcclusionQueries:n,currentOcclusionQueryObjects:r}=t;if(n&&r){const i=new WeakSet,{gl:a}=this;t.currentOcclusionQueryObjects=null,t.currentOcclusionQueries=null;const c=()=>{let h=0;for(let p=0;p<n.length;p++){const v=n[p];v!==null&&a.getQueryParameter(v,a.QUERY_RESULT_AVAILABLE)&&(a.getQueryParameter(v,a.QUERY_RESULT)===0&&i.add(r[p]),n[p]=null,a.deleteQuery(v),h++)}h<n.length?requestAnimationFrame(c):t.occluded=i};c()}}isOccluded(e,t){const n=this.get(e);return n.occluded&&n.occluded.has(t)}updateViewport(e){const{state:t}=this,{x:n,y:r,width:i,height:a}=e.viewportValue;t.viewport(n,e.height-a-r,i,a)}setScissorTest(e){this.state.setScissorTest(e)}getClearColor(){const e=super.getClearColor();return e.r*=e.a,e.g*=e.a,e.b*=e.a,e}clear(e,t,n,r=null,i=!0){const{gl:a,renderer:c}=this;r===null&&(r={textures:null,clearColorValue:this.getClearColor()});let h=0;if(e&&(h|=a.COLOR_BUFFER_BIT),t&&(h|=a.DEPTH_BUFFER_BIT),n&&(h|=a.STENCIL_BUFFER_BIT),h!==0){let p;r.clearColorValue?p=r.clearColorValue:p=this.getClearColor();const v=c.getClearDepth(),x=c.getClearStencil();if(t&&this.state.setDepthMask(!0),r.textures===null)a.clearColor(p.r,p.g,p.b,p.a),a.clear(h);else{if(i&&this._setFramebuffer(r),e)for(let S=0;S<r.textures.length;S++)S===0?a.clearBufferfv(a.COLOR,S,[p.r,p.g,p.b,p.a]):a.clearBufferfv(a.COLOR,S,[0,0,0,1]);t&&n?a.clearBufferfi(a.DEPTH_STENCIL,0,v,x):t?a.clearBufferfv(a.DEPTH,0,[v]):n&&a.clearBufferiv(a.STENCIL,0,[x])}}}beginCompute(e){const{state:t,gl:n}=this;t.bindFramebuffer(n.FRAMEBUFFER,null),this.initTimestampQuery(e)}compute(e,t,n,r){const{state:i,gl:a}=this;this.discard===!1&&(a.enable(a.RASTERIZER_DISCARD),this.discard=!0);const{programGPU:c,transformBuffers:h,attributes:p}=this.get(r),v=this._getVaoKey(p),x=this.vaoCache[v];x===void 0?this._createVao(p):i.setVertexState(x),i.useProgram(c),this._bindUniforms(n);const S=this._getTransformFeedback(h);a.bindTransformFeedback(a.TRANSFORM_FEEDBACK,S),a.beginTransformFeedback(a.POINTS),p[0].isStorageInstancedBufferAttribute?a.drawArraysInstanced(a.POINTS,0,1,t.count):a.drawArrays(a.POINTS,0,t.count),a.endTransformFeedback(),a.bindTransformFeedback(a.TRANSFORM_FEEDBACK,null);for(let C=0;C<h.length;C++){const I=h[C];I.pbo&&this.textureUtils.copyBufferToTexture(I.transformBuffer,I.pbo),I.switchBuffers()}}finishCompute(e){const t=this.gl;this.discard=!1,t.disable(t.RASTERIZER_DISCARD),this.prepareTimestampBuffer(e),this._currentContext&&this._setFramebuffer(this._currentContext)}_isRenderCameraDepthArray(e){return e.depthTexture&&e.depthTexture.isArrayTexture&&e.camera.isArrayCamera}draw(e){const{object:t,pipeline:n,material:r,context:i,hardwareClippingPlanes:a}=e,{programGPU:c}=this.get(n),{gl:h,state:p}=this,v=this.get(i),x=e.getDrawParameters();if(x===null)return;this._bindUniforms(e.getBindings());const S=t.isMesh&&t.matrixWorld.determinant()<0;p.setMaterial(r,S,a),p.useProgram(c);const C=this.get(e);let I=C.staticVao;if(I===void 0||C.geometryId!==e.geometry.id){const ce=this._getVaoKey(e.getAttributes());if(I=this.vaoCache[ce],I===void 0){let Q;({vaoGPU:I,staticVao:Q}=this._createVao(e.getAttributes())),Q&&(C.staticVao=I,C.geometryId=e.geometry.id)}}const L=e.getIndex(),U=L!==null?this.get(L).bufferGPU:null;p.setVertexState(I,U);const R=v.lastOcclusionObject;if(R!==t&&R!==void 0){if(R!==null&&R.occlusionTest===!0&&(h.endQuery(h.ANY_SAMPLES_PASSED),v.occlusionQueryIndex++),t.occlusionTest===!0){const ce=h.createQuery();h.beginQuery(h.ANY_SAMPLES_PASSED,ce),v.occlusionQueries[v.occlusionQueryIndex]=ce,v.occlusionQueryObjects[v.occlusionQueryIndex]=t}v.lastOcclusionObject=t}const $=this.bufferRenderer;t.isPoints?$.mode=h.POINTS:t.isLineSegments?$.mode=h.LINES:t.isLine?$.mode=h.LINE_STRIP:t.isLineLoop?$.mode=h.LINE_LOOP:r.wireframe===!0?(p.setLineWidth(r.wireframeLinewidth*this.renderer.getPixelRatio()),$.mode=h.LINES):$.mode=h.TRIANGLES;const{vertexCount:Z,instanceCount:k}=x;let{firstVertex:ie}=x;if($.object=t,L!==null){ie*=L.array.BYTES_PER_ELEMENT;const ce=this.get(L);$.index=L.count,$.type=ce.type}else $.index=0;const ue=()=>{t.isBatchedMesh?t._multiDrawInstances!==null?(Ng("THREE.WebGLBackend: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),$.renderMultiDrawInstances(t._multiDrawStarts,t._multiDrawCounts,t._multiDrawCount,t._multiDrawInstances)):this.hasFeature("WEBGL_multi_draw")?$.renderMultiDraw(t._multiDrawStarts,t._multiDrawCounts,t._multiDrawCount):Ng("THREE.WebGLRenderer: WEBGL_multi_draw not supported."):k>1?$.renderInstances(ie,Z,k):$.render(ie,Z)};if(e.camera.isArrayCamera===!0&&e.camera.cameras.length>0&&e.camera.isMultiViewCamera===!1){const ce=this.get(e.camera),Q=e.camera.cameras,ae=e.getBindingGroup("cameraIndex").bindings[0];if(ce.indexesGPU===void 0||ce.indexesGPU.length!==Q.length){const at=new Uint32Array([0,0,0,0]),Se=[];for(let gt=0,Ae=Q.length;gt<Ae;gt++){const lt=h.createBuffer();at[0]=gt,h.bindBuffer(h.UNIFORM_BUFFER,lt),h.bufferData(h.UNIFORM_BUFFER,at,h.STATIC_DRAW),Se.push(lt)}ce.indexesGPU=Se}const le=this.get(ae),J=this.renderer.getPixelRatio(),Ue=this._currentContext.renderTarget,je=this._isRenderCameraDepthArray(this._currentContext),rt=this._currentContext.activeCubeFace;if(je){const at=this.get(Ue.depthTexture);if(at.clearedRenderId!==this.renderer._nodes.nodeFrame.renderId){at.clearedRenderId=this.renderer._nodes.nodeFrame.renderId;const{stencilBuffer:Se}=Ue;for(let gt=0,Ae=Q.length;gt<Ae;gt++)this.renderer._activeCubeFace=gt,this._currentContext.activeCubeFace=gt,this._setFramebuffer(this._currentContext),this.clear(!1,!0,Se,this._currentContext,!1);this.renderer._activeCubeFace=rt,this._currentContext.activeCubeFace=rt}}for(let at=0,Se=Q.length;at<Se;at++){const gt=Q[at];if(t.layers.test(gt.layers)){je&&(this.renderer._activeCubeFace=at,this._currentContext.activeCubeFace=at,this._setFramebuffer(this._currentContext));const Ae=gt.viewport;if(Ae!==void 0){const lt=Ae.x*J,pt=Ae.y*J,De=Ae.width*J,_t=Ae.height*J;p.viewport(Math.floor(lt),Math.floor(e.context.height-_t-pt),Math.floor(De),Math.floor(_t))}p.bindBufferBase(h.UNIFORM_BUFFER,le.index,ce.indexesGPU[at]),ue()}this._currentContext.activeCubeFace=rt,this.renderer._activeCubeFace=rt}}else ue()}needsRenderUpdate(){return!1}getRenderCacheKey(){return""}createDefaultTexture(e){this.textureUtils.createDefaultTexture(e)}createTexture(e,t){this.textureUtils.createTexture(e,t)}updateTexture(e,t){this.textureUtils.updateTexture(e,t)}generateMipmaps(e){this.textureUtils.generateMipmaps(e)}destroyTexture(e){this.textureUtils.destroyTexture(e)}async copyTextureToBuffer(e,t,n,r,i,a){return this.textureUtils.copyTextureToBuffer(e,t,n,r,i,a)}createSampler(){}destroySampler(){}createNodeBuilder(e,t){return new GVe(e,t)}createProgram(e){const t=this.gl,{stage:n,code:r}=e,i=n==="fragment"?t.createShader(t.FRAGMENT_SHADER):t.createShader(t.VERTEX_SHADER);t.shaderSource(i,r),t.compileShader(i),this.set(e,{shaderGPU:i})}destroyProgram(e){this.delete(e)}createRenderPipeline(e,t){const n=this.gl,r=e.pipeline,{fragmentProgram:i,vertexProgram:a}=r,c=n.createProgram(),h=this.get(i).shaderGPU,p=this.get(a).shaderGPU;if(n.attachShader(c,h),n.attachShader(c,p),n.linkProgram(c),this.set(r,{programGPU:c,fragmentShader:h,vertexShader:p}),t!==null&&this.parallel){const v=new Promise(x=>{const S=this.parallel,C=()=>{n.getProgramParameter(c,S.COMPLETION_STATUS_KHR)?(this._completeCompile(e,r),x()):requestAnimationFrame(C)};C()});t.push(v);return}this._completeCompile(e,r)}_handleSource(e,t){const n=e.split(`
`),r=[],i=Math.max(t-6,0),a=Math.min(t+6,n.length);for(let c=i;c<a;c++){const h=c+1;r.push(`${h===t?">":" "} ${h}: ${n[c]}`)}return r.join(`
`)}_getShaderErrors(e,t,n){const r=e.getShaderParameter(t,e.COMPILE_STATUS),i=e.getShaderInfoLog(t).trim();if(r&&i==="")return"";const a=/ERROR: 0:(\d+)/.exec(i);if(a){const c=parseInt(a[1]);return n.toUpperCase()+`

`+i+`

`+this._handleSource(e.getShaderSource(t),c)}else return i}_logProgramError(e,t,n){if(this.renderer.debug.checkShaderErrors){const r=this.gl,i=r.getProgramInfoLog(e).trim();if(r.getProgramParameter(e,r.LINK_STATUS)===!1)if(typeof this.renderer.debug.onShaderError=="function")this.renderer.debug.onShaderError(r,e,n,t);else{const a=this._getShaderErrors(r,n,"vertex"),c=this._getShaderErrors(r,t,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(e,r.VALIDATE_STATUS)+`

Program Info Log: `+i+`
`+a+`
`+c)}else i!==""&&console.warn("THREE.WebGLProgram: Program Info Log:",i)}}_completeCompile(e,t){const{state:n,gl:r}=this,i=this.get(t),{programGPU:a,fragmentShader:c,vertexShader:h}=i;r.getProgramParameter(a,r.LINK_STATUS)===!1&&this._logProgramError(a,c,h),n.useProgram(a);const p=e.getBindings();this._setupBindings(p,a),this.set(t,{programGPU:a})}createComputePipeline(e,t){const{state:n,gl:r}=this,i={stage:"fragment",code:`#version 300 es
precision highp float;
void main() {}`};this.createProgram(i);const{computeProgram:a}=e,c=r.createProgram(),h=this.get(i).shaderGPU,p=this.get(a).shaderGPU,v=a.transforms,x=[],S=[];for(let U=0;U<v.length;U++){const R=v[U];x.push(R.varyingName),S.push(R.attributeNode)}r.attachShader(c,h),r.attachShader(c,p),r.transformFeedbackVaryings(c,x,r.SEPARATE_ATTRIBS),r.linkProgram(c),r.getProgramParameter(c,r.LINK_STATUS)===!1&&this._logProgramError(c,h,p),n.useProgram(c),this._setupBindings(t,c);const C=a.attributes,I=[],L=[];for(let U=0;U<C.length;U++){const R=C[U].node.attribute;I.push(R),this.has(R)||this.attributeUtils.createAttribute(R,r.ARRAY_BUFFER)}for(let U=0;U<S.length;U++){const R=S[U].attribute;this.has(R)||this.attributeUtils.createAttribute(R,r.ARRAY_BUFFER);const $=this.get(R);L.push($)}this.set(e,{programGPU:c,transformBuffers:L,attributes:I})}createBindings(e,t){if(this._knownBindings.has(t)===!1){this._knownBindings.add(t);let n=0,r=0;for(const i of t){this.set(i,{textures:r,uniformBuffers:n});for(const a of i.bindings)a.isUniformBuffer&&n++,a.isSampledTexture&&r++}}this.updateBindings(e,t)}updateBindings(e){const{gl:t}=this,n=this.get(e);let r=n.uniformBuffers,i=n.textures;for(const a of e.bindings)if(a.isUniformsGroup||a.isUniformBuffer){const c=a.buffer,h=t.createBuffer();t.bindBuffer(t.UNIFORM_BUFFER,h),t.bufferData(t.UNIFORM_BUFFER,c,t.DYNAMIC_DRAW),this.set(a,{index:r++,bufferGPU:h})}else if(a.isSampledTexture){const{textureGPU:c,glTextureType:h}=this.get(a.texture);this.set(a,{index:i++,textureGPU:c,glTextureType:h})}}updateBinding(e){const t=this.gl;if(e.isUniformsGroup||e.isUniformBuffer){const r=this.get(e).bufferGPU,i=e.buffer;t.bindBuffer(t.UNIFORM_BUFFER,r),t.bufferData(t.UNIFORM_BUFFER,i,t.DYNAMIC_DRAW)}}createIndexAttribute(e){const t=this.gl;this.attributeUtils.createAttribute(e,t.ELEMENT_ARRAY_BUFFER)}createAttribute(e){if(this.has(e))return;const t=this.gl;this.attributeUtils.createAttribute(e,t.ARRAY_BUFFER)}createStorageAttribute(e){if(this.has(e))return;const t=this.gl;this.attributeUtils.createAttribute(e,t.ARRAY_BUFFER)}updateAttribute(e){this.attributeUtils.updateAttribute(e)}destroyAttribute(e){this.attributeUtils.destroyAttribute(e)}hasFeature(e){const t=Object.keys(Qge).filter(r=>Qge[r]===e),n=this.extensions;for(let r=0;r<t.length;r++)if(n.has(t[r]))return!0;return!1}getMaxAnisotropy(){return this.capabilities.getMaxAnisotropy()}copyTextureToTexture(e,t,n=null,r=null,i=0,a=0){this.textureUtils.copyTextureToTexture(e,t,n,r,i,a)}copyFramebufferToTexture(e,t,n){this.textureUtils.copyFramebufferToTexture(e,t,n)}_setFramebuffer(e){const{gl:t,state:n}=this;let r=null;if(e.textures!==null){const i=e.renderTarget,a=this.get(i),{samples:c,depthBuffer:h,stencilBuffer:p}=i,v=i.isWebGLCubeRenderTarget===!0,x=i.isRenderTarget3D===!0,S=i.depth>1,C=i.isXRRenderTarget===!0,I=C===!0&&i.hasExternalTextures===!0;let L=a.msaaFrameBuffer,U=a.depthRenderbuffer;const R=this.extensions.get("WEBGL_multisampled_render_to_texture"),$=this.extensions.get("OVR_multiview2"),Z=this._useMultisampledExtension(i),k=z3e(e);let ie;if(v?(a.cubeFramebuffers||(a.cubeFramebuffers={}),ie=a.cubeFramebuffers[k]):C&&I===!1?ie=this._xrFramebuffer:(a.framebuffers||(a.framebuffers={}),ie=a.framebuffers[k]),ie===void 0){ie=t.createFramebuffer(),n.bindFramebuffer(t.FRAMEBUFFER,ie);const ue=e.textures,ce=[];if(v){a.cubeFramebuffers[k]=ie;const{textureGPU:ae}=this.get(ue[0]),le=this.renderer._activeCubeFace;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+le,ae,0)}else{a.framebuffers[k]=ie;for(let ae=0;ae<ue.length;ae++){const le=ue[ae],J=this.get(le);J.renderTarget=e.renderTarget,J.cacheKey=k;const Ue=t.COLOR_ATTACHMENT0+ae;if(i.multiview)$.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,Ue,J.textureGPU,0,c,0,2);else if(x||S){const je=this.renderer._activeCubeFace;t.framebufferTextureLayer(t.FRAMEBUFFER,Ue,J.textureGPU,0,je)}else Z?R.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,Ue,t.TEXTURE_2D,J.textureGPU,0,c):t.framebufferTexture2D(t.FRAMEBUFFER,Ue,t.TEXTURE_2D,J.textureGPU,0)}n.drawBuffers(e,ie)}const Q=p?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;if(i.autoAllocateDepthBuffer===!0){const ae=t.createRenderbuffer();this.textureUtils.setupRenderBufferStorage(ae,e,0,Z),a.xrDepthRenderbuffer=ae,ce.push(p?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT),t.bindRenderbuffer(t.RENDERBUFFER,ae),t.framebufferRenderbuffer(t.FRAMEBUFFER,Q,t.RENDERBUFFER,ae)}else if(e.depthTexture!==null){ce.push(p?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT);const ae=this.get(e.depthTexture);if(ae.renderTarget=e.renderTarget,ae.cacheKey=k,i.multiview)$.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,Q,ae.textureGPU,0,c,0,2);else if(I&&Z)R.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,Q,t.TEXTURE_2D,ae.textureGPU,0,c);else if(e.depthTexture.isArrayTexture){const le=this.renderer._activeCubeFace;t.framebufferTextureLayer(t.FRAMEBUFFER,Q,ae.textureGPU,0,le)}else t.framebufferTexture2D(t.FRAMEBUFFER,Q,t.TEXTURE_2D,ae.textureGPU,0)}a.depthInvalidationArray=ce}else{if(this._isRenderCameraDepthArray(e)){n.bindFramebuffer(t.FRAMEBUFFER,ie);const ce=this.renderer._activeCubeFace,Q=this.get(e.depthTexture),ae=p?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;t.framebufferTextureLayer(t.FRAMEBUFFER,ae,Q.textureGPU,0,ce)}if(C||Z||i.multiview){n.bindFramebuffer(t.FRAMEBUFFER,ie);const ce=this.get(e.textures[0]);i.multiview?$.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,ce.textureGPU,0,c,0,2):Z?R.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,ce.textureGPU,0,c):t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,ce.textureGPU,0);const Q=p?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;if(i.autoAllocateDepthBuffer===!0){const ae=a.xrDepthRenderbuffer;t.bindRenderbuffer(t.RENDERBUFFER,ae),t.framebufferRenderbuffer(t.FRAMEBUFFER,Q,t.RENDERBUFFER,ae)}else{const ae=this.get(e.depthTexture);i.multiview?$.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,Q,ae.textureGPU,0,c,0,2):Z?R.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,Q,t.TEXTURE_2D,ae.textureGPU,0,c):t.framebufferTexture2D(t.FRAMEBUFFER,Q,t.TEXTURE_2D,ae.textureGPU,0)}}}if(c>0&&Z===!1&&!i.multiview){if(L===void 0){const ue=[];L=t.createFramebuffer(),n.bindFramebuffer(t.FRAMEBUFFER,L);const ce=[],Q=e.textures;for(let ae=0;ae<Q.length;ae++){if(ce[ae]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,ce[ae]),ue.push(t.COLOR_ATTACHMENT0+ae),h){const Ue=p?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;ue.push(Ue)}const le=e.textures[ae],J=this.get(le);t.renderbufferStorageMultisample(t.RENDERBUFFER,c,J.glInternalFormat,e.width,e.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+ae,t.RENDERBUFFER,ce[ae])}if(a.msaaFrameBuffer=L,a.msaaRenderbuffers=ce,U===void 0){U=t.createRenderbuffer(),this.textureUtils.setupRenderBufferStorage(U,e,c),a.depthRenderbuffer=U;const ae=p?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;ue.push(ae)}a.invalidationArray=ue}r=a.msaaFrameBuffer}else r=ie}n.bindFramebuffer(t.FRAMEBUFFER,r)}_getVaoKey(e){let t="";for(let n=0;n<e.length;n++){const r=this.get(e[n]);t+=":"+r.id}return t}_createVao(e){const{gl:t}=this,n=t.createVertexArray();let r="",i=!0;t.bindVertexArray(n);for(let a=0;a<e.length;a++){const c=e[a],h=this.get(c);r+=":"+h.id,t.bindBuffer(t.ARRAY_BUFFER,h.bufferGPU),t.enableVertexAttribArray(a),(c.isStorageBufferAttribute||c.isStorageInstancedBufferAttribute)&&(i=!1);let p,v;c.isInterleavedBufferAttribute===!0?(p=c.data.stride*h.bytesPerElement,v=c.offset*h.bytesPerElement):(p=0,v=0),h.isInteger?t.vertexAttribIPointer(a,c.itemSize,h.type,p,v):t.vertexAttribPointer(a,c.itemSize,h.type,c.normalized,p,v),c.isInstancedBufferAttribute&&!c.isInterleavedBufferAttribute?t.vertexAttribDivisor(a,c.meshPerAttribute):c.isInterleavedBufferAttribute&&c.data.isInstancedInterleavedBuffer&&t.vertexAttribDivisor(a,c.data.meshPerAttribute)}return t.bindBuffer(t.ARRAY_BUFFER,null),this.vaoCache[r]=n,{vaoGPU:n,staticVao:i}}_getTransformFeedback(e){let t="";for(let i=0;i<e.length;i++)t+=":"+e[i].id;let n=this.transformFeedbackCache[t];if(n!==void 0)return n;const{gl:r}=this;n=r.createTransformFeedback(),r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,n);for(let i=0;i<e.length;i++){const a=e[i];r.bindBufferBase(r.TRANSFORM_FEEDBACK_BUFFER,i,a.transformBuffer)}return r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,null),this.transformFeedbackCache[t]=n,n}_setupBindings(e,t){const n=this.gl;for(const r of e)for(const i of r.bindings){const c=this.get(i).index;if(i.isUniformsGroup||i.isUniformBuffer){const h=n.getUniformBlockIndex(t,i.name);n.uniformBlockBinding(t,h,c)}else if(i.isSampledTexture){const h=n.getUniformLocation(t,i.name);n.uniform1i(h,c)}}}_bindUniforms(e){const{gl:t,state:n}=this;for(const r of e)for(const i of r.bindings){const a=this.get(i),c=a.index;i.isUniformsGroup||i.isUniformBuffer?n.bindBufferBase(t.UNIFORM_BUFFER,c,a.bufferGPU):i.isSampledTexture&&n.bindTexture(a.glTextureType,a.textureGPU,t.TEXTURE0+c)}}_useMultisampledExtension(e){return e.multiview===!0?!0:e.samples>0&&this.extensions.has("WEBGL_multisampled_render_to_texture")===!0&&e.autoAllocateDepthBuffer!==!1}dispose(){const e=this.extensions.get("WEBGL_lose_context");e&&e.loseContext(),this.renderer.domElement.removeEventListener("webglcontextlost",this._onContextLost)}}const y_={PointList:"point-list",LineList:"line-list",LineStrip:"line-strip",TriangleList:"triangle-list",TriangleStrip:"triangle-strip"},o0={Never:"never",Less:"less",Equal:"equal",LessEqual:"less-equal",Greater:"greater",NotEqual:"not-equal",GreaterEqual:"greater-equal",Always:"always"},Cl={Store:"store"},Zi={Load:"load",Clear:"clear"},KV={CCW:"ccw"},ZV={None:"none",Front:"front",Back:"back"},q_={Uint16:"uint16",Uint32:"uint32"},Ke={R8Unorm:"r8unorm",R8Snorm:"r8snorm",R8Uint:"r8uint",R8Sint:"r8sint",R16Uint:"r16uint",R16Sint:"r16sint",R16Float:"r16float",RG8Unorm:"rg8unorm",RG8Snorm:"rg8snorm",RG8Uint:"rg8uint",RG8Sint:"rg8sint",R32Uint:"r32uint",R32Sint:"r32sint",R32Float:"r32float",RG16Uint:"rg16uint",RG16Sint:"rg16sint",RG16Float:"rg16float",RGBA8Unorm:"rgba8unorm",RGBA8UnormSRGB:"rgba8unorm-srgb",RGBA8Snorm:"rgba8snorm",RGBA8Uint:"rgba8uint",RGBA8Sint:"rgba8sint",BGRA8Unorm:"bgra8unorm",BGRA8UnormSRGB:"bgra8unorm-srgb",RGB9E5UFloat:"rgb9e5ufloat",RGB10A2Unorm:"rgb10a2unorm",RG11B10UFloat:"rgb10a2unorm",RG32Uint:"rg32uint",RG32Sint:"rg32sint",RG32Float:"rg32float",RGBA16Uint:"rgba16uint",RGBA16Sint:"rgba16sint",RGBA16Float:"rgba16float",RGBA32Uint:"rgba32uint",RGBA32Sint:"rgba32sint",RGBA32Float:"rgba32float",Depth16Unorm:"depth16unorm",Depth24Plus:"depth24plus",Depth24PlusStencil8:"depth24plus-stencil8",Depth32Float:"depth32float",Depth32FloatStencil8:"depth32float-stencil8",BC1RGBAUnorm:"bc1-rgba-unorm",BC1RGBAUnormSRGB:"bc1-rgba-unorm-srgb",BC2RGBAUnorm:"bc2-rgba-unorm",BC2RGBAUnormSRGB:"bc2-rgba-unorm-srgb",BC3RGBAUnorm:"bc3-rgba-unorm",BC3RGBAUnormSRGB:"bc3-rgba-unorm-srgb",BC4RUnorm:"bc4-r-unorm",BC4RSnorm:"bc4-r-snorm",BC5RGUnorm:"bc5-rg-unorm",BC5RGSnorm:"bc5-rg-snorm",BC6HRGBUFloat:"bc6h-rgb-ufloat",BC6HRGBFloat:"bc6h-rgb-float",BC7RGBAUnorm:"bc7-rgba-unorm",BC7RGBAUnormSRGB:"bc7-rgba-srgb",ETC2RGB8Unorm:"etc2-rgb8unorm",ETC2RGB8UnormSRGB:"etc2-rgb8unorm-srgb",ETC2RGB8A1Unorm:"etc2-rgb8a1unorm",ETC2RGB8A1UnormSRGB:"etc2-rgb8a1unorm-srgb",ETC2RGBA8Unorm:"etc2-rgba8unorm",ETC2RGBA8UnormSRGB:"etc2-rgba8unorm-srgb",EACR11Unorm:"eac-r11unorm",EACR11Snorm:"eac-r11snorm",EACRG11Unorm:"eac-rg11unorm",EACRG11Snorm:"eac-rg11snorm",ASTC4x4Unorm:"astc-4x4-unorm",ASTC4x4UnormSRGB:"astc-4x4-unorm-srgb",ASTC5x4Unorm:"astc-5x4-unorm",ASTC5x4UnormSRGB:"astc-5x4-unorm-srgb",ASTC5x5Unorm:"astc-5x5-unorm",ASTC5x5UnormSRGB:"astc-5x5-unorm-srgb",ASTC6x5Unorm:"astc-6x5-unorm",ASTC6x5UnormSRGB:"astc-6x5-unorm-srgb",ASTC6x6Unorm:"astc-6x6-unorm",ASTC6x6UnormSRGB:"astc-6x6-unorm-srgb",ASTC8x5Unorm:"astc-8x5-unorm",ASTC8x5UnormSRGB:"astc-8x5-unorm-srgb",ASTC8x6Unorm:"astc-8x6-unorm",ASTC8x6UnormSRGB:"astc-8x6-unorm-srgb",ASTC8x8Unorm:"astc-8x8-unorm",ASTC8x8UnormSRGB:"astc-8x8-unorm-srgb",ASTC10x5Unorm:"astc-10x5-unorm",ASTC10x5UnormSRGB:"astc-10x5-unorm-srgb",ASTC10x6Unorm:"astc-10x6-unorm",ASTC10x6UnormSRGB:"astc-10x6-unorm-srgb",ASTC10x8Unorm:"astc-10x8-unorm",ASTC10x8UnormSRGB:"astc-10x8-unorm-srgb",ASTC10x10Unorm:"astc-10x10-unorm",ASTC10x10UnormSRGB:"astc-10x10-unorm-srgb",ASTC12x10Unorm:"astc-12x10-unorm",ASTC12x10UnormSRGB:"astc-12x10-unorm-srgb",ASTC12x12Unorm:"astc-12x12-unorm",ASTC12x12UnormSRGB:"astc-12x12-unorm-srgb"},QV={ClampToEdge:"clamp-to-edge",Repeat:"repeat",MirrorRepeat:"mirror-repeat"},c6={Linear:"linear",Nearest:"nearest"},Jr={Zero:"zero",One:"one",Src:"src",OneMinusSrc:"one-minus-src",SrcAlpha:"src-alpha",OneMinusSrcAlpha:"one-minus-src-alpha",Dst:"dst",OneMinusDst:"one-minus-dst",DstAlpha:"dst-alpha",OneMinusDstAlpha:"one-minus-dst-alpha",SrcAlphaSaturated:"src-alpha-saturated",Constant:"constant",OneMinusConstant:"one-minus-constant"},W8={Add:"add",Subtract:"subtract",ReverseSubtract:"reverse-subtract",Min:"min",Max:"max"},t2e={None:0,All:15},N3={Keep:"keep",Zero:"zero",Replace:"replace",Invert:"invert",IncrementClamp:"increment-clamp",DecrementClamp:"decrement-clamp",IncrementWrap:"increment-wrap",DecrementWrap:"decrement-wrap"},JV={Storage:"storage",ReadOnlyStorage:"read-only-storage"},eG={WriteOnly:"write-only",ReadOnly:"read-only",ReadWrite:"read-write"},n2e={NonFiltering:"non-filtering",Comparison:"comparison"},$8={Float:"float",UnfilterableFloat:"unfilterable-float",Depth:"depth",SInt:"sint",UInt:"uint"},r2e={TwoD:"2d",ThreeD:"3d"},Fa={TwoD:"2d",TwoDArray:"2d-array",Cube:"cube",ThreeD:"3d"},JVe={All:"all"},nk={Vertex:"vertex",Instance:"instance"},Jj={DepthClipControl:"depth-clip-control",Depth32FloatStencil8:"depth32float-stencil8",TextureCompressionBC:"texture-compression-bc",TextureCompressionETC2:"texture-compression-etc2",TextureCompressionASTC:"texture-compression-astc",TimestampQuery:"timestamp-query",IndirectFirstInstance:"indirect-first-instance",ShaderF16:"shader-f16",RG11B10UFloat:"rg11b10ufloat-renderable",BGRA8UNormStorage:"bgra8unorm-storage",Float32Filterable:"float32-filterable",ClipDistances:"clip-distances",DualSourceBlending:"dual-source-blending",Subgroups:"subgroups"};class eGe extends $W{constructor(e,t){super(e),this.texture=t,this.version=t?t.version:0,this.isSampler=!0}}class tGe extends eGe{constructor(e,t,n){super(e,t?t.value:null),this.textureNode=t,this.groupNode=n}update(){this.texture=this.textureNode.value}}class nGe extends g5e{constructor(e,t){super(e,t?t.array:null),this.attribute=t,this.isStorageBuffer=!0}}let rGe=0;class iGe extends nGe{constructor(e,t){super("StorageBuffer_"+rGe++,e?e.value:null),this.nodeUniform=e,this.access=e?e.access:_g.READ_WRITE,this.groupNode=t}get buffer(){return this.nodeUniform.value}}class sGe extends t4{constructor(e){super(),this.device=e;const t=`
struct VarysStruct {
	@builtin( position ) Position: vec4<f32>,
	@location( 0 ) vTex : vec2<f32>
};

@vertex
fn main( @builtin( vertex_index ) vertexIndex : u32 ) -> VarysStruct {

	var Varys : VarysStruct;

	var pos = array< vec2<f32>, 4 >(
		vec2<f32>( -1.0,  1.0 ),
		vec2<f32>(  1.0,  1.0 ),
		vec2<f32>( -1.0, -1.0 ),
		vec2<f32>(  1.0, -1.0 )
	);

	var tex = array< vec2<f32>, 4 >(
		vec2<f32>( 0.0, 0.0 ),
		vec2<f32>( 1.0, 0.0 ),
		vec2<f32>( 0.0, 1.0 ),
		vec2<f32>( 1.0, 1.0 )
	);

	Varys.vTex = tex[ vertexIndex ];
	Varys.Position = vec4<f32>( pos[ vertexIndex ], 0.0, 1.0 );

	return Varys;

}
`,n=`
@group( 0 ) @binding( 0 )
var imgSampler : sampler;

@group( 0 ) @binding( 1 )
var img : texture_2d<f32>;

@fragment
fn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {

	return textureSample( img, imgSampler, vTex );

}
`,r=`
@group( 0 ) @binding( 0 )
var imgSampler : sampler;

@group( 0 ) @binding( 1 )
var img : texture_2d<f32>;

@fragment
fn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {

	return textureSample( img, imgSampler, vec2( vTex.x, 1.0 - vTex.y ) );

}
`;this.mipmapSampler=e.createSampler({minFilter:c6.Linear}),this.flipYSampler=e.createSampler({minFilter:c6.Nearest}),this.transferPipelines={},this.flipYPipelines={},this.mipmapVertexShaderModule=e.createShaderModule({label:"mipmapVertex",code:t}),this.mipmapFragmentShaderModule=e.createShaderModule({label:"mipmapFragment",code:n}),this.flipYFragmentShaderModule=e.createShaderModule({label:"flipYFragment",code:r})}getTransferPipeline(e){let t=this.transferPipelines[e];return t===void 0&&(t=this.device.createRenderPipeline({label:`mipmap-${e}`,vertex:{module:this.mipmapVertexShaderModule,entryPoint:"main"},fragment:{module:this.mipmapFragmentShaderModule,entryPoint:"main",targets:[{format:e}]},primitive:{topology:y_.TriangleStrip,stripIndexFormat:q_.Uint32},layout:"auto"}),this.transferPipelines[e]=t),t}getFlipYPipeline(e){let t=this.flipYPipelines[e];return t===void 0&&(t=this.device.createRenderPipeline({label:`flipY-${e}`,vertex:{module:this.mipmapVertexShaderModule,entryPoint:"main"},fragment:{module:this.flipYFragmentShaderModule,entryPoint:"main",targets:[{format:e}]},primitive:{topology:y_.TriangleStrip,stripIndexFormat:q_.Uint32},layout:"auto"}),this.flipYPipelines[e]=t),t}flipY(e,t,n=0){const r=t.format,{width:i,height:a}=t.size,c=this.getTransferPipeline(r),h=this.getFlipYPipeline(r),p=this.device.createTexture({size:{width:i,height:a,depthOrArrayLayers:1},format:r,usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING}),v=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:Fa.TwoD,baseArrayLayer:n}),x=p.createView({baseMipLevel:0,mipLevelCount:1,dimension:Fa.TwoD,baseArrayLayer:0}),S=this.device.createCommandEncoder({}),C=(I,L,U)=>{const R=I.getBindGroupLayout(0),$=this.device.createBindGroup({layout:R,entries:[{binding:0,resource:this.flipYSampler},{binding:1,resource:L}]}),Z=S.beginRenderPass({colorAttachments:[{view:U,loadOp:Zi.Clear,storeOp:Cl.Store,clearValue:[0,0,0,0]}]});Z.setPipeline(I),Z.setBindGroup(0,$),Z.draw(4,1,0,0),Z.end()};C(c,v,x),C(h,x,v),this.device.queue.submit([S.finish()]),p.destroy()}generateMipmaps(e,t,n=0){const r=this.get(e);r.useCount===void 0&&(r.useCount=0,r.layers=[]);const i=r.layers[n]||this._mipmapCreateBundles(e,t,n),a=this.device.createCommandEncoder({});this._mipmapRunBundles(a,i),this.device.queue.submit([a.finish()]),r.useCount!==0&&(r.layers[n]=i),r.useCount++}_mipmapCreateBundles(e,t,n){const r=this.getTransferPipeline(t.format),i=r.getBindGroupLayout(0);let a=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:Fa.TwoD,baseArrayLayer:n});const c=[];for(let h=1;h<t.mipLevelCount;h++){const p=this.device.createBindGroup({layout:i,entries:[{binding:0,resource:this.mipmapSampler},{binding:1,resource:a}]}),v=e.createView({baseMipLevel:h,mipLevelCount:1,dimension:Fa.TwoD,baseArrayLayer:n}),x={colorAttachments:[{view:v,loadOp:Zi.Clear,storeOp:Cl.Store,clearValue:[0,0,0,0]}]},S=this.device.createRenderBundleEncoder({colorFormats:[t.format]});S.setPipeline(r),S.setBindGroup(0,p),S.draw(4,1,0,0),c.push({renderBundles:[S.finish()],passDescriptor:x}),a=v}return c}_mipmapRunBundles(e,t){const n=t.length;for(let r=0;r<n;r++){const i=t[r],a=e.beginRenderPass(i.passDescriptor);a.executeBundles(i.renderBundles),a.end()}}}const oGe={[w3e]:"never",[rW]:"less",[E3e]:"equal",[T3e]:"less-equal",[M3e]:"greater",[A3e]:"greater-equal",[P3e]:"always",[C3e]:"not-equal"},aGe=[0,1,3,2,4,5];class lGe{constructor(e){this.backend=e,this._passUtils=null,this.defaultTexture={},this.defaultCubeTexture={},this.defaultVideoFrame=null,this.colorBuffer=null,this.depthTexture=new t1,this.depthTexture.name="depthBuffer"}createSampler(e){const t=this.backend,n=t.device,r=t.get(e),i={addressModeU:this._convertAddressMode(e.wrapS),addressModeV:this._convertAddressMode(e.wrapT),addressModeW:this._convertAddressMode(e.wrapR),magFilter:this._convertFilterMode(e.magFilter),minFilter:this._convertFilterMode(e.minFilter),mipmapFilter:this._convertFilterMode(e.minFilter),maxAnisotropy:1};i.magFilter===c6.Linear&&i.minFilter===c6.Linear&&i.mipmapFilter===c6.Linear&&(i.maxAnisotropy=e.anisotropy),e.isDepthTexture&&e.compareFunction!==null&&(i.compare=oGe[e.compareFunction]),r.sampler=n.createSampler(i)}createDefaultTexture(e){let t;const n=eH(e);e.isCubeTexture?t=this._getDefaultCubeTextureGPU(n):e.isVideoTexture?this.backend.get(e).externalTexture=this._getDefaultVideoFrame():t=this._getDefaultTextureGPU(n),this.backend.get(e).texture=t}createTexture(e,t={}){const n=this.backend,r=n.get(e);if(r.initialized)throw new Error("WebGPUTextureUtils: Texture already initialized.");t.needsMipmaps===void 0&&(t.needsMipmaps=!1),t.levels===void 0&&(t.levels=1),t.depth===void 0&&(t.depth=1);const{width:i,height:a,depth:c,levels:h}=t;e.isFramebufferTexture&&(t.renderTarget?t.format=this.backend.utils.getCurrentColorFormat(t.renderTarget):t.format=this.backend.utils.getPreferredCanvasFormat());const p=this._getDimension(e),v=e.internalFormat||t.format||eH(e,n.device);r.format=v;const{samples:x,primarySamples:S,isMSAA:C}=n.utils.getTextureSampleData(e);let I=GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.COPY_SRC;e.isStorageTexture===!0&&(I|=GPUTextureUsage.STORAGE_BINDING),e.isCompressedTexture!==!0&&e.isCompressedArrayTexture!==!0&&(I|=GPUTextureUsage.RENDER_ATTACHMENT);const L={label:e.name,size:{width:i,height:a,depthOrArrayLayers:c},mipLevelCount:h,sampleCount:S,dimension:p,format:v,usage:I};if(e.isVideoTexture){const U=e.source.data,R=new VideoFrame(U);L.size.width=R.displayWidth,L.size.height=R.displayHeight,R.close(),r.externalTexture=U}else{if(v===void 0){console.warn("WebGPURenderer: Texture format not supported."),this.createDefaultTexture(e);return}e.isCubeTexture&&(L.textureBindingViewDimension=Fa.Cube),r.texture=n.device.createTexture(L)}if(C){const U=Object.assign({},L);U.label=U.label+"-msaa",U.sampleCount=x,r.msaaTexture=n.device.createTexture(U)}r.initialized=!0,r.textureDescriptorGPU=L}destroyTexture(e){const t=this.backend,n=t.get(e);n.texture!==void 0&&n.texture.destroy(),n.msaaTexture!==void 0&&n.msaaTexture.destroy(),t.delete(e)}destroySampler(e){const n=this.backend.get(e);delete n.sampler}generateMipmaps(e){const t=this.backend.get(e);if(e.isCubeTexture)for(let n=0;n<6;n++)this._generateMipmaps(t.texture,t.textureDescriptorGPU,n);else{const n=e.image.depth||1;for(let r=0;r<n;r++)this._generateMipmaps(t.texture,t.textureDescriptorGPU,r)}}getColorBuffer(){this.colorBuffer&&this.colorBuffer.destroy();const e=this.backend,{width:t,height:n}=e.getDrawingBufferSize();return this.colorBuffer=e.device.createTexture({label:"colorBuffer",size:{width:t,height:n,depthOrArrayLayers:1},sampleCount:e.utils.getSampleCount(e.renderer.samples),format:e.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC}),this.colorBuffer}getDepthBuffer(e=!0,t=!1){const n=this.backend,{width:r,height:i}=n.getDrawingBufferSize(),a=this.depthTexture,c=n.get(a).texture;let h,p;if(t?(h=Mg,p=$3):e&&(h=e1,p=Ho),c!==void 0){if(a.image.width===r&&a.image.height===i&&a.format===h&&a.type===p)return c;this.destroyTexture(a)}return a.name="depthBuffer",a.format=h,a.type=p,a.image.width=r,a.image.height=i,this.createTexture(a,{width:r,height:i}),n.get(a).texture}updateTexture(e,t){const n=this.backend.get(e),{textureDescriptorGPU:r}=n;if(!(e.isRenderTargetTexture||r===void 0)){if(e.isDataTexture)this._copyBufferToTexture(t.image,n.texture,r,0,e.flipY);else if(e.isArrayTexture||e.isDataArrayTexture||e.isData3DTexture)for(let i=0;i<t.image.depth;i++)this._copyBufferToTexture(t.image,n.texture,r,i,e.flipY,i);else if(e.isCompressedTexture||e.isCompressedArrayTexture)this._copyCompressedBufferToTexture(e.mipmaps,n.texture,r);else if(e.isCubeTexture)this._copyCubeMapToTexture(t.images,n.texture,r,e.flipY,e.premultiplyAlpha);else if(e.isVideoTexture){const i=e.source.data;n.externalTexture=i}else this._copyImageToTexture(t.image,n.texture,r,0,e.flipY,e.premultiplyAlpha);n.version=e.version,e.onUpdate&&e.onUpdate(e)}}async copyTextureToBuffer(e,t,n,r,i,a){const c=this.backend.device,h=this.backend.get(e),p=h.texture,v=h.textureDescriptorGPU.format,x=this._getBytesPerTexel(v);let S=r*x;S=Math.ceil(S/256)*256;const C=c.createBuffer({size:r*i*x,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),I=c.createCommandEncoder();I.copyTextureToBuffer({texture:p,origin:{x:t,y:n,z:a}},{buffer:C,bytesPerRow:S},{width:r,height:i});const L=this._getTypedArrayType(v);c.queue.submit([I.finish()]),await C.mapAsync(GPUMapMode.READ);const U=C.getMappedRange();return new L(U)}_getDefaultTextureGPU(e){let t=this.defaultTexture[e];if(t===void 0){const n=new j0;n.minFilter=ya,n.magFilter=ya,this.createTexture(n,{width:1,height:1,format:e}),this.defaultTexture[e]=t=n}return this.backend.get(t).texture}_getDefaultCubeTextureGPU(e){let t=this.defaultTexture[e];if(t===void 0){const n=new OI;n.minFilter=ya,n.magFilter=ya,this.createTexture(n,{width:1,height:1,depth:6}),this.defaultCubeTexture[e]=t=n}return this.backend.get(t).texture}_getDefaultVideoFrame(){let e=this.defaultVideoFrame;if(e===null){const t={timestamp:0,codedWidth:1,codedHeight:1,format:"RGBA"};this.defaultVideoFrame=e=new VideoFrame(new Uint8Array([0,0,0,255]),t)}return e}_copyCubeMapToTexture(e,t,n,r,i){for(let a=0;a<6;a++){const c=e[a],h=r===!0?aGe[a]:a;c.isDataTexture?this._copyBufferToTexture(c.image,t,n,h,r):this._copyImageToTexture(c,t,n,h,r,i)}}_copyImageToTexture(e,t,n,r,i,a){this.backend.device.queue.copyExternalImageToTexture({source:e,flipY:i},{texture:t,mipLevel:0,origin:{x:0,y:0,z:r},premultipliedAlpha:a},{width:e.width,height:e.height,depthOrArrayLayers:1})}_getPassUtils(){let e=this._passUtils;return e===null&&(this._passUtils=e=new sGe(this.backend.device)),e}_generateMipmaps(e,t,n=0){this._getPassUtils().generateMipmaps(e,t,n)}_flipY(e,t,n=0){this._getPassUtils().flipY(e,t,n)}_copyBufferToTexture(e,t,n,r,i,a=0){const c=this.backend.device,h=e.data,p=this._getBytesPerTexel(n.format),v=e.width*p;c.queue.writeTexture({texture:t,mipLevel:0,origin:{x:0,y:0,z:r}},h,{offset:e.width*e.height*p*a,bytesPerRow:v},{width:e.width,height:e.height,depthOrArrayLayers:1}),i===!0&&this._flipY(t,n,r)}_copyCompressedBufferToTexture(e,t,n){const r=this.backend.device,i=this._getBlockData(n.format),a=n.size.depthOrArrayLayers>1;for(let c=0;c<e.length;c++){const h=e[c],p=h.width,v=h.height,x=a?n.size.depthOrArrayLayers:1,S=Math.ceil(p/i.width)*i.byteLength,C=S*Math.ceil(v/i.height);for(let I=0;I<x;I++)r.queue.writeTexture({texture:t,mipLevel:c,origin:{x:0,y:0,z:I}},h.data,{offset:I*C,bytesPerRow:S,rowsPerImage:Math.ceil(v/i.height)},{width:Math.ceil(p/i.width)*i.width,height:Math.ceil(v/i.height)*i.height,depthOrArrayLayers:1})}}_getBlockData(e){if(e===Ke.BC1RGBAUnorm||e===Ke.BC1RGBAUnormSRGB)return{byteLength:8,width:4,height:4};if(e===Ke.BC2RGBAUnorm||e===Ke.BC2RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===Ke.BC3RGBAUnorm||e===Ke.BC3RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===Ke.BC4RUnorm||e===Ke.BC4RSnorm)return{byteLength:8,width:4,height:4};if(e===Ke.BC5RGUnorm||e===Ke.BC5RGSnorm)return{byteLength:16,width:4,height:4};if(e===Ke.BC6HRGBUFloat||e===Ke.BC6HRGBFloat)return{byteLength:16,width:4,height:4};if(e===Ke.BC7RGBAUnorm||e===Ke.BC7RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===Ke.ETC2RGB8Unorm||e===Ke.ETC2RGB8UnormSRGB)return{byteLength:8,width:4,height:4};if(e===Ke.ETC2RGB8A1Unorm||e===Ke.ETC2RGB8A1UnormSRGB)return{byteLength:8,width:4,height:4};if(e===Ke.ETC2RGBA8Unorm||e===Ke.ETC2RGBA8UnormSRGB)return{byteLength:16,width:4,height:4};if(e===Ke.EACR11Unorm)return{byteLength:8,width:4,height:4};if(e===Ke.EACR11Snorm)return{byteLength:8,width:4,height:4};if(e===Ke.EACRG11Unorm)return{byteLength:16,width:4,height:4};if(e===Ke.EACRG11Snorm)return{byteLength:16,width:4,height:4};if(e===Ke.ASTC4x4Unorm||e===Ke.ASTC4x4UnormSRGB)return{byteLength:16,width:4,height:4};if(e===Ke.ASTC5x4Unorm||e===Ke.ASTC5x4UnormSRGB)return{byteLength:16,width:5,height:4};if(e===Ke.ASTC5x5Unorm||e===Ke.ASTC5x5UnormSRGB)return{byteLength:16,width:5,height:5};if(e===Ke.ASTC6x5Unorm||e===Ke.ASTC6x5UnormSRGB)return{byteLength:16,width:6,height:5};if(e===Ke.ASTC6x6Unorm||e===Ke.ASTC6x6UnormSRGB)return{byteLength:16,width:6,height:6};if(e===Ke.ASTC8x5Unorm||e===Ke.ASTC8x5UnormSRGB)return{byteLength:16,width:8,height:5};if(e===Ke.ASTC8x6Unorm||e===Ke.ASTC8x6UnormSRGB)return{byteLength:16,width:8,height:6};if(e===Ke.ASTC8x8Unorm||e===Ke.ASTC8x8UnormSRGB)return{byteLength:16,width:8,height:8};if(e===Ke.ASTC10x5Unorm||e===Ke.ASTC10x5UnormSRGB)return{byteLength:16,width:10,height:5};if(e===Ke.ASTC10x6Unorm||e===Ke.ASTC10x6UnormSRGB)return{byteLength:16,width:10,height:6};if(e===Ke.ASTC10x8Unorm||e===Ke.ASTC10x8UnormSRGB)return{byteLength:16,width:10,height:8};if(e===Ke.ASTC10x10Unorm||e===Ke.ASTC10x10UnormSRGB)return{byteLength:16,width:10,height:10};if(e===Ke.ASTC12x10Unorm||e===Ke.ASTC12x10UnormSRGB)return{byteLength:16,width:12,height:10};if(e===Ke.ASTC12x12Unorm||e===Ke.ASTC12x12UnormSRGB)return{byteLength:16,width:12,height:12}}_convertAddressMode(e){let t=QV.ClampToEdge;return e===V_?t=QV.Repeat:e===G_&&(t=QV.MirrorRepeat),t}_convertFilterMode(e){let t=c6.Linear;return(e===ya||e===b3e||e===TE)&&(t=c6.Nearest),t}_getBytesPerTexel(e){if(e===Ke.R8Unorm||e===Ke.R8Snorm||e===Ke.R8Uint||e===Ke.R8Sint)return 1;if(e===Ke.R16Uint||e===Ke.R16Sint||e===Ke.R16Float||e===Ke.RG8Unorm||e===Ke.RG8Snorm||e===Ke.RG8Uint||e===Ke.RG8Sint)return 2;if(e===Ke.R32Uint||e===Ke.R32Sint||e===Ke.R32Float||e===Ke.RG16Uint||e===Ke.RG16Sint||e===Ke.RG16Float||e===Ke.RGBA8Unorm||e===Ke.RGBA8UnormSRGB||e===Ke.RGBA8Snorm||e===Ke.RGBA8Uint||e===Ke.RGBA8Sint||e===Ke.BGRA8Unorm||e===Ke.BGRA8UnormSRGB||e===Ke.RGB9E5UFloat||e===Ke.RGB10A2Unorm||e===Ke.RG11B10UFloat||e===Ke.Depth32Float||e===Ke.Depth24Plus||e===Ke.Depth24PlusStencil8||e===Ke.Depth32FloatStencil8)return 4;if(e===Ke.RG32Uint||e===Ke.RG32Sint||e===Ke.RG32Float||e===Ke.RGBA16Uint||e===Ke.RGBA16Sint||e===Ke.RGBA16Float)return 8;if(e===Ke.RGBA32Uint||e===Ke.RGBA32Sint||e===Ke.RGBA32Float)return 16}_getTypedArrayType(e){if(e===Ke.R8Uint)return Uint8Array;if(e===Ke.R8Sint)return Int8Array;if(e===Ke.R8Unorm)return Uint8Array;if(e===Ke.R8Snorm)return Int8Array;if(e===Ke.RG8Uint)return Uint8Array;if(e===Ke.RG8Sint)return Int8Array;if(e===Ke.RG8Unorm)return Uint8Array;if(e===Ke.RG8Snorm)return Int8Array;if(e===Ke.RGBA8Uint)return Uint8Array;if(e===Ke.RGBA8Sint)return Int8Array;if(e===Ke.RGBA8Unorm)return Uint8Array;if(e===Ke.RGBA8Snorm)return Int8Array;if(e===Ke.R16Uint)return Uint16Array;if(e===Ke.R16Sint)return Int16Array;if(e===Ke.RG16Uint)return Uint16Array;if(e===Ke.RG16Sint)return Int16Array;if(e===Ke.RGBA16Uint)return Uint16Array;if(e===Ke.RGBA16Sint)return Int16Array;if(e===Ke.R16Float||e===Ke.RG16Float||e===Ke.RGBA16Float)return Uint16Array;if(e===Ke.R32Uint)return Uint32Array;if(e===Ke.R32Sint)return Int32Array;if(e===Ke.R32Float)return Float32Array;if(e===Ke.RG32Uint)return Uint32Array;if(e===Ke.RG32Sint)return Int32Array;if(e===Ke.RG32Float)return Float32Array;if(e===Ke.RGBA32Uint)return Uint32Array;if(e===Ke.RGBA32Sint)return Int32Array;if(e===Ke.RGBA32Float)return Float32Array;if(e===Ke.BGRA8Unorm||e===Ke.BGRA8UnormSRGB)return Uint8Array;if(e===Ke.RGB10A2Unorm||e===Ke.RGB9E5UFloat||e===Ke.RG11B10UFloat)return Uint32Array;if(e===Ke.Depth32Float)return Float32Array;if(e===Ke.Depth24Plus||e===Ke.Depth24PlusStencil8)return Uint32Array;if(e===Ke.Depth32FloatStencil8)return Float32Array}_getDimension(e){let t;return e.isData3DTexture?t=r2e.ThreeD:t=r2e.TwoD,t}}function eH(o,e=null){const t=o.format,n=o.type,r=o.colorSpace,i=Os.getTransfer(r);let a;if(o.isCompressedTexture===!0||o.isCompressedArrayTexture===!0)switch(t){case wk:a=i===Yr?Ke.BC1RGBAUnormSRGB:Ke.BC1RGBAUnorm;break;case Ek:a=i===Yr?Ke.BC2RGBAUnormSRGB:Ke.BC2RGBAUnorm;break;case Tk:a=i===Yr?Ke.BC3RGBAUnormSRGB:Ke.BC3RGBAUnorm;break;case Ej:a=i===Yr?Ke.ETC2RGB8UnormSRGB:Ke.ETC2RGB8Unorm;break;case Tj:a=i===Yr?Ke.ETC2RGBA8UnormSRGB:Ke.ETC2RGBA8Unorm;break;case Mj:a=i===Yr?Ke.ASTC4x4UnormSRGB:Ke.ASTC4x4Unorm;break;case Cj:a=i===Yr?Ke.ASTC5x4UnormSRGB:Ke.ASTC5x4Unorm;break;case Aj:a=i===Yr?Ke.ASTC5x5UnormSRGB:Ke.ASTC5x5Unorm;break;case Pj:a=i===Yr?Ke.ASTC6x5UnormSRGB:Ke.ASTC6x5Unorm;break;case Rj:a=i===Yr?Ke.ASTC6x6UnormSRGB:Ke.ASTC6x6Unorm;break;case kj:a=i===Yr?Ke.ASTC8x5UnormSRGB:Ke.ASTC8x5Unorm;break;case Ij:a=i===Yr?Ke.ASTC8x6UnormSRGB:Ke.ASTC8x6Unorm;break;case Nj:a=i===Yr?Ke.ASTC8x8UnormSRGB:Ke.ASTC8x8Unorm;break;case Dj:a=i===Yr?Ke.ASTC10x5UnormSRGB:Ke.ASTC10x5Unorm;break;case Oj:a=i===Yr?Ke.ASTC10x6UnormSRGB:Ke.ASTC10x6Unorm;break;case Fj:a=i===Yr?Ke.ASTC10x8UnormSRGB:Ke.ASTC10x8Unorm;break;case Lj:a=i===Yr?Ke.ASTC10x10UnormSRGB:Ke.ASTC10x10Unorm;break;case Bj:a=i===Yr?Ke.ASTC12x10UnormSRGB:Ke.ASTC12x10Unorm;break;case Uj:a=i===Yr?Ke.ASTC12x12UnormSRGB:Ke.ASTC12x12Unorm;break;case Ch:a=i===Yr?Ke.RGBA8UnormSRGB:Ke.RGBA8Unorm;break;default:console.error("WebGPURenderer: Unsupported texture format.",t)}else switch(t){case Ch:switch(n){case iE:a=Ke.RGBA8Snorm;break;case sE:a=Ke.RGBA16Sint;break;case d_:a=Ke.RGBA16Uint;break;case Ho:a=Ke.RGBA32Uint;break;case Pl:a=Ke.RGBA32Sint;break;case Il:a=i===Yr?Ke.RGBA8UnormSRGB:Ke.RGBA8Unorm;break;case Mh:a=Ke.RGBA16Float;break;case Su:a=Ke.RGBA32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBAFormat.",n)}break;case QH:switch(n){case S3e:a=Ke.RGB9E5UFloat;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBFormat.",n)}break;case JH:switch(n){case iE:a=Ke.R8Snorm;break;case sE:a=Ke.R16Sint;break;case d_:a=Ke.R16Uint;break;case Ho:a=Ke.R32Uint;break;case Pl:a=Ke.R32Sint;break;case Il:a=Ke.R8Unorm;break;case Mh:a=Ke.R16Float;break;case Su:a=Ke.R32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with RedFormat.",n)}break;case f6:switch(n){case iE:a=Ke.RG8Snorm;break;case sE:a=Ke.RG16Sint;break;case d_:a=Ke.RG16Uint;break;case Ho:a=Ke.RG32Uint;break;case Pl:a=Ke.RG32Sint;break;case Il:a=Ke.RG8Unorm;break;case Mh:a=Ke.RG16Float;break;case Su:a=Ke.RG32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with RGFormat.",n)}break;case e1:switch(n){case d_:a=Ke.Depth16Unorm;break;case Ho:a=Ke.Depth24Plus;break;case Su:a=Ke.Depth32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with DepthFormat.",n)}break;case Mg:switch(n){case $3:a=Ke.Depth24PlusStencil8;break;case Su:e&&e.features.has(Jj.Depth32FloatStencil8)===!1&&console.error('WebGPURenderer: Depth textures with DepthStencilFormat + FloatType can only be used with the "depth32float-stencil8" GPU feature.'),a=Ke.Depth32FloatStencil8;break;default:console.error("WebGPURenderer: Unsupported texture type with DepthStencilFormat.",n)}break;case eW:switch(n){case Pl:a=Ke.R32Sint;break;case Ho:a=Ke.R32Uint;break;default:console.error("WebGPURenderer: Unsupported texture type with RedIntegerFormat.",n)}break;case tW:switch(n){case Pl:a=Ke.RG32Sint;break;case Ho:a=Ke.RG32Uint;break;default:console.error("WebGPURenderer: Unsupported texture type with RGIntegerFormat.",n)}break;case nW:switch(n){case Pl:a=Ke.RGBA32Sint;break;case Ho:a=Ke.RGBA32Uint;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBAIntegerFormat.",n)}break;default:console.error("WebGPURenderer: Unsupported texture format.",t)}return a}const cGe=/^[fn]*\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)\s*[\-\>]*\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/i,uGe=/([a-z_0-9]+)\s*:\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/ig,i2e={f32:"float",i32:"int",u32:"uint",bool:"bool","vec2<f32>":"vec2","vec2<i32>":"ivec2","vec2<u32>":"uvec2","vec2<bool>":"bvec2",vec2f:"vec2",vec2i:"ivec2",vec2u:"uvec2",vec2b:"bvec2","vec3<f32>":"vec3","vec3<i32>":"ivec3","vec3<u32>":"uvec3","vec3<bool>":"bvec3",vec3f:"vec3",vec3i:"ivec3",vec3u:"uvec3",vec3b:"bvec3","vec4<f32>":"vec4","vec4<i32>":"ivec4","vec4<u32>":"uvec4","vec4<bool>":"bvec4",vec4f:"vec4",vec4i:"ivec4",vec4u:"uvec4",vec4b:"bvec4","mat2x2<f32>":"mat2",mat2x2f:"mat2","mat3x3<f32>":"mat3",mat3x3f:"mat3","mat4x4<f32>":"mat4",mat4x4f:"mat4",sampler:"sampler",texture_1d:"texture",texture_2d:"texture",texture_2d_array:"texture",texture_multisampled_2d:"cubeTexture",texture_depth_2d:"depthTexture",texture_depth_2d_array:"depthTexture",texture_depth_multisampled_2d:"depthTexture",texture_depth_cube:"depthTexture",texture_depth_cube_array:"depthTexture",texture_3d:"texture3D",texture_cube:"cubeTexture",texture_cube_array:"cubeTexture",texture_storage_1d:"storageTexture",texture_storage_2d:"storageTexture",texture_storage_2d_array:"storageTexture",texture_storage_3d:"storageTexture"},hGe=o=>{o=o.trim();const e=o.match(cGe);if(e!==null&&e.length===4){const t=e[2],n=[];let r=null;for(;(r=uGe.exec(t))!==null;)n.push({name:r[1],type:r[2]});const i=[];for(let v=0;v<n.length;v++){const{name:x,type:S}=n[v];let C=S;C.startsWith("ptr")?C="pointer":(C.startsWith("texture")&&(C=S.split("<")[0]),C=i2e[C]),i.push(new BW(C,x))}const a=o.substring(e[0].length),c=e[3]||"void",h=e[1]!==void 0?e[1]:"";return{type:i2e[c]||c,inputs:i,name:h,inputsCode:t,blockCode:a,outputType:c}}else throw new Error("FunctionNode: Function is not a WGSL code.")};class dGe extends VW{constructor(e){const{type:t,inputs:n,name:r,inputsCode:i,blockCode:a,outputType:c}=hGe(e);super(t,n,r),this.inputsCode=i,this.blockCode=a,this.outputType=c}getCode(e=this.name){const t=this.outputType!=="void"?"-> "+this.outputType:"";return`fn ${e} ( ${this.inputsCode.trim()} ) ${t}`+this.blockCode}}class fGe extends u5e{parseFunction(e){return new dGe(e)}}const K7=typeof self<"u"?self.GPUShaderStage:{VERTEX:1,FRAGMENT:2,COMPUTE:4},pGe={[_g.READ_ONLY]:"read",[_g.WRITE_ONLY]:"write",[_g.READ_WRITE]:"read_write"},s2e={[V_]:"repeat",[W3]:"clamp",[G_]:"mirror"},rk={vertex:K7?K7.VERTEX:1,fragment:K7?K7.FRAGMENT:2,compute:K7?K7.COMPUTE:4},o2e={instance:!0,swizzleAssign:!1,storageBuffer:!0},mGe={"^^":"tsl_xor"},gGe={float:"f32",int:"i32",uint:"u32",bool:"bool",color:"vec3<f32>",vec2:"vec2<f32>",ivec2:"vec2<i32>",uvec2:"vec2<u32>",bvec2:"vec2<bool>",vec3:"vec3<f32>",ivec3:"vec3<i32>",uvec3:"vec3<u32>",bvec3:"vec3<bool>",vec4:"vec4<f32>",ivec4:"vec4<i32>",uvec4:"vec4<u32>",bvec4:"vec4<bool>",mat2:"mat2x2<f32>",mat3:"mat3x3<f32>",mat4:"mat4x4<f32>"},a2e={},bh={tsl_xor:new ga("fn tsl_xor( a : bool, b : bool ) -> bool { return ( a || b ) && !( a && b ); }"),mod_float:new ga("fn tsl_mod_float( x : f32, y : f32 ) -> f32 { return x - y * floor( x / y ); }"),mod_vec2:new ga("fn tsl_mod_vec2( x : vec2f, y : vec2f ) -> vec2f { return x - y * floor( x / y ); }"),mod_vec3:new ga("fn tsl_mod_vec3( x : vec3f, y : vec3f ) -> vec3f { return x - y * floor( x / y ); }"),mod_vec4:new ga("fn tsl_mod_vec4( x : vec4f, y : vec4f ) -> vec4f { return x - y * floor( x / y ); }"),equals_bool:new ga("fn tsl_equals_bool( a : bool, b : bool ) -> bool { return a == b; }"),equals_bvec2:new ga("fn tsl_equals_bvec2( a : vec2f, b : vec2f ) -> vec2<bool> { return vec2<bool>( a.x == b.x, a.y == b.y ); }"),equals_bvec3:new ga("fn tsl_equals_bvec3( a : vec3f, b : vec3f ) -> vec3<bool> { return vec3<bool>( a.x == b.x, a.y == b.y, a.z == b.z ); }"),equals_bvec4:new ga("fn tsl_equals_bvec4( a : vec4f, b : vec4f ) -> vec4<bool> { return vec4<bool>( a.x == b.x, a.y == b.y, a.z == b.z, a.w == b.w ); }"),repeatWrapping_float:new ga("fn tsl_repeatWrapping_float( coord: f32 ) -> f32 { return fract( coord ); }"),mirrorWrapping_float:new ga("fn tsl_mirrorWrapping_float( coord: f32 ) -> f32 { let mirrored = fract( coord * 0.5 ) * 2.0; return 1.0 - abs( 1.0 - mirrored ); }"),clampWrapping_float:new ga("fn tsl_clampWrapping_float( coord: f32 ) -> f32 { return clamp( coord, 0.0, 1.0 ); }"),biquadraticTexture:new ga(`
fn tsl_biquadraticTexture( map : texture_2d<f32>, coord : vec2f, iRes : vec2u, level : u32 ) -> vec4f {

	let res = vec2f( iRes );

	let uvScaled = coord * res;
	let uvWrapping = ( ( uvScaled % res ) + res ) % res;

	// https://www.shadertoy.com/view/WtyXRy

	let uv = uvWrapping - 0.5;
	let iuv = floor( uv );
	let f = fract( uv );

	let rg1 = textureLoad( map, vec2u( iuv + vec2( 0.5, 0.5 ) ) % iRes, level );
	let rg2 = textureLoad( map, vec2u( iuv + vec2( 1.5, 0.5 ) ) % iRes, level );
	let rg3 = textureLoad( map, vec2u( iuv + vec2( 0.5, 1.5 ) ) % iRes, level );
	let rg4 = textureLoad( map, vec2u( iuv + vec2( 1.5, 1.5 ) ) % iRes, level );

	return mix( mix( rg1, rg2, f.x ), mix( rg3, rg4, f.x ), f.y );

}
`)},qw={dFdx:"dpdx",dFdy:"- dpdy",mod_float:"tsl_mod_float",mod_vec2:"tsl_mod_vec2",mod_vec3:"tsl_mod_vec3",mod_vec4:"tsl_mod_vec4",equals_bool:"tsl_equals_bool",equals_bvec2:"tsl_equals_bvec2",equals_bvec3:"tsl_equals_bvec3",equals_bvec4:"tsl_equals_bvec4",inversesqrt:"inverseSqrt",bitcast:"bitcast<f32>"};typeof navigator<"u"&&/Windows/g.test(navigator.userAgent)&&(bh.pow_float=new ga("fn tsl_pow_float( a : f32, b : f32 ) -> f32 { return select( -pow( -a, b ), pow( a, b ), a > 0.0 ); }"),bh.pow_vec2=new ga("fn tsl_pow_vec2( a : vec2f, b : vec2f ) -> vec2f { return vec2f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ) ); }",[bh.pow_float]),bh.pow_vec3=new ga("fn tsl_pow_vec3( a : vec3f, b : vec3f ) -> vec3f { return vec3f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ), tsl_pow_float( a.z, b.z ) ); }",[bh.pow_float]),bh.pow_vec4=new ga("fn tsl_pow_vec4( a : vec4f, b : vec4f ) -> vec4f { return vec4f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ), tsl_pow_float( a.z, b.z ), tsl_pow_float( a.w, b.w ) ); }",[bh.pow_float]),qw.pow_float="tsl_pow_float",qw.pow_vec2="tsl_pow_vec2",qw.pow_vec3="tsl_pow_vec3",qw.pow_vec4="tsl_pow_vec4");let E5e="";(typeof navigator<"u"&&/Firefox|Deno/g.test(navigator.userAgent))!==!0&&(E5e+=`diagnostic( off, derivative_uniformity );
`);class yGe extends c5e{constructor(e,t){super(e,t,new fGe),this.uniformGroups={},this.builtins={},this.directives={},this.scopedArrays=new Map}needsToWorkingColorSpace(e){return e.isVideoTexture===!0&&e.colorSpace!==Ig}_generateTextureSample(e,t,n,r,i=this.shaderStage){return i==="fragment"?r?`textureSample( ${t}, ${t}_sampler, ${n}, ${r} )`:`textureSample( ${t}, ${t}_sampler, ${n} )`:this._generateTextureSampleLevel(e,t,n,"0",r)}_generateVideoSample(e,t,n=this.shaderStage){if(n==="fragment")return`textureSampleBaseClampToEdge( ${e}, ${e}_sampler, vec2<f32>( ${t}.x, 1.0 - ${t}.y ) )`;console.error(`WebGPURenderer: THREE.VideoTexture does not support ${n} shader.`)}_generateTextureSampleLevel(e,t,n,r,i){return this.isUnfilterable(e)===!1?`textureSampleLevel( ${t}, ${t}_sampler, ${n}, ${r} )`:this.isFilteredTexture(e)?this.generateFilteredTexture(e,t,n,r):this.generateTextureLod(e,t,n,i,r)}generateWrapFunction(e){const t=`tsl_coord_${s2e[e.wrapS]}S_${s2e[e.wrapT]}_${e.isData3DTexture?"3d":"2d"}T`;let n=a2e[t];if(n===void 0){const r=[],i=e.isData3DTexture?"vec3f":"vec2f";let a=`fn ${t}( coord : ${i} ) -> ${i} {

	return ${i}(
`;const c=(h,p)=>{h===V_?(r.push(bh.repeatWrapping_float),a+=`		tsl_repeatWrapping_float( coord.${p} )`):h===W3?(r.push(bh.clampWrapping_float),a+=`		tsl_clampWrapping_float( coord.${p} )`):h===G_?(r.push(bh.mirrorWrapping_float),a+=`		tsl_mirrorWrapping_float( coord.${p} )`):(a+=`		coord.${p}`,console.warn(`WebGPURenderer: Unsupported texture wrap type "${h}" for vertex shader.`))};c(e.wrapS,"x"),a+=`,
`,c(e.wrapT,"y"),e.isData3DTexture&&(a+=`,
`,c(e.wrapR,"z")),a+=`
	);

}
`,a2e[t]=n=new ga(a,r)}return n.build(this),t}generateArrayDeclaration(e,t){return`array< ${this.getType(e)}, ${t} >`}generateTextureDimension(e,t,n){const r=this.getDataFromNode(e,this.shaderStage,this.globalCache);r.dimensionsSnippet===void 0&&(r.dimensionsSnippet={});let i=r.dimensionsSnippet[n];if(r.dimensionsSnippet[n]===void 0){let a,c;const{primarySamples:h}=this.renderer.backend.utils.getTextureSampleData(e),p=h>1;e.isData3DTexture?c="vec3<u32>":c="vec2<u32>",p||e.isVideoTexture||e.isStorageTexture?a=t:a=`${t}${n?`, u32( ${n} )`:""}`,i=new Ak(new Rk(`textureDimensions( ${a} )`,c)),r.dimensionsSnippet[n]=i,(e.isArrayTexture||e.isDataArrayTexture||e.isData3DTexture)&&(r.arrayLayerCount=new Ak(new Rk(`textureNumLayers(${t})`,"u32"))),e.isTextureCube&&(r.cubeFaceCount=new Ak(new Rk("6u","u32")))}return i.build(this)}generateFilteredTexture(e,t,n,r="0u"){this._include("biquadraticTexture");const i=this.generateWrapFunction(e),a=this.generateTextureDimension(e,t,r);return`tsl_biquadraticTexture( ${t}, ${i}( ${n} ), ${a}, u32( ${r} ) )`}generateTextureLod(e,t,n,r,i="0u"){const a=this.generateWrapFunction(e),c=this.generateTextureDimension(e,t,i),h=e.isData3DTexture?"vec3":"vec2",p=`${h}<u32>( ${a}( ${n} ) * ${h}<f32>( ${c} ) )`;return this.generateTextureLoad(e,t,p,r,i)}generateTextureLoad(e,t,n,r,i="0u"){let a;return e.isVideoTexture===!0?a=`textureLoad( ${t}, ${n} )`:r?a=`textureLoad( ${t}, ${n}, ${r}, u32( ${i} ) )`:(a=`textureLoad( ${t}, ${n}, u32( ${i} ) )`,this.renderer.backend.compatibilityMode&&e.isDepthTexture&&(a+=".x")),a}generateTextureStore(e,t,n,r,i){let a;return r?a=`textureStore( ${t}, ${n}, ${r}, ${i} )`:a=`textureStore( ${t}, ${n}, ${i} )`,a}isSampleCompare(e){return e.isDepthTexture===!0&&e.compareFunction!==null}isUnfilterable(e){return this.getComponentTypeFromTexture(e)!=="float"||!this.isAvailable("float32Filterable")&&e.isDataTexture===!0&&e.type===Su||this.isSampleCompare(e)===!1&&e.minFilter===ya&&e.magFilter===ya||this.renderer.backend.utils.getTextureSampleData(e).primarySamples>1}generateTexture(e,t,n,r,i=this.shaderStage){let a=null;return e.isVideoTexture===!0?a=this._generateVideoSample(t,n,i):this.isUnfilterable(e)?a=this.generateTextureLod(e,t,n,r,"0",i):a=this._generateTextureSample(e,t,n,r,i),a}generateTextureGrad(e,t,n,r,i,a=this.shaderStage){if(a==="fragment")return`textureSampleGrad( ${t}, ${t}_sampler, ${n},  ${r[0]}, ${r[1]} )`;console.error(`WebGPURenderer: THREE.TextureNode.gradient() does not support ${a} shader.`)}generateTextureCompare(e,t,n,r,i,a=this.shaderStage){if(a==="fragment")return e.isDepthTexture===!0&&e.isArrayTexture===!0?`textureSampleCompare( ${t}, ${t}_sampler, ${n}, ${i}, ${r} )`:`textureSampleCompare( ${t}, ${t}_sampler, ${n}, ${r} )`;console.error(`WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ${a} shader.`)}generateTextureLevel(e,t,n,r,i,a=this.shaderStage){let c=null;return e.isVideoTexture===!0?c=this._generateVideoSample(t,n,a):c=this._generateTextureSampleLevel(e,t,n,r,i),c}generateTextureBias(e,t,n,r,i,a=this.shaderStage){if(a==="fragment")return`textureSampleBias( ${t}, ${t}_sampler, ${n}, ${r} )`;console.error(`WebGPURenderer: THREE.TextureNode.biasNode does not support ${a} shader.`)}getPropertyName(e,t=this.shaderStage){if(e.isNodeVarying===!0&&e.needsInterpolation===!0){if(t==="vertex")return`varyings.${e.name}`}else if(e.isNodeUniform===!0){const n=e.name,r=e.type;return r==="texture"||r==="cubeTexture"||r==="storageTexture"||r==="texture3D"?n:r==="buffer"||r==="storageBuffer"||r==="indirectStorageBuffer"?this.isCustomStruct(e)?n:n+".value":e.groupNode.name+"."+n}return super.getPropertyName(e)}getOutputStructName(){return"output"}getFunctionOperator(e){const t=mGe[e];return t!==void 0?(this._include(t),t):null}getNodeAccess(e,t){return t!=="compute"?_g.READ_ONLY:e.access}getStorageAccess(e,t){return pGe[this.getNodeAccess(e,t)]}getUniformFromNode(e,t,n,r=null){const i=super.getUniformFromNode(e,t,n,r),a=this.getDataFromNode(e,n,this.globalCache);if(a.uniformGPU===void 0){let c;const h=e.groupNode,p=h.name,v=this.getBindGroupArray(p,n);if(t==="texture"||t==="cubeTexture"||t==="storageTexture"||t==="texture3D"){let x=null;const S=this.getNodeAccess(e,n);if(t==="texture"||t==="storageTexture"?x=new zI(i.name,i.node,h,S):t==="cubeTexture"?x=new x5e(i.name,i.node,h,S):t==="texture3D"&&(x=new b5e(i.name,i.node,h,S)),x.store=e.isStorageTextureNode===!0,x.setVisibility(rk[n]),this.isUnfilterable(e.value)===!1&&x.store===!1){const C=new tGe(`${i.name}_sampler`,i.node,h);C.setVisibility(rk[n]),v.push(C,x),c=[C,x]}else v.push(x),c=[x]}else if(t==="buffer"||t==="storageBuffer"||t==="indirectStorageBuffer"){const x=t==="buffer"?v5e:iGe,S=new x(e,h);S.setVisibility(rk[n]),v.push(S),c=S,i.name=r||"NodeBuffer_"+i.id}else{const x=this.uniformGroups[n]||(this.uniformGroups[n]={});let S=x[p];S===void 0&&(S=new _5e(p,h),S.setVisibility(rk[n]),x[p]=S,v.push(S)),c=this.getNodeUniform(i,t),S.addUniform(c)}a.uniformGPU=c}return i}getBuiltin(e,t,n,r=this.shaderStage){const i=this.builtins[r]||(this.builtins[r]=new Map);return i.has(e)===!1&&i.set(e,{name:e,property:t,type:n}),t}hasBuiltin(e,t=this.shaderStage){return this.builtins[t]!==void 0&&this.builtins[t].has(e)}getVertexIndex(){return this.shaderStage==="vertex"?this.getBuiltin("vertex_index","vertexIndex","u32","attribute"):"vertexIndex"}buildFunctionCode(e){const t=e.layout,n=this.flowShaderNode(e),r=[];for(const a of t.inputs)r.push(a.name+" : "+this.getType(a.type));let i=`fn ${t.name}( ${r.join(", ")} ) -> ${this.getType(t.type)} {
${n.vars}
${n.code}
`;return n.result&&(i+=`	return ${n.result};
`),i+=`
}
`,i}getInstanceIndex(){return this.shaderStage==="vertex"?this.getBuiltin("instance_index","instanceIndex","u32","attribute"):"instanceIndex"}getInvocationLocalIndex(){return this.getBuiltin("local_invocation_index","invocationLocalIndex","u32","attribute")}getSubgroupSize(){return this.enableSubGroups(),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute")}getInvocationSubgroupIndex(){return this.enableSubGroups(),this.getBuiltin("subgroup_invocation_id","invocationSubgroupIndex","u32","attribute")}getSubgroupIndex(){return this.enableSubGroups(),this.getBuiltin("subgroup_id","subgroupIndex","u32","attribute")}getDrawIndex(){return null}getFrontFacing(){return this.getBuiltin("front_facing","isFront","bool")}getFragCoord(){return this.getBuiltin("position","fragCoord","vec4<f32>")+".xy"}getFragDepth(){return"output."+this.getBuiltin("frag_depth","depth","f32","output")}getClipDistance(){return"varyings.hw_clip_distances"}isFlipY(){return!1}enableDirective(e,t=this.shaderStage){(this.directives[t]||(this.directives[t]=new Set)).add(e)}getDirectives(e){const t=[],n=this.directives[e];if(n!==void 0)for(const r of n)t.push(`enable ${r};`);return t.join(`
`)}enableSubGroups(){this.enableDirective("subgroups")}enableSubgroupsF16(){this.enableDirective("subgroups-f16")}enableClipDistances(){this.enableDirective("clip_distances")}enableShaderF16(){this.enableDirective("f16")}enableDualSourceBlending(){this.enableDirective("dual_source_blending")}enableHardwareClipping(e){this.enableClipDistances(),this.getBuiltin("clip_distances","hw_clip_distances",`array<f32, ${e} >`,"vertex")}getBuiltins(e){const t=[],n=this.builtins[e];if(n!==void 0)for(const{name:r,property:i,type:a}of n.values())t.push(`@builtin( ${r} ) ${i} : ${a}`);return t.join(`,
	`)}getScopedArray(e,t,n,r){return this.scopedArrays.has(e)===!1&&this.scopedArrays.set(e,{name:e,scope:t,bufferType:n,bufferCount:r}),e}getScopedArrays(e){if(e!=="compute")return;const t=[];for(const{name:n,scope:r,bufferType:i,bufferCount:a}of this.scopedArrays.values()){const c=this.getType(i);t.push(`var<${r}> ${n}: array< ${c}, ${a} >;`)}return t.join(`
`)}getAttributes(e){const t=[];if(e==="compute"&&(this.getBuiltin("global_invocation_id","globalId","vec3<u32>","attribute"),this.getBuiltin("workgroup_id","workgroupId","vec3<u32>","attribute"),this.getBuiltin("local_invocation_id","localId","vec3<u32>","attribute"),this.getBuiltin("num_workgroups","numWorkgroups","vec3<u32>","attribute"),this.renderer.hasFeature("subgroups")&&(this.enableDirective("subgroups",e),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute"))),e==="vertex"||e==="compute"){const n=this.getBuiltins("attribute");n&&t.push(n);const r=this.getAttributesArray();for(let i=0,a=r.length;i<a;i++){const c=r[i],h=c.name,p=this.getType(c.type);t.push(`@location( ${i} ) ${h} : ${p}`)}}return t.join(`,
	`)}getStructMembers(e){const t=[];for(const n of e.members){const r=e.output?"@location( "+n.index+" ) ":"";let i=this.getType(n.type);n.atomic&&(i="atomic< "+i+" >"),t.push(`	${r+n.name} : ${i}`)}return e.output&&t.push(`	${this.getBuiltins("output")}`),t.join(`,
`)}getStructs(e){let t="";const n=this.structs[e];if(n.length>0){const r=[];for(const i of n){let a=`struct ${i.name} {
`;a+=this.getStructMembers(i),a+=`
};`,r.push(a)}t=`
`+r.join(`

`)+`
`}return t}getVar(e,t,n=null){let r=`var ${t} : `;return n!==null?r+=this.generateArrayDeclaration(e,n):r+=this.getType(e),r}getVars(e){const t=[],n=this.vars[e];if(n!==void 0)for(const r of n)t.push(`	${this.getVar(r.type,r.name,r.count)};`);return`
${t.join(`
`)}
`}getVaryings(e){const t=[];if(e==="vertex"&&this.getBuiltin("position","Vertex","vec4<f32>","vertex"),e==="vertex"||e==="fragment"){const i=this.varyings,a=this.vars[e];for(let c=0;c<i.length;c++){const h=i[c];if(h.needsInterpolation){let p=`@location( ${c} )`;if(h.interpolationType){const v=h.interpolationSampling!==null?`, ${h.interpolationSampling} )`:" )";p+=` @interpolate( ${h.interpolationType}${v}`}else/^(int|uint|ivec|uvec)/.test(h.type)&&(p+=` @interpolate( ${this.renderer.backend.compatibilityMode?"flat, either":"flat"} )`);t.push(`${p} ${h.name} : ${this.getType(h.type)}`)}else e==="vertex"&&a.includes(h)===!1&&a.push(h)}}const n=this.getBuiltins(e);n&&t.push(n);const r=t.join(`,
	`);return e==="vertex"?this._getWGSLStruct("VaryingsStruct","	"+r):r}isCustomStruct(e){const t=e.value,n=e.node,r=(t.isBufferAttribute||t.isInstancedBufferAttribute)&&n.structTypeNode!==null,i=n.value&&n.value.array&&typeof n.value.itemSize=="number"&&n.value.array.length>n.value.itemSize;return r&&!i}getUniforms(e){const t=this.uniforms[e],n=[],r=[],i=[],a={};for(const h of t){const p=h.groupNode.name,v=this.bindingsIndexes[p];if(h.type==="texture"||h.type==="cubeTexture"||h.type==="storageTexture"||h.type==="texture3D"){const x=h.node.value;this.isUnfilterable(x)===!1&&h.node.isStorageTextureNode!==!0&&(this.isSampleCompare(x)?n.push(`@binding( ${v.binding++} ) @group( ${v.group} ) var ${h.name}_sampler : sampler_comparison;`):n.push(`@binding( ${v.binding++} ) @group( ${v.group} ) var ${h.name}_sampler : sampler;`));let S,C="";const{primarySamples:I}=this.renderer.backend.utils.getTextureSampleData(x);if(I>1&&(C="_multisampled"),x.isCubeTexture===!0)S="texture_cube<f32>";else if(x.isDepthTexture===!0)this.renderer.backend.compatibilityMode&&x.compareFunction===null?S=`texture${C}_2d<f32>`:S=`texture_depth${C}_2d${x.isArrayTexture===!0?"_array":""}`;else if(x.isArrayTexture===!0||x.isDataArrayTexture===!0||x.isCompressedArrayTexture===!0)S="texture_2d_array<f32>";else if(x.isVideoTexture===!0)S="texture_external";else if(x.isData3DTexture===!0)S="texture_3d<f32>";else if(h.node.isStorageTextureNode===!0){const L=eH(x),U=this.getStorageAccess(h.node,e);S=`texture_storage_2d<${L}, ${U}>`}else{const L=this.getComponentTypeFromTexture(x).charAt(0);S=`texture${C}_2d<${L}32>`}n.push(`@binding( ${v.binding++} ) @group( ${v.group} ) var ${h.name} : ${S};`)}else if(h.type==="buffer"||h.type==="storageBuffer"||h.type==="indirectStorageBuffer"){const x=h.node,S=this.getType(x.getNodeType(this)),C=x.bufferCount,I=C>0&&h.type==="buffer"?", "+C:"",L=x.isStorageBufferNode?`storage, ${this.getStorageAccess(x,e)}`:"uniform";if(this.isCustomStruct(h))r.push(`@binding( ${v.binding++} ) @group( ${v.group} ) var<${L}> ${h.name} : ${S};`);else{const R=`	value : array< ${x.isAtomic?`atomic<${S}>`:`${S}`}${I} >`;r.push(this._getWGSLStructBinding(h.name,R,L,v.binding++,v.group))}}else{const x=this.getType(this.getVectorType(h.type)),S=h.groupNode.name;(a[S]||(a[S]={index:v.binding++,id:v.group,snippets:[]})).snippets.push(`	${h.name} : ${x}`)}}for(const h in a){const p=a[h];i.push(this._getWGSLStructBinding(h,p.snippets.join(`,
`),"uniform",p.index,p.id))}let c=n.join(`
`);return c+=r.join(`
`),c+=i.join(`
`),c}buildCode(){const e=this.material!==null?{fragment:{},vertex:{}}:{compute:{}};this.sortBindingGroups();for(const t in e){this.shaderStage=t;const n=e[t];n.uniforms=this.getUniforms(t),n.attributes=this.getAttributes(t),n.varyings=this.getVaryings(t),n.structs=this.getStructs(t),n.vars=this.getVars(t),n.codes=this.getCodes(t),n.directives=this.getDirectives(t),n.scopedArrays=this.getScopedArrays(t);let r=`// code

`;r+=this.flowCode[t];const i=this.flowNodes[t],a=i[i.length-1],c=a.outputNode,h=c!==void 0&&c.isOutputStructNode===!0;for(const p of i){const v=this.getFlowData(p),x=p.name;if(x&&(r.length>0&&(r+=`
`),r+=`	// flow -> ${x}
`),r+=`${v.code}
	`,p===a&&t!=="compute"){if(r+=`// result

	`,t==="vertex")r+=`varyings.Vertex = ${v.result};`;else if(t==="fragment")if(h)n.returnType=c.getNodeType(this),n.structs+="var<private> output : "+n.returnType+";",r+=`return ${v.result};`;else{let S="	@location(0) color: vec4<f32>";const C=this.getBuiltins("output");C&&(S+=`,
	`+C),n.returnType="OutputStruct",n.structs+=this._getWGSLStruct("OutputStruct",S),n.structs+=`
var<private> output : OutputStruct;`,r+=`output.color = ${v.result};

	return output;`}}}n.flow=r}this.shaderStage=null,this.material!==null?(this.vertexShader=this._getWGSLVertexCode(e.vertex),this.fragmentShader=this._getWGSLFragmentCode(e.fragment)):this.computeShader=this._getWGSLComputeCode(e.compute,(this.object.workgroupSize||[64]).join(", "))}getMethod(e,t=null){let n;return t!==null&&(n=this._getWGSLMethod(e+"_"+t)),n===void 0&&(n=this._getWGSLMethod(e)),n||e}getType(e){return gGe[e]||e}isAvailable(e){let t=o2e[e];return t===void 0&&(e==="float32Filterable"?t=this.renderer.hasFeature("float32-filterable"):e==="clipDistance"&&(t=this.renderer.hasFeature("clip-distances")),o2e[e]=t),t}_getWGSLMethod(e){return bh[e]!==void 0&&this._include(e),qw[e]}_include(e){const t=bh[e];return t.build(this),this.currentFunctionNode!==null&&this.currentFunctionNode.includes.push(t),t}_getWGSLVertexCode(e){return`${this.getSignature()}
// directives
${e.directives}

// structs
${e.structs}

// uniforms
${e.uniforms}

// varyings
${e.varyings}
var<private> varyings : VaryingsStruct;

// codes
${e.codes}

@vertex
fn main( ${e.attributes} ) -> VaryingsStruct {

	// vars
	${e.vars}

	// flow
	${e.flow}

	return varyings;

}
`}_getWGSLFragmentCode(e){return`${this.getSignature()}
// global
${E5e}

// structs
${e.structs}

// uniforms
${e.uniforms}

// codes
${e.codes}

@fragment
fn main( ${e.varyings} ) -> ${e.returnType} {

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}_getWGSLComputeCode(e,t){return`${this.getSignature()}
// directives
${e.directives}

// system
var<private> instanceIndex : u32;

// locals
${e.scopedArrays}

// structs
${e.structs}

// uniforms
${e.uniforms}

// codes
${e.codes}

@compute @workgroup_size( ${t} )
fn main( ${e.attributes} ) {

	// system
	instanceIndex = globalId.x + globalId.y * numWorkgroups.x * u32(${t}) + globalId.z * numWorkgroups.x * numWorkgroups.y * u32(${t});

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}_getWGSLStruct(e,t){return`
struct ${e} {
${t}
};`}_getWGSLStructBinding(e,t,n,r=0,i=0){const a=e+"Struct";return`${this._getWGSLStruct(a,t)}
@binding( ${r} ) @group( ${i} )
var<${n}> ${e} : ${a};`}}class vGe{constructor(e){this.backend=e}getCurrentDepthStencilFormat(e){let t;return e.depthTexture!==null?t=this.getTextureFormatGPU(e.depthTexture):e.depth&&e.stencil?t=Ke.Depth24PlusStencil8:e.depth&&(t=Ke.Depth24Plus),t}getTextureFormatGPU(e){return this.backend.get(e).format}getTextureSampleData(e){let t;if(e.isFramebufferTexture)t=1;else if(e.isDepthTexture&&!e.renderTarget){const i=this.backend.renderer,a=i.getRenderTarget();t=a?a.samples:i.samples}else e.renderTarget&&(t=e.renderTarget.samples);t=t||1;const n=t>1&&e.renderTarget!==null&&e.isDepthTexture!==!0&&e.isFramebufferTexture!==!0;return{samples:t,primarySamples:n?1:t,isMSAA:n}}getCurrentColorFormat(e){let t;return e.textures!==null?t=this.getTextureFormatGPU(e.textures[0]):t=this.getPreferredCanvasFormat(),t}getCurrentColorSpace(e){return e.textures!==null?e.textures[0].colorSpace:this.backend.renderer.outputColorSpace}getPrimitiveTopology(e,t){if(e.isPoints)return y_.PointList;if(e.isLineSegments||e.isMesh&&t.wireframe===!0)return y_.LineList;if(e.isLine)return y_.LineStrip;if(e.isMesh)return y_.TriangleList}getSampleCount(e){let t=1;return e>1&&(t=Math.pow(2,Math.floor(Math.log2(e))),t===2&&(t=4)),t}getSampleCountRenderContext(e){return e.textures!==null?this.getSampleCount(e.sampleCount):this.getSampleCount(this.backend.renderer.samples)}getPreferredCanvasFormat(){const e=this.backend.parameters.outputType;if(e===void 0)return navigator.gpu.getPreferredCanvasFormat();if(e===Il)return Ke.BGRA8Unorm;if(e===Mh)return Ke.RGBA16Float;throw new Error("Unsupported outputType")}}const _Ge=new Map([[Int8Array,["sint8","snorm8"]],[Uint8Array,["uint8","unorm8"]],[Int16Array,["sint16","snorm16"]],[Uint16Array,["uint16","unorm16"]],[Int32Array,["sint32","snorm32"]],[Uint32Array,["uint32","unorm32"]],[Float32Array,["float32"]]]),xGe=new Map([[L3e,["float16"]]]),bGe=new Map([[Int32Array,"sint32"],[Int16Array,"sint32"],[Uint32Array,"uint32"],[Uint16Array,"uint32"],[Float32Array,"float32"]]);class SGe{constructor(e){this.backend=e}createAttribute(e,t){const n=this._getBufferAttribute(e),r=this.backend,i=r.get(n);let a=i.buffer;if(a===void 0){const c=r.device;let h=n.array;if(e.normalized===!1){if(h.constructor===Int16Array||h.constructor===Int8Array)h=new Int32Array(h);else if((h.constructor===Uint16Array||h.constructor===Uint8Array)&&(h=new Uint32Array(h),t&GPUBufferUsage.INDEX))for(let x=0;x<h.length;x++)h[x]===65535&&(h[x]=4294967295)}if(n.array=h,(n.isStorageBufferAttribute||n.isStorageInstancedBufferAttribute)&&n.itemSize===3){h=new h.constructor(n.count*4);for(let x=0;x<n.count;x++)h.set(n.array.subarray(x*3,x*3+3),x*4);n.itemSize=4,n.array=h,i._force3to4BytesAlignment=!0}const p=h.byteLength,v=p+(4-p%4)%4;a=c.createBuffer({label:n.name,size:v,usage:t,mappedAtCreation:!0}),new h.constructor(a.getMappedRange()).set(h),a.unmap(),i.buffer=a}}updateAttribute(e){const t=this._getBufferAttribute(e),n=this.backend,r=n.device,i=n.get(t),a=n.get(t).buffer;let c=t.array;if(i._force3to4BytesAlignment===!0){c=new c.constructor(t.count*4);for(let v=0;v<t.count;v++)c.set(t.array.subarray(v*3,v*3+3),v*4);t.array=c}const h=this._isTypedArray(c),p=t.updateRanges;if(p.length===0)r.queue.writeBuffer(a,0,c,0);else{const v=h?1:c.BYTES_PER_ELEMENT;for(let x=0,S=p.length;x<S;x++){const C=p[x];let I,L;if(i._force3to4BytesAlignment===!0){const R=Math.floor(C.start/3),$=Math.ceil(C.count/3);I=R*4*v,L=$*4*v}else I=C.start*v,L=C.count*v;const U=I*(h?c.BYTES_PER_ELEMENT:1);r.queue.writeBuffer(a,U,c,I,L)}t.clearUpdateRanges()}}createShaderVertexBuffers(e){const t=e.getAttributes(),n=new Map;for(let r=0;r<t.length;r++){const i=t[r],a=i.array.BYTES_PER_ELEMENT,c=this._getBufferAttribute(i);let h=n.get(c);if(h===void 0){let x,S;i.isInterleavedBufferAttribute===!0?(x=i.data.stride*a,S=i.data.isInstancedInterleavedBuffer?nk.Instance:nk.Vertex):(x=i.itemSize*a,S=i.isInstancedBufferAttribute?nk.Instance:nk.Vertex),i.normalized===!1&&(i.array.constructor===Int16Array||i.array.constructor===Uint16Array)&&(x=4),h={arrayStride:x,attributes:[],stepMode:S},n.set(c,h)}const p=this._getVertexFormat(i),v=i.isInterleavedBufferAttribute===!0?i.offset*a:0;h.attributes.push({shaderLocation:r,offset:v,format:p})}return Array.from(n.values())}destroyAttribute(e){const t=this.backend;t.get(this._getBufferAttribute(e)).buffer.destroy(),t.delete(e)}async getArrayBufferAsync(e){const t=this.backend,n=t.device,i=t.get(this._getBufferAttribute(e)).buffer,a=i.size,c=n.createBuffer({label:`${e.name}_readback`,size:a,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),h=n.createCommandEncoder({label:`readback_encoder_${e.name}`});h.copyBufferToBuffer(i,0,c,0,a);const p=h.finish();n.queue.submit([p]),await c.mapAsync(GPUMapMode.READ);const v=c.getMappedRange(),x=new e.array.constructor(v.slice(0));return c.unmap(),x.buffer}_getVertexFormat(e){const{itemSize:t,normalized:n}=e,r=e.array.constructor,i=e.constructor;let a;if(t===1)a=bGe.get(r);else{const h=(xGe.get(i)||_Ge.get(r))[n?1:0];if(h){const p=r.BYTES_PER_ELEMENT*t,x=Math.floor((p+3)/4)*4/r.BYTES_PER_ELEMENT;if(x%1)throw new Error("THREE.WebGPUAttributeUtils: Bad vertex format item size.");a=`${h}x${x}`}}return a||console.error("THREE.WebGPUAttributeUtils: Vertex format not supported yet."),a}_isTypedArray(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}_getBufferAttribute(e){return e.isInterleavedBufferAttribute&&(e=e.data),e}}class wGe{constructor(e){this.backend=e,this.bindGroupLayoutCache=new WeakMap}createBindingsLayout(e){const t=this.backend,n=t.device,r=[];let i=0;for(const a of e.bindings){const c={binding:i++,visibility:a.visibility};if(a.isUniformBuffer||a.isStorageBuffer){const h={};a.isStorageBuffer&&(a.visibility&4&&(a.access===_g.READ_WRITE||a.access===_g.WRITE_ONLY)?h.type=JV.Storage:h.type=JV.ReadOnlyStorage),c.buffer=h}else if(a.isSampler){const h={};a.texture.isDepthTexture&&(a.texture.compareFunction!==null?h.type=n2e.Comparison:t.compatibilityMode&&(h.type=n2e.NonFiltering)),c.sampler=h}else if(a.isSampledTexture&&a.texture.isVideoTexture)c.externalTexture={};else if(a.isSampledTexture&&a.store){const h={};h.format=this.backend.get(a.texture).texture.format;const p=a.access;p===_g.READ_WRITE?h.access=eG.ReadWrite:p===_g.WRITE_ONLY?h.access=eG.WriteOnly:h.access=eG.ReadOnly,c.storageTexture=h}else if(a.isSampledTexture){const h={},{primarySamples:p}=t.utils.getTextureSampleData(a.texture);if(p>1&&(h.multisampled=!0,a.texture.isDepthTexture||(h.sampleType=$8.UnfilterableFloat)),a.texture.isDepthTexture)t.compatibilityMode&&a.texture.compareFunction===null?h.sampleType=$8.UnfilterableFloat:h.sampleType=$8.Depth;else if(a.texture.isDataTexture||a.texture.isDataArrayTexture||a.texture.isData3DTexture){const v=a.texture.type;v===Pl?h.sampleType=$8.SInt:v===Ho?h.sampleType=$8.UInt:v===Su&&(this.backend.hasFeature("float32-filterable")?h.sampleType=$8.Float:h.sampleType=$8.UnfilterableFloat)}a.isSampledCubeTexture?h.viewDimension=Fa.Cube:a.texture.isArrayTexture||a.texture.isDataArrayTexture||a.texture.isCompressedArrayTexture?h.viewDimension=Fa.TwoDArray:a.isSampledTexture3D&&(h.viewDimension=Fa.ThreeD),c.texture=h}else console.error(`WebGPUBindingUtils: Unsupported binding "${a}".`);r.push(c)}return n.createBindGroupLayout({entries:r})}createBindings(e,t,n,r=0){const{backend:i,bindGroupLayoutCache:a}=this,c=i.get(e);let h=a.get(e.bindingsReference);h===void 0&&(h=this.createBindingsLayout(e),a.set(e.bindingsReference,h));let p;n>0&&(c.groups===void 0&&(c.groups=[],c.versions=[]),c.versions[n]===r&&(p=c.groups[n])),p===void 0&&(p=this.createBindGroup(e,h),n>0&&(c.groups[n]=p,c.versions[n]=r)),c.group=p,c.layout=h}updateBinding(e){const t=this.backend,n=t.device,r=e.buffer,i=t.get(e).buffer;n.queue.writeBuffer(i,0,r,0)}createBindGroupIndex(e,t){const r=this.backend.device,i=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,a=e[0],c=r.createBuffer({label:"bindingCameraIndex_"+a,size:16,usage:i});r.queue.writeBuffer(c,0,e,0);const h=[{binding:0,resource:{buffer:c}}];return r.createBindGroup({label:"bindGroupCameraIndex_"+a,layout:t,entries:h})}createBindGroup(e,t){const n=this.backend,r=n.device;let i=0;const a=[];for(const c of e.bindings){if(c.isUniformBuffer){const h=n.get(c);if(h.buffer===void 0){const p=c.byteLength,v=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,x=r.createBuffer({label:"bindingBuffer_"+c.name,size:p,usage:v});h.buffer=x}a.push({binding:i,resource:{buffer:h.buffer}})}else if(c.isStorageBuffer){const h=n.get(c);if(h.buffer===void 0){const p=c.attribute;h.buffer=n.get(p).buffer}a.push({binding:i,resource:{buffer:h.buffer}})}else if(c.isSampler){const h=n.get(c.texture);a.push({binding:i,resource:h.sampler})}else if(c.isSampledTexture){const h=n.get(c.texture);let p;if(h.externalTexture!==void 0)p=r.importExternalTexture({source:h.externalTexture});else{const v=c.store?1:h.texture.mipLevelCount,x=`view-${h.texture.width}-${h.texture.height}-${v}`;if(p=h[x],p===void 0){const S=JVe.All;let C;c.isSampledCubeTexture?C=Fa.Cube:c.isSampledTexture3D?C=Fa.ThreeD:c.texture.isArrayTexture||c.texture.isDataArrayTexture||c.texture.isCompressedArrayTexture?C=Fa.TwoDArray:C=Fa.TwoD,p=h[x]=h.texture.createView({aspect:S,dimension:C,mipLevelCount:v})}}a.push({binding:i,resource:p})}i++}return r.createBindGroup({label:"bindGroup_"+e.name,layout:t,entries:a})}}class EGe{constructor(e){this.backend=e,this._activePipelines=new WeakMap}setPipeline(e,t){this._activePipelines.get(e)!==t&&(e.setPipeline(t),this._activePipelines.set(e,t))}_getSampleCount(e){return this.backend.utils.getSampleCountRenderContext(e)}createRenderPipeline(e,t){const{object:n,material:r,geometry:i,pipeline:a}=e,{vertexProgram:c,fragmentProgram:h}=a,p=this.backend,v=p.device,x=p.utils,S=p.get(a),C=[];for(const je of e.getBindings()){const rt=p.get(je);C.push(rt.layout)}const I=p.attributeUtils.createShaderVertexBuffers(e);let L;r.blending!==z_&&(r.blending!==Eg||r.transparent!==!1)&&(L=this._getBlending(r));let U={};r.stencilWrite===!0&&(U={compare:this._getStencilCompare(r),failOp:this._getStencilOperation(r.stencilFail),depthFailOp:this._getStencilOperation(r.stencilZFail),passOp:this._getStencilOperation(r.stencilZPass)});const R=this._getColorWriteMask(r),$=[];if(e.context.textures!==null){const je=e.context.textures;for(let rt=0;rt<je.length;rt++){const at=x.getTextureFormatGPU(je[rt]);$.push({format:at,blend:L,writeMask:R})}}else{const je=x.getCurrentColorFormat(e.context);$.push({format:je,blend:L,writeMask:R})}const Z=p.get(c).module,k=p.get(h).module,ie=this._getPrimitiveState(n,i,r),ue=this._getDepthCompare(r),ce=x.getCurrentDepthStencilFormat(e.context),Q=this._getSampleCount(e.context),ae={label:`renderPipeline_${r.name||r.type}_${r.id}`,vertex:Object.assign({},Z,{buffers:I}),fragment:Object.assign({},k,{targets:$}),primitive:ie,multisample:{count:Q,alphaToCoverageEnabled:r.alphaToCoverage&&Q>1},layout:v.createPipelineLayout({bindGroupLayouts:C})},le={},J=e.context.depth,Ue=e.context.stencil;if((J===!0||Ue===!0)&&(J===!0&&(le.format=ce,le.depthWriteEnabled=r.depthWrite,le.depthCompare=ue),Ue===!0&&(le.stencilFront=U,le.stencilBack={},le.stencilReadMask=r.stencilFuncMask,le.stencilWriteMask=r.stencilWriteMask),r.polygonOffset===!0&&(le.depthBias=r.polygonOffsetUnits,le.depthBiasSlopeScale=r.polygonOffsetFactor,le.depthBiasClamp=0),ae.depthStencil=le),t===null)S.pipeline=v.createRenderPipeline(ae);else{const je=new Promise(rt=>{v.createRenderPipelineAsync(ae).then(at=>{S.pipeline=at,rt()})});t.push(je)}}createBundleEncoder(e,t="renderBundleEncoder"){const n=this.backend,{utils:r,device:i}=n,a=r.getCurrentDepthStencilFormat(e),c=r.getCurrentColorFormat(e),h=this._getSampleCount(e),p={label:t,colorFormats:[c],depthStencilFormat:a,sampleCount:h};return i.createRenderBundleEncoder(p)}createComputePipeline(e,t){const n=this.backend,r=n.device,i=n.get(e.computeProgram).module,a=n.get(e),c=[];for(const h of t){const p=n.get(h);c.push(p.layout)}a.pipeline=r.createComputePipeline({compute:i,layout:r.createPipelineLayout({bindGroupLayouts:c})})}_getBlending(e){let t,n;const r=e.blending,i=e.blendSrc,a=e.blendDst,c=e.blendEquation;if(r===rE){const h=e.blendSrcAlpha!==null?e.blendSrcAlpha:i,p=e.blendDstAlpha!==null?e.blendDstAlpha:a,v=e.blendEquationAlpha!==null?e.blendEquationAlpha:c;t={srcFactor:this._getBlendFactor(i),dstFactor:this._getBlendFactor(a),operation:this._getBlendOperation(c)},n={srcFactor:this._getBlendFactor(h),dstFactor:this._getBlendFactor(p),operation:this._getBlendOperation(v)}}else{const h=e.premultipliedAlpha,p=(v,x,S,C)=>{t={srcFactor:v,dstFactor:x,operation:W8.Add},n={srcFactor:S,dstFactor:C,operation:W8.Add}};if(h)switch(r){case Eg:p(Jr.One,Jr.OneMinusSrcAlpha,Jr.One,Jr.OneMinusSrcAlpha);break;case $k:p(Jr.One,Jr.One,Jr.One,Jr.One);break;case qk:p(Jr.Zero,Jr.OneMinusSrc,Jr.Zero,Jr.One);break;case Xk:p(Jr.Zero,Jr.Src,Jr.Zero,Jr.SrcAlpha);break}else switch(r){case Eg:p(Jr.SrcAlpha,Jr.OneMinusSrcAlpha,Jr.One,Jr.OneMinusSrcAlpha);break;case $k:p(Jr.SrcAlpha,Jr.One,Jr.SrcAlpha,Jr.One);break;case qk:p(Jr.Zero,Jr.OneMinusSrc,Jr.Zero,Jr.One);break;case Xk:p(Jr.Zero,Jr.Src,Jr.Zero,Jr.Src);break}}if(t!==void 0&&n!==void 0)return{color:t,alpha:n};console.error("THREE.WebGPURenderer: Invalid blending: ",r)}_getBlendFactor(e){let t;switch(e){case B3:t=Jr.Zero;break;case o3e:t=Jr.One;break;case a3e:t=Jr.Src;break;case l3e:t=Jr.OneMinusSrc;break;case Yk:t=Jr.SrcAlpha;break;case Kk:t=Jr.OneMinusSrcAlpha;break;case h3e:t=Jr.Dst;break;case d3e:t=Jr.OneMinusDst;break;case c3e:t=Jr.DstAlpha;break;case u3e:t=Jr.OneMinusDstAlpha;break;case f3e:t=Jr.SrcAlphaSaturated;break;case CNe:t=Jr.Constant;break;case ANe:t=Jr.OneMinusConstant;break;default:console.error("THREE.WebGPURenderer: Blend factor not supported.",e)}return t}_getStencilCompare(e){let t;const n=e.stencilFunc;switch(n){case aNe:t=o0.Never;break;case zj:t=o0.Always;break;case lNe:t=o0.Less;break;case uNe:t=o0.LessEqual;break;case cNe:t=o0.Equal;break;case fNe:t=o0.GreaterEqual;break;case hNe:t=o0.Greater;break;case dNe:t=o0.NotEqual;break;default:console.error("THREE.WebGPURenderer: Invalid stencil function.",n)}return t}_getStencilOperation(e){let t;switch(e){case e6:t=N3.Keep;break;case eNe:t=N3.Zero;break;case tNe:t=N3.Replace;break;case oNe:t=N3.Invert;break;case nNe:t=N3.IncrementClamp;break;case rNe:t=N3.DecrementClamp;break;case iNe:t=N3.IncrementWrap;break;case sNe:t=N3.DecrementWrap;break;default:console.error("THREE.WebGPURenderer: Invalid stencil operation.",t)}return t}_getBlendOperation(e){let t;switch(e){case lf:t=W8.Add;break;case i3e:t=W8.Subtract;break;case s3e:t=W8.ReverseSubtract;break;case BIe:t=W8.Min;break;case UIe:t=W8.Max;break;default:console.error("THREE.WebGPUPipelineUtils: Blend equation not supported.",e)}return t}_getPrimitiveState(e,t,n){const r={},i=this.backend.utils;switch(r.topology=i.getPrimitiveTopology(e,n),t.index!==null&&e.isLine===!0&&e.isLineSegments!==!0&&(r.stripIndexFormat=t.index.array instanceof Uint16Array?q_.Uint16:q_.Uint32),n.side){case wg:r.frontFace=KV.CCW,r.cullMode=ZV.Back;break;case Ec:r.frontFace=KV.CCW,r.cullMode=ZV.Front;break;case S_:r.frontFace=KV.CCW,r.cullMode=ZV.None;break;default:console.error("THREE.WebGPUPipelineUtils: Unknown material.side value.",n.side);break}return r}_getColorWriteMask(e){return e.colorWrite===!0?t2e.All:t2e.None}_getDepthCompare(e){let t;if(e.depthTest===!1)t=o0.Always;else{const n=e.depthFunc;switch(n){case p3e:t=o0.Never;break;case m3e:t=o0.Always;break;case g3e:t=o0.Less;break;case Zk:t=o0.LessEqual;break;case y3e:t=o0.Equal;break;case v3e:t=o0.GreaterEqual;break;case _3e:t=o0.Greater;break;case x3e:t=o0.NotEqual;break;default:console.error("THREE.WebGPUPipelineUtils: Invalid depth function.",n)}}return t}}class TGe extends w5e{constructor(e,t,n=2048){super(n),this.device=e,this.type=t,this.querySet=this.device.createQuerySet({type:"timestamp",count:this.maxQueries,label:`queryset_global_timestamp_${t}`});const r=this.maxQueries*8;this.resolveBuffer=this.device.createBuffer({label:`buffer_timestamp_resolve_${t}`,size:r,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),this.resultBuffer=this.device.createBuffer({label:`buffer_timestamp_result_${t}`,size:r,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ})}allocateQueriesForContext(e){if(!this.trackTimestamp||this.isDisposed)return null;if(this.currentQueryIndex+2>this.maxQueries)return Ng(`WebGPUTimestampQueryPool [${this.type}]: Maximum number of queries exceeded, when using trackTimestamp it is necessary to resolves the queries via renderer.resolveTimestampsAsync( THREE.TimestampQuery.${this.type.toUpperCase()} ).`),null;const t=this.currentQueryIndex;return this.currentQueryIndex+=2,this.queryOffsets.set(e.id,t),t}async resolveQueriesAsync(){if(!this.trackTimestamp||this.currentQueryIndex===0||this.isDisposed)return this.lastValue;if(this.pendingResolve)return this.pendingResolve;this.pendingResolve=this._resolveQueries();try{return await this.pendingResolve}finally{this.pendingResolve=null}}async _resolveQueries(){if(this.isDisposed)return this.lastValue;try{if(this.resultBuffer.mapState!=="unmapped")return this.lastValue;const e=new Map(this.queryOffsets),t=this.currentQueryIndex,n=t*8;this.currentQueryIndex=0,this.queryOffsets.clear();const r=this.device.createCommandEncoder();r.resolveQuerySet(this.querySet,0,t,this.resolveBuffer,0),r.copyBufferToBuffer(this.resolveBuffer,0,this.resultBuffer,0,n);const i=r.finish();if(this.device.queue.submit([i]),this.resultBuffer.mapState!=="unmapped")return this.lastValue;if(await this.resultBuffer.mapAsync(GPUMapMode.READ,0,n),this.isDisposed)return this.resultBuffer.mapState==="mapped"&&this.resultBuffer.unmap(),this.lastValue;const a=new BigUint64Array(this.resultBuffer.getMappedRange(0,n));let c=0;for(const[,h]of e){const p=a[h],v=a[h+1],x=Number(v-p)/1e6;c+=x}return this.resultBuffer.unmap(),this.lastValue=c,c}catch(e){return console.error("Error resolving queries:",e),this.resultBuffer.mapState==="mapped"&&this.resultBuffer.unmap(),this.lastValue}}async dispose(){if(!this.isDisposed){if(this.isDisposed=!0,this.pendingResolve)try{await this.pendingResolve}catch(e){console.error("Error waiting for pending resolve:",e)}if(this.resultBuffer&&this.resultBuffer.mapState==="mapped")try{this.resultBuffer.unmap()}catch(e){console.error("Error unmapping buffer:",e)}this.querySet&&(this.querySet.destroy(),this.querySet=null),this.resolveBuffer&&(this.resolveBuffer.destroy(),this.resolveBuffer=null),this.resultBuffer&&(this.resultBuffer.destroy(),this.resultBuffer=null),this.queryOffsets.clear(),this.pendingResolve=null}}}class MGe extends S5e{constructor(e={}){super(e),this.isWebGPUBackend=!0,this.parameters.alpha=e.alpha===void 0?!0:e.alpha,this.parameters.compatibilityMode=e.compatibilityMode===void 0?!1:e.compatibilityMode,this.parameters.requiredLimits=e.requiredLimits===void 0?{}:e.requiredLimits,this.compatibilityMode=this.parameters.compatibilityMode,this.device=null,this.context=null,this.colorBuffer=null,this.defaultRenderPassdescriptor=null,this.utils=new vGe(this),this.attributeUtils=new SGe(this),this.bindingUtils=new wGe(this),this.pipelineUtils=new EGe(this),this.textureUtils=new lGe(this),this.occludedResolveCache=new Map}async init(e){await super.init(e);const t=this.parameters;let n;if(t.device===void 0){const a={powerPreference:t.powerPreference,featureLevel:t.compatibilityMode?"compatibility":void 0},c=typeof navigator<"u"?await navigator.gpu.requestAdapter(a):null;if(c===null)throw new Error("WebGPUBackend: Unable to create WebGPU adapter.");const h=Object.values(Jj),p=[];for(const x of h)c.features.has(x)&&p.push(x);const v={requiredFeatures:p,requiredLimits:t.requiredLimits};n=await c.requestDevice(v)}else n=t.device;n.lost.then(a=>{const c={api:"WebGPU",message:a.message||"Unknown reason",reason:a.reason||null,originalEvent:a};e.onDeviceLost(c)});const r=t.context!==void 0?t.context:e.domElement.getContext("webgpu");this.device=n,this.context=r;const i=t.alpha?"premultiplied":"opaque";this.trackTimestamp=this.trackTimestamp&&this.hasFeature(Jj.TimestampQuery),this.context.configure({device:this.device,format:this.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC,alphaMode:i}),this.updateSize()}get coordinateSystem(){return K3}async getArrayBufferAsync(e){return await this.attributeUtils.getArrayBufferAsync(e)}getContext(){return this.context}_getDefaultRenderPassDescriptor(){let e=this.defaultRenderPassdescriptor;if(e===null){const n=this.renderer;e={colorAttachments:[{view:null}]},(this.renderer.depth===!0||this.renderer.stencil===!0)&&(e.depthStencilAttachment={view:this.textureUtils.getDepthBuffer(n.depth,n.stencil).createView()});const r=e.colorAttachments[0];this.renderer.samples>0?r.view=this.colorBuffer.createView():r.resolveTarget=void 0,this.defaultRenderPassdescriptor=e}const t=e.colorAttachments[0];return this.renderer.samples>0?t.resolveTarget=this.context.getCurrentTexture().createView():t.view=this.context.getCurrentTexture().createView(),e}_isRenderCameraDepthArray(e){return e.depthTexture&&e.depthTexture.image.depth>1&&e.camera.isArrayCamera}_getRenderPassDescriptor(e,t={}){const n=e.renderTarget,r=this.get(n);let i=r.descriptors;if(i===void 0||r.width!==n.width||r.height!==n.height||r.dimensions!==n.dimensions||r.activeMipmapLevel!==e.activeMipmapLevel||r.activeCubeFace!==e.activeCubeFace||r.samples!==n.samples){i={},r.descriptors=i;const p=()=>{n.removeEventListener("dispose",p),this.delete(n)};n.hasEventListener("dispose",p)===!1&&n.addEventListener("dispose",p)}const a=e.getCacheKey();let c=i[a];if(c===void 0){const p=e.textures,v=[];let x;const S=this._isRenderCameraDepthArray(e);for(let C=0;C<p.length;C++){const I=this.get(p[C]),L={label:`colorAttachment_${C}`,baseMipLevel:e.activeMipmapLevel,mipLevelCount:1,baseArrayLayer:e.activeCubeFace,arrayLayerCount:1,dimension:Fa.TwoD};if(n.isRenderTarget3D)x=e.activeCubeFace,L.baseArrayLayer=0,L.dimension=Fa.ThreeD,L.depthOrArrayLayers=p[C].image.depth;else if(n.isRenderTarget&&p[C].image.depth>1)if(S===!0){const U=e.camera.cameras;for(let R=0;R<U.length;R++){const $={...L,baseArrayLayer:R,arrayLayerCount:1,dimension:Fa.TwoD},Z=I.texture.createView($);v.push({view:Z,resolveTarget:void 0,depthSlice:void 0})}}else L.dimension=Fa.TwoDArray,L.depthOrArrayLayers=p[C].image.depth;if(S!==!0){const U=I.texture.createView(L);let R,$;I.msaaTexture!==void 0?(R=I.msaaTexture.createView(),$=U):(R=U,$=void 0),v.push({view:R,resolveTarget:$,depthSlice:x})}}if(c={textureViews:v},e.depth){const C=this.get(e.depthTexture),I={};e.depthTexture.isArrayTexture&&(I.dimension=Fa.TwoD,I.arrayLayerCount=1,I.baseArrayLayer=e.activeCubeFace),c.depthStencilView=C.texture.createView(I)}i[a]=c,r.width=n.width,r.height=n.height,r.samples=n.samples,r.activeMipmapLevel=e.activeMipmapLevel,r.activeCubeFace=e.activeCubeFace,r.dimensions=n.dimensions}const h={colorAttachments:[]};for(let p=0;p<c.textureViews.length;p++){const v=c.textureViews[p];let x={r:0,g:0,b:0,a:1};p===0&&t.clearValue&&(x=t.clearValue),h.colorAttachments.push({view:v.view,depthSlice:v.depthSlice,resolveTarget:v.resolveTarget,loadOp:t.loadOp||Zi.Load,storeOp:t.storeOp||Cl.Store,clearValue:x})}return c.depthStencilView&&(h.depthStencilAttachment={view:c.depthStencilView}),h}beginRender(e){const t=this.get(e),n=this.device,r=e.occlusionQueryCount;let i;r>0&&(t.currentOcclusionQuerySet&&t.currentOcclusionQuerySet.destroy(),t.currentOcclusionQueryBuffer&&t.currentOcclusionQueryBuffer.destroy(),t.currentOcclusionQuerySet=t.occlusionQuerySet,t.currentOcclusionQueryBuffer=t.occlusionQueryBuffer,t.currentOcclusionQueryObjects=t.occlusionQueryObjects,i=n.createQuerySet({type:"occlusion",count:r,label:`occlusionQuerySet_${e.id}`}),t.occlusionQuerySet=i,t.occlusionQueryIndex=0,t.occlusionQueryObjects=new Array(r),t.lastOcclusionObject=null);let a;e.textures===null?a=this._getDefaultRenderPassDescriptor():a=this._getRenderPassDescriptor(e,{loadOp:Zi.Load}),this.initTimestampQuery(e,a),a.occlusionQuerySet=i;const c=a.depthStencilAttachment;if(e.textures!==null){const p=a.colorAttachments;for(let v=0;v<p.length;v++){const x=p[v];e.clearColor?(x.clearValue=v===0?e.clearColorValue:{r:0,g:0,b:0,a:1},x.loadOp=Zi.Clear):x.loadOp=Zi.Load,x.storeOp=Cl.Store}}else{const p=a.colorAttachments[0];e.clearColor?(p.clearValue=e.clearColorValue,p.loadOp=Zi.Clear):p.loadOp=Zi.Load,p.storeOp=Cl.Store}e.depth&&(e.clearDepth?(c.depthClearValue=e.clearDepthValue,c.depthLoadOp=Zi.Clear):c.depthLoadOp=Zi.Load,c.depthStoreOp=Cl.Store),e.stencil&&(e.clearStencil?(c.stencilClearValue=e.clearStencilValue,c.stencilLoadOp=Zi.Clear):c.stencilLoadOp=Zi.Load,c.stencilStoreOp=Cl.Store);const h=n.createCommandEncoder({label:"renderContext_"+e.id});if(this._isRenderCameraDepthArray(e)===!0){const p=e.camera.cameras;!t.layerDescriptors||t.layerDescriptors.length!==p.length?this._createDepthLayerDescriptors(e,t,a,p):this._updateDepthLayerDescriptors(e,t,p),t.bundleEncoders=[],t.bundleSets=[];for(let v=0;v<p.length;v++){const x=this.pipelineUtils.createBundleEncoder(e,"renderBundleArrayCamera_"+v),S={attributes:{},bindingGroups:[],pipeline:null,index:null};t.bundleEncoders.push(x),t.bundleSets.push(S)}t.currentPass=null}else{const p=h.beginRenderPass(a);if(t.currentPass=p,e.viewport&&this.updateViewport(e),e.scissor){const{x:v,y:x,width:S,height:C}=e.scissorValue;p.setScissorRect(v,x,S,C)}}t.descriptor=a,t.encoder=h,t.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.renderBundles=[]}_createDepthLayerDescriptors(e,t,n,r){const i=n.depthStencilAttachment;t.layerDescriptors=[];const a=this.get(e.depthTexture);a.viewCache||(a.viewCache=[]);for(let c=0;c<r.length;c++){const h={...n,colorAttachments:[{...n.colorAttachments[0],view:n.colorAttachments[c].view}]};if(n.depthStencilAttachment){const p=c;a.viewCache[p]||(a.viewCache[p]=a.texture.createView({dimension:Fa.TwoD,baseArrayLayer:c,arrayLayerCount:1})),h.depthStencilAttachment={view:a.viewCache[p],depthLoadOp:i.depthLoadOp||Zi.Clear,depthStoreOp:i.depthStoreOp||Cl.Store,depthClearValue:i.depthClearValue||1},e.stencil&&(h.depthStencilAttachment.stencilLoadOp=i.stencilLoadOp,h.depthStencilAttachment.stencilStoreOp=i.stencilStoreOp,h.depthStencilAttachment.stencilClearValue=i.stencilClearValue)}else h.depthStencilAttachment={...i};t.layerDescriptors.push(h)}}_updateDepthLayerDescriptors(e,t,n){for(let r=0;r<n.length;r++){const i=t.layerDescriptors[r];if(i.depthStencilAttachment){const a=i.depthStencilAttachment;e.depth&&(e.clearDepth?(a.depthClearValue=e.clearDepthValue,a.depthLoadOp=Zi.Clear):a.depthLoadOp=Zi.Load),e.stencil&&(e.clearStencil?(a.stencilClearValue=e.clearStencilValue,a.stencilLoadOp=Zi.Clear):a.stencilLoadOp=Zi.Load)}}}finishRender(e){const t=this.get(e),n=e.occlusionQueryCount;t.renderBundles.length>0&&t.currentPass.executeBundles(t.renderBundles),n>t.occlusionQueryIndex&&t.currentPass.endOcclusionQuery();const r=t.encoder;if(this._isRenderCameraDepthArray(e)===!0){const i=[];for(let a=0;a<t.bundleEncoders.length;a++){const c=t.bundleEncoders[a];i.push(c.finish())}for(let a=0;a<t.layerDescriptors.length;a++)if(a<i.length){const c=t.layerDescriptors[a],h=r.beginRenderPass(c);if(e.viewport){const{x:p,y:v,width:x,height:S,minDepth:C,maxDepth:I}=e.viewportValue;h.setViewport(p,v,x,S,C,I)}if(e.scissor){const{x:p,y:v,width:x,height:S}=e.scissorValue;h.setScissorRect(p,v,x,S)}h.executeBundles([i[a]]),h.end()}}else t.currentPass&&t.currentPass.end();if(n>0){const i=n*8;let a=this.occludedResolveCache.get(i);a===void 0&&(a=this.device.createBuffer({size:i,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),this.occludedResolveCache.set(i,a));const c=this.device.createBuffer({size:i,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});t.encoder.resolveQuerySet(t.occlusionQuerySet,0,n,a,0),t.encoder.copyBufferToBuffer(a,0,c,0,i),t.occlusionQueryBuffer=c,this.resolveOccludedAsync(e)}if(this.device.queue.submit([t.encoder.finish()]),e.textures!==null){const i=e.textures;for(let a=0;a<i.length;a++){const c=i[a];c.generateMipmaps===!0&&this.textureUtils.generateMipmaps(c)}}}isOccluded(e,t){const n=this.get(e);return n.occluded&&n.occluded.has(t)}async resolveOccludedAsync(e){const t=this.get(e),{currentOcclusionQueryBuffer:n,currentOcclusionQueryObjects:r}=t;if(n&&r){const i=new WeakSet;t.currentOcclusionQueryObjects=null,t.currentOcclusionQueryBuffer=null,await n.mapAsync(GPUMapMode.READ);const a=n.getMappedRange(),c=new BigUint64Array(a);for(let h=0;h<r.length;h++)c[h]===BigInt(0)&&i.add(r[h]);n.destroy(),t.occluded=i}}updateViewport(e){const{currentPass:t}=this.get(e),{x:n,y:r,width:i,height:a,minDepth:c,maxDepth:h}=e.viewportValue;t.setViewport(n,r,i,a,c,h)}getClearColor(){const e=super.getClearColor();return this.renderer.alpha===!0&&(e.r*=e.a,e.g*=e.a,e.b*=e.a),e}clear(e,t,n,r=null){const i=this.device,a=this.renderer;let c=[],h,p,v,x;if(e){const I=this.getClearColor();p={r:I.r,g:I.g,b:I.b,a:I.a}}if(r===null){v=a.depth,x=a.stencil;const I=this._getDefaultRenderPassDescriptor();if(e){c=I.colorAttachments;const L=c[0];L.clearValue=p,L.loadOp=Zi.Clear,L.storeOp=Cl.Store}(v||x)&&(h=I.depthStencilAttachment)}else{v=r.depth,x=r.stencil;const I={loadOp:e?Zi.Clear:Zi.Load,clearValue:e?p:void 0};v&&(I.depthLoadOp=t?Zi.Clear:Zi.Load,I.depthClearValue=t?a.getClearDepth():void 0,I.depthStoreOp=Cl.Store),x&&(I.stencilLoadOp=n?Zi.Clear:Zi.Load,I.stencilClearValue=n?a.getClearStencil():void 0,I.stencilStoreOp=Cl.Store);const L=this._getRenderPassDescriptor(r,I);c=L.colorAttachments,h=L.depthStencilAttachment}v&&h&&h.depthLoadOp===void 0&&(t?(h.depthLoadOp=Zi.Clear,h.depthClearValue=a.getClearDepth(),h.depthStoreOp=Cl.Store):(h.depthLoadOp=Zi.Load,h.depthStoreOp=Cl.Store)),x&&h&&h.stencilLoadOp===void 0&&(n?(h.stencilLoadOp=Zi.Clear,h.stencilClearValue=a.getClearStencil(),h.stencilStoreOp=Cl.Store):(h.stencilLoadOp=Zi.Load,h.stencilStoreOp=Cl.Store));const S=i.createCommandEncoder({label:"clear"});S.beginRenderPass({colorAttachments:c,depthStencilAttachment:h}).end(),i.queue.submit([S.finish()])}beginCompute(e){const t=this.get(e),n={label:"computeGroup_"+e.id};this.initTimestampQuery(e,n),t.cmdEncoderGPU=this.device.createCommandEncoder({label:"computeGroup_"+e.id}),t.passEncoderGPU=t.cmdEncoderGPU.beginComputePass(n)}compute(e,t,n,r){const{passEncoderGPU:i}=this.get(e),a=this.get(r).pipeline;this.pipelineUtils.setPipeline(i,a);for(let v=0,x=n.length;v<x;v++){const S=n[v],C=this.get(S);i.setBindGroup(v,C.group)}const c=this.device.limits.maxComputeWorkgroupsPerDimension,h=this.get(t);h.dispatchSize===void 0&&(h.dispatchSize={x:0,y:1,z:1});const{dispatchSize:p}=h;t.dispatchCount>c?(p.x=Math.min(t.dispatchCount,c),p.y=Math.ceil(t.dispatchCount/c)):p.x=t.dispatchCount,i.dispatchWorkgroups(p.x,p.y,p.z)}finishCompute(e){const t=this.get(e);t.passEncoderGPU.end(),this.device.queue.submit([t.cmdEncoderGPU.finish()])}async waitForGPU(){await this.device.queue.onSubmittedWorkDone()}draw(e,t){const{object:n,material:r,context:i,pipeline:a}=e,c=e.getBindings(),h=this.get(i),p=this.get(a).pipeline,v=e.getIndex(),x=v!==null,S=e.getDrawParameters();if(S===null)return;const C=(L,U)=>{this.pipelineUtils.setPipeline(L,p),U.pipeline=p;const R=U.bindingGroups;for(let Z=0,k=c.length;Z<k;Z++){const ie=c[Z],ue=this.get(ie);R[ie.index]!==ie.id&&(L.setBindGroup(ie.index,ue.group),R[ie.index]=ie.id)}if(x===!0&&U.index!==v){const Z=this.get(v).buffer,k=v.array instanceof Uint16Array?q_.Uint16:q_.Uint32;L.setIndexBuffer(Z,k),U.index=v}const $=e.getVertexBuffers();for(let Z=0,k=$.length;Z<k;Z++){const ie=$[Z];if(U.attributes[Z]!==ie){const ue=this.get(ie).buffer;L.setVertexBuffer(Z,ue),U.attributes[Z]=ie}}i.stencil===!0&&r.stencilWrite===!0&&h.currentStencilRef!==r.stencilRef&&(L.setStencilReference(r.stencilRef),h.currentStencilRef=r.stencilRef)},I=(L,U)=>{if(C(L,U),n.isBatchedMesh===!0){const R=n._multiDrawStarts,$=n._multiDrawCounts,Z=n._multiDrawCount,k=n._multiDrawInstances;k!==null&&Ng("THREE.WebGPUBackend: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection.");for(let ie=0;ie<Z;ie++){const ue=k?k[ie]:1,ce=ue>1?0:ie;x===!0?L.drawIndexed($[ie],ue,R[ie]/v.array.BYTES_PER_ELEMENT,0,ce):L.draw($[ie],ue,R[ie],ce),t.update(n,$[ie],ue)}}else if(x===!0){const{vertexCount:R,instanceCount:$,firstVertex:Z}=S,k=e.getIndirect();if(k!==null){const ie=this.get(k).buffer;L.drawIndexedIndirect(ie,0)}else L.drawIndexed(R,$,Z,0,0);t.update(n,R,$)}else{const{vertexCount:R,instanceCount:$,firstVertex:Z}=S,k=e.getIndirect();if(k!==null){const ie=this.get(k).buffer;L.drawIndirect(ie,0)}else L.draw(R,$,Z,0);t.update(n,R,$)}};if(e.camera.isArrayCamera&&e.camera.cameras.length>0){const L=this.get(e.camera),U=e.camera.cameras,R=e.getBindingGroup("cameraIndex");if(L.indexesGPU===void 0||L.indexesGPU.length!==U.length){const Z=this.get(R),k=[],ie=new Uint32Array([0,0,0,0]);for(let ue=0,ce=U.length;ue<ce;ue++){ie[0]=ue;const Q=this.bindingUtils.createBindGroupIndex(ie,Z.layout);k.push(Q)}L.indexesGPU=k}const $=this.renderer.getPixelRatio();for(let Z=0,k=U.length;Z<k;Z++){const ie=U[Z];if(n.layers.test(ie.layers)){const ue=ie.viewport;let ce=h.currentPass,Q=h.currentSets;if(h.bundleEncoders){const ae=h.bundleEncoders[Z],le=h.bundleSets[Z];ce=ae,Q=le}ue&&ce.setViewport(Math.floor(ue.x*$),Math.floor(ue.y*$),Math.floor(ue.width*$),Math.floor(ue.height*$),i.viewportValue.minDepth,i.viewportValue.maxDepth),R&&L.indexesGPU&&(ce.setBindGroup(R.index,L.indexesGPU[Z]),Q.bindingGroups[R.index]=R.id),I(ce,Q)}}}else if(h.currentPass){if(h.occlusionQuerySet!==void 0){const L=h.lastOcclusionObject;L!==n&&(L!==null&&L.occlusionTest===!0&&(h.currentPass.endOcclusionQuery(),h.occlusionQueryIndex++),n.occlusionTest===!0&&(h.currentPass.beginOcclusionQuery(h.occlusionQueryIndex),h.occlusionQueryObjects[h.occlusionQueryIndex]=n),h.lastOcclusionObject=n)}I(h.currentPass,h.currentSets)}}needsRenderUpdate(e){const t=this.get(e),{object:n,material:r}=e,i=this.utils,a=i.getSampleCountRenderContext(e.context),c=i.getCurrentColorSpace(e.context),h=i.getCurrentColorFormat(e.context),p=i.getCurrentDepthStencilFormat(e.context),v=i.getPrimitiveTopology(n,r);let x=!1;return(t.material!==r||t.materialVersion!==r.version||t.transparent!==r.transparent||t.blending!==r.blending||t.premultipliedAlpha!==r.premultipliedAlpha||t.blendSrc!==r.blendSrc||t.blendDst!==r.blendDst||t.blendEquation!==r.blendEquation||t.blendSrcAlpha!==r.blendSrcAlpha||t.blendDstAlpha!==r.blendDstAlpha||t.blendEquationAlpha!==r.blendEquationAlpha||t.colorWrite!==r.colorWrite||t.depthWrite!==r.depthWrite||t.depthTest!==r.depthTest||t.depthFunc!==r.depthFunc||t.stencilWrite!==r.stencilWrite||t.stencilFunc!==r.stencilFunc||t.stencilFail!==r.stencilFail||t.stencilZFail!==r.stencilZFail||t.stencilZPass!==r.stencilZPass||t.stencilFuncMask!==r.stencilFuncMask||t.stencilWriteMask!==r.stencilWriteMask||t.side!==r.side||t.alphaToCoverage!==r.alphaToCoverage||t.sampleCount!==a||t.colorSpace!==c||t.colorFormat!==h||t.depthStencilFormat!==p||t.primitiveTopology!==v||t.clippingContextCacheKey!==e.clippingContextCacheKey)&&(t.material=r,t.materialVersion=r.version,t.transparent=r.transparent,t.blending=r.blending,t.premultipliedAlpha=r.premultipliedAlpha,t.blendSrc=r.blendSrc,t.blendDst=r.blendDst,t.blendEquation=r.blendEquation,t.blendSrcAlpha=r.blendSrcAlpha,t.blendDstAlpha=r.blendDstAlpha,t.blendEquationAlpha=r.blendEquationAlpha,t.colorWrite=r.colorWrite,t.depthWrite=r.depthWrite,t.depthTest=r.depthTest,t.depthFunc=r.depthFunc,t.stencilWrite=r.stencilWrite,t.stencilFunc=r.stencilFunc,t.stencilFail=r.stencilFail,t.stencilZFail=r.stencilZFail,t.stencilZPass=r.stencilZPass,t.stencilFuncMask=r.stencilFuncMask,t.stencilWriteMask=r.stencilWriteMask,t.side=r.side,t.alphaToCoverage=r.alphaToCoverage,t.sampleCount=a,t.colorSpace=c,t.colorFormat=h,t.depthStencilFormat=p,t.primitiveTopology=v,t.clippingContextCacheKey=e.clippingContextCacheKey,x=!0),x}getRenderCacheKey(e){const{object:t,material:n}=e,r=this.utils,i=e.context;return[n.transparent,n.blending,n.premultipliedAlpha,n.blendSrc,n.blendDst,n.blendEquation,n.blendSrcAlpha,n.blendDstAlpha,n.blendEquationAlpha,n.colorWrite,n.depthWrite,n.depthTest,n.depthFunc,n.stencilWrite,n.stencilFunc,n.stencilFail,n.stencilZFail,n.stencilZPass,n.stencilFuncMask,n.stencilWriteMask,n.side,r.getSampleCountRenderContext(i),r.getCurrentColorSpace(i),r.getCurrentColorFormat(i),r.getCurrentDepthStencilFormat(i),r.getPrimitiveTopology(t,n),e.getGeometryCacheKey(),e.clippingContextCacheKey].join()}createSampler(e){this.textureUtils.createSampler(e)}destroySampler(e){this.textureUtils.destroySampler(e)}createDefaultTexture(e){this.textureUtils.createDefaultTexture(e)}createTexture(e,t){this.textureUtils.createTexture(e,t)}updateTexture(e,t){this.textureUtils.updateTexture(e,t)}generateMipmaps(e){this.textureUtils.generateMipmaps(e)}destroyTexture(e){this.textureUtils.destroyTexture(e)}async copyTextureToBuffer(e,t,n,r,i,a){return this.textureUtils.copyTextureToBuffer(e,t,n,r,i,a)}initTimestampQuery(e,t){if(!this.trackTimestamp)return;const n=e.isComputeNode?"compute":"render";this.timestampQueryPool[n]||(this.timestampQueryPool[n]=new TGe(this.device,n,2048));const r=this.timestampQueryPool[n],i=r.allocateQueriesForContext(e);t.timestampWrites={querySet:r.querySet,beginningOfPassWriteIndex:i,endOfPassWriteIndex:i+1}}createNodeBuilder(e,t){return new yGe(e,t)}createProgram(e){const t=this.get(e);t.module={module:this.device.createShaderModule({code:e.code,label:e.stage+(e.name!==""?`_${e.name}`:"")}),entryPoint:"main"}}destroyProgram(e){this.delete(e)}createRenderPipeline(e,t){this.pipelineUtils.createRenderPipeline(e,t)}createComputePipeline(e,t){this.pipelineUtils.createComputePipeline(e,t)}beginBundle(e){const t=this.get(e);t._currentPass=t.currentPass,t._currentSets=t.currentSets,t.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.currentPass=this.pipelineUtils.createBundleEncoder(e)}finishBundle(e,t){const n=this.get(e),i=n.currentPass.finish();this.get(t).bundleGPU=i,n.currentSets=n._currentSets,n.currentPass=n._currentPass}addBundle(e,t){this.get(e).renderBundles.push(this.get(t).bundleGPU)}createBindings(e,t,n,r){this.bindingUtils.createBindings(e,t,n,r)}updateBindings(e,t,n,r){this.bindingUtils.createBindings(e,t,n,r)}updateBinding(e){this.bindingUtils.updateBinding(e)}createIndexAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.INDEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createStorageAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.STORAGE|GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createIndirectStorageAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.STORAGE|GPUBufferUsage.INDIRECT|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}updateAttribute(e){this.attributeUtils.updateAttribute(e)}destroyAttribute(e){this.attributeUtils.destroyAttribute(e)}updateSize(){this.colorBuffer=this.textureUtils.getColorBuffer(),this.defaultRenderPassdescriptor=null}getMaxAnisotropy(){return 16}hasFeature(e){return this.device.features.has(e)}copyTextureToTexture(e,t,n=null,r=null,i=0,a=0){let c=0,h=0,p=0,v=0,x=0,S=0,C=e.image.width,I=e.image.height,L=1;n!==null&&(n.isBox3===!0?(v=n.min.x,x=n.min.y,S=n.min.z,C=n.max.x-n.min.x,I=n.max.y-n.min.y,L=n.max.z-n.min.z):(v=n.min.x,x=n.min.y,C=n.max.x-n.min.x,I=n.max.y-n.min.y,L=1)),r!==null&&(c=r.x,h=r.y,p=r.z||0);const U=this.device.createCommandEncoder({label:"copyTextureToTexture_"+e.id+"_"+t.id}),R=this.get(e).texture,$=this.get(t).texture;U.copyTextureToTexture({texture:R,mipLevel:i,origin:{x:v,y:x,z:S}},{texture:$,mipLevel:a,origin:{x:c,y:h,z:p}},[C,I,L]),this.device.queue.submit([U.finish()]),a===0&&t.generateMipmaps&&this.textureUtils.generateMipmaps(t)}copyFramebufferToTexture(e,t,n){const r=this.get(t);let i=null;t.renderTarget?e.isDepthTexture?i=this.get(t.depthTexture).texture:i=this.get(t.textures[0]).texture:e.isDepthTexture?i=this.textureUtils.getDepthBuffer(t.depth,t.stencil):i=this.context.getCurrentTexture();const a=this.get(e).texture;if(i.format!==a.format){console.error("WebGPUBackend: copyFramebufferToTexture: Source and destination formats do not match.",i.format,a.format);return}let c;if(r.currentPass?(r.currentPass.end(),c=r.encoder):c=this.device.createCommandEncoder({label:"copyFramebufferToTexture_"+e.id}),c.copyTextureToTexture({texture:i,origin:[n.x,n.y,0]},{texture:a},[n.z,n.w]),r.currentPass){const{descriptor:h}=r;for(let p=0;p<h.colorAttachments.length;p++)h.colorAttachments[p].loadOp=Zi.Load;if(t.depth&&(h.depthStencilAttachment.depthLoadOp=Zi.Load),t.stencil&&(h.depthStencilAttachment.stencilLoadOp=Zi.Load),r.currentPass=c.beginRenderPass(h),r.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.viewport&&this.updateViewport(t),t.scissor){const{x:p,y:v,width:x,height:S}=t.scissorValue;r.currentPass.setScissorRect(p,v,x,S)}}else this.device.queue.submit([c.finish()]);e.generateMipmaps&&this.textureUtils.generateMipmaps(e)}}class CGe extends Tc{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new qi(16777215),this.specular=new qi(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new qi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Y3,this.normalScale=new pi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new kh,this.combine=SI,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}const AGe=new CGe;class PGe extends sa{static get type(){return"MeshPhongNodeMaterial"}constructor(e){super(),this.isMeshPhongNodeMaterial=!0,this.lights=!0,this.shininessNode=null,this.specularNode=null,this.setDefaultValues(AGe),this.setValues(e)}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new zW(t):null}setupLightingModel(){return new d5e}setupVariants(){const e=(this.shininessNode?$t(this.shininessNode):wLe).max(1e-4);Wj.assign(e);const t=this.specularNode||TLe;_u.assign(t)}copy(e){return this.shininessNode=e.shininessNode,this.specularNode=e.specularNode,super.copy(e)}}class T5e extends Tc{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new qi(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new qi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Y3,this.normalScale=new pi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new kh,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}const RGe=new T5e;class M5e extends sa{static get type(){return"MeshStandardNodeMaterial"}constructor(e){super(),this.isMeshStandardNodeMaterial=!0,this.lights=!0,this.emissiveNode=null,this.metalnessNode=null,this.roughnessNode=null,this.setDefaultValues(RGe),this.setValues(e)}setupEnvironment(e){let t=super.setupEnvironment(e);return t===null&&e.environmentNode&&(t=e.environmentNode),t?new Hze(t):null}setupLightingModel(){return new p5e}setupSpecular(){const e=Zs(Yt(.04),$i.rgb,oI);_u.assign(e),lI.assign(1)}setupVariants(){const e=this.metalnessNode?$t(this.metalnessNode):ALe;oI.assign(e);let t=this.roughnessNode?$t(this.roughnessNode):CLe;t=n5e({roughness:t}),vg.assign(t),this.setupSpecular(),$i.assign(ei($i.rgb.mul(e.oneMinus()),$i.a))}copy(e){return this.emissiveNode=e.emissiveNode,this.metalnessNode=e.metalnessNode,this.roughnessNode=e.roughnessNode,super.copy(e)}}class kGe extends T5e{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new pi(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return wi(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new qi(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new qi(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new qi(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}const IGe=new kGe;class NGe extends M5e{static get type(){return"MeshPhysicalNodeMaterial"}constructor(e){super(),this.isMeshPhysicalNodeMaterial=!0,this.clearcoatNode=null,this.clearcoatRoughnessNode=null,this.clearcoatNormalNode=null,this.sheenNode=null,this.sheenRoughnessNode=null,this.iridescenceNode=null,this.iridescenceIORNode=null,this.iridescenceThicknessNode=null,this.specularIntensityNode=null,this.specularColorNode=null,this.iorNode=null,this.transmissionNode=null,this.thicknessNode=null,this.attenuationDistanceNode=null,this.attenuationColorNode=null,this.dispersionNode=null,this.anisotropyNode=null,this.setDefaultValues(IGe),this.setValues(e)}get useClearcoat(){return this.clearcoat>0||this.clearcoatNode!==null}get useIridescence(){return this.iridescence>0||this.iridescenceNode!==null}get useSheen(){return this.sheen>0||this.sheenNode!==null}get useAnisotropy(){return this.anisotropy>0||this.anisotropyNode!==null}get useTransmission(){return this.transmission>0||this.transmissionNode!==null}get useDispersion(){return this.dispersion>0||this.dispersionNode!==null}setupSpecular(){const e=this.iorNode?$t(this.iorNode):GLe;Ck.assign(e),_u.assign(Zs(H_(h4e(Ck.sub(1).div(Ck.add(1))).mul(MLe),Yt(1)).mul(Yme),$i.rgb,oI)),lI.assign(Zs(Yme,1,oI))}setupLightingModel(){return new p5e(this.useClearcoat,this.useSheen,this.useIridescence,this.useAnisotropy,this.useTransmission,this.useDispersion)}setupVariants(e){if(super.setupVariants(e),this.useClearcoat){const t=this.clearcoatNode?$t(this.clearcoatNode):RLe,n=this.clearcoatRoughnessNode?$t(this.clearcoatRoughnessNode):kLe;jj.assign(t),aI.assign(n5e({roughness:n}))}if(this.useSheen){const t=this.sheenNode?Yt(this.sheenNode):DLe,n=this.sheenRoughnessNode?$t(this.sheenRoughnessNode):OLe;m_.assign(t),gW.assign(n)}if(this.useIridescence){const t=this.iridescenceNode?$t(this.iridescenceNode):LLe,n=this.iridescenceIORNode?$t(this.iridescenceIORNode):BLe,r=this.iridescenceThicknessNode?$t(this.iridescenceThicknessNode):ULe;yW.assign(t),K3e.assign(n),Z3e.assign(r)}if(this.useAnisotropy){const t=(this.anisotropyNode?In(this.anisotropyNode):FLe).toVar();t6.assign(t.length()),Wo(t6.equal(0),()=>{t.assign(In(1,0))}).Else(()=>{t.divAssign(In(t6)),t6.assign(t6.saturate())}),Hj.assign(t6.pow2().mix(vg.pow2(),1)),Mk.assign(Ww[0].mul(t.x).add(Ww[1].mul(t.y))),A_.assign(Ww[1].mul(t.x).sub(Ww[0].mul(t.y)))}if(this.useTransmission){const t=this.transmissionNode?$t(this.transmissionNode):zLe,n=this.thicknessNode?$t(this.thicknessNode):VLe,r=this.attenuationDistanceNode?$t(this.attenuationDistanceNode):jLe,i=this.attenuationColorNode?Yt(this.attenuationColorNode):HLe;if($j.assign(t),Q3e.assign(n),J3e.assign(r),e4e.assign(i),this.useDispersion){const a=this.dispersionNode?$t(this.dispersionNode):KLe;t4e.assign(a)}}}setupClearcoatNormal(){return this.clearcoatNormalNode?Yt(this.clearcoatNormalNode):ILe}setup(e){e.context.setupClearcoatNormal=()=>this.setupClearcoatNormal(e),super.setup(e)}copy(e){return this.clearcoatNode=e.clearcoatNode,this.clearcoatRoughnessNode=e.clearcoatRoughnessNode,this.clearcoatNormalNode=e.clearcoatNormalNode,this.sheenNode=e.sheenNode,this.sheenRoughnessNode=e.sheenRoughnessNode,this.iridescenceNode=e.iridescenceNode,this.iridescenceIORNode=e.iridescenceIORNode,this.iridescenceThicknessNode=e.iridescenceThicknessNode,this.specularIntensityNode=e.specularIntensityNode,this.specularColorNode=e.specularColorNode,this.transmissionNode=e.transmissionNode,this.thicknessNode=e.thicknessNode,this.attenuationDistanceNode=e.attenuationDistanceNode,this.attenuationColorNode=e.attenuationColorNode,this.dispersionNode=e.dispersionNode,this.anisotropyNode=e.anisotropyNode,super.copy(e)}}const DGe=cn(({normal:o,lightDirection:e,builder:t})=>{const n=o.dot(e),r=In(n.mul(.5).add(.5),0);if(t.material.gradientMap){const i=j3("gradientMap","texture").context({getUV:()=>r});return Yt(i.r)}else{const i=r.fwidth().mul(.5);return Zs(Yt(.7),Yt(1),Z3($t(.7).sub(i.x),$t(.7).add(i.x),r.x))}});class OGe extends UI{direct({lightDirection:e,lightColor:t,reflectedLight:n},r){const i=DGe({normal:M4e,lightDirection:e,builder:r}).mul(t);n.directDiffuse.addAssign(i.mul($_({diffuseColor:$i.rgb})))}indirect(e){const{ambientOcclusion:t,irradiance:n,reflectedLight:r}=e.context;r.indirectDiffuse.addAssign(n.mul($_({diffuseColor:$i}))),r.indirectDiffuse.mulAssign(t)}}class FGe extends Tc{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new qi(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new qi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Y3,this.normalScale=new pi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const LGe=new FGe;class BGe extends sa{static get type(){return"MeshToonNodeMaterial"}constructor(e){super(),this.isMeshToonNodeMaterial=!0,this.lights=!0,this.setDefaultValues(LGe),this.setValues(e)}setupLightingModel(){return new OGe}}class UGe extends sx{static get type(){return"BasicLightMapNode"}constructor(e=null){super(),this.lightMapNode=e}setup(e){const t=$t(1/Math.PI);e.context.irradianceLightMap=this.lightMapNode.mul(t)}}const zGe=new H3;class VGe extends sa{static get type(){return"MeshBasicNodeMaterial"}constructor(e){super(),this.isMeshBasicNodeMaterial=!0,this.lights=!0,this.setDefaultValues(zGe),this.setValues(e)}setupNormal(){return s1}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new zW(t):null}setupLightMap(e){let t=null;return e.material.lightMap&&(t=new UGe(z4e)),t}setupOutgoingLight(){return $i.rgb}setupLightingModel(){return new h5e}}class GGe extends Tc{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new qi(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new qi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Y3,this.normalScale=new pi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new kh,this.combine=SI,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}const jGe=new GGe;class HGe extends sa{static get type(){return"MeshLambertNodeMaterial"}constructor(e){super(),this.isMeshLambertNodeMaterial=!0,this.lights=!0,this.setDefaultValues(jGe),this.setValues(e)}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new zW(t):null}setupLightingModel(){return new d5e(!1)}}class WGe extends Tc{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Y3,this.normalScale=new pi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}const $Ge=new WGe;class qGe extends sa{static get type(){return"MeshNormalNodeMaterial"}constructor(e){super(),this.isMeshNormalNodeMaterial=!0,this.setDefaultValues($Ge),this.setValues(e)}setupDiffuseColor(){const e=this.opacityNode?$t(this.opacityNode):U4e;$i.assign(EW(ei(jFe(ra),e),xu))}}class XGe extends Tc{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new qi(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Y3,this.normalScale=new pi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}const YGe=new XGe;class KGe extends sa{static get type(){return"MeshMatcapNodeMaterial"}constructor(e){super(),this.isMeshMatcapNodeMaterial=!0,this.setDefaultValues(YGe),this.setValues(e)}setupVariants(e){const t=zFe;let n;e.material.matcap?n=j3("matcap","texture").context({getUV:()=>t}):n=Yt(Zs(.2,.8,t.y)),$i.rgb.mulAssign(n.rgb)}}class C5e extends Tc{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new qi(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const ZGe=new C5e;class QGe extends sa{static get type(){return"LineBasicNodeMaterial"}constructor(e){super(),this.isLineBasicNodeMaterial=!0,this.setDefaultValues(ZGe),this.setValues(e)}}class JGe extends C5e{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}const eje=new JGe;class tje extends sa{static get type(){return"LineDashedNodeMaterial"}constructor(e){super(),this.isLineDashedNodeMaterial=!0,this.setDefaultValues(eje),this.dashOffset=0,this.offsetNode=null,this.dashScaleNode=null,this.dashSizeNode=null,this.gapSizeNode=null,this.setValues(e)}setupVariants(){const e=this.offsetNode?$t(this.offsetNode):XLe,t=this.dashScaleNode?$t(this.dashScaleNode):WLe,n=this.dashSizeNode?$t(this.dashSizeNode):$Le,r=this.gapSizeNode?$t(this.gapSizeNode):qLe;iV.assign(n),Bme.assign(r);const i=xf(Q3("lineDistance").mul(t));(e?i.add(e):i).mod(iV.add(Bme)).greaterThan(iV).discard()}}class nje extends Tc{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new qi(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const rje=new nje;class A5e extends sa{static get type(){return"SpriteNodeMaterial"}constructor(e){super(),this.isSpriteNodeMaterial=!0,this._useSizeAttenuation=!0,this.positionNode=null,this.rotationNode=null,this.scaleNode=null,this.transparent=!0,this.setDefaultValues(rje),this.setValues(e)}setupPositionView(e){const{object:t,camera:n}=e,r=this.sizeAttenuation,{positionNode:i,rotationNode:a,scaleNode:c}=this,h=kI.mul(Yt(i||0));let p=In(E6[0].xyz.length(),E6[1].xyz.length());if(c!==null&&(p=p.mul(In(c))),r===!1)if(n.isPerspectiveCamera)p=p.mul(h.z.negate());else{const C=$t(2).div(AW.element(1).element(1));p=p.mul(C.mul(2))}let v=II.xy;if(t.center&&t.center.isVector2===!0){const C=JOe("center","vec2",t);v=v.sub(C.sub(.5))}v=v.mul(p);const x=$t(a||NLe),S=A4e(v,x);return ei(h.xy.add(S),h.zw)}copy(e){return this.positionNode=e.positionNode,this.rotationNode=e.rotationNode,this.scaleNode=e.scaleNode,super.copy(e)}get sizeAttenuation(){return this._useSizeAttenuation}set sizeAttenuation(e){this._useSizeAttenuation!==e&&(this._useSizeAttenuation=e,this.needsUpdate=!0)}}class ije extends Tc{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new qi(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const sje=new ije;class oje extends A5e{static get type(){return"PointsNodeMaterial"}constructor(e){super(),this.sizeNode=null,this.isPointsNodeMaterial=!0,this.setDefaultValues(sje),this.setValues(e)}setupPositionView(){const{positionNode:e}=this;return kI.mul(Yt(e||z0)).xyz}setupVertex(e){const t=super.setupVertex(e);if(e.material.isNodeMaterial!==!0)return t;const{rotationNode:n,scaleNode:r,sizeNode:i}=this,a=II.xy.toVar(),c=aE.z.div(aE.w);if(n&&n.isNode){const p=$t(n);a.assign(A4e(a,p))}let h=i!==null?In(i):YLe;return this.sizeAttenuation===!0&&(h=h.mul(h.div(ia.z.negate()))),r&&r.isNode&&(h=h.mul(In(r))),a.mulAssign(h.mul(2)),a.assign(a.div(aE.z)),a.y.assign(a.y.mul(c)),a.assign(a.mul(t.w)),t.addAssign(ei(a,0,0)),t}get alphaToCoverage(){return this._useAlphaToCoverage}set alphaToCoverage(e){this._useAlphaToCoverage!==e&&(this._useAlphaToCoverage=e,this.needsUpdate=!0)}}class aje extends UI{constructor(){super(),this.shadowNode=$t(1).toVar("shadowMask")}direct({lightNode:e}){e.shadowNode!==null&&this.shadowNode.mulAssign(e.shadowNode)}finish({context:e}){$i.a.mulAssign(this.shadowNode.oneMinus()),e.outgoingLight.rgb.assign($i.rgb)}}class lje extends Tc{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new qi(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}const cje=new lje;class uje extends sa{static get type(){return"ShadowNodeMaterial"}constructor(e){super(),this.isShadowNodeMaterial=!0,this.lights=!0,this.transparent=!0,this.setDefaultValues(cje),this.setValues(e)}setupLightingModel(){return new aje}}class P6 extends va{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new qi(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(t.object.target=this.target.uuid),t}}const tG=new Ts,l2e=new yt,c2e=new yt;class qW{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new pi(512,512),this.mapType=Il,this.map=null,this.mapPass=null,this.matrix=new Ts,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new HW,this._frameExtents=new pi(1,1),this._viewportCount=1,this._viewports=[new Ri(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;l2e.setFromMatrixPosition(e.matrixWorld),t.position.copy(l2e),c2e.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(c2e),t.updateMatrixWorld(),tG.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(tG),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(tG)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}const u2e=new Ts,Pw=new yt,nG=new yt;class hje extends qW{constructor(){super(new bu(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new pi(4,2),this._viewportCount=6,this._viewports=[new Ri(2,1,1,1),new Ri(0,1,1,1),new Ri(3,1,1,1),new Ri(1,1,1,1),new Ri(3,0,1,1),new Ri(1,0,1,1)],this._cubeDirections=[new yt(1,0,0),new yt(-1,0,0),new yt(0,0,1),new yt(0,0,-1),new yt(0,1,0),new yt(0,-1,0)],this._cubeUps=[new yt(0,1,0),new yt(0,1,0),new yt(0,1,0),new yt(0,1,0),new yt(0,0,1),new yt(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,r=this.matrix,i=e.distance||n.far;i!==n.far&&(n.far=i,n.updateProjectionMatrix()),Pw.setFromMatrixPosition(e.matrixWorld),n.position.copy(Pw),nG.copy(n.position),nG.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(nG),n.updateMatrixWorld(),r.makeTranslation(-Pw.x,-Pw.y,-Pw.z),u2e.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(u2e)}}class dje extends P6{constructor(e,t,n=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new hje}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class fje extends qW{constructor(){super(new NW(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class pje extends P6{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(va.DEFAULT_UP),this.updateMatrix(),this.target=new va,this.shadow=new fje}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class mje extends P6{constructor(e,t,n=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class gje extends qW{constructor(){super(new bu(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1,this.aspect=1}updateMatrices(e){const t=this.camera,n=U_*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height*this.aspect,i=e.distance||t.far;(n!==t.fov||r!==t.aspect||i!==t.far)&&(t.fov=n,t.aspect=r,t.far=i,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class XW extends P6{constructor(e,t,n=0,r=Math.PI/3,i=0,a=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(va.DEFAULT_UP),this.updateMatrix(),this.target=new va,this.distance=n,this.angle=r,this.penumbra=i,this.decay=a,this.map=null,this.shadow=new gje}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class yje extends P6{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class vje extends P6{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(va.DEFAULT_UP),this.updateMatrix(),this.groundColor=new qi(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}class _je{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new yt)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,r=e.y,i=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.282095),t.addScaledVector(a[1],.488603*r),t.addScaledVector(a[2],.488603*i),t.addScaledVector(a[3],.488603*n),t.addScaledVector(a[4],1.092548*(n*r)),t.addScaledVector(a[5],1.092548*(r*i)),t.addScaledVector(a[6],.315392*(3*i*i-1)),t.addScaledVector(a[7],1.092548*(n*i)),t.addScaledVector(a[8],.546274*(n*n-r*r)),t}getIrradianceAt(e,t){const n=e.x,r=e.y,i=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.886227),t.addScaledVector(a[1],2*.511664*r),t.addScaledVector(a[2],2*.511664*i),t.addScaledVector(a[3],2*.511664*n),t.addScaledVector(a[4],2*.429043*n*r),t.addScaledVector(a[5],2*.429043*r*i),t.addScaledVector(a[6],.743125*i*i-.247708),t.addScaledVector(a[7],2*.429043*n*i),t.addScaledVector(a[8],.429043*(n*n-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(e,t+r*3);return this}toArray(e=[],t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(e,t+r*3);return e}static getBasisAt(e,t){const n=e.x,r=e.y,i=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*i,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*i,t[6]=.315392*(3*i*i-1),t[7]=1.092548*n*i,t[8]=.546274*(n*n-r*r)}}class xje extends P6{constructor(e=new _je,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class bje extends XW{constructor(e,t,n,r,i,a){super(e,t,n,r,i,a),this.iesMap=null}copy(e,t){return super.copy(e,t),this.iesMap=e.iesMap,this}}class Sje extends XW{constructor(e,t,n,r,i,a){super(e,t,n,r,i,a),this.aspect=null}copy(e,t){return super.copy(e,t),this.aspect=e.aspect,this}}class wje extends m5e{constructor(){super(),this.addMaterial(PGe,"MeshPhongMaterial"),this.addMaterial(M5e,"MeshStandardMaterial"),this.addMaterial(NGe,"MeshPhysicalMaterial"),this.addMaterial(BGe,"MeshToonMaterial"),this.addMaterial(VGe,"MeshBasicMaterial"),this.addMaterial(HGe,"MeshLambertMaterial"),this.addMaterial(qGe,"MeshNormalMaterial"),this.addMaterial(KGe,"MeshMatcapMaterial"),this.addMaterial(QGe,"LineBasicMaterial"),this.addMaterial(tje,"LineDashedMaterial"),this.addMaterial(oje,"PointsMaterial"),this.addMaterial(A5e,"SpriteMaterial"),this.addMaterial(uje,"ShadowMaterial"),this.addLight(AUe,dje),this.addLight(Fze,pje),this.addLight(Lze,mje),this.addLight(UW,XW),this.addLight(Vze,yje),this.addLight(Gze,vje),this.addLight(jze,xje),this.addLight(Bze,bje),this.addLight(zze,Sje),this.addToneMapping(FBe,GIe),this.addToneMapping(LBe,jIe),this.addToneMapping(BBe,HIe),this.addToneMapping(zBe,WIe),this.addToneMapping(HBe,$Ie),this.addToneMapping(WBe,qIe)}}class rG extends RVe{constructor(e={}){let t;e.forceWebGL?t=e2e:(t=MGe,e.getFallback=()=>(console.warn("THREE.WebGPURenderer: WebGPU is not available, running under WebGL2 backend."),new e2e(e)));const n=new t(e);super(n,e),this.library=new wje,this.isWebGPURenderer=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}}class Eje extends _c{constructor(e,t){const n=[1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],r=new _s;r.setAttribute("position",new Ur(n,3)),r.computeBoundingSphere();const i=new vf({fog:!1});super(r,i),this.light=e,this.color=t,this.type="RectAreaLightHelper";const a=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],c=new _s;c.setAttribute("position",new Ur(a,3)),c.computeBoundingSphere(),this.add(new Mn(c,new wu({side:u0,fog:!1})))}updateMatrixWorld(){if(this.scale.set(.5*this.light.width,.5*this.light.height,1),this.color!==void 0)this.material.color.set(this.color),this.children[0].material.color.set(this.color);else{this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);const e=this.material.color,t=Math.max(e.r,e.g,e.b);t>1&&e.multiplyScalar(1/t),this.children[0].material.color.copy(this.material.color)}this.matrixWorld.extractRotation(this.light.matrixWorld).scale(this.scale).copyPosition(this.light.matrixWorld),this.children[0].matrixWorld.copy(this.matrixWorld)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const h2e={type:"change"},YW={type:"start"},P5e={type:"end"},ik=new Z_,d2e=new L3,Tje=Math.cos(70*B0.DEG2RAD),pa=new Ie,yc=2*Math.PI,vs={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},iG=1e-6;class Mje extends q9e{constructor(e,t=null){super(e,t),this.state=vs.NONE,this.target=new Ie,this.cursor=new Ie,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.keyRotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:__.ROTATE,MIDDLE:__.DOLLY,RIGHT:__.PAN},this.touches={ONE:o_.ROTATE,TWO:o_.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new Ie,this._lastQuaternion=new os,this._lastTargetPosition=new Ie,this._quat=new os().setFromUnitVectors(e.up,new Ie(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new yj,this._sphericalDelta=new yj,this._scale=1,this._panOffset=new Ie,this._rotateStart=new mr,this._rotateEnd=new mr,this._rotateDelta=new mr,this._panStart=new mr,this._panEnd=new mr,this._panDelta=new mr,this._dollyStart=new mr,this._dollyEnd=new mr,this._dollyDelta=new mr,this._dollyDirection=new Ie,this._mouse=new mr,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=Aje.bind(this),this._onPointerDown=Cje.bind(this),this._onPointerUp=Pje.bind(this),this._onContextMenu=Fje.bind(this),this._onMouseWheel=Ije.bind(this),this._onKeyDown=Nje.bind(this),this._onTouchStart=Dje.bind(this),this._onTouchMove=Oje.bind(this),this._onMouseDown=Rje.bind(this),this._onMouseMove=kje.bind(this),this._interceptControlDown=Lje.bind(this),this._interceptControlUp=Bje.bind(this),this.domElement!==null&&this.connect(this.domElement),this.update()}connect(e){super.connect(e),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(e){e.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=e}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(h2e),this.update(),this.state=vs.NONE}update(e=null){const t=this.object.position;pa.copy(t).sub(this.target),pa.applyQuaternion(this._quat),this._spherical.setFromVector3(pa),this.autoRotate&&this.state===vs.NONE&&this._rotateLeft(this._getAutoRotationAngle(e)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let n=this.minAzimuthAngle,r=this.maxAzimuthAngle;isFinite(n)&&isFinite(r)&&(n<-Math.PI?n+=yc:n>Math.PI&&(n-=yc),r<-Math.PI?r+=yc:r>Math.PI&&(r-=yc),n<=r?this._spherical.theta=Math.max(n,Math.min(r,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(n+r)/2?Math.max(n,this._spherical.theta):Math.min(r,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let i=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const a=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),i=a!=this._spherical.radius}if(pa.setFromSpherical(this._spherical),pa.applyQuaternion(this._quatInverse),t.copy(this.target).add(pa),this.object.lookAt(this.target),this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let a=null;if(this.object.isPerspectiveCamera){const c=pa.length();a=this._clampDistance(c*this._scale);const h=c-a;this.object.position.addScaledVector(this._dollyDirection,h),this.object.updateMatrixWorld(),i=!!h}else if(this.object.isOrthographicCamera){const c=new Ie(this._mouse.x,this._mouse.y,0);c.unproject(this.object);const h=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),i=h!==this.object.zoom;const p=new Ie(this._mouse.x,this._mouse.y,0);p.unproject(this.object),this.object.position.sub(p).add(c),this.object.updateMatrixWorld(),a=pa.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;a!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(a).add(this.object.position):(ik.origin.copy(this.object.position),ik.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(ik.direction))<Tje?this.object.lookAt(this.target):(d2e.setFromNormalAndCoplanarPoint(this.object.up,this.target),ik.intersectPlane(d2e,this.target))))}else if(this.object.isOrthographicCamera){const a=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),a!==this.object.zoom&&(this.object.updateProjectionMatrix(),i=!0)}return this._scale=1,this._performCursorZoom=!1,i||this._lastPosition.distanceToSquared(this.object.position)>iG||8*(1-this._lastQuaternion.dot(this.object.quaternion))>iG||this._lastTargetPosition.distanceToSquared(this.target)>iG?(this.dispatchEvent(h2e),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(e){return e!==null?yc/60*this.autoRotateSpeed*e:yc/60/60*this.autoRotateSpeed}_getZoomScale(e){const t=Math.abs(e*.01);return Math.pow(.95,this.zoomSpeed*t)}_rotateLeft(e){this._sphericalDelta.theta-=e}_rotateUp(e){this._sphericalDelta.phi-=e}_panLeft(e,t){pa.setFromMatrixColumn(t,0),pa.multiplyScalar(-e),this._panOffset.add(pa)}_panUp(e,t){this.screenSpacePanning===!0?pa.setFromMatrixColumn(t,1):(pa.setFromMatrixColumn(t,0),pa.crossVectors(this.object.up,pa)),pa.multiplyScalar(e),this._panOffset.add(pa)}_pan(e,t){const n=this.domElement;if(this.object.isPerspectiveCamera){const r=this.object.position;pa.copy(r).sub(this.target);let i=pa.length();i*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*e*i/n.clientHeight,this.object.matrix),this._panUp(2*t*i/n.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(e*(this.object.right-this.object.left)/this.object.zoom/n.clientWidth,this.object.matrix),this._panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/n.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(e,t){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const n=this.domElement.getBoundingClientRect(),r=e-n.left,i=t-n.top,a=n.width,c=n.height;this._mouse.x=r/a*2-1,this._mouse.y=-(i/c)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(e){return Math.max(this.minDistance,Math.min(this.maxDistance,e))}_handleMouseDownRotate(e){this._rotateStart.set(e.clientX,e.clientY)}_handleMouseDownDolly(e){this._updateZoomParameters(e.clientX,e.clientX),this._dollyStart.set(e.clientX,e.clientY)}_handleMouseDownPan(e){this._panStart.set(e.clientX,e.clientY)}_handleMouseMoveRotate(e){this._rotateEnd.set(e.clientX,e.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft(yc*this._rotateDelta.x/t.clientHeight),this._rotateUp(yc*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(e){this._dollyEnd.set(e.clientX,e.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(e){this._panEnd.set(e.clientX,e.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(e){this._updateZoomParameters(e.clientX,e.clientY),e.deltaY<0?this._dollyIn(this._getZoomScale(e.deltaY)):e.deltaY>0&&this._dollyOut(this._getZoomScale(e.deltaY)),this.update()}_handleKeyDown(e){let t=!1;switch(e.code){case this.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(yc*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,this.keyPanSpeed),t=!0;break;case this.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(-yc*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,-this.keyPanSpeed),t=!0;break;case this.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(yc*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(this.keyPanSpeed,0),t=!0;break;case this.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(-yc*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(-this.keyPanSpeed,0),t=!0;break}t&&(e.preventDefault(),this.update())}_handleTouchStartRotate(e){if(this._pointers.length===1)this._rotateStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._rotateStart.set(n,r)}}_handleTouchStartPan(e){if(this._pointers.length===1)this._panStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._panStart.set(n,r)}}_handleTouchStartDolly(e){const t=this._getSecondPointerPosition(e),n=e.pageX-t.x,r=e.pageY-t.y,i=Math.sqrt(n*n+r*r);this._dollyStart.set(0,i)}_handleTouchStartDollyPan(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enablePan&&this._handleTouchStartPan(e)}_handleTouchStartDollyRotate(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enableRotate&&this._handleTouchStartRotate(e)}_handleTouchMoveRotate(e){if(this._pointers.length==1)this._rotateEnd.set(e.pageX,e.pageY);else{const n=this._getSecondPointerPosition(e),r=.5*(e.pageX+n.x),i=.5*(e.pageY+n.y);this._rotateEnd.set(r,i)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft(yc*this._rotateDelta.x/t.clientHeight),this._rotateUp(yc*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(e){if(this._pointers.length===1)this._panEnd.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._panEnd.set(n,r)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(e){const t=this._getSecondPointerPosition(e),n=e.pageX-t.x,r=e.pageY-t.y,i=Math.sqrt(n*n+r*r);this._dollyEnd.set(0,i),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);const a=(e.pageX+t.x)*.5,c=(e.pageY+t.y)*.5;this._updateZoomParameters(a,c)}_handleTouchMoveDollyPan(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enablePan&&this._handleTouchMovePan(e)}_handleTouchMoveDollyRotate(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enableRotate&&this._handleTouchMoveRotate(e)}_addPointer(e){this._pointers.push(e.pointerId)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId){this._pointers.splice(t,1);return}}_isTrackingPointer(e){for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId)return!0;return!1}_trackPointer(e){let t=this._pointerPositions[e.pointerId];t===void 0&&(t=new mr,this._pointerPositions[e.pointerId]=t),t.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){const t=e.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[t]}_customWheelEvent(e){const t=e.deltaMode,n={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(t){case 1:n.deltaY*=16;break;case 2:n.deltaY*=100;break}return e.ctrlKey&&!this._controlActive&&(n.deltaY*=10),n}}function Cje(o){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(o.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(o)&&(this._addPointer(o),o.pointerType==="touch"?this._onTouchStart(o):this._onMouseDown(o)))}function Aje(o){this.enabled!==!1&&(o.pointerType==="touch"?this._onTouchMove(o):this._onMouseMove(o))}function Pje(o){switch(this._removePointer(o),this._pointers.length){case 0:this.domElement.releasePointerCapture(o.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(P5e),this.state=vs.NONE;break;case 1:const e=this._pointers[0],t=this._pointerPositions[e];this._onTouchStart({pointerId:e,pageX:t.x,pageY:t.y});break}}function Rje(o){let e;switch(o.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case __.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(o),this.state=vs.DOLLY;break;case __.ROTATE:if(o.ctrlKey||o.metaKey||o.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(o),this.state=vs.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(o),this.state=vs.ROTATE}break;case __.PAN:if(o.ctrlKey||o.metaKey||o.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(o),this.state=vs.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(o),this.state=vs.PAN}break;default:this.state=vs.NONE}this.state!==vs.NONE&&this.dispatchEvent(YW)}function kje(o){switch(this.state){case vs.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(o);break;case vs.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(o);break;case vs.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(o);break}}function Ije(o){this.enabled===!1||this.enableZoom===!1||this.state!==vs.NONE||(o.preventDefault(),this.dispatchEvent(YW),this._handleMouseWheel(this._customWheelEvent(o)),this.dispatchEvent(P5e))}function Nje(o){this.enabled!==!1&&this._handleKeyDown(o)}function Dje(o){switch(this._trackPointer(o),this._pointers.length){case 1:switch(this.touches.ONE){case o_.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(o),this.state=vs.TOUCH_ROTATE;break;case o_.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(o),this.state=vs.TOUCH_PAN;break;default:this.state=vs.NONE}break;case 2:switch(this.touches.TWO){case o_.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(o),this.state=vs.TOUCH_DOLLY_PAN;break;case o_.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(o),this.state=vs.TOUCH_DOLLY_ROTATE;break;default:this.state=vs.NONE}break;default:this.state=vs.NONE}this.state!==vs.NONE&&this.dispatchEvent(YW)}function Oje(o){switch(this._trackPointer(o),this.state){case vs.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(o),this.update();break;case vs.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(o),this.update();break;case vs.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(o),this.update();break;case vs.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(o),this.update();break;default:this.state=vs.NONE}}function Fje(o){this.enabled!==!1&&o.preventDefault()}function Lje(o){o.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function Bje(o){o.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}/*!
 * camera-controls
 * https://github.com/yomotsu/camera-controls
 * (c) 2017 @yomotsu
 * Released under the MIT License.
 */const go={LEFT:1,RIGHT:2,MIDDLE:4},Nt=Object.freeze({NONE:0,ROTATE:1,TRUCK:2,SCREEN_PAN:4,OFFSET:8,DOLLY:16,ZOOM:32,TOUCH_ROTATE:64,TOUCH_TRUCK:128,TOUCH_SCREEN_PAN:256,TOUCH_OFFSET:512,TOUCH_DOLLY:1024,TOUCH_ZOOM:2048,TOUCH_DOLLY_TRUCK:4096,TOUCH_DOLLY_SCREEN_PAN:8192,TOUCH_DOLLY_OFFSET:16384,TOUCH_DOLLY_ROTATE:32768,TOUCH_ZOOM_TRUCK:65536,TOUCH_ZOOM_OFFSET:131072,TOUCH_ZOOM_SCREEN_PAN:262144,TOUCH_ZOOM_ROTATE:524288}),Z7={NONE:0,IN:1,OUT:-1};function q8(o){return o.isPerspectiveCamera}function F3(o){return o.isOrthographicCamera}const Q7=Math.PI*2,f2e=Math.PI/2,R5e=1e-5,Rw=Math.PI/180;function ef(o,e,t){return Math.max(e,Math.min(t,o))}function Ds(o,e=R5e){return Math.abs(o)<e}function is(o,e,t=R5e){return Ds(o-e,t)}function p2e(o,e){return Math.round(o/e)*e}function kw(o){return isFinite(o)?o:o<0?-Number.MAX_VALUE:Number.MAX_VALUE}function Iw(o){return Math.abs(o)<Number.MAX_VALUE?o:o*(1/0)}function sk(o,e,t,n,r=1/0,i){n=Math.max(1e-4,n);const a=2/n,c=a*i,h=1/(1+c+.48*c*c+.235*c*c*c);let p=o-e;const v=e,x=r*n;p=ef(p,-x,x),e=o-p;const S=(t.value+a*p)*i;t.value=(t.value-a*S)*h;let C=e+(p+S)*h;return v-o>0==C>v&&(C=v,t.value=(C-v)/i),C}function m2e(o,e,t,n,r=1/0,i,a){n=Math.max(1e-4,n);const c=2/n,h=c*i,p=1/(1+h+.48*h*h+.235*h*h*h);let v=e.x,x=e.y,S=e.z,C=o.x-v,I=o.y-x,L=o.z-S;const U=v,R=x,$=S,Z=r*n,k=Z*Z,ie=C*C+I*I+L*L;if(ie>k){const at=Math.sqrt(ie);C=C/at*Z,I=I/at*Z,L=L/at*Z}v=o.x-C,x=o.y-I,S=o.z-L;const ue=(t.x+c*C)*i,ce=(t.y+c*I)*i,Q=(t.z+c*L)*i;t.x=(t.x-c*ue)*p,t.y=(t.y-c*ce)*p,t.z=(t.z-c*Q)*p,a.x=v+(C+ue)*p,a.y=x+(I+ce)*p,a.z=S+(L+Q)*p;const ae=U-o.x,le=R-o.y,J=$-o.z,Ue=a.x-U,je=a.y-R,rt=a.z-$;return ae*Ue+le*je+J*rt>0&&(a.x=U,a.y=R,a.z=$,t.x=(a.x-U)/i,t.y=(a.y-R)/i,t.z=(a.z-$)/i),a}function sG(o,e){e.set(0,0),o.forEach(t=>{e.x+=t.clientX,e.y+=t.clientY}),e.x/=o.length,e.y/=o.length}function oG(o,e){return F3(o)?(console.warn(`${e} is not supported in OrthographicCamera`),!0):!1}class Uje{constructor(){this._listeners={}}addEventListener(e,t){const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){const r=this._listeners[e];if(r!==void 0){const i=r.indexOf(t);i!==-1&&r.splice(i,1)}}removeAllEventListeners(e){if(!e){this._listeners={};return}Array.isArray(this._listeners[e])&&(this._listeners[e].length=0)}dispatchEvent(e){const n=this._listeners[e.type];if(n!==void 0){e.target=this;const r=n.slice(0);for(let i=0,a=r.length;i<a;i++)r[i].call(this,e)}}}var aG;const zje="2.10.1",ok=1/8,Vje=/Mac/.test((aG=globalThis==null?void 0:globalThis.navigator)===null||aG===void 0?void 0:aG.platform);let $r,g2e,ak,lG,vc,ci,Wi,J7,Nw,jp,Hp,X8,y2e,v2e,xh,Dw,e_,_2e,cG,x2e,uG,hG,lk;class Xp extends Uje{static install(e){$r=e.THREE,g2e=Object.freeze(new $r.Vector3(0,0,0)),ak=Object.freeze(new $r.Vector3(0,1,0)),lG=Object.freeze(new $r.Vector3(0,0,1)),vc=new $r.Vector2,ci=new $r.Vector3,Wi=new $r.Vector3,J7=new $r.Vector3,Nw=new $r.Vector3,jp=new $r.Vector3,Hp=new $r.Vector3,X8=new $r.Vector3,y2e=new $r.Vector3,v2e=new $r.Vector3,xh=new $r.Spherical,Dw=new $r.Spherical,e_=new $r.Box3,_2e=new $r.Box3,cG=new $r.Sphere,x2e=new $r.Quaternion,uG=new $r.Quaternion,hG=new $r.Matrix4,lk=new $r.Raycaster}static get ACTION(){return Nt}set verticalDragToForward(e){console.warn("camera-controls: `verticalDragToForward` was removed. Use `mouseButtons.left = CameraControls.ACTION.SCREEN_PAN` instead.")}constructor(e,t){super(),this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.minDistance=Number.EPSILON,this.maxDistance=1/0,this.infinityDolly=!1,this.minZoom=.01,this.maxZoom=1/0,this.smoothTime=.25,this.draggingSmoothTime=.125,this.maxSpeed=1/0,this.azimuthRotateSpeed=1,this.polarRotateSpeed=1,this.dollySpeed=1,this.dollyDragInverted=!1,this.truckSpeed=2,this.dollyToCursor=!1,this.dragToOffset=!1,this.boundaryFriction=0,this.restThreshold=.01,this.colliderMeshes=[],this.cancel=()=>{},this._enabled=!0,this._state=Nt.NONE,this._viewport=null,this._changedDolly=0,this._changedZoom=0,this._hasRested=!0,this._boundaryEnclosesCamera=!1,this._needsUpdate=!0,this._updatedLastTime=!1,this._elementRect=new DOMRect,this._isDragging=!1,this._dragNeedsUpdate=!0,this._activePointers=[],this._lockedPointer=null,this._interactiveArea=new DOMRect(0,0,1,1),this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._isUserControllingOffset=!1,this._isUserControllingZoom=!1,this._lastDollyDirection=Z7.NONE,this._thetaVelocity={value:0},this._phiVelocity={value:0},this._radiusVelocity={value:0},this._targetVelocity=new $r.Vector3,this._focalOffsetVelocity=new $r.Vector3,this._zoomVelocity={value:0},this._truckInternal=(R,$,Z,k)=>{let ie,ue;if(q8(this._camera)){const ce=ci.copy(this._camera.position).sub(this._target),Q=this._camera.getEffectiveFOV()*Rw,ae=ce.length()*Math.tan(Q*.5);ie=this.truckSpeed*R*ae/this._elementRect.height,ue=this.truckSpeed*$*ae/this._elementRect.height}else if(F3(this._camera)){const ce=this._camera;ie=this.truckSpeed*R*(ce.right-ce.left)/ce.zoom/this._elementRect.width,ue=this.truckSpeed*$*(ce.top-ce.bottom)/ce.zoom/this._elementRect.height}else return;k?(Z?this.setFocalOffset(this._focalOffsetEnd.x+ie,this._focalOffsetEnd.y,this._focalOffsetEnd.z,!0):this.truck(ie,0,!0),this.forward(-ue,!0)):Z?this.setFocalOffset(this._focalOffsetEnd.x+ie,this._focalOffsetEnd.y+ue,this._focalOffsetEnd.z,!0):this.truck(ie,ue,!0)},this._rotateInternal=(R,$)=>{const Z=Q7*this.azimuthRotateSpeed*R/this._elementRect.height,k=Q7*this.polarRotateSpeed*$/this._elementRect.height;this.rotate(Z,k,!0)},this._dollyInternal=(R,$,Z)=>{const k=Math.pow(.95,-R*this.dollySpeed),ie=this._sphericalEnd.radius,ue=this._sphericalEnd.radius*k,ce=ef(ue,this.minDistance,this.maxDistance),Q=ce-ue;this.infinityDolly&&this.dollyToCursor?this._dollyToNoClamp(ue,!0):this.infinityDolly&&!this.dollyToCursor?(this.dollyInFixed(Q,!0),this._dollyToNoClamp(ce,!0)):this._dollyToNoClamp(ce,!0),this.dollyToCursor&&(this._changedDolly+=(this.infinityDolly?ue:ce)-ie,this._dollyControlCoord.set($,Z)),this._lastDollyDirection=Math.sign(-R)},this._zoomInternal=(R,$,Z)=>{const k=Math.pow(.95,R*this.dollySpeed),ie=this._zoom,ue=this._zoom*k;this.zoomTo(ue,!0),this.dollyToCursor&&(this._changedZoom+=ue-ie,this._dollyControlCoord.set($,Z))},typeof $r>"u"&&console.error("camera-controls: `THREE` is undefined. You must first run `CameraControls.install( { THREE: THREE } )`. Check the docs for further information."),this._camera=e,this._yAxisUpSpace=new $r.Quaternion().setFromUnitVectors(this._camera.up,ak),this._yAxisUpSpaceInverse=this._yAxisUpSpace.clone().invert(),this._state=Nt.NONE,this._target=new $r.Vector3,this._targetEnd=this._target.clone(),this._focalOffset=new $r.Vector3,this._focalOffsetEnd=this._focalOffset.clone(),this._spherical=new $r.Spherical().setFromVector3(ci.copy(this._camera.position).applyQuaternion(this._yAxisUpSpace)),this._sphericalEnd=this._spherical.clone(),this._lastDistance=this._spherical.radius,this._zoom=this._camera.zoom,this._zoomEnd=this._zoom,this._lastZoom=this._zoom,this._nearPlaneCorners=[new $r.Vector3,new $r.Vector3,new $r.Vector3,new $r.Vector3],this._updateNearPlaneCorners(),this._boundary=new $r.Box3(new $r.Vector3(-1/0,-1/0,-1/0),new $r.Vector3(1/0,1/0,1/0)),this._cameraUp0=this._camera.up.clone(),this._target0=this._target.clone(),this._position0=this._camera.position.clone(),this._zoom0=this._zoom,this._focalOffset0=this._focalOffset.clone(),this._dollyControlCoord=new $r.Vector2,this.mouseButtons={left:Nt.ROTATE,middle:Nt.DOLLY,right:Nt.TRUCK,wheel:q8(this._camera)?Nt.DOLLY:F3(this._camera)?Nt.ZOOM:Nt.NONE},this.touches={one:Nt.TOUCH_ROTATE,two:q8(this._camera)?Nt.TOUCH_DOLLY_TRUCK:F3(this._camera)?Nt.TOUCH_ZOOM_TRUCK:Nt.NONE,three:Nt.TOUCH_TRUCK};const n=new $r.Vector2,r=new $r.Vector2,i=new $r.Vector2,a=R=>{if(!this._enabled||!this._domElement)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){const k=this._domElement.getBoundingClientRect(),ie=R.clientX/k.width,ue=R.clientY/k.height;if(ie<this._interactiveArea.left||ie>this._interactiveArea.right||ue<this._interactiveArea.top||ue>this._interactiveArea.bottom)return}const $=R.pointerType!=="mouse"?null:(R.buttons&go.LEFT)===go.LEFT?go.LEFT:(R.buttons&go.MIDDLE)===go.MIDDLE?go.MIDDLE:(R.buttons&go.RIGHT)===go.RIGHT?go.RIGHT:null;if($!==null){const k=this._findPointerByMouseButton($);k&&this._disposePointer(k)}if((R.buttons&go.LEFT)===go.LEFT&&this._lockedPointer)return;const Z={pointerId:R.pointerId,clientX:R.clientX,clientY:R.clientY,deltaX:0,deltaY:0,mouseButton:$};this._activePointers.push(Z),this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",h),this._domElement.ownerDocument.addEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",h),this._isDragging=!0,S(R)},c=R=>{R.cancelable&&R.preventDefault();const $=R.pointerId,Z=this._lockedPointer||this._findPointerById($);if(Z){if(Z.clientX=R.clientX,Z.clientY=R.clientY,Z.deltaX=R.movementX,Z.deltaY=R.movementY,this._state=0,R.pointerType==="touch")switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else(!this._isDragging&&this._lockedPointer||this._isDragging&&(R.buttons&go.LEFT)===go.LEFT)&&(this._state=this._state|this.mouseButtons.left),this._isDragging&&(R.buttons&go.MIDDLE)===go.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),this._isDragging&&(R.buttons&go.RIGHT)===go.RIGHT&&(this._state=this._state|this.mouseButtons.right);C()}},h=R=>{const $=this._findPointerById(R.pointerId);if(!($&&$===this._lockedPointer)){if($&&this._disposePointer($),R.pointerType==="touch")switch(this._activePointers.length){case 0:this._state=Nt.NONE;break;case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else this._state=Nt.NONE;I()}};let p=-1;const v=R=>{if(!this._domElement||!this._enabled||this.mouseButtons.wheel===Nt.NONE)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){const ue=this._domElement.getBoundingClientRect(),ce=R.clientX/ue.width,Q=R.clientY/ue.height;if(ce<this._interactiveArea.left||ce>this._interactiveArea.right||Q<this._interactiveArea.top||Q>this._interactiveArea.bottom)return}if(R.preventDefault(),this.dollyToCursor||this.mouseButtons.wheel===Nt.ROTATE||this.mouseButtons.wheel===Nt.TRUCK){const ue=performance.now();p-ue<1e3&&this._getClientRect(this._elementRect),p=ue}const $=Vje?-1:-3,Z=R.deltaMode===1||R.ctrlKey?R.deltaY/$:R.deltaY/($*10),k=this.dollyToCursor?(R.clientX-this._elementRect.x)/this._elementRect.width*2-1:0,ie=this.dollyToCursor?(R.clientY-this._elementRect.y)/this._elementRect.height*-2+1:0;switch(this.mouseButtons.wheel){case Nt.ROTATE:{this._rotateInternal(R.deltaX,R.deltaY),this._isUserControllingRotate=!0;break}case Nt.TRUCK:{this._truckInternal(R.deltaX,R.deltaY,!1,!1),this._isUserControllingTruck=!0;break}case Nt.SCREEN_PAN:{this._truckInternal(R.deltaX,R.deltaY,!1,!0),this._isUserControllingTruck=!0;break}case Nt.OFFSET:{this._truckInternal(R.deltaX,R.deltaY,!0,!1),this._isUserControllingOffset=!0;break}case Nt.DOLLY:{this._dollyInternal(-Z,k,ie),this._isUserControllingDolly=!0;break}case Nt.ZOOM:{this._zoomInternal(-Z,k,ie),this._isUserControllingZoom=!0;break}}this.dispatchEvent({type:"control"})},x=R=>{if(!(!this._domElement||!this._enabled)){if(this.mouseButtons.right===Xp.ACTION.NONE){const $=R instanceof PointerEvent?R.pointerId:0,Z=this._findPointerById($);Z&&this._disposePointer(Z),this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",h);return}R.preventDefault()}},S=R=>{if(!this._enabled)return;if(sG(this._activePointers,vc),this._getClientRect(this._elementRect),n.copy(vc),r.copy(vc),this._activePointers.length>=2){const Z=vc.x-this._activePointers[1].clientX,k=vc.y-this._activePointers[1].clientY,ie=Math.sqrt(Z*Z+k*k);i.set(0,ie);const ue=(this._activePointers[0].clientX+this._activePointers[1].clientX)*.5,ce=(this._activePointers[0].clientY+this._activePointers[1].clientY)*.5;r.set(ue,ce)}if(this._state=0,!R)this._lockedPointer&&(this._state=this._state|this.mouseButtons.left);else if("pointerType"in R&&R.pointerType==="touch")switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else!this._lockedPointer&&(R.buttons&go.LEFT)===go.LEFT&&(this._state=this._state|this.mouseButtons.left),(R.buttons&go.MIDDLE)===go.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),(R.buttons&go.RIGHT)===go.RIGHT&&(this._state=this._state|this.mouseButtons.right);((this._state&Nt.ROTATE)===Nt.ROTATE||(this._state&Nt.TOUCH_ROTATE)===Nt.TOUCH_ROTATE||(this._state&Nt.TOUCH_DOLLY_ROTATE)===Nt.TOUCH_DOLLY_ROTATE||(this._state&Nt.TOUCH_ZOOM_ROTATE)===Nt.TOUCH_ZOOM_ROTATE)&&(this._sphericalEnd.theta=this._spherical.theta,this._sphericalEnd.phi=this._spherical.phi,this._thetaVelocity.value=0,this._phiVelocity.value=0),((this._state&Nt.TRUCK)===Nt.TRUCK||(this._state&Nt.SCREEN_PAN)===Nt.SCREEN_PAN||(this._state&Nt.TOUCH_TRUCK)===Nt.TOUCH_TRUCK||(this._state&Nt.TOUCH_SCREEN_PAN)===Nt.TOUCH_SCREEN_PAN||(this._state&Nt.TOUCH_DOLLY_TRUCK)===Nt.TOUCH_DOLLY_TRUCK||(this._state&Nt.TOUCH_DOLLY_SCREEN_PAN)===Nt.TOUCH_DOLLY_SCREEN_PAN||(this._state&Nt.TOUCH_ZOOM_TRUCK)===Nt.TOUCH_ZOOM_TRUCK||(this._state&Nt.TOUCH_ZOOM_SCREEN_PAN)===Nt.TOUCH_DOLLY_SCREEN_PAN)&&(this._targetEnd.copy(this._target),this._targetVelocity.set(0,0,0)),((this._state&Nt.DOLLY)===Nt.DOLLY||(this._state&Nt.TOUCH_DOLLY)===Nt.TOUCH_DOLLY||(this._state&Nt.TOUCH_DOLLY_TRUCK)===Nt.TOUCH_DOLLY_TRUCK||(this._state&Nt.TOUCH_DOLLY_SCREEN_PAN)===Nt.TOUCH_DOLLY_SCREEN_PAN||(this._state&Nt.TOUCH_DOLLY_OFFSET)===Nt.TOUCH_DOLLY_OFFSET||(this._state&Nt.TOUCH_DOLLY_ROTATE)===Nt.TOUCH_DOLLY_ROTATE)&&(this._sphericalEnd.radius=this._spherical.radius,this._radiusVelocity.value=0),((this._state&Nt.ZOOM)===Nt.ZOOM||(this._state&Nt.TOUCH_ZOOM)===Nt.TOUCH_ZOOM||(this._state&Nt.TOUCH_ZOOM_TRUCK)===Nt.TOUCH_ZOOM_TRUCK||(this._state&Nt.TOUCH_ZOOM_SCREEN_PAN)===Nt.TOUCH_ZOOM_SCREEN_PAN||(this._state&Nt.TOUCH_ZOOM_OFFSET)===Nt.TOUCH_ZOOM_OFFSET||(this._state&Nt.TOUCH_ZOOM_ROTATE)===Nt.TOUCH_ZOOM_ROTATE)&&(this._zoomEnd=this._zoom,this._zoomVelocity.value=0),((this._state&Nt.OFFSET)===Nt.OFFSET||(this._state&Nt.TOUCH_OFFSET)===Nt.TOUCH_OFFSET||(this._state&Nt.TOUCH_DOLLY_OFFSET)===Nt.TOUCH_DOLLY_OFFSET||(this._state&Nt.TOUCH_ZOOM_OFFSET)===Nt.TOUCH_ZOOM_OFFSET)&&(this._focalOffsetEnd.copy(this._focalOffset),this._focalOffsetVelocity.set(0,0,0)),this.dispatchEvent({type:"controlstart"})},C=()=>{if(!this._enabled||!this._dragNeedsUpdate)return;this._dragNeedsUpdate=!1,sG(this._activePointers,vc);const $=this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement?this._lockedPointer||this._activePointers[0]:null,Z=$?-$.deltaX:r.x-vc.x,k=$?-$.deltaY:r.y-vc.y;if(r.copy(vc),((this._state&Nt.ROTATE)===Nt.ROTATE||(this._state&Nt.TOUCH_ROTATE)===Nt.TOUCH_ROTATE||(this._state&Nt.TOUCH_DOLLY_ROTATE)===Nt.TOUCH_DOLLY_ROTATE||(this._state&Nt.TOUCH_ZOOM_ROTATE)===Nt.TOUCH_ZOOM_ROTATE)&&(this._rotateInternal(Z,k),this._isUserControllingRotate=!0),(this._state&Nt.DOLLY)===Nt.DOLLY||(this._state&Nt.ZOOM)===Nt.ZOOM){const ie=this.dollyToCursor?(n.x-this._elementRect.x)/this._elementRect.width*2-1:0,ue=this.dollyToCursor?(n.y-this._elementRect.y)/this._elementRect.height*-2+1:0,ce=this.dollyDragInverted?-1:1;(this._state&Nt.DOLLY)===Nt.DOLLY?(this._dollyInternal(ce*k*ok,ie,ue),this._isUserControllingDolly=!0):(this._zoomInternal(ce*k*ok,ie,ue),this._isUserControllingZoom=!0)}if((this._state&Nt.TOUCH_DOLLY)===Nt.TOUCH_DOLLY||(this._state&Nt.TOUCH_ZOOM)===Nt.TOUCH_ZOOM||(this._state&Nt.TOUCH_DOLLY_TRUCK)===Nt.TOUCH_DOLLY_TRUCK||(this._state&Nt.TOUCH_ZOOM_TRUCK)===Nt.TOUCH_ZOOM_TRUCK||(this._state&Nt.TOUCH_DOLLY_SCREEN_PAN)===Nt.TOUCH_DOLLY_SCREEN_PAN||(this._state&Nt.TOUCH_ZOOM_SCREEN_PAN)===Nt.TOUCH_ZOOM_SCREEN_PAN||(this._state&Nt.TOUCH_DOLLY_OFFSET)===Nt.TOUCH_DOLLY_OFFSET||(this._state&Nt.TOUCH_ZOOM_OFFSET)===Nt.TOUCH_ZOOM_OFFSET||(this._state&Nt.TOUCH_DOLLY_ROTATE)===Nt.TOUCH_DOLLY_ROTATE||(this._state&Nt.TOUCH_ZOOM_ROTATE)===Nt.TOUCH_ZOOM_ROTATE){const ie=vc.x-this._activePointers[1].clientX,ue=vc.y-this._activePointers[1].clientY,ce=Math.sqrt(ie*ie+ue*ue),Q=i.y-ce;i.set(0,ce);const ae=this.dollyToCursor?(r.x-this._elementRect.x)/this._elementRect.width*2-1:0,le=this.dollyToCursor?(r.y-this._elementRect.y)/this._elementRect.height*-2+1:0;(this._state&Nt.TOUCH_DOLLY)===Nt.TOUCH_DOLLY||(this._state&Nt.TOUCH_DOLLY_ROTATE)===Nt.TOUCH_DOLLY_ROTATE||(this._state&Nt.TOUCH_DOLLY_TRUCK)===Nt.TOUCH_DOLLY_TRUCK||(this._state&Nt.TOUCH_DOLLY_SCREEN_PAN)===Nt.TOUCH_DOLLY_SCREEN_PAN||(this._state&Nt.TOUCH_DOLLY_OFFSET)===Nt.TOUCH_DOLLY_OFFSET?(this._dollyInternal(Q*ok,ae,le),this._isUserControllingDolly=!0):(this._zoomInternal(Q*ok,ae,le),this._isUserControllingZoom=!0)}((this._state&Nt.TRUCK)===Nt.TRUCK||(this._state&Nt.TOUCH_TRUCK)===Nt.TOUCH_TRUCK||(this._state&Nt.TOUCH_DOLLY_TRUCK)===Nt.TOUCH_DOLLY_TRUCK||(this._state&Nt.TOUCH_ZOOM_TRUCK)===Nt.TOUCH_ZOOM_TRUCK)&&(this._truckInternal(Z,k,!1,!1),this._isUserControllingTruck=!0),((this._state&Nt.SCREEN_PAN)===Nt.SCREEN_PAN||(this._state&Nt.TOUCH_SCREEN_PAN)===Nt.TOUCH_SCREEN_PAN||(this._state&Nt.TOUCH_DOLLY_SCREEN_PAN)===Nt.TOUCH_DOLLY_SCREEN_PAN||(this._state&Nt.TOUCH_ZOOM_SCREEN_PAN)===Nt.TOUCH_ZOOM_SCREEN_PAN)&&(this._truckInternal(Z,k,!1,!0),this._isUserControllingTruck=!0),((this._state&Nt.OFFSET)===Nt.OFFSET||(this._state&Nt.TOUCH_OFFSET)===Nt.TOUCH_OFFSET||(this._state&Nt.TOUCH_DOLLY_OFFSET)===Nt.TOUCH_DOLLY_OFFSET||(this._state&Nt.TOUCH_ZOOM_OFFSET)===Nt.TOUCH_ZOOM_OFFSET)&&(this._truckInternal(Z,k,!0,!1),this._isUserControllingOffset=!0),this.dispatchEvent({type:"control"})},I=()=>{sG(this._activePointers,vc),r.copy(vc),this._dragNeedsUpdate=!1,(this._activePointers.length===0||this._activePointers.length===1&&this._activePointers[0]===this._lockedPointer)&&(this._isDragging=!1),this._activePointers.length===0&&this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",h),this.dispatchEvent({type:"controlend"}))};this.lockPointer=()=>{!this._enabled||!this._domElement||(this.cancel(),this._lockedPointer={pointerId:-1,clientX:0,clientY:0,deltaX:0,deltaY:0,mouseButton:null},this._activePointers.push(this._lockedPointer),this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",h),this._domElement.requestPointerLock(),this._domElement.ownerDocument.addEventListener("pointerlockchange",L),this._domElement.ownerDocument.addEventListener("pointerlockerror",U),this._domElement.ownerDocument.addEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",h),S())},this.unlockPointer=()=>{var R,$,Z;this._lockedPointer!==null&&(this._disposePointer(this._lockedPointer),this._lockedPointer=null),(R=this._domElement)===null||R===void 0||R.ownerDocument.exitPointerLock(),($=this._domElement)===null||$===void 0||$.ownerDocument.removeEventListener("pointerlockchange",L),(Z=this._domElement)===null||Z===void 0||Z.ownerDocument.removeEventListener("pointerlockerror",U),this.cancel()};const L=()=>{this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement||this.unlockPointer()},U=()=>{this.unlockPointer()};this._addAllEventListeners=R=>{this._domElement=R,this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none",this._domElement.addEventListener("pointerdown",a),this._domElement.addEventListener("pointercancel",h),this._domElement.addEventListener("wheel",v,{passive:!1}),this._domElement.addEventListener("contextmenu",x)},this._removeAllEventListeners=()=>{this._domElement&&(this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect="",this._domElement.removeEventListener("pointerdown",a),this._domElement.removeEventListener("pointercancel",h),this._domElement.removeEventListener("wheel",v,{passive:!1}),this._domElement.removeEventListener("contextmenu",x),this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",h),this._domElement.ownerDocument.removeEventListener("pointerlockchange",L),this._domElement.ownerDocument.removeEventListener("pointerlockerror",U))},this.cancel=()=>{this._state!==Nt.NONE&&(this._state=Nt.NONE,this._activePointers.length=0,I())},t&&this.connect(t),this.update(0)}get camera(){return this._camera}set camera(e){this._camera=e,this.updateCameraUp(),this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._domElement&&(e?(this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none"):(this.cancel(),this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect=""))}get active(){return!this._hasRested}get currentAction(){return this._state}get distance(){return this._spherical.radius}set distance(e){this._spherical.radius===e&&this._sphericalEnd.radius===e||(this._spherical.radius=e,this._sphericalEnd.radius=e,this._needsUpdate=!0)}get azimuthAngle(){return this._spherical.theta}set azimuthAngle(e){this._spherical.theta===e&&this._sphericalEnd.theta===e||(this._spherical.theta=e,this._sphericalEnd.theta=e,this._needsUpdate=!0)}get polarAngle(){return this._spherical.phi}set polarAngle(e){this._spherical.phi===e&&this._sphericalEnd.phi===e||(this._spherical.phi=e,this._sphericalEnd.phi=e,this._needsUpdate=!0)}get boundaryEnclosesCamera(){return this._boundaryEnclosesCamera}set boundaryEnclosesCamera(e){this._boundaryEnclosesCamera=e,this._needsUpdate=!0}set interactiveArea(e){this._interactiveArea.width=ef(e.width,0,1),this._interactiveArea.height=ef(e.height,0,1),this._interactiveArea.x=ef(e.x,0,1-this._interactiveArea.width),this._interactiveArea.y=ef(e.y,0,1-this._interactiveArea.height)}addEventListener(e,t){super.addEventListener(e,t)}removeEventListener(e,t){super.removeEventListener(e,t)}rotate(e,t,n=!1){return this.rotateTo(this._sphericalEnd.theta+e,this._sphericalEnd.phi+t,n)}rotateAzimuthTo(e,t=!1){return this.rotateTo(e,this._sphericalEnd.phi,t)}rotatePolarTo(e,t=!1){return this.rotateTo(this._sphericalEnd.theta,e,t)}rotateTo(e,t,n=!1){this._isUserControllingRotate=!1;const r=ef(e,this.minAzimuthAngle,this.maxAzimuthAngle),i=ef(t,this.minPolarAngle,this.maxPolarAngle);this._sphericalEnd.theta=r,this._sphericalEnd.phi=i,this._sphericalEnd.makeSafe(),this._needsUpdate=!0,n||(this._spherical.theta=this._sphericalEnd.theta,this._spherical.phi=this._sphericalEnd.phi);const a=!n||is(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&is(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold);return this._createOnRestPromise(a)}dolly(e,t=!1){return this.dollyTo(this._sphericalEnd.radius-e,t)}dollyTo(e,t=!1){return this._isUserControllingDolly=!1,this._lastDollyDirection=Z7.NONE,this._changedDolly=0,this._dollyToNoClamp(ef(e,this.minDistance,this.maxDistance),t)}_dollyToNoClamp(e,t=!1){const n=this._sphericalEnd.radius;if(this.colliderMeshes.length>=1){const a=this._collisionTest(),c=is(a,this._spherical.radius);if(!(n>e)&&c)return Promise.resolve();this._sphericalEnd.radius=Math.min(e,a)}else this._sphericalEnd.radius=e;this._needsUpdate=!0,t||(this._spherical.radius=this._sphericalEnd.radius);const i=!t||is(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(i)}dollyInFixed(e,t=!1){this._targetEnd.add(this._getCameraDirection(Nw).multiplyScalar(e)),t||this._target.copy(this._targetEnd);const n=!t||is(this._target.x,this._targetEnd.x,this.restThreshold)&&is(this._target.y,this._targetEnd.y,this.restThreshold)&&is(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(n)}zoom(e,t=!1){return this.zoomTo(this._zoomEnd+e,t)}zoomTo(e,t=!1){this._isUserControllingZoom=!1,this._zoomEnd=ef(e,this.minZoom,this.maxZoom),this._needsUpdate=!0,t||(this._zoom=this._zoomEnd);const n=!t||is(this._zoom,this._zoomEnd,this.restThreshold);return this._changedZoom=0,this._createOnRestPromise(n)}pan(e,t,n=!1){return console.warn("`pan` has been renamed to `truck`"),this.truck(e,t,n)}truck(e,t,n=!1){this._camera.updateMatrix(),jp.setFromMatrixColumn(this._camera.matrix,0),Hp.setFromMatrixColumn(this._camera.matrix,1),jp.multiplyScalar(e),Hp.multiplyScalar(-t);const r=ci.copy(jp).add(Hp),i=Wi.copy(this._targetEnd).add(r);return this.moveTo(i.x,i.y,i.z,n)}forward(e,t=!1){ci.setFromMatrixColumn(this._camera.matrix,0),ci.crossVectors(this._camera.up,ci),ci.multiplyScalar(e);const n=Wi.copy(this._targetEnd).add(ci);return this.moveTo(n.x,n.y,n.z,t)}elevate(e,t=!1){return ci.copy(this._camera.up).multiplyScalar(e),this.moveTo(this._targetEnd.x+ci.x,this._targetEnd.y+ci.y,this._targetEnd.z+ci.z,t)}moveTo(e,t,n,r=!1){this._isUserControllingTruck=!1;const i=ci.set(e,t,n).sub(this._targetEnd);this._encloseToBoundary(this._targetEnd,i,this.boundaryFriction),this._needsUpdate=!0,r||this._target.copy(this._targetEnd);const a=!r||is(this._target.x,this._targetEnd.x,this.restThreshold)&&is(this._target.y,this._targetEnd.y,this.restThreshold)&&is(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(a)}lookInDirectionOf(e,t,n,r=!1){const c=ci.set(e,t,n).sub(this._targetEnd).normalize().multiplyScalar(-this._sphericalEnd.radius).add(this._targetEnd);return this.setPosition(c.x,c.y,c.z,r)}fitToBox(e,t,{cover:n=!1,paddingLeft:r=0,paddingRight:i=0,paddingBottom:a=0,paddingTop:c=0}={}){const h=[],p=e.isBox3?e_.copy(e):e_.setFromObject(e);p.isEmpty()&&(console.warn("camera-controls: fitTo() cannot be used with an empty box. Aborting"),Promise.resolve());const v=p2e(this._sphericalEnd.theta,f2e),x=p2e(this._sphericalEnd.phi,f2e);h.push(this.rotateTo(v,x,t));const S=ci.setFromSpherical(this._sphericalEnd).normalize(),C=x2e.setFromUnitVectors(S,lG),I=is(Math.abs(S.y),1);I&&C.multiply(uG.setFromAxisAngle(ak,v)),C.multiply(this._yAxisUpSpaceInverse);const L=_2e.makeEmpty();Wi.copy(p.min).applyQuaternion(C),L.expandByPoint(Wi),Wi.copy(p.min).setX(p.max.x).applyQuaternion(C),L.expandByPoint(Wi),Wi.copy(p.min).setY(p.max.y).applyQuaternion(C),L.expandByPoint(Wi),Wi.copy(p.max).setZ(p.min.z).applyQuaternion(C),L.expandByPoint(Wi),Wi.copy(p.min).setZ(p.max.z).applyQuaternion(C),L.expandByPoint(Wi),Wi.copy(p.max).setY(p.min.y).applyQuaternion(C),L.expandByPoint(Wi),Wi.copy(p.max).setX(p.min.x).applyQuaternion(C),L.expandByPoint(Wi),Wi.copy(p.max).applyQuaternion(C),L.expandByPoint(Wi),L.min.x-=r,L.min.y-=a,L.max.x+=i,L.max.y+=c,C.setFromUnitVectors(lG,S),I&&C.premultiply(uG.invert()),C.premultiply(this._yAxisUpSpace);const U=L.getSize(ci),R=L.getCenter(Wi).applyQuaternion(C);if(q8(this._camera)){const $=this.getDistanceToFitBox(U.x,U.y,U.z,n);h.push(this.moveTo(R.x,R.y,R.z,t)),h.push(this.dollyTo($,t)),h.push(this.setFocalOffset(0,0,0,t))}else if(F3(this._camera)){const $=this._camera,Z=$.right-$.left,k=$.top-$.bottom,ie=n?Math.max(Z/U.x,k/U.y):Math.min(Z/U.x,k/U.y);h.push(this.moveTo(R.x,R.y,R.z,t)),h.push(this.zoomTo(ie,t)),h.push(this.setFocalOffset(0,0,0,t))}return Promise.all(h)}fitToSphere(e,t){const n=[],i="isObject3D"in e?Xp.createBoundingSphere(e,cG):cG.copy(e);if(n.push(this.moveTo(i.center.x,i.center.y,i.center.z,t)),q8(this._camera)){const a=this.getDistanceToFitSphere(i.radius);n.push(this.dollyTo(a,t))}else if(F3(this._camera)){const a=this._camera.right-this._camera.left,c=this._camera.top-this._camera.bottom,h=2*i.radius,p=Math.min(a/h,c/h);n.push(this.zoomTo(p,t))}return n.push(this.setFocalOffset(0,0,0,t)),Promise.all(n)}setLookAt(e,t,n,r,i,a,c=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=Z7.NONE,this._changedDolly=0;const h=Wi.set(r,i,a),p=ci.set(e,t,n);this._targetEnd.copy(h),this._sphericalEnd.setFromVector3(p.sub(h).applyQuaternion(this._yAxisUpSpace)),this.normalizeRotations(),this._needsUpdate=!0,c||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const v=!c||is(this._target.x,this._targetEnd.x,this.restThreshold)&&is(this._target.y,this._targetEnd.y,this.restThreshold)&&is(this._target.z,this._targetEnd.z,this.restThreshold)&&is(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&is(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&is(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(v)}lerpLookAt(e,t,n,r,i,a,c,h,p,v,x,S,C,I=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=Z7.NONE,this._changedDolly=0;const L=ci.set(r,i,a),U=Wi.set(e,t,n);xh.setFromVector3(U.sub(L).applyQuaternion(this._yAxisUpSpace));const R=J7.set(v,x,S),$=Wi.set(c,h,p);Dw.setFromVector3($.sub(R).applyQuaternion(this._yAxisUpSpace)),this._targetEnd.copy(L.lerp(R,C));const Z=Dw.theta-xh.theta,k=Dw.phi-xh.phi,ie=Dw.radius-xh.radius;this._sphericalEnd.set(xh.radius+ie*C,xh.phi+k*C,xh.theta+Z*C),this.normalizeRotations(),this._needsUpdate=!0,I||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const ue=!I||is(this._target.x,this._targetEnd.x,this.restThreshold)&&is(this._target.y,this._targetEnd.y,this.restThreshold)&&is(this._target.z,this._targetEnd.z,this.restThreshold)&&is(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&is(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&is(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(ue)}setPosition(e,t,n,r=!1){return this.setLookAt(e,t,n,this._targetEnd.x,this._targetEnd.y,this._targetEnd.z,r)}setTarget(e,t,n,r=!1){const i=this.getPosition(ci),a=this.setLookAt(i.x,i.y,i.z,e,t,n,r);return this._sphericalEnd.phi=ef(this._sphericalEnd.phi,this.minPolarAngle,this.maxPolarAngle),a}setFocalOffset(e,t,n,r=!1){this._isUserControllingOffset=!1,this._focalOffsetEnd.set(e,t,n),this._needsUpdate=!0,r||this._focalOffset.copy(this._focalOffsetEnd);const i=!r||is(this._focalOffset.x,this._focalOffsetEnd.x,this.restThreshold)&&is(this._focalOffset.y,this._focalOffsetEnd.y,this.restThreshold)&&is(this._focalOffset.z,this._focalOffsetEnd.z,this.restThreshold);return this._createOnRestPromise(i)}setOrbitPoint(e,t,n){this._camera.updateMatrixWorld(),jp.setFromMatrixColumn(this._camera.matrixWorldInverse,0),Hp.setFromMatrixColumn(this._camera.matrixWorldInverse,1),X8.setFromMatrixColumn(this._camera.matrixWorldInverse,2);const r=ci.set(e,t,n),i=r.distanceTo(this._camera.position),a=r.sub(this._camera.position);jp.multiplyScalar(a.x),Hp.multiplyScalar(a.y),X8.multiplyScalar(a.z),ci.copy(jp).add(Hp).add(X8),ci.z=ci.z+i,this.dollyTo(i,!1),this.setFocalOffset(-ci.x,ci.y,-ci.z,!1),this.moveTo(e,t,n,!1)}setBoundary(e){if(!e){this._boundary.min.set(-1/0,-1/0,-1/0),this._boundary.max.set(1/0,1/0,1/0),this._needsUpdate=!0;return}this._boundary.copy(e),this._boundary.clampPoint(this._targetEnd,this._targetEnd),this._needsUpdate=!0}setViewport(e,t,n,r){if(e===null){this._viewport=null;return}this._viewport=this._viewport||new $r.Vector4,typeof e=="number"?this._viewport.set(e,t,n,r):this._viewport.copy(e)}getDistanceToFitBox(e,t,n,r=!1){if(oG(this._camera,"getDistanceToFitBox"))return this._spherical.radius;const i=e/t,a=this._camera.getEffectiveFOV()*Rw,c=this._camera.aspect;return((r?i>c:i<c)?t:e/c)*.5/Math.tan(a*.5)+n*.5}getDistanceToFitSphere(e){if(oG(this._camera,"getDistanceToFitSphere"))return this._spherical.radius;const t=this._camera.getEffectiveFOV()*Rw,n=Math.atan(Math.tan(t*.5)*this._camera.aspect)*2,r=1<this._camera.aspect?t:n;return e/Math.sin(r*.5)}getTarget(e,t=!0){return(e&&e.isVector3?e:new $r.Vector3).copy(t?this._targetEnd:this._target)}getPosition(e,t=!0){return(e&&e.isVector3?e:new $r.Vector3).setFromSpherical(t?this._sphericalEnd:this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(t?this._targetEnd:this._target)}getSpherical(e,t=!0){return(e||new $r.Spherical).copy(t?this._sphericalEnd:this._spherical)}getFocalOffset(e,t=!0){return(e&&e.isVector3?e:new $r.Vector3).copy(t?this._focalOffsetEnd:this._focalOffset)}normalizeRotations(){this._sphericalEnd.theta=this._sphericalEnd.theta%Q7,this._sphericalEnd.theta<0&&(this._sphericalEnd.theta+=Q7),this._spherical.theta+=Q7*Math.round((this._sphericalEnd.theta-this._spherical.theta)/Q7)}stop(){this._focalOffset.copy(this._focalOffsetEnd),this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd),this._zoom=this._zoomEnd}reset(e=!1){if(!is(this._camera.up.x,this._cameraUp0.x)||!is(this._camera.up.y,this._cameraUp0.y)||!is(this._camera.up.z,this._cameraUp0.z)){this._camera.up.copy(this._cameraUp0);const n=this.getPosition(ci);this.updateCameraUp(),this.setPosition(n.x,n.y,n.z)}const t=[this.setLookAt(this._position0.x,this._position0.y,this._position0.z,this._target0.x,this._target0.y,this._target0.z,e),this.setFocalOffset(this._focalOffset0.x,this._focalOffset0.y,this._focalOffset0.z,e),this.zoomTo(this._zoom0,e)];return Promise.all(t)}saveState(){this._cameraUp0.copy(this._camera.up),this.getTarget(this._target0),this.getPosition(this._position0),this._zoom0=this._zoom,this._focalOffset0.copy(this._focalOffset)}updateCameraUp(){this._yAxisUpSpace.setFromUnitVectors(this._camera.up,ak),this._yAxisUpSpaceInverse.copy(this._yAxisUpSpace).invert()}applyCameraUp(){const e=ci.subVectors(this._target,this._camera.position).normalize(),t=Wi.crossVectors(e,this._camera.up);this._camera.up.crossVectors(t,e).normalize(),this._camera.updateMatrixWorld();const n=this.getPosition(ci);this.updateCameraUp(),this.setPosition(n.x,n.y,n.z)}update(e){const t=this._sphericalEnd.theta-this._spherical.theta,n=this._sphericalEnd.phi-this._spherical.phi,r=this._sphericalEnd.radius-this._spherical.radius,i=y2e.subVectors(this._targetEnd,this._target),a=v2e.subVectors(this._focalOffsetEnd,this._focalOffset),c=this._zoomEnd-this._zoom;if(Ds(t))this._thetaVelocity.value=0,this._spherical.theta=this._sphericalEnd.theta;else{const x=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.theta=sk(this._spherical.theta,this._sphericalEnd.theta,this._thetaVelocity,x,1/0,e),this._needsUpdate=!0}if(Ds(n))this._phiVelocity.value=0,this._spherical.phi=this._sphericalEnd.phi;else{const x=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.phi=sk(this._spherical.phi,this._sphericalEnd.phi,this._phiVelocity,x,1/0,e),this._needsUpdate=!0}if(Ds(r))this._radiusVelocity.value=0,this._spherical.radius=this._sphericalEnd.radius;else{const x=this._isUserControllingDolly?this.draggingSmoothTime:this.smoothTime;this._spherical.radius=sk(this._spherical.radius,this._sphericalEnd.radius,this._radiusVelocity,x,this.maxSpeed,e),this._needsUpdate=!0}if(Ds(i.x)&&Ds(i.y)&&Ds(i.z))this._targetVelocity.set(0,0,0),this._target.copy(this._targetEnd);else{const x=this._isUserControllingTruck?this.draggingSmoothTime:this.smoothTime;m2e(this._target,this._targetEnd,this._targetVelocity,x,this.maxSpeed,e,this._target),this._needsUpdate=!0}if(Ds(a.x)&&Ds(a.y)&&Ds(a.z))this._focalOffsetVelocity.set(0,0,0),this._focalOffset.copy(this._focalOffsetEnd);else{const x=this._isUserControllingOffset?this.draggingSmoothTime:this.smoothTime;m2e(this._focalOffset,this._focalOffsetEnd,this._focalOffsetVelocity,x,this.maxSpeed,e,this._focalOffset),this._needsUpdate=!0}if(Ds(c))this._zoomVelocity.value=0,this._zoom=this._zoomEnd;else{const x=this._isUserControllingZoom?this.draggingSmoothTime:this.smoothTime;this._zoom=sk(this._zoom,this._zoomEnd,this._zoomVelocity,x,1/0,e)}if(this.dollyToCursor){if(q8(this._camera)&&this._changedDolly!==0){const x=this._spherical.radius-this._lastDistance,S=this._camera,C=this._getCameraDirection(Nw),I=ci.copy(C).cross(S.up).normalize();I.lengthSq()===0&&(I.x=1);const L=Wi.crossVectors(I,C),U=this._sphericalEnd.radius*Math.tan(S.getEffectiveFOV()*Rw*.5),$=(this._sphericalEnd.radius-x-this._sphericalEnd.radius)/this._sphericalEnd.radius,Z=J7.copy(this._targetEnd).add(I.multiplyScalar(this._dollyControlCoord.x*U*S.aspect)).add(L.multiplyScalar(this._dollyControlCoord.y*U)),k=ci.copy(this._targetEnd).lerp(Z,$),ie=this._lastDollyDirection===Z7.IN&&this._spherical.radius<=this.minDistance,ue=this._lastDollyDirection===Z7.OUT&&this.maxDistance<=this._spherical.radius;if(this.infinityDolly&&(ie||ue)){this._sphericalEnd.radius-=x,this._spherical.radius-=x;const Q=Wi.copy(C).multiplyScalar(-x);k.add(Q)}this._boundary.clampPoint(k,k);const ce=Wi.subVectors(k,this._targetEnd);this._targetEnd.copy(k),this._target.add(ce),this._changedDolly-=x,Ds(this._changedDolly)&&(this._changedDolly=0)}else if(F3(this._camera)&&this._changedZoom!==0){const x=this._zoom-this._lastZoom,S=this._camera,C=ci.set(this._dollyControlCoord.x,this._dollyControlCoord.y,(S.near+S.far)/(S.near-S.far)).unproject(S),I=Wi.set(0,0,-1).applyQuaternion(S.quaternion),L=J7.copy(C).add(I.multiplyScalar(-C.dot(S.up))),R=-(this._zoom-x-this._zoom)/this._zoom,$=this._getCameraDirection(Nw),Z=this._targetEnd.dot($),k=ci.copy(this._targetEnd).lerp(L,R),ie=k.dot($),ue=$.multiplyScalar(ie-Z);k.sub(ue),this._boundary.clampPoint(k,k);const ce=Wi.subVectors(k,this._targetEnd);this._targetEnd.copy(k),this._target.add(ce),this._changedZoom-=x,Ds(this._changedZoom)&&(this._changedZoom=0)}}this._camera.zoom!==this._zoom&&(this._camera.zoom=this._zoom,this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0),this._dragNeedsUpdate=!0;const h=this._collisionTest();this._spherical.radius=Math.min(this._spherical.radius,h),this._spherical.makeSafe(),this._camera.position.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(this._target),this._camera.lookAt(this._target),(!Ds(this._focalOffset.x)||!Ds(this._focalOffset.y)||!Ds(this._focalOffset.z))&&(jp.setFromMatrixColumn(this._camera.matrix,0),Hp.setFromMatrixColumn(this._camera.matrix,1),X8.setFromMatrixColumn(this._camera.matrix,2),jp.multiplyScalar(this._focalOffset.x),Hp.multiplyScalar(-this._focalOffset.y),X8.multiplyScalar(this._focalOffset.z),ci.copy(jp).add(Hp).add(X8),this._camera.position.add(ci),this._camera.updateMatrixWorld()),this._boundaryEnclosesCamera&&this._encloseToBoundary(this._camera.position.copy(this._target),ci.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse),1);const v=this._needsUpdate;return v&&!this._updatedLastTime?(this._hasRested=!1,this.dispatchEvent({type:"wake"}),this.dispatchEvent({type:"update"})):v?(this.dispatchEvent({type:"update"}),Ds(t,this.restThreshold)&&Ds(n,this.restThreshold)&&Ds(r,this.restThreshold)&&Ds(i.x,this.restThreshold)&&Ds(i.y,this.restThreshold)&&Ds(i.z,this.restThreshold)&&Ds(a.x,this.restThreshold)&&Ds(a.y,this.restThreshold)&&Ds(a.z,this.restThreshold)&&Ds(c,this.restThreshold)&&!this._hasRested&&(this._hasRested=!0,this.dispatchEvent({type:"rest"}))):!v&&this._updatedLastTime&&this.dispatchEvent({type:"sleep"}),this._lastDistance=this._spherical.radius,this._lastZoom=this._zoom,this._updatedLastTime=v,this._needsUpdate=!1,v}toJSON(){return JSON.stringify({enabled:this._enabled,minDistance:this.minDistance,maxDistance:kw(this.maxDistance),minZoom:this.minZoom,maxZoom:kw(this.maxZoom),minPolarAngle:this.minPolarAngle,maxPolarAngle:kw(this.maxPolarAngle),minAzimuthAngle:kw(this.minAzimuthAngle),maxAzimuthAngle:kw(this.maxAzimuthAngle),smoothTime:this.smoothTime,draggingSmoothTime:this.draggingSmoothTime,dollySpeed:this.dollySpeed,truckSpeed:this.truckSpeed,dollyToCursor:this.dollyToCursor,target:this._targetEnd.toArray(),position:ci.setFromSpherical(this._sphericalEnd).add(this._targetEnd).toArray(),zoom:this._zoomEnd,focalOffset:this._focalOffsetEnd.toArray(),target0:this._target0.toArray(),position0:this._position0.toArray(),zoom0:this._zoom0,focalOffset0:this._focalOffset0.toArray()})}fromJSON(e,t=!1){const n=JSON.parse(e);this.enabled=n.enabled,this.minDistance=n.minDistance,this.maxDistance=Iw(n.maxDistance),this.minZoom=n.minZoom,this.maxZoom=Iw(n.maxZoom),this.minPolarAngle=n.minPolarAngle,this.maxPolarAngle=Iw(n.maxPolarAngle),this.minAzimuthAngle=Iw(n.minAzimuthAngle),this.maxAzimuthAngle=Iw(n.maxAzimuthAngle),this.smoothTime=n.smoothTime,this.draggingSmoothTime=n.draggingSmoothTime,this.dollySpeed=n.dollySpeed,this.truckSpeed=n.truckSpeed,this.dollyToCursor=n.dollyToCursor,this._target0.fromArray(n.target0),this._position0.fromArray(n.position0),this._zoom0=n.zoom0,this._focalOffset0.fromArray(n.focalOffset0),this.moveTo(n.target[0],n.target[1],n.target[2],t),xh.setFromVector3(ci.fromArray(n.position).sub(this._targetEnd).applyQuaternion(this._yAxisUpSpace)),this.rotateTo(xh.theta,xh.phi,t),this.dollyTo(xh.radius,t),this.zoomTo(n.zoom,t),this.setFocalOffset(n.focalOffset[0],n.focalOffset[1],n.focalOffset[2],t),this._needsUpdate=!0}connect(e){if(this._domElement){console.warn("camera-controls is already connected.");return}e.setAttribute("data-camera-controls-version",zje),this._addAllEventListeners(e),this._getClientRect(this._elementRect)}disconnect(){this.cancel(),this._removeAllEventListeners(),this._domElement&&(this._domElement.removeAttribute("data-camera-controls-version"),this._domElement=void 0)}dispose(){this.removeAllEventListeners(),this.disconnect()}_getTargetDirection(e){return e.setFromSpherical(this._spherical).divideScalar(this._spherical.radius).applyQuaternion(this._yAxisUpSpaceInverse)}_getCameraDirection(e){return this._getTargetDirection(e).negate()}_findPointerById(e){return this._activePointers.find(t=>t.pointerId===e)}_findPointerByMouseButton(e){return this._activePointers.find(t=>t.mouseButton===e)}_disposePointer(e){this._activePointers.splice(this._activePointers.indexOf(e),1)}_encloseToBoundary(e,t,n){const r=t.lengthSq();if(r===0)return e;const i=Wi.copy(t).add(e),c=this._boundary.clampPoint(i,J7).sub(i),h=c.lengthSq();if(h===0)return e.add(t);if(h===r)return e;if(n===0)return e.add(t).add(c);{const p=1+n*h/t.dot(c);return e.add(Wi.copy(t).multiplyScalar(p)).add(c.multiplyScalar(1-n))}}_updateNearPlaneCorners(){if(q8(this._camera)){const e=this._camera,t=e.near,n=e.getEffectiveFOV()*Rw,r=Math.tan(n*.5)*t,i=r*e.aspect;this._nearPlaneCorners[0].set(-i,-r,0),this._nearPlaneCorners[1].set(i,-r,0),this._nearPlaneCorners[2].set(i,r,0),this._nearPlaneCorners[3].set(-i,r,0)}else if(F3(this._camera)){const e=this._camera,t=1/e.zoom,n=e.left*t,r=e.right*t,i=e.top*t,a=e.bottom*t;this._nearPlaneCorners[0].set(n,i,0),this._nearPlaneCorners[1].set(r,i,0),this._nearPlaneCorners[2].set(r,a,0),this._nearPlaneCorners[3].set(n,a,0)}}_collisionTest(){let e=1/0;if(!(this.colliderMeshes.length>=1)||oG(this._camera,"_collisionTest"))return e;const n=this._getTargetDirection(Nw);hG.lookAt(g2e,n,this._camera.up);for(let r=0;r<4;r++){const i=Wi.copy(this._nearPlaneCorners[r]);i.applyMatrix4(hG);const a=J7.addVectors(this._target,i);lk.set(a,n),lk.far=this._spherical.radius+1;const c=lk.intersectObjects(this.colliderMeshes);c.length!==0&&c[0].distance<e&&(e=c[0].distance)}return e}_getClientRect(e){if(!this._domElement)return;const t=this._domElement.getBoundingClientRect();return e.x=t.left,e.y=t.top,this._viewport?(e.x+=this._viewport.x,e.y+=t.height-this._viewport.w-this._viewport.y,e.width=this._viewport.z,e.height=this._viewport.w):(e.width=t.width,e.height=t.height),e}_createOnRestPromise(e){return e?Promise.resolve():(this._hasRested=!1,this.dispatchEvent({type:"transitionstart"}),new Promise(t=>{const n=()=>{this.removeEventListener("rest",n),t()};this.addEventListener("rest",n)}))}_addAllEventListeners(e){}_removeAllEventListeners(){}get dampingFactor(){return console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead."),0}set dampingFactor(e){console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead.")}get draggingDampingFactor(){return console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead."),0}set draggingDampingFactor(e){console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead.")}static createBoundingSphere(e,t=new $r.Sphere){const n=t,r=n.center;e_.makeEmpty(),e.traverseVisible(a=>{a.isMesh&&e_.expandByObject(a)}),e_.getCenter(r);let i=0;return e.traverseVisible(a=>{if(!a.isMesh)return;const c=a;if(!c.geometry)return;const h=c.geometry.clone();h.applyMatrix4(c.matrixWorld);const v=h.attributes.position;for(let x=0,S=v.count;x<S;x++)ci.fromBufferAttribute(v,x),i=Math.max(i,r.distanceToSquared(ci))}),n.radius=Math.sqrt(i),n}}const hI=o=>{const[e,t]=Rn.useState(o.options[o.index]),n=()=>{o.onToggle(!o.open)},r=i=>{i!==e&&(o.onSelect(i),t(i)),o.onToggle(!1)};return Je.jsxs("div",{className:`dropdown ${o.up===!0?"up":""}`,children:[Je.jsx("div",{className:"dropdown-toggle",onClick:n,children:`${o.title}: ${e}`}),o.open&&Je.jsx("ul",{className:"dropdown-menu",children:o.options.map(i=>Je.jsx("li",{onClick:()=>r(i),children:i},i))})]})},Y8=Rn.forwardRef(function(e,t){const n=["Renderer","Depth","Normals","UVs","Wireframe"],[r,i]=Rn.useState("Renderer"),[a,c]=Rn.useState(!1),[h,p]=Rn.useState(!1),[v,x]=Rn.useState(!1);return Je.jsxs("div",{className:`CameraWindow ${e.name}`,children:[Je.jsx("div",{ref:t,className:"clickable",onClick:()=>{v&&x(!1)}}),Je.jsxs("div",{className:"options",children:[e.camera!==null&&Je.jsx(hI,{title:"Camera",index:e.options.indexOf(e.camera.name),open:v,options:e.options,onSelect:e.onSelectCamera,onToggle:S=>{x(S)},up:!0}),Je.jsx(hI,{title:"Mode",index:n.indexOf(r),open:h,options:n,onSelect:S=>{if(S===r)return;const C=S;e.onSelectRenderMode(C),i(C)},onToggle:S=>{a&&c(!1),p(S)},up:!0})]})]})}),Gje=`out vec3 worldPosition;
uniform float uDistance;

void main() {
  // Scale the plane by the drawing distance
  worldPosition = position.xzy * uDistance;
  worldPosition.xz += cameraPosition.xz;

  gl_Position = projectionMatrix * modelViewMatrix * vec4(worldPosition, 1.0);
}`,jje=`out vec4 fragColor;
in vec3 worldPosition;
uniform float uDivisions;
uniform float uScale;
uniform vec3 uColor;
uniform float uDistance;
uniform float uGridOpacity;
uniform float uSubgridOpacity;

float getGrid(float gapSize) {
  vec2 worldPositionByDivision = worldPosition.xz / gapSize;

  // Inverted, 0 where line, >1 where there's no line
  // We use the worldPosition (which in this case we use similarly to UVs) differential to control the anti-aliasing
  // We need to do the -0.5)-0.5 trick because the result fades out from 0 to 1, and we want both
  // worldPositionByDivision == 0.3 and worldPositionByDivision == 0.7 to result in the same fade, i.e. 0.3,
  // otherwise only one side of the line will be anti-aliased
  vec2 grid = abs(fract(worldPositionByDivision-0.5)-0.5) / fwidth(worldPositionByDivision) / 2.0;
  float gridLine = min(grid.x, grid.y);

  // Uninvert and clamp
  return 1.0 - min(gridLine, 1.0);
}

void main() {
  float cameraDistanceToGridPlane = max(200.0, distance(cameraPosition.y, worldPosition.y));
  float cameraDistanceToFragmentOnGridPlane = distance(cameraPosition.xyz, worldPosition.xyz);

  // The size of the grid and subgrid are powers of each other and they are determined based on camera distance.
  // The current grid will become the next subgrid when it becomes too small, and its next power becomes the new grid.
  float subGridPower = pow(uDivisions, floor(log(cameraDistanceToGridPlane) / log(uDivisions)));
  float gridPower = subGridPower * uDivisions;

  // If we want to fade both the grid and its subgrid, we need to displays 3 different opacities, with the next grid being the third
  float nextGridPower = gridPower * uDivisions;

  // 1 where grid, 0 where no grid
  float subgrid = getGrid(subGridPower * uScale);
  float grid = getGrid(gridPower * uScale);
  float nextGrid = getGrid(nextGridPower * uScale);

  // Where we are between the introduction of the current grid power and when we switch to the next grid power
  float stepPercentage = (cameraDistanceToGridPlane - subGridPower)/(gridPower - subGridPower);

  // The last x percentage of the current step over which we want to fade
  float fadeRange = 0.3;

  // We calculate the fade percentage from the step percentage and the fade range
  float fadePercentage = max(stepPercentage - 1.0 + fadeRange, 0.0) / fadeRange;

  // Set base opacity based on how close we are to the drawing distance, with a cubic falloff
  float baseOpacity = subgrid * pow(1.0 - min(cameraDistanceToFragmentOnGridPlane / uDistance, 1.0), 3.0);

  // Shade the subgrid
  fragColor = vec4(uColor.rgb, (baseOpacity - fadePercentage) * uSubgridOpacity);

  // Somewhat arbitrary additional fade coefficient to counter anti-aliasing popping when switching between grid powers
  float fadeCoefficient = 0.5;

  // Shade the grid
  fragColor.a = mix(fragColor.a, baseOpacity * uGridOpacity - fadePercentage * (uGridOpacity - uSubgridOpacity) * fadeCoefficient, grid);

  // Shade the next grid
  fragColor.a = mix(fragColor.a, baseOpacity * uGridOpacity, nextGrid);

  if (fragColor.a <= 0.0) discard;
}`;class Hje extends ff{constructor(e){super({extensions:{derivatives:!0},uniforms:{uScale:{value:(e==null?void 0:e.scale)!==void 0?e==null?void 0:e.scale:.1},uDivisions:{value:(e==null?void 0:e.divisions)!==void 0?e==null?void 0:e.divisions:10},uColor:{value:(e==null?void 0:e.color)!==void 0?e==null?void 0:e.color:new Vn(16777215)},uDistance:{value:(e==null?void 0:e.distance)!==void 0?e==null?void 0:e.distance:1e4},uSubgridOpacity:{value:(e==null?void 0:e.subgridOpacity)!==void 0?e==null?void 0:e.subgridOpacity:.15},uGridOpacity:{value:(e==null?void 0:e.gridOpacity)!==void 0?e==null?void 0:e.gridOpacity:.25}},glslVersion:cj,side:wh,transparent:!0,name:"InfiniteGrid",vertexShader:Gje,fragmentShader:jje})}}class Wje extends Mn{constructor(t){const n=new Hje(t);super(new b6,n);et(this,"gridMaterial");this.gridMaterial=n,this.frustumCulled=!1,this.name="InfiniteGridHelper"}update(){this.gridMaterial.needsUpdate=!0}}function dI(o){const[e,t]=Rn.useState(o.open!==void 0?o.open:!0),n=!e||o.children===void 0,r=()=>{o.app.dispatchEvent({type:br.REMOVE_SCENE,value:o.scene})};return Je.jsxs("div",{className:`accordion ${n?"hide":""}`,children:[Je.jsxs("button",{className:"toggle",onClick:()=>{const i=!e;o.onToggle!==void 0&&o.onToggle(i),t(i)},children:[Je.jsx("p",{className:`status ${e?"open":""}`,children:"Toggle"}),Je.jsx("p",{className:"label",children:Hk(o.label)})]}),o.onRefresh?Je.jsxs(Je.Fragment,{children:[Je.jsx("button",{className:"refresh",onClick:o.onRefresh}),Je.jsx("button",{className:"remove",onClick:r})]}):null,o.button,Je.jsx("div",{className:e?"open":"",children:Je.jsx("div",{children:o.children})},Math.random())]})}function Xw(o){const[e,t]=Rn.useState(o.defaultValue);return Rn.useEffect(()=>{var C,I;let n=!1,r=-1,i=0,a=o.defaultValue,c=!1;const h=L=>{c=L.ctrlKey},p=L=>{var U;n=!0,i=Number((U=o.input.current)==null?void 0:U.value),r=L.clientX,document.addEventListener("mouseup",x,!1),document.addEventListener("mousemove",v,!1),document.addEventListener("contextmenu",x,!1)},v=L=>{if(!n)return;const U=o.step!==void 0?o.step:1,R=(L.clientX-r)*U*(c?10:1);a=Number((i+R).toFixed(4)),o.min!==void 0&&(a=Math.max(a,o.min)),o.max!==void 0&&(a=Math.min(a,o.max)),o.onChange!==void 0&&o.onChange(a),t(a)},x=()=>{n=!1,document.removeEventListener("mouseup",x),document.removeEventListener("mousemove",v),document.removeEventListener("contextmenu",x)},S=L=>{const U=Number(L.target.value);o.onChange!==void 0&&o.onChange(U),t(U)};return(C=o.label.current)==null||C.addEventListener("mousedown",p,!1),o.sliderRef!==void 0&&((I=o.sliderRef.current)==null||I.addEventListener("input",S)),document.addEventListener("keydown",h,!1),document.addEventListener("keyup",h,!1),()=>{var L,U;(L=o.label.current)==null||L.removeEventListener("mousedown",p),o.sliderRef!==void 0&&((U=o.sliderRef.current)==null||U.removeEventListener("input",S)),document.removeEventListener("mouseup",x),document.removeEventListener("mousemove",v),document.removeEventListener("contextmenu",x),document.removeEventListener("keydown",h),document.addEventListener("keyup",h,!1)}},[]),e}function g6(o){const e=Rn.useRef(null),t=Rn.useRef(null),[n,r]=Rn.useState(o.value);return Xw({label:o.labelRef,input:e,sliderRef:t,defaultValue:n,min:o.min,max:o.max,step:o.step,onChange:i=>{r(i),o.onChange!==void 0&&o.onChange(o.prop,i)}}),Je.jsxs(Je.Fragment,{children:[o.type==="number"&&Je.jsx("input",{alt:o.alt,className:o.className,ref:e,type:"number",value:n,min:o.min,max:o.max,step:o.step,disabled:o.disabled,onChange:i=>{if(r(i.target.value),i.target.value.length===0)return;const a=Number(i.target.value);isNaN(a)||o.onChange!==void 0&&o.onChange(o.prop,a)}}),o.type==="range"&&Je.jsxs(Je.Fragment,{children:[Je.jsx("input",{type:"text",value:n.toString(),disabled:o.disabled,ref:e,className:"min",onChange:i=>{if(i.target.value.length===0)return;const a=Number(i.target.value);isNaN(a)||o.onChange!==void 0&&o.onChange(o.prop,a)}}),Je.jsx("input",{disabled:o.disabled,type:"range",value:n,min:o.min,max:o.max,step:o.step,ref:t,onChange:e3e})]})]})}function $je(o){const e=Rn.useRef(null),t=Rn.useRef(null),n=Rn.useRef(null),r=Rn.useRef(null),i=Rn.useRef(null),a=Rn.useRef(null),c=Rn.useRef(null),h=Rn.useRef(null),p=Rn.useRef(null),v=Rn.useRef(null),[x,S]=Rn.useState(o.value.x),[C,I]=Rn.useState(o.value.y),[L,U]=Rn.useState({min:Math.min(o.min,Math.min(o.value.x,o.value.y)),max:Math.max(o.max,Math.max(o.value.x,o.value.y))}),[R,$]=Rn.useState(!1);Xw({label:c,input:e,defaultValue:x,min:L.min,max:L.max,step:.01,onChange:ae=>{S(ae),o.onChange({target:{value:{x:ae,y:C}}})}}),Xw({label:h,input:t,defaultValue:C,min:L.min,max:L.max,step:.01,onChange:ae=>{I(ae),o.onChange({target:{value:{x,y:ae}}})}}),Xw({label:p,input:n,defaultValue:L.min,min:L.min-1,max:L.max+1,step:.01,onChange:ae=>{U({min:ae,max:L.max})}}),Xw({label:v,input:r,defaultValue:L.max,min:L.min-1,max:L.max+1,step:.01,onChange:ae=>{U({min:L.min,max:ae})}});function Z(){R||(window.addEventListener("mousemove",ie),window.addEventListener("mouseup",k),$(!0))}function k(){window.removeEventListener("mousemove",ie),window.removeEventListener("mouseup",k),$(!1)}function ie(ae){const le=i.current.getBoundingClientRect(),J=Q8(0,99,ae.clientX-le.left)/99,Ue=1-Q8(0,99,ae.clientY-le.top)/99,je=sf(bj(L.min,L.max,J),3),rt=sf(bj(L.min,L.max,Ue),3);o.onChange({target:{value:{x:je,y:rt}}}),S(je),I(rt)}function ue(){const ae=Number(n.current.value);U({min:ae,max:L.max}),x<ae&&S(Q8(ae,L.max,x)),C<ae&&I(Q8(ae,L.max,C))}function ce(){const ae=Number(r.current.value);U({min:L.min,max:ae}),x>ae&&S(Q8(L.min,ae,x)),C>ae&&I(Q8(L.min,ae,C))}Rn.useEffect(()=>{a.current.style.left=`${rme(L.min,L.max,x)*100}%`,a.current.style.top=`${(1-rme(L.min,L.max,C))*100}%`},[L,x,C]);const Q=o.step!==void 0?o.step:.01;return Je.jsxs("div",{className:"vector2",children:[Je.jsxs("div",{className:"fields",children:[Je.jsxs("div",{children:[Je.jsx("label",{ref:c,children:"X"}),Je.jsx("input",{ref:e,type:"number",value:x,min:L.min,max:L.max,step:Q,onChange:ae=>{if(S(ae.target.value),ae.target.value.length===0)return;const le=Number(ae.target.value);isNaN(le)||(o.onChange({target:{value:{x:le,y:C}}}),le<L.min&&U({min:le,max:L.max}))}})]}),Je.jsxs("div",{children:[Je.jsx("label",{ref:h,children:"Y"}),Je.jsx("input",{ref:t,type:"number",value:C,min:L.min,max:L.max,step:Q,onChange:ae=>{if(I(ae.target.value),ae.target.value.length===0)return;const le=Number(ae.target.value);isNaN(le)||(o.onChange({target:{value:{x,y:le}}}),le>L.max&&U({min:L.min,max:le}))}})]}),Je.jsxs("div",{children:[Je.jsx("label",{ref:p,children:"Min"}),Je.jsx("input",{ref:n,type:"number",value:L.min,step:Q,onChange:ue})]}),Je.jsxs("div",{children:[Je.jsx("label",{ref:v,children:"Max"}),Je.jsx("input",{ref:r,type:"number",value:L.max,step:Q,onChange:ce})]})]}),Je.jsxs("div",{className:"input",ref:i,onMouseDown:Z,onMouseUp:k,children:[Je.jsx("div",{className:"x"}),Je.jsx("div",{className:"y"}),Je.jsx("div",{className:"pt",ref:a})]})]})}function b2e(o){const e=o.value.x!==void 0&&o.value.y!==void 0&&o.value.z!==void 0,t=o.value.isEuler!==void 0,n=o.value.elements!==void 0,r=o.step!==void 0?o.step:.01,i=[];if(t){const a=Rn.useMemo(()=>o.value,[]);["_x","_y","_z"].forEach(h=>{const p=Rn.useRef(null);i.push(Je.jsxs("div",{children:[Je.jsx("label",{ref:p,children:h.substring(1).toUpperCase()}),Je.jsx(g6,{value:n3e(a[h]),type:"number",prop:h,step:.1,labelRef:p,onChange:(v,x)=>{a[v]=Wk(x),o.onChange({target:{value:a}})}})]},h))})}else if(e){const a=Rn.useMemo(()=>o.value,[]),c=(p,v)=>{a[p]=v,o.onChange({target:{value:a}})};["x","y","z"].forEach(p=>{const v=Rn.useRef(null);i.push(Je.jsxs("div",{children:[Je.jsx("label",{ref:v,children:p.toUpperCase()}),Je.jsx(g6,{value:a[p],type:"number",prop:p,step:r,labelRef:v,onChange:c})]},p))})}else if(n){const a=Rn.useMemo(()=>o.value,[]),c=(h,p)=>{const v=Number(h);a.elements[v]=p,o.onChange({target:{value:a}})};for(let h=0;h<9;h++){const p=Rn.useRef(null);i.push(Je.jsxs("div",{children:[Je.jsx("label",{ref:p,children:h+1}),Je.jsx(g6,{value:a.elements[h],type:"number",prop:h.toString(),step:r,labelRef:p,onChange:c})]},h.toString()))}}return Je.jsx("div",{className:"grid3",children:i},Math.random().toString())}function qje(o){const e=o.value.x!==void 0,t=o.step!==void 0?o.step:.01,n=[];if(e){const r=Rn.useMemo(()=>o.value,[]),i=(c,h)=>{r[c]=h,o.onChange({target:{value:r}})};["x","y","z","w"].forEach(c=>{const h=Rn.useRef(null);n.push(Je.jsxs("div",{children:[Je.jsx("label",{ref:h,children:c.toUpperCase()}),Je.jsx(g6,{value:r[c],type:"number",prop:c,step:t,labelRef:h,onChange:i})]},c))})}else{const r=Rn.useMemo(()=>o.value,[]),i=(a,c)=>{const h=Number(a);r.elements[h]=c,o.onChange({target:{value:r}})};for(let a=0;a<16;a++){const c=Rn.useRef(null);n.push(Je.jsxs("div",{children:[Je.jsx("label",{ref:c,children:a+1}),Je.jsx(g6,{value:r.elements[a],type:"number",prop:a.toString(),step:t,labelRef:c,onChange:i})]},a.toString()))}}return Je.jsx("div",{className:"grid4",children:n})}function Xje(o){return!(o==="defaultAttributeValues"||o==="forceSinglePass"||o==="linecap"||o==="linejoin"||o==="linewidth"||o==="normalMapType"||o==="precision"||o==="shadowSide"||o==="uniformsGroups"||o==="uniformsNeedUpdate"||o==="userData"||o==="version"||o==="wireframeLinecap"||o==="wireframeLinejoin"||o==="wireframeLinewidth"||o.slice(0,4)==="clip"||o.slice(0,7)==="polygon"||o.slice(0,7)==="stencil"||o.slice(0,2)==="is")}function Yje(o){switch(o){case"Alpha Map":return"alphaMap";case"Anisotropy Map":return"anisotropyMap";case"AO Map":return"aoMap";case"Bump Map":return"bumpMap";case"Clearcoat Map":return"clearcoatMap";case"Clearcoat Normal Map":return"clearcoatNormalMap";case"Clearcoat Roughness Map":return"clearcoatRoughnessMap";case"Displacement Map":return"displacementMap";case"Emissive Map":return"emissiveMap";case"Gradient Map":return"gradientMap";case"Iridescence Map":return"iridescenceMap";case"Iridescence Thickness Map":return"iridescenceThicknessMap";case"Map":return"map";case"Matcap":return"matcap";case"Normal Map":return"normalMap";case"Roughness Map":return"roughnessMap";case"Sheen Color Map":return"sheenColorMap";case"Sheen Roughness Map":return"sheenRoughnessMap";case"Specular Color Map":return"specularColorMap";case"Specular Map Intensity":return"specularIntensityMap";case"Thickness Map":return"thicknessMap";case"Transmission Map":return"transmissionMap"}return o}function VI(o){switch(o){case"alphaHash":return"Alpha Hash";case"alphaMap":return"Alpha Map";case"alphaToCoverage":return"Alpha To Coverage";case"anisotropy":return"Anisotropy";case"anisotropyMap":return"Anisotropy Map";case"anisotropyRotation":return"Anisotropy Rotation";case"aoMap":return"AO Map";case"aoMapIntensity":return"AO Map Intensity";case"attenuationColor":return"Attenuation Color";case"attenuationDistance":return"Attenuation Distance";case"blendAlpha":return"Blend Alpha";case"blendColor":return"Blend Color";case"blendDst":return"Blend Dst";case"blendDstAlpha":return"Blend Dst Alha";case"blendEquation":return"Blend Equation";case"blendEquationAlpha":return"Blend Equation Alpha";case"blending":return"Blending";case"blendSrc":return"Blend Src";case"blendSrcAlpha":return"Blend Src Alpha";case"bumpMap":return"Bump Map";case"bumpScale":return"Bump Scale";case"clearcoat":return"Clearcoat";case"clearcoatMap":return"Clearcoat Map";case"clearcoatNormalMap":return"Clearcoat Normal Map";case"clearcoatNormalScale":return"Clearcoat Normal Scale";case"clearcoatRoughness":return"Clearcoat Roughness";case"clearcoatRoughnessMap":return"Clearcoat Roughness Map";case"color":return"Color";case"colorWrite":return"Color Write";case"defines":return"Defines";case"depthFunc":return"Depth Func";case"depthTest":return"Depth Test";case"depthWrite":return"Depth Write";case"dispersion":return"Dispersion";case"displacementBias":return"Displacement Bias";case"displacementMap":return"Displacement Map";case"displacementScale":return"Displacement Scale";case"dithering":return"Dithering";case"emissive":return"Emissive";case"emissiveMap":return"Emissive Map";case"emissiveIntensity":return"Emissive Intensity";case"envMap":return"Environment Map";case"envMapIntensity":return"Environment Map Intensity";case"envMapRotation":return"Environment Map Rotation";case"extensions":return"Extensions";case"flatShading":return"Flat Shading";case"fragmentShader":return"Fragment Shader";case"fog":return"Fog";case"glslVersion":return"GLSL Version";case"gradientMap":return"Gradient Map";case"ior":return"IOR";case"iridescence":return"Iridescence";case"iridescenceIOR":return"Iridescence IOR";case"iridescenceMap":return"Iridescence Map";case"iridescenceThicknessMap":return"Iridescence Thickness Map";case"iridescenceThicknessRange":return"Iridescence Thickness Range";case"lights":return"Lights";case"lightMap":return"Light Map";case"lightMapIntensity":return"Light Map Intensity";case"map":return"Map";case"matcap":return"Matcap";case"metalness":return"Metalness";case"metalnessMap":return"Metalness Map";case"name":return"Name";case"normalMap":return"Normal Map";case"normalScale":return"Normal Scale";case"premultipliedAlpha":return"Premultiplied Alpha";case"opacity":return"Opacity";case"reflectivity":return"Reflectivity";case"refractionRatio":return"Refraction Ratio";case"roughness":return"Roughness";case"roughnessMap":return"Roughness Map";case"sheen":return"Sheen";case"sheenColor":return"Sheen Color";case"sheenColorMap":return"Sheen Color Map";case"sheenRoughness":return"Sheen Roughness";case"sheenRoughnessMap":return"Sheen Roughness Map";case"shininess":return"Shininess";case"side":return"Side";case"size":return"Size";case"sizeAttenuation":return"Size Attenuation";case"specular":return"Specular";case"specularColor":return"Specular Color";case"specularColorMap":return"Specular Color Map";case"specularIntensity":return"Specular Intensity";case"specularIntensityMap":return"Specular Map Intensity";case"thickness":return"Thickness";case"thicknessMap":return"Thickness Map";case"toneMapped":return"Tone Mapped";case"transmission":return"Transmission";case"transmissionMap":return"Transmission Map";case"transparent":return"Transparent";case"type":return"Type";case"uuid":return"UUID";case"uniforms":return"Uniforms";case"vertexColors":return"Vertex Colors";case"vertexShader":return"Vertex Shader";case"visible":return"Visible";case"wireframe":return"Wireframe"}return o}function k5e(o){const e=o.toLowerCase();return e.search("intensity")>-1||e==="anisotropyrotation"||e==="blendalpha"||e==="bumpscale"||e==="clearcoatroughness"||e==="displacementbias"||e==="displacementscale"||e==="metalness"||e==="opacity"||e==="reflectivity"||e==="refractionratio"||e==="roughness"||e==="sheenroughness"}function Kje(){const o=document.createElement("input");return o.type="file",new Promise((e,t)=>{o.addEventListener("change",function(){if(o.files===null)t();else{const n=o.files[0],r=new FileReader;r.onload=function(i){e(i.target.result)},r.readAsDataURL(n)}}),o.click()})}const Zje=[{title:"Front",value:Rg},{title:"Back",value:u0},{title:"Double",value:wh}],Qje=[{title:"No Blending",value:xg},{title:"Normal",value:p6},{title:"Additive",value:EG},{title:"Subtractive",value:TG},{title:"Multiply",value:MG},{title:"Custom",value:q2e}],Jje=[{title:"Add",value:V3},{title:"Subtract",value:X2e},{title:"Reverse Subtract",value:Y2e},{title:"Min",value:K2e},{title:"Max",value:Z2e}],eHe=[{title:"Zero",value:aH},{title:"One",value:lH},{title:"Src Color",value:cH},{title:"One Minus Src Color",value:uH},{title:"Src Alpha",value:hE},{title:"One Minus Src Alpha",value:dE},{title:"Dst Alpha",value:hH},{title:"One Minus Dst Alpha",value:dH},{title:"Dst Color",value:fH},{title:"One Minus Dst Color",value:pH},{title:"Src Alpha Saturate",value:Q2e},{title:"Constant Color",value:mH},{title:"One Minus Constant Color",value:gH},{title:"Constant Alpha",value:yH},{title:"One Minus Constant Alpha",value:vH}],tHe=[{title:"Zero",value:aH},{title:"One",value:lH},{title:"Src Color",value:cH},{title:"One Minus Src Color",value:uH},{title:"Src Alpha",value:hE},{title:"One Minus Src Alpha",value:dE},{title:"Dst Alpha",value:hH},{title:"One Minus Dst Alpha",value:dH},{title:"Dst Color",value:fH},{title:"One Minus Dst Color",value:pH},{title:"Constant Color",value:mH},{title:"One Minus Constant Color",value:gH},{title:"Constant Alpha",value:yH},{title:"One Minus Constant Alpha",value:vH}];function Ow(o,e){o.needsUpdate=!0,o.type="option",o.options=e}function nHe(o,e,t,n){return{type:"boolean",title:VI(o),prop:o,value:e,needsUpdate:!0,onChange:(r,i)=>{n.updateObject(t.uuid,`material.${o}`,i),n.updateObject(t.uuid,"material.needsUpdate",!0);const a=n.getScene(t.uuid);if(a!==null){const c=a.getObjectByProperty("uuid",t.uuid);jo(c,`material.${o}`,i)}}}}function rHe(o,e,t,n){const r={type:"number",title:VI(o),prop:o,value:e,min:void 0,max:void 0,step:.01,needsUpdate:!0,onChange:(i,a)=>{n.updateObject(t.uuid,`material.${o}`,a),n.updateObject(t.uuid,"material.needsUpdate",!0);const c=n.getScene(t.uuid);if(c!==null){const h=c.getObjectByProperty("uuid",t.uuid);jo(h,`material.${o}`,a)}}};switch(o){case"blending":Ow(r,Qje);break;case"blendDst":Ow(r,tHe);break;case"blendEquation":Ow(r,Jje);break;case"blendSrc":Ow(r,eHe);break;case"side":Ow(r,Zje);break}return k5e(o)&&(r.value=Number(e),r.type="range",r.min=Math.min(0,r.value),r.max=Math.max(1,r.value),r.step=.01),r}function iHe(o,e,t,n){const r={type:"string",title:VI(o),prop:o,value:e,needsUpdate:!0,onChange:(a,c)=>{n.updateObject(t.uuid,`material.${o}`,c),n.updateObject(t.uuid,"material.needsUpdate",!0);const h=n.getScene(t.uuid);if(h!==null){const p=h.getObjectByProperty("uuid",t.uuid);jo(p,`material.${o}`,c)}},onKeyDown:a=>{}};return(o==="vertexShader"||o==="fragmentShader")&&(r.disabled=!1,r.latest=r.value,r.onChange=(a,c)=>{r.latest=c,n.updateObject(t.uuid,`material.${o}`,c);const h=n.getScene(t.uuid);if(h!==null){const p=h.getObjectByProperty("uuid",t.uuid);jo(p,`material.${o}`,c)}},r.onKeyDown=a=>{if(a.key==="Enter"&&(a.altKey||a.metaKey)){n.updateObject(t.uuid,"material.needsUpdate",!0);const c=n.getScene(t.uuid);if(c!==null){const h=c.getObjectByProperty("uuid",t.uuid);jo(h,"material.needsUpdate",!0)}}}),r}function sHe(o){return o.x!==void 0&&o.y!==void 0&&o.z===void 0}function oHe(o){return o.x!==void 0&&o.y!==void 0&&o.z!==void 0&&o.w===void 0}function aHe(o){return o.x!==void 0&&o.y!==void 0&&o.z!==void 0&&o.w!==void 0}function tH(o){o.sort((e,t)=>e.title<t.title?-1:e.title>t.title?1:0)}function Yw(o,e,t,n,r="",i=!1){const a=VI(o).split(".")[0].replaceAll("[","").replaceAll("]",""),c=r.length>0?`${r}.${o}`:o,h=typeof e;if(h==="boolean"||h==="string")return{title:a,prop:c,type:h,value:e,disabled:i,onChange:(p,v)=>{n.updateObject(t.uuid,`material.${c}`,v);const x=n.getScene(t.uuid);if(x!==null){const S=x.getObjectByProperty("uuid",t.uuid);jo(S,`material.${c}`,v)}}};if(h==="number"){const p={title:a,prop:c,type:"number",value:e,step:.01,disabled:i,onChange:(v,x)=>{n.updateObject(t.uuid,`material.${c}`,x);const S=n.getScene(t.uuid);if(S!==null){const C=S.getObjectByProperty("uuid",t.uuid);jo(C,`material.${c}`,x)}}};return k5e(a)&&(p.type="range",p.min=0,p.max=1),p}else{if(e.isColor)return{title:a,prop:c,type:"color",value:e,disabled:i,onChange:(p,v)=>{const x=new Vn(v);n.updateObject(t.uuid,`material.${c}`,x);const S=n.getScene(t.uuid);if(S!==null){const C=S.getObjectByProperty("uuid",t.uuid);jo(C,`material.${c}`,x)}}};if(Array.isArray(e)){const p=[];for(const v in e){const x=e[v],S=`[${v.toString()}]`;if(x.value!==void 0){const C=Yw(`${S}.value`,x.value,t,n,c,i);C!==void 0&&p.push(C)}else{const C=Yw(S,x,t,n,c,i);C!==void 0&&p.push(C)}}if(p.length>0)return tH(p),{title:a,items:p}}else{if(sHe(e))return{title:a,prop:c,type:"vector2",value:e,disabled:i,onChange:(p,v)=>{n.updateObject(t.uuid,`material.${c}`,v);const x=n.getScene(t.uuid);if(x!==null){const S=x.getObjectByProperty("uuid",t.uuid);jo(S,`material.${c}`,v)}}};if(oHe(e))return{title:a,prop:c,type:"grid3",value:e,disabled:i,onChange:(p,v)=>{n.updateObject(t.uuid,`material.${c}`,v);const x=n.getScene(t.uuid);if(x!==null){const S=x.getObjectByProperty("uuid",t.uuid);jo(S,`material.${c}`,v)}}};if(aHe(e))return{title:a,prop:c,type:"grid4",value:e,disabled:i,onChange:(p,v)=>{n.updateObject(t.uuid,`material.${c}`,v);const x=n.getScene(t.uuid);if(x!==null){const S=x.getObjectByProperty("uuid",t.uuid);jo(S,`material.${c}`,v)}}};if(e.isEuler)return{title:a,prop:c,type:"euler",value:e,disabled:i,onChange:(p,v)=>{n.updateObject(t.uuid,`material.${c}`,v);const x=n.getScene(t.uuid);if(x!==null){const S=x.getObjectByProperty("uuid",t.uuid);jo(S,`material.${c}`,v)}}};if(e.src!==void 0)return{title:a,type:"image",value:e,disabled:i,onChange:(p,v)=>{const x=Yje(o),S=r.length>0?`${r}.${x}`:x;n.createTexture(t.uuid,`material.${S}`,v);const C=n.getScene(t.uuid);if(C!==null){const I=C.getObjectByProperty("uuid",t.uuid);if(I!==void 0){const L=U=>{const R=I.material,$=S.split(".");switch($.length){case 1:R[$[0]]=U;break;case 2:R[$[0]][$[1]]=U;break;case 3:R[$[0]][$[1]][$[2]]=U;break;case 4:R[$[0]][$[1]][$[2]][$[3]]=U;break;case 5:R[$[0]][$[1]][$[2]][$[3]][$[4]]=U;break}R.needsUpdate=!0};v.src.length>0?qH(v.src).then(U=>{U.offset.set(v.offset[0],v.offset[1]),U.repeat.set(v.repeat[0],v.repeat[1]),L(U)}):L(null)}}}};if(e.elements!==void 0)return{title:a,prop:c,type:e.elements.length>9?"grid4":"grid3",value:e,disabled:i,onChange:(p,v)=>{n.updateObject(t.uuid,`material.${c}`,v);const x=n.getScene(t.uuid);if(x!==null){const S=x.getObjectByProperty("uuid",t.uuid);jo(S,`material.${c}`,v)}}};{const p=[],v=o==="defines"||o==="extensions";try{for(const x in e){const S=e[x];if(S!==void 0)if(S.value!==void 0){const C=Yw(`${x}.value`,S.value,t,n,c,v);C!==void 0&&p.push(C)}else{const C=Yw(x,S,t,n,c,v);C!==void 0&&p.push(C)}}}catch{console.log("Issue cycling through material object:",o,e)}if(p.length>0)return tH(p),{title:a,items:p}}}}}function S2e(o,e,t){const n=[];for(const r in o){if(!Xje(r))continue;const i=typeof o[r],a=o[r];if(i==="boolean")n.push(nHe(r,a,e,t));else if(i==="number")n.push(rHe(r,a,e,t));else if(i==="string")n.push(iHe(r,a,e,t));else if(i==="object"){const c=Yw(r,a,e,t);c!==void 0&&n.push(c)}else a!==void 0&&console.log("other:",r,i,a)}return tH(n),n.push({title:"Update Material",type:"button",onChange:()=>{t.updateObject(e.uuid,"material.needsUpdate",!0);const r=t.getScene(e.uuid);if(r!==null){const i=r.getObjectByProperty("uuid",e.uuid);jo(i,"material.needsUpdate",!0)}}}),n}function lHe(o,e,t){function n(){return`${t.app.appID}_material`}const r=localStorage.getItem(n()),i=r!==null?r==="open":!1;function a(h){localStorage.setItem(n(),h?"open":"closed")}const c=o.material;if(Array.isArray(c)){const h=[],p=c.length;for(let v=0;v<p;v++)h.push(Je.jsx(Nh,{app:e,title:`Material ${v}`,items:S2e(c[v],o,t)},`Material ${v}`));return Je.jsx(Je.Fragment,{children:h})}else return Je.jsx(Nh,{app:e,title:"Material",items:S2e(c,o,t),expanded:i,onToggle:h=>{a(h)}})}const w2e="data:image/gif;base64,R0lGODlhDgFkAIAAAP///wAAACH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgOS4xLWMwMDIgNzkuZGJhM2RhM2I1LCAyMDIzLzEyLzE1LTEwOjQyOjM3ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjUuNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoyMDk3M0NEODAxQjQxMUVGODVGNENDMkUyMUExNDk1NSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDoyMDk3M0NEOTAxQjQxMUVGODVGNENDMkUyMUExNDk1NSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkE4ODc3Qzg5MDFCMzExRUY4NUY0Q0MyRTIxQTE0OTU1IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkE4ODc3QzhBMDFCMzExRUY4NUY0Q0MyRTIxQTE0OTU1Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkEAAAAAAAsAAAAAA4BZAAAAv+Mj6nL7Q+jnLTai7PevPsPhuJIluaJpurKtu4Lx/JM1/aN5/rO9/4PDAqHxKLxiEwql8ym8wmNSqfUqvWKzWq33K73Cw6Lx+Sy+YxOq9fstvsNj8vn9Lr9js/r9/y+/w8YKDhIWGh4iJiouMjY6PgIGSk5SVlpeYmZqTkJAGDQ+dnpuekmGgAKejpKuiZqmprKqoZKGyrbOlqrejub6xvLGyw8TFzcprurGuvqybxq7ETbrItsCz0l7Zpc+6p9/cS967w9/S2FTF0u/mzehK4Oqz3eTl9vf4+fr7/P3+//DzCgwIEECxo8iDChwoUMGzp8CDGixIkUK1q8iDGjxo0XHDt6/AgypMiRJEuaPIkypcqVLFt+KwAAOw==";function cHe(o){const e=o.step!==void 0?o.step:.01,t=Rn.useRef(null),n=Rn.useRef(null),r=Rn.useRef(null),i=Rn.useRef(null),a=Rn.useRef(null),[c]=Rn.useState(o.value),[h,p]=Rn.useState(o.value.offset[0]),[v,x]=Rn.useState(o.value.offset[1]),[S,C]=Rn.useState(o.value.repeat[0]),[I,L]=Rn.useState(o.value.repeat[1]);function U($,Z,k,ie,ue){if(o.onChange!==void 0){const ce=o.prop!==void 0?o.prop:o.title;o.onChange(ce,{src:$,offset:[Z,k],repeat:[ie,ue]})}}function R($){const Z=t.current.src,k=$.target.value;switch($.target){case n.current:p(k),U(Z,k,v,S,I);break;case r.current:x(k),U(Z,h,k,S,I);break;case i.current:C(k),U(Z,h,v,k,I);break;case a.current:L(k),U(Z,h,v,S,k);break}}return Je.jsxs("div",{className:"imageField",children:[Je.jsx("img",{alt:o.title,ref:t,onClick:()=>{Kje().then($=>{t.current.src=$,U($,h,v,S,I)})},src:c.src.length>0?c.src:w2e}),Je.jsxs("div",{className:"fields",children:[Je.jsxs("div",{children:[Je.jsx("label",{children:"Offset:"}),Je.jsx("input",{ref:n,type:"number",value:h,step:e,onChange:R}),Je.jsx("input",{ref:r,type:"number",value:v,step:e,onChange:R})]}),Je.jsxs("div",{children:[Je.jsx("label",{children:"Repeat:"}),Je.jsx("input",{ref:i,type:"number",value:S,step:e,onChange:R}),Je.jsx("input",{ref:a,type:"number",value:I,step:e,onChange:R})]}),Je.jsx("button",{onClick:()=>{U("",h,v,S,I),t.current.src=w2e},children:"Clear"})]})]})}function Ik(o){var p;let e=o.value;e!==void 0&&(e.isColor!==void 0?e=eme(o.value):o.type==="color"&&(e=eme(new Vn().setStyle(o.value,df))));const[t,n]=Rn.useState(e),r=Rn.useRef(null),i=v=>{let x=v.target.value;if(o.type==="boolean")x=v.target.checked;else if(o.type==="option"&&(typeof o.value=="number"?x=Number(x):typeof o.value=="boolean"?x=!!x:typeof o.value=="object"&&(x=JSON.parse(x)),o.options!==void 0)){const S=o.options.length;for(let C=0;C<S&&o.options[C].value!==x;C++);}n(x),o.onChange!==void 0&&o.onChange(o.prop!==void 0?o.prop:o.title,x)},a={};o.disabled&&(a.opacity=.8);const c=o.type==="string"&&(t.length>100||t.search(`
`)>-1),h=c||o.type==="image"||o.type==="vector2";return Je.jsxs("div",{className:`field ${h?"block":""}`,style:a,children:[o.type!=="button"&&Je.jsx("label",{ref:r,children:Hk(o.title)},"fieldLabel"),o.type==="string"&&!c&&Je.jsx("input",{type:"text",disabled:o.disabled,onChange:i,value:t}),o.type==="string"&&c&&Je.jsx("textarea",{cols:50,rows:10,disabled:o.disabled!==void 0?o.disabled:!0,onChange:i,onKeyDown:v=>{o.onKeyDown!==void 0&&o.onKeyDown(v)},value:t}),o.type==="boolean"&&Je.jsx("input",{type:"checkbox",disabled:o.disabled,onChange:i,checked:t}),o.type==="number"&&Je.jsx(g6,{value:t,type:o.type,prop:o.prop!==void 0?o.prop:o.title,min:o.min,max:o.max,step:o.step,disabled:o.disabled,labelRef:r,onChange:o.onChange}),o.type==="range"&&Je.jsx(g6,{value:t,type:o.type,prop:o.prop!==void 0?o.prop:o.title,min:o.min,max:o.max,step:o.step,disabled:o.disabled,labelRef:r,onChange:o.onChange}),o.type==="color"&&Je.jsxs(Je.Fragment,{children:[Je.jsx("input",{type:"text",value:t.toString(),onChange:i,disabled:o.disabled,className:"color"}),Je.jsx("input",{type:"color",value:t,onChange:i,disabled:o.disabled})]}),o.type==="button"&&Je.jsx("button",{disabled:o.disabled,onClick:()=>{o.onChange!==void 0&&o.onChange(o.prop!==void 0?o.prop:o.title,!0)},children:o.title}),o.type==="image"&&Je.jsx(cHe,{title:o.title,prop:o.prop,value:o.value,onChange:o.onChange}),o.type==="option"&&Je.jsx(Je.Fragment,{children:Je.jsx("select",{onChange:i,disabled:o.disabled,defaultValue:o.value,children:(p=o.options)==null?void 0:p.map((v,x)=>Je.jsx("option",{value:v.value,children:Hk(v.title)},x))})}),o.type==="vector2"&&Je.jsx($je,{step:o.step,value:t,min:0,max:1,onChange:i}),o.type==="grid3"&&Je.jsx(b2e,{step:o.step,value:t,onChange:i}),o.type==="grid4"&&Je.jsx(qje,{step:o.step,value:t,onChange:i}),o.type==="euler"&&Je.jsx(b2e,{step:o.step,value:t,onChange:i})]})}function uHe(o){return"items"in o}class Nh extends Rn.Component{constructor(t){super(t);et(this,"subgroupNames",[]);et(this,"subgroupElements",[]);et(this,"valueOverrides",new Map);et(this,"app");this.app=t.app,this.state={lastUpdated:Date.now()}}addGroup(t){const n=[];t.items.forEach(a=>{n.push({type:a.type,prop:a.prop,title:a.title!==void 0?a.title:a.prop,value:a.value,min:a.min,max:a.max,step:a.step,options:a.options,disabled:a.disabled,onChange:(c,h)=>{t.onUpdate(c,h)}})});const r=Rn.createRef(),i=Je.jsx(Nh,{app:this.app,ref:r,title:t.title,items:n},Math.random());return this.subgroupNames.push(t.title),this.subgroupElements.push(i),this.setState({lastUpdated:Date.now()}),r}removeGroup(t){const n=this.subgroupNames.length;for(let r=0;r<n;r++){const i=this.subgroupNames[r];if(t===i){this.subgroupNames.splice(r,1),this.subgroupElements.splice(r,1),this.setState({lastUpdated:Date.now()});return}}}setField(t,n){this.valueOverrides.set(t,n),this.setState({lastUpdated:Date.now()})}render(){const t=[];return this.props.items.forEach(n=>{if(uHe(n))t.push(Je.jsx(Nh,{app:this.app,title:Hk(n.title),items:n.items},Math.random()));else{const r=this.valueOverrides.get(n.title),i=r!==void 0?r:n.value;t.push(Je.jsx(Ik,{title:n.title,prop:n.prop,value:i,type:n.type,min:n.min,max:n.max,step:n.step,disabled:n.disabled,options:n.options,onChange:(a,c)=>{n.onChange!==void 0&&(this.valueOverrides.delete(n.title),n.onChange(a,c))},onKeyDown:a=>{n.onKeyDown!==void 0&&n.onKeyDown(a)}},Math.random()))}}),this.subgroupElements.forEach(n=>t.push(n)),Je.jsx(dI,{app:this.app,label:this.props.title,open:this.props.expanded===!0,onToggle:n=>{var r;this.props.onToggle&&((r=this.props)==null||r.onToggle(n))},children:t})}}const ss=class ss extends Rn.Component{constructor(t){super(t);et(this,"addGroup",t=>{const n=JSON.parse(t.value),r=[];n.items.forEach(i=>{r.push({type:i.type,prop:i.prop,title:i.title!==void 0?i.title:i.prop,value:i.value,min:i.min,max:i.max,step:i.step,options:i.options,disabled:i.disabled,onChange:(a,c)=>{this.props.three.updateGroup(n.title,a,c)}})}),ss.groups.push(Je.jsx(Nh,{app:ss.app,title:n.title,items:r},Math.random())),ss.groupTitles.push(n.title),this.setState({lastUpdate:Date.now()})});et(this,"removeGroup",t=>{const n=t.value,r=ss.groupTitles.length;for(let i=0;i<r;i++)if(n===ss.groupTitles[i]){ss.groups.splice(i,1),ss.groupTitles.splice(i,1),this.setState({lastUpdate:Date.now()});return}});this.state={lastUpdate:Date.now()},ss.app=t.app,ss.instance=this,ss.app.addEventListener(br.ADD_GROUP,this.addGroup),ss.app.addEventListener(br.REMOVE_GROUP,this.removeGroup)}componentWillUnmount(){ss.app.removeEventListener(br.ADD_GROUP,this.addGroup),ss.app.removeEventListener(br.REMOVE_GROUP,this.removeGroup)}render(){return Je.jsx("div",{className:"customGroups",children:ss.groups},this.state.lastUpdate)}static addEditorGroup(t){const n=[];t.items.forEach(a=>{n.push({type:a.type,prop:a.prop,title:a.title!==void 0?a.title:a.prop,value:a.value,min:a.min,max:a.max,step:a.step,options:a.options,disabled:a.disabled,onChange:(c,h)=>{t.onUpdate(c,h)}})});const r=Rn.createRef(),i=Je.jsx(Nh,{app:ss.app,ref:r,title:t.title,items:n},Math.random());return ss.groups.push(i),ss.groupsRefs.push(r),ss.groupTitles.push(t.title),r}static removeEditorGroup(t){const n=ss.groupTitles.length;for(let r=0;r<n;r++)if(t===ss.groupTitles[r]){ss.groups.splice(r,1),ss.groupTitles.splice(r,1),ss.instance.setState({lastUpdate:Date.now()});return}}};et(ss,"instance"),et(ss,"groups",[]),et(ss,"groupsRefs",[]),et(ss,"groupTitles",[]),et(ss,"app");let X_=ss;const pI=class pI extends Rn.Component{constructor(t){super(t);et(this,"app");et(this,"matrix",new vr);et(this,"position",new Ie);et(this,"rotation",new na);et(this,"scale",new Ie);et(this,"open",!1);et(this,"updateTransform",(t,n)=>{const r=t==="rotation"?{x:n._x,y:n._y,z:n._z}:n;this.props.three.updateObject(this.props.object.uuid,t,r);const i=this.props.three.getScene(this.props.object.uuid);if(i){const a=i.getObjectByProperty("uuid",this.props.object.uuid);jo(a,t,r)}});this.app=t.app;const n=localStorage.getItem(this.expandedName),r=n!==null?n==="open":!1;this.open=r,this.saveExpanded(),this.state={lastUpdated:0,expanded:r},this.matrix.elements=t.object.matrix,t.object.uuid.length>0&&(this.position.setFromMatrixPosition(this.matrix),this.rotation.setFromRotationMatrix(this.matrix),this.scale.setFromMatrixScale(this.matrix)),pI.instance=this}update(){if(U0.instance){const t=U0.instance.selectedItem;if(t===void 0)return;this.position.x=sf(t.position.x,3),this.position.y=sf(t.position.y,3),this.position.z=sf(t.position.z,3),this.rotation.copy(t.rotation),this.scale.x=sf(t.scale.x,3),this.scale.y=sf(t.scale.y,3),this.scale.z=sf(t.scale.z,3),this.setState({lastUpdated:Date.now()})}}render(){return Je.jsx(Nh,{app:this.app,title:"Transform",expanded:this.open,items:[{title:"Position",prop:"position",type:"grid3",step:.1,value:this.position,onChange:this.updateTransform},{title:"Rotation",prop:"rotation",type:"euler",value:this.rotation,onChange:this.updateTransform},{title:"Scale",prop:"scale",type:"grid3",value:this.scale,onChange:this.updateTransform},{title:"Visible",prop:"visible",type:"boolean",value:this.props.object.visible,onChange:this.updateTransform}],onToggle:t=>{this.open=t,this.saveExpanded()}},this.state.lastUpdated)}saveExpanded(){localStorage.setItem(this.expandedName,this.open?"open":"closed")}get expandedName(){return`${this.props.three.app.appID}_transform`}};et(pI,"instance");let fI=pI;function dG(o){const[e,t]=Rn.useState(o.selected),n="toggle"+(e?" selected":"");return Je.jsx("button",{className:n,onClick:()=>{const r=!e;t(r),o.onClick(r)},style:{backgroundImage:`url(${o.icon})`,backgroundPositionX:"center",backgroundPositionY:o.top!==void 0?`${o.top}px`:"center",backgroundSize:`${o.width!==void 0?`${o.width}px`:"26px"} ${o.height}px`}},o.name)}const hHe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>

	#if defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
}`,dHe=`
#include <common>
#include <uv_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {
	#include <clipping_planes_fragment>
	gl_FragColor = vec4(vec3(vUv, 0.0), 1.0);
}`;class fHe extends ff{constructor(){super({defines:{USE_UV:""},vertexShader:hHe,fragmentShader:dHe})}}const K8=new jk,L0=new Ie,D3=new Ie,ro=new os,E2e={X:new Ie(1,0,0),Y:new Ie(0,1,0),Z:new Ie(0,0,1)},fG={type:"change"},T2e={type:"mouseDown",mode:null},M2e={type:"mouseUp",mode:null},C2e={type:"objectChange"};class pHe extends q9e{constructor(e,t=null){super(void 0,t);const n=new xHe(this);this._root=n;const r=new bHe;this._gizmo=r,n.add(r);const i=new SHe;this._plane=i,n.add(i);const a=this;function c(Z,k){let ie=k;Object.defineProperty(a,Z,{get:function(){return ie!==void 0?ie:k},set:function(ue){ie!==ue&&(ie=ue,i[Z]=ue,r[Z]=ue,a.dispatchEvent({type:Z+"-changed",value:ue}),a.dispatchEvent(fG))}}),a[Z]=k,i[Z]=k,r[Z]=k}c("camera",e),c("object",void 0),c("enabled",!0),c("axis",null),c("mode","translate"),c("translationSnap",null),c("rotationSnap",null),c("scaleSnap",null),c("space","world"),c("size",1),c("dragging",!1),c("showX",!0),c("showY",!0),c("showZ",!0),c("minX",-1/0),c("maxX",1/0),c("minY",-1/0),c("maxY",1/0),c("minZ",-1/0),c("maxZ",1/0);const h=new Ie,p=new Ie,v=new os,x=new os,S=new Ie,C=new os,I=new Ie,L=new Ie,U=new Ie,R=0,$=new Ie;c("worldPosition",h),c("worldPositionStart",p),c("worldQuaternion",v),c("worldQuaternionStart",x),c("cameraPosition",S),c("cameraQuaternion",C),c("pointStart",I),c("pointEnd",L),c("rotationAxis",U),c("rotationAngle",R),c("eye",$),this._offset=new Ie,this._startNorm=new Ie,this._endNorm=new Ie,this._cameraScale=new Ie,this._parentPosition=new Ie,this._parentQuaternion=new os,this._parentQuaternionInv=new os,this._parentScale=new Ie,this._worldScaleStart=new Ie,this._worldQuaternionInv=new os,this._worldScale=new Ie,this._positionStart=new Ie,this._quaternionStart=new os,this._scaleStart=new Ie,this._getPointer=mHe.bind(this),this._onPointerDown=yHe.bind(this),this._onPointerHover=gHe.bind(this),this._onPointerMove=vHe.bind(this),this._onPointerUp=_He.bind(this),t!==null&&this.connect(t)}connect(e){super.connect(e),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointermove",this._onPointerHover),this.domElement.addEventListener("pointerup",this._onPointerUp),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.style.touchAction="auto"}getHelper(){return this._root}pointerHover(e){if(this.object===void 0||this.dragging===!0)return;e!==null&&K8.setFromCamera(e,this.camera);const t=pG(this._gizmo.picker[this.mode],K8);t?this.axis=t.object.name:this.axis=null}pointerDown(e){if(!(this.object===void 0||this.dragging===!0||e!=null&&e.button!==0)&&this.axis!==null){e!==null&&K8.setFromCamera(e,this.camera);const t=pG(this._plane,K8,!0);t&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(t.point).sub(this.worldPositionStart)),this.dragging=!0,T2e.mode=this.mode,this.dispatchEvent(T2e)}}pointerMove(e){const t=this.axis,n=this.mode,r=this.object;let i=this.space;if(n==="scale"?i="local":(t==="E"||t==="XYZE"||t==="XYZ")&&(i="world"),r===void 0||t===null||this.dragging===!1||e!==null&&e.button!==-1)return;e!==null&&K8.setFromCamera(e,this.camera);const a=pG(this._plane,K8,!0);if(a){if(this.pointEnd.copy(a.point).sub(this.worldPositionStart),n==="translate")this._offset.copy(this.pointEnd).sub(this.pointStart),i==="local"&&t!=="XYZ"&&this._offset.applyQuaternion(this._worldQuaternionInv),t.indexOf("X")===-1&&(this._offset.x=0),t.indexOf("Y")===-1&&(this._offset.y=0),t.indexOf("Z")===-1&&(this._offset.z=0),i==="local"&&t!=="XYZ"?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),r.position.copy(this._offset).add(this._positionStart),this.translationSnap&&(i==="local"&&(r.position.applyQuaternion(ro.copy(this._quaternionStart).invert()),t.search("X")!==-1&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),t.search("Y")!==-1&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),t.search("Z")!==-1&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.position.applyQuaternion(this._quaternionStart)),i==="world"&&(r.parent&&r.position.add(L0.setFromMatrixPosition(r.parent.matrixWorld)),t.search("X")!==-1&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),t.search("Y")!==-1&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),t.search("Z")!==-1&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.parent&&r.position.sub(L0.setFromMatrixPosition(r.parent.matrixWorld)))),r.position.x=Math.max(this.minX,Math.min(this.maxX,r.position.x)),r.position.y=Math.max(this.minY,Math.min(this.maxY,r.position.y)),r.position.z=Math.max(this.minZ,Math.min(this.maxZ,r.position.z));else if(n==="scale"){if(t.search("XYZ")!==-1){let c=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(c*=-1),D3.set(c,c,c)}else L0.copy(this.pointStart),D3.copy(this.pointEnd),L0.applyQuaternion(this._worldQuaternionInv),D3.applyQuaternion(this._worldQuaternionInv),D3.divide(L0),t.search("X")===-1&&(D3.x=1),t.search("Y")===-1&&(D3.y=1),t.search("Z")===-1&&(D3.z=1);r.scale.copy(this._scaleStart).multiply(D3),this.scaleSnap&&(t.search("X")!==-1&&(r.scale.x=Math.round(r.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),t.search("Y")!==-1&&(r.scale.y=Math.round(r.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),t.search("Z")!==-1&&(r.scale.z=Math.round(r.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if(n==="rotate"){this._offset.copy(this.pointEnd).sub(this.pointStart);const c=20/this.worldPosition.distanceTo(L0.setFromMatrixPosition(this.camera.matrixWorld));let h=!1;t==="XYZE"?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(L0.copy(this.rotationAxis).cross(this.eye))*c):(t==="X"||t==="Y"||t==="Z")&&(this.rotationAxis.copy(E2e[t]),L0.copy(E2e[t]),i==="local"&&L0.applyQuaternion(this.worldQuaternion),L0.cross(this.eye),L0.length()===0?h=!0:this.rotationAngle=this._offset.dot(L0.normalize())*c),(t==="E"||h)&&(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this._endNorm.cross(this._startNorm).dot(this.eye)<0?1:-1),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),i==="local"&&t!=="E"&&t!=="XYZE"?(r.quaternion.copy(this._quaternionStart),r.quaternion.multiply(ro.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),r.quaternion.copy(ro.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),r.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent(fG),this.dispatchEvent(C2e)}}pointerUp(e){e!==null&&e.button!==0||(this.dragging&&this.axis!==null&&(M2e.mode=this.mode,this.dispatchEvent(M2e)),this.dragging=!1,this.axis=null)}dispose(){this.disconnect(),this._root.dispose()}attach(e){return this.object=e,this._root.visible=!0,this}detach(){return this.object=void 0,this.axis=null,this._root.visible=!1,this}reset(){this.enabled&&this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent(fG),this.dispatchEvent(C2e),this.pointStart.copy(this.pointEnd))}getRaycaster(){return K8}getMode(){return this.mode}setMode(e){this.mode=e}setTranslationSnap(e){this.translationSnap=e}setRotationSnap(e){this.rotationSnap=e}setScaleSnap(e){this.scaleSnap=e}setSize(e){this.size=e}setSpace(e){this.space=e}}function mHe(o){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:o.button};{const e=this.domElement.getBoundingClientRect();return{x:(o.clientX-e.left)/e.width*2-1,y:-(o.clientY-e.top)/e.height*2+1,button:o.button}}}function gHe(o){if(this.enabled)switch(o.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(o));break}}function yHe(o){this.enabled&&(document.pointerLockElement||this.domElement.setPointerCapture(o.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(o)),this.pointerDown(this._getPointer(o)))}function vHe(o){this.enabled&&this.pointerMove(this._getPointer(o))}function _He(o){this.enabled&&(this.domElement.releasePointerCapture(o.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(o)))}function pG(o,e,t){const n=e.intersectObject(o,!0);for(let r=0;r<n.length;r++)if(n[r].object.visible||t)return n[r];return!1}const ck=new na,ws=new Ie(0,1,0),A2e=new Ie(0,0,0),P2e=new vr,uk=new os,Nk=new os,Wp=new Ie,R2e=new vr,Kw=new Ie(1,0,0),r6=new Ie(0,1,0),Zw=new Ie(0,0,1),hk=new Ie,Fw=new Ie,Lw=new Ie;class xHe extends Ci{constructor(e){super(),this.isTransformControlsRoot=!0,this.controls=e,this.visible=!1}updateMatrixWorld(e){const t=this.controls;t.object!==void 0&&(t.object.updateMatrixWorld(),t.object.parent===null?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):t.object.parent.matrixWorld.decompose(t._parentPosition,t._parentQuaternion,t._parentScale),t.object.matrixWorld.decompose(t.worldPosition,t.worldQuaternion,t._worldScale),t._parentQuaternionInv.copy(t._parentQuaternion).invert(),t._worldQuaternionInv.copy(t.worldQuaternion).invert()),t.camera.updateMatrixWorld(),t.camera.matrixWorld.decompose(t.cameraPosition,t.cameraQuaternion,t._cameraScale),t.camera.isOrthographicCamera?t.camera.getWorldDirection(t.eye).negate():t.eye.copy(t.cameraPosition).sub(t.worldPosition).normalize(),super.updateMatrixWorld(e)}dispose(){this.traverse(function(e){e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()})}}class bHe extends Ci{constructor(){super(),this.isTransformControlsGizmo=!0,this.type="TransformControlsGizmo";const e=new wu({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),t=new vf({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),n=e.clone();n.opacity=.15;const r=t.clone();r.opacity=.5;const i=e.clone();i.color.setHex(16711680);const a=e.clone();a.color.setHex(65280);const c=e.clone();c.color.setHex(255);const h=e.clone();h.color.setHex(16711680),h.opacity=.5;const p=e.clone();p.color.setHex(65280),p.opacity=.5;const v=e.clone();v.color.setHex(255),v.opacity=.5;const x=e.clone();x.opacity=.25;const S=e.clone();S.color.setHex(16776960),S.opacity=.25,e.clone().color.setHex(16776960);const I=e.clone();I.color.setHex(7895160);const L=new gc(0,.04,.1,12);L.translate(0,.05,0);const U=new ma(.08,.08,.08);U.translate(0,.04,0);const R=new _s;R.setAttribute("position",new Ur([0,0,0,1,0,0],3));const $=new gc(.0075,.0075,.5,3);$.translate(0,.25,0);function Z(at,Se){const gt=new i6(at,.0075,3,64,Se*Math.PI*2);return gt.rotateY(Math.PI/2),gt.rotateX(Math.PI/2),gt}function k(){const at=new _s;return at.setAttribute("position",new Ur([0,0,0,1,1,1],3)),at}const ie={X:[[new Mn(L,i),[.5,0,0],[0,0,-Math.PI/2]],[new Mn(L,i),[-.5,0,0],[0,0,Math.PI/2]],[new Mn($,i),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new Mn(L,a),[0,.5,0]],[new Mn(L,a),[0,-.5,0],[Math.PI,0,0]],[new Mn($,a)]],Z:[[new Mn(L,c),[0,0,.5],[Math.PI/2,0,0]],[new Mn(L,c),[0,0,-.5],[-Math.PI/2,0,0]],[new Mn($,c),null,[Math.PI/2,0,0]]],XYZ:[[new Mn(new d6(.1,0),x.clone()),[0,0,0]]],XY:[[new Mn(new ma(.15,.15,.01),v.clone()),[.15,.15,0]]],YZ:[[new Mn(new ma(.15,.15,.01),h.clone()),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new Mn(new ma(.15,.15,.01),p.clone()),[.15,0,.15],[-Math.PI/2,0,0]]]},ue={X:[[new Mn(new gc(.2,0,.6,4),n),[.3,0,0],[0,0,-Math.PI/2]],[new Mn(new gc(.2,0,.6,4),n),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new Mn(new gc(.2,0,.6,4),n),[0,.3,0]],[new Mn(new gc(.2,0,.6,4),n),[0,-.3,0],[0,0,Math.PI]]],Z:[[new Mn(new gc(.2,0,.6,4),n),[0,0,.3],[Math.PI/2,0,0]],[new Mn(new gc(.2,0,.6,4),n),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new Mn(new d6(.2,0),n)]],XY:[[new Mn(new ma(.2,.2,.01),n),[.15,.15,0]]],YZ:[[new Mn(new ma(.2,.2,.01),n),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new Mn(new ma(.2,.2,.01),n),[.15,0,.15],[-Math.PI/2,0,0]]]},ce={START:[[new Mn(new d6(.01,2),r),null,null,null,"helper"]],END:[[new Mn(new d6(.01,2),r),null,null,null,"helper"]],DELTA:[[new _c(k(),r),null,null,null,"helper"]],X:[[new _c(R,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new _c(R,r.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new _c(R,r.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},Q={XYZE:[[new Mn(Z(.5,1),I),null,[0,Math.PI/2,0]]],X:[[new Mn(Z(.5,.5),i)]],Y:[[new Mn(Z(.5,.5),a),null,[0,0,-Math.PI/2]]],Z:[[new Mn(Z(.5,.5),c),null,[0,Math.PI/2,0]]],E:[[new Mn(Z(.75,1),S),null,[0,Math.PI/2,0]]]},ae={AXIS:[[new _c(R,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},le={XYZE:[[new Mn(new S6(.25,10,8),n)]],X:[[new Mn(new i6(.5,.1,4,24),n),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new Mn(new i6(.5,.1,4,24),n),[0,0,0],[Math.PI/2,0,0]]],Z:[[new Mn(new i6(.5,.1,4,24),n),[0,0,0],[0,0,-Math.PI/2]]],E:[[new Mn(new i6(.75,.1,2,24),n)]]},J={X:[[new Mn(U,i),[.5,0,0],[0,0,-Math.PI/2]],[new Mn($,i),[0,0,0],[0,0,-Math.PI/2]],[new Mn(U,i),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new Mn(U,a),[0,.5,0]],[new Mn($,a)],[new Mn(U,a),[0,-.5,0],[0,0,Math.PI]]],Z:[[new Mn(U,c),[0,0,.5],[Math.PI/2,0,0]],[new Mn($,c),[0,0,0],[Math.PI/2,0,0]],[new Mn(U,c),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new Mn(new ma(.15,.15,.01),v),[.15,.15,0]]],YZ:[[new Mn(new ma(.15,.15,.01),h),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new Mn(new ma(.15,.15,.01),p),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new Mn(new ma(.1,.1,.1),x.clone())]]},Ue={X:[[new Mn(new gc(.2,0,.6,4),n),[.3,0,0],[0,0,-Math.PI/2]],[new Mn(new gc(.2,0,.6,4),n),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new Mn(new gc(.2,0,.6,4),n),[0,.3,0]],[new Mn(new gc(.2,0,.6,4),n),[0,-.3,0],[0,0,Math.PI]]],Z:[[new Mn(new gc(.2,0,.6,4),n),[0,0,.3],[Math.PI/2,0,0]],[new Mn(new gc(.2,0,.6,4),n),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new Mn(new ma(.2,.2,.01),n),[.15,.15,0]]],YZ:[[new Mn(new ma(.2,.2,.01),n),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new Mn(new ma(.2,.2,.01),n),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new Mn(new ma(.2,.2,.2),n),[0,0,0]]]},je={X:[[new _c(R,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new _c(R,r.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new _c(R,r.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function rt(at){const Se=new Ci;for(const gt in at)for(let Ae=at[gt].length;Ae--;){const lt=at[gt][Ae][0].clone(),pt=at[gt][Ae][1],De=at[gt][Ae][2],_t=at[gt][Ae][3],Jt=at[gt][Ae][4];lt.name=gt,lt.tag=Jt,pt&&lt.position.set(pt[0],pt[1],pt[2]),De&&lt.rotation.set(De[0],De[1],De[2]),_t&&lt.scale.set(_t[0],_t[1],_t[2]),lt.updateMatrix();const dt=lt.geometry.clone();dt.applyMatrix4(lt.matrix),lt.geometry=dt,lt.renderOrder=1/0,lt.position.set(0,0,0),lt.rotation.set(0,0,0),lt.scale.set(1,1,1),Se.add(lt)}return Se}this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=rt(ie)),this.add(this.gizmo.rotate=rt(Q)),this.add(this.gizmo.scale=rt(J)),this.add(this.picker.translate=rt(ue)),this.add(this.picker.rotate=rt(le)),this.add(this.picker.scale=rt(Ue)),this.add(this.helper.translate=rt(ce)),this.add(this.helper.rotate=rt(ae)),this.add(this.helper.scale=rt(je)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}updateMatrixWorld(e){const n=(this.mode==="scale"?"local":this.space)==="local"?this.worldQuaternion:Nk;this.gizmo.translate.visible=this.mode==="translate",this.gizmo.rotate.visible=this.mode==="rotate",this.gizmo.scale.visible=this.mode==="scale",this.helper.translate.visible=this.mode==="translate",this.helper.rotate.visible=this.mode==="rotate",this.helper.scale.visible=this.mode==="scale";let r=[];r=r.concat(this.picker[this.mode].children),r=r.concat(this.gizmo[this.mode].children),r=r.concat(this.helper[this.mode].children);for(let i=0;i<r.length;i++){const a=r[i];a.visible=!0,a.rotation.set(0,0,0),a.position.copy(this.worldPosition);let c;if(this.camera.isOrthographicCamera?c=(this.camera.top-this.camera.bottom)/this.camera.zoom:c=this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),a.scale.set(1,1,1).multiplyScalar(c*this.size/4),a.tag==="helper"){a.visible=!1,a.name==="AXIS"?(a.visible=!!this.axis,this.axis==="X"&&(ro.setFromEuler(ck.set(0,0,0)),a.quaternion.copy(n).multiply(ro),Math.abs(ws.copy(Kw).applyQuaternion(n).dot(this.eye))>.9&&(a.visible=!1)),this.axis==="Y"&&(ro.setFromEuler(ck.set(0,0,Math.PI/2)),a.quaternion.copy(n).multiply(ro),Math.abs(ws.copy(r6).applyQuaternion(n).dot(this.eye))>.9&&(a.visible=!1)),this.axis==="Z"&&(ro.setFromEuler(ck.set(0,Math.PI/2,0)),a.quaternion.copy(n).multiply(ro),Math.abs(ws.copy(Zw).applyQuaternion(n).dot(this.eye))>.9&&(a.visible=!1)),this.axis==="XYZE"&&(ro.setFromEuler(ck.set(0,Math.PI/2,0)),ws.copy(this.rotationAxis),a.quaternion.setFromRotationMatrix(P2e.lookAt(A2e,ws,r6)),a.quaternion.multiply(ro),a.visible=this.dragging),this.axis==="E"&&(a.visible=!1)):a.name==="START"?(a.position.copy(this.worldPositionStart),a.visible=this.dragging):a.name==="END"?(a.position.copy(this.worldPosition),a.visible=this.dragging):a.name==="DELTA"?(a.position.copy(this.worldPositionStart),a.quaternion.copy(this.worldQuaternionStart),L0.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),L0.applyQuaternion(this.worldQuaternionStart.clone().invert()),a.scale.copy(L0),a.visible=this.dragging):(a.quaternion.copy(n),this.dragging?a.position.copy(this.worldPositionStart):a.position.copy(this.worldPosition),this.axis&&(a.visible=this.axis.search(a.name)!==-1));continue}a.quaternion.copy(n),this.mode==="translate"||this.mode==="scale"?(a.name==="X"&&Math.abs(ws.copy(Kw).applyQuaternion(n).dot(this.eye))>.99&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),a.name==="Y"&&Math.abs(ws.copy(r6).applyQuaternion(n).dot(this.eye))>.99&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),a.name==="Z"&&Math.abs(ws.copy(Zw).applyQuaternion(n).dot(this.eye))>.99&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),a.name==="XY"&&Math.abs(ws.copy(Zw).applyQuaternion(n).dot(this.eye))<.2&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),a.name==="YZ"&&Math.abs(ws.copy(Kw).applyQuaternion(n).dot(this.eye))<.2&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),a.name==="XZ"&&Math.abs(ws.copy(r6).applyQuaternion(n).dot(this.eye))<.2&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1)):this.mode==="rotate"&&(uk.copy(n),ws.copy(this.eye).applyQuaternion(ro.copy(n).invert()),a.name.search("E")!==-1&&a.quaternion.setFromRotationMatrix(P2e.lookAt(this.eye,A2e,r6)),a.name==="X"&&(ro.setFromAxisAngle(Kw,Math.atan2(-ws.y,ws.z)),ro.multiplyQuaternions(uk,ro),a.quaternion.copy(ro)),a.name==="Y"&&(ro.setFromAxisAngle(r6,Math.atan2(ws.x,ws.z)),ro.multiplyQuaternions(uk,ro),a.quaternion.copy(ro)),a.name==="Z"&&(ro.setFromAxisAngle(Zw,Math.atan2(ws.y,ws.x)),ro.multiplyQuaternions(uk,ro),a.quaternion.copy(ro))),a.visible=a.visible&&(a.name.indexOf("X")===-1||this.showX),a.visible=a.visible&&(a.name.indexOf("Y")===-1||this.showY),a.visible=a.visible&&(a.name.indexOf("Z")===-1||this.showZ),a.visible=a.visible&&(a.name.indexOf("E")===-1||this.showX&&this.showY&&this.showZ),a.material._color=a.material._color||a.material.color.clone(),a.material._opacity=a.material._opacity||a.material.opacity,a.material.color.copy(a.material._color),a.material.opacity=a.material._opacity,this.enabled&&this.axis&&(a.name===this.axis||this.axis.split("").some(function(h){return a.name===h}))&&(a.material.color.setHex(16776960),a.material.opacity=1)}super.updateMatrixWorld(e)}}class SHe extends Mn{constructor(){super(new b6(1e5,1e5,2,2),new wu({visible:!1,wireframe:!0,side:wh,transparent:!0,opacity:.1,toneMapped:!1})),this.isTransformControlsPlane=!0,this.type="TransformControlsPlane"}updateMatrixWorld(e){let t=this.space;switch(this.position.copy(this.worldPosition),this.mode==="scale"&&(t="local"),hk.copy(Kw).applyQuaternion(t==="local"?this.worldQuaternion:Nk),Fw.copy(r6).applyQuaternion(t==="local"?this.worldQuaternion:Nk),Lw.copy(Zw).applyQuaternion(t==="local"?this.worldQuaternion:Nk),ws.copy(Fw),this.mode){case"translate":case"scale":switch(this.axis){case"X":ws.copy(this.eye).cross(hk),Wp.copy(hk).cross(ws);break;case"Y":ws.copy(this.eye).cross(Fw),Wp.copy(Fw).cross(ws);break;case"Z":ws.copy(this.eye).cross(Lw),Wp.copy(Lw).cross(ws);break;case"XY":Wp.copy(Lw);break;case"YZ":Wp.copy(hk);break;case"XZ":ws.copy(Lw),Wp.copy(Fw);break;case"XYZ":case"E":Wp.set(0,0,0);break}break;case"rotate":default:Wp.set(0,0,0)}Wp.length()===0?this.quaternion.copy(this.cameraQuaternion):(R2e.lookAt(L0.set(0,0,0),Wp,ws),this.quaternion.setFromRotationMatrix(R2e)),super.updateMatrixWorld(e)}}const nf=class nf extends gf{constructor(){super(...arguments);et(this,"app");et(this,"three");et(this,"activeCamera");et(this,"controls",new Map);et(this,"visibility",new Map);et(this,"setScene",()=>{this.clear()})}setApp(t,n){this.app=t,this.three=n,this.app.addEventListener(br.SET_SCENE,this.setScene)}clear(){for(const t of this.controls.values()){t.detach(),t.disconnect();const n=t.getHelper();pf(n)}this.controls=new Map,this.visibility=new Map}add(t){let n=this.controls.get(t);if(n===void 0){const r=document.querySelector(".clickable");n=new pHe(this.activeCamera,r),n.getHelper().name=t,n.setSpace("local"),this.controls.set(t,n),this.visibility.set(t,!0),n.addEventListener("mouseDown",()=>{this.dispatchEvent({type:nf.DRAG_START})}),n.addEventListener("mouseUp",()=>{this.dispatchEvent({type:nf.DRAG_END})}),n.addEventListener("dragging-changed",i=>{var a;(a=U0.instance)==null||a.toggleOrbitControls(i.value)})}return n}get(t){return this.controls.get(t)}remove(t){const n=this.get(t);return n===void 0?!1:(n.detach(),n.disconnect(),pf(n.getHelper()),this.controls.delete(t),!0)}enabled(t){this.controls.forEach(n=>{n.enabled=t})}updateCamera(t,n){this.activeCamera=t,this.controls.forEach(r=>{r.camera!==t&&(r.camera=t,t.getWorldPosition(r.cameraPosition),t.getWorldQuaternion(r.cameraQuaternion)),r.domElement!==n&&(r.disconnect(),r.domElement=n,r.connect(n))})}show(){this.controls.forEach(t=>{const n=t.getHelper(),r=this.visibility.get(n.name);r!==void 0&&(n.visible=r)})}hide(){this.controls.forEach(t=>{const n=t.getHelper();this.visibility.set(n.name,n.visible),n.visible=!1})}static get instance(){return nf._instance||(nf._instance=new nf),nf._instance}};et(nf,"DRAG_START","Transform::dragStart"),et(nf,"DRAG_END","Transform::dragEnd"),et(nf,"_instance");let Zp=nf;const wHe=new ma,mG=new mr;class k2e extends Ci{constructor(t,n){const r=new Vn(of(.5,1,Math.random()),of(.5,1,Math.random()),of(.5,1,Math.random()));super();et(this,"curve",new d1e);et(this,"line");et(this,"draggable");et(this,"curvePos");et(this,"tension",.5);et(this,"closed",!1);et(this,"subdivide",50);et(this,"curveType");et(this,"offset",1);et(this,"lineMaterial");et(this,"_camera");et(this,"_curvePercentage",0);et(this,"_draggableScale",10);et(this,"_transform");et(this,"raycaster");et(this,"draggedMat",new wu);et(this,"parentGroup");et(this,"group");et(this,"dispose",()=>{this._transform&&(this._transform.removeEventListener("objectChange",this.updateSpline),Zp.instance.remove(this.name)),this.disable(),this.parentGroup.removeGroup(this.name)});et(this,"hideTransform",()=>{var t;(t=this._transform)==null||t.detach()});et(this,"exportSpline",()=>{const t=[];this.draggable.children.forEach(n=>{t.push([sf(n.position.x,3),sf(n.position.y,3),sf(n.position.z,3)])}),iIe({name:this.name,points:t,tension:this.tension,closed:this.closed,subdivide:this.subdivide,type:this.curveType}),console.log("Spline copied!")});et(this,"showPoints",(t=!0)=>{this.draggable.visible=t});et(this,"addPoints",(t=[])=>{if(t.length>0){const n=t.length-1;for(let r=0;r<n;r++)this.addPoint(t[r],!1);this.addPoint(t[n])}else this.addPoint(new Ie(-50,0,0),!1),this.addPoint(new Ie(50,0,0))});et(this,"addPoint",(t,n=!0)=>{const r=this.draggable.children.length,i=new Mn(wHe,this.draggedMat);return i.name=`point_${r}`,i.position.copy(t),i.scale.setScalar(this._draggableScale),this.draggable.add(i),n&&this.updateSpline(),i});et(this,"addNextPt",()=>{var i,a;const t=this.draggable.children.length,n=new Ie(of(-this.offset,this.offset,Math.random()),of(-this.offset,this.offset,Math.random()),of(-this.offset,this.offset,Math.random()));t>0&&n.add(this.draggable.children[t-1].position);const r=this.addPoint(n);(i=this._transform)==null||i.attach(r),(a=this.group.current)==null||a.setField("Current Point",r.position)});et(this,"removePoint",t=>{var n,r,i,a;if(((n=this._transform)==null?void 0:n.object)===t){(r=this._transform)==null||r.detach();const c=this.draggable.children[this.draggable.children.length-1];(i=this._transform)==null||i.attach(c),(a=this.group.current)==null||a.setField("Current Point",c.position)}pf(t),this.updateSpline()});et(this,"removePointAt",t=>{const n=this.draggable.children[t];this.removePoint(n)});et(this,"removeSelectedPt",()=>{var t,n;((t=this._transform)==null?void 0:t.object)!==void 0&&this.removePoint((n=this._transform)==null?void 0:n.object)});et(this,"updateSpline",()=>{this.curve=new d1e(this.points,this.closed,this.curveType,this.tension),this.line.geometry.setFromPoints(this.getPoints()),this.curvePos.position.copy(this.getPointAt(this._curvePercentage))});et(this,"onMouseClick",t=>{var a,c,h;if(!U0.instance||this._transform&&!this._transform.getHelper().visible)return;const r=U0.instance.currentWindow.current.getBoundingClientRect();mG.x=(t.clientX-r.x)/r.width*2-1,mG.y=-((t.clientY-r.y)/r.height)*2+1,this.raycaster.setFromCamera(mG,this.camera);const i=this.raycaster.intersectObjects(this.draggable.children,!1);if(i.length>0){const p=i[0].object;p!==((a=this._transform)==null?void 0:a.object)&&((c=this._transform)==null||c.attach(p),(h=this.group.current)==null||h.setField("Current Point",p.position))}});et(this,"onUpdateTransform",()=>{var t,n,r;if((t=this._transform)!=null&&t.object&&this.group){const i=(n=this._transform)==null?void 0:n.object;i.name.search("point")>-1&&((r=this.group.current)==null||r.setField("Current Point",i.position))}this.updateSpline()});et(this,"debugPoint",t=>{t.name,t.visible=this.draggable.visible});this.name=t,this.lineMaterial=new vf({color:r}),this.line=new _c(new _s,this.lineMaterial),this.line.name="line",this.add(this.line),this._camera=n,this.curveType="catmullrom",this.draggedMat.color=r,this.draggable=new Ci,this.draggable.name="draggablePoints",this.add(this.draggable),this.curvePos=new Mn(new S6(1.5),new wu({color:r})),this.curvePos.name="curvePos",this.curvePos.scale.setScalar(this._draggableScale),this.curvePos.visible=!1,this.add(this.curvePos),this.raycaster=new jk,this.raycaster.params.Line.threshold=3,this.enable()}enable(){document.addEventListener("pointerdown",this.onMouseClick)}disable(){document.removeEventListener("pointerdown",this.onMouseClick)}getPointAt(t){return this.curve.getPointAt(t)}getPoints(){return this.curve.getPoints(this.subdivide)}getTangentAt(t){return this.curve.getTangentAt(t)}get points(){const t=[];return this.draggable.children.forEach(n=>{t.push(n.position)}),t}get total(){return this.draggable.children.length}get draggableScale(){return this._draggableScale}set draggableScale(t){this._draggableScale=t,this.draggable.children.forEach(n=>n.scale.setScalar(t)),this.curvePos.scale.setScalar(t)}get camera(){return this._camera}set camera(t){this._camera=t,this._transform!==void 0&&(this._transform.camera=t)}get curvePercentage(){return this._curvePercentage}set curvePercentage(t){this._curvePercentage=t,this.curvePos.position.copy(this.getPointAt(t))}initDebug(t){var i;const n=this.draggable.children;this.parentGroup=t,this._transform=Zp.instance.add(this.name),this._transform.camera=this._camera,this._transform.addEventListener("objectChange",this.onUpdateTransform),this._transform.attach(n.length>0?n[n.length-1]:this),(i=U0.instance)==null||i.scene.add(this._transform.getHelper());const r=n.length>0?n[n.length-1].position:{x:0,y:0,z:0};this.group=t.addGroup({title:this.name,items:[{prop:"Closed",type:"boolean",value:this.closed},{prop:"Visible",type:"boolean",value:this.visible},{prop:"Show Position",type:"boolean",value:this.curvePos.visible},{prop:"Show Points",type:"boolean",value:this.draggable.visible},{prop:"Color",type:"color",value:`#${this.draggedMat.color.getHexString()}`},{prop:"Curve",type:"option",options:[{title:"Catmullrom",value:"catmullrom"},{title:"Centripetal",value:"centripetal"},{title:"Chordal",value:"chordal"}]},{prop:"Draggable Scale",type:"range",min:.01,max:100,step:.01,value:this._draggableScale},{prop:"Subdivide",type:"range",min:1,max:100,step:1,value:this.subdivide},{prop:"Tension",type:"range",min:0,max:1,step:.01,value:this.tension},{prop:"New Pt Offset",type:"range",min:0,max:10,value:this.offset},{prop:"Curve At",type:"range",min:0,max:1,step:.01,value:0},{prop:"Toggle Transform",type:"button"},{prop:"Add Point",type:"button"},{prop:"Remove Point",type:"button"},{prop:"Export",type:"button"},{prop:"Delete",type:"button"},{prop:"Current Point",type:"grid3",value:r}],onUpdate:(a,c)=>{var h,p;switch(a){case"Closed":this.closed=c,this.updateSpline();break;case"Visible":this.visible=c;break;case"Color":this.lineMaterial.color.setStyle(c),this.draggedMat.color.setStyle(c);break;case"Curve":this.curveType=c,this.updateSpline();break;case"Draggable Scale":this.draggableScale=c;break;case"Subdivide":this.subdivide=c,this.updateSpline();break;case"Tension":this.tension=c,this.updateSpline();break;case"New Pt Offset":this.offset=c;break;case"Curve At":this.curvePos.position.copy(this.getPointAt(c));break;case"Show Position":this.curvePos.visible=c;break;case"Show Points":this.draggable.visible=c;break;case"Toggle Transform":this._transform&&(this._transform.getHelper().visible=!this._transform.getHelper().visible);break;case"Add Point":this.addNextPt();break;case"Remove Point":this.removeSelectedPt();break;case"Export":this.exportSpline();break;case"Delete":pf(this);break;case"Current Point":if(this.group.current&&((h=this._transform)!=null&&h.object)){const v=(p=this._transform)==null?void 0:p.object;v.name.search("point")>-1&&(v.position.copy(c),this.updateSpline())}break}}}),this.draggable.children.forEach(a=>{this.debugPoint(a)})}}let dk=0;class EHe extends Ci{constructor(t,n){super();et(this,"defaultScale",10);et(this,"_camera");et(this,"group",null);et(this,"app");et(this,"createSpline",(t=[])=>{const n=`Spline ${dk+1}`,r=new k2e(n,this._camera);return r.addPoints(t),this.addSpline(r),dk++,r});et(this,"createSplineFromArray",t=>{const n=[];return t.forEach(r=>{n.push(new Ie(r[0],r[1],r[2]))}),this.createSpline(n)});et(this,"createSplineFromCatmullRom",t=>this.createSpline(t.points));et(this,"createSplineFromJSON",t=>{const n=this.createSplineFromArray(t.points);return n.name=t.name,n.closed=t.closed,n.subdivide=t.subdivide,n.tension=t.tension,n.type=t.type,n.updateSpline(),n});et(this,"showPoints",(t=!0)=>{this.children.forEach(n=>{n.showPoints(t)})});et(this,"onAddSpline",t=>{const n=JSON.parse(t.value),r=`Spline ${dk+1}`,i=[];n.points.forEach(c=>{i.push(new Ie(c[0],c[1],c[2]))});const a=new k2e(r,this.camera);a.addPoints(i),this.addSpline(a),dk++});this.name="Spline Editor",this._camera=t,this.app=n,this.app.addEventListener(br.ADD_SPLINE,this.onAddSpline)}initDebug(){this.group=X_.addEditorGroup({title:this.name,items:[{type:"button",prop:"New Spline"},{type:"boolean",prop:"Show Points",value:!0},{type:"boolean",prop:"Visible",value:this.visible},{type:"range",prop:"Default Scale",min:0,max:50,step:.01,value:this.defaultScale}],onUpdate:(t,n)=>{switch(t){case"New Spline":this.createSpline();break;case"Show Points":this.showPoints(n);break;case"Visible":this.visible=n;break;case"Default Scale":this.defaultScale=n;break}}})}dispose(){this.app.removeEventListener(br.ADD_SPLINE,this.onAddSpline),X_.removeEditorGroup(this.name)}addSpline(t){var n;t.draggableScale=this.defaultScale,t.hideTransform(),((n=this.group)==null?void 0:n.current)!==null&&t.initDebug(this.group.current),this.add(t)}get camera(){return this._camera}set camera(t){this._camera=t,this.children.forEach(n=>{const r=n;r.camera=t})}}const I2e=["Single","Side by Side","Stacked","Quad"],THe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC60lEQVRYhe2YT4hNcRTHP48xpmYaNAvRyEQxEhnKQljYsRm9/EmSyJiMFAsMZWNhJYoNIUVJ2VGiyb9ZzIpMpkQSahbGv9GMYWrM+1rc2zjvzvvdd+99rzdvMd+6de75nd+5387vnN/v/G5KEuWMKRNNIB8mCRaKiiL5qQb2ApuBuUAV0Ad0AJeB3sSeJRX6LJbULTf6JTUn9Z+KWMUpPyp/Avoa4CNQZ3Sj/lNpdL/xottR7AjOkHRUUpekN5I6JbVLavDH75lIfZN0UFKTpCWS0pJem/HeJBEMG6yV1ONYtgFJbZJ+GF1jDh+zJb03NuliEuwMkMo4yErS2RA/LcbuYVyCrm1mA7Dal/8Cu4FG4JD/HsTTkCy6a+SVMTPQuc1sBKb78nHghi+/A+YBxwL2lbhRY+ThuARdEVxu5JdGFvACr0otdoZ8Y4+Rn0Sn5sFFsMvI6YB9MzA1YJ8mN8k1wAHzfj4uQVdyrpI0aJL7oqTtkq4FiqPLyCOSbktqlbRL0jlJQ2b8QdwCUZ4qvhRStZL0XFK1pMd57CRvq5mfhKBriRfiFUMY6oD7eOdwPlQAN4G10dfWg+uouwXsiOssAj4AC+JMcEWwvnAuOTEr7gTXPmg34zagOwkbIIOXAo9CbDYBrcBXYN+4UUdy2sRflyS5zVNlfPX7ugpJW5V9nI7mmh+lYU0lCZ2B3TOnAVuAk0BTwC5nuhWro46KauBOQJch5OpRaoIW34GreGf+YZdRqS9NAj4Bp4ClQDvwOWxCqSM4ADQEdKE5XvbXzlITrAVe4TW+M6NMKDXBFLAMuAD0ACfIc7pMZBXXA2cY3/xmodQRHAL2A2+NLtj8ZiEKwUL/z2WMPAJcAVYALWSf8dZuDFGWeBHwKxm3sWYhiGG8Tfo6sA2vSfiSy4GrH3wGrDcfKSSKKf6v1E9yF0XK9Q1XBPuMXMw8HXTonQFwETwNzMFr64v1jzgFHIk9ybHEZYPJo65QlD3Bf2/Q/eaHPiSWAAAAAElFTkSuQmCC",MHe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAACXBIWXMAAAsTAAALEwEAmpwYAAAETklEQVRYhe2YXYhVVRTHf3d0/JhyUrMpFbImM+whSa3Mynww+4AeIgiKoozooQ+KyMyXIAujF6OXqHyI6iEKKYgIP/owsjSFqCkprdDUTEcjbWZ0HHV+Pex1ucfb9Z57Z9REXHA4Z++99l7/s/ZZ/7X2KaiczNLwfwPIk9MA+yunNMAG4DHgV+BvoB3YFff2TPstYEyfrajVroI6Sr1GvahsbJC63HzZq04pmztSvU5tVRuqYRiYg78JeBR4HPg5ntdmxovz9wJfA3uAxuibDLQCA+IqynnAQuBuYCnwMLC1rx48U12U8cZqdWqMDcx4cI16qTpYbVKHqa+ovWUeHKsujn7VL9ULq2HI+wY7gVeBJdGeFu3J4ZUiy/cAXeHRRuAQsC/GC0B3eG4BcH/0tUV7czUAeVsMsBF4Kha9HZgCvAncAuwPnXHA0wFuGLANuDrGuoGDwFxgTqzzQ7RX5FrP2eLsdb76vnogtme6+nE8H1YPlQXHwbi3q9eqn0e7Tb25VrsF68vFY0lb1AGcDTwItGQ8tQM4AIwGmqP/EPAu8A0wElgJfFGzxTo8mKWXu9Rd4ZF96jvqjSbauEC9Sn1O3R463epLaku99voCsFXdkAH3kNpcQW+IiT/bQne3eufxBtioPqP2mKhioXpWzpxb1T8C5Ifh4ZptVoriRmAIKdrI3Lujf3bobAPeJpF0NVkKrAFuI9HTOBIxnxFrF4OgQKKr/dnJlQA+AcwABgOHA4zAamA5cE7orQL+zAEHiWI+A2bFC7aSguheYCgpqAphZz3wSB7AecCICv2TgH8oFRib4gVqka0k0h8CXAxMBW6ooDejFoCvA9OBQUAvKWM0kDz4XUZvNKXtyZMWUl7vBbaQXq457PeEziDgx/KJlQAuIPFdMcEXv5OdYWBP9M8k8VpnDQCvB4aTSrCNJB5cSdrW3tBpIJVnR0qdUTxAfdGUOVTnmwqEanNmqltC/9OgqePKg5eom8PgdvW+oJ9Kupera0O3U50TL3lcAaI+oHaF4R3qa6Z822wq0Saq89T1lmSxOrxeW/Xm4uGkiqQDmECKuKHxHW0HdpMiewSpvGqKeR8Ay0iBsYIjg6261PE2o9Q3Yqv+MqWxO9R1Hl12qs+q49Vlppy82pSr+5xJKsko4AXgHlJ0t5NIeg3wLXAlqZhtIUV8J6nmWwX8QiLjdhL5TwMWkY4R6/rrwYKlMr1Y321QZ/vfwBijPqm+rF4Wc7PjE9QllurGVeoV5gRNHsAm9fnMom3qrKPoTjKdMXaYyrFygEWQ72XWW24qhPu8xcUc2UU6O8wFPjmK7jhgPHAuMJGUGQ6U6WwE5sfzTXGvei7KA9hFOiR9D/wOfFVFt4dS2tpfRe83Ur7/CPiJakfOGgBCypubatArl2r8VfOax/LfzABKtePAzHO/5FgC7KBEzB2kOrDfUm8mOeFySv9+OyFyGmB/5aQH+C9BVKmVCNuMZgAAAABJRU5ErkJggg==",CHe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVCAYAAACpF6WWAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAQ0lEQVQ4jWP8////fwYqAxYozUhFM/8zkaKYWIWkGEq0b0ZdSjQY5i79TyWagRGaTUdzFEEw6lLqGzqwLoVVJ1StpwA9sBwbUqAh5gAAAABJRU5ErkJggg==",mI=class mI extends Rn.Component{constructor(t){super(t);et(this,"app");et(this,"scene");et(this,"renderer");et(this,"currentScene");et(this,"cameras",new Map);et(this,"controls",new Map);et(this,"currentCamera");et(this,"currentWindow");et(this,"cameraHelpers",new Map);et(this,"lightHelpers",new Map);et(this,"helpersContainer",new h6);et(this,"grid",new Wje);et(this,"interactionHelper",new xCe(25));et(this,"currentTransform");et(this,"splineEditor");et(this,"depthMaterial",new B9e);et(this,"normalsMaterial",new L9e);et(this,"uvMaterial",new fHe);et(this,"wireframeMaterial",new wu({opacity:.33,transparent:!0,wireframe:!0}));et(this,"playing",!1);et(this,"rafID",-1);et(this,"cameraControlsRafID",-1);et(this,"width",0);et(this,"height",0);et(this,"sceneSet",!1);et(this,"tlCam",null);et(this,"trCam",null);et(this,"blCam",null);et(this,"brCam",null);et(this,"tlRender","Renderer");et(this,"trRender","Renderer");et(this,"blRender","Renderer");et(this,"brRender","Renderer");et(this,"cameraVisibility",!0);et(this,"lightVisibility",!0);et(this,"gridVisibility",!0);et(this,"selectedItem");et(this,"debugCamera");et(this,"raycaster",new jk);et(this,"pointer",new mr);et(this,"cameraControls");et(this,"canvasRef");et(this,"containerRef");et(this,"tlWindow");et(this,"trWindow");et(this,"blWindow");et(this,"brWindow");et(this,"setupRenderer",t=>{this.renderer&&this.renderer.dispose();const n=this.canvasRef.current,r=t.value;r.type==="WebGLRenderer"?(this.renderer=new tE({canvas:n,stencil:!1}),this.grid.visible=!0):r.type==="WebGPURenderer"&&(this.renderer=new rG({canvas:n,stencil:!1}),this.grid.visible=!1),this.renderer&&(this.renderer.autoClear=!1,this.renderer.shadowMap.enabled=!0,this.renderer.setPixelRatio(devicePixelRatio),this.renderer.setClearColor(0),this.resize(),this.props.three.renderer=this.renderer)});et(this,"onUpdate",()=>{this.playing&&(this.update(),this.draw(),this.rafID=requestAnimationFrame(this.onUpdate))});et(this,"resize",()=>{var c;this.width=window.innerWidth-300,this.height=window.innerHeight,(c=this.renderer)==null||c.setSize(this.width,this.height);const t=Math.floor(this.width/2),n=Math.floor(this.height/2);this.props.three.resize(this.width,this.height),this.props.onSceneResize!==void 0&&this.sceneSet&&this.currentScene!==void 0&&this.props.onSceneResize(this.currentScene,this.width,this.height);let r=this.width,i=this.height;switch(this.state.mode){case"Side by Side":r=t,i=this.height;break;case"Stacked":r=this.width,i=n;break;case"Quad":r=t,i=n;break}const a=r/i;this.cameras.forEach(h=>{var p;h instanceof wE?(h.left=r/-2,h.right=r/2,h.top=i/2,h.bottom=i/-2,h.name==="UI"&&(h.position.x=this.width/2,h.position.y=this.height/-2,h.position.z=100),h.updateProjectionMatrix()):h instanceof La&&(h.aspect=a,h.updateProjectionMatrix()),(p=this.cameraHelpers.get(h.name))==null||p.update()})});et(this,"sceneUpdate",t=>{this.clearLightHelpers(),this.scene.remove(this.currentScene),pf(this.currentScene);const n=this.props.scenes.get(t.value.name);if(n!==void 0){const r=new n;this.props.onSceneSet!==void 0&&this.props.onSceneSet(r),this.currentScene=r,this.props.three.scene=this.currentScene,this.scene.add(this.currentScene),this.sceneSet=!0,this.addLightHelpers()}});et(this,"addCamera",t=>{var i;const n=t.value,r=(i=this.props.three.scene)==null?void 0:i.getObjectByProperty("uuid",n.uuid);if(r!==void 0){const a=r;this.cameras.set(n.name,a);const c=new _Ce(a);c.visible=this.cameraVisibility,this.cameraHelpers.set(a.name,c),this.scene.add(c),this.setState({lastUpdate:Date.now()})}});et(this,"removeCamera",t=>{const n=this.cameraHelpers.get(t.value.name);n!==void 0&&(this.scene.remove(n),n.dispose()),this.cameras.delete(t.value.name),this.setState({lastUpdate:Date.now()})});et(this,"onMouseMove",t=>{var x;const n=new mr;(x=this.renderer)==null||x.getSize(n);const r=Math.min(t.clientX,n.x),i=Math.min(t.clientY,n.y);this.pointer.x=J8(r,0,n.x,-1,1),this.pointer.y=J8(i,0,n.y,1,-1);const a=n.x/2,c=n.y/2,h=()=>{r<a?this.pointer.x=J8(r,0,a,-1,1):this.pointer.x=J8(r,a,n.x,-1,1)},p=()=>{i<c?this.pointer.y=J8(i,0,c,1,-1):this.pointer.y=J8(i,c,n.y,1,-1)};switch(this.state.mode){case"Quad":h(),p();break;case"Side by Side":h();break;case"Stacked":p(),p();break}if(this.updateCamera(r,i,a,c),this.state.interactionMode==="Orbit")return;const v=this.raycaster.intersectObjects(this.currentScene.children);v.length>0&&this.interactionHelper.position.copy(v[0].point)});et(this,"onClick",t=>{if(this.state.interactionMode==="Orbit")return;const n=new mr;if(this.renderer.getSize(n),t.clientX>=n.x)return;this.onMouseMove(t);const r=this.raycaster.intersectObjects(this.currentScene.children);r.length>0&&(this.props.three.getObject(r[0].object.uuid),this.interactionHelper.visible=!1,this.setState({interactionMode:"Orbit",lastUpdate:Date.now()}))});et(this,"onKey",t=>{if(this.selectedItem!==void 0){if(t.ctrlKey){if(this.currentCamera.name==="UI")return;const n=this.controls.get(this.currentCamera.name);t.key==="0"?(t.preventDefault(),this.clearControls(),this.cameraControls=new Xp(this.currentCamera,this.currentWindow.current),this.selectedItem instanceof Mn||this.selectedItem instanceof NH?(this.selectedItem.geometry.computeBoundingBox(),this.cameraControls.fitToBox(this.selectedItem.geometry.boundingBox,!0)):this.cameraControls.fitToSphere(this.selectedItem,!0),this.updateCameraControls(n,!0)):t.key==="1"?(t.preventDefault(),this.clearControls(),this.cameraControls=new Xp(this.currentCamera,this.currentWindow.current),this.cameraControls.rotateTo(0,Math.PI*.5,!0),this.cameraControls.moveTo(this.selectedItem.position.x,this.selectedItem.position.y,0,!0),this.updateCameraControls(n)):t.key==="2"?(t.preventDefault(),this.clearControls(),this.cameraControls=new Xp(this.currentCamera,this.currentWindow.current),this.cameraControls.rotateTo(0,0,!0),this.cameraControls.moveTo(this.selectedItem.position.x,0,this.selectedItem.position.z,!0),this.updateCameraControls(n)):t.key==="3"?(t.preventDefault(),this.clearControls(),this.cameraControls=new Xp(this.currentCamera,this.currentWindow.current),this.cameraControls.rotateTo(Math.PI/2,Math.PI/2,!0),this.cameraControls.moveTo(0,this.selectedItem.position.y,this.selectedItem.position.z,!0),this.updateCameraControls(n)):t.key==="4"?(t.preventDefault(),this.clearControls(),this.cameraControls=new Xp(this.currentCamera,this.currentWindow.current),this.cameraControls.rotateTo(Math.PI,Math.PI/2,!0),this.cameraControls.moveTo(this.selectedItem.position.x,this.selectedItem.position.y,0,!0),this.updateCameraControls(n)):t.key==="5"&&(t.preventDefault(),this.clearControls(),this.cameraControls=new Xp(this.currentCamera,this.currentWindow.current),this.cameraControls.rotateTo(Wk(45),Wk(45),!0),this.updateCameraControls(n))}else if(this.currentTransform!==void 0)switch(t.key){case"r":this.currentTransform.setMode("rotate");break;case"s":this.currentTransform.setMode("scale");break;case"t":this.currentTransform.setMode("translate");break;case"q":this.currentTransform.setSpace(this.currentTransform.space==="local"?"world":"local");break}}});et(this,"onSetSelectedItem",t=>{this.selectedItem!==void 0&&this.updateSelectedItemHelper(!1),this.selectedItem=this.currentScene.getObjectByProperty("uuid",t.value.uuid),this.selectedItem!==void 0&&(this.currentTransform!==void 0&&(this.currentTransform.removeEventListener("objectChange",this.onUpdateTransform),Zp.instance.remove(this.currentTransform.getHelper().name)),this.currentTransform=Zp.instance.add(t.value.name),this.currentTransform.attach(this.selectedItem),this.scene.add(this.currentTransform.getHelper()),this.currentTransform.addEventListener("objectChange",this.onUpdateTransform),this.updateSelectedItemHelper(!0))});et(this,"onUpdateTransform",()=>{this.selectedItem!==void 0&&(this.props.three.updateObject(this.selectedItem.uuid,"position",this.selectedItem.position),this.props.three.updateObject(this.selectedItem.uuid,"rotation",{x:this.selectedItem.rotation.x,y:this.selectedItem.rotation.y,z:this.selectedItem.rotation.z}),this.props.three.updateObject(this.selectedItem.uuid,"scale",this.selectedItem.scale),fI.instance.update())});et(this,"clearLightHelpers",()=>{this.lightHelpers.forEach(t=>{this.helpersContainer.remove(t),t.dispose()}),this.lightHelpers.clear()});et(this,"addLightHelpers",()=>{this.currentScene!==void 0&&this.currentScene.traverse(t=>{if(t.type.search("Light")>-1){let n;switch(t.type){case"DirectionalLight":n=new vCe(t,100),n.name=`${t.name}Helper`,n.visible=this.lightVisibility,this.lightHelpers.set(t.name,n),this.helpersContainer.add(n);break;case"HemisphereLight":n=new yCe(t,250),n.name=`${t.name}Helper`,n.visible=this.lightVisibility,this.lightHelpers.set(t.name,n),this.helpersContainer.add(n);break;case"RectAreaLight":n=new Eje(t),n.name=`${t.name}Helper`,n.visible=this.lightVisibility,this.lightHelpers.set(t.name,n),this.helpersContainer.add(n);break;case"PointLight":n=new mCe(t,100),n.name=`${t.name}Helper`,n.visible=this.lightVisibility,this.lightHelpers.set(t.name,n),this.helpersContainer.add(n);break;case"SpotLight":n=new fCe(t),n.name=`${t.name}Helper`,n.visible=this.lightVisibility,this.lightHelpers.set(t.name,n),this.helpersContainer.add(n);break}}})});et(this,"updateCamera",(t,n,r,i)=>{switch(this.state.mode){case"Quad":n<i?t<r?this.currentCamera=this.tlCam:this.currentCamera=this.trCam:t<r?this.currentCamera=this.blCam:this.currentCamera=this.brCam;break;case"Side by Side":t<r?this.currentCamera=this.tlCam:this.currentCamera=this.trCam;break;case"Single":this.currentCamera=this.tlCam;break;case"Stacked":n<i?this.currentCamera=this.tlCam:this.currentCamera=this.trCam;break}this.splineEditor.camera=this.currentCamera,this.raycaster.setFromCamera(this.pointer,this.currentCamera),this.currentCamera===this.tlCam?this.currentWindow=this.tlWindow:this.currentCamera===this.trCam?this.currentWindow=this.trWindow:this.currentCamera===this.blCam?this.currentWindow=this.blWindow:this.currentCamera===this.brCam&&(this.currentWindow=this.brWindow),Zp.instance.updateCamera(this.currentCamera,this.currentWindow.current)});et(this,"updateCameraControls",(t,n=!1)=>{if(this.selectedItem===void 0)return;cancelAnimationFrame(this.cameraControlsRafID),this.cameraControlsRafID=-1,this.cameraControls&&(this.cameraControls.smoothTime=.1);const r=.15,i=new W9e;i.start(),this.selectedItem.getWorldPosition(t.target0);const a=()=>{const c=i.getDelta();this.cameraControls&&this.cameraControls.update(c),n&&(t.target.lerp(t.target0,r),t.object.position.lerp(t.position0,r),t.object.zoom=bj(t.object.zoom,t.zoom0,r),t.object.updateProjectionMatrix(),t.dispatchEvent({type:"change"})),i.getElapsedTime()>=.5?(cancelAnimationFrame(this.cameraControlsRafID),this.cameraControlsRafID=-1,this.clearControls()):this.cameraControlsRafID=requestAnimationFrame(a)};a()});et(this,"clearControls",()=>{this.cameraControls!==void 0&&(this.cameraControls.disconnect(),this.cameraControls.dispose(),this.cameraControls=void 0)});et(this,"drawDouble",()=>{const t=this.getSceneOverride(this.tlRender),n=this.getSceneOverride(this.trRender),r=Math.floor(this.width/2),i=Math.floor(this.height/2);if(this.state.mode==="Side by Side")this.drawTo(0,0,r,this.height,this.tlCam,t),this.drawTo(r,0,r,this.height,this.trCam,n);else{const a=this.height-i;this.drawTo(0,a,this.width,i,this.tlCam,t),this.drawTo(0,0,this.width,i,this.trCam,n)}});et(this,"drawQuad",()=>{const t=this.getSceneOverride(this.tlRender),n=this.getSceneOverride(this.trRender),r=this.getSceneOverride(this.blRender),i=this.getSceneOverride(this.brRender),a=Math.floor(this.width/2),c=Math.floor(this.height/2);let h=0,p=0;p=this.height-c,h=0,this.drawTo(h,p,a,c,this.tlCam,t),h=a,this.drawTo(h,p,a,c,this.trCam,n),p=0,h=0,this.scene.overrideMaterial=r,this.drawTo(h,p,a,c,this.blCam,r),h=a,this.drawTo(h,p,a,c,this.brCam,i)});this.app=t.app,this.app.addEventListener(br.ADD_RENDERER,this.setupRenderer),this.scene=new vI,this.scene.name=this.scene.uuid="Debug Scene",this.canvasRef=Rn.createRef(),this.containerRef=Rn.createRef(),this.tlWindow=Rn.createRef(),this.trWindow=Rn.createRef(),this.blWindow=Rn.createRef(),this.brWindow=Rn.createRef();const n=t.three.app.appID,r=localStorage,i=r.getItem(`${n}_mode`);this.state={mode:i!==null?i:"Single",modeOpen:!1,renderModeOpen:!1,interactionMode:"Orbit",interactionModeOpen:!1,lastUpdate:Date.now()},r.setItem(`${n}_mode`,this.state.mode),r.setItem(`${n}_tlCam`,r.getItem(`${n}_tlCam`)!==null?r.getItem(`${n}_tlCam`):"Debug"),r.setItem(`${n}_trCam`,r.getItem(`${n}_trCam`)!==null?r.getItem(`${n}_trCam`):"Orthographic"),r.setItem(`${n}_blCam`,r.getItem(`${n}_blCam`)!==null?r.getItem(`${n}_blCam`):"Front"),r.setItem(`${n}_brCam`,r.getItem(`${n}_brCam`)!==null?r.getItem(`${n}_brCam`):"Top"),r.setItem(`${n}_tlRender`,r.getItem(`${n}_tlRender`)!==null?r.getItem(`${n}_tlRender`):"Renderer"),r.setItem(`${n}_trRender`,r.getItem(`${n}_trRender`)!==null?r.getItem(`${n}_trRender`):"Renderer"),r.setItem(`${n}_blRender`,r.getItem(`${n}_blRender`)!==null?r.getItem(`${n}_blRender`):"Renderer"),r.setItem(`${n}_brRender`,r.getItem(`${n}_brRender`)!==null?r.getItem(`${n}_brRender`):"Renderer");const a={Vector2:mr,Vector3:Ie,Vector4:Pi,Quaternion:os,Matrix4:vr,Spherical:yj,Box3:T6,Sphere:e4,Raycaster:jk};Xp.install({THREE:a}),this.setupScene(),this.setupTools();const c=localStorage.getItem(this.expandedCameraVisibility);c!==null&&(this.cameraVisibility=c==="open"),this.saveExpandedCameraVisibility();const h=localStorage.getItem(this.expandedLightVisibility);h!==null&&(this.lightVisibility=h==="open"),this.saveExpandedLightVisibility();const p=localStorage.getItem(this.expandedGridVisibility);p!==null&&(this.gridVisibility=p==="open"),this.grid.visible=this.gridVisibility,this.saveExpandedGridVisibility(),mI.instance=this}componentDidMount(){this.enable(),this.assignControls(),this.resize(),this.play(),Zp.instance.setApp(this.props.app,this.props.three),Zp.instance.activeCamera=this.debugCamera}componentDidUpdate(t,n,r){n.mode!==this.state.mode&&(this.assignControls(),this.resize())}componentWillUnmount(){this.disable(),X_.removeEditorGroup("View Settings")}render(){const t=[];return this.cameras.forEach((n,r)=>{t.push(r)}),Je.jsxs("div",{className:"multiview",children:[Je.jsx("canvas",{ref:this.canvasRef}),Je.jsxs("div",{className:`cameras ${this.state.mode==="Single"||this.state.mode==="Stacked"?"single":""}`,ref:this.containerRef,children:[this.state.mode==="Single"&&Je.jsx(Je.Fragment,{children:Je.jsx(Y8,{name:"tl",camera:this.tlCam,options:t,ref:this.tlWindow,onSelectCamera:n=>{var i;(i=this.controls.get(this.tlCam.name))==null||i.dispose();const r=this.cameras.get(n);r!==void 0&&(this.clearCamera(this.tlCam),this.tlCam=r,localStorage.setItem(`${this.appID}_tlCam`,r.name),this.createControls(r,this.tlWindow.current))},onSelectRenderMode:n=>{this.tlRender=n,localStorage.setItem(`${this.appID}_tlRender`,n)}})}),(this.state.mode==="Side by Side"||this.state.mode==="Stacked")&&Je.jsxs(Je.Fragment,{children:[Je.jsx(Y8,{name:"tl",camera:this.tlCam,options:t,ref:this.tlWindow,onSelectCamera:n=>{var i;(i=this.controls.get(this.tlCam.name))==null||i.dispose();const r=this.cameras.get(n);r!==void 0&&(this.clearCamera(this.tlCam),this.tlCam=r,localStorage.setItem(`${this.appID}_tlCam`,r.name),this.createControls(r,this.tlWindow.current))},onSelectRenderMode:n=>{this.tlRender=n,localStorage.setItem(`${this.appID}_tlRender`,n)}}),Je.jsx(Y8,{name:"tr",camera:this.trCam,options:t,ref:this.trWindow,onSelectCamera:n=>{var i;(i=this.controls.get(this.trCam.name))==null||i.dispose();const r=this.cameras.get(n);r!==void 0&&(this.clearCamera(this.trCam),this.trCam=r,localStorage.setItem(`${this.appID}_trCam`,r.name),this.createControls(r,this.trWindow.current))},onSelectRenderMode:n=>{this.trRender=n,localStorage.setItem(`${this.appID}_trRender`,n)}})]}),this.state.mode==="Quad"&&Je.jsxs(Je.Fragment,{children:[Je.jsx(Y8,{name:"tl",camera:this.tlCam,options:t,ref:this.tlWindow,onSelectCamera:n=>{var i;(i=this.controls.get(this.tlCam.name))==null||i.dispose();const r=this.cameras.get(n);r!==void 0&&(this.clearCamera(this.tlCam),this.tlCam=r,localStorage.setItem(`${this.appID}_tlCam`,r.name),this.createControls(r,this.tlWindow.current))},onSelectRenderMode:n=>{this.tlRender=n,localStorage.setItem(`${this.appID}_tlRender`,n)}}),Je.jsx(Y8,{name:"tr",camera:this.trCam,options:t,ref:this.trWindow,onSelectCamera:n=>{var i;(i=this.controls.get(this.trCam.name))==null||i.dispose();const r=this.cameras.get(n);r!==void 0&&(this.clearCamera(this.trCam),this.trCam=r,localStorage.setItem(`${this.appID}_trCam`,r.name),this.createControls(r,this.trWindow.current))},onSelectRenderMode:n=>{this.trRender=n,localStorage.setItem(`${this.appID}_trRender`,n)}}),Je.jsx(Y8,{name:"bl",camera:this.blCam,options:t,ref:this.blWindow,onSelectCamera:n=>{var i;(i=this.controls.get(this.blCam.name))==null||i.dispose();const r=this.cameras.get(n);r!==void 0&&(this.clearCamera(this.blCam),this.blCam=r,localStorage.setItem(`${this.appID}_blCam`,r.name),this.createControls(r,this.blWindow.current))},onSelectRenderMode:n=>{this.blRender=n,localStorage.setItem(`${this.appID}_blRender`,n)}}),Je.jsx(Y8,{name:"br",camera:this.brCam,options:t,ref:this.brWindow,onSelectCamera:n=>{var i;(i=this.controls.get(this.brCam.name))==null||i.dispose();const r=this.cameras.get(n);r!==void 0&&(this.clearCamera(this.brCam),this.brCam=r,localStorage.setItem(`${this.appID}_brCam`,r.name),this.createControls(r,this.brWindow.current))},onSelectRenderMode:n=>{this.brRender=n,localStorage.setItem(`${this.appID}_brRender`,n)}})]})]}),Je.jsxs("div",{className:"settings",children:[Je.jsx(hI,{title:"View",index:I2e.indexOf(this.state.mode),options:I2e,onSelect:n=>{n!==this.state.mode&&(this.killControls(),this.setState({mode:n}),localStorage.setItem(`${this.appID}_mode`,n))},open:this.state.modeOpen,onToggle:n=>{this.setState({modeOpen:n,renderModeOpen:!1,interactionModeOpen:!1})}}),Je.jsx(hI,{title:"Interact",index:this.state.interactionMode==="Orbit"?0:1,options:["Orbit Mode","Selection Mode"],onSelect:n=>{this.interactionHelper.visible=n==="Selection Mode",this.setState({interactionMode:this.interactionHelper.visible?"Selection":"Orbit"})},open:this.state.interactionModeOpen,onToggle:n=>{this.setState({modeOpen:!1,renderModeOpen:!1,interactionModeOpen:n})}}),Je.jsx(dG,{name:"cameraHelper",icon:THe,selected:this.cameraVisibility,height:24,top:2,onClick:n=>{if(this.cameraVisibility=n,this.saveExpandedCameraVisibility(),this.cameraHelpers.forEach(r=>{r.visible=n}),this.selectedItem!==void 0&&!n){const r=this.cameraHelpers.get(this.selectedItem.name);r!==void 0&&(r.visible=!0)}}}),Je.jsx(dG,{name:"lightHelper",icon:MHe,selected:this.lightVisibility,height:24,top:4,onClick:n=>{if(this.lightVisibility=n,this.saveExpandedLightVisibility(),this.lightHelpers.forEach(r=>{r.visible=n}),this.selectedItem!==void 0&&!n&&this.selectedItem.isLight===!0){const r=this.lightHelpers.get(this.selectedItem.name);r!==void 0&&(r.visible=!0)}}}),Je.jsx(dG,{name:"gridHelper",icon:CHe,selected:this.gridVisibility,height:21,width:21,onClick:n=>{this.gridVisibility=n,this.saveExpandedGridVisibility(),this.grid.visible=n}})]},this.state.lastUpdate)]})}setupScene(){this.scene.name="Debug Scene",this.scene.uuid="Debug Scene",this.helpersContainer.name="helpers",this.scene.add(this.helpersContainer),this.grid.position.y=-1,this.helpersContainer.add(this.grid),this.interactionHelper.name="interactionHelper",this.interactionHelper.visible=!1,this.helpersContainer.add(this.interactionHelper);const t=(a,c)=>{const h=new wE(-100,100,100,-100,0,3e3);return h.name=a,h.position.copy(c),h.lookAt(0,0,0),this.cameras.set(a,h),h},n=1e3;t("Top",new Ie(0,n,0)),t("Bottom",new Ie(0,-n,0)),t("Left",new Ie(-n,0,0)),t("Right",new Ie(n,0,0)),t("Front",new Ie(0,0,n)),t("Back",new Ie(0,0,-n)),t("Orthographic",new Ie(n,n,n)),t("UI",new Ie),this.debugCamera=new La(60,1,50,5e3),this.debugCamera.name="Debug",this.debugCamera.position.set(500,500,500),this.debugCamera.lookAt(0,0,0),this.cameras.set("Debug",this.debugCamera),this.currentCamera=this.debugCamera;const r=localStorage,i=this.props.three.app.appID;this.tlCam=this.cameras.get(r.getItem(`${i}_tlCam`)),this.trCam=this.cameras.get(r.getItem(`${i}_trCam`)),this.blCam=this.cameras.get(r.getItem(`${i}_blCam`)),this.brCam=this.cameras.get(r.getItem(`${i}_brCam`)),this.tlCam===void 0&&(this.tlCam=this.cameras.get("Debug")),this.trCam===void 0&&(this.trCam=this.cameras.get("Orthographic")),this.blCam===void 0&&(this.blCam=this.cameras.get("Front")),this.brCam===void 0&&(this.brCam=this.cameras.get("Top"))}setupTools(){this.splineEditor=new EHe(this.currentCamera,this.app),this.splineEditor.initDebug(),this.scene.add(this.splineEditor)}play(){this.playing=!0,this.onUpdate()}pause(){this.playing=!1,cancelAnimationFrame(this.rafID),this.rafID=-1}toggleOrbitControls(t){this.controls.forEach(n=>{n.enabled=!t})}update(){this.controls.forEach(t=>t.update()),this.cameraHelpers.forEach(t=>t.update()),this.lightHelpers.forEach(t=>{t.update!==void 0&&t.update()}),this.props.onSceneUpdate!==void 0&&this.sceneSet&&this.props.onSceneUpdate(this.currentScene)}draw(){var t,n;switch(this.renderer&&(this.renderer instanceof tE?(t=this.renderer)==null||t.clear():this.renderer instanceof rG&&((n=this.renderer)==null||n.clearAsync())),this.state.mode){case"Single":this.drawSingle();break;case"Side by Side":case"Stacked":this.drawDouble();break;case"Quad":this.drawQuad();break}}enable(){const t=this.containerRef.current;t.addEventListener("mousemove",this.onMouseMove),t.addEventListener("click",this.onClick),window.addEventListener("keydown",this.onKey),window.addEventListener("resize",this.resize),this.app.addEventListener(br.SET_SCENE,this.sceneUpdate),this.app.addEventListener(br.ADD_CAMERA,this.addCamera),this.app.addEventListener(br.REMOVE_CAMERA,this.removeCamera),this.app.addEventListener(br.SET_OBJECT,this.onSetSelectedItem)}disable(){const t=this.containerRef.current;t.removeEventListener("mousemove",this.onMouseMove),t.removeEventListener("click",this.onClick),window.removeEventListener("keydown",this.onKey),window.removeEventListener("resize",this.resize),this.app.removeEventListener(br.SET_SCENE,this.sceneUpdate),this.app.removeEventListener(br.ADD_CAMERA,this.addCamera),this.app.removeEventListener(br.REMOVE_CAMERA,this.removeCamera),this.app.removeEventListener(br.SET_OBJECT,this.onSetSelectedItem)}updateSelectedItemHelper(t){if(this.selectedItem!==void 0)if(this.cameraVisibility){if(this.selectedItem.isLight===!0&&!this.lightVisibility){const n=this.lightHelpers.get(this.selectedItem.name);n!==void 0&&(n.visible=t)}}else{const n=this.cameraHelpers.get(this.selectedItem.name);n!==void 0&&(n.visible=t)}}createControls(t,n){const r=this.controls.get(t.name);if(r!==void 0&&r.dispose(),this.controls.delete(t.name),t.name==="UI")return;const i=new Mje(t,n);switch(i.enableDamping=!0,i.dampingFactor=.05,t.name){case"Top":case"Bottom":case"Left":case"Right":case"Front":case"Back":i.enableRotate=!1;break}this.controls.set(t.name,i)}clearCamera(t){const n=this.cameraHelpers.get(t.name);n!==void 0&&(this.scene.remove(n),n.dispose(),this.cameraHelpers.delete(t.name));const r=this.controls.get(t.name);r!==void 0&&(r.dispose(),this.controls.delete(t.name))}killControls(){this.controls.forEach((t,n)=>{t.dispose();const r=this.cameraHelpers.get(n);r!==void 0&&(this.scene.remove(r),r.dispose()),this.cameraHelpers.delete(n),this.controls.delete(n)}),this.controls.clear(),this.cameraHelpers.clear()}assignControls(){switch(this.state.mode){case"Single":this.createControls(this.tlCam,this.tlWindow.current);break;case"Side by Side":case"Stacked":this.createControls(this.tlCam,this.tlWindow.current),this.createControls(this.trCam,this.trWindow.current);break;case"Quad":this.createControls(this.tlCam,this.tlWindow.current),this.createControls(this.trCam,this.trWindow.current),this.createControls(this.blCam,this.blWindow.current),this.createControls(this.brCam,this.brWindow.current);break}}saveExpandedCameraVisibility(){localStorage.setItem(this.expandedCameraVisibility,this.cameraVisibility?"open":"closed")}saveExpandedLightVisibility(){localStorage.setItem(this.expandedLightVisibility,this.lightVisibility?"open":"closed")}saveExpandedGridVisibility(){localStorage.setItem(this.expandedGridVisibility,this.gridVisibility?"open":"closed")}getSceneOverride(t){switch(t){case"Depth":return this.depthMaterial;case"Normals":return this.normalsMaterial;case"Renderer":return null;case"UVs":return this.uvMaterial;case"Wireframe":return this.wireframeMaterial}return null}drawTo(t,n,r,i,a,c){var h,p,v,x;switch(a.name){case"Left":case"Right":this.grid.rotation.z=Math.PI/2;break;case"Front":case"Back":this.grid.rotation.x=Math.PI/2;break}this.scene.overrideMaterial=c,this.renderer&&((h=this.renderer)==null||h.setViewport(t,n,r,i),(p=this.renderer)==null||p.setScissor(t,n,r,i),this.renderer instanceof tE?(v=this.renderer)==null||v.render(this.scene,a):this.renderer instanceof rG&&((x=this.renderer)==null||x.renderAsync(this.scene,a))),this.grid.rotation.set(0,0,0)}drawSingle(){const t=this.getSceneOverride(this.tlRender);this.drawTo(0,0,this.width,this.height,this.tlCam,t)}get appID(){return this.props.three.app.appID}get mode(){return this.state.mode}get three(){return this.props.three}get expandedCameraVisibility(){return`${this.appID}_multiviewCameraVisibility`}get expandedLightVisibility(){return`${this.appID}_multiviewLightVisibility`}get expandedGridVisibility(){return`${this.appID}_multiviewGridVisibility`}};et(mI,"instance",null);let U0=mI;function I5e(o){const e=Rn.useRef(null),[t,n]=Rn.useState(!1),r=o.child!==void 0&&o.child.children.length>0,i=[];return o.child!==void 0&&o.child.children.length>0&&o.child.children.map((a,c)=>{i.push(Je.jsx(I5e,{app:o.app,child:a,three:o.three},c))}),Rn.useEffect(()=>{if(o.child){const a=o.three.getScene(o.child.uuid);if(a!==null){const c=a.getObjectByProperty("uuid",o.child.uuid);c!==void 0&&(e.current.style.opacity=c.visible?"1":"0.25")}}},[t]),Je.jsx(Je.Fragment,{children:o.child!==void 0&&Je.jsxs("div",{className:"childObject",children:[Je.jsxs("div",{className:"child",children:[r?Je.jsx("button",{className:"status",style:{backgroundPositionX:t?"-14px":"2px"},onClick:()=>{n(!t)}}):null,Je.jsx("button",{className:"name",style:{left:r?"20px":"5px"},onClick:()=>{o.child!==void 0&&(o.three.getObject(o.child.uuid),t||n(!0))},children:o.child.name.length>0?`${o.child.name} (${o.child.type})`:`${o.child.type}::${o.child.uuid}`}),Je.jsx("button",{className:"visibility",ref:e,onClick:()=>{if(o.child){const a=o.three.getScene(o.child.uuid);if(a!==null){const c=a.getObjectByProperty("uuid",o.child.uuid);if(c!==void 0){const h="visible",p=!c.visible;e.current.style.opacity=p?"1":"0.25",o.three.updateObject(o.child.uuid,h,p),jo(c,h,p)}}}}}),Je.jsx("div",{className:`icon ${cIe(o.child)}`})]}),Je.jsx("div",{className:t?"open":"",children:Je.jsx("div",{className:"container",children:i})})]},Math.random())})}function N2e(o){var t;const e=[];return(t=o.child)==null||t.children.map((n,r)=>{e.push(Je.jsx(I5e,{app:o.app,child:n,scene:o.scene,three:o.three},r))}),Je.jsx("div",{className:`scene ${o.class!==void 0?o.class:""}`,children:e})}function D2e(o){switch(o){case"fov":return"FOV";case"zoom":return"Zoom";case"near":return"Near";case"far":return"Far";case"focus":return"Focus";case"aspect":return"Aspect";case"filmGauge":return"Film Gauge";case"filmOffset":return"Film Offset";case"left":return"Left";case"right":return"Right";case"top":return"Top";case"bottom":return"Bottom"}return o}function AHe(o,e,t){function n(){return`${t.app.appID}_camera`}const r=localStorage.getItem(n()),i=r!==null?r==="open":!1;function a(h){localStorage.setItem(n(),h?"open":"closed")}const c=[];if(o.perspectiveCameraInfo!==void 0)for(const h in o.perspectiveCameraInfo)c.push({title:D2e(h),prop:h,type:"number",step:.01,value:o.perspectiveCameraInfo[h],onChange:(p,v)=>{t.updateObject(o.uuid,p,v),t.requestMethod(o.uuid,"updateProjectionMatrix");const x=t.getScene(o.uuid);if(x!==null){const S=x.getObjectByProperty("uuid",o.uuid);S!==void 0&&(jo(S,p,v),S.updateProjectionMatrix())}}});else if(o.orthographicCameraInfo!==void 0)for(const h in o.orthographicCameraInfo)c.push({title:D2e(h),prop:h,type:"number",step:.01,value:o.orthographicCameraInfo[h],onChange:(p,v)=>{t.updateObject(o.uuid,p,v),t.requestMethod(o.uuid,"updateProjectionMatrix");const x=t.getScene(o.uuid);if(x!==null){const S=x.getObjectByProperty("uuid",o.uuid);S!==void 0&&(jo(S,p,v),S.updateProjectionMatrix())}}});return Je.jsx(Nh,{app:e,title:"Camera",items:c,expanded:i,onToggle:h=>{a(h)}})}function O2e(o){switch(o){case"color":return"Color";case"intensity":return"Intensity";case"decay":return"Decay";case"distance":return"Distance";case"angle":return"Angle";case"penumbra":return"Penumbra";case"groundColor":return"Ground Color";case"width":return"Width";case"height":return"Height"}return o}function PHe(o,e,t){function n(){return`${t.app.appID}_light`}const r=localStorage.getItem(n()),i=r!==null?r==="open":!1;function a(h){localStorage.setItem(n(),h?"open":"closed")}const c=[];if(o.lightInfo!==void 0)for(const h in o.lightInfo){const p=o.lightInfo[h];p!==void 0&&(p.isColor!==void 0?c.push({title:O2e(h),prop:h,type:"color",value:p,onChange:(v,x)=>{const S=new Vn(x);t.updateObject(o.uuid,v,S);const C=t.getScene(o.uuid);if(C!==null){const I=C.getObjectByProperty("uuid",o.uuid);jo(I,v,S)}}}):c.push({title:O2e(h),prop:h,type:typeof p,value:p,step:typeof p=="number"?.01:void 0,onChange:(v,x)=>{t.updateObject(o.uuid,v,x);const S=t.getScene(o.uuid);if(S!==null){const C=S.getObjectByProperty("uuid",o.uuid);jo(C,v,x)}}}))}return Je.jsx(Nh,{app:e,title:"Light",items:c,expanded:i,onToggle:h=>{a(h)}})}function RHe(o){var S;const e=o.object,t=o.three;function n(){return`${t.app.appID}_animation`}const r=localStorage.getItem(n()),i=r!==null?r==="open":!1;function a(C){localStorage.setItem(n(),C?"open":"closed")}const c=[],h=[];let p=0;e.animations.forEach(C=>{p=Math.max(p,C.duration),C.duration>0&&h.push({title:C.name,items:[{title:"Duration",type:"number",value:C.duration,disabled:!0},{title:"Blend Mode",type:"option",disabled:!0,options:[{title:"Normal",value:2500},{title:"Additive",value:2501}]}]})}),c.push({title:"Animations",items:h});let v;const x=t.getScene(e.uuid);if(x!==null){const C=x.getObjectByProperty("uuid",e.uuid);if(C!==void 0){const I=C.mixer;if(I!==void 0){const U=[{title:"Time Scale",type:"range",value:I.timeScale,step:.01,min:-1,max:2,onChange:(R,$)=>{I.timeScale=$,t.updateObject(e.uuid,"mixer.timeScale",$)}}];U.push({title:"Stop All",type:"button",onChange:()=>{I.stopAllAction(),t.requestMethod(e.uuid,"stopAllAction",void 0,"mixer")}}),c.push({title:"Mixer",items:U}),v=new pCe(C),(S=U0.instance)==null||S.scene.add(v)}}}return Rn.useEffect(()=>()=>{v!==void 0&&pf(v)},[]),Je.jsx(Nh,{app:o.app,title:"Animation",items:c,expanded:i,onToggle:C=>{a(C)}})}const nH={name:"",uuid:"",type:"",visible:!1,matrix:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],animations:[],material:void 0,perspectiveCameraInfo:void 0,orthographicCameraInfo:void 0,lightInfo:void 0,children:[]};let a0={...nH};function kHe(o){const[e,t]=Rn.useState(-1);Rn.useEffect(()=>{function a(h){a0={...h.value},t(Date.now())}function c(){a0={...nH},t(Date.now())}return o.app.addEventListener(br.SET_SCENE,c),o.app.addEventListener(br.SET_OBJECT,a),()=>{o.app.removeEventListener(br.SET_SCENE,c),o.app.removeEventListener(br.SET_OBJECT,a)}},[]);const n=a0.type.toLowerCase(),r=a0.animations.length>0||a0.mixer!==void 0,i=n.search("mesh")>-1||n.search("line")>-1||n.search("points")>-1;return Je.jsx(dI,{app:o.app,label:"Inspector",button:a0.uuid.length>0?Je.jsx("button",{className:"remove",onClick:()=>{Zp.instance.remove(a0.name),a0={...nH},t(Date.now())}}):void 0,children:Je.jsx("div",{id:"Inspector",className:o.class,children:a0.uuid.length>0&&Je.jsxs(Je.Fragment,{children:[Je.jsxs(Je.Fragment,{children:[Je.jsx(Ik,{type:"string",title:"Name",prop:"name",value:a0.name,disabled:!0}),Je.jsx(Ik,{type:"string",title:"Type",prop:"type",value:a0.type,disabled:!0}),Je.jsx(Ik,{type:"string",title:"UUID",prop:"uuid",value:a0.uuid,disabled:!0})]}),Je.jsxs(Je.Fragment,{children:[Je.jsx(fI,{object:a0,app:o.app,three:o.three}),r?Je.jsx(RHe,{app:o.app,object:a0,three:o.three}):null,n.search("camera")>-1?AHe(a0,o.app,o.three):null,n.search("light")>-1?PHe(a0,o.app,o.three):null,i?lHe(a0,o.app,o.three):null]})]})},e)},"Inspector")}class IHe extends Rn.Component{constructor(t){super(t);et(this,"app");et(this,"autoClear",!0);et(this,"autoClearColor",!0);et(this,"autoClearDepth",!0);et(this,"autoClearStencil",!0);et(this,"outputColorSpace",ys);et(this,"localClippingEnabled",!1);et(this,"clearColor",new Vn(0));et(this,"clearAlpha",1);et(this,"toneMapping",Jp);et(this,"toneMappingExposure",1);et(this,"type","");et(this,"onAddRenderer",t=>{const n=t.value;if(this.autoClear=n.autoClear,this.autoClearColor=n.autoClearColor,this.autoClearDepth=n.autoClearDepth,this.autoClearStencil=n.autoClearStencil,this.outputColorSpace=n.outputColorSpace,this.localClippingEnabled=n.localClippingEnabled,this.clearAlpha=n.clearAlpha,this.type=n.type,this.toneMapping=n.toneMapping,this.toneMappingExposure=n.toneMappingExposure,this.clearColor.setStyle(n.clearColor,df),Kr.enabled=n.colorManagement,U0.instance){const r=U0.instance.renderer;r&&(r.autoClear=this.autoClear,r.autoClearColor=this.autoClearColor,r.autoClearDepth=this.autoClearDepth,r.autoClearStencil=this.autoClearStencil,r.outputColorSpace=this.outputColorSpace,r.localClippingEnabled=this.localClippingEnabled,r.toneMapping=this.toneMapping,r.toneMappingExposure=this.toneMappingExposure,r.setClearColor(n.clearColor,this.clearAlpha))}this.setState({lastUpdated:Date.now()})});this.app=t.app;const n=localStorage.getItem(this.expandedName),r=n!==null?n==="open":!1;if(this.state={expanded:r,lastUpdated:Date.now()},this.saveExpanded(r),U0.instance){const i=U0.instance.renderer;i&&(this.autoClear=i.autoClear,this.autoClearColor=i.autoClearColor,this.autoClearDepth=i.autoClearDepth,this.autoClearStencil=i.autoClearStencil,this.clearAlpha=i.getClearAlpha(),this.toneMapping=i.toneMapping,this.toneMappingExposure=i.toneMappingExposure,i instanceof tE&&(this.localClippingEnabled=i.localClippingEnabled,i.getClearColor(this.clearColor)))}this.app.addEventListener(br.ADD_RENDERER,this.onAddRenderer)}componentwillunmount(){this.app.removeEventListener(br.ADD_RENDERER,this.onAddRenderer)}render(){const t=()=>{if(U0.instance){const n=U0.instance.renderer;n&&(n.autoClear=this.autoClear,n.autoClearColor=this.autoClearColor,n.autoClearDepth=this.autoClearDepth,n.autoClearStencil=this.autoClearStencil,n.outputColorSpace=this.outputColorSpace,n.localClippingEnabled=this.localClippingEnabled,n.toneMapping=this.toneMapping,n.toneMappingExposure=this.toneMappingExposure,n.setClearColor(this.clearColor.getStyle(),this.clearAlpha),this.props.three.updateRenderer({autoClear:this.autoClear,autoClearColor:this.autoClearColor,autoClearDepth:this.autoClearDepth,autoClearStencil:this.autoClearStencil,outputColorSpace:this.outputColorSpace,localClippingEnabled:this.localClippingEnabled,clearAlpha:this.clearAlpha,clearColor:this.clearColor.getStyle(),colorManagement:Kr.enabled,toneMapping:this.toneMapping,toneMappingExposure:this.toneMappingExposure}))}};return Je.jsx(Nh,{app:this.app,title:"Renderer",expanded:this.state.expanded,items:[{type:"boolean",title:"Auto Clear",value:this.autoClear,onChange:(n,r)=>{this.autoClear=r}},{type:"boolean",title:"Auto Clear Color",value:this.autoClearColor,onChange:(n,r)=>{this.autoClearColor=r,t()}},{type:"boolean",title:"Auto Clear Depth",value:this.autoClearDepth,onChange:(n,r)=>{this.autoClearDepth=r,t()}},{type:"boolean",title:"Auto Clear Stencil",value:this.autoClearStencil,onChange:(n,r)=>{this.autoClearStencil=r,t()}},{type:"boolean",title:"Local Clipping",value:this.localClippingEnabled,onChange:(n,r)=>{this.localClippingEnabled=r,t()}},{type:"color",title:"Clear Color",value:`#${this.clearColor.getHexString()}`,onChange:(n,r)=>{this.clearColor.setStyle(r),t()}},{type:"range",title:"Clear Alpha",min:0,max:1,step:.01,value:this.clearAlpha,onChange:(n,r)=>{this.clearAlpha=r,t()}},{type:"boolean",title:"Clear Management",value:Kr.enabled,onChange:(n,r)=>{Kr.enabled=r,t()}},{type:"option",title:"Color Space",value:this.outputColorSpace,options:[{title:"No Color Space",value:mg},{title:"SRB Color Space",value:ys},{title:"Linear SRB Color Space",value:df}],onChange:(n,r)=>{this.outputColorSpace=r,t()}},{type:"option",title:"Tone Mapping",value:this.toneMapping,options:[{title:"None ",value:Jp},{title:"Linear ",value:J2e},{title:"Reinhard",value:e9e},{title:"Cineon ",value:t9e},{title:"ACES Filmic",value:n9e},{title:"AgX",value:i9e},{title:"Neutral",value:s9e},{title:"Custom",value:r9e}],onChange:(n,r)=>{this.toneMapping=r,t()}},{type:"range",title:"Tone Mapping Exposure",value:this.toneMappingExposure,min:0,max:2,step:.01,onChange:(n,r)=>{this.toneMappingExposure=r,t()}},{type:"string",title:"Type",value:this.type,disabled:!0}],onToggle:n=>{this.setState({expanded:n}),this.saveExpanded(n)}},Math.random())}saveExpanded(t){localStorage.setItem(this.expandedName,t?"open":"closed")}get expandedName(){return`${this.props.three.app.appID}_renderer`}}function NHe(o){const[e]=Rn.useState([]),[t]=Rn.useState([]),[n,r]=Rn.useState(0),i=h=>{const p=h.value;e.push(p),t.push(Je.jsx(dI,{app:o.app,label:`Scene: ${p.name}`,scene:p,open:!0,onRefresh:()=>{o.three.refreshScene(p.name)},children:Je.jsx(N2e,{app:o.app,child:p,scene:p,three:o.three})},Math.random())),r(Date.now())},a=h=>{const p=h.value;for(let v=0;v<e.length;v++)if(p.uuid===e[v].uuid){e[v]=p,t[v]=Je.jsx(dI,{app:o.app,label:`Scene: ${p.name}`,scene:p,open:!0,onRefresh:()=>{o.three.refreshScene(p.name)},children:Je.jsx(N2e,{app:o.app,child:p,scene:p,three:o.three})},Math.random()),r(Date.now());return}},c=h=>{const p=h.value;for(let v=0;v<e.length;v++)if(p.uuid===e[v].uuid){e.splice(v,1),t.splice(v,1),r(Date.now());return}};return Rn.useEffect(()=>(o.app.addEventListener(br.ADD_SCENE,i),o.app.addEventListener(br.REFRESH_SCENE,a),o.app.addEventListener(br.REMOVE_SCENE,c),()=>{o.app.removeEventListener(br.ADD_SCENE,i),o.app.removeEventListener(br.REFRESH_SCENE,a),o.app.removeEventListener(br.REMOVE_SCENE,c)}),[]),Je.jsxs("div",{id:"SidePanel",children:[Je.jsx("div",{className:"scenes",children:t},n),Je.jsx(kHe,{app:o.app,three:o.three}),Je.jsx(IHe,{app:o.app,three:o.three}),Je.jsx(X_,{app:o.app,three:o.three})]})}function DHe(o){return Je.jsx(yIe,{children:Je.jsxs(Je.Fragment,{children:[Je.jsx(U0,{app:o.app,three:o.three,scenes:o.scenes,onSceneResize:o.onSceneResize,onSceneSet:o.onSceneSet,onSceneUpdate:o.onSceneUpdate}),Je.jsx(NHe,{app:o.app,three:o.three})]})})}const OHe=`varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}`,FHe=`struct Light {
  float intensity;
  vec3 position;
  vec3 color;
};

uniform float time;
uniform float opacity;
uniform vec2 resolution;
uniform vec3 diffuse;
uniform vec3 mouse;
uniform sampler2D map;
uniform Light light;
uniform Light lights[3];
varying vec2 vUv;

#define MIN_ALPHA 2.0 / 255.0

void main() {
  if (opacity < MIN_ALPHA) discard;
  vec2 imageUV = vUv * 10.0;
  vec3 image = texture2D(map, imageUV).rgb;
  vec3 col = image * diffuse;
  col += (sin(time * 0.1) * 0.5 + 0.5) * 0.2;
  col += vec3(resolution, 0.0);
  col += mouse;
  gl_FragColor = vec4(col, opacity);
}`,LHe="data:image/png;base64,R0lGODlhCAAIAIAAAP///wAAACH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgOS4xLWMwMDEgNzkuMTQ2Mjg5OTc3NywgMjAyMy8wNi8yNS0yMzo1NzoxNCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjIgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NjVENjQyODM4QTYzMTFFRUJFQTBFOTJFNjA1OTQ5N0YiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NjVENjQyODQ4QTYzMTFFRUJFQTBFOTJFNjA1OTQ5N0YiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo2NUQ2NDI4MThBNjMxMUVFQkVBMEU5MkU2MDU5NDk3RiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo2NUQ2NDI4MjhBNjMxMUVFQkVBMEU5MkU2MDU5NDk3RiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgH//v38+/r5+Pf29fTz8vHw7+7t7Ovq6ejn5uXk4+Lh4N/e3dzb2tnY19bV1NPS0dDPzs3My8rJyMfGxcTDwsHAv769vLu6ubi3trW0s7KxsK+urayrqqmop6alpKOioaCfnp2cm5qZmJeWlZSTkpGQj46NjIuKiYiHhoWEg4KBgH9+fXx7enl4d3Z1dHNycXBvbm1sa2ppaGdmZWRjYmFgX15dXFtaWVhXVlVUU1JRUE9OTUxLSklIR0ZFRENCQUA/Pj08Ozo5ODc2NTQzMjEwLy4tLCsqKSgnJiUkIyIhIB8eHRwbGhkYFxYVFBMSERAPDg0MCwoJCAcGBQQDAgEAACH5BAAAAAAALAAAAAAIAAgAAAIOjH8AprzRkHyspqSoNAUAOw==";class N5e extends ff{constructor(){super({vertexShader:OHe,fragmentShader:FHe,name:"ExampleScene/SimpleShader",transparent:!0,uniforms:{diffuse:{value:new Vn(16777215)},opacity:{value:1},time:{value:0},map:{value:null},resolution:{value:new mr},mouse:{value:new Ie},v4:{value:new Pi},euler:{value:new na},testM3:{value:new ui},testM4:{value:new vr},light:{value:{position:new mr(5,10),intensity:1,color:new Vn(16711935)}},lights:{value:[{position:new mr(1,1),intensity:1,color:new Vn(16711680)},{position:new mr(2,2),intensity:2,color:new Vn(65280)},{position:new mr(3,3),intensity:3,color:new Vn(255)}]}}}),qH(LHe).then(e=>{this.uniforms.map.value=e})}update(e){this.uniforms.opacity.value=this.opacity,this.uniforms.time.value+=e}}function BHe(o){const e=new Map,t=new Map,n=o.clone();return D5e(o,n,function(r,i){e.set(i,r),t.set(r,i)}),n.traverse(function(r){if(!r.isSkinnedMesh)return;const i=r,a=e.get(r),c=a.skeleton.bones;i.skeleton=a.skeleton.clone(),i.bindMatrix.copy(a.bindMatrix),i.skeleton.bones=c.map(function(h){return t.get(h)}),i.bind(i.skeleton,i.bindMatrix)}),n}function D5e(o,e,t){t(o,e);for(let n=0;n<o.children.length;n++)D5e(o.children[n],e.children[n],t)}/*!
fflate - fast JavaScript compression/decompression
<https://101arrowz.github.io/fflate>
Licensed under MIT. https://github.com/101arrowz/fflate/blob/master/LICENSE
version 0.8.2
*/var Eh=Uint8Array,v_=Uint16Array,UHe=Int32Array,O5e=new Eh([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),F5e=new Eh([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),zHe=new Eh([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),L5e=function(o,e){for(var t=new v_(31),n=0;n<31;++n)t[n]=e+=1<<o[n-1];for(var r=new UHe(t[30]),n=1;n<30;++n)for(var i=t[n];i<t[n+1];++i)r[i]=i-t[n]<<5|n;return{b:t,r}},B5e=L5e(O5e,2),U5e=B5e.b,VHe=B5e.r;U5e[28]=258,VHe[258]=28;var GHe=L5e(F5e,0),jHe=GHe.b,rH=new v_(32768);for(var Js=0;Js<32768;++Js){var O3=(Js&43690)>>1|(Js&21845)<<1;O3=(O3&52428)>>2|(O3&13107)<<2,O3=(O3&61680)>>4|(O3&3855)<<4,rH[Js]=((O3&65280)>>8|(O3&255)<<8)>>1}var uE=function(o,e,t){for(var n=o.length,r=0,i=new v_(e);r<n;++r)o[r]&&++i[o[r]-1];var a=new v_(e);for(r=1;r<e;++r)a[r]=a[r-1]+i[r-1]<<1;var c;if(t){c=new v_(1<<e);var h=15-e;for(r=0;r<n;++r)if(o[r])for(var p=r<<4|o[r],v=e-o[r],x=a[o[r]-1]++<<v,S=x|(1<<v)-1;x<=S;++x)c[rH[x]>>h]=p}else for(c=new v_(n),r=0;r<n;++r)o[r]&&(c[r]=rH[a[o[r]-1]++]>>15-o[r]);return c},UE=new Eh(288);for(var Js=0;Js<144;++Js)UE[Js]=8;for(var Js=144;Js<256;++Js)UE[Js]=9;for(var Js=256;Js<280;++Js)UE[Js]=7;for(var Js=280;Js<288;++Js)UE[Js]=8;var z5e=new Eh(32);for(var Js=0;Js<32;++Js)z5e[Js]=5;var HHe=uE(UE,9,1),WHe=uE(z5e,5,1),gG=function(o){for(var e=o[0],t=1;t<o.length;++t)o[t]>e&&(e=o[t]);return e},Jd=function(o,e,t){var n=e/8|0;return(o[n]|o[n+1]<<8)>>(e&7)&t},yG=function(o,e){var t=e/8|0;return(o[t]|o[t+1]<<8|o[t+2]<<16)>>(e&7)},$He=function(o){return(o+7)/8|0},qHe=function(o,e,t){return(t==null||t>o.length)&&(t=o.length),new Eh(o.subarray(e,t))},XHe=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],rf=function(o,e,t){var n=new Error(e||XHe[o]);if(n.code=o,Error.captureStackTrace&&Error.captureStackTrace(n,rf),!t)throw n;return n},YHe=function(o,e,t,n){var r=o.length,i=0;if(!r||e.f&&!e.l)return t||new Eh(0);var a=!t,c=a||e.i!=2,h=e.i;a&&(t=new Eh(r*3));var p=function(ni){var ai=t.length;if(ni>ai){var qr=new Eh(Math.max(ai*2,ni));qr.set(t),t=qr}},v=e.f||0,x=e.p||0,S=e.b||0,C=e.l,I=e.d,L=e.m,U=e.n,R=r*8;do{if(!C){v=Jd(o,x,1);var $=Jd(o,x+1,3);if(x+=3,$)if($==1)C=HHe,I=WHe,L=9,U=5;else if($==2){var ue=Jd(o,x,31)+257,ce=Jd(o,x+10,15)+4,Q=ue+Jd(o,x+5,31)+1;x+=14;for(var ae=new Eh(Q),le=new Eh(19),J=0;J<ce;++J)le[zHe[J]]=Jd(o,x+J*3,7);x+=ce*3;for(var Ue=gG(le),je=(1<<Ue)-1,rt=uE(le,Ue,1),J=0;J<Q;){var at=rt[Jd(o,x,je)];x+=at&15;var Z=at>>4;if(Z<16)ae[J++]=Z;else{var Se=0,gt=0;for(Z==16?(gt=3+Jd(o,x,3),x+=2,Se=ae[J-1]):Z==17?(gt=3+Jd(o,x,7),x+=3):Z==18&&(gt=11+Jd(o,x,127),x+=7);gt--;)ae[J++]=Se}}var Ae=ae.subarray(0,ue),lt=ae.subarray(ue);L=gG(Ae),U=gG(lt),C=uE(Ae,L,1),I=uE(lt,U,1)}else rf(1);else{var Z=$He(x)+4,k=o[Z-4]|o[Z-3]<<8,ie=Z+k;if(ie>r){h&&rf(0);break}c&&p(S+k),t.set(o.subarray(Z,ie),S),e.b=S+=k,e.p=x=ie*8,e.f=v;continue}if(x>R){h&&rf(0);break}}c&&p(S+131072);for(var pt=(1<<L)-1,De=(1<<U)-1,_t=x;;_t=x){var Se=C[yG(o,x)&pt],Jt=Se>>4;if(x+=Se&15,x>R){h&&rf(0);break}if(Se||rf(2),Jt<256)t[S++]=Jt;else if(Jt==256){_t=x,C=null;break}else{var dt=Jt-254;if(Jt>264){var J=Jt-257,Dt=O5e[J];dt=Jd(o,x,(1<<Dt)-1)+U5e[J],x+=Dt}var gn=I[yG(o,x)&De],qt=gn>>4;gn||rf(3),x+=gn&15;var lt=jHe[qt];if(qt>3){var Dt=F5e[qt];lt+=yG(o,x)&(1<<Dt)-1,x+=Dt}if(x>R){h&&rf(0);break}c&&p(S+131072);var wn=S+dt;if(S<lt){var nr=i-lt,qn=Math.min(lt,wn);for(nr+S<0&&rf(3);S<qn;++S)t[S]=n[nr+S]}for(;S<wn;++S)t[S]=t[S-lt]}}e.l=C,e.p=_t,e.b=S,e.f=v,C&&(v=1,e.m=L,e.d=I,e.n=U)}while(!v);return S!=t.length&&a?qHe(t,0,S):t.subarray(0,S)},KHe=new Eh(0),ZHe=function(o,e){return((o[0]&15)!=8||o[0]>>4>7||(o[0]<<8|o[1])%31)&&rf(6,"invalid zlib data"),(o[1]>>5&1)==1&&rf(6,"invalid zlib data: "+(o[1]&32?"need":"unexpected")+" dictionary"),(o[1]>>3&4)+2};function QHe(o,e){return YHe(o.subarray(ZHe(o),-4),{i:2},e,e)}var JHe=typeof TextDecoder<"u"&&new TextDecoder,eWe=0;try{JHe.decode(KHe,{stream:!0}),eWe=1}catch{}function V5e(o,e,t){const n=t.length-o-1;if(e>=t[n])return n-1;if(e<=t[o])return o;let r=o,i=n,a=Math.floor((r+i)/2);for(;e<t[a]||e>=t[a+1];)e<t[a]?i=a:r=a,a=Math.floor((r+i)/2);return a}function tWe(o,e,t,n){const r=[],i=[],a=[];r[0]=1;for(let c=1;c<=t;++c){i[c]=e-n[o+1-c],a[c]=n[o+c]-e;let h=0;for(let p=0;p<c;++p){const v=a[p+1],x=i[c-p],S=r[p]/(v+x);r[p]=h+v*S,h=x*S}r[c]=h}return r}function nWe(o,e,t,n){const r=V5e(o,n,e),i=tWe(r,n,o,e),a=new Pi(0,0,0,0);for(let c=0;c<=o;++c){const h=t[r-o+c],p=i[c],v=h.w*p;a.x+=h.x*v,a.y+=h.y*v,a.z+=h.z*v,a.w+=h.w*p}return a}function rWe(o,e,t,n,r){const i=[];for(let x=0;x<=t;++x)i[x]=0;const a=[];for(let x=0;x<=n;++x)a[x]=i.slice(0);const c=[];for(let x=0;x<=t;++x)c[x]=i.slice(0);c[0][0]=1;const h=i.slice(0),p=i.slice(0);for(let x=1;x<=t;++x){h[x]=e-r[o+1-x],p[x]=r[o+x]-e;let S=0;for(let C=0;C<x;++C){const I=p[C+1],L=h[x-C];c[x][C]=I+L;const U=c[C][x-1]/c[x][C];c[C][x]=S+I*U,S=L*U}c[x][x]=S}for(let x=0;x<=t;++x)a[0][x]=c[x][t];for(let x=0;x<=t;++x){let S=0,C=1;const I=[];for(let L=0;L<=t;++L)I[L]=i.slice(0);I[0][0]=1;for(let L=1;L<=n;++L){let U=0;const R=x-L,$=t-L;x>=L&&(I[C][0]=I[S][0]/c[$+1][R],U=I[C][0]*c[R][$]);const Z=R>=-1?1:-R,k=x-1<=$?L-1:t-x;for(let ue=Z;ue<=k;++ue)I[C][ue]=(I[S][ue]-I[S][ue-1])/c[$+1][R+ue],U+=I[C][ue]*c[R+ue][$];x<=$&&(I[C][L]=-I[S][L-1]/c[$+1][x],U+=I[C][L]*c[x][$]),a[L][x]=U;const ie=S;S=C,C=ie}}let v=t;for(let x=1;x<=n;++x){for(let S=0;S<=t;++S)a[x][S]*=v;v*=t-x}return a}function iWe(o,e,t,n,r){const i=r<o?r:o,a=[],c=V5e(o,n,e),h=rWe(c,n,o,i,e),p=[];for(let v=0;v<t.length;++v){const x=t[v].clone(),S=x.w;x.x*=S,x.y*=S,x.z*=S,p[v]=x}for(let v=0;v<=i;++v){const x=p[c-o].clone().multiplyScalar(h[v][0]);for(let S=1;S<=o;++S)x.add(p[c-o+S].clone().multiplyScalar(h[v][S]));a[v]=x}for(let v=i+1;v<=r+1;++v)a[v]=new Pi(0,0,0);return a}function sWe(o,e){let t=1;for(let r=2;r<=o;++r)t*=r;let n=1;for(let r=2;r<=e;++r)n*=r;for(let r=2;r<=o-e;++r)n*=r;return t/n}function oWe(o){const e=o.length,t=[],n=[];for(let i=0;i<e;++i){const a=o[i];t[i]=new Ie(a.x,a.y,a.z),n[i]=a.w}const r=[];for(let i=0;i<e;++i){const a=t[i].clone();for(let c=1;c<=i;++c)a.sub(r[i-c].clone().multiplyScalar(sWe(i,c)*n[c]));r[i]=a.divideScalar(n[0])}return r}function aWe(o,e,t,n,r){const i=iWe(o,e,t,n,r);return oWe(i)}class lWe extends R9e{constructor(e,t,n,r,i){super();const a=t?t.length-1:0,c=n?n.length:0;this.degree=e,this.knots=t,this.controlPoints=[],this.startKnot=r||0,this.endKnot=i||a;for(let h=0;h<c;++h){const p=n[h];this.controlPoints[h]=new Pi(p.x,p.y,p.z,p.w)}}getPoint(e,t=new Ie){const n=t,r=this.knots[this.startKnot]+e*(this.knots[this.endKnot]-this.knots[this.startKnot]),i=nWe(this.degree,this.knots,this.controlPoints,r);return i.w!==1&&i.divideScalar(i.w),n.set(i.x,i.y,i.z)}getTangent(e,t=new Ie){const n=t,r=this.knots[0]+e*(this.knots[this.knots.length-1]-this.knots[0]),i=aWe(this.degree,this.knots,this.controlPoints,r,1);return n.copy(i[1]).normalize(),n}toJSON(){const e=super.toJSON();return e.degree=this.degree,e.knots=[...this.knots],e.controlPoints=this.controlPoints.map(t=>t.toArray()),e.startKnot=this.startKnot,e.endKnot=this.endKnot,e}fromJSON(e){return super.fromJSON(e),this.degree=e.degree,this.knots=[...e.knots],this.controlPoints=e.controlPoints.map(t=>new Pi(t[0],t[1],t[2],t[3])),this.startKnot=e.startKnot,this.endKnot=e.endKnot,this}}let yi,Go,Al;class cWe extends q3{constructor(e){super(e)}load(e,t,n,r){const i=this,a=i.path===""?QMe.extractUrlBase(e):i.path,c=new HMe(this.manager);c.setPath(i.path),c.setResponseType("arraybuffer"),c.setRequestHeader(i.requestHeader),c.setWithCredentials(i.withCredentials),c.load(e,function(h){try{t(i.parse(h,a))}catch(p){r?r(p):console.error(p),i.manager.itemError(e)}},n,r)}parse(e,t){if(mWe(e))yi=new pWe().parse(e);else{const r=H5e(e);if(!gWe(r))throw new Error("THREE.FBXLoader: Unknown format.");if(L2e(r)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+L2e(r));yi=new fWe().parse(r)}const n=new H9e(this.manager).setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin);return new uWe(n,this.manager).parse(yi)}}class uWe{constructor(e,t){this.textureLoader=e,this.manager=t}parse(){Go=this.parseConnections();const e=this.parseImages(),t=this.parseTextures(e),n=this.parseMaterials(t),r=this.parseDeformers(),i=new hWe().parse(r);return this.parseScene(r,i,n),Al}parseConnections(){const e=new Map;return"Connections"in yi&&yi.Connections.connections.forEach(function(n){const r=n[0],i=n[1],a=n[2];e.has(r)||e.set(r,{parents:[],children:[]});const c={ID:i,relationship:a};e.get(r).parents.push(c),e.has(i)||e.set(i,{parents:[],children:[]});const h={ID:r,relationship:a};e.get(i).children.push(h)}),e}parseImages(){const e={},t={};if("Video"in yi.Objects){const n=yi.Objects.Video;for(const r in n){const i=n[r],a=parseInt(r);if(e[a]=i.RelativeFilename||i.Filename,"Content"in i){const c=i.Content instanceof ArrayBuffer&&i.Content.byteLength>0,h=typeof i.Content=="string"&&i.Content!=="";if(c||h){const p=this.parseImage(n[r]);t[i.RelativeFilename||i.Filename]=p}}}}for(const n in e){const r=e[n];t[r]!==void 0?e[n]=t[r]:e[n]=e[n].split("\\").pop()}return e}parseImage(e){const t=e.Content,n=e.RelativeFilename||e.Filename,r=n.slice(n.lastIndexOf(".")+1).toLowerCase();let i;switch(r){case"bmp":i="image/bmp";break;case"jpg":case"jpeg":i="image/jpeg";break;case"png":i="image/png";break;case"tif":i="image/tiff";break;case"tga":this.manager.getHandler(".tga")===null&&console.warn("FBXLoader: TGA loader not found, skipping ",n),i="image/tga";break;case"webp":i="image/webp";break;default:console.warn('FBXLoader: Image type "'+r+'" is not supported.');return}if(typeof t=="string")return"data:"+i+";base64,"+t;{const a=new Uint8Array(t);return window.URL.createObjectURL(new Blob([a],{type:i}))}}parseTextures(e){const t=new Map;if("Texture"in yi.Objects){const n=yi.Objects.Texture;for(const r in n){const i=this.parseTexture(n[r],e);t.set(parseInt(r),i)}}return t}parseTexture(e,t){const n=this.loadTexture(e,t);n.ID=e.id,n.name=e.attrName;const r=e.WrapModeU,i=e.WrapModeV,a=r!==void 0?r.value:0,c=i!==void 0?i.value:0;if(n.wrapS=a===0?kg:l0,n.wrapT=c===0?kg:l0,"Scaling"in e){const h=e.Scaling.value;n.repeat.x=h[0],n.repeat.y=h[1]}if("Translation"in e){const h=e.Translation.value;n.offset.x=h[0],n.offset.y=h[1]}return n}loadTexture(e,t){const n=e.FileName.split(".").pop().toLowerCase();let r=this.manager.getHandler(`.${n}`);r===null&&(r=this.textureLoader);const i=r.path;i||r.setPath(this.textureLoader.path);const a=Go.get(e.id).children;let c;if(a!==void 0&&a.length>0&&t[a[0].ID]!==void 0&&(c=t[a[0].ID],(c.indexOf("blob:")===0||c.indexOf("data:")===0)&&r.setPath(void 0)),c===void 0)return console.warn("FBXLoader: Undefined filename, creating placeholder texture."),new H0;const h=r.load(c);return r.setPath(i),h}parseMaterials(e){const t=new Map;if("Material"in yi.Objects){const n=yi.Objects.Material;for(const r in n){const i=this.parseMaterial(n[r],e);i!==null&&t.set(parseInt(r),i)}}return t}parseMaterial(e,t){const n=e.id,r=e.attrName;let i=e.ShadingModel;if(typeof i=="object"&&(i=i.value),!Go.has(n))return null;const a=this.parseParameters(e,t,n);let c;switch(i.toLowerCase()){case"phong":c=new u_;break;case"lambert":c=new IMe;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',i),c=new u_;break}return c.setValues(a),c.name=r,c}parseParameters(e,t,n){const r={};e.BumpFactor&&(r.bumpScale=e.BumpFactor.value),e.Diffuse?r.color=Kr.colorSpaceToWorking(new Vn().fromArray(e.Diffuse.value),ys):e.DiffuseColor&&(e.DiffuseColor.type==="Color"||e.DiffuseColor.type==="ColorRGB")&&(r.color=Kr.colorSpaceToWorking(new Vn().fromArray(e.DiffuseColor.value),ys)),e.DisplacementFactor&&(r.displacementScale=e.DisplacementFactor.value),e.Emissive?r.emissive=Kr.colorSpaceToWorking(new Vn().fromArray(e.Emissive.value),ys):e.EmissiveColor&&(e.EmissiveColor.type==="Color"||e.EmissiveColor.type==="ColorRGB")&&(r.emissive=Kr.colorSpaceToWorking(new Vn().fromArray(e.EmissiveColor.value),ys)),e.EmissiveFactor&&(r.emissiveIntensity=parseFloat(e.EmissiveFactor.value)),r.opacity=1-(e.TransparencyFactor?parseFloat(e.TransparencyFactor.value):0),(r.opacity===1||r.opacity===0)&&(r.opacity=e.Opacity?parseFloat(e.Opacity.value):null,r.opacity===null&&(r.opacity=1-(e.TransparentColor?parseFloat(e.TransparentColor.value[0]):0))),r.opacity<1&&(r.transparent=!0),e.ReflectionFactor&&(r.reflectivity=e.ReflectionFactor.value),e.Shininess&&(r.shininess=e.Shininess.value),e.Specular?r.specular=Kr.colorSpaceToWorking(new Vn().fromArray(e.Specular.value),ys):e.SpecularColor&&e.SpecularColor.type==="Color"&&(r.specular=Kr.colorSpaceToWorking(new Vn().fromArray(e.SpecularColor.value),ys));const i=this;return Go.get(n).children.forEach(function(a){const c=a.relationship;switch(c){case"Bump":r.bumpMap=i.getTexture(t,a.ID);break;case"Maya|TEX_ao_map":r.aoMap=i.getTexture(t,a.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":r.map=i.getTexture(t,a.ID),r.map!==void 0&&(r.map.colorSpace=ys);break;case"DisplacementColor":r.displacementMap=i.getTexture(t,a.ID);break;case"EmissiveColor":r.emissiveMap=i.getTexture(t,a.ID),r.emissiveMap!==void 0&&(r.emissiveMap.colorSpace=ys);break;case"NormalMap":case"Maya|TEX_normal_map":r.normalMap=i.getTexture(t,a.ID);break;case"ReflectionColor":r.envMap=i.getTexture(t,a.ID),r.envMap!==void 0&&(r.envMap.mapping=Dk,r.envMap.colorSpace=ys);break;case"SpecularColor":r.specularMap=i.getTexture(t,a.ID),r.specularMap!==void 0&&(r.specularMap.colorSpace=ys);break;case"TransparentColor":case"TransparencyFactor":r.alphaMap=i.getTexture(t,a.ID),r.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",c);break}}),r}getTexture(e,t){return"LayeredTexture"in yi.Objects&&t in yi.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),t=Go.get(t).children[0].ID),e.get(t)}parseDeformers(){const e={},t={};if("Deformer"in yi.Objects){const n=yi.Objects.Deformer;for(const r in n){const i=n[r],a=Go.get(parseInt(r));if(i.attrType==="Skin"){const c=this.parseSkeleton(a,n);c.ID=r,a.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),c.geometryID=a.parents[0].ID,e[r]=c}else if(i.attrType==="BlendShape"){const c={id:r};c.rawTargets=this.parseMorphTargets(a,n),c.id=r,a.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),t[r]=c}}}return{skeletons:e,morphTargets:t}}parseSkeleton(e,t){const n=[];return e.children.forEach(function(r){const i=t[r.ID];if(i.attrType!=="Cluster")return;const a={ID:r.ID,indices:[],weights:[],transformLink:new vr().fromArray(i.TransformLink.a)};"Indexes"in i&&(a.indices=i.Indexes.a,a.weights=i.Weights.a),n.push(a)}),{rawBones:n,bones:[]}}parseMorphTargets(e,t){const n=[];for(let r=0;r<e.children.length;r++){const i=e.children[r],a=t[i.ID],c={name:a.attrName,initialWeight:a.DeformPercent,id:a.id,fullWeights:a.FullWeights.a};if(a.attrType!=="BlendShapeChannel")return;c.geoID=Go.get(parseInt(i.ID)).children.filter(function(h){return h.relationship===void 0})[0].ID,n.push(c)}return n}parseScene(e,t,n){Al=new h6;const r=this.parseModels(e.skeletons,t,n),i=yi.Objects.Model,a=this;r.forEach(function(h){const p=i[h.ID];a.setLookAtProperties(h,p),Go.get(h.ID).parents.forEach(function(x){const S=r.get(x.ID);S!==void 0&&S.add(h)}),h.parent===null&&Al.add(h)}),this.bindSkeleton(e.skeletons,t,r),this.addGlobalSceneSettings(),Al.traverse(function(h){if(h.userData.transformData){h.parent&&(h.userData.transformData.parentMatrix=h.parent.matrix,h.userData.transformData.parentMatrixWorld=h.parent.matrixWorld);const p=j5e(h.userData.transformData);h.applyMatrix4(p),h.updateWorldMatrix()}});const c=new dWe().parse();Al.children.length===1&&Al.children[0].isGroup&&(Al.children[0].animations=c,Al=Al.children[0]),Al.animations=c}parseModels(e,t,n){const r=new Map,i=yi.Objects.Model;for(const a in i){const c=parseInt(a),h=i[a],p=Go.get(c);let v=this.buildSkeleton(p,e,c,h.attrName);if(!v){switch(h.attrType){case"Camera":v=this.createCamera(p);break;case"Light":v=this.createLight(p);break;case"Mesh":v=this.createMesh(p,t,n);break;case"NurbsCurve":v=this.createCurve(p,t);break;case"LimbNode":case"Root":v=new hj;break;case"Null":default:v=new h6;break}v.name=h.attrName?zi.sanitizeNodeName(h.attrName):"",v.userData.originalName=h.attrName,v.ID=c}this.getTransformData(v,h),r.set(c,v)}return r}buildSkeleton(e,t,n,r){let i=null;return e.parents.forEach(function(a){for(const c in t){const h=t[c];h.rawBones.forEach(function(p,v){if(p.ID===a.ID){const x=i;i=new hj,i.matrixWorld.copy(p.transformLink),i.name=r?zi.sanitizeNodeName(r):"",i.userData.originalName=r,i.ID=n,h.bones[v]=i,x!==null&&i.add(x)}})}}),i}createCamera(e){let t,n;if(e.children.forEach(function(r){const i=yi.Objects.NodeAttribute[r.ID];i!==void 0&&(n=i)}),n===void 0)t=new Ci;else{let r=0;n.CameraProjectionType!==void 0&&n.CameraProjectionType.value===1&&(r=1);let i=1;n.NearPlane!==void 0&&(i=n.NearPlane.value/1e3);let a=1e3;n.FarPlane!==void 0&&(a=n.FarPlane.value/1e3);let c=window.innerWidth,h=window.innerHeight;n.AspectWidth!==void 0&&n.AspectHeight!==void 0&&(c=n.AspectWidth.value,h=n.AspectHeight.value);const p=c/h;let v=45;n.FieldOfView!==void 0&&(v=n.FieldOfView.value);const x=n.FocalLength?n.FocalLength.value:null;switch(r){case 0:t=new La(v,p,i,a),x!==null&&t.setFocalLength(x);break;case 1:console.warn("THREE.FBXLoader: Orthographic cameras not supported yet."),t=new Ci;break;default:console.warn("THREE.FBXLoader: Unknown camera type "+r+"."),t=new Ci;break}}return t}createLight(e){let t,n;if(e.children.forEach(function(r){const i=yi.Objects.NodeAttribute[r.ID];i!==void 0&&(n=i)}),n===void 0)t=new Ci;else{let r;n.LightType===void 0?r=0:r=n.LightType.value;let i=16777215;n.Color!==void 0&&(i=Kr.colorSpaceToWorking(new Vn().fromArray(n.Color.value),ys));let a=n.Intensity===void 0?1:n.Intensity.value/100;n.CastLightOnObject!==void 0&&n.CastLightOnObject.value===0&&(a=0);let c=0;n.FarAttenuationEnd!==void 0&&(n.EnableFarAttenuation!==void 0&&n.EnableFarAttenuation.value===0?c=0:c=n.FarAttenuationEnd.value);const h=1;switch(r){case 0:t=new x1e(i,a,c,h);break;case 1:t=new GH(i,a);break;case 2:let p=Math.PI/3;n.InnerAngle!==void 0&&(p=B0.degToRad(n.InnerAngle.value));let v=0;n.OuterAngle!==void 0&&(v=B0.degToRad(n.OuterAngle.value),v=Math.max(v,1)),t=new VH(i,a,c,p,v,h);break;default:console.warn("THREE.FBXLoader: Unknown light type "+n.LightType.value+", defaulting to a PointLight."),t=new x1e(i,a);break}n.CastShadows!==void 0&&n.CastShadows.value===1&&(t.castShadow=!0)}return t}createMesh(e,t,n){let r,i=null,a=null;const c=[];if(e.children.forEach(function(h){t.has(h.ID)&&(i=t.get(h.ID)),n.has(h.ID)&&c.push(n.get(h.ID))}),c.length>1?a=c:c.length>0?a=c[0]:(a=new u_({name:q3.DEFAULT_MATERIAL_NAME,color:13421772}),c.push(a)),"color"in i.attributes&&c.forEach(function(h){h.vertexColors=!0}),i.groups.length>0){let h=!1;for(let p=0,v=i.groups.length;p<v;p++){const x=i.groups[p];(x.materialIndex<0||x.materialIndex>=c.length)&&(x.materialIndex=c.length,h=!0)}if(h){const p=new u_;c.push(p)}}return i.FBX_Deformer?(r=new NH(i,a),r.normalizeSkinWeights()):r=new Mn(i,a),r}createCurve(e,t){const n=e.children.reduce(function(i,a){return t.has(a.ID)&&(i=t.get(a.ID)),i},null),r=new vf({name:q3.DEFAULT_MATERIAL_NAME,color:3342591,linewidth:1});return new _c(n,r)}getTransformData(e,t){const n={};"InheritType"in t&&(n.inheritType=parseInt(t.InheritType.value)),"RotationOrder"in t?n.eulerOrder=IE(t.RotationOrder.value):n.eulerOrder=IE(0),"Lcl_Translation"in t&&(n.translation=t.Lcl_Translation.value),"PreRotation"in t&&(n.preRotation=t.PreRotation.value),"Lcl_Rotation"in t&&(n.rotation=t.Lcl_Rotation.value),"PostRotation"in t&&(n.postRotation=t.PostRotation.value),"Lcl_Scaling"in t&&(n.scale=t.Lcl_Scaling.value),"ScalingOffset"in t&&(n.scalingOffset=t.ScalingOffset.value),"ScalingPivot"in t&&(n.scalingPivot=t.ScalingPivot.value),"RotationOffset"in t&&(n.rotationOffset=t.RotationOffset.value),"RotationPivot"in t&&(n.rotationPivot=t.RotationPivot.value),e.userData.transformData=n}setLookAtProperties(e,t){"LookAtProperty"in t&&Go.get(e.ID).children.forEach(function(r){if(r.relationship==="LookAtProperty"){const i=yi.Objects.Model[r.ID];if("Lcl_Translation"in i){const a=i.Lcl_Translation.value;e.target!==void 0?(e.target.position.fromArray(a),Al.add(e.target)):e.lookAt(new Ie().fromArray(a))}}})}bindSkeleton(e,t,n){const r=this.parsePoseNodes();for(const i in e){const a=e[i];Go.get(parseInt(a.ID)).parents.forEach(function(h){if(t.has(h.ID)){const p=h.ID;Go.get(p).parents.forEach(function(x){n.has(x.ID)&&n.get(x.ID).bind(new DH(a.bones),r[x.ID])})}})}}parsePoseNodes(){const e={};if("Pose"in yi.Objects){const t=yi.Objects.Pose;for(const n in t)if(t[n].attrType==="BindPose"&&t[n].NbPoseNodes>0){const r=t[n].PoseNode;Array.isArray(r)?r.forEach(function(i){e[i.Node]=new vr().fromArray(i.Matrix.a)}):e[r.Node]=new vr().fromArray(r.Matrix.a)}}return e}addGlobalSceneSettings(){if("GlobalSettings"in yi){if("AmbientColor"in yi.GlobalSettings){const e=yi.GlobalSettings.AmbientColor.value,t=e[0],n=e[1],r=e[2];if(t!==0||n!==0||r!==0){const i=new Vn().setRGB(t,n,r,ys);Al.add(new KMe(i,1))}}"UnitScaleFactor"in yi.GlobalSettings&&(Al.userData.unitScaleFactor=yi.GlobalSettings.UnitScaleFactor.value)}}}class hWe{constructor(){this.negativeMaterialIndices=!1}parse(e){const t=new Map;if("Geometry"in yi.Objects){const n=yi.Objects.Geometry;for(const r in n){const i=Go.get(parseInt(r)),a=this.parseGeometry(i,n[r],e);t.set(parseInt(r),a)}}return this.negativeMaterialIndices===!0&&console.warn("THREE.FBXLoader: The FBX file contains invalid (negative) material indices. The asset might not render as expected."),t}parseGeometry(e,t,n){switch(t.attrType){case"Mesh":return this.parseMeshGeometry(e,t,n);case"NurbsCurve":return this.parseNurbsGeometry(t)}}parseMeshGeometry(e,t,n){const r=n.skeletons,i=[],a=e.parents.map(function(x){return yi.Objects.Model[x.ID]});if(a.length===0)return;const c=e.children.reduce(function(x,S){return r[S.ID]!==void 0&&(x=r[S.ID]),x},null);e.children.forEach(function(x){n.morphTargets[x.ID]!==void 0&&i.push(n.morphTargets[x.ID])});const h=a[0],p={};"RotationOrder"in h&&(p.eulerOrder=IE(h.RotationOrder.value)),"InheritType"in h&&(p.inheritType=parseInt(h.InheritType.value)),"GeometricTranslation"in h&&(p.translation=h.GeometricTranslation.value),"GeometricRotation"in h&&(p.rotation=h.GeometricRotation.value),"GeometricScaling"in h&&(p.scale=h.GeometricScaling.value);const v=j5e(p);return this.genGeometry(t,c,i,v)}genGeometry(e,t,n,r){const i=new _s;e.attrName&&(i.name=e.attrName);const a=this.parseGeoNode(e,t),c=this.genBuffers(a),h=new Ur(c.vertex,3);if(h.applyMatrix4(r),i.setAttribute("position",h),c.colors.length>0&&i.setAttribute("color",new Ur(c.colors,3)),t&&(i.setAttribute("skinIndex",new RH(c.weightsIndices,4)),i.setAttribute("skinWeight",new Ur(c.vertexWeights,4)),i.FBX_Deformer=t),c.normal.length>0){const p=new ui().getNormalMatrix(r),v=new Ur(c.normal,3);v.applyNormalMatrix(p),i.setAttribute("normal",v)}if(c.uvs.forEach(function(p,v){const x=v===0?"uv":`uv${v}`;i.setAttribute(x,new Ur(c.uvs[v],2))}),a.material&&a.material.mappingType!=="AllSame"){let p=c.materialIndex[0],v=0;if(c.materialIndex.forEach(function(x,S){x!==p&&(i.addGroup(v,S-v,p),p=x,v=S)}),i.groups.length>0){const x=i.groups[i.groups.length-1],S=x.start+x.count;S!==c.materialIndex.length&&i.addGroup(S,c.materialIndex.length-S,p)}i.groups.length===0&&i.addGroup(0,c.materialIndex.length,c.materialIndex[0])}return this.addMorphTargets(i,e,n,r),i}parseGeoNode(e,t){const n={};if(n.vertexPositions=e.Vertices!==void 0?e.Vertices.a:[],n.vertexIndices=e.PolygonVertexIndex!==void 0?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(n.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(n.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(n.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){n.uv=[];let r=0;for(;e.LayerElementUV[r];)e.LayerElementUV[r].UV&&n.uv.push(this.parseUVs(e.LayerElementUV[r])),r++}return n.weightTable={},t!==null&&(n.skeleton=t,t.rawBones.forEach(function(r,i){r.indices.forEach(function(a,c){n.weightTable[a]===void 0&&(n.weightTable[a]=[]),n.weightTable[a].push({id:i,weight:r.weights[c]})})})),n}genBuffers(e){const t={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let n=0,r=0,i=!1,a=[],c=[],h=[],p=[],v=[],x=[];const S=this;return e.vertexIndices.forEach(function(C,I){let L,U=!1;C<0&&(C=C^-1,U=!0);let R=[],$=[];if(a.push(C*3,C*3+1,C*3+2),e.color){const Z=fk(I,n,C,e.color);h.push(Z[0],Z[1],Z[2])}if(e.skeleton){if(e.weightTable[C]!==void 0&&e.weightTable[C].forEach(function(Z){$.push(Z.weight),R.push(Z.id)}),$.length>4){i||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),i=!0);const Z=[0,0,0,0],k=[0,0,0,0];$.forEach(function(ie,ue){let ce=ie,Q=R[ue];k.forEach(function(ae,le,J){if(ce>ae){J[le]=ce,ce=ae;const Ue=Z[le];Z[le]=Q,Q=Ue}})}),R=Z,$=k}for(;$.length<4;)$.push(0),R.push(0);for(let Z=0;Z<4;++Z)v.push($[Z]),x.push(R[Z])}if(e.normal){const Z=fk(I,n,C,e.normal);c.push(Z[0],Z[1],Z[2])}e.material&&e.material.mappingType!=="AllSame"&&(L=fk(I,n,C,e.material)[0],L<0&&(S.negativeMaterialIndices=!0,L=0)),e.uv&&e.uv.forEach(function(Z,k){const ie=fk(I,n,C,Z);p[k]===void 0&&(p[k]=[]),p[k].push(ie[0]),p[k].push(ie[1])}),r++,U&&(S.genFace(t,e,a,L,c,h,p,v,x,r),n++,r=0,a=[],c=[],h=[],p=[],v=[],x=[])}),t}getNormalNewell(e){const t=new Ie(0,0,0);for(let n=0;n<e.length;n++){const r=e[n],i=e[(n+1)%e.length];t.x+=(r.y-i.y)*(r.z+i.z),t.y+=(r.z-i.z)*(r.x+i.x),t.z+=(r.x-i.x)*(r.y+i.y)}return t.normalize(),t}getNormalTangentAndBitangent(e){const t=this.getNormalNewell(e),r=(Math.abs(t.z)>.5?new Ie(0,1,0):new Ie(0,0,1)).cross(t).normalize(),i=t.clone().cross(r).normalize();return{normal:t,tangent:r,bitangent:i}}flattenVertex(e,t,n){return new mr(e.dot(t),e.dot(n))}genFace(e,t,n,r,i,a,c,h,p,v){let x;if(v>3){const S=[],C=t.baseVertexPositions||t.vertexPositions;for(let R=0;R<n.length;R+=3)S.push(new Ie(C[n[R]],C[n[R+1]],C[n[R+2]]));const{tangent:I,bitangent:L}=this.getNormalTangentAndBitangent(S),U=[];for(const R of S)U.push(this.flattenVertex(R,I,L));x=BH.triangulateShape(U,[])}else x=[[0,1,2]];for(const[S,C,I]of x)e.vertex.push(t.vertexPositions[n[S*3]]),e.vertex.push(t.vertexPositions[n[S*3+1]]),e.vertex.push(t.vertexPositions[n[S*3+2]]),e.vertex.push(t.vertexPositions[n[C*3]]),e.vertex.push(t.vertexPositions[n[C*3+1]]),e.vertex.push(t.vertexPositions[n[C*3+2]]),e.vertex.push(t.vertexPositions[n[I*3]]),e.vertex.push(t.vertexPositions[n[I*3+1]]),e.vertex.push(t.vertexPositions[n[I*3+2]]),t.skeleton&&(e.vertexWeights.push(h[S*4]),e.vertexWeights.push(h[S*4+1]),e.vertexWeights.push(h[S*4+2]),e.vertexWeights.push(h[S*4+3]),e.vertexWeights.push(h[C*4]),e.vertexWeights.push(h[C*4+1]),e.vertexWeights.push(h[C*4+2]),e.vertexWeights.push(h[C*4+3]),e.vertexWeights.push(h[I*4]),e.vertexWeights.push(h[I*4+1]),e.vertexWeights.push(h[I*4+2]),e.vertexWeights.push(h[I*4+3]),e.weightsIndices.push(p[S*4]),e.weightsIndices.push(p[S*4+1]),e.weightsIndices.push(p[S*4+2]),e.weightsIndices.push(p[S*4+3]),e.weightsIndices.push(p[C*4]),e.weightsIndices.push(p[C*4+1]),e.weightsIndices.push(p[C*4+2]),e.weightsIndices.push(p[C*4+3]),e.weightsIndices.push(p[I*4]),e.weightsIndices.push(p[I*4+1]),e.weightsIndices.push(p[I*4+2]),e.weightsIndices.push(p[I*4+3])),t.color&&(e.colors.push(a[S*3]),e.colors.push(a[S*3+1]),e.colors.push(a[S*3+2]),e.colors.push(a[C*3]),e.colors.push(a[C*3+1]),e.colors.push(a[C*3+2]),e.colors.push(a[I*3]),e.colors.push(a[I*3+1]),e.colors.push(a[I*3+2])),t.material&&t.material.mappingType!=="AllSame"&&(e.materialIndex.push(r),e.materialIndex.push(r),e.materialIndex.push(r)),t.normal&&(e.normal.push(i[S*3]),e.normal.push(i[S*3+1]),e.normal.push(i[S*3+2]),e.normal.push(i[C*3]),e.normal.push(i[C*3+1]),e.normal.push(i[C*3+2]),e.normal.push(i[I*3]),e.normal.push(i[I*3+1]),e.normal.push(i[I*3+2])),t.uv&&t.uv.forEach(function(L,U){e.uvs[U]===void 0&&(e.uvs[U]=[]),e.uvs[U].push(c[U][S*2]),e.uvs[U].push(c[U][S*2+1]),e.uvs[U].push(c[U][C*2]),e.uvs[U].push(c[U][C*2+1]),e.uvs[U].push(c[U][I*2]),e.uvs[U].push(c[U][I*2+1])})}addMorphTargets(e,t,n,r){if(n.length===0)return;e.morphTargetsRelative=!0,e.morphAttributes.position=[];const i=this;n.forEach(function(a){a.rawTargets.forEach(function(c){const h=yi.Objects.Geometry[c.geoID];h!==void 0&&i.genMorphGeometry(e,t,h,r,c.name)})})}genMorphGeometry(e,t,n,r,i){const a=t.Vertices!==void 0?t.Vertices.a:[],c=t.PolygonVertexIndex!==void 0?t.PolygonVertexIndex.a:[],h=n.Vertices!==void 0?n.Vertices.a:[],p=n.Indexes!==void 0?n.Indexes.a:[],v=e.attributes.position.count*3,x=new Float32Array(v);for(let L=0;L<p.length;L++){const U=p[L]*3;x[U]=h[L*3],x[U+1]=h[L*3+1],x[U+2]=h[L*3+2]}const S={vertexIndices:c,vertexPositions:x,baseVertexPositions:a},C=this.genBuffers(S),I=new Ur(C.vertex,3);I.name=i||n.attrName,I.applyMatrix4(r),e.morphAttributes.position.push(I)}parseNormals(e){const t=e.MappingInformationType,n=e.ReferenceInformationType,r=e.Normals.a;let i=[];return n==="IndexToDirect"&&("NormalIndex"in e?i=e.NormalIndex.a:"NormalsIndex"in e&&(i=e.NormalsIndex.a)),{dataSize:3,buffer:r,indices:i,mappingType:t,referenceType:n}}parseUVs(e){const t=e.MappingInformationType,n=e.ReferenceInformationType,r=e.UV.a;let i=[];return n==="IndexToDirect"&&(i=e.UVIndex.a),{dataSize:2,buffer:r,indices:i,mappingType:t,referenceType:n}}parseVertexColors(e){const t=e.MappingInformationType,n=e.ReferenceInformationType,r=e.Colors.a;let i=[];n==="IndexToDirect"&&(i=e.ColorIndex.a);for(let a=0,c=new Vn;a<r.length;a+=4)c.fromArray(r,a),Kr.colorSpaceToWorking(c,ys),c.toArray(r,a);return{dataSize:4,buffer:r,indices:i,mappingType:t,referenceType:n}}parseMaterialIndices(e){const t=e.MappingInformationType,n=e.ReferenceInformationType;if(t==="NoMappingInformation")return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:n};const r=e.Materials.a,i=[];for(let a=0;a<r.length;++a)i.push(a);return{dataSize:1,buffer:r,indices:i,mappingType:t,referenceType:n}}parseNurbsGeometry(e){const t=parseInt(e.Order);if(isNaN(t))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new _s;const n=t-1,r=e.KnotVector.a,i=[],a=e.Points.a;for(let x=0,S=a.length;x<S;x+=4)i.push(new Pi().fromArray(a,x));let c,h;if(e.Form==="Closed")i.push(i[0]);else if(e.Form==="Periodic"){c=n,h=r.length-1-c;for(let x=0;x<n;++x)i.push(i[x])}const v=new lWe(n,r,i,c,h).getPoints(i.length*12);return new _s().setFromPoints(v)}}class dWe{parse(){const e=[],t=this.parseClips();if(t!==void 0)for(const n in t){const r=t[n],i=this.addClip(r);e.push(i)}return e}parseClips(){if(yi.Objects.AnimationCurve===void 0)return;const e=this.parseAnimationCurveNodes();this.parseAnimationCurves(e);const t=this.parseAnimationLayers(e);return this.parseAnimStacks(t)}parseAnimationCurveNodes(){const e=yi.Objects.AnimationCurveNode,t=new Map;for(const n in e){const r=e[n];if(r.attrName.match(/S|R|T|DeformPercent/)!==null){const i={id:r.id,attr:r.attrName,curves:{}};t.set(i.id,i)}}return t}parseAnimationCurves(e){const t=yi.Objects.AnimationCurve;for(const n in t){const r={id:t[n].id,times:t[n].KeyTime.a.map(yWe),values:t[n].KeyValueFloat.a},i=Go.get(r.id);if(i!==void 0){const a=i.parents[0].ID,c=i.parents[0].relationship;c.match(/X/)?e.get(a).curves.x=r:c.match(/Y/)?e.get(a).curves.y=r:c.match(/Z/)?e.get(a).curves.z=r:c.match(/DeformPercent/)&&e.has(a)&&(e.get(a).curves.morph=r)}}}parseAnimationLayers(e){const t=yi.Objects.AnimationLayer,n=new Map;for(const r in t){const i=[],a=Go.get(parseInt(r));a!==void 0&&(a.children.forEach(function(h,p){if(e.has(h.ID)){const v=e.get(h.ID);if(v.curves.x!==void 0||v.curves.y!==void 0||v.curves.z!==void 0){if(i[p]===void 0){const x=Go.get(h.ID).parents.filter(function(S){return S.relationship!==void 0})[0].ID;if(x!==void 0){const S=yi.Objects.Model[x.toString()];if(S===void 0){console.warn("THREE.FBXLoader: Encountered a unused curve.",h);return}const C={modelName:S.attrName?zi.sanitizeNodeName(S.attrName):"",ID:S.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};Al.traverse(function(I){I.ID===S.id&&(C.transform=I.matrix,I.userData.transformData&&(C.eulerOrder=I.userData.transformData.eulerOrder))}),C.transform||(C.transform=new vr),"PreRotation"in S&&(C.preRotation=S.PreRotation.value),"PostRotation"in S&&(C.postRotation=S.PostRotation.value),i[p]=C}}i[p]&&(i[p][v.attr]=v)}else if(v.curves.morph!==void 0){if(i[p]===void 0){const x=Go.get(h.ID).parents.filter(function(R){return R.relationship!==void 0})[0].ID,S=Go.get(x).parents[0].ID,C=Go.get(S).parents[0].ID,I=Go.get(C).parents[0].ID,L=yi.Objects.Model[I],U={modelName:L.attrName?zi.sanitizeNodeName(L.attrName):"",morphName:yi.Objects.Deformer[x].attrName};i[p]=U}i[p][v.attr]=v}}}),n.set(parseInt(r),i))}return n}parseAnimStacks(e){const t=yi.Objects.AnimationStack,n={};for(const r in t){const i=Go.get(parseInt(r)).children;i.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const a=e.get(i[0].ID);n[r]={name:t[r].attrName,layer:a}}return n}addClip(e){let t=[];const n=this;return e.layer.forEach(function(r){t=t.concat(n.generateTracks(r))}),new mj(e.name,-1,t)}generateTracks(e){const t=[];let n=new Ie,r=new Ie;if(e.transform&&e.transform.decompose(n,new os,r),n=n.toArray(),r=r.toArray(),e.T!==void 0&&Object.keys(e.T.curves).length>0){const i=this.generateVectorTrack(e.modelName,e.T.curves,n,"position");i!==void 0&&t.push(i)}if(e.R!==void 0&&Object.keys(e.R.curves).length>0){const i=this.generateRotationTrack(e.modelName,e.R.curves,e.preRotation,e.postRotation,e.eulerOrder);i!==void 0&&t.push(i)}if(e.S!==void 0&&Object.keys(e.S.curves).length>0){const i=this.generateVectorTrack(e.modelName,e.S.curves,r,"scale");i!==void 0&&t.push(i)}if(e.DeformPercent!==void 0){const i=this.generateMorphTrack(e);i!==void 0&&t.push(i)}return t}generateVectorTrack(e,t,n,r){const i=this.getTimesForAllAxes(t),a=this.getKeyframeTrackValues(i,t,n);return new SE(e+"."+r,i,a)}generateRotationTrack(e,t,n,r,i){let a,c;if(t.x!==void 0&&t.y!==void 0&&t.z!==void 0){const S=this.interpolateRotations(t.x,t.y,t.z,i);a=S[0],c=S[1]}const h=IE(0);n!==void 0&&(n=n.map(B0.degToRad),n.push(h),n=new na().fromArray(n),n=new os().setFromEuler(n)),r!==void 0&&(r=r.map(B0.degToRad),r.push(h),r=new na().fromArray(r),r=new os().setFromEuler(r).invert());const p=new os,v=new na,x=[];if(!c||!a)return new L_(e+".quaternion",[0],[0]);for(let S=0;S<c.length;S+=3)v.set(c[S],c[S+1],c[S+2],i),p.setFromEuler(v),n!==void 0&&p.premultiply(n),r!==void 0&&p.multiply(r),S>2&&new os().fromArray(x,(S-3)/3*4).dot(p)<0&&p.set(-p.x,-p.y,-p.z,-p.w),p.toArray(x,S/3*4);return new L_(e+".quaternion",a,x)}generateMorphTrack(e){const t=e.DeformPercent.curves.morph,n=t.values.map(function(i){return i/100}),r=Al.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return new bE(e.modelName+".morphTargetInfluences["+r+"]",t.times,n)}getTimesForAllAxes(e){let t=[];if(e.x!==void 0&&(t=t.concat(e.x.times)),e.y!==void 0&&(t=t.concat(e.y.times)),e.z!==void 0&&(t=t.concat(e.z.times)),t=t.sort(function(n,r){return n-r}),t.length>1){let n=1,r=t[0];for(let i=1;i<t.length;i++){const a=t[i];a!==r&&(t[n]=a,r=a,n++)}t=t.slice(0,n)}return t}getKeyframeTrackValues(e,t,n){const r=n,i=[];let a=-1,c=-1,h=-1;return e.forEach(function(p){if(t.x&&(a=t.x.times.indexOf(p)),t.y&&(c=t.y.times.indexOf(p)),t.z&&(h=t.z.times.indexOf(p)),a!==-1){const v=t.x.values[a];i.push(v),r[0]=v}else i.push(r[0]);if(c!==-1){const v=t.y.values[c];i.push(v),r[1]=v}else i.push(r[1]);if(h!==-1){const v=t.z.values[h];i.push(v),r[2]=v}else i.push(r[2])}),i}interpolateRotations(e,t,n,r){const i=[],a=[];i.push(e.times[0]),a.push(B0.degToRad(e.values[0])),a.push(B0.degToRad(t.values[0])),a.push(B0.degToRad(n.values[0]));for(let c=1;c<e.values.length;c++){const h=[e.values[c-1],t.values[c-1],n.values[c-1]];if(isNaN(h[0])||isNaN(h[1])||isNaN(h[2]))continue;const p=h.map(B0.degToRad),v=[e.values[c],t.values[c],n.values[c]];if(isNaN(v[0])||isNaN(v[1])||isNaN(v[2]))continue;const x=v.map(B0.degToRad),S=[v[0]-h[0],v[1]-h[1],v[2]-h[2]],C=[Math.abs(S[0]),Math.abs(S[1]),Math.abs(S[2])];if(C[0]>=180||C[1]>=180||C[2]>=180){const L=Math.max(...C)/180,U=new na(...p,r),R=new na(...x,r),$=new os().setFromEuler(U),Z=new os().setFromEuler(R);$.dot(Z)&&Z.set(-Z.x,-Z.y,-Z.z,-Z.w);const k=e.times[c-1],ie=e.times[c]-k,ue=new os,ce=new na;for(let Q=0;Q<1;Q+=1/L)ue.copy($.clone().slerp(Z.clone(),Q)),i.push(k+Q*ie),ce.setFromQuaternion(ue,r),a.push(ce.x),a.push(ce.y),a.push(ce.z)}else i.push(e.times[c]),a.push(B0.degToRad(e.values[c])),a.push(B0.degToRad(t.values[c])),a.push(B0.degToRad(n.values[c]))}return[i,a]}}class fWe{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(e){this.nodeStack.push(e),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(e,t){this.currentProp=e,this.currentPropName=t}parse(e){this.currentIndent=0,this.allNodes=new G5e,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const t=this,n=e.split(/[\r\n]+/);return n.forEach(function(r,i){const a=r.match(/^[\s\t]*;/),c=r.match(/^[\s\t]*$/);if(a||c)return;const h=r.match("^\\t{"+t.currentIndent+"}(\\w+):(.*){",""),p=r.match("^\\t{"+t.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),v=r.match("^\\t{"+(t.currentIndent-1)+"}}");h?t.parseNodeBegin(r,h):p?t.parseNodeProperty(r,p,n[++i]):v?t.popStack():r.match(/^[^\s\t}]/)&&t.parseNodePropertyContinued(r)}),this.allNodes}parseNodeBegin(e,t){const n=t[1].trim().replace(/^"/,"").replace(/"$/,""),r=t[2].split(",").map(function(h){return h.trim().replace(/^"/,"").replace(/"$/,"")}),i={name:n},a=this.parseNodeAttr(r),c=this.getCurrentNode();this.currentIndent===0?this.allNodes.add(n,i):n in c?(n==="PoseNode"?c.PoseNode.push(i):c[n].id!==void 0&&(c[n]={},c[n][c[n].id]=c[n]),a.id!==""&&(c[n][a.id]=i)):typeof a.id=="number"?(c[n]={},c[n][a.id]=i):n!=="Properties70"&&(n==="PoseNode"?c[n]=[i]:c[n]=i),typeof a.id=="number"&&(i.id=a.id),a.name!==""&&(i.attrName=a.name),a.type!==""&&(i.attrType=a.type),this.pushStack(i)}parseNodeAttr(e){let t=e[0];e[0]!==""&&(t=parseInt(e[0]),isNaN(t)&&(t=e[0]));let n="",r="";return e.length>1&&(n=e[1].replace(/^(\w+)::/,""),r=e[2]),{id:t,name:n,type:r}}parseNodeProperty(e,t,n){let r=t[1].replace(/^"/,"").replace(/"$/,"").trim(),i=t[2].replace(/^"/,"").replace(/"$/,"").trim();r==="Content"&&i===","&&(i=n.replace(/"/g,"").replace(/,$/,"").trim());const a=this.getCurrentNode();if(a.name==="Properties70"){this.parseNodeSpecialProperty(e,r,i);return}if(r==="C"){const h=i.split(",").slice(1),p=parseInt(h[0]),v=parseInt(h[1]);let x=i.split(",").slice(3);x=x.map(function(S){return S.trim().replace(/^"/,"")}),r="connections",i=[p,v],_We(i,x),a[r]===void 0&&(a[r]=[])}r==="Node"&&(a.id=i),r in a&&Array.isArray(a[r])?a[r].push(i):r!=="a"?a[r]=i:a.a=i,this.setCurrentProp(a,r),r==="a"&&i.slice(-1)!==","&&(a.a=_G(i))}parseNodePropertyContinued(e){const t=this.getCurrentNode();t.a+=e,e.slice(-1)!==","&&(t.a=_G(t.a))}parseNodeSpecialProperty(e,t,n){const r=n.split('",').map(function(v){return v.trim().replace(/^\"/,"").replace(/\s/,"_")}),i=r[0],a=r[1],c=r[2],h=r[3];let p=r[4];switch(a){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":p=parseFloat(p);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":p=_G(p);break}this.getPrevNode()[i]={type:a,type2:c,flag:h,value:p},this.setCurrentProp(this.getPrevNode(),i)}}class pWe{parse(e){const t=new F2e(e);t.skip(23);const n=t.getUint32();if(n<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+n);const r=new G5e;for(;!this.endOfContent(t);){const i=this.parseNode(t,n);i!==null&&r.add(i.name,i)}return r}endOfContent(e){return e.size()%16===0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()}parseNode(e,t){const n={},r=t>=7500?e.getUint64():e.getUint32(),i=t>=7500?e.getUint64():e.getUint32();t>=7500?e.getUint64():e.getUint32();const a=e.getUint8(),c=e.getString(a);if(r===0)return null;const h=[];for(let S=0;S<i;S++)h.push(this.parseProperty(e));const p=h.length>0?h[0]:"",v=h.length>1?h[1]:"",x=h.length>2?h[2]:"";for(n.singleProperty=i===1&&e.getOffset()===r;r>e.getOffset();){const S=this.parseNode(e,t);S!==null&&this.parseSubNode(c,n,S)}return n.propertyList=h,typeof p=="number"&&(n.id=p),v!==""&&(n.attrName=v),x!==""&&(n.attrType=x),c!==""&&(n.name=c),n}parseSubNode(e,t,n){if(n.singleProperty===!0){const r=n.propertyList[0];Array.isArray(r)?(t[n.name]=n,n.a=r):t[n.name]=r}else if(e==="Connections"&&n.name==="C"){const r=[];n.propertyList.forEach(function(i,a){a!==0&&r.push(i)}),t.connections===void 0&&(t.connections=[]),t.connections.push(r)}else if(n.name==="Properties70")Object.keys(n).forEach(function(i){t[i]=n[i]});else if(e==="Properties70"&&n.name==="P"){let r=n.propertyList[0],i=n.propertyList[1];const a=n.propertyList[2],c=n.propertyList[3];let h;r.indexOf("Lcl ")===0&&(r=r.replace("Lcl ","Lcl_")),i.indexOf("Lcl ")===0&&(i=i.replace("Lcl ","Lcl_")),i==="Color"||i==="ColorRGB"||i==="Vector"||i==="Vector3D"||i.indexOf("Lcl_")===0?h=[n.propertyList[4],n.propertyList[5],n.propertyList[6]]:h=n.propertyList[4],t[r]={type:i,type2:a,flag:c,value:h}}else t[n.name]===void 0?typeof n.id=="number"?(t[n.name]={},t[n.name][n.id]=n):t[n.name]=n:n.name==="PoseNode"?(Array.isArray(t[n.name])||(t[n.name]=[t[n.name]]),t[n.name].push(n)):t[n.name][n.id]===void 0&&(t[n.name][n.id]=n)}parseProperty(e){const t=e.getString(1);let n;switch(t){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":return n=e.getUint32(),e.getArrayBuffer(n);case"S":return n=e.getUint32(),e.getString(n);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const r=e.getUint32(),i=e.getUint32(),a=e.getUint32();if(i===0)switch(t){case"b":case"c":return e.getBooleanArray(r);case"d":return e.getFloat64Array(r);case"f":return e.getFloat32Array(r);case"i":return e.getInt32Array(r);case"l":return e.getInt64Array(r)}const c=QHe(new Uint8Array(e.getArrayBuffer(a))),h=new F2e(c.buffer);switch(t){case"b":case"c":return h.getBooleanArray(r);case"d":return h.getFloat64Array(r);case"f":return h.getFloat32Array(r);case"i":return h.getInt32Array(r);case"l":return h.getInt64Array(r)}break;default:throw new Error("THREE.FBXLoader: Unknown property type "+t)}}}class F2e{constructor(e,t){this.dv=new DataView(e),this.offset=0,this.littleEndian=t!==void 0?t:!0,this._textDecoder=new TextDecoder}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(e){this.offset+=e}getBoolean(){return(this.getUint8()&1)===1}getBooleanArray(e){const t=[];for(let n=0;n<e;n++)t.push(this.getBoolean());return t}getUint8(){const e=this.dv.getUint8(this.offset);return this.offset+=1,e}getInt16(){const e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}getInt32(){const e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}getInt32Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getInt32());return t}getUint32(){const e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}getInt64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),t&2147483648?(t=~t&4294967295,e=~e&4294967295,e===4294967295&&(t=t+1&4294967295),e=e+1&4294967295,-(t*4294967296+e)):t*4294967296+e}getInt64Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getInt64());return t}getUint64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),t*4294967296+e}getFloat32(){const e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}getFloat32Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getFloat32());return t}getFloat64(){const e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}getFloat64Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getFloat64());return t}getArrayBuffer(e){const t=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}getString(e){const t=this.offset;let n=new Uint8Array(this.dv.buffer,t,e);this.skip(e);const r=n.indexOf(0);return r>=0&&(n=new Uint8Array(this.dv.buffer,t,r)),this._textDecoder.decode(n)}}class G5e{add(e,t){this[e]=t}}function mWe(o){const e="Kaydara FBX Binary  \0";return o.byteLength>=e.length&&e===H5e(o,0,e.length)}function gWe(o){const e=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let t=0;function n(r){const i=o[r-1];return o=o.slice(t+r),t++,i}for(let r=0;r<e.length;++r)if(n(1)===e[r])return!1;return!0}function L2e(o){const e=/FBXVersion: (\d+)/,t=o.match(e);if(t)return parseInt(t[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function yWe(o){return o/46186158e3}const vWe=[];function fk(o,e,t,n){let r;switch(n.mappingType){case"ByPolygonVertex":r=o;break;case"ByPolygon":r=e;break;case"ByVertice":r=t;break;case"AllSame":r=n.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+n.mappingType)}n.referenceType==="IndexToDirect"&&(r=n.indices[r]);const i=r*n.dataSize,a=i+n.dataSize;return xWe(vWe,n.buffer,i,a)}const vG=new na,t_=new Ie;function j5e(o){const e=new vr,t=new vr,n=new vr,r=new vr,i=new vr,a=new vr,c=new vr,h=new vr,p=new vr,v=new vr,x=new vr,S=new vr,C=o.inheritType?o.inheritType:0;o.translation&&e.setPosition(t_.fromArray(o.translation));const I=IE(0);if(o.preRotation){const J=o.preRotation.map(B0.degToRad);J.push(I),t.makeRotationFromEuler(vG.fromArray(J))}if(o.rotation){const J=o.rotation.map(B0.degToRad);J.push(o.eulerOrder||I),n.makeRotationFromEuler(vG.fromArray(J))}if(o.postRotation){const J=o.postRotation.map(B0.degToRad);J.push(I),r.makeRotationFromEuler(vG.fromArray(J)),r.invert()}o.scale&&i.scale(t_.fromArray(o.scale)),o.scalingOffset&&c.setPosition(t_.fromArray(o.scalingOffset)),o.scalingPivot&&a.setPosition(t_.fromArray(o.scalingPivot)),o.rotationOffset&&h.setPosition(t_.fromArray(o.rotationOffset)),o.rotationPivot&&p.setPosition(t_.fromArray(o.rotationPivot)),o.parentMatrixWorld&&(x.copy(o.parentMatrix),v.copy(o.parentMatrixWorld));const L=t.clone().multiply(n).multiply(r),U=new vr;U.extractRotation(v);const R=new vr;R.copyPosition(v);const $=R.clone().invert().multiply(v),Z=U.clone().invert().multiply($),k=i,ie=new vr;if(C===0)ie.copy(U).multiply(L).multiply(Z).multiply(k);else if(C===1)ie.copy(U).multiply(Z).multiply(L).multiply(k);else{const Ue=new vr().scale(new Ie().setFromMatrixScale(x)).clone().invert(),je=Z.clone().multiply(Ue);ie.copy(U).multiply(L).multiply(je).multiply(k)}const ue=p.clone().invert(),ce=a.clone().invert();let Q=e.clone().multiply(h).multiply(p).multiply(t).multiply(n).multiply(r).multiply(ue).multiply(c).multiply(a).multiply(i).multiply(ce);const ae=new vr().copyPosition(Q),le=v.clone().multiply(ae);return S.copyPosition(le),Q=S.clone().multiply(ie),Q.premultiply(v.invert()),Q}function IE(o){o=o||0;const e=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return o===6?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),e[0]):e[o]}function _G(o){return o.split(",").map(function(t){return parseFloat(t)})}function H5e(o,e,t){return e===void 0&&(e=0),t===void 0&&(t=o.byteLength),new TextDecoder().decode(new Uint8Array(o,e,t))}function _We(o,e){for(let t=0,n=o.length,r=e.length;t<r;t++,n++)o[n]=e[t]}function xWe(o,e,t,n){for(let r=t,i=0;r<n;r++,i++)o[i]=e[r];return o}var Qw={exports:{}};Qw.exports;var B2e;function bWe(){return B2e||(B2e=1,function(o,e){var t=Object.create,n=Object.defineProperty,r=Object.defineProperties,i=Object.getOwnPropertyDescriptor,a=Object.getOwnPropertyDescriptors,c=Object.getOwnPropertyNames,h=Object.getOwnPropertySymbols,p=Object.getPrototypeOf,v=Object.prototype.hasOwnProperty,x=Object.prototype.propertyIsEnumerable,S=(w,D,W)=>D in w?n(w,D,{enumerable:!0,configurable:!0,writable:!0,value:W}):w[D]=W,C=(w,D)=>{for(var W in D||(D={}))v.call(D,W)&&S(w,W,D[W]);if(h)for(var W of h(D))x.call(D,W)&&S(w,W,D[W]);return w},I=(w,D)=>r(w,a(D)),L=(w,D)=>function(){return D||(0,w[c(w)[0]])((D={exports:{}}).exports,D),D.exports},U=(w,D)=>{for(var W in D)n(w,W,{get:D[W],enumerable:!0})},R=(w,D,W,re)=>{if(D&&typeof D=="object"||typeof D=="function")for(let me of c(D))!v.call(w,me)&&me!==W&&n(w,me,{get:()=>D[me],enumerable:!(re=i(D,me))||re.enumerable});return w},$=(w,D,W)=>(W=w!=null?t(p(w)):{},R(!w||!w.__esModule?n(W,"default",{value:w,enumerable:!0}):W,w)),Z=w=>R(n({},"__esModule",{value:!0}),w),k=(w,D,W)=>(S(w,typeof D!="symbol"?D+"":D,W),W),ie=L({"../node_modules/timing-function/lib/UnitBezier.js"(w,D){D.exports=function(){function W(re,me,Ee,Ge){this.set(re,me,Ee,Ge)}return W.prototype.set=function(re,me,Ee,Ge){this._cx=3*re,this._bx=3*(Ee-re)-this._cx,this._ax=1-this._cx-this._bx,this._cy=3*me,this._by=3*(Ge-me)-this._cy,this._ay=1-this._cy-this._by},W.epsilon=1e-6,W.prototype._sampleCurveX=function(re){return((this._ax*re+this._bx)*re+this._cx)*re},W.prototype._sampleCurveY=function(re){return((this._ay*re+this._by)*re+this._cy)*re},W.prototype._sampleCurveDerivativeX=function(re){return(3*this._ax*re+2*this._bx)*re+this._cx},W.prototype._solveCurveX=function(re,me){var Ee,Ge,ft,Tt,zt,xn;for(ft=void 0,Tt=void 0,zt=void 0,xn=void 0,Ee=void 0,Ge=void 0,zt=re,Ge=0;Ge<8;){if(xn=this._sampleCurveX(zt)-re,Math.abs(xn)<me)return zt;if(Ee=this._sampleCurveDerivativeX(zt),Math.abs(Ee)<me)break;zt=zt-xn/Ee,Ge++}if(ft=0,Tt=1,zt=re,zt<ft)return ft;if(zt>Tt)return Tt;for(;ft<Tt;){if(xn=this._sampleCurveX(zt),Math.abs(xn-re)<me)return zt;re>xn?ft=zt:Tt=zt,zt=(Tt-ft)*.5+ft}return zt},W.prototype.solve=function(re,me){return this._sampleCurveY(this._solveCurveX(re,me))},W.prototype.solveSimple=function(re){return this._sampleCurveY(this._solveCurveX(re,1e-6))},W}()}}),ue=L({"../node_modules/levenshtein-edit-distance/index.js"(w,D){var W,re;W=[],re=[];function me(Ee,Ge,ft){var Tt,zt,xn,bn,Fn,fr,rr,Te;if(Ee===Ge)return 0;if(Tt=Ee.length,zt=Ge.length,Tt===0)return zt;if(zt===0)return Tt;for(ft&&(Ee=Ee.toLowerCase(),Ge=Ge.toLowerCase()),rr=0;rr<Tt;)re[rr]=Ee.charCodeAt(rr),W[rr]=++rr;for(Te=0;Te<zt;)for(xn=Ge.charCodeAt(Te),bn=Fn=Te++,rr=-1;++rr<Tt;)fr=xn===re[rr]?Fn:Fn+1,Fn=W[rr],W[rr]=bn=Fn>bn?fr>bn?bn+1:fr:fr>Fn?Fn+1:fr;return bn}D.exports=me}}),ce=L({"../node_modules/propose/propose.js"(w,D){var W=ue();function re(){var me,Ee,Ge,ft,Tt,zt=0,xn=arguments[0],bn=arguments[1],Fn=bn.length,fr=arguments[2];fr&&(ft=fr.threshold,Tt=fr.ignoreCase),ft===void 0&&(ft=0);for(var rr=0;rr<Fn;++rr)Tt?Ee=W(xn,bn[rr],!0):Ee=W(xn,bn[rr]),Ee>xn.length?me=1-Ee/bn[rr].length:me=1-Ee/xn.length,me>zt&&(zt=me,Ge=bn[rr]);return zt>=ft?Ge:null}D.exports=re}}),Q=L({"../node_modules/fast-deep-equal/index.js"(w,D){D.exports=function W(re,me){if(re===me)return!0;if(re&&me&&typeof re=="object"&&typeof me=="object"){if(re.constructor!==me.constructor)return!1;var Ee,Ge,ft;if(Array.isArray(re)){if(Ee=re.length,Ee!=me.length)return!1;for(Ge=Ee;Ge--!==0;)if(!W(re[Ge],me[Ge]))return!1;return!0}if(re.constructor===RegExp)return re.source===me.source&&re.flags===me.flags;if(re.valueOf!==Object.prototype.valueOf)return re.valueOf()===me.valueOf();if(re.toString!==Object.prototype.toString)return re.toString()===me.toString();if(ft=Object.keys(re),Ee=ft.length,Ee!==Object.keys(me).length)return!1;for(Ge=Ee;Ge--!==0;)if(!Object.prototype.hasOwnProperty.call(me,ft[Ge]))return!1;for(Ge=Ee;Ge--!==0;){var Tt=ft[Ge];if(!W(re[Tt],me[Tt]))return!1}return!0}return re!==re&&me!==me}}}),ae={};U(ae,{createRafDriver:()=>Ny,getProject:()=>Xx,notify:()=>fm,onChange:()=>Zy,types:()=>Px,val:()=>I5}),o.exports=Z(ae);var le={};U(le,{createRafDriver:()=>Ny,getProject:()=>Xx,notify:()=>fm,onChange:()=>Zy,types:()=>Px,val:()=>I5});var J=mn(),Ue=class{constructor(){k(this,"atom",new J.Atom({projects:{}}))}add(w,D){this.atom.setByPointer(W=>W.projects[w],D)}get(w){return this.atom.get().projects[w]}has(w){return!!this.get(w)}},je=new Ue,rt=je,at=new WeakMap;function Se(w){return at.get(w)}function gt(w,D){at.set(w,D)}var Ae=[],lt=Array.isArray,pt=lt,De=typeof vo=="object"&&vo&&vo.Object===Object&&vo,_t=De,Jt=typeof self=="object"&&self&&self.Object===Object&&self,dt=_t||Jt||Function("return this")(),Dt=dt,gn=Dt.Symbol,qt=gn,wn=Object.prototype,nr=wn.hasOwnProperty,qn=wn.toString,ni=qt?qt.toStringTag:void 0;function ai(w){var D=nr.call(w,ni),W=w[ni];try{w[ni]=void 0;var re=!0}catch{}var me=qn.call(w);return re&&(D?w[ni]=W:delete w[ni]),me}var qr=ai,$e=Object.prototype,Ls=$e.toString;function li(w){return Ls.call(w)}var Ti=li,Ln="[object Null]",Pr="[object Undefined]",sr=qt?qt.toStringTag:void 0;function dr(w){return w==null?w===void 0?Pr:Ln:sr&&sr in Object(w)?qr(w):Ti(w)}var mi=dr;function Oe(w){return w!=null&&typeof w=="object"}var _e=Oe,Ct="[object Symbol]";function Kt(w){return typeof w=="symbol"||_e(w)&&mi(w)==Ct}var Zt=Kt,jt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,or=/^\w*$/;function An(w,D){if(pt(w))return!1;var W=typeof w;return W=="number"||W=="symbol"||W=="boolean"||w==null||Zt(w)?!0:or.test(w)||!jt.test(w)||D!=null&&w in Object(D)}var Gn=An;function ar(w){var D=typeof w;return w!=null&&(D=="object"||D=="function")}var Qt=ar,jn="[object AsyncFunction]",Cr="[object Function]",gr="[object GeneratorFunction]",Pn="[object Proxy]";function wr(w){if(!Qt(w))return!1;var D=mi(w);return D==Cr||D==gr||D==jn||D==Pn}var Ze=wr,Tn=Dt["__core-js_shared__"],nn=Tn,Nn=function(){var w=/[^.]+$/.exec(nn&&nn.keys&&nn.keys.IE_PROTO||"");return w?"Symbol(src)_1."+w:""}();function ln(w){return!!Nn&&Nn in w}var en=ln,Xn=Function.prototype,Sr=Xn.toString;function _i(w){if(w!=null){try{return Sr.call(w)}catch{}try{return w+""}catch{}}return""}var Zr=_i,Bs=/[\\^$.*+?()[\]{}|]/g,so=/^\[object .+?Constructor\]$/,Cc=Function.prototype,Ms=Object.prototype,Us=Cc.toString,h0=Ms.hasOwnProperty,Fl=RegExp("^"+Us.call(h0).replace(Bs,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function $0(w){if(!Qt(w)||en(w))return!1;var D=Ze(w)?Fl:so;return D.test(Zr(w))}var Ro=$0;function Tu(w,D){return w==null?void 0:w[D]}var Mu=Tu;function bf(w,D){var W=Mu(w,D);return Ro(W)?W:void 0}var oo=bf,Dh=oo(Object,"create"),Ll=Dh;function Cu(){this.__data__=Ll?Ll(null):{},this.size=0}var Oh=Cu;function Fh(w){var D=this.has(w)&&delete this.__data__[w];return this.size-=D?1:0,D}var Sf=Fh,we="__lodash_hash_undefined__",st=Object.prototype,Pt=st.hasOwnProperty;function bt(w){var D=this.__data__;if(Ll){var W=D[w];return W===we?void 0:W}return Pt.call(D,w)?D[w]:void 0}var ht=bt,yn=Object.prototype,On=yn.hasOwnProperty;function Un(w){var D=this.__data__;return Ll?D[w]!==void 0:On.call(D,w)}var Hn=Un,lr="__lodash_hash_undefined__";function yr(w,D){var W=this.__data__;return this.size+=this.has(w)?0:1,W[w]=Ll&&D===void 0?lr:D,this}var Yn=yr;function Fr(w){var D=-1,W=w==null?0:w.length;for(this.clear();++D<W;){var re=w[D];this.set(re[0],re[1])}}Fr.prototype.clear=Oh,Fr.prototype.delete=Sf,Fr.prototype.get=ht,Fr.prototype.has=Hn,Fr.prototype.set=Yn;var Lr=Fr;function Ii(){this.__data__=[],this.size=0}var Xi=Ii;function ri(w,D){return w===D||w!==w&&D!==D}var Jn=ri;function Yi(w,D){for(var W=w.length;W--;)if(Jn(w[W][0],D))return W;return-1}var Qr=Yi,Cs=Array.prototype,Ba=Cs.splice;function ko(w){var D=this.__data__,W=Qr(D,w);if(W<0)return!1;var re=D.length-1;return W==re?D.pop():Ba.call(D,W,1),--this.size,!0}var d0=ko;function Ni(w){var D=this.__data__,W=Qr(D,w);return W<0?void 0:D[W][1]}var hs=Ni;function As(w){return Qr(this.__data__,w)>-1}var zs=As;function xs(w,D){var W=this.__data__,re=Qr(W,w);return re<0?(++this.size,W.push([w,D])):W[re][1]=D,this}var hi=xs;function eo(w){var D=-1,W=w==null?0:w.length;for(this.clear();++D<W;){var re=w[D];this.set(re[0],re[1])}}eo.prototype.clear=Xi,eo.prototype.delete=d0,eo.prototype.get=hs,eo.prototype.has=zs,eo.prototype.set=hi;var Lh=eo,a1=oo(Dt,"Map"),Bl=a1;function l1(){this.size=0,this.__data__={hash:new Lr,map:new(Bl||Lh),string:new Lr}}var Ug=l1;function c1(w){var D=typeof w;return D=="string"||D=="number"||D=="symbol"||D=="boolean"?w!=="__proto__":w===null}var Bh=c1;function q0(w,D){var W=w.__data__;return Bh(D)?W[typeof D=="string"?"string":"hash"]:W.map}var Vs=q0;function f0(w){var D=Vs(this,w).delete(w);return this.size-=D?1:0,D}var Au=f0;function Pu(w){return Vs(this,w).get(w)}var X0=Pu;function zg(w){return Vs(this,w).has(w)}var u1=zg;function Ru(w,D){var W=Vs(this,w),re=W.size;return W.set(w,D),this.size+=W.size==re?0:1,this}var Vg=Ru;function Ul(w){var D=-1,W=w==null?0:w.length;for(this.clear();++D<W;){var re=w[D];this.set(re[0],re[1])}}Ul.prototype.clear=Ug,Ul.prototype.delete=Au,Ul.prototype.get=X0,Ul.prototype.has=u1,Ul.prototype.set=Vg;var zl=Ul,Gg="Expected a function";function h1(w,D){if(typeof w!="function"||D!=null&&typeof D!="function")throw new TypeError(Gg);var W=function(){var re=arguments,me=D?D.apply(this,re):re[0],Ee=W.cache;if(Ee.has(me))return Ee.get(me);var Ge=w.apply(this,re);return W.cache=Ee.set(me,Ge)||Ee,Ge};return W.cache=new(h1.Cache||zl),W}h1.Cache=zl;var ku=h1,Uh=500;function Iu(w){var D=ku(w,function(re){return W.size===Uh&&W.clear(),re}),W=D.cache;return D}var Ua=Iu,Ac=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,jg=/\\(\\)?/g,Nu=Ua(function(w){var D=[];return w.charCodeAt(0)===46&&D.push(""),w.replace(Ac,function(W,re,me,Ee){D.push(me?Ee.replace(jg,"$1"):re||W)}),D}),wf=Nu;function Ef(w,D){for(var W=-1,re=w==null?0:w.length,me=Array(re);++W<re;)me[W]=D(w[W],W,w);return me}var d1=Ef,Y0=qt?qt.prototype:void 0,Tf=Y0?Y0.toString:void 0;function Du(w){if(typeof w=="string")return w;if(pt(w))return d1(w,Du)+"";if(Zt(w))return Tf?Tf.call(w):"";var D=w+"";return D=="0"&&1/w==-1/0?"-0":D}var f1=Du;function Mf(w){return w==null?"":f1(w)}var Vl=Mf;function p1(w,D){return pt(w)?w:Gn(w,D)?[w]:wf(Vl(w))}var ao=p1;function Pc(w){if(typeof w=="string"||Zt(w))return w;var D=w+"";return D=="0"&&1/w==-1/0?"-0":D}var ba=Pc;function p0(w,D){D=ao(D,w);for(var W=0,re=D.length;w!=null&&W<re;)w=w[ba(D[W++])];return W&&W==re?w:void 0}var zh=p0;function Vh(w,D,W){var re=w==null?void 0:zh(w,D);return re===void 0?W:re}var K0=Vh;function Rc(w,D){return D.length===0?w:K0(w,D)}var Z0=class{constructor(){k(this,"_values",{})}get(w,D){if(this.has(w))return this._values[w];{const W=D();return this._values[w]=W,W}}has(w){return this._values.hasOwnProperty(w)}},Gs=mn(),Gl=function(){try{var w=oo(Object,"defineProperty");return w({},"",{}),w}catch{}}(),Cf=Gl;function Hg(w,D,W){D=="__proto__"&&Cf?Cf(w,D,{configurable:!0,enumerable:!0,value:W,writable:!0}):w[D]=W}var m0=Hg,Gh=Object.prototype,Wg=Gh.hasOwnProperty;function $g(w,D,W){var re=w[D];(!(Wg.call(w,D)&&Jn(re,W))||W===void 0&&!(D in w))&&m0(w,D,W)}var m1=$g,i4=9007199254740991,Ou=/^(?:0|[1-9]\d*)$/;function g1(w,D){var W=typeof w;return D=D??i4,!!D&&(W=="number"||W!="symbol"&&Ou.test(w))&&w>-1&&w%1==0&&w<D}var y1=g1;function qg(w,D,W,re){if(!Qt(w))return w;D=ao(D,w);for(var me=-1,Ee=D.length,Ge=Ee-1,ft=w;ft!=null&&++me<Ee;){var Tt=ba(D[me]),zt=W;if(Tt==="__proto__"||Tt==="constructor"||Tt==="prototype")return w;if(me!=Ge){var xn=ft[Tt];zt=re?re(xn,Tt,ft):void 0,zt===void 0&&(zt=Qt(xn)?xn:y1(D[me+1])?[]:{})}m1(ft,Tt,zt),ft=ft[Tt]}return w}var Xg=qg;function Af(w,D,W){return w==null?w:Xg(w,D,W)}var jh=Af,bo=new WeakMap;function s4(w){return Fu(w)}function Fu(w){if(bo.has(w))return bo.get(w);const D=w.type==="compound"?Yg(w):w.type==="enum"?v1(w):w.default;return bo.set(w,D),D}function v1(w){const D={$case:w.defaultCase};for(const[W,re]of Object.entries(w.cases))D[W]=Fu(re);return D}function Yg(w){const D={};for(const[W,re]of Object.entries(w.props))D[W]=Fu(re);return D}var $o=mn(),o4=$(ie());function a4(w,D,W){return(0,$o.prism)(()=>{const re=(0,$o.val)(D);return $o.prism.memo("driver",()=>re?re.type==="BasicKeyframedTrack"?Kg(w,re,W):(w.logger.error("Track type not yet supported."),(0,$o.prism)(()=>{})):(0,$o.prism)(()=>{}),[re]).getValue()})}function Kg(w,D,W){return(0,$o.prism)(()=>{let re=$o.prism.ref("state",{started:!1}),me=re.current;const Ee=W.getValue();return(!me.started||Ee<me.validFrom||me.validTo<=Ee)&&(re.current=me=kc(w,W,D)),me.der.getValue()})}var _1=(0,$o.prism)(()=>{});function kc(w,D,W){const re=D.getValue();if(W.keyframes.length===0)return{started:!0,validFrom:-1/0,validTo:1/0,der:_1};let me=0;for(;;){const Ee=W.keyframes[me];if(!Ee)return Qi.error;const Ge=me===W.keyframes.length-1;if(re<Ee.position)return me===0?Qi.beforeFirstKeyframe(Ee):Qi.error;if(Ee.position===re)return Ge?Qi.lastKeyframe(Ee):Qi.between(Ee,W.keyframes[me+1],D);if(me===W.keyframes.length-1)return Qi.lastKeyframe(Ee);{const ft=me+1;if(W.keyframes[ft].position<=re){me=ft;continue}else return Qi.between(Ee,W.keyframes[me+1],D)}}}var Qi={beforeFirstKeyframe(w){return{started:!0,validFrom:-1/0,validTo:w.position,der:(0,$o.prism)(()=>({left:w.value,progression:0}))}},lastKeyframe(w){return{started:!0,validFrom:w.position,validTo:1/0,der:(0,$o.prism)(()=>({left:w.value,progression:0}))}},between(w,D,W){if(!w.connectedRight)return{started:!0,validFrom:w.position,validTo:D.position,der:(0,$o.prism)(()=>({left:w.value,progression:0}))};const re=Ee=>(Ee-w.position)/(D.position-w.position);if(!w.type||w.type==="bezier"){const Ee=new o4.default(w.handles[2],w.handles[3],D.handles[0],D.handles[1]),Ge=(0,$o.prism)(()=>{const ft=re(W.getValue()),Tt=Ee.solveSimple(ft);return{left:w.value,right:D.value,progression:Tt}});return{started:!0,validFrom:w.position,validTo:D.position,der:Ge}}const me=(0,$o.prism)(()=>{const Ee=re(W.getValue()),Ge=Math.floor(Ee);return{left:w.value,right:D.value,progression:Ge}});return{started:!0,validFrom:w.position,validTo:D.position,der:me}},error:{started:!0,validFrom:-1/0,validTo:1/0,der:_1}};function Hh(w,D,W){const me=W.get(w);if(me&&me.override===D)return me.merged;const Ee=C({},w);for(const Ge of Object.keys(D)){const ft=D[Ge],Tt=w[Ge];Ee[Ge]=typeof ft=="object"&&typeof Tt=="object"?Hh(Tt,ft,W):ft===void 0?Tt:ft}return W.set(w,{override:D,merged:Ee}),Ee}function Q0(w,D){let W=w;for(const re of D)W=W[re];return W}var jl=mn(),x1=(w,D)=>{const W=jl.prism.memo(w,()=>new jl.Atom(D),[]);return W.set(D),W},xi=mn(),Ic=mn(),Lu=/\s/;function b1(w){for(var D=w.length;D--&&Lu.test(w.charAt(D)););return D}var S1=b1,w1=/^\s+/;function Zg(w){return w&&w.slice(0,S1(w)+1).replace(w1,"")}var Wh=Zg,J0=NaN,Bu=/^[-+]0x[0-9a-f]+$/i,l4=/^0b[01]+$/i,$h=/^0o[0-7]+$/i,E1=parseInt;function T1(w){if(typeof w=="number")return w;if(Zt(w))return J0;if(Qt(w)){var D=typeof w.valueOf=="function"?w.valueOf():w;w=Qt(D)?D+"":D}if(typeof w!="string")return w===0?w:+w;w=Wh(w);var W=l4.test(w);return W||$h.test(w)?E1(w.slice(2),W?2:8):Bu.test(w)?J0:+w}var de=T1,Pe=1/0,Ye=17976931348623157e292;function Ut(w){if(!w)return w===0?w:0;if(w=de(w),w===Pe||w===-Pe){var D=w<0?-1:1;return D*Ye}return w===w?w:0}var Ar=Ut;function di(w){var D=Ar(w),W=D%1;return D===D?W?D-W:D:0}var to=di;function g0(w){return w}var Pf=g0,Uu=oo(Dt,"WeakMap"),Io=Uu,qh=Object.create,c4=function(){function w(){}return function(D){if(!Qt(D))return{};if(qh)return qh(D);w.prototype=D;var W=new w;return w.prototype=void 0,W}}(),R6=c4;function k6(w,D){var W=-1,re=w.length;for(D||(D=Array(re));++W<re;)D[W]=w[W];return D}var u4=k6;function h4(w,D){for(var W=-1,re=w==null?0:w.length;++W<re&&D(w[W],W,w)!==!1;);return w}var ox=h4;function I6(w,D,W,re){var me=!W;W||(W={});for(var Ee=-1,Ge=D.length;++Ee<Ge;){var ft=D[Ee],Tt=re?re(W[ft],w[ft],ft,W,w):void 0;Tt===void 0&&(Tt=w[ft]),me?m0(W,ft,Tt):m1(W,ft,Tt)}return W}var el=I6,d4=9007199254740991;function Xh(w){return typeof w=="number"&&w>-1&&w%1==0&&w<=d4}var Rf=Xh;function f4(w){return w!=null&&Rf(w.length)&&!Ze(w)}var kf=f4,Nc=Object.prototype;function M1(w){var D=w&&w.constructor,W=typeof D=="function"&&D.prototype||Nc;return w===W}var Qg=M1;function C1(w,D){for(var W=-1,re=Array(w);++W<w;)re[W]=D(W);return re}var N6=C1,Jg="[object Arguments]";function e2(w){return _e(w)&&mi(w)==Jg}var t2=e2,A1=Object.prototype,p4=A1.hasOwnProperty,Dc=A1.propertyIsEnumerable,If=t2(function(){return arguments}())?t2:function(w){return _e(w)&&p4.call(w,"callee")&&!Dc.call(w,"callee")},P1=If;function ax(){return!1}var D6=ax,Yh=e&&!e.nodeType&&e,m4=Yh&&!0&&o&&!o.nodeType&&o,g4=m4&&m4.exports===Yh,n2=g4?Dt.Buffer:void 0,Ji=n2?n2.isBuffer:void 0,r2=Ji||D6,zu=r2,Nf="[object Arguments]",y4="[object Array]",i2="[object Boolean]",Df="[object Date]",R1="[object Error]",Kh="[object Function]",v4="[object Map]",O6="[object Number]",F6="[object Object]",_4="[object RegExp]",k1="[object Set]",I1="[object String]",s2="[object WeakMap]",o2="[object ArrayBuffer]",a2="[object DataView]",l2="[object Float32Array]",es="[object Float64Array]",x4="[object Int8Array]",lx="[object Int16Array]",cx="[object Int32Array]",Of="[object Uint8Array]",Hl="[object Uint8ClampedArray]",c2="[object Uint16Array]",tl="[object Uint32Array]",gi={};gi[l2]=gi[es]=gi[x4]=gi[lx]=gi[cx]=gi[Of]=gi[Hl]=gi[c2]=gi[tl]=!0,gi[Nf]=gi[y4]=gi[o2]=gi[i2]=gi[a2]=gi[Df]=gi[R1]=gi[Kh]=gi[v4]=gi[O6]=gi[F6]=gi[_4]=gi[k1]=gi[I1]=gi[s2]=!1;function Vu(w){return _e(w)&&Rf(w.length)&&!!gi[mi(w)]}var Wl=Vu;function N1(w){return function(D){return w(D)}}var b4=N1,u2=e&&!e.nodeType&&e,y0=u2&&!0&&o&&!o.nodeType&&o,Zh=y0&&y0.exports===u2,Oc=Zh&&_t.process,h2=function(){try{var w=y0&&y0.require&&y0.require("util").types;return w||Oc&&Oc.binding&&Oc.binding("util")}catch{}}(),Fc=h2,Gu=Fc&&Fc.isTypedArray,Lc=Gu?b4(Gu):Wl,ts=Lc,ns=Object.prototype,$l=ns.hasOwnProperty;function No(w,D){var W=pt(w),re=!W&&P1(w),me=!W&&!re&&zu(w),Ee=!W&&!re&&!me&&ts(w),Ge=W||re||me||Ee,ft=Ge?N6(w.length,String):[],Tt=ft.length;for(var zt in w)(D||$l.call(w,zt))&&!(Ge&&(zt=="length"||me&&(zt=="offset"||zt=="parent")||Ee&&(zt=="buffer"||zt=="byteLength"||zt=="byteOffset")||y1(zt,Tt)))&&ft.push(zt);return ft}var qo=No;function ju(w,D){return function(W){return w(D(W))}}var Qh=ju,Sa=Qh(Object.keys,Object),D1=Sa,S4=Object.prototype,w4=S4.hasOwnProperty;function d2(w){if(!Qg(w))return D1(w);var D=[];for(var W in Object(w))w4.call(w,W)&&W!="constructor"&&D.push(W);return D}var L6=d2;function v0(w){return kf(w)?qo(w):L6(w)}var ql=v0;function E4(w){var D=[];if(w!=null)for(var W in Object(w))D.push(W);return D}var T4=E4,B6=Object.prototype,nl=B6.hasOwnProperty;function Hu(w){if(!Qt(w))return T4(w);var D=Qg(w),W=[];for(var re in w)re=="constructor"&&(D||!nl.call(w,re))||W.push(re);return W}var Jh=Hu;function Bc(w){return kf(w)?qo(w,!0):Jh(w)}var Uc=Bc;function _0(w,D){for(var W=-1,re=D.length,me=w.length;++W<re;)w[me+W]=D[W];return w}var wa=_0,ed=Qh(Object.getPrototypeOf,Object),rl=ed,Xl="[object Object]",td=Function.prototype,U6=Object.prototype,O1=td.toString,f2=U6.hasOwnProperty,Ea=O1.call(Object);function Ta(w){if(!_e(w)||mi(w)!=Xl)return!1;var D=rl(w);if(D===null)return!0;var W=f2.call(D,"constructor")&&D.constructor;return typeof W=="function"&&W instanceof W&&O1.call(W)==Ea}var ds=Ta;function il(w,D,W){var re=-1,me=w.length;D<0&&(D=-D>me?0:me+D),W=W>me?me:W,W<0&&(W+=me),me=D>W?0:W-D>>>0,D>>>=0;for(var Ee=Array(me);++re<me;)Ee[re]=w[re+D];return Ee}var p2=il;function M4(w,D,W){var re=w.length;return W=W===void 0?re:W,!D&&W>=re?w:p2(w,D,W)}var m2=M4,C4="\\ud800-\\udfff",z6="\\u0300-\\u036f",F1="\\ufe20-\\ufe2f",A4="\\u20d0-\\u20ff",Ff=z6+F1+A4,Wu="\\ufe0e\\ufe0f",P4="\\u200d",L1=RegExp("["+P4+C4+Ff+Wu+"]");function g2(w){return L1.test(w)}var B1=g2;function V6(w){return w.split("")}var Lf=V6,nd="\\ud800-\\udfff",rd="\\u0300-\\u036f",y2="\\ufe20-\\ufe2f",id="\\u20d0-\\u20ff",v2=rd+y2+id,_2="\\ufe0e\\ufe0f",R4="["+nd+"]",U1="["+v2+"]",zc="\\ud83c[\\udffb-\\udfff]",x0="(?:"+U1+"|"+zc+")",$u="[^"+nd+"]",z1="(?:\\ud83c[\\udde6-\\uddff]){2}",k4="[\\ud800-\\udbff][\\udc00-\\udfff]",Vc="\\u200d",Yl=x0+"?",x2="["+_2+"]?",sd="(?:"+Vc+"(?:"+[$u,z1,k4].join("|")+")"+x2+Yl+")*",za=x2+Yl+sd,sl="(?:"+[$u+U1+"?",U1,z1,k4,R4].join("|")+")",V1=RegExp(zc+"(?="+zc+")|"+sl+za,"g");function od(w){return w.match(V1)||[]}var Bf=od;function G6(w){return B1(w)?Bf(w):Lf(w)}var Uf=G6;function Kl(w,D,W){return w===w&&(W!==void 0&&(w=w<=W?w:W),D!==void 0&&(w=w>=D?w:D)),w}var G1=Kl;function zf(w,D,W){return W===void 0&&(W=D,D=void 0),W!==void 0&&(W=de(W),W=W===W?W:0),D!==void 0&&(D=de(D),D=D===D?D:0),G1(de(w),D,W)}var qu=zf;function I4(){this.__data__=new Lh,this.size=0}var Zl=I4;function j1(w){var D=this.__data__,W=D.delete(w);return this.size=D.size,W}var N4=j1;function fs(w){return this.__data__.get(w)}var b2=fs;function D4(w){return this.__data__.has(w)}var S2=D4,w2=200;function O4(w,D){var W=this.__data__;if(W instanceof Lh){var re=W.__data__;if(!Bl||re.length<w2-1)return re.push([w,D]),this.size=++W.size,this;W=this.__data__=new zl(re)}return W.set(w,D),this.size=W.size,this}var Xu=O4;function Gi(w){var D=this.__data__=new Lh(w);this.size=D.size}Gi.prototype.clear=Zl,Gi.prototype.delete=N4,Gi.prototype.get=b2,Gi.prototype.has=S2,Gi.prototype.set=Xu;var bs=Gi;function lo(w,D){return w&&el(D,ql(D),w)}var E2=lo;function Ql(w,D){return w&&el(D,Uc(D),w)}var Gc=Ql,T2=e&&!e.nodeType&&e,co=T2&&!0&&o&&!o.nodeType&&o,M2=co&&co.exports===T2,Vf=M2?Dt.Buffer:void 0,H1=Vf?Vf.allocUnsafe:void 0;function Jl(w,D){if(D)return w.slice();var W=w.length,re=H1?H1(W):new w.constructor(W);return w.copy(re),re}var Va=Jl;function Gf(w,D){for(var W=-1,re=w==null?0:w.length,me=0,Ee=[];++W<re;){var Ge=w[W];D(Ge,W,w)&&(Ee[me++]=Ge)}return Ee}var F4=Gf;function C2(){return[]}var A2=C2,L4=Object.prototype,B4=L4.propertyIsEnumerable,U4=Object.getOwnPropertySymbols,j6=U4?function(w){return w==null?[]:(w=Object(w),F4(U4(w),function(D){return B4.call(w,D)}))}:A2,ad=j6;function z4(w,D){return el(w,ad(w),D)}var H6=z4,Yu=Object.getOwnPropertySymbols,P2=Yu?function(w){for(var D=[];w;)wa(D,ad(w)),w=rl(w);return D}:A2,W1=P2;function $1(w,D){return el(w,W1(w),D)}var ld=$1;function cd(w,D,W){var re=D(w);return pt(w)?re:wa(re,W(w))}var V4=cd;function q1(w){return V4(w,ql,ad)}var jf=q1;function W6(w){return V4(w,Uc,W1)}var jc=W6,Hf=oo(Dt,"DataView"),R2=Hf,k2=oo(Dt,"Promise"),I2=k2,$6=oo(Dt,"Set"),X1=$6,G4="[object Map]",q6="[object Object]",N2="[object Promise]",D2="[object Set]",Y1="[object WeakMap]",j4="[object DataView]",X6=Zr(R2),ux=Zr(Bl),ol=Zr(I2),O2=Zr(X1),K1=Zr(Io),Hc=mi;(R2&&Hc(new R2(new ArrayBuffer(1)))!=j4||Bl&&Hc(new Bl)!=G4||I2&&Hc(I2.resolve())!=N2||X1&&Hc(new X1)!=D2||Io&&Hc(new Io)!=Y1)&&(Hc=function(w){var D=mi(w),W=D==q6?w.constructor:void 0,re=W?Zr(W):"";if(re)switch(re){case X6:return j4;case ux:return G4;case ol:return N2;case O2:return D2;case K1:return Y1}return D});var Ku=Hc,H4=Object.prototype,F2=H4.hasOwnProperty;function Wc(w){var D=w.length,W=new w.constructor(D);return D&&typeof w[0]=="string"&&F2.call(w,"index")&&(W.index=w.index,W.input=w.input),W}var L2=Wc,W4=Dt.Uint8Array,Z1=W4;function $4(w){var D=new w.constructor(w.byteLength);return new Z1(D).set(new Z1(w)),D}var Q1=$4;function Y6(w,D){var W=D?Q1(w.buffer):w.buffer;return new w.constructor(W,w.byteOffset,w.byteLength)}var K6=Y6,q4=/\w*$/;function hx(w){var D=new w.constructor(w.source,q4.exec(w));return D.lastIndex=w.lastIndex,D}var Ma=hx,ii=qt?qt.prototype:void 0,Wf=ii?ii.valueOf:void 0;function Z6(w){return Wf?Object(Wf.call(w)):{}}var X4=Z6;function Q6(w,D){var W=D?Q1(w.buffer):w.buffer;return new w.constructor(W,w.byteOffset,w.length)}var J6=Q6,B2="[object Boolean]",ey="[object Date]",Y4="[object Map]",K4="[object Number]",ty="[object RegExp]",Z4="[object Set]",U2="[object String]",ny="[object Symbol]",Q4="[object ArrayBuffer]",J1="[object DataView]",ry="[object Float32Array]",iy="[object Float64Array]",Zu="[object Int8Array]",$f="[object Int16Array]",em="[object Int32Array]",$c="[object Uint8Array]",sy="[object Uint8ClampedArray]",oy="[object Uint16Array]",J4="[object Uint32Array]";function e5(w,D,W){var re=w.constructor;switch(D){case Q4:return Q1(w);case B2:case ey:return new re(+w);case J1:return K6(w,W);case ry:case iy:case Zu:case $f:case em:case $c:case sy:case oy:case J4:return J6(w,W);case Y4:return new re;case K4:case U2:return new re(w);case ty:return Ma(w);case Z4:return new re;case ny:return X4(w)}}var ay=e5;function qf(w){return typeof w.constructor=="function"&&!Qg(w)?R6(rl(w)):{}}var Do=qf,t5="[object Map]";function ly(w){return _e(w)&&Ku(w)==t5}var tm=ly,Oo=Fc&&Fc.isMap,dx=Oo?b4(Oo):tm,Kn=dx,Xf="[object Set]";function n5(w){return _e(w)&&Ku(w)==Xf}var z2=n5,cy=Fc&&Fc.isSet,Yf=cy?b4(cy):z2,ud=Yf,r5=1,i5=2,nm=4,s5="[object Arguments]",V2="[object Array]",qc="[object Boolean]",So="[object Date]",Ga="[object Error]",ec="[object Function]",G2="[object GeneratorFunction]",j2="[object Map]",ja="[object Number]",rm="[object Object]",al="[object RegExp]",uy="[object Set]",o5="[object String]",a5="[object Symbol]",l5="[object WeakMap]",Xc="[object ArrayBuffer]",c5="[object DataView]",H2="[object Float32Array]",W2="[object Float64Array]",Ca="[object Int8Array]",Mi="[object Int16Array]",wo="[object Int32Array]",js="[object Uint8Array]",Eo="[object Uint8ClampedArray]",Ha="[object Uint16Array]",Kf="[object Uint32Array]",Br={};Br[s5]=Br[V2]=Br[Xc]=Br[c5]=Br[qc]=Br[So]=Br[H2]=Br[W2]=Br[Ca]=Br[Mi]=Br[wo]=Br[j2]=Br[ja]=Br[rm]=Br[al]=Br[uy]=Br[o5]=Br[a5]=Br[js]=Br[Eo]=Br[Ha]=Br[Kf]=!0,Br[Ga]=Br[ec]=Br[l5]=!1;function Qu(w,D,W,re,me,Ee){var Ge,ft=D&r5,Tt=D&i5,zt=D&nm;if(W&&(Ge=me?W(w,re,me,Ee):W(w)),Ge!==void 0)return Ge;if(!Qt(w))return w;var xn=pt(w);if(xn){if(Ge=L2(w),!ft)return u4(w,Ge)}else{var bn=Ku(w),Fn=bn==ec||bn==G2;if(zu(w))return Va(w,ft);if(bn==rm||bn==s5||Fn&&!me){if(Ge=Tt||Fn?{}:Do(w),!ft)return Tt?ld(w,Gc(Ge,w)):H6(w,E2(Ge,w))}else{if(!Br[bn])return me?w:{};Ge=ay(w,bn,ft)}}Ee||(Ee=new bs);var fr=Ee.get(w);if(fr)return fr;Ee.set(w,Ge),ud(w)?w.forEach(function(Ft){Ge.add(Qu(Ft,D,W,Ft,w,Ee))}):Kn(w)&&w.forEach(function(Ft,Or){Ge.set(Or,Qu(Ft,D,W,Or,w,Ee))});var rr=zt?Tt?jc:jf:Tt?Uc:ql,Te=xn?void 0:rr(w);return ox(Te||w,function(Ft,Or){Te&&(Or=Ft,Ft=w[Or]),m1(Ge,Or,Qu(Ft,D,W,Or,w,Ee))}),Ge}var tc=Qu,Zf=1,$2=4;function im(w){return tc(w,Zf|$2)}var la=im,u5="__lodash_hash_undefined__";function Qf(w){return this.__data__.set(w,u5),this}var ll=Qf;function sm(w){return this.__data__.has(w)}var h5=sm;function b0(w){var D=-1,W=w==null?0:w.length;for(this.__data__=new zl;++D<W;)this.add(w[D])}b0.prototype.add=b0.prototype.push=ll,b0.prototype.has=h5;var om=b0;function nc(w,D){for(var W=-1,re=w==null?0:w.length;++W<re;)if(D(w[W],W,w))return!0;return!1}var am=nc;function lm(w,D){return w.has(D)}var q2=lm,X2=1,Y2=2;function To(w,D,W,re,me,Ee){var Ge=W&X2,ft=w.length,Tt=D.length;if(ft!=Tt&&!(Ge&&Tt>ft))return!1;var zt=Ee.get(w),xn=Ee.get(D);if(zt&&xn)return zt==D&&xn==w;var bn=-1,Fn=!0,fr=W&Y2?new om:void 0;for(Ee.set(w,D),Ee.set(D,w);++bn<ft;){var rr=w[bn],Te=D[bn];if(re)var Ft=Ge?re(Te,rr,bn,D,w,Ee):re(rr,Te,bn,w,D,Ee);if(Ft!==void 0){if(Ft)continue;Fn=!1;break}if(fr){if(!am(D,function(Or,Oi){if(!q2(fr,Oi)&&(rr===Or||me(rr,Or,W,re,Ee)))return fr.push(Oi)})){Fn=!1;break}}else if(!(rr===Te||me(rr,Te,W,re,Ee))){Fn=!1;break}}return Ee.delete(w),Ee.delete(D),Fn}var cl=To;function ul(w){var D=-1,W=Array(w.size);return w.forEach(function(re,me){W[++D]=[me,re]}),W}var ca=ul;function d5(w){var D=-1,W=Array(w.size);return w.forEach(function(re){W[++D]=re}),W}var K2=d5,Z2=1,hy=2,Yc="[object Boolean]",f5="[object Date]",Q2="[object Error]",Ju="[object Map]",J2="[object Number]",eh="[object RegExp]",p5="[object Set]",m5="[object String]",cm="[object Symbol]",hd="[object ArrayBuffer]",dy="[object DataView]",fy=qt?qt.prototype:void 0,e9=fy?fy.valueOf:void 0;function g5(w,D,W,re,me,Ee,Ge){switch(W){case dy:if(w.byteLength!=D.byteLength||w.byteOffset!=D.byteOffset)return!1;w=w.buffer,D=D.buffer;case hd:return!(w.byteLength!=D.byteLength||!Ee(new Z1(w),new Z1(D)));case Yc:case f5:case J2:return Jn(+w,+D);case Q2:return w.name==D.name&&w.message==D.message;case eh:case m5:return w==D+"";case Ju:var ft=ca;case p5:var Tt=re&Z2;if(ft||(ft=K2),w.size!=D.size&&!Tt)return!1;var zt=Ge.get(w);if(zt)return zt==D;re|=hy,Ge.set(w,D);var xn=cl(ft(w),ft(D),re,me,Ee,Ge);return Ge.delete(w),xn;case cm:if(e9)return e9.call(w)==e9.call(D)}return!1}var th=g5,py=1,dd=Object.prototype,my=dd.hasOwnProperty;function Ps(w,D,W,re,me,Ee){var Ge=W&py,ft=jf(w),Tt=ft.length,zt=jf(D),xn=zt.length;if(Tt!=xn&&!Ge)return!1;for(var bn=Tt;bn--;){var Fn=ft[bn];if(!(Ge?Fn in D:my.call(D,Fn)))return!1}var fr=Ee.get(w),rr=Ee.get(D);if(fr&&rr)return fr==D&&rr==w;var Te=!0;Ee.set(w,D),Ee.set(D,w);for(var Ft=Ge;++bn<Tt;){Fn=ft[bn];var Or=w[Fn],Oi=D[Fn];if(re)var Aa=Ge?re(Oi,Or,Fn,D,w,Ee):re(Or,Oi,Fn,w,D,Ee);if(!(Aa===void 0?Or===Oi||me(Or,Oi,W,re,Ee):Aa)){Te=!1;break}Ft||(Ft=Fn=="constructor")}if(Te&&!Ft){var w0=w.constructor,Co=D.constructor;w0!=Co&&"constructor"in w&&"constructor"in D&&!(typeof w0=="function"&&w0 instanceof w0&&typeof Co=="function"&&Co instanceof Co)&&(Te=!1)}return Ee.delete(w),Ee.delete(D),Te}var gy=Ps,t9=1,n9="[object Arguments]",Jf="[object Array]",ep="[object Object]",r9=Object.prototype,y5=r9.hasOwnProperty;function S0(w,D,W,re,me,Ee){var Ge=pt(w),ft=pt(D),Tt=Ge?Jf:Ku(w),zt=ft?Jf:Ku(D);Tt=Tt==n9?ep:Tt,zt=zt==n9?ep:zt;var xn=Tt==ep,bn=zt==ep,Fn=Tt==zt;if(Fn&&zu(w)){if(!zu(D))return!1;Ge=!0,xn=!1}if(Fn&&!xn)return Ee||(Ee=new bs),Ge||ts(w)?cl(w,D,W,re,me,Ee):th(w,D,Tt,W,re,me,Ee);if(!(W&t9)){var fr=xn&&y5.call(w,"__wrapped__"),rr=bn&&y5.call(D,"__wrapped__");if(fr||rr){var Te=fr?w.value():w,Ft=rr?D.value():D;return Ee||(Ee=new bs),me(Te,Ft,W,re,Ee)}}return Fn?(Ee||(Ee=new bs),gy(w,D,W,re,me,Ee)):!1}var i9=S0;function s9(w,D,W,re,me){return w===D?!0:w==null||D==null||!_e(w)&&!_e(D)?w!==w&&D!==D:i9(w,D,W,re,s9,me)}var rc=s9,o9=1,nh=2;function um(w,D,W,re){var me=W.length,Ee=me,Ge=!re;if(w==null)return!Ee;for(w=Object(w);me--;){var ft=W[me];if(Ge&&ft[2]?ft[1]!==w[ft[0]]:!(ft[0]in w))return!1}for(;++me<Ee;){ft=W[me];var Tt=ft[0],zt=w[Tt],xn=ft[1];if(Ge&&ft[2]){if(zt===void 0&&!(Tt in w))return!1}else{var bn=new bs;if(re)var Fn=re(zt,xn,Tt,w,D,bn);if(!(Fn===void 0?rc(xn,zt,o9|nh,re,bn):Fn))return!1}}return!0}var a9=um;function v5(w){return w===w&&!Qt(w)}var yy=v5;function hm(w){for(var D=ql(w),W=D.length;W--;){var re=D[W],me=w[re];D[W]=[re,me,yy(me)]}return D}var vy=hm;function _y(w,D){return function(W){return W==null?!1:W[w]===D&&(D!==void 0||w in Object(W))}}var l9=_y;function c9(w){var D=vy(w);return D.length==1&&D[0][2]?l9(D[0][0],D[0][1]):function(W){return W===w||a9(W,w,D)}}var u9=c9;function h9(w,D){return w!=null&&D in Object(w)}var d9=h9;function fx(w,D,W){D=ao(D,w);for(var re=-1,me=D.length,Ee=!1;++re<me;){var Ge=ba(D[re]);if(!(Ee=w!=null&&W(w,Ge)))break;w=w[Ge]}return Ee||++re!=me?Ee:(me=w==null?0:w.length,!!me&&Rf(me)&&y1(Ge,me)&&(pt(w)||P1(w)))}var _5=fx;function x5(w,D){return w!=null&&_5(w,D,d9)}var f9=x5,p9=1,m9=2;function xy(w,D){return Gn(w)&&yy(D)?l9(ba(w),D):function(W){var re=K0(W,w);return re===void 0&&re===D?f9(W,w):rc(D,re,p9|m9)}}var by=xy;function g9(w){return function(D){return D==null?void 0:D[w]}}var Sy=g9;function tp(w){return function(D){return zh(D,w)}}var px=tp;function y9(w){return Gn(w)?Sy(ba(w)):px(w)}var d=y9;function g(w){return typeof w=="function"?w:w==null?Pf:typeof w=="object"?pt(w)?by(w[0],w[1]):u9(w):d(w)}var M=g;function O(w){return function(D,W,re){for(var me=-1,Ee=Object(D),Ge=re(D),ft=Ge.length;ft--;){var Tt=Ge[w?ft:++me];if(W(Ee[Tt],Tt,Ee)===!1)break}return D}}var q=O,ee=q(),ge=ee;function Fe(w,D){return w&&ge(w,D,ql)}var Xe=Fe,Ot=function(){return Dt.Date.now()},on=Ot,vn="Expected a function",an=Math.max,Wn=Math.min;function $n(w,D,W){var re,me,Ee,Ge,ft,Tt,zt=0,xn=!1,bn=!1,Fn=!0;if(typeof w!="function")throw new TypeError(vn);D=de(D)||0,Qt(W)&&(xn=!!W.leading,bn="maxWait"in W,Ee=bn?an(de(W.maxWait)||0,D):Ee,Fn="trailing"in W?!!W.trailing:Fn);function fr(Ki){var Pa=re,fl=me;return re=me=void 0,zt=Ki,Ge=w.apply(fl,Pa),Ge}function rr(Ki){return zt=Ki,ft=setTimeout(Or,D),xn?fr(Ki):Ge}function Te(Ki){var Pa=Ki-Tt,fl=Ki-zt,sc=D-Pa;return bn?Wn(sc,Ee-fl):sc}function Ft(Ki){var Pa=Ki-Tt,fl=Ki-zt;return Tt===void 0||Pa>=D||Pa<0||bn&&fl>=Ee}function Or(){var Ki=on();if(Ft(Ki))return Oi(Ki);ft=setTimeout(Or,Te(Ki))}function Oi(Ki){return ft=void 0,Fn&&re?fr(Ki):(re=me=void 0,Ge)}function Aa(){ft!==void 0&&clearTimeout(ft),zt=0,re=Tt=me=ft=void 0}function w0(){return ft===void 0?Ge:Oi(on())}function Co(){var Ki=on(),Pa=Ft(Ki);if(re=arguments,me=this,Tt=Ki,Pa){if(ft===void 0)return rr(Tt);if(bn)return clearTimeout(ft),ft=setTimeout(Or,D),fr(Tt)}return ft===void 0&&(ft=setTimeout(Or,D)),Ge}return Co.cancel=Aa,Co.flush=w0,Co}var Zn=$n;function Hs(w){var D=w==null?0:w.length;return D?w[D-1]:void 0}var xt=Hs;function tt(w,D){return D.length<2?w:zh(w,p2(D,0,-1))}var At=tt;function En(w){return typeof w=="number"&&w==to(w)}var cr=En;function Er(w,D){var W={};return D=M(D),Xe(w,function(re,me,Ee){m0(W,me,D(re,me,Ee))}),W}var Tr=Er;function Dr(w,D){return D=ao(D,w),w=At(w,D),w==null||delete w[ba(xt(D))]}var Mo=Dr,bi=9007199254740991,Kc=Math.floor;function mx(w,D){var W="";if(!w||D<1||D>bi)return W;do D%2&&(W+=w),D=Kc(D/2),D&&(w+=w);while(D);return W}var gx=mx,jI=Sy("length"),zE=jI,wy="\\ud800-\\udfff",VE="\\u0300-\\u036f",HI="\\ufe20-\\ufe2f",GE="\\u20d0-\\u20ff",WI=VE+HI+GE,$I="\\ufe0e\\ufe0f",jE="["+wy+"]",yx="["+WI+"]",Ey="\\ud83c[\\udffb-\\udfff]",Ty="(?:"+yx+"|"+Ey+")",HE="[^"+wy+"]",WE="(?:\\ud83c[\\udde6-\\uddff]){2}",vx="[\\ud800-\\udbff][\\udc00-\\udfff]",$E="\\u200d",_x=Ty+"?",My="["+$I+"]?",qE="(?:"+$E+"(?:"+[HE,WE,vx].join("|")+")"+My+_x+")*",qI=My+_x+qE,XE="(?:"+[HE+yx+"?",yx,WE,vx,jE].join("|")+")",YE=RegExp(Ey+"(?="+Ey+")|"+XE+qI,"g");function XI(w){for(var D=YE.lastIndex=0;YE.test(w);)++D;return D}var dm=XI;function Cy(w){return B1(w)?dm(w):zE(w)}var KE=Cy,ZE=Math.ceil;function xx(w,D){D=D===void 0?" ":f1(D);var W=D.length;if(W<2)return W?gx(D,w):D;var re=gx(D,ZE(w/KE(D)));return B1(D)?m2(Uf(re),0,w).join(""):re.slice(0,w)}var YI=xx;function KI(w,D,W){w=Vl(w),D=to(D);var re=D?KE(w):0;return D&&re<D?YI(D-re,W)+w:w}var v9=KI;function QE(w,D){return w==null?!0:Mo(w,D)}var bx=QE,ZI=5*1e3,QI=class{constructor(w){k(this,"_cache",new Z0),k(this,"_keepHotUntapDebounce"),gt(this,w)}get type(){return"Theatre_SheetObject_PublicAPI"}get props(){return Se(this).propsP}get sheet(){return Se(this).sheet.publicApi}get project(){return Se(this).sheet.project.publicApi}get address(){return C({},Se(this).address)}_valuesPrism(){return this._cache.get("_valuesPrism",()=>{const w=Se(this);return(0,Ic.prism)(()=>(0,Ic.val)(w.getValues().getValue()))})}onValuesChange(w,D){return Zy(this._valuesPrism(),w,D)}get value(){const w=this._valuesPrism();{if(!w.isHot){this._keepHotUntapDebounce!=null&&this._keepHotUntapDebounce.flush();const D=w.keepHot();this._keepHotUntapDebounce=Zn(()=>{D(),this._keepHotUntapDebounce=void 0},ZI)}this._keepHotUntapDebounce&&this._keepHotUntapDebounce()}return w.getValue()}set initialValue(w){Se(this).setInitialValue(w)}};function JE(w){const D=new WeakMap;return W=>(D.has(W)||D.set(W,w(W)),D.get(W))}function Ay(w){return w.type==="compound"||w.type==="enum"}function Sx(w,D){if(!w)return;const[W,...re]=D;if(W===void 0)return w;if(!Ay(w))return;const me=w.type==="enum"?w.cases[W]:w.props[W];return Sx(me,re)}function eT(w){return!Ay(w)}var tT=class{constructor(w,D,W){this.sheet=w,this.template=D,this.nativeObject=W,k(this,"$$isPointerToPrismProvider",!0),k(this,"address"),k(this,"publicApi"),k(this,"_initialValue",new xi.Atom({})),k(this,"_cache",new Z0),k(this,"_logger"),k(this,"_internalUtilCtx"),this._logger=w._logger.named("SheetObject",D.address.objectKey),this._logger._trace("creating object"),this._internalUtilCtx={logger:this._logger.utilFor.internal()},this.address=I(C({},D.address),{sheetInstanceId:w.address.sheetInstanceId}),this.publicApi=new QI(this)}get type(){return"Theatre_SheetObject"}getValues(){return this._cache.get("getValues()",()=>(0,xi.prism)(()=>{const w=(0,xi.val)(this.template.getDefaultValues()),D=(0,xi.val)(this._initialValue.pointer),W=xi.prism.memo("withInitialCache",()=>new WeakMap,[]),re=Hh(w,D,W),me=(0,xi.val)(this.template.getStaticValues()),Ee=xi.prism.memo("withStatics",()=>new WeakMap,[]);let ft=Hh(re,me,Ee),Tt;{const xn=xi.prism.memo("seq",()=>this.getSequencedValues(),[]),bn=xi.prism.memo("withSeqsCache",()=>new WeakMap,[]);Tt=(0,xi.val)((0,xi.val)(xn)),ft=Hh(ft,Tt,bn)}return x1("finalAtom",ft).pointer}))}getValueByPointer(w){const D=(0,xi.val)(this.getValues()),{path:W}=(0,xi.getPointerParts)(w);return(0,xi.val)(Q0(D,W))}pointerToPrism(w){const{path:D}=(0,xi.getPointerParts)(w);return(0,xi.prism)(()=>{const W=(0,xi.val)(this.getValues());return(0,xi.val)(Q0(W,D))})}getSequencedValues(){return(0,xi.prism)(()=>{const w=xi.prism.memo("tracksToProcess",()=>this.template.getArrayOfValidSequenceTracks(),[]),D=(0,xi.val)(w),W=new xi.Atom({}),re=(0,xi.val)(this.template.configPointer);return xi.prism.effect("processTracks",()=>{const me=[];for(const{trackId:Ee,pathToProp:Ge}of D){const ft=this._trackIdToPrism(Ee),Tt=Sx(re,Ge),zt=Tt.deserializeAndSanitize,xn=Tt.interpolate,bn=()=>{const fr=ft.getValue();if(!fr)return W.setByPointer(Oi=>Q0(Oi,Ge),void 0);const rr=zt(fr.left),Te=rr===void 0?Tt.default:rr;if(fr.right===void 0)return W.setByPointer(Oi=>Q0(Oi,Ge),Te);const Ft=zt(fr.right),Or=Ft===void 0?Tt.default:Ft;return W.setByPointer(Oi=>Q0(Oi,Ge),xn(Te,Or,fr.progression))},Fn=ft.onStale(bn);bn(),me.push(Fn)}return()=>{for(const Ee of me)Ee()}},[re,...D]),W.pointer})}_trackIdToPrism(w){const D=this.template.project.pointers.historic.sheetsById[this.address.sheetId].sequence.tracksByObject[this.address.objectKey].trackData[w],W=this.sheet.getSequence().positionPrism;return a4(this._internalUtilCtx,D,W)}get propsP(){return this._cache.get("propsP",()=>(0,xi.pointer)({root:this,path:[]}))}validateValue(w,D){}setInitialValue(w){this.validateValue(this.propsP,w),this._initialValue.set(w)}};function ls(w){return function(W,re){return w(W,re())}}var hl={_hmm:dl(524),_todo:dl(522),_error:dl(521),errorDev:dl(529),errorPublic:dl(545),_kapow:dl(268),_warn:dl(265),warnDev:dl(273),warnPublic:dl(289),_debug:dl(137),debugDev:dl(145),_trace:dl(73),traceDev:dl(81)};function dl(w){return Object.freeze({audience:fd(w,8)?"internal":fd(w,16)?"dev":"public",category:fd(w,4)?"troubleshooting":fd(w,2)?"todo":"general",level:fd(w,512)?512:fd(w,256)?256:fd(w,128)?128:64})}function fd(w,D){return(w&D)===D}function ps(w,D){return((D&32)===32?!0:(D&16)===16?w.dev:(D&8)===8?w.internal:!1)&&w.min<=D}var pd={loggingConsoleStyle:!0,loggerConsoleStyle:!0,includes:Object.freeze({internal:!1,dev:!1,min:256}),filtered:function(){},include:function(){return{}},create:null,creatExt:null,named(w,D,W){return this.create({names:[...w.names,{name:D,key:W}]})},style:{bold:void 0,italic:void 0,cssMemo:new Map([["",""]]),collapseOnRE:/[a-z- ]+/g,color:void 0,collapsed(w){if(w.length<5)return w;const D=w.replace(this.collapseOnRE,"");return this.cssMemo.has(D)||this.cssMemo.set(D,this.css(w)),D},css(w){var D,W,re,me;const Ee=this.cssMemo.get(w);if(Ee)return Ee;let Ge="color:".concat((W=(D=this.color)==null?void 0:D.call(this,w))!=null?W:"hsl(".concat((w.charCodeAt(0)+w.charCodeAt(w.length-1))%360,", 100%, 60%)"));return(re=this.bold)!=null&&re.test(w)&&(Ge+=";font-weight:600"),(me=this.italic)!=null&&me.test(w)&&(Ge+=";font-style:italic"),this.cssMemo.set(w,Ge),Ge}}};function Py(w=console,D={}){const W=I(C({},pd),{includes:C({},pd.includes)}),re={styled:b5.bind(W,w),noStyle:eN.bind(W,w)},me=rT.bind(W);function Ee(){return W.loggingConsoleStyle&&W.loggerConsoleStyle?re.styled:re.noStyle}return W.create=Ee(),{configureLogger(Ge){var ft;Ge==="console"?(W.loggerConsoleStyle=pd.loggerConsoleStyle,W.create=Ee()):Ge.type==="console"?(W.loggerConsoleStyle=(ft=Ge.style)!=null?ft:pd.loggerConsoleStyle,W.create=Ee()):Ge.type==="keyed"?(W.creatExt=Tt=>Ge.keyed(Tt.names),W.create=me):Ge.type==="named"&&(W.creatExt=nT.bind(null,Ge.named),W.create=me)},configureLogging(Ge){var ft,Tt,zt,xn,bn;W.includes.dev=(ft=Ge.dev)!=null?ft:pd.includes.dev,W.includes.internal=(Tt=Ge.internal)!=null?Tt:pd.includes.internal,W.includes.min=(zt=Ge.min)!=null?zt:pd.includes.min,W.include=(xn=Ge.include)!=null?xn:pd.include,W.loggingConsoleStyle=(bn=Ge.consoleStyle)!=null?bn:pd.loggingConsoleStyle,W.create=Ee()},getLogger(){return W.create({names:[]})}}}function nT(w,D){const W=[];for(let{name:re,key:me}of D.names)W.push(me==null?re:"".concat(re," (").concat(me,")"));return w(W)}function rT(w){const D=C(C({},this.includes),this.include(w)),W=this.filtered,re=this.named.bind(this,w),me=this.creatExt(w),Ee=ps(D,524),Ge=ps(D,522),ft=ps(D,521),Tt=ps(D,529),zt=ps(D,545),xn=ps(D,265),bn=ps(D,268),Fn=ps(D,273),fr=ps(D,289),rr=ps(D,137),Te=ps(D,145),Ft=ps(D,73),Or=ps(D,81),Oi=Ee?me.error.bind(me,hl._hmm):W.bind(w,524),Aa=Ge?me.error.bind(me,hl._todo):W.bind(w,522),w0=ft?me.error.bind(me,hl._error):W.bind(w,521),Co=Tt?me.error.bind(me,hl.errorDev):W.bind(w,529),Ki=zt?me.error.bind(me,hl.errorPublic):W.bind(w,545),Pa=bn?me.warn.bind(me,hl._kapow):W.bind(w,268),fl=xn?me.warn.bind(me,hl._warn):W.bind(w,265),sc=Fn?me.warn.bind(me,hl.warnDev):W.bind(w,273),Sm=fr?me.warn.bind(me,hl.warnPublic):W.bind(w,273),wm=rr?me.debug.bind(me,hl._debug):W.bind(w,137),Em=Te?me.debug.bind(me,hl.debugDev):W.bind(w,145),Tm=Ft?me.trace.bind(me,hl._trace):W.bind(w,73),Mm=Or?me.trace.bind(me,hl.traceDev):W.bind(w,81),$s={_hmm:Oi,_todo:Aa,_error:w0,errorDev:Co,errorPublic:Ki,_kapow:Pa,_warn:fl,warnDev:sc,warnPublic:Sm,_debug:wm,debugDev:Em,_trace:Tm,traceDev:Mm,lazy:{_hmm:Ee?ls(Oi):Oi,_todo:Ge?ls(Aa):Aa,_error:ft?ls(w0):w0,errorDev:Tt?ls(Co):Co,errorPublic:zt?ls(Ki):Ki,_kapow:bn?ls(Pa):Pa,_warn:xn?ls(fl):fl,warnDev:Fn?ls(sc):sc,warnPublic:fr?ls(Sm):Sm,_debug:rr?ls(wm):wm,debugDev:Te?ls(Em):Em,_trace:Ft?ls(Tm):Tm,traceDev:Or?ls(Mm):Mm},named:re,utilFor:{internal(){return{debug:$s._debug,error:$s._error,warn:$s._warn,trace:$s._trace,named(pl,rs){return $s.named(pl,rs).utilFor.internal()}}},dev(){return{debug:$s.debugDev,error:$s.errorDev,warn:$s.warnDev,trace:$s.traceDev,named(pl,rs){return $s.named(pl,rs).utilFor.dev()}}},public(){return{error:$s.errorPublic,warn:$s.warnPublic,debug(pl,rs){$s._warn('(public "debug" filtered out) '.concat(pl),rs)},trace(pl,rs){$s._warn('(public "trace" filtered out) '.concat(pl),rs)},named(pl,rs){return $s.named(pl,rs).utilFor.public()}}}}};return $s}function b5(w,D){const W=C(C({},this.includes),this.include(D)),re=[];let me="";for(let Tt=0;Tt<D.names.length;Tt++){const{name:zt,key:xn}=D.names[Tt];if(me+=" %c".concat(zt),re.push(this.style.css(zt)),xn!=null){const bn="%c#".concat(xn);me+=bn,re.push(this.style.css(bn))}}const Ee=this.filtered,Ge=this.named.bind(this,D),ft=[me,...re];return np(Ee,D,W,w,ft,JI(ft),Ge)}function JI(w){const D=w.slice(0);for(let W=1;W<D.length;W++)D[W]+=";background-color:#e0005a;padding:2px;color:white";return D}function eN(w,D){const W=C(C({},this.includes),this.include(D));let re="";for(let ft=0;ft<D.names.length;ft++){const{name:Tt,key:zt}=D.names[ft];re+=" ".concat(Tt),zt!=null&&(re+="#".concat(zt))}const me=this.filtered,Ee=this.named.bind(this,D),Ge=[re];return np(me,D,W,w,Ge,Ge,Ee)}function np(w,D,W,re,me,Ee,Ge){const ft=ps(W,524),Tt=ps(W,522),zt=ps(W,521),xn=ps(W,529),bn=ps(W,545),Fn=ps(W,265),fr=ps(W,268),rr=ps(W,273),Te=ps(W,289),Ft=ps(W,137),Or=ps(W,145),Oi=ps(W,73),Aa=ps(W,81),w0=ft?re.error.bind(re,...me):w.bind(D,524),Co=Tt?re.error.bind(re,...me):w.bind(D,522),Ki=zt?re.error.bind(re,...me):w.bind(D,521),Pa=xn?re.error.bind(re,...me):w.bind(D,529),fl=bn?re.error.bind(re,...me):w.bind(D,545),sc=fr?re.warn.bind(re,...Ee):w.bind(D,268),Sm=Fn?re.warn.bind(re,...me):w.bind(D,265),wm=rr?re.warn.bind(re,...me):w.bind(D,273),Em=Te?re.warn.bind(re,...me):w.bind(D,273),Tm=Ft?re.info.bind(re,...me):w.bind(D,137),Mm=Or?re.info.bind(re,...me):w.bind(D,145),$s=Oi?re.debug.bind(re,...me):w.bind(D,73),pl=Aa?re.debug.bind(re,...me):w.bind(D,81),rs={_hmm:w0,_todo:Co,_error:Ki,errorDev:Pa,errorPublic:fl,_kapow:sc,_warn:Sm,warnDev:wm,warnPublic:Em,_debug:Tm,debugDev:Mm,_trace:$s,traceDev:pl,lazy:{_hmm:ft?ls(w0):w0,_todo:Tt?ls(Co):Co,_error:zt?ls(Ki):Ki,errorDev:xn?ls(Pa):Pa,errorPublic:bn?ls(fl):fl,_kapow:fr?ls(sc):sc,_warn:Fn?ls(Sm):Sm,warnDev:rr?ls(wm):wm,warnPublic:Te?ls(Em):Em,_debug:Ft?ls(Tm):Tm,debugDev:Or?ls(Mm):Mm,_trace:Oi?ls($s):$s,traceDev:Aa?ls(pl):pl},named:Ge,utilFor:{internal(){return{debug:rs._debug,error:rs._error,warn:rs._warn,trace:rs._trace,named(_d,xd){return rs.named(_d,xd).utilFor.internal()}}},dev(){return{debug:rs.debugDev,error:rs.errorDev,warn:rs.warnDev,trace:rs.traceDev,named(_d,xd){return rs.named(_d,xd).utilFor.dev()}}},public(){return{error:rs.errorPublic,warn:rs.warnPublic,debug(_d,xd){rs._warn('(public "debug" filtered out) '.concat(_d),xd)},trace(_d,xd){rs._warn('(public "trace" filtered out) '.concat(_d),xd)},named(_d,xd){return rs.named(_d,xd).utilFor.public()}}}}};return rs}var wx=Py(console,{});wx.configureLogging({dev:!0,min:64});var Ry=wx.getLogger().named("Theatre.js (default logger)").utilFor.dev(),Ex=new WeakMap;function tN(w){const D=Ex.get(w);if(D)return D;const W=new Map;return Ex.set(w,W),iT([],w,W),W}function iT(w,D,W){for(const[re,me]of Object.entries(D.props))if(!Ay(me)){const Ee=[...w,re];W.set(JSON.stringify(Ee),W.size),Tx(Ee,me,W)}for(const[re,me]of Object.entries(D.props))if(Ay(me)){const Ee=[...w,re];W.set(JSON.stringify(Ee),W.size),Tx(Ee,me,W)}}function Tx(w,D,W){if(D.type==="compound")iT(w,D,W);else{if(D.type==="enum")throw new Error("Enums aren't supported yet");W.set(JSON.stringify(w),W.size)}}function sT(w){return typeof w=="object"&&w!==null&&Object.keys(w).length===0}var nN=class{constructor(w,D,W,re,me){this.sheetTemplate=w,k(this,"address"),k(this,"type","Theatre_SheetObjectTemplate"),k(this,"_config"),k(this,"_temp_actions_atom"),k(this,"_cache",new Z0),k(this,"project"),k(this,"pointerToSheetState"),k(this,"pointerToStaticOverrides"),this.address=I(C({},w.address),{objectKey:D}),this._config=new Gs.Atom(re),this._temp_actions_atom=new Gs.Atom(me),this.project=w.project,this.pointerToSheetState=this.sheetTemplate.project.pointers.historic.sheetsById[this.address.sheetId],this.pointerToStaticOverrides=this.pointerToSheetState.staticOverrides.byObject[this.address.objectKey]}get staticConfig(){return this._config.get()}get configPointer(){return this._config.pointer}get _temp_actions(){return this._temp_actions_atom.get()}get _temp_actionsPointer(){return this._temp_actions_atom.pointer}createInstance(w,D,W){return this._config.set(W),new tT(w,this,D)}reconfigure(w){this._config.set(w)}_temp_setActions(w){this._temp_actions_atom.set(w)}getDefaultValues(){return this._cache.get("getDefaultValues()",()=>(0,Gs.prism)(()=>{const w=(0,Gs.val)(this.configPointer);return s4(w)}))}getStaticValues(){return this._cache.get("getStaticValues",()=>(0,Gs.prism)(()=>{var w;const D=(w=(0,Gs.val)(this.pointerToStaticOverrides))!=null?w:{};return(0,Gs.val)(this.configPointer).deserializeAndSanitize(D)||{}}))}getArrayOfValidSequenceTracks(){return this._cache.get("getArrayOfValidSequenceTracks",()=>(0,Gs.prism)(()=>{const w=this.project.pointers.historic.sheetsById[this.address.sheetId],D=(0,Gs.val)(w.sequence.tracksByObject[this.address.objectKey].trackIdByPropPath);if(!D)return Ae;const W=[];if(!D)return Ae;const re=(0,Gs.val)(this.configPointer),me=Object.entries(D);for(const[Ge,ft]of me){const Tt=oT(Ge);if(!Tt)continue;const zt=Sx(re,Tt);zt&&eT(zt)&&W.push({pathToProp:Tt,trackId:ft})}const Ee=tN(re);return W.sort((Ge,ft)=>{const Tt=Ge.pathToProp,zt=ft.pathToProp,xn=Ee.get(JSON.stringify(Tt)),bn=Ee.get(JSON.stringify(zt));return xn>bn?1:-1}),W.length===0?Ae:W}))}getMapOfValidSequenceTracks_forStudio(){return this._cache.get("getMapOfValidSequenceTracks_forStudio",()=>(0,Gs.prism)(()=>{const w=(0,Gs.val)(this.getArrayOfValidSequenceTracks());let D={};for(const{pathToProp:W,trackId:re}of w)jh(D,W,re);return D}))}getStaticButNotSequencedOverrides(){return this._cache.get("getStaticButNotSequencedOverrides",()=>(0,Gs.prism)(()=>{const w=(0,Gs.val)(this.getStaticValues()),D=(0,Gs.val)(this.getArrayOfValidSequenceTracks()),W=la(w);for(const{pathToProp:re}of D){bx(W,re);let me=re.slice(0,-1);for(;me.length>0;){const Ee=Rc(W,me);if(!sT(Ee))break;bx(W,me),me=me.slice(0,-1)}}if(!sT(W))return W}))}getDefaultsAtPointer(w){const{path:D}=(0,Gs.getPointerParts)(w),W=this.getDefaultValues().getValue();return Rc(W,D)}};function oT(w){try{return JSON.parse(w)}catch{Ry.warn("property ".concat(JSON.stringify(w)," cannot be parsed. Skipping."));return}}var aT=mn(),rN=JE(w=>JSON.stringify(w));$(ce());var lT=class extends Error{},S5=class extends lT{},cT=mn(),uT=mn(),iN=mn(),Xo=mn();function md(){let w,D;const W=new Promise((me,Ee)=>{w=Ge=>{me(Ge),re.status="resolved"},D=Ge=>{Ee(Ge),re.status="rejected"}}),re={resolve:w,reject:D,promise:W,status:"pending"};return re}var sN=()=>{},ky=sN,hT=mn(),Mx=class{constructor(){k(this,"_stopPlayCallback",ky),k(this,"_state",new hT.Atom({position:0,playing:!1})),k(this,"statePointer"),this.statePointer=this._state.pointer}destroy(){}pause(){this._stopPlayCallback(),this.playing=!1,this._stopPlayCallback=ky}gotoPosition(w){this._updatePositionInState(w)}_updatePositionInState(w){this._state.setByPointer(D=>D.position,w)}getCurrentPosition(){return this._state.get().position}get playing(){return this._state.get().playing}set playing(w){this._state.setByPointer(D=>D.playing,w)}play(w,D,W,re,me){this.playing&&this.pause(),this.playing=!0;const Ee=D[1]-D[0];{const Fn=this.getCurrentPosition();Fn<D[0]||Fn>D[1]?re==="normal"||re==="alternate"?this._updatePositionInState(D[0]):(re==="reverse"||re==="alternateReverse")&&this._updatePositionInState(D[1]):re==="normal"||re==="alternate"?Fn===D[1]&&this._updatePositionInState(D[0]):Fn===D[0]&&this._updatePositionInState(D[1])}const Ge=md(),ft=me.time,Tt=Ee*w;let zt=this.getCurrentPosition()-D[0];(re==="reverse"||re==="alternateReverse")&&(zt=D[1]-this.getCurrentPosition());const xn=Fn=>{const rr=Math.max(Fn-ft,0)/1e3,Te=Math.min(rr*W+zt,Tt);if(Te!==Tt){const Ft=Math.floor(Te/Ee);let Or=Te/Ee%1*Ee;if(re!=="normal")if(re==="reverse")Or=Ee-Or;else{const Oi=Ft%2===0;re==="alternate"?Oi||(Or=Ee-Or):Oi&&(Or=Ee-Or)}this._updatePositionInState(Or+D[0]),bn()}else{if(re==="normal")this._updatePositionInState(D[1]);else if(re==="reverse")this._updatePositionInState(D[0]);else{const Ft=(w-1)%2===0;re==="alternate"?Ft?this._updatePositionInState(D[1]):this._updatePositionInState(D[0]):Ft?this._updatePositionInState(D[0]):this._updatePositionInState(D[1])}this.playing=!1,Ge.resolve(!0)}};this._stopPlayCallback=()=>{me.offThisOrNextTick(xn),me.offNextTick(xn),this.playing&&Ge.resolve(!1)};const bn=()=>me.onNextTick(xn);return me.onThisOrNextTick(xn),Ge.promise}playDynamicRange(w,D){this.playing&&this.pause(),this.playing=!0;const W=md(),re=w.keepHot();W.promise.then(re,re);let me=D.time;const Ee=ft=>{const Tt=Math.max(ft-me,0);me=ft;const zt=Tt/1e3,xn=this.getCurrentPosition(),bn=w.getValue();if(xn<bn[0]||xn>bn[1])this.gotoPosition(bn[0]);else{let Fn=xn+zt;Fn>bn[1]&&(Fn=bn[0]+(Fn-bn[1])),this.gotoPosition(Fn)}Ge()};this._stopPlayCallback=()=>{D.offThisOrNextTick(Ee),D.offNextTick(Ee),W.resolve(!1)};const Ge=()=>D.onNextTick(Ee);return D.onThisOrNextTick(Ee),W.promise}},dT=mn(),oN="__TheatreJS_StudioBundle",Cx="__TheatreJS_CoreBundle",fT="__TheatreJS_Notifications",Iy=w=>(...D)=>{var W;switch(w){case"success":{Ry.debug(D.slice(0,2).join(`
`));break}case"info":{Ry.debug(D.slice(0,2).join(`
`));break}case"warning":{Ry.warn(D.slice(0,2).join(`
`));break}}return typeof window<"u"?(W=window[fT])==null?void 0:W.notify[w](...D):void 0},fm={warning:Iy("warning"),success:Iy("success"),info:Iy("info"),error:Iy("error")};typeof window<"u"&&(window.addEventListener("error",w=>{fm.error("An error occurred","<pre>".concat(w.message,`</pre>

See **console** for details.`))}),window.addEventListener("unhandledrejection",w=>{fm.error("An error occurred","<pre>".concat(w.reason,`</pre>

See **console** for details.`))}));var pT=class{constructor(w,D,W){this._decodedBuffer=w,this._audioContext=D,this._nodeDestination=W,k(this,"_mainGain"),k(this,"_state",new dT.Atom({position:0,playing:!1})),k(this,"statePointer"),k(this,"_stopPlayCallback",ky),this.statePointer=this._state.pointer,this._mainGain=this._audioContext.createGain(),this._mainGain.connect(this._nodeDestination)}playDynamicRange(w,D){const W=md();this._playing&&this.pause(),this._playing=!0;let re;const me=()=>{re==null||re(),re=this._loopInRange(w.getValue(),D).stop},Ee=w.onStale(me);return me(),this._stopPlayCallback=()=>{re==null||re(),Ee(),W.resolve(!1)},W.promise}_loopInRange(w,D){let re=this.getCurrentPosition();const me=w[1]-w[0];re<w[0]||re>w[1]?this._updatePositionInState(w[0]):re===w[1]&&this._updatePositionInState(w[0]),re=this.getCurrentPosition();const Ee=this._audioContext.createBufferSource();Ee.buffer=this._decodedBuffer,Ee.connect(this._mainGain),Ee.playbackRate.value=1,Ee.loop=!0,Ee.loopStart=w[0],Ee.loopEnd=w[1];const Ge=D.time;let ft=re-w[0];Ee.start(0,re);const Tt=bn=>{let Te=(Math.max(bn-Ge,0)/1e3*1+ft)/me%1*me;this._updatePositionInState(Te+w[0]),zt()},zt=()=>D.onNextTick(Tt);return D.onThisOrNextTick(Tt),{stop:()=>{Ee.stop(),Ee.disconnect(),D.offThisOrNextTick(Tt),D.offNextTick(Tt)}}}get _playing(){return this._state.get().playing}set _playing(w){this._state.setByPointer(D=>D.playing,w)}destroy(){}pause(){this._stopPlayCallback(),this._playing=!1,this._stopPlayCallback=ky}gotoPosition(w){this._updatePositionInState(w)}_updatePositionInState(w){this._state.reduce(D=>I(C({},D),{position:w}))}getCurrentPosition(){return this._state.get().position}play(w,D,W,re,me){this._playing&&this.pause(),this._playing=!0;let Ee=this.getCurrentPosition();const Ge=D[1]-D[0];if(re!=="normal")throw new S5('Audio-controlled sequences can only be played in the "normal" direction. '+"'".concat(re,"' given."));Ee<D[0]||Ee>D[1]?this._updatePositionInState(D[0]):Ee===D[1]&&this._updatePositionInState(D[0]),Ee=this.getCurrentPosition();const ft=md(),Tt=this._audioContext.createBufferSource();Tt.buffer=this._decodedBuffer,Tt.connect(this._mainGain),Tt.playbackRate.value=W,w>1e3&&(fm.warning("Can't play sequences with audio more than 1000 times","The sequence will still play, but only 1000 times. The `iterationCount: ".concat(w,"` provided to `sequence.play()`\nis too high for a sequence with audio.\n\nTo fix this, either set `iterationCount` to a lower value, or remove the audio from the sequence."),[{url:"https://www.theatrejs.com/docs/latest/manual/audio",title:"Using Audio"},{url:"https://www.theatrejs.com/docs/latest/api/core#sequence.attachaudio",title:"Audio API"}]),w=1e3),w>1&&(Tt.loop=!0,Tt.loopStart=D[0],Tt.loopEnd=D[1]);const zt=me.time;let xn=Ee-D[0];const bn=Ge*w;Tt.start(0,Ee,bn-xn);const Fn=Te=>{const Or=Math.max(Te-zt,0)/1e3,Oi=Math.min(Or*W+xn,bn);if(Oi!==bn){let Aa=Oi/Ge%1*Ge;this._updatePositionInState(Aa+D[0]),rr()}else this._updatePositionInState(D[1]),this._playing=!1,fr(),ft.resolve(!0)},fr=()=>{Tt.stop(),Tt.disconnect()};this._stopPlayCallback=()=>{fr(),me.offThisOrNextTick(Fn),me.offNextTick(Fn),this._playing&&ft.resolve(!1)};const rr=()=>me.onNextTick(Fn);return me.onThisOrNextTick(Fn),ft.promise}},aN=mn(),Ax=0;function Ny(w){var D;const W=Ge=>{re.tick(Ge)},re=new aN.Ticker({onActive(){var Ge;(Ge=w==null?void 0:w.start)==null||Ge.call(w)},onDormant(){var Ge;(Ge=w==null?void 0:w.stop)==null||Ge.call(w)}}),me={tick:W,id:Ax++,name:(D=w==null?void 0:w.name)!=null?D:"CustomRafDriver-".concat(Ax),type:"Theatre_RafDriver_PublicAPI"},Ee={type:"Theatre_RafDriver_PrivateAPI",publicApi:me,ticker:re,start:w==null?void 0:w.start,stop:w==null?void 0:w.stop};return gt(me,Ee),me}function lN(){let w=null;const re=Ny({name:"DefaultCoreRafDriver",start:()=>{if(typeof window<"u"){const me=Ee=>{re.tick(Ee),w=window.requestAnimationFrame(me)};w=window.requestAnimationFrame(me)}else re.tick(0),setTimeout(()=>re.tick(1),0)},stop:()=>{typeof window<"u"&&w!==null&&window.cancelAnimationFrame(w)}});return re}var Dy;function pm(){return Dy||mT(lN()),Dy}function Oy(){return pm().ticker}function mT(w){if(Dy)throw new Error("`setCoreRafDriver()` is already called.");Dy=Se(w)}var gT=class{get type(){return"Theatre_Sequence_PublicAPI"}constructor(w){gt(this,w)}play(w){const D=Se(this);if(D._project.isReady()){const W=w!=null&&w.rafDriver?Se(w.rafDriver).ticker:Oy();return D.play(w??{},W)}else{const W=md();return W.resolve(!0),W.promise}}pause(){Se(this).pause()}get position(){return Se(this).position}set position(w){Se(this).position=w}__experimental_getKeyframes(w){return Se(this).getKeyframesOfSimpleProp(w)}async attachAudio(w){const{audioContext:D,destinationNode:W,decodedBuffer:re,gainNode:me}=await cN(w),Ee=new pT(re,D,me);return Se(this).replacePlaybackController(Ee),{audioContext:D,destinationNode:W,decodedBuffer:re,gainNode:me}}get pointer(){return Se(this).pointer}};async function cN(w){function D(){if(w.audioContext)return Promise.resolve(w.audioContext);const zt=new AudioContext;return zt.state==="running"||typeof window>"u"?Promise.resolve(zt):new Promise(xn=>{const bn=()=>{zt.resume().catch(rr=>{console.error(rr)})},Fn=["mousedown","keydown","touchstart"],fr={capture:!0,passive:!1};Fn.forEach(rr=>{window.addEventListener(rr,bn,fr)}),zt.addEventListener("statechange",()=>{zt.state==="running"&&(Fn.forEach(rr=>{window.removeEventListener(rr,bn,fr)}),xn(zt))})})}async function W(){if(w.source instanceof AudioBuffer)return w.source;const zt=md();if(typeof w.source!="string")throw new Error("Error validating arguments to sequence.attachAudio(). args.source must either be a string or an instance of AudioBuffer.");let xn;try{xn=await fetch(w.source)}catch(rr){throw console.error(rr),new Error("Could not fetch '".concat(w.source,"'. Network error logged above."))}let bn;try{bn=await xn.arrayBuffer()}catch(rr){throw console.error(rr),new Error("Could not read '".concat(w.source,"' as an arrayBuffer."))}(await re).decodeAudioData(bn,zt.resolve,zt.reject);let fr;try{fr=await zt.promise}catch(rr){throw console.error(rr),new Error("Could not decode ".concat(w.source," as an audio file."))}return fr}const re=D(),me=W(),[Ee,Ge]=await Promise.all([re,me]),ft=w.destinationNode||Ee.destination,Tt=Ee.createGain();return Tt.connect(ft),{audioContext:Ee,decodedBuffer:Ge,gainNode:Tt,destinationNode:ft}}var yT=vT("Theatre_SheetObject");function vT(w){return D=>typeof D=="object"&&!!D&&D.type===w}var _T=class{constructor(w,D,W,re,me){this._project=w,this._sheet=D,this._lengthD=W,this._subUnitsPerUnitD=re,k(this,"address"),k(this,"publicApi"),k(this,"_playbackControllerBox"),k(this,"_prismOfStatePointer"),k(this,"_positionD"),k(this,"_positionFormatterD"),k(this,"_playableRangeD"),k(this,"pointer",(0,iN.pointer)({root:this,path:[]})),k(this,"$$isPointerToPrismProvider",!0),k(this,"_logger"),k(this,"closestGridPosition",Ee=>{const ft=1/this.subUnitsPerUnit;return parseFloat((Math.round(Ee/ft)*ft).toFixed(3))}),this._logger=w._logger.named("Sheet",D.address.sheetId).named("Instance",D.address.sheetInstanceId),this.address=I(C({},this._sheet.address),{sequenceName:"default"}),this.publicApi=new gT(this),this._playbackControllerBox=new uT.Atom(me??new Mx),this._prismOfStatePointer=(0,Xo.prism)(()=>this._playbackControllerBox.prism.getValue().statePointer),this._positionD=(0,Xo.prism)(()=>{const Ee=this._prismOfStatePointer.getValue();return(0,Xo.val)(Ee.position)}),this._positionFormatterD=(0,Xo.prism)(()=>{const Ee=(0,Xo.val)(this._subUnitsPerUnitD);return new uN(Ee)})}get type(){return"Theatre_Sequence"}pointerToPrism(w){const{path:D}=(0,cT.getPointerParts)(w);if(D.length===0)return(0,Xo.prism)(()=>({length:(0,Xo.val)(this.pointer.length),playing:(0,Xo.val)(this.pointer.playing),position:(0,Xo.val)(this.pointer.position),subUnitsPerUnit:(0,Xo.val)(this.pointer.subUnitsPerUnit)}));if(D.length>1)return(0,Xo.prism)(()=>{});const[W]=D;return W==="length"?this._lengthD:W==="subUnitsPerUnit"?this._subUnitsPerUnitD:W==="position"?this._positionD:W==="playing"?(0,Xo.prism)(()=>(0,Xo.val)(this._prismOfStatePointer.getValue().playing)):(0,Xo.prism)(()=>{})}getKeyframesOfSimpleProp(w){const{path:D,root:W}=(0,cT.getPointerParts)(w);if(!yT(W))throw new S5("Argument prop must be a pointer to a SheetObject property");const re=(0,Xo.val)(this._project.pointers.historic.sheetsById[this._sheet.address.sheetId].sequence.tracksByObject[W.address.objectKey]);if(!re)return[];const{trackData:me,trackIdByPropPath:Ee}=re,Ge=rN(D),ft=Ee[Ge];if(!ft)return[];const Tt=me[ft];return Tt?Tt.keyframes:[]}get positionFormatter(){return this._positionFormatterD.getValue()}get prismOfStatePointer(){return this._prismOfStatePointer}get length(){return this._lengthD.getValue()}get positionPrism(){return this._positionD}get position(){return this._playbackControllerBox.get().getCurrentPosition()}get subUnitsPerUnit(){return this._subUnitsPerUnitD.getValue()}get positionSnappedToGrid(){return this.closestGridPosition(this.position)}set position(w){let D=w;this.pause(),D>this.length&&(D=this.length);const W=this.length;this._playbackControllerBox.get().gotoPosition(D>W?W:D)}getDurationCold(){return this._lengthD.getValue()}get playing(){return(0,Xo.val)(this._playbackControllerBox.get().statePointer.playing)}_makeRangeFromSequenceTemplate(){return(0,Xo.prism)(()=>[0,(0,Xo.val)(this._lengthD)])}playDynamicRange(w,D){return this._playbackControllerBox.get().playDynamicRange(w,D)}async play(w,D){const W=this.length,re=w&&w.range?w.range:[0,W],me=w&&typeof w.iterationCount=="number"?w.iterationCount:1,Ee=w&&typeof w.rate<"u"?w.rate:1,Ge=w&&w.direction?w.direction:"normal";return await this._play(me,[re[0],re[1]],Ee,Ge,D)}_play(w,D,W,re,me){return this._playbackControllerBox.get().play(w,D,W,re,me)}pause(){this._playbackControllerBox.get().pause()}replacePlaybackController(w){this.pause();const D=this._playbackControllerBox.get();this._playbackControllerBox.set(w);const W=D.getCurrentPosition();D.destroy(),w.gotoPosition(W)}},uN=class{constructor(w){this._fps=w}formatSubUnitForGrid(w){const D=w%1,W=1/this._fps;return Math.round(D/W)+"f"}formatFullUnitForGrid(w){let D=w,W="";if(D>=gm){const me=Math.floor(D/gm);W+=me+"h",D=D%gm}if(D>=rp){const me=Math.floor(D/rp);W+=me+"m",D=D%rp}if(D>=mm){const me=Math.floor(D/mm);W+=me+"s",D=D%mm}const re=1/this._fps;if(D>=re){const me=Math.floor(D/re);W+=me+"f",D=D%re}return W.length===0?"0s":W}formatForPlayhead(w){let D=w,W="";if(D>=gm){const me=Math.floor(D/gm);W+=v9(me.toString(),2,"0")+"h",D=D%gm}if(D>=rp){const me=Math.floor(D/rp);W+=v9(me.toString(),2,"0")+"m",D=D%rp}else W.length>0&&(W+="00m");if(D>=mm){const me=Math.floor(D/mm);W+=v9(me.toString(),2,"0")+"s",D=D%mm}else W+="00s";const re=1/this._fps;if(D>=re){const me=Math.round(D/re);W+=v9(me.toString(),2,"0")+"f",D=D%re}else D/re>.98?(W+=v9("1",2,"0")+"f",D=D%re):W+="00f";return W.length===0?"00s00f":W}formatBasic(w){return w.toFixed(2)+"s"}},mm=1,rp=mm*60,gm=rp*60,Px={};U(Px,{boolean:()=>Ix,compound:()=>w5,file:()=>Fy,image:()=>sp,number:()=>op,rgba:()=>_9,string:()=>AT,stringLiteral:()=>PT});function xT(w,D){return w.length<=D?w:w.substr(0,D-3)+"..."}var ip=w=>typeof w=="string"?'string("'.concat(xT(w,10),'")'):typeof w=="number"?"number(".concat(xT(String(w),10),")"):w===null?"null":w===void 0?"undefined":typeof w=="boolean"?String(w):Array.isArray(w)?"array":typeof w=="object"?"object":"unknown",bT=ip;function Fo(w,{removeAlphaIfOpaque:D=!1}={}){const W=(w.a*255|256).toString(16).slice(1),re=(w.r*255|256).toString(16).slice(1)+(w.g*255|256).toString(16).slice(1)+(w.b*255|256).toString(16).slice(1)+(D&&W==="ff"?"":W);return"#".concat(re)}function Rx(w){return I(C({},w),{toString(){return Fo(this,{removeAlphaIfOpaque:!0})}})}function hN(w){return Object.fromEntries(Object.entries(w).map(([D,W])=>[D,qu(W,0,1)]))}function qe(w){function D(W){return W>=.0031308?1.055*W**(1/2.4)-.055:12.92*W}return hN({r:D(w.r),g:D(w.g),b:D(w.b),a:w.a})}function ST(w){function D(W){return W>=.04045?((W+.055)/(1+.055))**2.4:W/12.92}return{r:D(w.r),g:D(w.g),b:D(w.b),a:w.a}}function wT(w){let D=.4122214708*w.r+.5363325363*w.g+.0514459929*w.b,W=.2119034982*w.r+.6806995451*w.g+.1073969566*w.b,re=.0883024619*w.r+.2817188376*w.g+.6299787005*w.b,me=Math.cbrt(D),Ee=Math.cbrt(W),Ge=Math.cbrt(re);return{L:.2104542553*me+.793617785*Ee-.0040720468*Ge,a:1.9779984951*me-2.428592205*Ee+.4505937099*Ge,b:.0259040371*me+.7827717662*Ee-.808675766*Ge,alpha:w.a}}function dN(w){let D=w.L+.3963377774*w.a+.2158037573*w.b,W=w.L-.1055613458*w.a-.0638541728*w.b,re=w.L-.0894841775*w.a-1.291485548*w.b,me=D*D*D,Ee=W*W*W,Ge=re*re*re;return{r:4.0767416621*me-3.3077115913*Ee+.2309699292*Ge,g:-1.2684380046*me+2.6097574011*Ee-.3413193965*Ge,b:-.0041960863*me-.7034186147*Ee+1.707614701*Ge,a:w.alpha}}var ua=Symbol("TheatrePropType_Basic");function ET(w){return typeof w=="object"&&!!w&&w[ua]==="TheatrePropType"}function jr(w){if(typeof w=="number")return op(w);if(typeof w=="boolean")return Ix(w);if(typeof w=="string")return AT(w);if(typeof w=="object"&&w){if(ET(w))return w;if(ds(w))return w5(w);throw new S5("This value is not a valid prop type: ".concat(bT(w)))}else throw new S5("This value is not a valid prop type: ".concat(bT(w)))}function fN(w){const D={};for(const W of Object.keys(w)){const re=w[W];ET(re)?D[W]=re:D[W]=jr(re)}return D}var w5=(w,D={})=>{const W=fN(w),re=new WeakMap;return{type:"compound",props:W,valueType:null,[ua]:"TheatrePropType",label:D.label,default:Tr(W,Ee=>Ee.default),deserializeAndSanitize:Ee=>{if(typeof Ee!="object"||!Ee)return;if(re.has(Ee))return re.get(Ee);const Ge={};let ft=!1;for(const[Tt,zt]of Object.entries(W))if(Object.prototype.hasOwnProperty.call(Ee,Tt)){const xn=zt.deserializeAndSanitize(Ee[Tt]);xn!=null&&(ft=!0,Ge[Tt]=xn)}if(re.set(Ee,Ge),ft)return Ge}}},Fy=(w,D={})=>{const W=(re,me,Ee)=>{var Ge;return{type:"file",id:((Ge=D.interpolate)!=null?Ge:er)(re.id,me.id,Ee)}};return{type:"file",default:{type:"file",id:w},valueType:null,[ua]:"TheatrePropType",label:D.label,interpolate:W,deserializeAndSanitize:TT}},TT=w=>{if(!w)return;let D=!0;if(typeof w.id!="string"&&![null,void 0].includes(w.id)&&(D=!1),w.type!=="file"&&(D=!1),!!D)return w},sp=(w,D={})=>{const W=(re,me,Ee)=>{var Ge;return{type:"image",id:((Ge=D.interpolate)!=null?Ge:er)(re.id,me.id,Ee)}};return{type:"image",default:{type:"image",id:w},valueType:null,[ua]:"TheatrePropType",label:D.label,interpolate:W,deserializeAndSanitize:MT}},MT=w=>{if(!w)return;let D=!0;if(typeof w.id!="string"&&![null,void 0].includes(w.id)&&(D=!1),w.type!=="image"&&(D=!1),!!D)return w},op=(w,D={})=>{var W;return I(C({type:"number",valueType:0,default:w,[ua]:"TheatrePropType"},D||{}),{label:D.label,nudgeFn:(W=D.nudgeFn)!=null?W:mN,nudgeMultiplier:typeof D.nudgeMultiplier=="number"?D.nudgeMultiplier:void 0,interpolate:Zc,deserializeAndSanitize:Xr(D.range)})},Xr=w=>w?D=>{if(typeof D=="number"&&isFinite(D))return qu(D,w[0],w[1])}:kx,kx=w=>typeof w=="number"&&isFinite(w)?w:void 0,Zc=(w,D,W)=>w+W*(D-w),_9=(w={r:0,g:0,b:0,a:1},D={})=>{const W={};for(const re of["r","g","b","a"])W[re]=Math.min(Math.max(w[re],0),1);return{type:"rgba",valueType:null,default:Rx(W),[ua]:"TheatrePropType",label:D.label,interpolate:CT,deserializeAndSanitize:Ly}},Ly=w=>{if(!w)return;let D=!0;for(const re of["r","g","b","a"])(!Object.prototype.hasOwnProperty.call(w,re)||typeof w[re]!="number")&&(D=!1);if(!D)return;const W={};for(const re of["r","g","b","a"])W[re]=Math.min(Math.max(w[re],0),1);return Rx(W)},CT=(w,D,W)=>{const re=wT(ST(w)),me=wT(ST(D)),Ee={L:(1-W)*re.L+W*me.L,a:(1-W)*re.a+W*me.a,b:(1-W)*re.b+W*me.b,alpha:(1-W)*re.alpha+W*me.alpha},Ge=qe(dN(Ee));return Rx(Ge)},Ix=(w,D={})=>{var W;return{type:"boolean",default:w,valueType:null,[ua]:"TheatrePropType",label:D.label,interpolate:(W=D.interpolate)!=null?W:er,deserializeAndSanitize:Nx}},Nx=w=>typeof w=="boolean"?w:void 0;function er(w){return w}var AT=(w,D={})=>{var W;return{type:"string",default:w,valueType:null,[ua]:"TheatrePropType",label:D.label,interpolate:(W=D.interpolate)!=null?W:er,deserializeAndSanitize:pN}};function pN(w){return typeof w=="string"?w:void 0}function PT(w,D,W={}){var re,me;return{type:"stringLiteral",default:w,valuesAndLabels:C({},D),[ua]:"TheatrePropType",valueType:null,as:(re=W.as)!=null?re:"menu",label:W.label,interpolate:(me=W.interpolate)!=null?me:er,deserializeAndSanitize(Ee){if(typeof Ee=="string"&&Object.prototype.hasOwnProperty.call(D,Ee))return Ee}}}var mN=({config:w,deltaX:D,deltaFraction:W,magnitude:re})=>{var me;const{range:Ee}=w;return!w.nudgeMultiplier&&Ee&&!Ee.includes(1/0)&&!Ee.includes(-1/0)?W*(Ee[1]-Ee[0])*re:D*re*((me=w.nudgeMultiplier)!=null?me:1)},RT=w=>w.replace(/^[\s\/]*/,"").replace(/[\s\/]*$/,"").replace(/\s*\/\s*/g," / ");function By(w,D){return RT(w)}$(Q());var kT=class{get type(){return"Theatre_Sheet_PublicAPI"}constructor(w){gt(this,w)}object(w,D,W){const re=Se(this),me=By(w),Ee=re.getObject(me),Ge=null,ft=W==null?void 0:W.__actions__THIS_API_IS_UNSTABLE_AND_WILL_CHANGE_IN_THE_NEXT_VERSION;if(Ee)return ft&&Ee.template._temp_setActions(ft),Ee.publicApi;{const Tt=w5(D);return re.createObject(me,Ge,Tt,ft).publicApi}}__experimental_getExistingObject(w){const D=Se(this),W=By(w),re=D.getObject(W);return re==null?void 0:re.publicApi}get sequence(){return Se(this).getSequence().publicApi}get project(){return Se(this).project.publicApi}get address(){return C({},Se(this).address)}detachObject(w){const D=Se(this),W=By(w);if(!D.getObject(W)){fm.warning(`Couldn't delete object "`.concat(W,'"'),'There is no object with key "'.concat(W,`".

To fix this, make sure you are calling \`sheet.deleteObject("`).concat(W,'")` with the correct key.')),console.warn('Object key "'.concat(W,'" does not exist.'));return}D.deleteObject(W)}},x9=mn(),gN=class{constructor(w,D){this.template=w,this.instanceId=D,k(this,"_objects",new x9.Atom({})),k(this,"_sequence"),k(this,"address"),k(this,"publicApi"),k(this,"project"),k(this,"objectsP",this._objects.pointer),k(this,"type","Theatre_Sheet"),k(this,"_logger"),this._logger=w.project._logger.named("Sheet",D),this._logger._trace("creating sheet"),this.project=w.project,this.address=I(C({},w.address),{sheetInstanceId:this.instanceId}),this.publicApi=new kT(this)}createObject(w,D,W,re={}){const Ee=this.template.getObjectTemplate(w,D,W,re).createInstance(this,D,W);return this._objects.setByPointer(Ge=>Ge[w],Ee),Ee}getObject(w){return this._objects.get()[w]}deleteObject(w){this._objects.reduce(D=>{const W=C({},D);return delete W[w],W})}getSequence(){if(!this._sequence){const w=(0,x9.prism)(()=>{const W=(0,x9.val)(this.project.pointers.historic.sheetsById[this.address.sheetId].sequence.length);return yN(W)}),D=(0,x9.prism)(()=>{const W=(0,x9.val)(this.project.pointers.historic.sheetsById[this.address.sheetId].sequence.subUnitsPerUnit);return IT(W)});this._sequence=new _T(this.template.project,this,w,D)}return this._sequence}},yN=w=>typeof w=="number"&&isFinite(w)&&w>0?w:10,IT=w=>typeof w=="number"&&cr(w)&&w>=1&&w<=1e3?w:30,vN=class{constructor(w,D){this.project=w,k(this,"type","Theatre_SheetTemplate"),k(this,"address"),k(this,"_instances",new aT.Atom({})),k(this,"instancesP",this._instances.pointer),k(this,"_objectTemplates",new aT.Atom({})),k(this,"objectTemplatesP",this._objectTemplates.pointer),this.address=I(C({},w.address),{sheetId:D})}getInstance(w){let D=this._instances.get()[w];return D||(D=new gN(this,w),this._instances.setByPointer(W=>W[w],D)),D}getObjectTemplate(w,D,W,re){let me=this._objectTemplates.get()[w];return me||(me=new nN(this,w,D,W,re),this._objectTemplates.setByPointer(Ee=>Ee[w],me)),me}},Uy=mn(),Dx=mn(),Ox=w=>new Promise(D=>setTimeout(D,w)),_N=Ox;function ic(w){for(var D=arguments.length,W=Array(D>1?D-1:0),re=1;re<D;re++)W[re-1]=arguments[re];throw Error("[Immer] minified error nr: "+w+(W.length?" "+W.map(function(me){return"'"+me+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function ym(w){return!!w&&!!w[$a]}function vm(w){return!!w&&(function(D){if(!D||typeof D!="object")return!1;var W=Object.getPrototypeOf(D);if(W===null)return!0;var re=Object.hasOwnProperty.call(W,"constructor")&&W.constructor;return re===Object||typeof re=="function"&&Function.toString.call(re)===OT}(w)||Array.isArray(w)||!!w[Hx]||!!w.constructor[Hx]||Vy(w)||T5(w))}function Qc(w){return ym(w)||ic(23,w),w[$a].t}function gd(w,D,W){W===void 0&&(W=!1),_m(w)===0?(W?Object.keys:Wy)(w).forEach(function(re){W&&typeof re=="symbol"||D(re,w[re],w)}):w.forEach(function(re,me){return D(me,re,w)})}function _m(w){var D=w[$a];return D?D.i>3?D.i-4:D.i:Array.isArray(w)?1:Vy(w)?2:T5(w)?3:0}function E5(w,D){return _m(w)===2?w.has(D):Object.prototype.hasOwnProperty.call(w,D)}function yd(w,D){return _m(w)===2?w.get(D):w[D]}function zy(w,D,W){var re=_m(w);re===2?w.set(D,W):re===3?(w.delete(D),w.add(W)):w[D]=W}function NT(w,D){return w===D?w!==0||1/w==1/D:w!=w&&D!=D}function Vy(w){return T9&&w instanceof Map}function T5(w){return P5&&w instanceof Set}function ap(w){return w.o||w.t}function Gy(w){if(Array.isArray(w))return Array.prototype.slice.call(w);var D=$y(w);delete D[$a];for(var W=Wy(D),re=0;re<W.length;re++){var me=W[re],Ee=D[me];Ee.writable===!1&&(Ee.writable=!0,Ee.configurable=!0),(Ee.get||Ee.set)&&(D[me]={configurable:!0,writable:!0,enumerable:Ee.enumerable,value:w[me]})}return Object.create(Object.getPrototypeOf(w),D)}function jy(w,D){return D===void 0&&(D=!1),Wa(w)||ym(w)||!vm(w)||(_m(w)>1&&(w.set=w.add=w.clear=w.delete=xm),Object.freeze(w),D&&gd(w,function(W,re){return jy(re,!0)},!0)),w}function xm(){ic(2)}function Wa(w){return w==null||typeof w!="object"||Object.isFrozen(w)}function Jc(w){var D=Wx[w];return D||ic(18,w),D}function M5(){return vd}function Fx(w,D){D&&(Jc("Patches"),w.u=[],w.s=[],w.v=D)}function C5(w){Hy(w),w.p.forEach(Bx),w.p=null}function Hy(w){w===vd&&(vd=w.l)}function Lx(w){return vd={p:[],l:vd,h:w,m:!0,_:0}}function Bx(w){var D=w[$a];D.i===0||D.i===1?D.j():D.O=!0}function Ws(w,D){D._=D.p.length;var W=D.p[0],re=w!==void 0&&w!==W;return D.h.g||Jc("ES5").S(D,w,re),re?(W[$a].P&&(C5(D),ic(4)),vm(w)&&(w=A5(D,w),D.l||b9(D,w)),D.u&&Jc("Patches").M(W[$a],w,D.u,D.s)):w=A5(D,W,[]),C5(D),D.u&&D.v(D.u,D.s),w!==jx?w:void 0}function A5(w,D,W){if(Wa(D))return D;var re=D[$a];if(!re)return gd(D,function(Ee,Ge){return Ux(w,re,D,Ee,Ge,W)},!0),D;if(re.A!==w)return D;if(!re.P)return b9(w,re.t,!0),re.t;if(!re.I){re.I=!0,re.A._--;var me=re.i===4||re.i===5?re.o=Gy(re.k):re.o;gd(re.i===3?new Set(me):me,function(Ee,Ge){return Ux(w,re,me,Ee,Ge,W)}),b9(w,me,!1),W&&w.u&&Jc("Patches").R(re,W,w.u,w.s)}return re.o}function Ux(w,D,W,re,me,Ee){if(ym(me)){var Ge=A5(w,me,Ee&&D&&D.i!==3&&!E5(D.D,re)?Ee.concat(re):void 0);if(zy(W,re,Ge),!ym(Ge))return;w.m=!1}if(vm(me)&&!Wa(me)){if(!w.h.F&&w._<1)return;A5(w,me),D&&D.A.l||b9(w,me)}}function b9(w,D,W){W===void 0&&(W=!1),w.h.F&&w.m&&jy(D,W)}function S9(w,D){var W=w[$a];return(W?ap(W):w)[D]}function w9(w,D){if(D in w)for(var W=Object.getPrototypeOf(w);W;){var re=Object.getOwnPropertyDescriptor(W,D);if(re)return re;W=Object.getPrototypeOf(W)}}function eu(w){w.P||(w.P=!0,w.l&&eu(w.l))}function tu(w){w.o||(w.o=Gy(w.t))}function E9(w,D,W){var re=Vy(D)?Jc("MapSet").N(D,W):T5(D)?Jc("MapSet").T(D,W):w.g?function(me,Ee){var Ge=Array.isArray(me),ft={i:Ge?1:0,A:Ee?Ee.A:M5(),P:!1,I:!1,D:{},l:Ee,t:me,k:null,o:null,j:null,C:!1},Tt=ft,zt=R5;Ge&&(Tt=[ft],zt=k5);var xn=Proxy.revocable(Tt,zt),bn=xn.revoke,Fn=xn.proxy;return ft.k=Fn,ft.j=bn,Fn}(D,W):Jc("ES5").J(D,W);return(W?W.A:M5()).p.push(re),re}function DT(w){return ym(w)||ic(22,w),function D(W){if(!vm(W))return W;var re,me=W[$a],Ee=_m(W);if(me){if(!me.P&&(me.i<4||!Jc("ES5").K(me)))return me.t;me.I=!0,re=zx(W,Ee),me.I=!1}else re=zx(W,Ee);return gd(re,function(Ge,ft){me&&yd(me.t,Ge)===ft||zy(re,Ge,D(ft))}),Ee===3?new Set(re):re}(w)}function zx(w,D){switch(D){case 2:return new Map(w);case 3:return Array.from(w)}return Gy(w)}var Vx,vd,bm=typeof Symbol<"u"&&typeof Symbol("x")=="symbol",T9=typeof Map<"u",P5=typeof Set<"u",Gx=typeof Proxy<"u"&&Proxy.revocable!==void 0&&typeof Reflect<"u",jx=bm?Symbol.for("immer-nothing"):((Vx={})["immer-nothing"]=!0,Vx),Hx=bm?Symbol.for("immer-draftable"):"__$immer_draftable",$a=bm?Symbol.for("immer-state"):"__$immer_state",OT=""+Object.prototype.constructor,Wy=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols!==void 0?function(w){return Object.getOwnPropertyNames(w).concat(Object.getOwnPropertySymbols(w))}:Object.getOwnPropertyNames,$y=Object.getOwnPropertyDescriptors||function(w){var D={};return Wy(w).forEach(function(W){D[W]=Object.getOwnPropertyDescriptor(w,W)}),D},Wx={},R5={get:function(w,D){if(D===$a)return w;var W=ap(w);if(!E5(W,D))return function(me,Ee,Ge){var ft,Tt=w9(Ee,Ge);return Tt?"value"in Tt?Tt.value:(ft=Tt.get)===null||ft===void 0?void 0:ft.call(me.k):void 0}(w,W,D);var re=W[D];return w.I||!vm(re)?re:re===S9(w.t,D)?(tu(w),w.o[D]=E9(w.A.h,re,w)):re},has:function(w,D){return D in ap(w)},ownKeys:function(w){return Reflect.ownKeys(ap(w))},set:function(w,D,W){var re=w9(ap(w),D);if(re!=null&&re.set)return re.set.call(w.k,W),!0;if(!w.P){var me=S9(ap(w),D),Ee=me==null?void 0:me[$a];if(Ee&&Ee.t===W)return w.o[D]=W,w.D[D]=!1,!0;if(NT(W,me)&&(W!==void 0||E5(w.t,D)))return!0;tu(w),eu(w)}return w.o[D]===W&&typeof W!="number"&&(W!==void 0||D in w.o)||(w.o[D]=W,w.D[D]=!0,!0)},deleteProperty:function(w,D){return S9(w.t,D)!==void 0||D in w.t?(w.D[D]=!1,tu(w),eu(w)):delete w.D[D],w.o&&delete w.o[D],!0},getOwnPropertyDescriptor:function(w,D){var W=ap(w),re=Reflect.getOwnPropertyDescriptor(W,D);return re&&{writable:!0,configurable:w.i!==1||D!=="length",enumerable:re.enumerable,value:W[D]}},defineProperty:function(){ic(11)},getPrototypeOf:function(w){return Object.getPrototypeOf(w.t)},setPrototypeOf:function(){ic(12)}},k5={};gd(R5,function(w,D){k5[w]=function(){return arguments[0]=arguments[0][0],D.apply(this,arguments)}}),k5.deleteProperty=function(w,D){return R5.deleteProperty.call(this,w[0],D)},k5.set=function(w,D,W){return R5.set.call(this,w[0],D,W,w[0])};var FT=function(){function w(W){var re=this;this.g=Gx,this.F=!0,this.produce=function(me,Ee,Ge){if(typeof me=="function"&&typeof Ee!="function"){var ft=Ee;Ee=me;var Tt=re;return function(fr){var rr=this;fr===void 0&&(fr=ft);for(var Te=arguments.length,Ft=Array(Te>1?Te-1:0),Or=1;Or<Te;Or++)Ft[Or-1]=arguments[Or];return Tt.produce(fr,function(Oi){var Aa;return(Aa=Ee).call.apply(Aa,[rr,Oi].concat(Ft))})}}var zt;if(typeof Ee!="function"&&ic(6),Ge!==void 0&&typeof Ge!="function"&&ic(7),vm(me)){var xn=Lx(re),bn=E9(re,me,void 0),Fn=!0;try{zt=Ee(bn),Fn=!1}finally{Fn?C5(xn):Hy(xn)}return typeof Promise<"u"&&zt instanceof Promise?zt.then(function(fr){return Fx(xn,Ge),Ws(fr,xn)},function(fr){throw C5(xn),fr}):(Fx(xn,Ge),Ws(zt,xn))}if(!me||typeof me!="object")return(zt=Ee(me))===jx?void 0:(zt===void 0&&(zt=me),re.F&&jy(zt,!0),zt);ic(21,me)},this.produceWithPatches=function(me,Ee){return typeof me=="function"?function(Tt){for(var zt=arguments.length,xn=Array(zt>1?zt-1:0),bn=1;bn<zt;bn++)xn[bn-1]=arguments[bn];return re.produceWithPatches(Tt,function(Fn){return me.apply(void 0,[Fn].concat(xn))})}:[re.produce(me,Ee,function(Tt,zt){Ge=Tt,ft=zt}),Ge,ft];var Ge,ft},typeof(W==null?void 0:W.useProxies)=="boolean"&&this.setUseProxies(W.useProxies),typeof(W==null?void 0:W.autoFreeze)=="boolean"&&this.setAutoFreeze(W.autoFreeze)}var D=w.prototype;return D.createDraft=function(W){vm(W)||ic(8),ym(W)&&(W=DT(W));var re=Lx(this),me=E9(this,W,void 0);return me[$a].C=!0,Hy(re),me},D.finishDraft=function(W,re){var me=W&&W[$a],Ee=me.A;return Fx(Ee,re),Ws(void 0,Ee)},D.setAutoFreeze=function(W){this.F=W},D.setUseProxies=function(W){W&&!Gx&&ic(20),this.g=W},D.applyPatches=function(W,re){var me;for(me=re.length-1;me>=0;me--){var Ee=re[me];if(Ee.path.length===0&&Ee.op==="replace"){W=Ee.value;break}}var Ge=Jc("Patches").$;return ym(W)?Ge(W,re):this.produce(W,function(ft){return Ge(ft,re.slice(me+1))})},w}(),qa=new FT;qa.produce,qa.produceWithPatches.bind(qa),qa.setAutoFreeze.bind(qa),qa.setUseProxies.bind(qa),qa.applyPatches.bind(qa),qa.createDraft.bind(qa),qa.finishDraft.bind(qa);var LT={currentProjectStateDefinitionVersion:"0.4.0"},lp=LT;async function BT(w,D,W){await _N(0),w.transaction(({drafts:re})=>{var me;const Ee=D.address.projectId;re.ephemeral.coreByProject[Ee]={lastExportedObject:null,loadingState:{type:"loading"}},re.ahistoric.coreByProject[Ee]={ahistoricStuff:""};function Ge(){re.ephemeral.coreByProject[Ee].loadingState={type:"loaded"},re.historic.coreByProject[Ee]={sheetsById:{},definitionVersion:lp.currentProjectStateDefinitionVersion,revisionHistory:[]}}function ft(bn){re.ephemeral.coreByProject[Ee].loadingState={type:"loaded"},re.historic.coreByProject[Ee]=bn}function Tt(){re.ephemeral.coreByProject[Ee].loadingState={type:"loaded"}}function zt(bn){re.ephemeral.coreByProject[Ee].loadingState={type:"browserStateIsNotBasedOnDiskState",onDiskState:bn}}const xn=(me=Qc(re.historic))==null?void 0:me.coreByProject[D.address.projectId];xn?W&&xn.revisionHistory.indexOf(W.revisionHistory[0])==-1?zt(W):Tt():W?ft(W):Ge()})}function qy(){}function cp(w){var D,W;const re=(D=w==null?void 0:w.logging)!=null&&D.internal?(W=w.logging.min)!=null?W:256:1/0,me=re<=128,Ee=re<=512,Ge=Py(void 0,{_debug:me?console.debug.bind(console,"_coreLogger(TheatreInternalLogger) debug"):qy,_error:Ee?console.error.bind(console,"_coreLogger(TheatreInternalLogger) error"):qy});if(w){const{logger:ft,logging:Tt}=w;ft&&Ge.configureLogger(ft),Tt?Ge.configureLogging(Tt):Ge.configureLogging({dev:!1})}return Ge.getLogger().named("Theatre")}var $x=class{constructor(w,D={},W){this.config=D,this.publicApi=W,k(this,"pointers"),k(this,"_pointerProxies"),k(this,"address"),k(this,"_studioReadyDeferred"),k(this,"_assetStorageReadyDeferred"),k(this,"_readyPromise"),k(this,"_sheetTemplates",new Dx.Atom({})),k(this,"sheetTemplatesP",this._sheetTemplates.pointer),k(this,"_studio"),k(this,"assetStorage"),k(this,"type","Theatre_Project"),k(this,"_logger");var re;this._logger=cp({logging:{dev:!0}}).named("Project",w),this._logger.traceDev("creating project"),this.address={projectId:w};const me=new Dx.Atom({ahistoric:{ahistoricStuff:""},historic:(re=D.state)!=null?re:{sheetsById:{},definitionVersion:lp.currentProjectStateDefinitionVersion,revisionHistory:[]},ephemeral:{loadingState:{type:"loaded"},lastExportedObject:null}});this._assetStorageReadyDeferred=md(),this.assetStorage={getAssetUrl:Ee=>{var Ge;return"".concat((Ge=D.assets)==null?void 0:Ge.baseUrl,"/").concat(Ee)},createAsset:()=>{throw new Error("Please wait for Project.ready to use assets.")}},this._pointerProxies={historic:new Uy.PointerProxy(me.pointer.historic),ahistoric:new Uy.PointerProxy(me.pointer.ahistoric),ephemeral:new Uy.PointerProxy(me.pointer.ephemeral)},this.pointers={historic:this._pointerProxies.historic.pointer,ahistoric:this._pointerProxies.ahistoric.pointer,ephemeral:this._pointerProxies.ephemeral.pointer},rt.add(w,this),this._studioReadyDeferred=md(),this._readyPromise=Promise.all([this._studioReadyDeferred.promise,this._assetStorageReadyDeferred.promise]).then(()=>{}),D.state?setTimeout(()=>{this._studio||(this._studioReadyDeferred.resolve(void 0),this._assetStorageReadyDeferred.resolve(void 0),this._logger._trace("ready deferred resolved with no state"))},0):typeof window>"u"?console.error('Argument config.state in Theatre.getProject("'.concat(w,'", config) is empty. ')+"You can safely ignore this message if you're developing a Next.js/Remix project in development mode. But if you are shipping to your end-users, then you need to set config.state, otherwise your project's state will be empty and nothing will animate. Learn more at https://www.theatrejs.com/docs/latest/manual/projects#state"):setTimeout(()=>{if(!this._studio)throw new Error('Argument config.state in Theatre.getProject("'.concat(w,'", config) is empty. This is fine ')+"while you are using @theatre/core along with @theatre/studio. But since @theatre/studio "+'is not loaded, the state of project "'.concat(w,`" will be empty.

`)+`To fix this, you need to add @theatre/studio into the bundle and export the project's state. Learn how to do that at https://www.theatrejs.com/docs/latest/manual/projects#state
`)},1e3)}attachToStudio(w){if(this._studio){if(this._studio!==w)throw new Error("Project ".concat(this.address.projectId," is already attached to studio ").concat(this._studio.address.studioId));console.warn("Project ".concat(this.address.projectId," is already attached to studio ").concat(this._studio.address.studioId));return}this._studio=w,w.initialized.then(async()=>{var D;await BT(w,this,this.config.state),this._pointerProxies.historic.setPointer(w.atomP.historic.coreByProject[this.address.projectId]),this._pointerProxies.ahistoric.setPointer(w.atomP.ahistoric.coreByProject[this.address.projectId]),this._pointerProxies.ephemeral.setPointer(w.atomP.ephemeral.coreByProject[this.address.projectId]),await w.createAssetStorage(this,(D=this.config.assets)==null?void 0:D.baseUrl).then(W=>{this.assetStorage=W,this._assetStorageReadyDeferred.resolve(void 0)}),this._studioReadyDeferred.resolve(void 0)}).catch(D=>{throw console.error(D),D})}get isAttachedToStudio(){return!!this._studio}get ready(){return this._readyPromise}isReady(){return this._studioReadyDeferred.status==="resolved"&&this._assetStorageReadyDeferred.status==="resolved"}getOrCreateSheet(w,D="default"){let W=this._sheetTemplates.get()[w];return W||(W=new vN(this,w),this._sheetTemplates.reduce(re=>I(C({},re),{[w]:W}))),W.getInstance(D)}},UT=class{get type(){return"Theatre_Project_PublicAPI"}constructor(w,D={}){gt(this,new $x(w,D,this))}get ready(){return Se(this).ready}get isReady(){return Se(this).isReady()}get address(){return C({},Se(this).address)}getAssetUrl(w){if(!this.isReady){console.error("Calling `project.getAssetUrl()` before `project.ready` is resolved, will always return `undefined`. Either use `project.ready.then(() => project.getAssetUrl())` or `await project.ready` before calling `project.getAssetUrl()`.");return}return w.id?Se(this).assetStorage.getAssetUrl(w.id):void 0}sheet(w,D="default"){const W=By(w);return Se(this).getOrCreateSheet(W,D).publicApi}};$(Q());var qx=mn(),Xy=mn();function Xx(w,D={}){const W=rt.get(w);if(W)return W.publicApi;const me=cp().named("Project",w);return D.state?(Ky(w,D.state),me._debug("deep validated config.state on disk")):me._debug("no config.state"),new UT(w,D)}var Yy=(w,D)=>{if(Array.isArray(D)||D==null||D.definitionVersion!==lp.currentProjectStateDefinitionVersion)throw new S5("Error validating conf.state in Theatre.getProject(".concat(JSON.stringify(w),", conf). The state seems to be formatted in a way that is unreadable to Theatre.js. Read more at https://www.theatrejs.com/docs/latest/manual/projects#state"))},Ky=(w,D)=>{Yy(w,D)};function Zy(w,D,W){const re=W?Se(W).ticker:Oy();if((0,qx.isPointer)(w))return(0,Xy.pointerToPrism)(w).onChange(re,D,!0);if((0,Xy.isPrism)(w))return w.onChange(re,D,!0);throw new Error("Called onChange(p) where p is neither a pointer nor a prism.")}function I5(w){if((0,qx.isPointer)(w))return(0,Xy.pointerToPrism)(w).getValue();throw new Error("Called val(p) where p is not a pointer.")}var zT=class{constructor(){k(this,"_studio")}get type(){return"Theatre_CoreBundle"}get version(){return"0.7.2"}getBitsForStudio(w,D){if(this._studio)throw new Error("@theatre/core is already attached to @theatre/studio");this._studio=w;const W={projectsP:rt.atom.pointer.projects,privateAPI:Se,coreExports:le,getCoreRafDriver:pm};D(W)}};VT();function VT(){if(typeof window>"u")return;const w=window[Cx];if(typeof w<"u")throw typeof w=="object"&&w&&typeof w.version=="string"?new Error(`It seems that the module '@theatre/core' is loaded more than once. This could have two possible causes:
1. You might have two separate versions of Theatre.js in node_modules.
2. Or this might be a bundling misconfiguration, in case you're using a bundler like Webpack/ESBuild/Rollup.

Note that it **is okay** to import '@theatre/core' multiple times. But those imports should point to the same module.`):new Error("The variable window.".concat(Cx," seems to be already set by a module other than @theatre/core."));const D=new zT;window[Cx]=D;const W=window[oN];W&&W!==null&&W.type==="Theatre_StudioBundle"&&W.registerCoreBundle(D)}/*! Bundled license information:

		lodash-es/lodash.js:
		  (**
		   * @license
		   * Lodash (Custom Build) <https://lodash.com/>
		   * Build: `lodash modularize exports="es" -o ./`
		   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
		   * Released under MIT license <https://lodash.com/license>
		   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
		   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
		   *)
		*/}(Qw,Qw.exports)),Qw.exports}var iH=bWe();const GI=new Map,W5e=new Map,$5e=new Map,KW=new Map;function SWe(o,e){return new Promise((t,n)=>{new WMe().setPath("images/milkyWay/").load(e,r=>{GI.set(o,r),t(r)},void 0,()=>{n()})})}function wWe(o,e){return new Promise((t,n)=>{new cWe().setPath("./models/").loadAsync(e).then(r=>{r.traverse(i=>{i.isMesh&&(i.castShadow=!0,i.receiveShadow=!0)}),$5e.set(o,r),t(r)}).catch(r=>{console.log("Couldn't load:",e),console.log(r),n()})})}function EWe(o,e){return new Promise((t,n)=>{new H9e().load(e,r=>{r.wrapS=kg,r.wrapT=kg,r.needsUpdate=!0,KW.set(o,r),t(r)},void 0,()=>{n()})})}function TWe(o,e){return new Promise((t,n)=>{fetch(e).then(r=>{if(!r.ok)throw new Error(`Network response was not ok: ${r.status}`);return r.json()}).then(r=>{W5e.set(o,r),t(r)}).catch(()=>{console.log(`Couldn't load: ${e}`),n()})})}function MWe(o){return new Promise((e,t)=>{const n=[()=>SWe("environment",["dark-s_px.jpg","dark-s_nx.jpg","dark-s_py.jpg","dark-s_ny.jpg","dark-s_pz.jpg","dark-s_nz.jpg"]),()=>EWe("uv_grid","images/uv_grid_opengl.jpg"),()=>wWe("Flair","Flair.fbx"),()=>TWe("animation","json/animation.json")];Promise.all(n.map(r=>r())).then(()=>{const r=o.components.get("theatre"),i=W5e.get("animation");r.project=iH.getProject("RemoteApp",{state:i}),r.project.ready.then(()=>{w6.dispatchEvent({type:X3.LOAD_COMPLETE}),e()})}).catch(r=>{console.log(r),t()})})}class q5e extends Ci{constructor(t){super();et(this,"mixer");this.name=t,this.scale.setScalar(.5);const n=$5e.get(t),r=BHe(n);this.add(r),this.mixer=new dCe(r),r.mixer=this.mixer,this.mixer.clipAction(r.animations[0]).play()}update(t){this.mixer.update(t)}get timeScale(){return this.mixer.timeScale}set timeScale(t){this.mixer.timeScale=t}}class X5e extends vI{constructor(){super();et(this,"app");et(this,"camera");et(this,"renderer");et(this,"clock");this.clock=new W9e,this.clock.start();const t=new Ci;t.name="cameras",this.add(t),this.camera=new La(90,1,10,1e3),this.camera.name="Main",this.camera.position.set(0,100,125),this.camera.lookAt(0,50,0),t.add(this.camera)}setup(t,n){this.app=t,this.renderer=n}init(){}dispose(){this.app.components.get("theatre").clearSheetObjects(this.name)}resize(t,n){this.camera.aspect=t/n,this.camera.updateProjectionMatrix()}update(){}draw(){this.renderer.isWebGLRenderer?this.renderer.render(this,this.camera):this.renderer.renderAsync(this,this.camera)}}class Y5e extends X5e{constructor(){super();et(this,"dance");et(this,"customMat");this.name="Scene1"}init(){const t=GI.get("environment");this.background=t,this.camera.position.set(0,50,50),this.camera.lookAt(0,50,0),this.createLights(),this.createWorld(),this.createAnimation(),B_(this);const n=this.app.components.get("three");n.addScene(this),n.setScene(this),n.addCamera(this.camera)}createLights(){const t=new Ci;t.name="lights",this.add(t);const n=new GH(16777215,.25);n.name="sun",n.castShadow=!0,n.position.set(0,50,50);const r=1024;n.shadow.camera.top=r,n.shadow.camera.bottom=-r,n.shadow.camera.left=-r,n.shadow.camera.right=r,n.shadow.mapSize.width=1024,n.shadow.mapSize.height=1024,n.shadow.camera.near=10,n.shadow.camera.far=1e3,n.shadow.bias=-.001,t.add(n);const i=new $Me(7320802,12872999,.5);i.name="hemi",t.add(i);const a=new VH(16777215,3);a.angle=5.8,a.decay=0,a.distance=1e3,a.penumbra=Math.PI,a.name="spotlight",a.castShadow=!0,a.shadow.mapSize.width=1024,a.shadow.mapSize.height=1024,a.shadow.camera.near=10,a.shadow.camera.far=1e3,a.shadow.bias=-.001,a.position.set(-50,200,200),a.lookAt(0,50,0),t.add(a)}createWorld(){const t=new Ci;t.name="world",this.add(t);const n=KW.get("uv_grid");n.repeat.setScalar(10),n.needsUpdate=!0;const r=new u_({map:n}),i=new Mn(new _I(500,36),r);i.name="floor",i.receiveShadow=!0,i.rotateX(-Math.PI/2),t.add(i),this.dance=new q5e("Flair"),this.dance.position.set(0,0,0),t.add(this.dance),this.createTestMaterials(t)}createTestMaterials(t){const n=new S6(20),r=[],i=new Mn(n,new wu({name:"BasicMaterial",transparent:!0}));i.name="Basic",t.add(i),r.push(i);const a=new Mn(n,new U9e({transparent:!0}));a.name="Matcap",t.add(a),r.push(a);const c=new Mn(n,new u_({name:"PhongMaterial",transparent:!0}));c.name="Phong",t.add(c),r.push(c);const h=new Mn(n,new Vk({name:"PhysicalMaterial",transparent:!0}));if(h.name="Physical",t.add(h),r.push(h),this.app.components.get("three").renderer.isWebGLRenderer){this.customMat=new N5e;const C=new Mn(n,this.customMat);C.name="Shader",t.add(C),r.push(C)}const v=50,x=r.length,S=(x-1)/2*v;for(let C=0;C<x;C++){const I=C*v-S;r[C].position.set(I,100,-150),r[C].castShadow=!0}}createAnimation(){const t=this.app.components.get("theatre");t.sheet(this.name),t.sheetObject(this.name,"Camera",{position:{x:this.camera.position.x,y:this.camera.position.y,z:this.camera.position.z},rotation:{x:this.camera.rotation.x,y:this.camera.rotation.y,z:this.camera.rotation.z}},n=>{this.camera.position.set(n.position.x,n.position.y,n.position.z),this.camera.rotation.set(n.rotation.x,n.rotation.y,n.rotation.z)}),t.sheetObject(this.name,"Break Dancer",{position:{x:this.dance.position.x,y:this.dance.position.y,z:this.dance.position.z},rotation:{x:this.dance.rotation.x,y:this.dance.rotation.y,z:this.dance.rotation.z}},n=>{this.dance.position.set(n.position.x,n.position.y,n.position.z),this.dance.rotation.set(n.rotation.x,n.rotation.y,n.rotation.z)}),t.playSheet(this.name,{iterationCount:1/0})}update(){var n;const t=this.clock.getDelta();(n=this.customMat)==null||n.update(t),this.dance.update(t)}resize(t,n){var r;super.resize(t,n),(r=this.renderer)==null||r.setSize(t,n)}}class Y_{static init(){const e=[1,0,0,2e-5,1,0,0,503905e-9,1,0,0,.00201562,1,0,0,.00453516,1,0,0,.00806253,1,0,0,.0125978,1,0,0,.018141,1,0,0,.0246924,1,0,0,.0322525,1,0,0,.0408213,1,0,0,.0503999,1,0,0,.0609894,1,0,0,.0725906,1,0,0,.0852058,1,0,0,.0988363,1,0,0,.113484,1,0,0,.129153,1,0,0,.145839,1,0,0,.163548,1,0,0,.182266,1,0,0,.201942,1,0,0,.222314,1,0,0,.241906,1,0,0,.262314,1,0,0,.285754,1,0,0,.310159,1,0,0,.335426,1,0,0,.361341,1,0,0,.387445,1,0,0,.412784,1,0,0,.438197,1,0,0,.466966,1,0,0,.49559,1,0,0,.523448,1,0,0,.549938,1,0,0,.57979,1,0,0,.608746,1,0,0,.636185,1,0,0,.664748,1,0,0,.69313,1,0,0,.71966,1,0,0,.747662,1,0,0,.774023,1,0,0,.799775,1,0,0,.825274,1,0,0,.849156,1,0,0,.873248,1,0,0,.89532,1,0,0,.917565,1,0,0,.937863,1,0,0,.958139,1,0,0,.976563,1,0,0,.994658,1,0,0,1.0112,1,0,0,1.02712,1,0,0,1.04189,1,0,0,1.05568,1,0,0,1.06877,1,0,0,1.08058,1,0,0,1.09194,1,0,0,1.10191,1,0,0,1.11161,1,0,0,1.1199,1,0,0,1.12813,.999547,-448815e-12,.0224417,199902e-10,.999495,-113079e-10,.0224406,503651e-9,.999496,-452317e-10,.0224406,.00201461,.999496,-101772e-9,.0224406,.00453287,.999495,-180928e-9,.0224406,.00805845,.999497,-282702e-9,.0224406,.0125914,.999496,-407096e-9,.0224406,.0181319,.999498,-554114e-9,.0224406,.02468,.999499,-723768e-9,.0224406,.0322363,.999495,-916058e-9,.0224405,.0408009,.999499,-.00113101,.0224408,.050375,.999494,-.00136863,.0224405,.0609586,.999489,-.00162896,.0224401,.0725537,.999489,-.00191201,.0224414,.0851619,.999498,-.00221787,.0224413,.0987867,.999492,-.00254642,.0224409,.113426,.999507,-.00289779,.0224417,.129088,.999494,-.0032716,.0224386,.145767,.999546,-.0036673,.0224424,.163472,.999543,-.00408166,.0224387,.182182,.999499,-.00450056,.0224338,.201843,.999503,-.00483661,.0224203,.222198,.999546,-.00452928,.022315,.241714,.999508,-.00587403,.0224329,.262184,.999509,-.00638806,.0224271,.285609,.999501,-.00691028,.0224166,.309998,.999539,-.00741979,.0223989,.335262,.999454,-.00786282,.0223675,.361154,.999529,-.00811928,.0222828,.387224,.999503,-.00799941,.0221063,.41252,.999561,-.00952753,.0223057,.438006,.999557,-.0099134,.0222065,.466735,.999541,-.0100935,.0220402,.495332,.999562,-.00996821,.0218067,.523197,.999556,-.0105031,.0217096,.550223,.999561,-.0114191,.0217215,.579498,.999588,-.0111818,.0213357,.608416,.999633,-.0107725,.0208689,.635965,.999527,-.0121671,.0210149,.664476,.999508,-.0116005,.020431,.692786,.999568,-.0115604,.0199791,.719709,.999671,-.0121117,.0197415,.74737,.999688,-.0110769,.0188846,.773692,.99962,-.0122368,.0188452,.799534,.999823,-.0110325,.0178001,.825046,.999599,-.0114923,.0174221,.849075,.999619,-.0105923,.0164345,.872999,.999613,-.0105988,.0158227,.895371,.99964,-.00979861,.0148131,.917364,.99977,-.00967238,.0140721,.938002,.999726,-.00869175,.0129543,.957917,.99973,-.00866872,.0122329,.976557,.999773,-.00731956,.0108958,.994459,.999811,-.00756027,.0102715,1.01118,.999862,-.00583732,.00878781,1.02701,.999835,-.00631438,.00827529,1.04186,.999871,-.00450785,.00674583,1.05569,.999867,-.00486079,.00621041,1.06861,.999939,-.00322072,.00478301,1.08064,.999918,-.00318199,.00406395,1.09181,1.00003,-.00193348,.00280682,1.10207,.999928,-.00153729,.00198741,1.11152,.999933,-623666e-9,917714e-9,1.12009,1,-102387e-11,907581e-12,1.12813,.997866,-896716e-12,.0448334,199584e-10,.997987,-225945e-10,.0448389,502891e-9,.997987,-903781e-10,.0448388,.00201156,.997985,-203351e-9,.0448388,.00452602,.997986,-361514e-9,.0448388,.00804629,.997987,-56487e-8,.0448389,.0125724,.997988,-813423e-9,.0448389,.0181045,.997984,-.00110718,.0448387,.0246427,.997985,-.00144616,.0448388,.0321875,.997987,-.00183038,.044839,.0407392,.997983,-.00225987,.0448387,.0502986,.997991,-.00273467,.0448389,.0608667,.997984,-.00325481,.0448384,.0724444,.998002,-.00382043,.044839,.0850348,.997997,-.00443145,.0448396,.0986372,.998007,-.00508796,.0448397,.113255,.998008,-.00578985,.04484,.128891,.998003,-.00653683,.0448384,.145548,.997983,-.00732713,.0448358,.163221,.997985,-.00815454,.0448358,.181899,.998005,-.00898985,.0448286,.201533,.998026,-.00964404,.0447934,.221821,.998055,-.00922677,.044611,.241282,.99804,-.0117361,.0448245,.261791,.998048,-.0127628,.0448159,.285181,.998088,-.0138055,.0447996,.30954,.998058,-.0148206,.0447669,.334751,.998099,-.0156998,.044697,.36061,.998116,-.0161976,.0445122,.386603,.998195,-.015945,.0441711,.411844,.998168,-.0183947,.0444255,.43773,.998184,-.0197913,.0443809,.466009,.998251,-.0201426,.0440689,.494574,.998305,-.0198847,.0435632,.522405,.998273,-.0210577,.043414,.549967,.998254,-.0227901,.0433943,.578655,.998349,-.0223108,.0426529,.60758,.99843,-.0223088,.042,.635524,.998373,-.0241141,.0418987,.663621,.998425,-.0231446,.0408118,.691906,.998504,-.0233684,.0400565,.719339,.998443,-.0241652,.0394634,.74643,.99848,-.0228715,.0380002,.773086,.998569,-.023519,.0372322,.798988,.998619,-.0223108,.0356468,.824249,.998594,-.0223105,.034523,.848808,.998622,-.0213426,.0328887,.87227,.998669,-.0207912,.0314374,.895157,.998705,-.0198416,.0296925,.916769,.998786,-.0189168,.0279634,.937773,.998888,-.0178811,.0261597,.957431,.99906,-.0166845,.0242159,.976495,.999038,-.0155464,.0222638,.994169,.999237,-.0141349,.0201967,1.01112,.999378,-.0129324,.0181744,1.02692,.999433,-.0113192,.0159898,1.04174,.999439,-.0101244,.0140385,1.05559,.999614,-.00837456,.0117826,1.06852,.999722,-.00721769,.00983745,1.08069,.999817,-.00554067,.00769002,1.09176,.99983,-.00426961,.005782,1.10211,.999964,-.00273904,.00374503,1.11152,1.00001,-.00136739,.00187176,1.12031,.999946,393227e-10,-28919e-9,1.12804,.995847,-13435e-10,.0671785,19916e-9,.995464,-338387e-10,.0671527,501622e-9,.99547,-135355e-9,.0671531,.00200649,.995471,-30455e-8,.0671532,.00451461,.99547,-541423e-9,.0671531,.008026,.995471,-84598e-8,.0671531,.0125407,.99547,-.00121823,.0671531,.0180589,.99547,-.00165817,.0671531,.0245806,.995463,-.00216583,.0671526,.0321062,.995468,-.00274127,.0671527,.0406366,.995474,-.00338447,.0671534,.0501717,.995473,-.00409554,.0671533,.0607131,.995478,-.00487451,.0671531,.0722618,.995476,-.00572148,.0671532,.0848191,.995477,-.00663658,.0671539,.0983882,.995498,-.00761986,.0671541,.112972,.995509,-.00867094,.0671542,.128568,.995509,-.00978951,.0671531,.145183,.995503,-.0109725,.0671491,.162808,.995501,-.012211,.0671465,.181441,.99553,-.0134565,.0671371,.201015,.99555,-.014391,.0670831,.221206,.99558,-.014351,.0668883,.240813,.995577,-.0173997,.0671055,.261257,.995602,-.0191111,.0671178,.284467,.995623,-.0206705,.0670946,.308765,.995658,-.022184,.0670472,.333905,.995705,-.0234832,.0669417,.359677,.995719,-.0241933,.0666714,.385554,.995786,-.0243539,.066266,.410951,.995887,-.0271866,.0664367,.437163,.995944,-.0296012,.0664931,.464842,.996004,-.0301045,.0660105,.49332,.996128,-.0298311,.0652694,.521131,.996253,-.0316426,.0650739,.549167,.996244,-.0339043,.0649433,.57737,.996309,-.033329,.0638926,.606073,.996417,-.0338935,.0630849,.634527,.996372,-.0353104,.0625083,.66256,.996542,-.0348942,.0611986,.690516,.996568,-.0351614,.060069,.718317,.996711,-.0354317,.0588522,.74528,.996671,-.0349513,.0571902,.772061,.996865,-.0345622,.0555321,.798089,.996802,-.0342566,.0537816,.823178,.996992,-.0330862,.0516095,.847949,.996944,-.0324666,.0495537,.871431,.997146,-.0309544,.0470302,.894357,.997189,-.0299372,.0446043,.916142,.997471,-.0281389,.0418812,.937193,.997515,-.0268702,.0391823,.957,.997812,-.0247166,.0361338,.975936,.998027,-.0233525,.0333945,.99391,.998233,-.0209839,.0301917,1.01075,.998481,-.0194309,.027271,1.02669,.998859,-.0169728,.0240162,1.04173,.99894,-.0152322,.0210517,1.05551,.999132,-.0127497,.0178632,1.06856,.999369,-.0108282,.014787,1.08054,.999549,-.00845886,.0116185,1.09185,.999805,-.0063937,.00867209,1.10207,.99985,-.00414582,.00566823,1.1117,.999912,-.00207443,.00277562,1.12022,1.00001,870226e-10,-53766e-9,1.12832,.991943,-178672e-11,.0893382,198384e-10,.991952,-450183e-10,.089339,499849e-9,.991956,-180074e-9,.0893394,.0019994,.991955,-405167e-9,.0893393,.00449867,.991953,-720298e-9,.0893391,.00799764,.991955,-.00112548,.0893393,.0124964,.991957,-.0016207,.0893395,.0179951,.991958,-.00220601,.0893396,.0244939,.991947,-.00288137,.0893385,.0319929,.991962,-.00364693,.0893399,.0404933,.991965,-.00450264,.0893399,.049995,.99198,-.00544862,.0893411,.0604995,.99197,-.00648491,.0893397,.0720074,.991976,-.00761164,.089341,.0845207,.99198,-.00882891,.0893405,.0980413,.991982,-.0101367,.0893396,.112571,.992008,-.011535,.0893415,.128115,.992026,-.0130228,.0893414,.144672,.992064,-.0145966,.0893418,.162241,.992041,-.0162421,.0893359,.180801,.992086,-.0178888,.0893214,.200302,.992157,-.0190368,.0892401,.220332,.992181,-.0195584,.0890525,.240144,.992175,-.0227257,.0892153,.260728,.99221,-.0254195,.089304,.283473,.99222,-.0274883,.0892703,.307673,.992317,-.0294905,.0892027,.332729,.992374,-.0311861,.0890577,.358387,.992505,-.0320656,.0886994,.384102,.992568,-.0329715,.0883198,.409767,.992675,-.036006,.0883602,.436145,.992746,-.0392897,.0884591,.463217,.992873,-.0399337,.0878287,.491557,.992934,-.040231,.0870108,.519516,.993091,-.0422013,.0865857,.547741,.993259,-.0443503,.0861937,.575792,.993455,-.0446368,.0851187,.604233,.993497,-.0454299,.0840576,.632925,.993694,-.0463296,.0829671,.660985,.993718,-.0470619,.0817185,.688714,.993973,-.0468838,.0800294,.716743,.994207,-.046705,.0781286,.74377,.994168,-.0469698,.0763337,.77042,.9945,-.0456816,.0738184,.796659,.994356,-.0455518,.0715545,.821868,.994747,-.0439488,.0686085,.846572,.994937,-.0430056,.065869,.870435,.995142,-.0413414,.0626446,.893272,.995451,-.0396521,.05929,.915376,.995445,-.0378453,.0558503,.936196,.995967,-.0355219,.0520949,.956376,.996094,-.0335146,.048377,.975327,.996622,-.030682,.0442575,.993471,.996938,-.0285504,.0404693,1.01052,.997383,-.0253399,.0360903,1.02637,.997714,-.0231651,.0322176,1.04139,.998249,-.0198138,.0278433,1.05542,.998596,-.0174337,.0238759,1.06846,.998946,-.0141349,.0195944,1.08056,.99928,-.0115603,.0156279,1.09181,.999507,-.00839065,.0114607,1.10213,.999697,-.005666,.00763325,1.11169,.999869,-.00269902,.00364946,1.12042,1.00001,623836e-10,-319288e-10,1.12832,.987221,-222675e-11,.111332,197456e-10,.98739,-561116e-10,.111351,497563e-9,.987448,-224453e-9,.111357,.00199031,.987441,-505019e-9,.111357,.0044782,.987442,-897816e-9,.111357,.00796129,.987442,-.00140284,.111357,.0124396,.987444,-.00202012,.111357,.0179132,.987442,-.00274964,.111357,.0243824,.987446,-.00359147,.111357,.0318474,.987435,-.00454562,.111356,.0403086,.987461,-.00561225,.111358,.0497678,.987458,-.00679125,.111358,.0602239,.987443,-.0080828,.111356,.0716792,.987476,-.0094872,.111358,.0841364,.98749,-.0110044,.111361,.097597,.987508,-.0126344,.111362,.112062,.987494,-.0143767,.111357,.127533,.987526,-.0162307,.111359,.144015,.987558,-.0181912,.111361,.161502,.987602,-.0202393,.111355,.179979,.987692,-.022273,.111346,.199386,.987702,-.0235306,.111215,.219183,.987789,-.0247628,.111061,.239202,.987776,-.0280668,.111171,.259957,.987856,-.0316751,.111327,.282198,.987912,-.0342468,.111282,.306294,.988,-.0367205,.111198,.331219,.988055,-.0387766,.110994,.356708,.988241,-.0397722,.110547,.382234,.988399,-.0416076,.110198,.408227,.988539,-.0448192,.110137,.434662,.988661,-.0483793,.110143,.461442,.988967,-.0495895,.109453,.489318,.989073,-.0506797,.108628,.517516,.989274,-.0526953,.108003,.545844,.989528,-.054578,.107255,.573823,.989709,-.0561503,.106294,.601944,.989991,-.056866,.104896,.630855,.990392,-.0572914,.103336,.658925,.990374,-.0586224,.10189,.686661,.990747,-.0584764,.099783,.714548,.991041,-.0582662,.0974309,.74186,.991236,-.0584118,.0951678,.768422,.991585,-.0573055,.0921581,.794817,.991984,-.0564241,.0891167,.820336,.9921,-.0553608,.085805,.84493,.992749,-.0533816,.0820354,.868961,.99288,-.0518661,.0782181,.891931,.993511,-.0492492,.0738935,.914186,.993617,-.0471956,.0696402,.93532,.99411,-.044216,.0649659,.95543,.994595,-.0416654,.0603177,.974685,.994976,-.0384314,.0553493,.992807,.995579,-.0353491,.0503942,1.00996,.996069,-.0319787,.0452123,1.02606,.996718,-.028472,.0400112,1.04114,.997173,-.0250789,.0349456,1.05517,.997818,-.0213326,.029653,1.0683,.998318,-.0178509,.024549,1.0805,.998853,-.0141118,.0194197,1.09177,.999218,-.0105914,.0143869,1.1022,.999594,-.00693474,.00943517,1.11175,.99975,-.00340478,.00464051,1.12056,1.00001,109172e-9,-112821e-9,1.12853,.983383,-266524e-11,.133358,196534e-10,.981942,-671009e-10,.133162,494804e-9,.981946,-268405e-9,.133163,.00197923,.981944,-603912e-9,.133163,.00445326,.981941,-.00107362,.133162,.00791693,.981946,-.00167755,.133163,.0123703,.981944,-.00241569,.133162,.0178135,.981945,-.00328807,.133163,.0242466,.981945,-.00429472,.133162,.03167,.981955,-.00543573,.133164,.0400846,.981951,-.00671105,.133163,.0494901,.981968,-.00812092,.133165,.0598886,.981979,-.00966541,.133166,.0712811,.981996,-.0113446,.133168,.083669,.982014,-.0131585,.133169,.0970533,.982011,-.0151073,.133167,.111438,.982062,-.0171906,.133172,.126826,.9821,-.0194067,.133175,.143215,.982149,-.0217502,.133176,.160609,.982163,-.0241945,.133173,.178981,.982247,-.0265907,.133148,.198249,.982291,-.027916,.132974,.217795,.982396,-.0299663,.132868,.238042,.982456,-.0334544,.132934,.258901,.982499,-.0378636,.133137,.280639,.982617,-.0409274,.133085,.304604,.98274,-.0438523,.132985,.329376,.982944,-.0462288,.132728,.354697,.98308,-.0475995,.132228,.380102,.983391,-.0501901,.131924,.406256,.983514,-.0535899,.131737,.432735,.98373,-.0571858,.131567,.459359,.984056,-.0592353,.130932,.486637,.984234,-.0610488,.130092,.51509,.984748,-.0630758,.12923,.543461,.985073,-.0647398,.128174,.571376,.985195,-.0671941,.127133,.599414,.985734,-.0681345,.125576,.628134,.986241,-.0686089,.123639,.656399,.986356,-.0698511,.121834,.684258,.986894,-.0700931,.119454,.711818,.987382,-.0698321,.116718,.739511,.988109,-.0693975,.113699,.766267,.988363,-.0689584,.110454,.792456,.989112,-.0672353,.106602,.81813,.989241,-.0662034,.10267,.842889,.990333,-.0638938,.0981381,.867204,.990591,-.0618534,.0935388,.89038,.991106,-.0593117,.088553,.912576,.991919,-.0562676,.0832187,.934118,.992111,-.0534085,.0778302,.954254,.992997,-.0495459,.0720453,.973722,.993317,-.0463707,.0663458,.991949,.994133,-.0421245,.0601883,1.00936,.994705,-.0384977,.0542501,1.02559,.995495,-.0340956,.0479862,1.04083,.996206,-.030105,.041887,1.05497,.996971,-.0256095,.0355355,1.06824,.997796,-.0213932,.0293655,1.08056,.998272,-.0169612,.0232926,1.09182,.998857,-.0126756,.0172786,1.10219,.99939,-.00832486,.0113156,1.11192,.999752,-.00410826,.00557892,1.12075,1,150957e-9,-119101e-9,1.12885,.975169,-309397e-11,.154669,195073e-10,.975439,-779608e-10,.154712,491534e-9,.975464,-311847e-9,.154716,.00196617,.975464,-701656e-9,.154716,.00442387,.975462,-.0012474,.154715,.0078647,.975461,-.00194906,.154715,.0122886,.975464,-.00280667,.154715,.0176959,.975468,-.00382025,.154716,.0240867,.975471,-.00498985,.154716,.0314612,.975472,-.00631541,.154717,.0398199,.975486,-.00779719,.154718,.0491639,.975489,-.00943505,.154718,.0594932,.975509,-.0112295,.154721,.0708113,.97554,-.0131802,.154724,.0831176,.975557,-.0152876,.154726,.096415,.975585,-.0175512,.154728,.110705,.975605,-.0199713,.154729,.125992,.975645,-.0225447,.154729,.142272,.975711,-.0252649,.154735,.159549,.975788,-.0280986,.154736,.177805,.975872,-.0308232,.154704,.196911,.975968,-.0324841,.154525,.216324,.976063,-.0351281,.154432,.236628,.976157,-.0388618,.15446,.257539,.976204,-.0437704,.154665,.278975,.976358,-.047514,.154652,.302606,.976571,-.0508638,.154535,.327204,.976725,-.0534995,.154221,.352276,.977013,-.0555547,.153737,.377696,.977294,-.0586728,.153403,.403855,.977602,-.0622715,.15312,.430333,.977932,-.0658166,.152755,.456855,.978241,-.0689877,.152233,.483668,.978602,-.0712805,.15132,.512097,.979234,-.0732775,.150235,.540455,.97977,-.075163,.148978,.568486,.979995,-.0778026,.147755,.596524,.98078,-.0791854,.146019,.624825,.981628,-.0799666,.143906,.653403,.982067,-.0808532,.141561,.681445,.98271,-.0816024,.139025,.708918,.983734,-.0812511,.135764,.736594,.98431,-.0806201,.132152,.763576,.985071,-.0801605,.12846,.789797,.98618,-.0784208,.124084,.815804,.986886,-.0766643,.1193,.840869,.987485,-.0747744,.114236,.864952,.988431,-.0716701,.108654,.888431,.988886,-.0691609,.102994,.910963,.990024,-.0654048,.0967278,.932629,.990401,-.0619765,.090384,.95313,.991093,-.0579296,.0837885,.972587,.992018,-.0536576,.0770171,.991184,.992536,-.0493719,.0701486,1.00863,.993421,-.0444813,.062953,1.02494,.993928,-.040008,.0560455,1.04017,.994994,-.0347982,.04856,1.05463,.995866,-.0301017,.0416152,1.06807,.996916,-.0248225,.0342597,1.08039,.997766,-.0199229,.0271668,1.09177,.998479,-.0147422,.0201387,1.10235,.99921,-.00980173,.0131944,1.11206,.999652,-.0047426,.00640712,1.12104,.999998,891673e-10,-10379e-8,1.12906,.967868,-351885e-11,.175947,193569e-10,.968001,-886733e-10,.175972,487782e-9,.96801,-354697e-9,.175973,.00195115,.968012,-798063e-9,.175974,.00439006,.968011,-.00141879,.175973,.00780461,.968011,-.00221686,.175973,.0121948,.968016,-.00319231,.175974,.0175607,.968019,-.00434515,.175974,.0239027,.968018,-.00567538,.175974,.0312208,.968033,-.00718308,.175977,.0395158,.968049,-.00886836,.175979,.0487885,.968047,-.0107312,.175978,.0590394,.968072,-.0127719,.175981,.0702705,.968108,-.0149905,.175986,.0824836,.968112,-.0173866,.175985,.0956783,.968173,-.0199611,.175993,.109862,.96827,-.0227128,.176008,.125033,.968292,-.025639,.17601,.141193,.968339,-.0287299,.176007,.158336,.968389,-.0319399,.176001,.176441,.968501,-.034941,.175962,.195359,.968646,-.0370812,.175793,.214686,.968789,-.0402329,.175708,.234973,.96886,-.0442601,.1757,.255871,.969013,-.049398,.175876,.277238,.969242,-.0539932,.17594,.300326,.969419,-.0577299,.175781,.324702,.969763,-.0605643,.175432,.349527,.970093,-.0634488,.174992,.374976,.970361,-.0670589,.174611,.401097,.970825,-.0708246,.174226,.427496,.971214,-.0742871,.173684,.453858,.971622,-.0782608,.173186,.480637,.972175,-.0813151,.172288,.508655,.972944,-.0832678,.170979,.536973,.973595,-.0855964,.169573,.565138,.974345,-.0882163,.168152,.593222,.975233,-.0901671,.166314,.621201,.976239,-.0912111,.163931,.649919,.977289,-.0916959,.161106,.678011,.978076,-.0927061,.158272,.705717,.979533,-.0925562,.15475,.733228,.980335,-.0918159,.150638,.760454,.981808,-.0908508,.146201,.786918,.983061,-.0896172,.141386,.812953,.984148,-.0871588,.135837,.838281,.985047,-.0850624,.130135,.862594,.986219,-.0818541,.123882,.88633,.987043,-.0784523,.117126,.908952,.988107,-.0749601,.110341,.930744,.988955,-.0703548,.102885,.951728,.989426,-.0662798,.0954167,.971166,.990421,-.0610834,.0876331,.989984,.991032,-.0562936,.0797785,1.00765,.992041,-.0508154,.0718166,1.02434,.992794,-.0454045,.0637125,1.03976,.993691,-.0398194,.0555338,1.05418,.994778,-.0341482,.0473388,1.06772,.995915,-.028428,.0391016,1.08028,.997109,-.022642,.0309953,1.09185,.998095,-.0168738,.0230288,1.10247,.998985,-.0111274,.0150722,1.11229,.999581,-.00543881,.00740605,1.12131,1.00003,162239e-9,-105549e-9,1.12946,.959505,-393734e-11,.196876,191893e-10,.959599,-992157e-10,.196895,483544e-9,.959641,-396868e-9,.196903,.0019342,.959599,-892948e-9,.196895,.00435193,.959603,-.00158747,.196896,.0077368,.959604,-.00248042,.196896,.0120888,.959605,-.00357184,.196896,.0174082,.959605,-.00486169,.196896,.0236949,.959613,-.00635008,.196897,.0309497,.959619,-.00803696,.196898,.0391725,.959636,-.00992255,.196901,.0483649,.959634,-.0120067,.1969,.0585266,.959675,-.0142898,.196906,.0696609,.959712,-.0167717,.196911,.0817678,.959752,-.0194524,.196918,.0948494,.959807,-.0223321,.196925,.10891,.959828,-.0254091,.196924,.123947,.959906,-.0286815,.196934,.139968,.960005,-.0321371,.196944,.156968,.960071,-.0357114,.196936,.17491,.960237,-.0389064,.196882,.193597,.960367,-.041623,.196731,.21285,.960562,-.0452655,.196654,.233075,.960735,-.0496207,.196643,.253941,.960913,-.0549379,.196774,.275278,.961121,-.0603414,.196893,.297733,.96139,-.0644244,.196717,.321877,.961818,-.067556,.196314,.346476,.962175,-.0712709,.195917,.371907,.96255,-.0752848,.1955,.397916,.963164,-.0792073,.195026,.424229,.963782,-.0828225,.194424,.450637,.964306,-.0873119,.193831,.477288,.964923,-.0911051,.192973,.504716,.966048,-.093251,.19151,.533053,.967024,-.0958983,.190013,.561366,.968038,-.09835,.188253,.589464,.969152,-.100754,.186257,.617433,.970557,-.102239,.183775,.645801,.972104,-.102767,.180645,.674278,.973203,-.103492,.177242,.702004,.975123,-.103793,.17345,.729529,.97641,-.102839,.168886,.756712,.978313,-.101687,.163892,.783801,.980036,-.100314,.158439,.809671,.981339,-.097836,.152211,.835402,.982794,-.0950006,.145679,.860081,.984123,-.0920994,.138949,.883757,.984918,-.0878641,.131283,.90685,.985999,-.083939,.123464,.928786,.987151,-.0791234,.115324,.94983,.987827,-.0739332,.106854,.96962,.988806,-.0688088,.0982691,.98861,.989588,-.0628962,.0893456,1.00667,.990438,-.0573146,.0805392,1.02344,.991506,-.0509433,.0713725,1.03933,.992492,-.0448724,.0623732,1.05378,.993663,-.0383497,.0530838,1.06747,.994956,-.0319593,.0439512,1.08007,.99634,-.025401,.0347803,1.09182,.99761,-.0189687,.0257954,1.1025,.99863,-.0124441,.0169893,1.11247,.99947,-.00614003,.00829498,1.12151,1.00008,216624e-9,-146107e-9,1.12993,.950129,-434955e-11,.217413,190081e-10,.950264,-10957e-8,.217444,47884e-8,.9503,-438299e-9,.217451,.00191543,.950246,-986124e-9,.21744,.00430951,.950246,-.00175311,.21744,.00766137,.950245,-.00273923,.21744,.011971,.950253,-.00394453,.217441,.0172385,.950258,-.00536897,.217442,.0234641,.950267,-.00701262,.217444,.030648,.950277,-.00887551,.217446,.038791,.950284,-.0109576,.217446,.0478931,.950312,-.0132591,.217451,.0579568,.950334,-.01578,.217454,.0689821,.950378,-.0185204,.217462,.0809714,.950417,-.0214803,.217467,.0939265,.950488,-.0246594,.217479,.10785,.950534,-.0280565,.217483,.122743,.950633,-.0316685,.217498,.138611,.950698,-.0354787,.217499,.155442,.950844,-.0394003,.217507,.173208,.950999,-.0426812,.217419,.191605,.951221,-.0461302,.217317,.21084,.951412,-.0502131,.217238,.230945,.951623,-.0549183,.21722,.251745,.951867,-.0604493,.217306,.273001,.952069,-.0665189,.217466,.294874,.952459,-.0709179,.217266,.318732,.952996,-.0746112,.216891,.34318,.953425,-.0789252,.216503,.36849,.953885,-.0833293,.216042,.394373,.954617,-.087371,.215469,.420505,.955429,-.0914054,.214802,.446907,.956068,-.0961671,.214146,.473522,.957094,-.10048,.213286,.50052,.958372,-.103248,.211796,.528715,.959654,-.106033,.21016,.557065,.961305,-.108384,.208149,.585286,.962785,-.111122,.206024,.613334,.964848,-.112981,.203442,.641334,.966498,-.113717,.19996,.669955,.968678,-.114121,.196105,.698094,.970489,-.114524,.191906,.725643,.972903,-.113792,.186963,.752856,.974701,-.112406,.181343,.780013,.976718,-.110685,.175185,.806268,.978905,-.108468,.168535,.832073,.980267,-.105061,.161106,.857149,.981967,-.101675,.153387,.881145,.983063,-.0974492,.145199,.904255,.984432,-.0925815,.136527,.926686,.985734,-.0877983,.127584,.947901,.986228,-.081884,.118125,.968111,.98719,-.0761208,.108594,.98719,.988228,-.0698196,.0989996,1.00559,.989046,-.0632739,.0890074,1.02246,.990242,-.056522,.0790832,1.03841,.991252,-.0495272,.0689182,1.05347,.992542,-.0425373,.0588592,1.06724,.994096,-.0353198,.0486833,1.08009,.995593,-.028235,.0385977,1.09177,.99711,-.0209511,.0286457,1.10274,.998263,-.0139289,.0188497,1.11262,.999254,-.0067359,.009208,1.12191,.999967,141846e-9,-657764e-10,1.13024,.935608,-474692e-11,.236466,187817e-10,.93996,-11971e-8,.237568,473646e-9,.939959,-478845e-9,.237567,.0018946,.939954,-.0010774,.237566,.00426284,.939956,-.00191538,.237566,.00757842,.939954,-.00299277,.237566,.0118413,.93996,-.00430961,.237567,.0170518,.939969,-.00586589,.237569,.02321,.939982,-.00766166,.237572,.0303164,.939987,-.00969686,.237572,.0383711,.939997,-.0119715,.237574,.0473751,.940031,-.0144858,.237581,.0573298,.940073,-.0172399,.237589,.0682366,.94012,-.0202335,.237598,.080097,.940162,-.0234663,.237604,.0929116,.940237,-.0269387,.237615,.106686,.940328,-.0306489,.237632,.121421,.940419,-.0345917,.237645,.137115,.940522,-.0387481,.237654,.153766,.940702,-.0429906,.237661,.17133,.940871,-.0465089,.237561,.189502,.941103,-.050531,.23748,.208616,.941369,-.0550657,.237423,.228595,.941641,-.0601337,.237399,.249287,.941903,-.0658804,.237443,.270467,.942224,-.0722674,.237597,.292024,.942633,-.0771788,.237419,.315272,.943172,-.0815623,.237068,.339579,.943691,-.0863973,.236682,.364717,.944382,-.0911536,.236213,.390435,.945392,-.0952967,.235562,.416425,.946185,-.0998948,.234832,.442772,.947212,-.104796,.234114,.469347,.948778,-.10928,.233222,.496162,.950149,-.113081,.231845,.523978,.951989,-.115893,.230005,.552295,.953921,-.11846,.227862,.580569,.955624,-.12115,.225439,.608698,.958234,-.123373,.222635,.636696,.960593,-.124519,.219093,.665208,.963201,-.124736,.214749,.693557,.965642,-.125012,.210059,.721334,.968765,-.124661,.204935,.748613,.971753,-.122996,.198661,.776224,.973751,-.120998,.191823,.802461,.976709,-.118583,.184359,.828399,.977956,-.115102,.176437,.853693,.979672,-.111077,.167681,.877962,.981816,-.10688,.158872,.901564,.98238,-.101469,.149398,.924057,.983964,-.0960013,.139436,.945751,.984933,-.0899626,.12943,.966272,.985694,-.0832973,.11894,.985741,.986822,-.0767082,.108349,1.00407,.987725,-.0693614,.0976026,1.02154,.98877,-.06211,.086652,1.03757,.990129,-.0544143,.0756182,1.05296,.991337,-.046744,.0645753,1.06683,.992978,-.0387931,.0534683,1.0798,.994676,-.030973,.0424137,1.09181,.99645,-.0230311,.0314035,1.10286,.997967,-.0152065,.0206869,1.11291,.99922,-.00744837,.010155,1.12237,1.00002,240209e-9,-752767e-10,1.13089,.922948,-515351e-11,.255626,186069e-10,.928785,-129623e-9,.257244,468009e-9,.928761,-51849e-8,.257237,.00187202,.928751,-.0011666,.257235,.00421204,.928751,-.00207395,.257234,.0074881,.928754,-.00324055,.257235,.0117002,.92876,-.00466639,.257236,.0168486,.928763,-.00635149,.257237,.0229334,.928774,-.00829584,.257239,.029955,.928791,-.0104995,.257243,.0379139,.928804,-.0129623,.257245,.0468108,.928847,-.0156846,.257255,.0566473,.92889,-.0186661,.257263,.0674246,.928924,-.0219067,.257268,.0791433,.928989,-.0254066,.257282,.0918076,.92909,-.0291651,.257301,.105419,.92918,-.0331801,.257316,.119978,.92929,-.0374469,.257332,.135491,.929453,-.041939,.257357,.151948,.929586,-.0464612,.257347,.169275,.929858,-.0503426,.257269,.187257,.930125,-.0548409,.257199,.206204,.930403,-.0598063,.257149,.22601,.930726,-.0652437,.257122,.246561,.931098,-.0712376,.257153,.267618,.931396,-.0777506,.257237,.288993,.931947,-.0832374,.257124,.311527,.932579,-.0883955,.25683,.335697,.933194,-.0937037,.256444,.360634,.934013,-.0987292,.255939,.386126,.935307,-.103215,.255282,.412018,.936374,-.108234,.254538,.438292,.93776,-.113234,.253728,.464805,.939599,-.118013,.25275,.491464,.941036,-.122661,.251404,.518751,.94337,-.125477,.249435,.547133,.945318,-.128374,.247113,.575456,.947995,-.130996,.244441,.60372,.950818,-.133438,.241352,.63174,.954378,-.135004,.237849,.659971,.957151,-.135313,.233188,.688478,.960743,-.13521,.228001,.716767,.964352,-.135007,.222249,.744349,.967273,-.133523,.21542,.771786,.969767,-.131155,.208039,.798639,.973195,-.128492,.200076,.824774,.975557,-.125094,.191451,.850222,.977692,-.120578,.18184,.874761,.98026,-.115882,.172102,.898497,.981394,-.110372,.161859,.921636,.982386,-.10415,.15108,.943467,.983783,-.0978128,.140407,.964045,.98422,-.0906171,.129058,.98398,.985447,-.0832921,.117614,1.00276,.986682,-.0754412,.10585,1.02047,.987326,-.0673885,.0940943,1.03678,.988707,-.0592565,.0822093,1.05218,.990185,-.050717,.070192,1.06652,.991866,-.0423486,.0582081,1.07965,.993897,-.0336118,.0460985,1.09188,.995841,-.0252178,.0342737,1.10307,.997605,-.0164893,.0224829,1.11324,.999037,-.00817112,.0110647,1.12262,1.00003,291686e-9,-168673e-9,1.13139,.915304,-552675e-11,.275999,183285e-10,.91668,-139285e-9,.276414,461914e-9,.916664,-55713e-8,.276409,.00184763,.916653,-.00125354,.276406,.00415715,.916651,-.00222851,.276405,.00739053,.916655,-.00348205,.276406,.0115478,.916653,-.00501414,.276405,.0166291,.916667,-.00682478,.276409,.0226346,.91668,-.00891398,.276412,.0295648,.91669,-.0112817,.276413,.0374199,.916727,-.013928,.276422,.0462016,.916759,-.0168528,.276429,.0559101,.916793,-.0200558,.276436,.0665466,.916849,-.0235373,.276448,.0781139,.916964,-.0272973,.276474,.0906156,.917047,-.0313344,.276491,.104051,.917152,-.0356465,.276511,.118424,.917286,-.0402271,.276533,.133736,.917469,-.0450408,.276564,.149978,.917686,-.0497872,.276563,.167057,.917953,-.0540937,.276493,.184846,.918228,-.0590709,.276437,.203614,.918572,-.0644277,.276398,.223212,.918918,-.0702326,.276362,.243584,.919356,-.076484,.276383,.264465,.919842,-.0830808,.276434,.285701,.920451,-.0892972,.276407,.307559,.921113,-.095016,.276128,.331501,.921881,-.100771,.275754,.356207,.923027,-.106029,.275254,.381477,.924364,-.111029,.274595,.40722,.925818,-.116345,.273841,.433385,.92746,-.121424,.272913,.459848,.929167,-.12657,.271837,.486493,.931426,-.131581,.270575,.513432,.934001,-.135038,.268512,.541502,.936296,-.138039,.266135,.569658,.939985,-.140687,.263271,.598375,.943516,-.143247,.260058,.626563,.94782,-.145135,.256138,.654711,.951023,-.145733,.251154,.683285,.955338,-.145554,.245562,.711831,.959629,-.145008,.239265,.739573,.963123,-.144003,.232064,.767027,.966742,-.141289,.224036,.794359,.969991,-.138247,.215305,.820361,.973403,-.134786,.206051,.846548,.975317,-.129966,.195914,.871541,.977647,-.12471,.185184,.895313,.980137,-.119086,.174161,.918398,.981031,-.112297,.162792,.940679,.982037,-.105372,.150952,.961991,.983164,-.097821,.138921,.981913,.983757,-.0897245,.126611,1.00109,.985036,-.0815974,.114228,1.01902,.986289,-.0727725,.101389,1.03604,.987329,-.0639323,.0886476,1.05149,.989193,-.0548109,.0756837,1.06619,.990716,-.045687,.0627581,1.07948,.992769,-.0364315,.0498337,1.09172,.99524,-.0271761,.0370305,1.1033,.997154,-.0179609,.0243959,1.11353,.998845,-.00878063,.0119567,1.12319,1.00002,259038e-9,-108146e-9,1.13177,.903945,-591681e-11,.295126,181226e-10,.903668,-148672e-9,.295037,455367e-9,.903677,-594683e-9,.29504,.00182145,.903673,-.00133805,.295039,.00409831,.903666,-.00237872,.295036,.00728584,.903668,-.00371676,.295037,.0113842,.903679,-.00535212,.29504,.0163936,.903684,-.00728479,.295041,.0223141,.903698,-.00951473,.295044,.0291462,.903718,-.0120419,.295049,.0368904,.903754,-.0148664,.295058,.0455477,.903801,-.017988,.29507,.0551194,.903851,-.0214064,.295082,.0656058,.903921,-.0251219,.295097,.0770109,.904002,-.0291337,.295116,.0893354,.904111,-.033441,.29514,.102583,.904246,-.0380415,.295169,.116755,.904408,-.0429258,.295202,.131853,.904637,-.0480468,.295245,.147869,.904821,-.0529208,.295214,.164658,.905163,-.0577748,.295185,.182274,.905469,-.0631763,.295143,.200828,.905851,-.068917,.295112,.2202,.906322,-.0750861,.295104,.240372,.906761,-.0815855,.295086,.261082,.90735,-.0882138,.295095,.282123,.908087,-.095082,.295139,.303563,.908826,-.101488,.29492,.327028,.909832,-.107577,.294577,.351464,.911393,-.113033,.294115,.376497,.912804,-.118629,.293446,.402115,.914081,-.124232,.292581,.428111,.91637,-.129399,.29166,.454442,.91814,-.134892,.290422,.481024,.921179,-.140069,.289194,.507924,.924544,-.144431,.287421,.535557,.927995,-.147498,.284867,.563984,.931556,-.150197,.281722,.5923,.935777,-.152711,.278207,.620832,.940869,-.154836,.274148,.649069,.945994,-.155912,.269057,.677746,.949634,-.155641,.262799,.706293,.955032,-.154809,.256097,.734278,.95917,-.153678,.248618,.761751,.962931,-.151253,.239794,.789032,.966045,-.147625,.230281,.815422,.96971,-.143964,.220382,.841787,.972747,-.139464,.209846,.867446,.975545,-.133459,.198189,.892004,.978381,-.127424,.186362,.915458,.979935,-.120506,.173964,.937948,.980948,-.11282,.161429,.959732,.982234,-.104941,.148557,.980118,.982767,-.0962905,.135508,.999463,.983544,-.0873625,.122338,1.01756,.984965,-.0783447,.108669,1.03492,.986233,-.0684798,.0949911,1.05087,.987796,-.0590867,.0811386,1.0656,.989885,-.0489145,.0673099,1.0794,.991821,-.0391,.0535665,1.09174,.99448,-.029087,.0397529,1.10341,.996769,-.019114,.0261463,1.11383,.998641,-.00947007,.0128731,1.1237,.999978,446316e-9,-169093e-9,1.13253,.888362,-627064e-11,.312578,178215e-10,.889988,-157791e-9,.313148,448451e-9,.889825,-631076e-9,.313092,.00179356,.88984,-.00141994,.313097,.00403554,.889828,-.0025243,.313092,.00717429,.889831,-.00394421,.313093,.0112099,.889831,-.00567962,.313093,.0161425,.889844,-.00773051,.313096,.0219724,.889858,-.0100968,.3131,.0286999,.889882,-.0127786,.313106,.0363256,.889918,-.0157757,.313116,.0448509,.889967,-.0190878,.313129,.0542758,.89003,-.022715,.313145,.0646032,.890108,-.0266566,.313165,.0758339,.890218,-.0309131,.313193,.0879729,.890351,-.0354819,.313226,.101019,.89051,-.0403613,.313263,.114979,.890672,-.0455385,.313294,.129848,.890882,-.0509444,.313333,.145616,.891189,-.0559657,.313324,.162122,.891457,-.0613123,.313281,.179524,.891856,-.0671488,.313281,.197855,.892312,-.0732732,.313268,.216991,.892819,-.0797865,.313263,.236924,.893369,-.0865269,.313247,.257433,.894045,-.0931592,.313205,.278215,.894884,-.100532,.313276,.299467,.895832,-.107716,.313205,.322276,.897043,-.114099,.312873,.34642,.898515,-.119941,.312331,.371187,.900191,-.126044,.311731,.396656,.90188,-.131808,.310859,.422488,.904359,-.137289,.309857,.448744,.906923,-.142991,.308714,.475239,.910634,-.148253,.307465,.501983,.914502,-.153332,.305774,.529254,.919046,-.156646,.303156,.557709,.923194,-.159612,.299928,.586267,.928858,-.162027,.296245,.614925,.934464,-.164203,.291832,.643187,.939824,-.165602,.286565,.671601,.944582,-.165383,.280073,.700213,.949257,-.164439,.272891,.728432,.954389,-.162953,.264771,.756082,.958595,-.161007,.255927,.78369,.962138,-.157243,.245769,.810769,.966979,-.152872,.235127,.836999,.969566,-.148209,.22347,.862684,.972372,-.142211,.211147,.887847,.975916,-.135458,.198606,.911843,.978026,-.128398,.185498,.934795,.979686,-.120313,.17171,.956787,.980748,-.11166,.158159,.978046,.981622,-.103035,.144399,.997693,.982356,-.0930328,.13001,1.01642,.983308,-.0834627,.115778,1.03366,.985037,-.0732249,.101327,1.05014,.986493,-.0628145,.086554,1.06507,.988484,-.0526556,.0720413,1.07907,.991051,-.0415744,.0571151,1.09189,.993523,-.0314275,.0426643,1.10369,.99628,-.0203603,.0279325,1.11423,.998344,-.0102446,.0138182,1.12421,.999997,42612e-8,-193628e-9,1.1333,.871555,-660007e-11,.329176,174749e-10,.875255,-166579e-9,.330571,441051e-9,.875644,-666394e-9,.330718,.00176441,.875159,-.00149903,.330536,.00396899,.87516,-.00266493,.330536,.007056,.875158,-.00416393,.330535,.0110251,.87516,-.00599598,.330535,.0158764,.875163,-.00816108,.330536,.0216101,.875174,-.0106591,.330538,.0282266,.875199,-.0134899,.330545,.0357266,.875257,-.0166538,.330563,.0441117,.875304,-.0201501,.330575,.0533821,.875373,-.0239785,.330595,.0635395,.875464,-.0281389,.330619,.0745872,.875565,-.0326301,.330645,.0865255,.875691,-.0374516,.330676,.0993599,.875897,-.0425993,.330733,.113093,.876091,-.0480576,.330776,.127722,.876353,-.0537216,.330826,.143227,.876649,-.0589807,.330809,.159462,.877034,-.0647865,.330819,.176642,.877443,-.0709789,.330817,.194702,.877956,-.0774782,.330832,.213577,.878499,-.0843175,.330822,.233246,.879144,-.0912714,.330804,.253512,.879982,-.0980824,.330766,.274137,.88097,-.105823,.330864,.295209,.882051,-.113671,.330896,.317226,.883397,-.120303,.330545,.341068,.884987,-.12667,.330068,.365613,.886789,-.133118,.329418,.390807,.889311,-.139024,.328683,.416494,.891995,-.144971,.327729,.442618,.895106,-.150747,.326521,.469131,.899527,-.156283,.325229,.495921,.90504,-.161707,.32378,.523162,.909875,-.165661,.32122,.55092,.91561,-.168755,.317942,.579928,.921225,-.171193,.313983,.608539,.927308,-.17319,.309636,.636854,.933077,-.174819,.304262,.66523,.938766,-.175002,.297563,.693609,.943667,-.173946,.289613,.722157,.949033,-.172221,.281227,.750021,.953765,-.169869,.271545,.777466,.95804,-.166578,.261034,.804853,.962302,-.161761,.249434,.831569,.966544,-.156636,.237484,.857779,.969372,-.150784,.224395,.883051,.972486,-.143672,.210786,.907864,.975853,-.135772,.196556,.931223,.977975,-.127942,.182307,.954061,.979122,-.118347,.167607,.97531,.980719,-.109112,.152739,.995666,.981223,-.0991789,.137932,1.01475,.98216,-.0883553,.122692,1.03253,.983379,-.0780825,.107493,1.04917,.985434,-.0665646,.0917791,1.06464,.987332,-.0557714,.0764949,1.07896,.990004,-.0442805,.060721,1.09199,.992975,-.0331676,.0452284,1.10393,.995811,-.0219547,.0297934,1.11476,.9982,-.0107613,.0146415,1.12484,1.00002,248678e-9,-14555e-8,1.13413,.859519,-693595e-11,.347264,171673e-10,.859843,-17503e-8,.347394,433219e-9,.859656,-700076e-9,.347319,.00173277,.859671,-.00157517,.347325,.00389875,.859669,-.00280028,.347324,.00693112,.85967,-.0043754,.347324,.01083,.859665,-.00630049,.347321,.0155954,.859685,-.0085755,.347328,.0212278,.859694,-.0112003,.347329,.0277273,.859718,-.0141747,.347336,.0350946,.85976,-.0174988,.347348,.0433314,.85982,-.0211722,.347366,.0524384,.859892,-.0251941,.347387,.0624168,.860006,-.0295649,.347422,.0732708,.860122,-.0342825,.347453,.0849999,.860282,-.0393462,.347499,.0976102,.860482,-.0447513,.347554,.111104,.860719,-.0504775,.347614,.125479,.860998,-.0563577,.347666,.140703,.861322,-.0619473,.347662,.156681,.861724,-.0681277,.347684,.173597,.862198,-.0746567,.347709,.191371,.862733,-.0815234,.347727,.209976,.863371,-.0886643,.347744,.229351,.86414,-.0957908,.347734,.24934,.865138,-.102912,.34772,.269797,.866182,-.110924,.3478,.290654,.867436,-.119223,.347911,.312074,.869087,-.126197,.347649,.335438,.870859,-.133145,.347222,.359732,.872997,-.139869,.346645,.38467,.875939,-.146089,.345935,.41019,.879012,-.152334,.345012,.436218,.883353,-.15821,.343924,.462641,.888362,-.164097,.342636,.489449,.895026,-.169528,.341351,.516629,.900753,-.174408,.339115,.544109,.906814,-.17751,.335809,.572857,.912855,-.180101,.331597,.601554,.919438,-.182116,.32698,.630198,.925962,-.183494,.321449,.658404,.931734,-.184159,.314595,.686625,.93762,-.18304,.306462,.71531,.943858,-.181323,.297514,.744272,.948662,-.178683,.287447,.771462,.953299,-.175379,.276166,.798593,.957346,-.170395,.263758,.8256,.962565,-.165042,.251019,.852575,.966075,-.158655,.237011,.878316,.969048,-.151707,.222518,.90329,.972423,-.143271,.207848,.927745,.975833,-.134824,.192463,.950859,.977629,-.125444,.1768,.972947,.978995,-.114949,.161033,.993263,.980533,-.104936,.145523,1.01337,.980745,-.0935577,.129799,1.03128,.981814,-.0822956,.113486,1.04825,.983943,-.0710082,.0972925,1.06405,.986141,-.0587931,.0808138,1.0785,.988878,-.0472755,.0644915,1.09204,.992132,-.0349128,.0478128,1.10413,.9953,-.0232407,.031621,1.11527,.998117,-.0112713,.0154935,1.12551,1.00003,339743e-9,-195763e-9,1.13504,.845441,-729126e-11,.364305,169208e-10,.843588,-183164e-9,.363506,425067e-9,.843412,-73253e-8,.36343,.00169999,.843401,-.00164818,.363426,.00382495,.843399,-.00293008,.363425,.00679993,.843401,-.00457822,.363425,.010625,.843394,-.00659249,.363421,.0153002,.843398,-.00897282,.363421,.0208258,.843415,-.0117191,.363426,.0272024,.843438,-.0148312,.363432,.0344305,.843483,-.018309,.363447,.0425116,.84356,-.0221521,.363472,.0514471,.843646,-.0263597,.363499,.061238,.843743,-.0309315,.363527,.0718873,.84388,-.0358658,.363569,.0833969,.844079,-.0411624,.363631,.0957742,.844279,-.0468128,.363688,.109015,.844549,-.0527923,.363761,.123124,.844858,-.0588204,.363817,.138044,.84522,-.0647573,.36383,.153755,.845669,-.0713181,.363879,.170394,.846155,-.0781697,.363908,.187861,.846789,-.0853913,.363969,.206176,.847502,-.0928086,.363999,.225244,.8484,-.10005,.363997,.244926,.849461,-.107615,.364008,.265188,.850562,-.115814,.364055,.28587,.851962,-.124334,.364179,.306926,.854326,-.131995,.364233,.329605,.856295,-.139338,.363856,.35359,.858857,-.146346,.363347,.37831,.862428,-.152994,.362807,.403722,.866203,-.159463,.361963,.429537,.871629,-.165623,.36112,.456,.877365,-.171649,.359917,.482773,.883744,-.177151,.35848,.509705,.890693,-.182381,.356523,.537215,.897278,-.186076,.3533,.565493,.903958,-.188602,.349095,.594293,.910908,-.190755,.344215,.623165,.918117,-.192063,.338606,.651573,.924644,-.192758,.331544,.679869,.931054,-.192238,.323163,.708668,.937303,-.190035,.313529,.737201,.943387,-.187162,.303152,.764977,.948494,-.183876,.29146,.792683,.952546,-.178901,.277917,.819228,.958077,-.173173,.264753,.846559,.962462,-.16645,.25002,.872962,.966569,-.159452,.234873,.898729,.969108,-.15074,.218752,.923126,.973072,-.141523,.202673,.947278,.975452,-.132075,.186326,.969938,.977784,-.121257,.169396,.991325,.97899,-.110182,.153044,1.01123,.979777,-.0989634,.136485,1.0299,.980865,-.0865894,.119343,1.04727,.982432,-.0746115,.102452,1.06341,.984935,-.0621822,.0852423,1.07834,.987776,-.0495694,.0678546,1.092,.99103,-.0372386,.0506917,1.1043,.99474,-.0244353,.0333316,1.11576,.997768,-.0121448,.0164348,1.12617,1.00003,31774e-8,-169504e-9,1.13598,.825551,-756799e-11,.378425,165099e-10,.82664,-190922e-9,.378923,416504e-9,.826323,-763495e-9,.378779,.0016656,.826359,-.00171789,.378795,.00374768,.82636,-.00305402,.378795,.00666259,.826368,-.00477185,.378798,.0104104,.826364,-.00687131,.378795,.0149912,.826368,-.00935232,.378795,.0204054,.826376,-.0122146,.378797,.0266532,.826399,-.0154581,.378803,.0337355,.82646,-.0190825,.378824,.0416537,.826525,-.0230873,.378846,.0504091,.826614,-.0274719,.378876,.0600032,.82674,-.0322355,.378917,.0704393,.826888,-.0373766,.378964,.0817195,.827078,-.0428936,.379024,.0938492,.827318,-.0487778,.379099,.106828,.82764,-.0549935,.379199,.120659,.827926,-.0611058,.379227,.13526,.828325,-.0675054,.379275,.150713,.828801,-.0743455,.379332,.167034,.8294,-.0815523,.379415,.184209,.830094,-.0890779,.379495,.202203,.8309,-.096736,.379555,.220945,.831943,-.104135,.379577,.240306,.833037,-.112106,.379604,.260317,.834278,-.120554,.379668,.2808,.836192,-.129128,.3799,.301654,.838671,-.137541,.380109,.323502,.840939,-.14523,.379809,.347176,.844575,-.15248,.379593,.371706,.848379,-.159607,.37909,.39688,.853616,-.166267,.378617,.422702,.858921,-.172698,.377746,.448919,.865324,-.178823,.376749,.475661,.872207,-.184542,.375363,.502599,.880018,-.189836,.373657,.529914,.88694,-.194294,.370673,.557683,.894779,-.197022,.36662,.586848,.902242,-.199108,.36138,.615831,.909914,-.200398,.355434,.644478,.917088,-.20094,.348173,.672905,.923888,-.200671,.339482,.701327,.930495,-.198773,.32956,.730101,.937247,-.195394,.318363,.758383,.943108,-.191956,.306323,.786539,.948296,-.187227,.292576,.813637,.953472,-.181165,.278234,.840793,.958485,-.174119,.263054,.867712,.962714,-.166564,.246756,.893635,.966185,-.158181,.229945,.919028,.970146,-.148275,.212633,.943413,.973491,-.138157,.195229,.966627,.975741,-.127574,.178048,.988817,.977238,-.11554,.160312,1.00924,.978411,-.10364,.142857,1.02845,.979811,-.0913122,.125317,1.04648,.98116,-.0782558,.107627,1.06284,.983543,-.0655957,.0895862,1.07798,.986789,-.0520411,.0713756,1.092,.990292,-.0389727,.053228,1.10484,.994187,-.025808,.0351945,1.11642,.997499,-.0126071,.0173198,1.12703,.999999,275604e-9,-148602e-9,1.13674,.81075,-78735e-10,.394456,161829e-10,.808692,-198293e-9,.393453,407564e-9,.80846,-792877e-9,.39334,.00162965,.808595,-.00178416,.393407,.00366711,.808597,-.00317182,.393408,.00651934,.808598,-.00495589,.393408,.0101866,.808591,-.00713627,.393403,.0146689,.808592,-.00971285,.393402,.0199667,.80861,-.0126855,.393407,.0260803,.808633,-.0160538,.393413,.0330107,.80868,-.0198175,.393429,.0407589,.808748,-.0239758,.393453,.0493264,.808854,-.0285286,.39349,.0587161,.808992,-.0334748,.39354,.0689304,.809141,-.0388116,.393588,.0799707,.809352,-.0445375,.39366,.0918432,.809608,-.0506427,.393742,.104549,.809915,-.0570708,.393834,.118085,.810253,-.0633526,.393885,.132377,.810687,-.0700966,.393953,.147537,.811233,-.0772274,.394047,.163543,.811865,-.0847629,.394148,.180394,.812648,-.0925663,.394265,.198051,.813583,-.100416,.394363,.216443,.814683,-.108119,.394402,.235502,.815948,-.11644,.394489,.255242,.817278,-.125036,.394542,.275441,.819605,-.133655,.39486,.296094,.822256,-.142682,.395248,.317309,.825349,-.150756,.395241,.340516,.829605,-.158392,.395285,.364819,.83391,-.165801,.394922,.389736,.839808,-.172677,.394691,.415409,.845708,-.179448,.394006,.441546,.853025,-.185746,.393279,.46832,.859666,-.191684,.391655,.495302,.86789,-.197146,.390068,.52262,.875845,-.201904,.38727,.550336,.882634,-.205023,.382688,.578825,.891076,-.207098,.377543,.608103,.900589,-.208474,.371752,.63723,.90791,-.209068,.364016,.665769,.915971,-.208655,.355593,.694428,.923455,-.20729,.345439,.723224,.931514,-.203821,.334099,.751925,.937885,-.19986,.321069,.780249,.943136,-.194993,.306571,.8077,.948818,-.189132,.291556,.83497,.954433,-.181617,.275745,.86188,.959078,-.173595,.258695,.888562,.962705,-.164855,.240825,.914008,.966753,-.155129,.22268,.939145,.970704,-.144241,.204542,.963393,.973367,-.133188,.185927,.985983,.975984,-.121146,.167743,1.00704,.976994,-.108366,.149218,1.02715,.978485,-.0956746,.13131,1.0455,.980074,-.0820733,.112513,1.06221,.98225,-.0684061,.0938323,1.07782,.98553,-.0549503,.0749508,1.09199,.989529,-.0407857,.055848,1.10508,.993536,-.0271978,.0368581,1.11684,.997247,-.0132716,.0181845,1.12789,1,431817e-9,-198809e-9,1.13792,.785886,-812608e-11,.405036,157669e-10,.790388,-205278e-9,.407355,398297e-9,.790145,-820824e-9,.407231,.00159263,.790135,-.00184681,.407226,.00358336,.790119,-.00328316,.407218,.00637039,.790126,-.00512988,.40722,.0099539,.79013,-.00738684,.407221,.0143339,.790135,-.0100538,.407221,.0195107,.790134,-.0131306,.407217,.0254848,.79016,-.0166169,.407224,.0322572,.790197,-.020512,.407236,.0398284,.790273,-.0248157,.407263,.0482014,.790381,-.029527,.407304,.0573777,.790521,-.0346446,.407355,.0673602,.790704,-.0401665,.40742,.0781522,.790925,-.0460896,.407499,.0897582,.791195,-.0524017,.407589,.10218,.791522,-.0590121,.407691,.11541,.791878,-.0654876,.407748,.12939,.792361,-.0725207,.407849,.144237,.792942,-.0799844,.407963,.159924,.79362,-.0877896,.408087,.176425,.794529,-.0958451,.408259,.193733,.795521,-.103827,.408362,.211756,.796778,-.111937,.408482,.230524,.798027,-.120521,.408547,.249967,.799813,-.129242,.408721,.269926,.802387,-.138048,.409148,.290338,.805279,-.147301,.409641,.311193,.809251,-.155895,.410154,.333611,.813733,-.163942,.410297,.357615,.819081,-.171666,.410373,.382339,.825427,-.178905,.410348,.407828,.83172,-.185812,.409486,.434034,.83877,-.192318,.408776,.460493,.845817,-.198249,.407176,.487346,.854664,-.204034,.405719,.514832,.863495,-.208908,.403282,.542401,.871883,-.212765,.399293,.570683,.88065,-.214911,.393803,.599947,.89004,-.216214,.387536,.62932,.898476,-.216745,.379846,.658319,.906738,-.216387,.370625,.687138,.914844,-.215053,.360139,.71601,.923877,-.212007,.348849,.745124,.931925,-.207481,.335639,.773366,.938054,-.202418,.320798,.801636,.943895,-.196507,.304772,.829055,.949468,-.189009,.288033,.856097,.955152,-.180539,.270532,.88301,.959403,-.171437,.251639,.909296,.963309,-.161661,.232563,.934868,.967399,-.150425,.213231,.959662,.972009,-.138659,.194247,.98302,.97433,-.126595,.174718,1.00517,.975823,-.113205,.155518,1.02566,.976371,-.0996096,.136709,1.04418,.978705,-.0860754,.117571,1.06146,.981477,-.0714438,.0980046,1.07777,.984263,-.0572304,.0782181,1.09214,.988423,-.0428875,.0584052,1.10553,.993,-.0282442,.038522,1.11758,.99704,-.0140183,.0190148,1.12864,.999913,369494e-9,-145203e-9,1.13901,.777662,-84153e-10,.423844,154403e-10,.770458,-211714e-9,.419915,38845e-8,.770716,-846888e-9,.420055,.00155386,.770982,-.00190567,.420202,.00349653,.770981,-.00338782,.420201,.00621606,.77098,-.00529338,.4202,.00971274,.770983,-.00762223,.4202,.0139867,.770985,-.0103741,.420198,.0190381,.770996,-.0135489,.4202,.0248677,.771029,-.0171461,.420212,.0314764,.771052,-.0211647,.420215,.0388648,.771131,-.0256048,.420245,.047036,.771235,-.0304647,.420284,.0559911,.771383,-.0357436,.420341,.0657346,.771591,-.0414392,.420423,.0762694,.771819,-.0475462,.420506,.0875984,.772123,-.0540506,.420617,.099727,.772464,-.060797,.42072,.112637,.772855,-.0675393,.420799,.126313,.773317,-.0748323,.420893,.140824,.773981,-.0825681,.421058,.15617,.774746,-.0906307,.421226,.172322,.77566,-.0988982,.421397,.189253,.776837,-.106994,.421569,.206912,.778097,-.115528,.421704,.225359,.779588,-.124317,.421849,.24447,.781574,-.133139,.422097,.264156,.784451,-.142179,.422615,.284318,.787682,-.15165,.423269,.304902,.792433,-.160771,.424396,.3265,.797359,-.169166,.424772,.35014,.803986,-.177149,.425475,.374768,.809504,-.184745,.424996,.399928,.815885,-.19173,.424247,.425796,.823513,-.198525,.423515,.452287,.832549,-.204709,.422787,.479321,.841653,-.210447,.421187,.506718,.850401,-.215501,.418519,.53432,.859854,-.219752,.414715,.56242,.869364,-.222305,.409462,.591558,.878837,-.223744,.402926,.621074,.888636,-.224065,.395043,.650538,.898132,-.223742,.38564,.679538,.907181,-.222308,.375378,.708674,.915621,-.219837,.363212,.737714,.9239,-.215233,.349313,.767014,.931644,-.209592,.334162,.795133,.938887,-.203644,.317943,.823228,.945282,-.196349,.300581,.850822,.950758,-.18742,.282195,.877594,.956146,-.177879,.262481,.904564,.960355,-.167643,.242487,.930741,.965256,-.156671,.222668,.955868,.968029,-.144123,.201907,.979869,.97251,-.131305,.18202,1.00291,.974925,-.118335,.161909,1.02392,.975402,-.103714,.142129,1.0433,.976987,-.089415,.122447,1.06089,.979677,-.0748858,.102248,1.07713,.983184,-.0596086,.0814851,1.09218,.987466,-.0447671,.0609484,1.10585,.992348,-.0295217,.0401835,1.11829,.996674,-.0143917,.0198163,1.12966,1.00003,321364e-9,-149983e-9,1.1402,.757901,-869074e-11,.436176,151011e-10,.751195,-217848e-9,.432317,378533e-9,.751178,-871373e-9,.432307,.0015141,.751195,-.00196061,.432317,.0034068,.751198,-.00348552,.432318,.00605659,.751195,-.00544599,.432315,.00946353,.751207,-.00784203,.43232,.013628,.751213,-.0106732,.43232,.0185499,.751221,-.0139393,.432319,.0242302,.751244,-.0176398,.432325,.0306694,.7513,-.0217743,.432348,.0378698,.751358,-.0263412,.432367,.0458321,.751458,-.0313396,.432404,.0545587,.751608,-.0367682,.432464,.0640543,.7518,-.0426246,.43254,.0743222,.752065,-.0489031,.432645,.0853668,.752376,-.0555828,.432762,.0971911,.752715,-.0623861,.432859,.109768,.753137,-.069415,.432958,.123126,.753676,-.0770039,.433099,.137308,.754345,-.084971,.433272,.15229,.755235,-.0932681,.433504,.168075,.756186,-.10171,.433693,.184625,.757363,-.110019,.433857,.201897,.75884,-.11887,.434102,.220014,.760467,-.127881,.434306,.238778,.762969,-.136766,.434751,.258172,.765823,-.14612,.43529,.278062,.769676,-.15566,.436236,.298437,.774909,-.165177,.437754,.319532,.77994,-.17402,.438343,.342505,.785757,-.182201,.438609,.366693,.792487,-.190104,.438762,.391668,.80038,-.197438,.438795,.417494,.808494,-.204365,.438226,.443933,.817695,-.210714,.437283,.470929,.828111,-.216651,.436087,.498569,.837901,-.221804,.433717,.526165,.847813,-.226318,.430133,.554155,.858314,-.229297,.425213,.582822,.868891,-.230999,.418576,.612847,.878941,-.231155,.410405,.642445,.888809,-.230935,.400544,.672024,.898089,-.229343,.389613,.701366,.908081,-.226886,.377197,.730763,.916819,-.222676,.363397,.759642,.924968,-.216835,.347437,.788775,.932906,-.210245,.32995,.817135,.940025,-.202992,.312262,.844912,.946101,-.19436,.293313,.872164,.952835,-.184125,.273638,.899443,.957347,-.173657,.252385,.926389,.961434,-.162204,.231038,.951947,.965522,-.14979,.209834,.976751,.969412,-.136307,.188821,1.00022,.973902,-.122527,.168013,1.02229,.974045,-.108213,.147634,1.04199,.975775,-.0927397,.12705,1.06019,.978383,-.0778212,.106309,1.07711,.98211,-.0621216,.0849279,1.09245,.986517,-.0463847,.0633519,1.10651,.991696,-.0309353,.0419698,1.11903,.996349,-.0150914,.0206272,1.13073,1.00003,442449e-9,-231396e-9,1.14146,.727498,-885074e-11,.441528,145832e-10,.730897,-223525e-9,.443589,368298e-9,.730796,-893996e-9,.443528,.00147303,.730805,-.00201149,.443533,.00331433,.730814,-.00357596,.443538,.00589222,.730815,-.00558734,.443538,.00920678,.730822,-.00804544,.44354,.0132582,.730836,-.0109501,.443545,.0180468,.730848,-.0143008,.443546,.0235732,.730871,-.0180969,.443552,.0298382,.730915,-.022338,.443567,.0368438,.730982,-.0270225,.443591,.044591,.731076,-.0321491,.443627,.0530831,.731245,-.0377166,.443699,.0623243,.73144,-.0437216,.443777,.0723181,.7317,-.0501576,.443881,.0830691,.732034,-.0569942,.444014,.0945809,.732388,-.0638756,.444113,.106825,.732853,-.071203,.444247,.119859,.733473,-.0790076,.444442,.13369,.734195,-.0871937,.444645,.148304,.735069,-.095696,.444877,.163702,.736169,-.10426,.445133,.179861,.73747,-.112853,.44537,.196778,.738991,-.12199,.445651,.214496,.740865,-.131153,.445958,.232913,.743637,-.140245,.446548,.251977,.746797,-.149722,.447246,.271551,.751517,-.159341,.448656,.291774,.756156,-.169106,.449866,.312455,.761519,-.178436,.450919,.334552,.768295,-.186904,.451776,.358491,.776613,-.195117,.452832,.383446,.783966,-.202695,.45249,.408945,.793542,-.20985,.452587,.435364,.803192,-.216403,.451852,.462336,.813892,-.22251,.450708,.48987,.824968,-.227676,.4486,.517697,.835859,-.232443,.445156,.545975,.846825,-.235775,.440351,.574483,.858085,-.237897,.433641,.604246,.868825,-.238074,.425354,.634101,.879638,-.237661,.415383,.664201,.889966,-.236186,.404136,.693918,.899479,-.233599,.390917,.723481,.908769,-.229737,.376352,.75258,.917966,-.223836,.360372,.781764,.926304,-.217067,.342551,.811139,.934626,-.209309,.324238,.839585,.941841,-.20071,.304484,.867044,.94789,-.190602,.283607,.894579,.954196,-.179253,.262205,.921743,.958383,-.167646,.239847,.948026,.963119,-.155073,.218078,.973296,.966941,-.141426,.195899,.998135,.970836,-.126849,.174121,1.02021,.973301,-.112296,.153052,1.04085,.97448,-.0964965,.131733,1.05946,.977045,-.080489,.10997,1.07693,.980751,-.064844,.0881657,1.09254,.985475,-.0481938,.0657987,1.10697,.991089,-.0319185,.0435215,1.12004,.996122,-.0158088,.0214779,1.13173,1.00001,372455e-9,-200295e-9,1.14291,.708622,-907597e-11,.45304,141962e-10,.711162,-228911e-9,.454662,358052e-9,.709812,-914446e-9,.453797,.00143034,.709865,-.00205819,.453834,.00321935,.709864,-.00365894,.453833,.00572331,.709855,-.00571692,.453826,.00894278,.709862,-.00823201,.453828,.012878,.709875,-.011204,.453832,.0175295,.709896,-.0146323,.453839,.0228978,.709925,-.0185163,.453847,.0289839,.709974,-.0228551,.453866,.0357894,.710045,-.0276473,.453892,.0433161,.710133,-.032891,.453924,.0515665,.710292,-.0385851,.453992,.0605458,.710485,-.0447254,.45407,.0702574,.710769,-.0513051,.454192,.0807077,.711106,-.0582733,.454329,.091896,.711516,-.0652866,.45446,.103814,.712071,-.0728426,.454653,.116508,.712676,-.0808307,.45484,.129968,.713476,-.0892216,.455096,.144206,.714377,-.0979047,.455346,.159212,.715579,-.106531,.455647,.174973,.716977,-.115492,.455961,.191504,.71862,-.124821,.456315,.208835,.72084,-.134079,.4568,.226869,.723786,-.143427,.457521,.245582,.727464,-.153061,.458475,.264957,.732771,-.162768,.460239,.284948,.736515,-.172627,.460899,.30522,.743519,-.182487,.463225,.326717,.750041,-.191295,.464027,.350113,.758589,-.199746,.465227,.374782,.767703,-.207584,.465877,.400226,.777484,-.214973,.465996,.426442,.788792,-.221796,.466019,.453688,.800194,-.228038,.465083,.481246,.811234,-.233346,.462506,.509086,.822859,-.238073,.459257,.537338,.835082,-.241764,.454863,.566108,.846332,-.244241,.448163,.595126,.858355,-.244736,.439709,.625574,.87034,-.244278,.429837,.65617,.881027,-.24255,.418002,.686029,.891007,-.239912,.404325,.716039,.900874,-.236133,.389222,.745518,.911072,-.230672,.373269,.775026,.920359,-.22356,.355083,.804521,.928604,-.215591,.335533,.834045,.937175,-.206503,.315278,.861612,.942825,-.196684,.293653,.889131,.949805,-.185116,.271503,.916853,.955535,-.172703,.248821,.943541,.959843,-.159978,.225591,.970132,.964393,-.146375,.202719,.994709,.968008,-.131269,.179928,1.0186,.971013,-.11569,.158007,1.03928,.973334,-.1003,.13624,1.05887,.975775,-.0833352,.1138,1.07652,.979579,-.0668981,.0913141,1.09297,.984323,-.0500902,.0683051,1.10734,.990351,-.0332377,.0451771,1.12084,.995823,-.0161491,.0221705,1.13296,1.0001,234083e-9,-108712e-9,1.14441,.683895,-924677e-11,.46015,137429e-10,.68833,-233383e-9,.463134,346865e-9,.688368,-933547e-9,.463159,.00138748,.688367,-.00210049,.463159,.00312187,.688369,-.00373415,.463159,.00555004,.688377,-.00583449,.463163,.00867216,.688386,-.00840128,.463166,.0124884,.688398,-.0114343,.463169,.0169993,.688418,-.0149329,.463175,.0222054,.688453,-.0188964,.463188,.028108,.688515,-.0233239,.463214,.0347085,.68857,-.0282136,.463231,.0420091,.688679,-.033564,.463276,.0500132,.688854,-.0393733,.463356,.0587255,.689038,-.0456354,.46343,.0681476,.689321,-.0523433,.463553,.0782897,.689662,-.059412,.463693,.0891501,.690188,-.0665736,.4639,.100735,.690755,-.0743106,.464107,.113074,.691405,-.0824722,.464329,.126161,.692198,-.0910484,.464585,.140007,.693196,-.0998778,.464893,.154612,.69454,-.108651,.465285,.169984,.695921,-.117855,.465596,.186106,.697749,-.12734,.466056,.203034,.700375,-.136714,.466771,.220703,.703395,-.146386,.467579,.239062,.707904,-.156096,.469067,.258188,.711673,-.165904,.469851,.277759,.717489,-.175812,.471815,.297935,.724051,-.185931,.47389,.318916,.731965,-.195238,.47587,.341591,.741151,-.204021,.477523,.366062,.751416,-.212113,.478881,.391396,.761848,-.21979,.479226,.417599,.771886,-.2267,.478495,.444401,.783998,-.232991,.477622,.472084,.796523,-.238645,.475833,.500193,.808851,-.243396,.472568,.52865,.821191,-.247226,.467857,.557362,.834261,-.250102,.461871,.586768,.846762,-.251056,.453543,.617085,.859867,-.250604,.443494,.647659,.871948,-.248783,.431711,.678119,.882967,-.245855,.417911,.708399,.892826,-.242168,.401993,.738256,.90332,-.237062,.385371,.767999,.913633,-.22997,.366837,.798191,.922774,-.221687,.346372,.827756,.931371,-.212345,.325682,.856425,.938929,-.20206,.303665,.884299,.944821,-.190981,.280786,.912023,.951792,-.178065,.2573,.939669,.957712,-.164634,.233448,.96655,.961912,-.150863,.209504,.992366,.966382,-.13577,.18597,1.01633,.969588,-.119593,.162905,1.03843,.971777,-.103203,.14053,1.05841,.97433,-.0865888,.117909,1.07632,.978686,-.0690829,.0944101,1.09326,.983281,-.0516568,.0705671,1.10796,.989562,-.034558,.0468592,1.12182,.995465,-.0167808,.0229846,1.1342,.999991,373016e-9,-235606e-9,1.1459,.662251,-939016e-11,.468575,132714e-10,.666634,-237624e-9,.471675,335842e-9,.666411,-950385e-9,.471516,.00134321,.666399,-.00213833,.471509,.00302221,.666386,-.0038014,.471499,.00537283,.666405,-.00593958,.471511,.00839533,.666406,-.00855253,.471508,.0120898,.666428,-.0116401,.471519,.0164569,.666444,-.0152015,.471522,.0214971,.66649,-.0192362,.471543,.027212,.666537,-.0237428,.471558,.033603,.666617,-.0287198,.471591,.0406728,.666718,-.0341647,.471631,.0484238,.666889,-.0400759,.47171,.0568621,.667104,-.0464479,.471805,.0659915,.667374,-.0532677,.471923,.0758178,.667772,-.0603805,.472098,.0863425,.668371,-.0677392,.472363,.0975917,.668971,-.0756028,.472596,.109567,.669696,-.0839293,.472869,.122272,.670481,-.0926683,.473126,.135718,.6715,-.1016,.473442,.149914,.672911,-.110566,.47389,.164882,.674512,-.119984,.474354,.180602,.67651,-.129574,.474922,.19711,.679292,-.139106,.475764,.214371,.682798,-.148993,.476886,.232405,.686955,-.158737,.478179,.251153,.691406,-.168754,.479432,.270436,.697438,-.178703,.481481,.290374,.704761,-.188955,.484143,.311044,.713599,-.198814,.487007,.333003,.723194,-.207869,.488962,.357144,.732601,-.216189,.489815,.382169,.744193,-.22398,.490888,.408227,.754907,-.231156,.490355,.434928,.767403,-.23747,.489548,.462599,.78107,-.243503,.488274,.490908,.793893,-.248114,.484843,.519421,.807296,-.25222,.4803,.548561,.820529,-.255265,.474097,.577772,.833716,-.256741,.466041,.607782,.848403,-.25637,.456547,.638807,.860755,-.254804,.443946,.670058,.874012,-.251834,.430852,.700749,.885619,-.247867,.414903,.731446,.896069,-.242634,.397276,.761191,.906266,-.236093,.378535,.791053,.916759,-.227543,.358038,.821298,.92523,-.21783,.335705,.850747,.93436,-.207534,.313797,.879258,.941631,-.195983,.289671,.907734,.947564,-.183567,.265319,.935206,.953681,-.169345,.240815,.962739,.960008,-.154909,.216119,.989227,.964145,-.140161,.192096,1.01465,.968171,-.123411,.167855,1.03737,.969859,-.106525,.144817,1.05767,.972666,-.0891023,.12149,1.0761,.977055,-.0718094,.0975306,1.09336,.982527,-.0534213,.0730217,1.10878,.989001,-.0355579,.0483366,1.12285,.99512,-.0176383,.023938,1.13548,1.00007,368831e-9,-211581e-9,1.14744,.651047,-960845e-11,.484101,12922e-9,.644145,-241347e-9,.478968,324578e-9,.64396,-965142e-9,.478831,.00129798,.64396,-.00217154,.47883,.00292046,.643968,-.00386049,.478835,.00519202,.643974,-.00603186,.478838,.0081128,.643977,-.0086854,.478836,.011683,.643982,-.0118207,.478834,.0159031,.644024,-.0154374,.478856,.0207743,.644059,-.0195343,.478868,.0262975,.644122,-.0241103,.478896,.0324747,.644207,-.0291638,.478933,.039309,.64432,-.0346919,.478981,.0468029,.644481,-.0406919,.479053,.0549614,.644722,-.047159,.479169,.0637909,.645013,-.0540748,.479302,.0732974,.645503,-.0612001,.479541,.0834898,.646117,-.0687303,.479829,.0943873,.646707,-.0767846,.480061,.105991,.647431,-.0852465,.480343,.11831,.64831,-.0940719,.48066,.131348,.649486,-.103056,.481083,.14514,.650864,-.112261,.481528,.159676,.652604,-.121852,.482102,.174979,.654825,-.131505,.482813,.191079,.657876,-.141189,.483876,.207927,.661339,-.151239,.48499,.225586,.665463,-.161091,.486279,.243947,.670542,-.171235,.487968,.262957,.677361,-.181347,.49053,.282781,.685672,-.191679,.493862,.303311,.694551,-.201781,.49699,.324607,.703753,-.211164,.498884,.347916,.713703,-.219675,.500086,.372628,.725911,-.227836,.501554,.398694,.73862,-.23533,.502193,.425529,.752118,-.241786,.501811,.453209,.76579,-.247865,.500185,.481381,.779568,-.252696,.497159,.51011,.793991,-.256802,.492765,.539322,.808182,-.259942,.486827,.569078,.821698,-.261703,.478386,.598818,.836009,-.262006,.468772,.629762,.849824,-.260333,.456352,.661366,.863888,-.257398,.442533,.69295,.876585,-.253264,.426573,.723608,.888665,-.248026,.408964,.754378,.899537,-.241487,.389677,.784761,.9094,-.233463,.368516,.814688,.920166,-.223397,.346624,.845009,.928899,-.21255,.322717,.874431,.937156,-.200869,.298698,.902922,.943861,-.188387,.273491,.931356,.949557,-.174341,.247866,.958854,.955862,-.158994,.222496,.986098,.961721,-.143664,.197522,1.01229,.965976,-.127412,.17302,1.03571,.968652,-.109798,.148954,1.05699,.971084,-.0916787,.125044,1.07587,.975584,-.0739634,.100577,1.09372,.98122,-.055322,.0753666,1.10948,.988253,-.0366825,.0498899,1.12394,.99482,-.0180389,.024611,1.13694,1.00001,229839e-9,-188283e-9,1.14919,.613867,-964198e-11,.479449,123452e-10,.621485,-244534e-9,.485399,313091e-9,.621429,-978202e-9,.485353,.00125245,.62112,-.00220004,.485114,.00281687,.621119,-.0039111,.485112,.00500783,.621122,-.00611091,.485112,.00782498,.621133,-.00879922,.485117,.0112687,.621152,-.0119756,.485125,.0153394,.621183,-.0156396,.485139,.0200382,.621227,-.0197898,.485158,.0253663,.621298,-.0244253,.485192,.0313261,.621388,-.0295441,.485233,.0379204,.621507,-.0351432,.485286,.0451523,.621693,-.0412198,.485378,.0530277,.621933,-.0477673,.485495,.0615522,.622232,-.0547574,.485635,.0707316,.622809,-.0619417,.485943,.0805883,.623407,-.069625,.486232,.0911267,.62406,-.077796,.486516,.102354,.624835,-.0863731,.486838,.114279,.625758,-.095251,.487188,.126902,.627043,-.104299,.487695,.140285,.628438,-.113724,.488163,.154397,.630325,-.123417,.488858,.169267,.632801,-.133137,.489754,.184941,.635784,-.143052,.490815,.20136,.639406,-.153132,.492048,.218643,.643872,-.163143,.49363,.236615,.6499,-.17333,.496009,.255449,.657201,-.183622,.498994,.275006,.666221,-.194019,.502888,.295354,.674419,-.204192,.505459,.316244,.683729,-.21406,.507771,.33849,.695584,-.222854,.510245,.363166,.708583,-.231315,.512293,.389071,.721233,-.238911,.512747,.415737,.735134,-.245657,.512482,.443331,.750179,-.251879,.511526,.471891,.765073,-.256911,.508935,.500892,.779794,-.261144,.504341,.530294,.794801,-.264316,.498515,.560144,.810339,-.266276,.491015,.590213,.824818,-.266981,.481126,.620865,.839375,-.265778,.468685,.652687,.853043,-.262748,.453925,.684759,.867335,-.258474,.437912,.716209,.88037,-.253187,.419648,.747508,.891711,-.246476,.39982,.77797,.902896,-.238735,.37879,.808586,.913601,-.22885,.355891,.838843,.923019,-.217656,.331773,.869014,.933432,-.205539,.307356,.898512,.939691,-.192595,.281321,.9269,.946938,-.178945,.255441,.955297,.952372,-.163587,.229013,.983231,.95909,-.147214,.203179,1.00971,.963675,-.13064,.17792,1.03438,.968247,-.113121,.152898,1.05625,.97001,-.0945824,.128712,1.07598,.974458,-.0755648,.103349,1.094,.980168,-.0571998,.0776731,1.1104,.987295,-.0377994,.0514445,1.12491,.994432,-.0186417,.025429,1.13851,.999975,542714e-9,-282356e-9,1.15108,.592656,-980249e-11,.486018,119532e-10,.598467,-247275e-9,.490781,301531e-9,.597934,-988317e-9,.490343,.00120517,.597903,-.00222366,.490319,.0027116,.597913,-.00395315,.490327,.00482077,.597919,-.00617653,.490329,.00753264,.597936,-.00889375,.490339,.0108478,.597956,-.0121043,.490347,.0147668,.597992,-.0158073,.490365,.0192905,.598032,-.0200017,.490382,.0244204,.598109,-.0246865,.49042,.0301593,.598215,-.0298594,.490474,.03651,.59833,-.0355167,.490524,.0434757,.598525,-.0416559,.490624,.0510629,.598778,-.0482692,.490753,.0592781,.599135,-.0553114,.49094,.0681304,.599802,-.062542,.491328,.0776467,.600361,-.0703638,.491598,.0878184,.60101,-.0786256,.491882,.0986573,.601811,-.0872962,.492232,.11018,.602861,-.0962284,.492684,.1224,.604167,-.10538,.493213,.135354,.605693,-.114896,.493799,.149034,.607682,-.124654,.494576,.163469,.610672,-.13456,.4959,.178747,.613313,-.144581,.496713,.194723,.617603,-.154703,.498499,.211617,.622174,-.16489,.500188,.229183,.628855,-.175164,.503072,.247786,.636963,-.185565,.506798,.267116,.644866,-.195911,.509719,.28702,.653741,-.206104,.512776,.307763,.664942,-.216447,.516812,.329631,.67633,-.22552,.519181,.353515,.690012,-.234316,.521681,.379226,.704243,-.242032,.523129,.405901,.719396,-.249172,.523768,.433585,.734471,-.255543,.522541,.462085,.750539,-.260697,.520217,.491233,.766365,-.26501,.516293,.521094,.781677,-.268409,.509708,.551014,.797132,-.270399,.501944,.581463,.812655,-.271247,.492025,.612402,.828592,-.270708,.480424,.643798,.844044,-.268085,.465955,.67682,.857305,-.263459,.448425,.708496,.87114,-.258151,.430243,.74046,.884936,-.251171,.410578,.771583,.895772,-.243305,.38862,.802234,.906961,-.234037,.365214,.833179,.917775,-.222714,.34116,.86353,.927883,-.210175,.31572,.893557,.936617,-.196925,.289159,.922976,.943384,-.182788,.261996,.951606,.949713,-.167965,.235324,.979958,.955818,-.151109,.208408,1.00765,.961344,-.133834,.182591,1.03329,.965469,-.115987,.156958,1.0557,.968693,-.09746,.132239,1.07583,.973165,-.0778514,.106195,1.09451,.979387,-.0585067,.0797669,1.11137,.98671,-.0390409,.0530263,1.12643,.994093,-.019408,.0263163,1.14016,1.00002,540029e-9,-194487e-9,1.15299,.574483,-989066e-11,.494533,114896e-10,.574478,-249127e-9,.494528,289403e-9,.574607,-996811e-9,.494637,.00115797,.574396,-.00224241,.494458,.00260498,.574377,-.00398632,.49444,.00463102,.574386,-.00622836,.494445,.00723623,.574401,-.0089683,.494453,.010421,.574419,-.0122056,.49446,.0141859,.574459,-.0159396,.494481,.0185322,.574525,-.0201692,.49452,.0234617,.574587,-.0248924,.494547,.0289762,.574697,-.0301074,.494604,.0350797,.574853,-.0358114,.494688,.0417767,.575027,-.041999,.494772,.0490718,.575294,-.0486618,.494915,.0569728,.575733,-.0557148,.495173,.0654955,.576356,-.0630489,.495537,.0746612,.576944,-.0709285,.495836,.0844615,.57765,-.0792723,.496177,.0949142,.578491,-.0880167,.496563,.10603,.579639,-.0969462,.497096,.117841,.580989,-.10622,.497684,.130367,.582587,-.115861,.498337,.143609,.584951,-.125605,.499414,.157625,.587602,-.135608,.500518,.172413,.59076,-.145742,.501767,.187999,.594992,-.155934,.503542,.20445,.600656,-.166303,.506135,.221764,.607816,-.176681,.509542,.24002,.61522,-.187071,.51263,.258992,.623702,-.197465,.516021,.278773,.634192,-.207816,.520422,.299377,.644936,-.218183,.524073,.320802,.657888,-.2278,.528049,.34384,.670666,-.236747,.52986,.36916,.685626,-.24484,.531892,.395867,.701304,-.252071,.532727,.423488,.717727,-.258714,.532146,.452201,.733914,-.264211,.529883,.481579,.750529,-.26859,.5259,.511558,.76747,-.272046,.51999,.542042,.785189,-.274225,.513083,.572799,.800954,-.275189,.502936,.603816,.816962,-.274946,.490921,.635461,.83336,-.272695,.47684,.6676,.848143,-.268223,.459405,.70051,.861818,-.262768,.440319,.732902,.876828,-.255872,.420123,.765084,.889312,-.247703,.398379,.796391,.900412,-.238381,.374496,.827333,.912251,-.227783,.349874,.858385,.921792,-.214832,.323181,.888652,.931273,-.200949,.296624,.917763,.940295,-.186537,.269211,.947878,.946812,-.171538,.241447,.977016,.953588,-.155254,.213829,1.00501,.958841,-.137156,.186807,1.03179,.963746,-.118699,.160706,1.05502,.966468,-.0998358,.135504,1.07568,.971178,-.0805186,.109131,1.09479,.97831,-.0599348,.0818293,1.1123,.985886,-.0399661,.0545872,1.12771,.994021,-.0198682,.0269405,1.14186,1.00009,271022e-9,-12989e-8,1.15514,.538716,-990918e-11,.486732,109675e-10,.550656,-250642e-9,.497518,277412e-9,.55057,-.00100265,.497441,.00110974,.550903,-.00225672,.497733,.00249779,.550568,-.00401046,.497438,.00443906,.550574,-.00626613,.49744,.00693637,.550591,-.0090226,.497449,.00998921,.550623,-.0122795,.497469,.0135984,.550667,-.0160361,.497495,.0177654,.550724,-.0202908,.497526,.0224915,.550792,-.0250421,.497557,.0277795,.550918,-.0302878,.49763,.0336334,.551058,-.0360241,.497701,.0400573,.551276,-.0422473,.497824,.0470585,.551551,-.0489441,.497977,.0546433,.552074,-.0559596,.498312,.0628367,.552681,-.0633978,.498679,.071646,.553324,-.0713176,.499031,.0810746,.554011,-.0797268,.499365,.091129,.55488,-.0885238,.499779,.101837,.556171,-.0974417,.500444,.113239,.557498,-.106841,.501025,.125316,.559299,-.116533,.501864,.138128,.561647,-.126298,.502967,.151695,.564347,-.136388,.504129,.16604,.567863,-.146576,.505713,.181207,.572569,-.156832,.507953,.197259,.578919,-.167323,.511186,.214258,.585387,-.177712,.514042,.232038,.593134,-.188184,.517484,.250733,.603295,-.198717,.522345,.270454,.613854,-.209177,.526751,.290807,.626092,-.219644,.531595,.312202,.637868,-.229494,.534721,.334435,.652458,-.238718,.538304,.359184,.666985,-.247061,.539875,.385637,.683301,-.254652,.541042,.41328,.69998,-.261376,.540735,.441903,.717824,-.267085,.539139,.471609,.734617,-.271465,.534958,.501446,.753663,-.27528,.53032,.532571,.770512,-.277617,.522134,.563641,.787356,-.278525,.51206,.595067,.806252,-.278512,.50119,.627226,.822061,-.277023,.486791,.659402,.838959,-.273175,.470467,.692874,.85379,-.267238,.450688,.725702,.868268,-.260327,.429741,.75832,.881994,-.251946,.407223,.790189,.893885,-.242432,.383214,.821625,.905118,-.231904,.357297,.853011,.916045,-.219545,.330733,.883773,.927614,-.205378,.303916,.914435,.936005,-.190388,.275941,.944502,.944533,-.1749,.247493,.974439,.950758,-.158588,.218996,1.00286,.957078,-.141027,.191559,1.0304,.962448,-.121507,.164457,1.05466,.964993,-.102068,.138636,1.0761,.970017,-.0822598,.111861,1.09541,.97661,-.062033,.0843438,1.11317,.985073,-.0409832,.0558496,1.12911,.993515,-.020146,.0275331,1.1438,1.00006,27329e-8,-107883e-9,1.15736,.525324,-999341e-11,.498153,105385e-10,.526513,-251605e-9,.499277,265329e-9,.526517,-.00100641,.499282,.0010613,.526588,-.00226466,.499337,.00238823,.526539,-.0040255,.499302,.00424535,.526547,-.00628954,.499306,.00663364,.526561,-.00905628,.499313,.00955337,.526593,-.0123253,.499334,.0130054,.526642,-.0160957,.499365,.0169911,.5267,-.0203661,.499396,.0215122,.526792,-.0251347,.499451,.0265718,.526904,-.0303985,.499511,.0321732,.527079,-.0361554,.499617,.0383231,.527285,-.0423982,.499731,.045026,.527602,-.0491121,.499924,.0522936,.528166,-.0561127,.500306,.0601528,.52879,-.0635988,.5007,.0686059,.529421,-.071581,.501048,.0776518,.530144,-.0799854,.501421,.0873148,.531062,-.0888032,.501884,.0976084,.532374,-.0977643,.50259,.108588,.533828,-.107197,.50329,.120234,.53581,-.116887,.504312,.132602,.538063,-.126755,.505365,.145721,.5409,-.136819,.506668,.159617,.544882,-.147117,.508731,.174369,.550238,-.157446,.511601,.190028,.556038,-.167988,.514431,.206587,.563031,-.178364,.517808,.224046,.571543,-.189007,.521937,.242503,.582255,-.199546,.527415,.261977,.59272,-.210084,.531682,.282162,.605648,-.220448,.537123,.303426,.61785,-.230593,.540664,.325323,.632223,-.240238,.544467,.348993,.648819,-.24887,.547594,.375462,.665825,-.256657,.54912,.403024,.683389,-.263711,.549294,.431773,.701495,-.269666,.547649,.461494,.719197,-.274169,.543786,.491623,.737906,-.278124,.538644,.522994,.756652,-.280632,.531057,.554775,.775279,-.281741,.521972,.586441,.792688,-.281652,.509613,.618596,.811894,-.280345,.496497,.651462,.827938,-.277128,.47968,.684023,.844837,-.271646,.460688,.718024,.859239,-.264397,.438872,.751207,.874088,-.256144,.41577,.784232,.887693,-.246311,.391369,.816191,.899402,-.235497,.365872,.847828,.910973,-.223631,.338618,.87934,.92204,-.209874,.310803,.910325,.930987,-.194265,.281802,.940695,.94,-.178125,.252836,.970958,.948018,-.161479,.224239,1.00078,.955141,-.144038,.195857,1.0288,.960513,-.124915,.168487,1.05371,.963964,-.104284,.141495,1.07596,.968713,-.0838732,.114437,1.09628,.975524,-.0635579,.0863105,1.11448,.98431,-.042291,.0574774,1.13069,.992916,-.0209131,.0284343,1.14568,.999926,743097e-9,-379265e-9,1.15955,.501042,-998428e-11,.498726,100306e-10,.502992,-252112e-9,.500665,253283e-9,.502417,-.00100791,.500092,.00101259,.502965,-.00226919,.500621,.00227978,.502318,-.00403109,.499994,.00405011,.502333,-.00629832,.500005,.00632868,.502362,-.00906907,.500027,.00911446,.502369,-.0123423,.500023,.0124078,.50243,-.0161178,.500066,.016211,.502493,-.0203937,.500103,.0205256,.502592,-.0251684,.500166,.0253548,.502707,-.0304389,.50023,.0307029,.502881,-.0362015,.500335,.0365753,.503124,-.0424507,.500488,.0429798,.503443,-.0491582,.500686,.0499268,.504083,-.0561476,.501155,.0574541,.504668,-.0636846,.501524,.0655408,.505319,-.0716834,.501904,.0742072,.50609,-.0800925,.502321,.0834699,.507122,-.0888425,.502896,.0933603,.508414,-.097855,.503603,.10391,.509955,-.107304,.504416,.115113,.512061,-.116921,.505565,.127054,.514419,-.12689,.506732,.139709,.517529,-.136934,.508338,.153173,.522085,-.147327,.510987,.167528,.526986,-.157612,.513527,.182708,.533122,-.168213,.516717,.198881,.540807,-.178688,.520832,.215986,.550687,-.189511,.52632,.234335,.560567,-.199998,.531009,.253375,.571698,-.210652,.535839,.273499,.584364,-.220917,.541091,.294355,.599066,-.23137,.546875,.316525,.614148,-.241206,.551306,.339671,.631157,-.250379,.555187,.36531,.647919,-.258397,.556595,.392767,.666112,-.265528,.556949,.421397,.686158,-.271827,.556617,.451433,.704838,-.27674,.552975,.482131,.723957,-.280733,.547814,.513458,.74262,-.283359,.53997,.545446,.762009,-.284541,.530422,.57775,.781314,-.284507,.518546,.610434,.799116,-.283309,.504178,.643178,.817604,-.280378,.48843,.676248,.83459,-.275619,.469457,.709698,.850974,-.26856,.447698,.744245,.866747,-.260094,.424791,.777695,.881412,-.249929,.399913,.810392,.8936,-.239137,.37308,.842872,.905943,-.226818,.345705,.874677,.916408,-.213699,.31706,.906257,.927215,-.198428,.288444,.936881,.935625,-.181643,.258329,.96795,.944076,-.164386,.228488,.998216,.951229,-.146339,.199763,1.02689,.958793,-.127709,.172153,1.0535,.963219,-.107244,.144989,1.07646,.967562,-.0857764,.11685,1.09675,.974866,-.0645377,.0880571,1.11576,.983353,-.0431732,.0587352,1.13227,.992503,-.0218356,.0294181,1.1478,1.00003,605203e-9,-231013e-9,1.16207,.482935,-101177e-10,.504695,968142e-11,.477554,-251521e-9,.499071,240676e-9,.477904,-.00100683,.499436,96342e-8,.478368,-.00226636,.499899,.0021687,.477977,-.00402719,.499513,.00385384,.477993,-.00629226,.499525,.0060221,.478011,-.00906011,.499536,.00867289,.478051,-.0123305,.499566,.0118074,.478089,-.016102,.499587,.0154269,.478171,-.0203736,.499645,.0195341,.478254,-.025143,.499692,.0241318,.47839,-.0304071,.499779,.0292247,.478588,-.0361631,.499911,.0348196,.478812,-.0424023,.500046,.0409231,.479208,-.0490724,.500326,.047552,.479841,-.0560722,.500805,.0547377,.480392,-.0636125,.501152,.0624607,.481068,-.0716134,.501561,.0707473,.481898,-.0800062,.502054,.0796118,.483022,-.0886568,.502728,.0890974,.484332,-.0977553,.503479,.0992099,.486126,-.107173,.504546,.10999,.488066,-.11677,.50557,.121476,.490521,-.126725,.506849,.133672,.494232,-.136793,.50911,.146731,.498302,-.147116,.511345,.160577,.503565,-.157446,.514344,.175335,.510902,-.168121,.518824,.191207,.519263,-.178799,.523666,.208058,.528204,-.189407,.528296,.225875,.538854,-.200145,.533724,.244782,.551278,-.210701,.539833,.264753,.565222,-.221303,.546131,.285745,.579403,-.231688,.551496,.307592,.595469,-.241718,.556809,.330582,.610929,-.250992,.559641,.354995,.629433,-.259602,.562379,.382471,.648504,-.267038,.563676,.411126,.66756,-.273388,.562092,.440924,.689143,-.278788,.560807,.472118,.709056,-.282783,.555701,.503774,.729855,-.285836,.548698,.536364,.748954,-.287078,.538544,.56895,.768373,-.287133,.526711,.601991,.78827,-.285839,.512511,.635403,.807465,-.283238,.496323,.668797,.825194,-.27906,.477638,.702584,.842203,-.272286,.456253,.736393,.857749,-.263854,.432412,.77096,.874799,-.253943,.407806,.80489,.887497,-.24237,.38033,.83771,.89966,-.230278,.352446,.870376,.911753,-.21646,.323268,.902256,.923011,-.202071,.294314,.933306,.932375,-.185519,.264104,.965177,.940537,-.167604,.234035,.996303,.948904,-.149068,.20412,1.0261,.955263,-.129539,.175431,1.05304,.960303,-.109932,.148116,1.07617,.965512,-.0880572,.119693,1.09742,.973466,-.0660548,.0901619,1.11721,.98284,-.0439228,.0599875,1.13436,.992216,-.0219588,.0298975,1.15006,.999946,119402e-9,-208547e-10,1.16471,.447827,-100414e-10,.491543,914833e-11,.454778,-251257e-9,.499172,22891e-8,.453519,-.00100342,.497787,914184e-9,.45357,-.00225776,.497847,.00205701,.453578,-.00401371,.497855,.00365705,.45357,-.00627107,.497841,.00571453,.453598,-.00902968,.497864,.00823019,.453627,-.0122888,.497882,.0112049,.453684,-.0160475,.497923,.0146405,.453764,-.0203044,.49798,.0185394,.453866,-.0250576,.498049,.0229054,.453996,-.0303028,.49813,.0277424,.454196,-.0360379,.498267,.0330587,.454457,-.0422521,.498445,.0388613,.454926,-.0488393,.498812,.0451767,.455525,-.0558653,.499272,.0520153,.456074,-.0633772,.499625,.0593754,.456752,-.0713606,.500049,.0672751,.457648,-.07971,.500615,.0757447,.458849,-.0883032,.501399,.0848231,.46029,-.0974095,.502293,.0945135,.462,-.106729,.503301,.104848,.464121,-.116354,.504533,.115884,.466889,-.126214,.506172,.127652,.470744,-.136324,.508667,.14024,.47488,-.146595,.510995,.153673,.480845,-.157027,.514832,.168053,.488262,-.167658,.519506,.183508,.496547,-.178343,.524347,.199948,.506254,-.188916,.52983,.217503,.517961,-.199975,.536357,.236272,.531484,-.210624,.543641,.256096,.545496,-.221227,.550048,.277085,.559497,-.231568,.555076,.298615,.575752,-.241698,.560541,.321547,.591999,-.251172,.564156,.345602,.610654,-.260178,.567607,.371851,.630484,-.268094,.56923,.40076,.651807,-.274661,.569779,.430801,.67239,-.280331,.566791,.461939,.693024,-.284501,.562007,.493854,.715473,-.287852,.555791,.526992,.736323,-.28929,.546345,.560102,.755771,-.289405,.534,.593543,.775424,-.2881,.519114,.627256,.795447,-.285562,.502543,.661464,.815319,-.281416,.484773,.695206,.831769,-.275523,.463445,.729044,.849464,-.267516,.440269,.764069,.866775,-.257584,.415049,.799089,.881252,-.245817,.388049,.831948,.894209,-.233127,.35889,.865526,.906922,-.219579,.329915,.89818,.919686,-.204491,.300441,.930013,.929044,-.188962,.269445,.962061,.938393,-.171079,.238402,.994214,.94661,-.15199,.208204,1.02533,.953095,-.131953,.178653,1.0529,.958644,-.111233,.150684,1.0771,.963925,-.0903098,.122359,1.09855,.971995,-.0680505,.0923342,1.11874,.981658,-.0448512,.0614195,1.13635,.991649,-.0221931,.0303582,1.15238,.999985,393403e-9,-111086e-9,1.16772,.396806,-971563e-11,.457671,842355e-11,.429186,-249421e-9,.495017,21625e-8,.429324,-998052e-9,.495173,865322e-9,.429175,-.00224487,.494999,.00194637,.429129,-.00399041,.494952,.00346004,.429153,-.00623476,.494974,.00540684,.429168,-.0089773,.494983,.00778714,.429207,-.0122175,.495012,.0106022,.429257,-.0159542,.495047,.0138535,.429338,-.0201864,.495106,.0175443,.429431,-.0249104,.495165,.0216774,.429587,-.0301252,.495279,.0262594,.429796,-.0358249,.495432,.0312968,.430065,-.0419972,.495621,.0367985,.430588,-.0485144,.496061,.042798,.43113,-.0555028,.496472,.0492914,.431743,-.0629852,.496904,.0562907,.432448,-.0709256,.497369,.0638056,.433414,-.0791942,.498032,.071885,.434638,-.0877346,.498854,.0805517,.43611,-.0968056,.499812,.0898047,.437859,-.106002,.500891,.0997142,.440017,-.115648,.502198,.110289,.443236,-.125427,.504389,.121644,.44697,-.135492,.506809,.133769,.451689,-.145746,.509858,.146787,.45811,-.156219,.514247,.160793,.465305,-.166834,.518816,.175791,.474085,-.177546,.524331,.191906,.484808,-.188262,.53104,.209199,.49732,-.199346,.538511,.227825,.509693,-.209951,.544554,.247269,.524367,-.220533,.551616,.267978,.539228,-.231082,.557368,.289672,.55644,-.241342,.563782,.31268,.574204,-.250964,.568851,.33651,.593388,-.260306,.57312,.362219,.613358,-.268667,.574916,.390322,.634512,-.275591,.575053,.420478,.65563,-.281328,.572404,.451614,.678265,-.285948,.568893,.484112,.70011,-.289408,.561878,.517348,.723005,-.291328,.55359,.551355,.743744,-.291418,.541099,.585109,.763949,-.290252,.526489,.619487,.784186,-.287648,.509496,.65404,.804304,-.283782,.491484,.688649,.823629,-.278067,.470517,.723133,.84094,-.270588,.44705,.757163,.857852,-.261188,.421252,.792816,.874934,-.249313,.394191,.827248,.888709,-.236492,.365359,.861074,.902589,-.222185,.336016,.894417,.914201,-.207314,.30527,.926825,.925978,-.191146,.274532,.9595,.93512,-.174135,.243393,.991583,.943656,-.155231,.212414,1.02356,.951719,-.134403,.182005,1.05239,.957164,-.113023,.153043,1.07754,.962656,-.0914493,.124186,1.09984,.970695,-.0694179,.0941654,1.12,.980749,-.0466199,.0629671,1.13849,.991205,-.0227032,.0311146,1.15494,.999884,632388e-9,-254483e-9,1.1706,.379821,-957289e-11,.460637,789337e-11,.405188,-247483e-9,.491396,204064e-9,.404796,-989434e-9,.490914,815853e-9,.40483,-.00222607,.490949,.00183559,.40473,-.00395723,.49084,.00326332,.404731,-.00618287,.490836,.00509945,.404768,-.00890258,.490871,.00734463,.404791,-.0121156,.490883,.00999992,.404857,-.0158214,.490938,.0130676,.404943,-.0200178,.491004,.0165503,.405059,-.0247027,.491093,.0204521,.405213,-.0298729,.491205,.0247788,.405399,-.0355226,.491333,.0295373,.405731,-.0416352,.491604,.034741,.406303,-.0480807,.492116,.0404255,.406814,-.0550458,.492506,.0465732,.407404,-.0624652,.492926,.0532058,.408149,-.0702958,.493442,.0603442,.409128,-.0784623,.494136,.0680297,.410408,-.087007,.495054,.0762786,.411813,-.0959639,.495962,.0851046,.413735,-.105075,.497257,.0945878,.416137,-.114646,.498882,.104725,.41934,-.124394,.501132,.11563,.423326,-.134328,.503883,.127325,.428419,-.14458,.50747,.139911,.43484,-.154979,.511964,.153481,.442641,-.165628,.517328,.168114,.452511,-.176365,.524258,.183995,.463473,-.187298,.531248,.200953,.475564,-.198244,.538367,.219176,.488664,-.208938,.545175,.238514,.504073,-.219599,.553227,.259129,.520832,-.230378,.560653,.280997,.538455,-.240703,.567523,.303821,.55709,-.250548,.573287,.327948,.576646,-.259964,.577795,.353362,.596705,-.268721,.580077,.380336,.618053,-.276054,.58018,.4101,.640303,-.282176,.578747,.44161,.662365,-.286931,.574294,.474106,.684542,-.290521,.567035,.507549,.707984,-.292672,.558687,.541853,.730913,-.293189,.547606,.576581,.752948,-.292199,.533471,.61172,.773452,-.289508,.516395,.646339,.794715,-.285716,.497873,.682131,.814251,-.280051,.476845,.716396,.833057,-.272873,.453449,.751503,.84959,-.263982,.427857,.786085,.867022,-.252745,.400335,.821355,.882277,-.239655,.371304,.85646,.895375,-.225386,.340397,.890828,.909347,-.209587,.310005,.923532,.921885,-.193433,.2796,.956419,.932127,-.176135,.247276,.989445,.941869,-.157872,.216186,1.02221,.949735,-.137577,.185602,1.05195,.956617,-.115285,.155767,1.07822,.961974,-.0928418,.126103,1.10149,.96972,-.0700592,.0956758,1.12207,.98012,-.0474671,.0643269,1.1408,.990825,-.0238113,.0320863,1.1577,.999876,381574e-9,-812203e-10,1.17403,.367636,-961342e-11,.469176,753287e-11,.380377,-244772e-9,.485434,191797e-9,.380416,-978857e-9,.485475,767015e-9,.380376,-.00220165,.485435,.00172522,.380419,-.00391408,.485487,.00306734,.380438,-.00611549,.485505,.00479332,.380462,-.00880558,.485525,.00690391,.380496,-.0119837,.485551,.00940039,.38056,-.0156487,.485605,.0122848,.38064,-.0197988,.485666,.0155601,.380767,-.0244324,.48577,.0192313,.380909,-.0295444,.485871,.0233032,.381142,-.0351321,.48606,.0277861,.381472,-.0411535,.486336,.0326939,.382015,-.0475408,.486833,.0380565,.382523,-.0544395,.487231,.0438615,.383129,-.061784,.487683,.0501332,.383952,-.0695085,.488313,.0568996,.38498,-.0775819,.489077,.0641952,.386331,-.0860443,.490113,.0720324,.387788,-.0948406,.491099,.0804379,.389808,-.103899,.492566,.0894899,.39252,-.113313,.494601,.0992098,.395493,-.123007,.496619,.109641,.399826,-.132859,.499912,.120919,.405341,-.143077,.504061,.133107,.411932,-.153465,.508905,.146263,.420591,-.164108,.515482,.160544,.43101,-.174893,.523191,.176123,.441881,-.185839,.53026,.192757,.453919,-.196633,.537295,.210535,.468715,-.207611,.546156,.229886,.485182,-.218517,.555173,.250543,.501926,-.229249,.562728,.27221,.51785,-.239481,.567494,.294892,.536947,-.249395,.573889,.318987,.557115,-.259,.578831,.344348,.577966,-.268075,.582055,.371223,.599489,-.276115,.583307,.399834,.62479,-.282523,.583902,.431415,.647504,-.287663,.57953,.464301,.670601,-.291538,.573103,.498123,.693539,-.293842,.563731,.532662,.717385,-.294681,.553169,.567925,.741533,-.293717,.539908,.603502,.762142,-.291156,.521902,.639074,.783014,-.28719,.502815,.674439,.805158,-.281773,.482598,.710497,.823646,-.274682,.458949,.7456,.841879,-.266184,.433129,.781085,.859515,-.255682,.406064,.816,.875335,-.242849,.376509,.851074,.890147,-.228329,.345502,.886473,.903144,-.212491,.31428,.920751,.916618,-.195695,.282994,.954606,.927953,-.178267,.251091,.988402,.937414,-.159549,.219107,1.02141,.946823,-.140022,.18896,1.05167,.954651,-.118154,.158667,1.07819,.959955,-.0946636,.128808,1.1025,.96858,-.0711792,.0973787,1.12391,.97938,-.0475046,.0650965,1.14322,.990498,-.024059,.0326267,1.16077,.999844,-512408e-10,112444e-9,1.17727,.316912,-934977e-11,.425996,695559e-11,.356423,-241372e-9,.479108,179562e-9,.356272,-965292e-9,.478897,71811e-8,.356262,-.00217182,.478894,.00161574,.356265,-.00386092,.478895,.00287261,.356278,-.0060324,.478905,.00448907,.356293,-.00868565,.478914,.00646572,.356346,-.0118207,.478965,.00880438,.356395,-.0154355,.479001,.0115066,.356484,-.019529,.479075,.0145762,.356609,-.0240991,.47918,.018018,.356766,-.0291413,.479305,.0218379,.357009,-.0346498,.479512,.0260454,.357424,-.0405462,.479909,.0306657,.357899,-.0468825,.480337,.0357054,.358424,-.0536887,.480771,.0411728,.359041,-.0609416,.481242,.0470841,.359903,-.0685239,.481943,.0534831,.360932,-.0764883,.482741,.0603795,.362196,-.0848364,.483688,.0678028,.363847,-.0935002,.484947,.0758086,.365972,-.102471,.486588,.0844173,.368741,-.111751,.488787,.0937199,.372146,-.121334,.491405,.103732,.377114,-.131147,.495604,.114608,.38226,-.141213,.499436,.126345,.389609,-.151632,.505334,.139116,.397925,-.162073,.51168,.152995,.407824,-.172819,.518876,.168071,.420014,-.183929,.527639,.184495,.434266,-.195032,.537588,.20232,.447352,-.205792,.544379,.221189,.463726,-.216704,.553422,.241616,.481406,-.227531,.562074,.263298,.498707,-.238017,.568227,.286116,.518039,-.247936,.574473,.3101,.538277,-.257437,.579191,.335401,.561166,-.266829,.584807,.362246,.583189,-.275329,.586476,.390609,.606024,-.28234,.585578,.420998,.632419,-.287924,.584496,.454357,.656128,-.291972,.577766,.488233,.679953,-.29456,.56875,.523248,.704654,-.295816,.558388,.559168,.729016,-.295157,.544826,.595326,.752062,-.292779,.528273,.631864,.773138,-.288681,.508482,.667793,.794869,-.283358,.487341,.704035,.815101,-.27608,.46354,.739925,.834212,-.26767,.438672,.775539,.852368,-.257397,.411239,.810895,.870207,-.245689,.3829,.846472,.884063,-.231452,.351496,.881788,.898284,-.215561,.31895,.917438,.912964,-.198208,.287367,.952422,.924666,-.180426,.254487,.987551,.934429,-.161525,.222226,1.02142,.943485,-.141197,.191143,1.05218,.9521,-.120085,.161112,1.07937,.957876,-.0975881,.130982,1.10403,.966943,-.0726842,.0990553,1.12616,.978313,-.0483705,.0662818,1.14619,.990048,-.0239072,.0329243,1.16413,.999984,461885e-9,-772859e-10,1.18099,.321287,-935049e-11,.455413,659662e-11,.332595,-237513e-9,.471437,167562e-9,.332729,-949964e-9,.471618,670192e-9,.332305,-.00213618,.471028,.00150712,.332326,-.00379765,.471055,.00267959,.332344,-.00593353,.471072,.00418751,.332356,-.00854349,.471077,.00603172,.332403,-.0116268,.471121,.00821362,.332461,-.0151824,.47117,.0107357,.332552,-.0192088,.471251,.0136014,.332657,-.0237024,.47133,.0168152,.332835,-.0286615,.471487,.0203853,.333083,-.0340765,.471708,.0243212,.333547,-.0398563,.47219,.0286518,.333989,-.0460916,.472587,.0333763,.334532,-.0527897,.473054,.0385084,.335167,-.0599284,.473568,.0440638,.33608,-.0673514,.474362,.0500962,.337146,-.0752237,.475231,.0566022,.338462,-.083418,.476282,.0636272,.34014,-.0919382,.477615,.0712153,.342341,-.100741,.479404,.079417,.345088,-.109905,.481618,.0882631,.349049,-.119369,.485081,.0978851,.353939,-.129033,.489317,.108336,.359893,-.139038,.494309,.119698,.366945,-.149411,.499983,.132024,.375814,-.159843,.507185,.145558,.387112,-.170664,.516392,.160433,.40023,-.181897,.526519,.176648,.412555,-.192785,.53423,.193922,.427023,-.203663,.542741,.212662,.443685,-.214695,.552066,.232944,.461499,-.225561,.560762,.254495,.480975,-.236257,.569421,.277531,.501,-.24639,.576101,.301724,.521691,-.256101,.581493,.327112,.543478,-.265289,.585221,.353917,.566094,-.273938,.587614,.381941,.589578,-.281679,.587991,.41172,.614583,-.287655,.585928,.444148,.641813,-.292228,.582092,.478617,.666189,-.295172,.57398,.51397,.690475,-.29648,.561676,.550118,.715543,-.296203,.548758,.586933,.740405,-.293999,.532792,.62384,.762183,-.28998,.512735,.660723,.786069,-.28478,.492402,.69807,.806812,-.277568,.469058,.734422,.826987,-.268951,.443017,.770946,.844588,-.259049,.415501,.80699,.863725,-.2471,.387328,.842107,.879137,-.234157,.356108,.878078,.894634,-.218719,.324315,.914058,.909162,-.201293,.291813,.949922,.92072,-.18267,.258474,.985337,.93158,-.163212,.225593,1.0205,.941238,-.142771,.193986,1.05273,.949293,-.120956,.163392,1.08075,.956226,-.0985743,.132934,1.10559,.96546,-.075118,.101255,1.12823,.977403,-.0497921,.0675441,1.149,.989648,-.0241574,.0334681,1.16765,1.00001,5762e-7,-184807e-9,1.18519,.303474,-916603e-11,.4542,61243e-10,.308894,-232869e-9,.462306,155592e-9,.309426,-931661e-9,.463093,622499e-9,.308643,-.0020949,.461933,.00139979,.308651,-.0037242,.461941,.00248874,.308662,-.00581873,.46195,.00388933,.308687,-.00837818,.461974,.00560247,.308728,-.0114016,.462011,.00762948,.308789,-.0148884,.462067,.00997326,.308882,-.0188369,.462151,.0126375,.309007,-.0232436,.462263,.0156271,.30918,-.0281054,.462417,.0189498,.309442,-.0334065,.462667,.0226167,.309901,-.0390589,.463162,.0266614,.310331,-.0452042,.463555,.0310715,.310858,-.0517735,.464019,.0358698,.311576,-.0587359,.464669,.0410848,.312436,-.0660383,.465406,.0467453,.313526,-.0737266,.466339,.0528718,.314903,-.0817574,.467504,.0595039,.316814,-.090167,.469226,.0666888,.318965,-.0987555,.470981,.0744658,.322077,-.107792,.473814,.082912,.325947,-.117098,.477241,.0920846,.331008,-.126602,.48184,.102137,.337893,-.136619,.488334,.113135,.345106,-.146838,.494415,.12511,.355111,-.157357,.503275,.138356,.365095,-.167955,.510966,.152686,.378344,-.179157,.521508,.16856,.391599,-.190143,.530455,.18561,.407786,-.20123,.541275,.204308,.425294,-.212456,.551784,.224623,.444021,-.223568,.561493,.246172,.463418,-.234154,.569886,.268979,.484077,-.244546,.577116,.293411,.505513,-.254301,.582914,.318936,.527672,-.263564,.587208,.345856,.550565,-.272332,.589277,.374054,.573656,-.280011,.588426,.403276,.59827,-.286924,.587504,.43474,.624731,-.291994,.583401,.468767,.652396,-.295159,.576997,.504411,.67732,-.296954,.565863,.54114,.703147,-.296877,.552316,.57816,.728715,-.295147,.536773,.616124,.752448,-.291275,.51771,.653885,.775169,-.285905,.496087,.691537,.799307,-.279064,.474232,.729251,.819482,-.270294,.447676,.766267,.837659,-.260032,.419656,.802616,.856903,-.248497,.391328,.838583,.873325,-.235252,.360285,.874711,.889788,-.221126,.329215,.91077,.904486,-.204304,.296392,.94653,.917711,-.185562,.262159,.983828,.928969,-.165635,.229142,1.01955,.939707,-.14442,.19673,1.05317,.948167,-.122147,.165095,1.0823,.955222,-.099098,.13451,1.10791,.964401,-.0755332,.102476,1.1312,.976605,-.0513817,.0689667,1.15218,.989085,-.0258499,.034506,1.17129,.999908,617773e-9,-271268e-9,1.18961,.285803,-905752e-11,.452348,572272e-11,.284689,-22732e-8,.450581,143626e-9,.285263,-910214e-9,.451482,575099e-9,.285302,-.00204784,.451553,.00129395,.285318,-.00364057,.451574,.0023006,.28533,-.00568813,.451585,.00359547,.285361,-.00819001,.451618,.00517934,.285397,-.0111458,.45165,.007054,.285447,-.0145536,.451688,.00922167,.285527,-.0184127,.451758,.0116869,.285688,-.0227207,.451929,.0144555,.28584,-.0274712,.452055,.0175341,.286136,-.0326278,.452369,.0209406,.286574,-.0381792,.452853,.0246965,.287012,-.0441879,.453272,.0287996,.287542,-.0506096,.453752,.033268,.288299,-.0573634,.454488,.0381504,.289186,-.0645458,.455294,.0434447,.290302,-.0720405,.456301,.0491973,.291776,-.0799046,.457648,.0554453,.29372,-.088117,.459483,.0622311,.296052,-.0965328,.461571,.0695992,.299563,-.105409,.465085,.077658,.30335,-.114553,.468506,.0864176,.309167,-.123917,.474423,.0961078,.31529,-.13381,.47995,.106643,.324163,-.144021,.488592,.118322,.333272,-.154382,.496461,.131133,.344224,-.165015,.50562,.145208,.357733,-.176168,.516719,.16073,.373046,-.187468,.528513,.177807,.38788,-.198488,.537713,.196072,.405133,-.209545,.547999,.21605,.423845,-.220724,.55759,.237484,.443777,-.231518,.566246,.26039,.464824,-.242035,.574326,.284835,.486635,-.251898,.58037,.310518,.51012,-.261304,.58568,.337678,.535301,-.270384,.590197,.366242,.559193,-.27841,.590569,.395873,.583544,-.285325,.588161,.426857,.608834,-.291113,.584249,.459477,.635753,-.294882,.57763,.494734,.664367,-.297088,.569479,.532023,.689688,-.297364,.555064,.569629,.715732,-.295949,.539522,.608124,.741307,-.292259,.521613,.646231,.764949,-.287063,.49969,.684938,.788599,-.28012,.476747,.723548,.81048,-.27153,.45116,.761135,.831372,-.261289,.424101,.798916,.850092,-.249559,.39443,.835952,.867777,-.236348,.363849,.871606,.884632,-.221569,.332477,.907843,.90047,-.20618,.300667,.944187,.914524,-.188771,.266552,.981371,.926892,-.168362,.232349,1.01841,.937951,-.146761,.199359,1.05308,.947236,-.123813,.1675,1.0839,.954367,-.099984,.136166,1.11047,.963907,-.0759278,.103808,1.13414,.976218,-.0511367,.0697061,1.15575,.988772,-.0267415,.0352529,1.17531,.999888,-520778e-9,289926e-9,1.19389,.263546,-883274e-11,.441896,526783e-11,.262352,-221849e-9,.439889,132311e-9,.262325,-886683e-9,.439848,528824e-9,.26228,-.00199476,.439765,.00118975,.262372,-.00354671,.439922,.00211568,.26239,-.00554141,.439941,.00330652,.262412,-.00797888,.439961,.00476346,.262453,-.0108584,.440002,.00648818,.262528,-.0141788,.440085,.0084835,.262615,-.017938,.440166,.0107533,.262744,-.0221346,.440291,.0133044,.262939,-.026762,.440493,.0161445,.263277,-.0317573,.440889,.0192974,.26368,-.0371832,.441338,.0227699,.264106,-.0430371,.441753,.0265698,.264624,-.0493035,.442227,.0307178,.265378,-.0558669,.442985,.0352616,.266253,-.0628718,.443795,.0401968,.267478,-.0701569,.445008,.04559,.269062,-.077845,.446599,.0514539,.270926,-.0857941,.448349,.0578382,.273693,-.0940773,.451221,.0648363,.276746,-.102704,.454097,.0724389,.281693,-.111735,.459517,.0808744,.287335,-.121004,.46531,.0901551,.29448,-.130734,.472605,.100371,.30257,-.140777,.480251,.111644,.312465,-.15111,.489444,.124111,.324856,-.16189,.500919,.137979,.33774,-.172946,.511317,.153163,.35255,-.184152,.522684,.169817,.367786,-.19522,.53248,.187886,.385474,-.20632,.543326,.207634,.404976,-.217744,.554109,.229165,.425203,-.228691,.563395,.252068,.446704,-.239299,.571565,.276471,.468951,-.249348,.577935,.302323,.493487,-.258933,.584309,.329882,.517861,-.268009,.58773,.358525,.543309,-.276238,.589612,.388585,.569704,-.28356,.589294,.419787,.594871,-.289497,.585137,.452114,.622555,-.294452,.580356,.486466,.651167,-.296918,.57185,.523079,.677332,-.297647,.558428,.5611,.703718,-.296321,.542232,.599592,.730262,-.293339,.524541,.639138,.754304,-.288036,.502691,.677978,.778051,-.281018,.479212,.716537,.801557,-.272414,.454071,.75586,.822559,-.262419,.425952,.794477,.843051,-.250702,.397313,.832664,.86232,-.237264,.366534,.869876,.879044,-.222716,.334816,.906973,.896362,-.206827,.303143,.943558,.910342,-.189659,.269699,.979759,.924119,-.171108,.236411,1.01718,.935374,-.149579,.202224,1.05289,.944295,-.126295,.16989,1.08496,.952227,-.101511,.138089,1.11256,.962041,-.0766392,.105053,1.1375,.97528,-.0511967,.070329,1.15983,.988476,-.025463,.0351268,1.17987,.999962,286808e-10,145564e-10,1.19901,.227089,-841413e-11,.404216,472707e-11,.239725,-215083e-9,.426708,120833e-9,.239904,-860718e-9,.427028,483555e-9,.239911,-.00193661,.427039,.00108806,.239914,-.00344276,.42704,.00193457,.239933,-.00537907,.427064,.00302363,.239944,-.00774482,.427065,.00435604,.239993,-.01054,.427122,.00593398,.240052,-.0137626,.427179,.00775987,.240148,-.0174115,.427279,.00983854,.240278,-.021484,.42741,.0121763,.240472,-.0259729,.427618,.0147827,.240839,-.0308131,.428086,.0176837,.241201,-.0360893,.428482,.0208775,.241626,-.0417723,.428907,.0243821,.242207,-.0478337,.42952,.0282228,.24298,-.0542199,.430332,.0324333,.243881,-.0610015,.431222,.0370252,.245123,-.0680874,.432512,.0420535,.24667,-.0755482,.434088,.0475414,.248779,-.0832873,.436323,.0535542,.251665,-.0913546,.439509,.0601716,.255305,-.0998489,.443478,.0674282,.260049,-.108576,.448713,.0754673,.266192,-.117754,.455524,.084339,.273158,-.127294,.4627,.0941683,.282131,-.137311,.472068,.10515,.293332,-.147736,.483565,.117402,.304667,-.158357,.493702,.130824,.317785,-.169274,.504708,.145724,.333245,-.180595,.517107,.16215,.349843,-.191892,.528849,.180149,.367944,-.203168,.540301,.199746,.387579,-.214443,.551514,.221047,.408247,-.225624,.560906,.243981,.43014,-.236422,.56959,.268513,.452669,-.24654,.576098,.294409,.476196,-.256157,.580925,.322002,.501157,-.265289,.584839,.351052,.527632,-.273671,.587614,.3812,.555754,-.281254,.589119,.412994,.581682,-.287448,.585204,.445498,.608196,-.292614,.579006,.479505,.635661,-.296068,.571297,.514643,.664999,-.297395,.560855,.552213,.691039,-.296645,.544525,.591365,.7179,-.293785,.526535,.630883,.744059,-.289089,.50545,.670932,.76863,-.282239,.482514,.710904,.793273,-.273688,.457246,.750259,.814731,-.26328,.428872,.78948,.835603,-.251526,.399384,.828597,.85489,-.238339,.368811,.866892,.872828,-.223607,.336617,.90563,.889462,-.207538,.303997,.943538,.904929,-.190297,.270812,.980591,.919101,-.172034,.237453,1.01935,.930536,-.152058,.204431,1.05498,.941223,-.129515,.172495,1.08717,.94982,-.104263,.140175,1.11551,.960592,-.0781944,.106465,1.14098,.974629,-.051688,.0711592,1.16418,.98811,-.0253929,.0354432,1.18465,1.00004,804378e-9,-330876e-9,1.20462,.214668,-821282e-11,.406619,433582e-11,.218053,-208144e-9,.413025,109887e-9,.217987,-832212e-9,.412901,439362e-9,.217971,-.00187246,.412876,988623e-9,.217968,-.00332855,.41286,.00175772,.217985,-.00520055,.412882,.00274729,.218014,-.00748814,.412916,.00395842,.218054,-.0101901,.412957,.00539274,.218106,-.0133057,.413005,.00705348,.218217,-.0168342,.413139,.00894581,.218338,-.0207707,.413258,.0110754,.21855,-.0251001,.413509,.0134551,.218913,-.0297861,.413992,.0161081,.219265,-.0348956,.414383,.0190307,.219696,-.0403909,.414839,.0222458,.220329,-.0462003,.415567,.025792,.220989,-.0524208,.41621,.0296637,.222027,-.058948,.417385,.0339323,.223301,-.0658208,.418779,.0386055,.224988,-.0730347,.420665,.0437355,.227211,-.0805274,.423198,.0493844,.230131,-.088395,.426566,.0556135,.233908,-.0966208,.43091,.0624829,.239092,-.105223,.437148,.0701636,.245315,-.11424,.444302,.0786949,.253166,-.12368,.453262,.0882382,.262374,-.133569,.463211,.0988682,.273145,-.143836,.474271,.110727,.285512,-.154577,.4863,.123945,.299512,-.165501,.498817,.138581,.314287,-.176698,.510341,.154676,.331083,-.188066,.522583,.172459,.349615,-.199597,.534879,.191979,.369318,-.210843,.546083,.21309,.390377,-.222068,.5562,.235998,.412411,-.233059,.564704,.260518,.435715,-.24357,.572314,.286795,.461196,-.253356,.579395,.314559,.485587,-.262362,.581985,.343581,.511908,-.270895,.584347,.374367,.539798,-.278452,.58505,.406015,.567974,-.284877,.583344,.439168,.594303,-.290124,.577348,.473005,.622951,-.294183,.570751,.508534,.652404,-.296389,.561541,.544764,.679291,-.296605,.546426,.582927,.706437,-.294095,.528599,.622681,.734485,-.28978,.508676,.663567,.758841,-.283363,.484768,.704092,.78537,-.275015,.460434,.745101,.807315,-.264689,.432166,.784712,.8271,-.252597,.401807,.824241,.849191,-.239154,.371458,.863803,.867046,-.224451,.338873,.903063,.8852,-.208342,.306175,.942763,.901771,-.190684,.272759,.981559,.915958,-.172105,.239306,1.02048,.928046,-.152214,.206071,1.05765,.939961,-.130247,.17367,1.08999,.948711,-.10672,.142201,1.11829,.959305,-.0808688,.108454,1.14467,.973009,-.0539145,.0728109,1.16839,.987631,-.0262947,.0360625,1.19004,.999978,.00132758,-559424e-9,1.21058,.193925,-793421e-11,.391974,392537e-11,.196746,-200315e-9,.397675,991033e-10,.19667,-801099e-9,.397521,396342e-9,.196633,-.00180246,.397445,891829e-9,.196654,-.00320443,.397482,.00158582,.196659,-.00500647,.39748,.00247867,.196683,-.0072086,.397506,.00357167,.196728,-.00981001,.397562,.00486675,.196792,-.0128096,.397633,.00636707,.19689,-.0162055,.397746,.00807752,.197017,-.0199943,.397884,.0100052,.19729,-.024139,.39827,.0121691,.197583,-.0286671,.398639,.0145755,.197927,-.0335858,.399034,.0172355,.198383,-.0388806,.399554,.0201718,.199002,-.0444736,.400289,.0234194,.199739,-.0504583,.401111,.026984,.200784,-.056729,.402349,.0309217,.202075,-.0633643,.403841,.0352496,.203898,-.0703247,.406076,.0400313,.206199,-.0775565,.408841,.0453282,.209252,-.085184,.41259,.0511794,.213638,-.0931994,.418288,.0577459,.21881,-.101617,.424681,.0650508,.225642,-.11052,.433429,.0732759,.233717,-.119772,.442897,.0824683,.242823,-.129505,.452888,.0927484,.254772,-.139906,.466407,.104417,.266603,-.150402,.477413,.117211,.28073,-.161395,.490519,.131598,.295399,-.172465,.50201,.147407,.312705,-.183982,.515311,.165031,.331335,-.195532,.52786,.184336,.351037,-.206971,.5392,.205361,.372175,-.218117,.54941,.228043,.394548,-.229327,.558642,.25267,.419598,-.240052,.567861,.279071,.443922,-.249937,.573332,.306882,.471495,-.259407,.58013,.33661,.496769,-.267749,.580564,.367328,.524951,-.275524,.581696,.399753,.55318,-.282148,.579885,.433134,.581577,-.287533,.575471,.467534,.609231,-.291612,.567445,.502943,.637478,-.293911,.557657,.53871,.667795,-.295096,.546535,.576568,.694272,-.294073,.529561,.614929,.722937,-.290386,.510561,.655909,.749682,-.284481,.487846,.697663,.774754,-.276188,.462487,.738515,.799301,-.266215,.43481,.779802,.820762,-.254116,.404879,.820045,.843231,-.240393,.374559,.860294,.861857,-.225503,.341582,.900965,.880815,-.209382,.308778,.941727,.89766,-.19155,.275232,.980916,.912926,-.172346,.240938,1.02162,.926391,-.151799,.207223,1.0597,.938429,-.129968,.17484,1.09291,.947834,-.10651,.142984,1.12248,.958432,-.0824098,.109902,1.149,.972402,-.0565242,.0744454,1.1733,.987191,-.028427,.0373794,1.19538,.999975,385685e-10,-4203e-8,1.21676,.178114,-766075e-11,.385418,354027e-11,.176074,-191966e-9,.381002,887135e-10,.17601,-767549e-9,.380861,354715e-9,.17598,-.00172696,.380798,798168e-9,.175994,-.00307012,.380824,.00141928,.176017,-.00479684,.380858,.00221859,.176019,-.00690648,.380839,.00319714,.176072,-.00939888,.380913,.0043572,.176131,-.0122726,.380979,.005702,.176239,-.0155264,.38112,.00723689,.176371,-.0191551,.381272,.00896907,.176638,-.023117,.381669,.0109194,.176912,-.0274633,.382015,.0130903,.177279,-.032173,.382476,.0154949,.17774,-.0372219,.383041,.0181669,.178344,-.0426132,.38378,.0211209,.179153,-.0483309,.384773,.0243899,.180197,-.0543447,.386076,.0280062,.181581,-.0607122,.387809,.032004,.18344,-.0673855,.390205,.036453,.186139,-.0743989,.393944,.0414162,.189432,-.0817731,.39832,.0469394,.193795,-.0895464,.404188,.0531442,.199641,-.0978264,.4121,.0601374,.206679,-.106499,.421425,.0680078,.214865,-.115654,.431504,.076919,.224406,-.125268,.442526,.0868835,.235876,-.135475,.455465,.0981875,.248335,-.146023,.4681,.110759,.262868,-.157016,.482069,.124885,.278962,-.168245,.496182,.140645,.295082,-.17958,.507401,.157838,.313738,-.191227,.520252,.17695,.333573,-.202718,.531708,.197817,.356433,-.214424,.544509,.220785,.378853,-.225492,.55373,.245306,.402717,-.236236,.561348,.271593,.428375,-.246568,.568538,.299776,.454724,-.255941,.573462,.329433,.482291,-.264511,.576356,.360598,.509706,-.272129,.576446,.393204,.538805,-.278979,.575298,.427227,.568919,-.284528,.572154,.462157,.596804,-.288801,.564691,.497997,.625987,-.291334,.555134,.534467,.656414,-.292722,.545051,.571736,.683916,-.292185,.528813,.610158,.711809,-.290043,.51106,.649061,.739547,-.285246,.490103,.690081,.766914,-.277647,.465523,.732554,.791375,-.267603,.437718,.773982,.814772,-.256109,.40882,.81609,.836691,-.242281,.377823,.856849,.856984,-.227155,.34496,.898363,.876332,-.210395,.311335,.939471,.894988,-.192612,.277703,.980799,.911113,-.173236,.243019,1.02215,.924092,-.152258,.209037,1.06139,.936828,-.129575,.175909,1.09635,.946869,-.10594,.143852,1.12707,.958284,-.081318,.110289,1.15419,.972325,-.0556133,.0747232,1.17909,.986878,-.0297899,.0383149,1.20163,.999936,-.00197169,912402e-9,1.22338,.151174,-720365e-11,.351531,309789e-11,.155594,-18279e-8,.361806,78608e-9,.156099,-731569e-9,.362982,314615e-9,.156053,-.00164578,.362869,707845e-9,.156093,-.0029261,.362961,.00125884,.156099,-.00457155,.362959,.00196783,.15612,-.00658224,.362982,.00283622,.156168,-.00895774,.363048,.00386625,.156221,-.0116962,.363101,.00506109,.156324,-.0147973,.363241,.00642675,.156476,-.0182503,.363448,.00797175,.156731,-.0220266,.36384,.00971484,.156994,-.026176,.364179,.0116575,.157341,-.0306701,.36462,.0138207,.157867,-.0354591,.365364,.0162356,.15846,-.0406141,.366111,.0189092,.159308,-.0460519,.367248,.021885,.160426,-.0518096,.368767,.0252004,.161877,-.0578906,.370745,.0288825,.163995,-.0642812,.373831,.0330139,.16655,-.0710067,.377366,.0376283,.170237,-.0781522,.382799,.0428493,.175096,-.0857172,.389915,.0487324,.181069,-.0938025,.398487,.0554214,.188487,-.102363,.408799,.0630189,.197029,-.111343,.419991,.071634,.206684,-.120812,.431455,.0812797,.218698,-.131033,.445746,.0923651,.230726,-.141373,.457471,.104545,.245516,-.152387,.472388,.118449,.261551,-.163628,.486671,.133923,.277437,-.174814,.49762,.150849,.296662,-.186713,.51162,.169924,.31795,-.198513,.525435,.190848,.339422,-.210119,.536267,.213504,.362143,-.221354,.545982,.237947,.387198,-.23224,.555364,.264427,.412349,-.24257,.561489,.292519,.439274,-.252284,.566903,.322561,.466779,-.261023,.569614,.353952,.496011,-.26899,.571589,.387278,.524964,-.275498,.570325,.421356,.556518,-.281449,.568792,.457314,.584363,-.285526,.560268,.493199,.614214,-.28844,.55205,.530276,.645684,-.289777,.541906,.56855,.673446,-.289722,.526464,.606927,.701924,-.287792,.509872,.645945,.73037,-.284315,.490649,.685564,.757405,-.278804,.467964,.726511,.784025,-.269543,.441468,.768601,.808255,-.258117,.41216,.811321,.830739,-.244728,.380606,.853496,.851914,-.229428,.348111,.895374,.872586,-.212508,.314732,.937674,.891581,-.194025,.280338,.979869,.907641,-.174711,.245203,1.02253,.922233,-.153509,.21077,1.06371,.935878,-.130418,.177399,1.09972,.946338,-.105558,.144507,1.13124,.957265,-.080059,.110508,1.15973,.971668,-.0539766,.0742311,1.18515,.9866,-.0277101,.0375224,1.20858,1.00021,-515531e-9,135226e-9,1.23135,.137468,-686011e-11,.345041,273315e-11,.13703,-173378e-9,.343936,690761e-10,.136986,-693048e-9,.34383,276126e-9,.136964,-.00155931,.343761,621337e-9,.137003,-.00277211,.343863,.00110494,.137012,-.00433103,.343868,.00172744,.137043,-.00623606,.343916,.00249022,.13709,-.0084868,.343986,.00339559,.137145,-.0110814,.344045,.00444687,.137242,-.0140187,.344177,.00565007,.137431,-.0172713,.344491,.00701868,.137644,-.0208605,.344805,.00856042,.13791,-.024792,.345172,.0102863,.138295,-.0290461,.345734,.0122185,.138764,-.0335957,.346371,.0143771,.139415,-.038467,.347298,.0167894,.140272,-.0436176,.348527,.0194895,.141457,-.0491016,.350276,.0225043,.14303,-.0548764,.352646,.0258962,.145289,-.0610096,.356206,.0297168,.148502,-.0674777,.361488,.0340562,.152188,-.074345,.367103,.0389534,.157359,-.0817442,.375247,.0445541,.16379,-.0896334,.385064,.0509535,.171376,-.098005,.396082,.0582611,.179901,-.106817,.407418,.06654,.189892,-.116239,.420031,.075994,.201838,-.12627,.434321,.0867239,.214311,-.136701,.447631,.0987517,.228902,-.147616,.462046,.112353,.245107,-.158871,.476942,.127605,.262292,-.170261,.490285,.144469,.281215,-.182017,.503783,.163282,.301058,-.193729,.515505,.183873,.322752,-.205512,.52682,.206466,.347547,-.217214,.539473,.231194,.370969,-.227966,.546625,.257288,.397533,-.238555,.55472,.285789,.42398,-.248278,.559468,.315746,.452928,-.257422,.564095,.347724,.482121,-.265306,.565426,.380922,.510438,-.272043,.563205,.415639,.541188,-.277614,.561087,.451702,.571667,-.281927,.554922,.48845,.602432,-.285015,.546838,.526442,.634126,-.286512,.537415,.564896,.662816,-.286388,.522906,.604037,.692411,-.284734,.507003,.643795,.720946,-.281297,.488398,.68298,.748293,-.276262,.466353,.723466,.776931,-.269978,.443573,.764565,.801065,-.260305,.415279,.805838,.825843,-.247426,.384773,.849985,.84807,-.232437,.352555,.893174,.869122,-.215806,.318642,.936564,.888963,-.197307,.28381,.980253,.905547,-.177203,.247888,1.02463,.918554,-.155542,.212904,1.06714,.931395,-.131948,.1787,1.10451,.941749,-.106723,.145902,1.13694,.954551,-.0804939,.111193,1.1666,.970279,-.0534239,.0744697,1.19249,.986117,-.0257452,.0368788,1.21665,.999938,.00190634,-.0010291,1.23981,.118493,-647439e-11,.32272,23772e-10,.118765,-163023e-9,.323456,598573e-10,.118772,-65212e-8,.323477,239447e-9,.118843,-.00146741,.323657,538881e-9,.118804,-.00260846,.323553,95826e-8,.118826,-.00407576,.323595,.00149845,.118846,-.00586826,.323617,.00216047,.118886,-.00798578,.32367,.00294679,.118947,-.0104273,.323753,.00386124,.119055,-.0131909,.323922,.00490999,.119241,-.0162444,.324251,.00610804,.11944,-.0196339,.324544,.00745805,.119739,-.0233378,.325026,.00897805,.12011,-.0273179,.325586,.0106895,.120571,-.0316143,.326231,.0126073,.12124,-.0361939,.327264,.0147654,.122162,-.0410511,.328733,.0172001,.123378,-.0462233,.330659,.0199375,.125183,-.0517109,.333754,.0230498,.127832,-.0575652,.338507,.026597,.130909,-.0637441,.343666,.0306345,.135221,-.0704302,.351063,.035273,.14082,-.0776364,.360604,.0406137,.146781,-.0852293,.369638,.0466788,.155121,-.0935351,.3827,.0537628,.16398,-.102234,.39522,.0617985,.173926,-.111465,.40793,.07097,.185137,-.121296,.42105,.0813426,.19826,-.13169,.435735,.0931596,.212938,-.142614,.450932,.106547,.229046,-.153884,.465726,.121575,.246246,-.165382,.479461,.138286,.264637,-.176806,.492106,.15666,.284959,-.188793,.504774,.17728,.308157,-.200763,.518805,.19988,.330951,-.21239,.528231,.224293,.3549,-.223521,.536376,.250541,.381502,-.234169,.544846,.278902,.409529,-.244077,.551717,.309227,.437523,-.253363,.55517,.341426,.467624,-.261659,.557772,.37518,.497268,-.268498,.556442,.41007,.528294,-.274018,.553915,.446445,.559053,-.278169,.549153,.483779,.589329,-.281229,.539878,.522249,.622503,-.282902,.53162,.561754,.652382,-.282815,.518119,.601544,.681847,-.281247,.502187,.641574,.712285,-.277986,.484824,.682633,.740094,-.273017,.463483,.723426,.768478,-.266692,.441299,.763747,.794556,-.258358,.415238,.805565,.819408,-.248807,.386912,.847254,.843411,-.236214,.356165,.891091,.862397,-.219794,.320562,.936174,.883113,-.201768,.285322,.982562,.90023,-.181672,.249713,1.02862,.915192,-.159279,.214546,1.07163,.928458,-.134725,.180285,1.10995,.94069,-.10913,.147119,1.14354,.953409,-.0821315,.112492,1.17372,.969537,-.0542677,.0752014,1.20043,.985612,-.0259096,.0370361,1.22528,.999835,.00298198,-.00151801,1.24959,.10097,-602574e-11,.300277,202619e-11,.101577,-152164e-9,.302077,511662e-10,.101572,-608889e-9,.302066,204751e-9,.101566,-.00136997,.302047,460753e-9,.101592,-.00243557,.302114,819497e-9,.101608,-.0038053,.30214,.00128154,.101627,-.00547906,.30216,.0018483,.101669,-.00745647,.302224,.00252223,.101732,-.00973615,.302318,.00330716,.101844,-.0123097,.302513,.00421061,.102025,-.0151681,.30285,.00524481,.102224,-.0183334,.303166,.0064154,.102515,-.0217819,.303654,.00774063,.102886,-.0255067,.304243,.0092398,.103395,-.029514,.305089,.0109339,.104109,-.0337912,.306301,.0128561,.105074,-.0383565,.30798,.0150338,.10654,-.0432132,.310726,.0175228,.108478,-.0484244,.314351,.0203648,.111015,-.0539339,.319032,.0236325,.114682,-.0598885,.32605,.0274188,.11911,-.0663375,.334109,.0317905,.124736,-.0733011,.344013,.0368502,.131479,-.0807744,.355358,.0427104,.139283,-.0888204,.367614,.0494788,.148054,-.0973394,.380072,.0572367,.159037,-.10665,.395678,.0662704,.169794,-.116221,.40795,.0763192,.18314,-.126632,.423546,.087956,.197515,-.137383,.438213,.101042,.213514,-.148641,.453248,.115827,.23065,-.160117,.46688,.132283,.249148,-.171807,.479962,.150644,.270219,-.183695,.494618,.171073,.292338,-.195574,.506937,.193378,.314999,-.207205,.516463,.217585,.340991,-.218955,.528123,.24428,.367982,-.229917,.537025,.272784,.39432,-.239737,.541627,.302742,.423364,-.249048,.546466,.335112,.453751,-.257329,.549466,.369032,.48416,-.264623,.549503,.404577,.515262,-.270411,.547008,.441337,.547036,-.274581,.542249,.479162,.576614,-.277266,.533015,.517904,.611143,-.279144,.525512,.558508,.640989,-.279001,.51154,.598995,.671182,-.277324,.495641,.639935,.700848,-.273908,.477526,.681017,.729862,-.269063,.457955,.722764,.758273,-.262282,.434846,.764349,.784121,-.254281,.409203,.806206,.809798,-.24505,.382694,.848617,.834953,-.233861,.354034,.892445,.856817,-.221308,.321764,.936263,.877609,-.205996,.288118,.982401,.897489,-.186702,.253277,1.02975,.913792,-.164618,.217963,1.07488,.92785,-.140023,.183221,1.11487,.940378,-.11328,.149385,1.14947,.95273,-.0853958,.114152,1.1807,.969059,-.0568698,.0769845,1.20912,.985574,-.0276502,.0381186,1.23498,.999943,.00239052,-.00126861,1.25987,.0852715,-560067e-11,.279021,171162e-11,.0854143,-140871e-9,.279483,430516e-10,.0854191,-563385e-9,.2795,172184e-9,.0854188,-.00126753,.279493,387464e-9,.0854229,-.00225337,.279501,68918e-8,.0854443,-.00352086,.279549,.00107803,.0854697,-.00506962,.279591,.00155536,.0855093,-.00689873,.279652,.00212354,.0855724,-.00900821,.279752,.00278703,.0856991,-.0113799,.280011,.0035551,.085855,-.0140314,.280297,.00443449,.0860682,-.016963,.280682,.00543636,.086344,-.0201438,.281159,.0065788,.0867426,-.0235999,.281886,.00787977,.087239,-.0273069,.282745,.0093606,.0879815,-.031269,.284139,.011056,.0891258,-.035531,.28647,.0130065,.0906909,-.0400947,.289708,.0152495,.0927624,-.0449638,.293904,.0178454,.0958376,-.0502427,.300471,.0208915,.0995827,-.0559514,.30806,.0244247,.104526,-.0622152,.317874,.0285721,.110532,-.0690046,.329332,.0334227,.117385,-.0763068,.341217,.0390466,.12522,-.084184,.353968,.0455786,.134037,-.0925248,.366797,.0530773,.144014,-.101487,.380209,.0617424,.156013,-.111273,.395956,.071777,.168872,-.121431,.41053,.0830905,.183089,-.132105,.425073,.0959341,.198763,-.143286,.439833,.110448,.216159,-.154841,.454507,.126769,.234859,-.166588,.468368,.14495,.255879,-.178626,.482846,.165233,.27677,-.190218,.493489,.187217,.301184,-.202227,.506549,.211659,.325852,-.213764,.5158,.237922,.352824,-.22487,.525442,.26632,.380882,-.235246,.532487,.296691,.410137,-.244847,.537703,.329179,.439787,-.253122,.540361,.363135,.472291,-.260517,.542734,.399222,.501856,-.266519,.538826,.436352,.534816,-.270905,.535152,.474505,.565069,-.273826,.525979,.513988,.597154,-.275333,.516394,.554852,.630473,-.275314,.506206,.596592,.660574,-.273323,.489769,.638117,.692015,-.270008,.472578,.680457,.720647,-.265001,.452134,.723008,.750528,-.258311,.430344,.765954,.777568,-.250046,.405624,.809012,.80387,-.240114,.378339,.852425,.828439,-.228737,.349877,.895346,.851472,-.216632,.318968,.940695,.873906,-.202782,.287489,.987235,.89467,-.187059,.254394,1.03348,.912281,-.168818,.221294,1.07812,.927358,-.146494,.18675,1.11928,.940385,-.120009,.152322,1.15609,.952672,-.0917183,.117514,1.18875,.968496,-.0620321,.0797405,1.21821,.985236,-.0314945,.0402383,1.24523,.99998,-575153e-9,110644e-9,1.27133,.0702429,-512222e-11,.255273,140947e-11,.0702981,-128826e-9,.255469,354488e-10,.0703691,-515562e-9,.255727,141874e-9,.0703805,-.00116,.255754,31929e-8,.0703961,-.00206224,.255813,567999e-9,.0704102,-.00322223,.255839,88871e-8,.0704298,-.00463928,.255863,.00128272,.0704759,-.00631375,.255953,.00175283,.0705434,-.00824317,.256079,.00230342,.0706693,-.010412,.25636,.0029443,.0708189,-.0128439,.256647,.00368031,.0710364,-.0155177,.257084,.00452614,.0713223,-.0184374,.257637,.00549706,.0717182,-.0216002,.258416,.00661246,.072321,-.0249966,.259699,.00790147,.0731446,-.0286566,.261475,.0093884,.0743352,-.0325888,.264132,.0111186,.0760676,-.036843,.26815,.013145,.078454,-.0414292,.273636,.0155251,.0818618,-.0464634,.281653,.0183525,.0857382,-.0519478,.289992,.0216642,.0908131,-.0579836,.30066,.0255956,.0967512,-.0645124,.312204,.0301954,.103717,-.0716505,.325001,.0356017,.111596,-.0793232,.338129,.041896,.120933,-.087645,.352853,.0492447,.130787,-.096492,.366192,.0576749,.142311,-.105973,.380864,.0673969,.155344,-.116182,.396575,.0785899,.169535,-.126815,.411443,.0912377,.185173,-.138015,.426256,.105607,.201755,-.149325,.439607,.121551,.221334,-.161207,.455467,.139608,.241461,-.173162,.469096,.159591,.26294,-.18504,.481014,.18156,.286776,-.196881,.493291,.205781,.311596,-.208311,.503556,.231819,.338667,-.219671,.513268,.260274,.366021,-.230451,.519414,.290862,.395875,-.240131,.526766,.323196,.425564,-.248566,.52905,.357071,.457094,-.256195,.530796,.393262,.488286,-.262331,.528703,.430797,.522291,-.267141,.52727,.470231,.554172,-.270411,.519848,.510477,.586427,-.271986,.510307,.551594,.619638,-.27192,.499158,.593849,.650656,-.269817,.483852,.636314,.68284,-.266267,.467515,.679679,.714356,-.26113,.44931,.723884,.742717,-.254067,.425789,.767245,.770894,-.245652,.401144,.811819,.797358,-.235554,.374224,.856315,.823377,-.223896,.346167,.901077,.847456,-.210865,.316056,.946502,.870697,-.196574,.284503,.993711,.891068,-.180814,.251628,1.04134,.909267,-.163314,.219065,1.08609,.925653,-.143304,.186446,1.12702,.940017,-.121322,.153416,1.16371,.952398,-.0973872,.120334,1.19712,.967568,-.0698785,.08352,1.22791,.984772,-.0390031,.0439209,1.25672,1.00026,-.0070087,.00315668,1.28428,.0556653,-459654e-11,.227325,112556e-11,.0565238,-116382e-9,.230826,284985e-10,.0565717,-465666e-9,.231026,114036e-9,.0565859,-.00104773,.231079,256656e-9,.0565761,-.00186255,.231025,45663e-8,.0565913,-.00291002,.231058,714664e-9,.0566108,-.00418998,.231085,.00103224,.0566532,-.00570206,.231169,.00141202,.0567473,-.00743666,.231417,.00186018,.0568567,-.00940298,.231661,.00238264,.0569859,-.0115991,.231895,.00298699,.0572221,-.0140096,.232456,.00368957,.057519,-.0166508,.233096,.00450303,.0579534,-.01951,.234094,.00544945,.0585922,-.0225991,.235629,.00655564,.0595647,-.0259416,.238106,.00785724,.0609109,-.0295661,.241557,.00939127,.0628751,-.0335126,.246652,.0112198,.0656908,-.0378604,.254091,.0134168,.0691347,-.0426543,.262666,.0160374,.0732165,-.0478967,.272029,.0191514,.0782863,-.0536716,.283007,.0228597,.0843973,-.0600683,.295732,.0272829,.0913598,-.0670095,.308779,.032484,.0994407,-.0745516,.322886,.0385886,.108189,-.082712,.336408,.0457133,.118574,-.0914927,.351692,.0539832,.129989,-.100854,.366502,.0635162,.142722,-.110837,.381675,.0744386,.156654,-.121353,.3963,.0868483,.172151,-.132414,.411477,.100963,.188712,-.143809,.42508,.116795,.208093,-.155765,.441328,.134715,.227936,-.167608,.454328,.154396,.249495,-.179579,.467235,.176179,.27362,-.191488,.480248,.200193,.296371,-.202618,.487886,.225775,.324234,-.214133,.499632,.25441,.353049,-.225212,.509532,.285077,.381785,-.234875,.514265,.317047,.414038,-.244205,.521282,.351874,.445251,-.252145,.522931,.388279,.476819,-.258433,.520947,.425825,.509209,-.263411,.517669,.465104,.542759,-.266732,.512841,.505741,.574822,-.268263,.503317,.547611,.609324,-.268489,.493035,.590953,.641772,-.266941,.478816,.63488,.674049,-.263297,.462863,.679072,.705071,-.257618,.442931,.723487,.734709,-.250625,.421299,.768708,.763704,-.24179,.397085,.814375,.791818,-.231115,.370577,.859907,.817439,-.21922,.34232,.906715,.843202,-.205658,.312627,.953943,.866639,-.190563,.280933,1.00185,.888129,-.173978,.248393,1.05105,.907239,-.155485,.216007,1.09704,.923893,-.134782,.183233,1.13857,.938882,-.11249,.150376,1.17539,.952464,-.0890706,.117177,1.20924,.968529,-.0646523,.0813095,1.24055,.984763,-.038606,.0439378,1.27018,1.00053,-.01238,.00598668,1.29873,.0437928,-409594e-11,.204012,879224e-12,.0440166,-103395e-9,.205049,221946e-10,.0440529,-413633e-9,.205225,887981e-10,.0440493,-930594e-9,.2052,199858e-9,.0439884,-.00165352,.204901,355495e-9,.0440716,-.0025849,.205255,556983e-9,.0440968,-.00372222,.205311,805326e-9,.0441359,-.00506478,.205391,.00110333,.0442231,-.00660384,.205638,.00145768,.0443254,-.00835246,.205877,.00187275,.0444832,-.0102992,.20627,.00235938,.0447001,-.0124449,.206796,.0029299,.0450168,-.0147935,.207593,.0036005,.0454816,-.017336,.208819,.00439246,.0462446,-.0201156,.211036,.00533864,.0473694,-.0231568,.214388,.00646984,.0490191,-.0264941,.219357,.00783856,.0512776,-.030184,.226061,.00950182,.0541279,-.0342661,.234094,.0115156,.0578989,-.0388539,.244297,.0139687,.0620835,-.0438735,.254457,.0169015,.0673497,-.04951,.266706,.0204554,.0731759,-.0556263,.278753,.0246606,.0803937,-.0624585,.29309,.0297126,.0879287,-.0697556,.305856,.0355868,.0970669,-.0778795,.321059,.0425768,.106508,-.0863541,.333873,.05056,.11776,-.0955935,.349008,.0598972,.130081,-.105438,.363776,.0706314,.144454,-.115899,.380112,.0828822,.1596,-.126827,.394843,.0967611,.176097,-.138161,.409033,.112381,.194726,-.149904,.424257,.129952,.213944,-.161675,.436945,.149333,.235516,-.173659,.450176,.170892,.260564,-.185963,.466305,.194984,.285183,-.197582,.477328,.220805,.311095,-.208697,.486566,.248694,.338924,-.219519,.494811,.279015,.369757,-.229766,.504065,.311725,.3996,-.238879,.507909,.345844,.430484,-.246802,.509805,.381749,.46413,-.253924,.511436,.420251,.497077,-.259319,.508787,.459957,.530434,-.263297,.50394,.501356,.565725,-.265619,.49804,.544252,.599254,-.265842,.487346,.587856,.631251,-.263978,.472975,.631969,.663972,-.26043,.457135,.677471,.697724,-.255358,.439844,.723744,.727725,-.248308,.417872,.770653,.756417,-.239181,.39273,.817357,.785419,-.22814,.367839,.864221,.81266,-.215681,.339449,.912701,.839391,-.201623,.309279,.962419,.86366,-.185624,.278029,1.0122,.885028,-.16797,.245294,1.06186,.904639,-.148336,.212689,1.10934,.922048,-.12637,.179616,1.15063,.936952,-.102928,.146749,1.18885,.951895,-.0785268,.112733,1.22352,.967198,-.0530153,.0760056,1.25681,.984405,-.02649,.0383183,1.28762,1.00021,70019e-8,-20039e-8,1.31656,.0325964,-355447e-11,.176706,655682e-12,.0329333,-899174e-10,.178527,165869e-10,.0329181,-359637e-9,.178453,663498e-10,.0329085,-808991e-9,.178383,149332e-9,.0329181,-.00143826,.178394,265873e-9,.0329425,-.00224678,.178517,416597e-9,.0329511,-.00323575,.17849,603299e-9,.033011,-.00439875,.178695,829422e-9,.0330733,-.00574059,.178843,.00109908,.0331857,-.00725896,.179176,.00141933,.0333445,-.00895289,.179618,.0017999,.0335674,-.0108219,.180238,.00225316,.033939,-.0128687,.181417,.00279765,.0345239,-.015114,.183395,.0034564,.0354458,-.017596,.186616,.00425864,.0368313,-.0203524,.191547,.00524936,.0386115,-.0234105,.197508,.00647033,.0410303,-.0268509,.205395,.00798121,.0442245,-.0307481,.215365,.0098557,.0478659,-.0350863,.225595,.0121417,.0522416,-.0399506,.236946,.0149385,.0574513,-.045357,.249442,.0183189,.0631208,-.0512863,.261222,.0223644,.0701124,-.0579273,.275418,.0272418,.0777331,-.0650652,.288989,.0329458,.0862709,-.0728813,.302546,.0396819,.096103,-.081363,.317164,.04757,.106976,-.0904463,.331733,.0567012,.119175,-.100105,.34661,.067202,.132919,-.110375,.362249,.0792588,.147727,-.121115,.376978,.0928672,.163618,-.132299,.390681,.108228,.182234,-.143887,.406571,.125502,.201809,-.155827,.42042,.144836,.225041,-.168357,.438411,.166706,.247621,-.18004,.450368,.189909,.27097,-.191536,.460083,.215251,.296658,-.203024,.469765,.243164,.325892,-.214056,.481837,.273388,.35406,-.224104,.487474,.305344,.384372,-.233489,.492773,.339741,.41749,-.241874,.498451,.376287,.45013,-.248834,.499632,.414195,.481285,-.254658,.495233,.454077,.519183,-.259367,.496401,.496352,.551544,-.261818,.487686,.538798,.587349,-.262964,.479453,.583626,.621679,-.262128,.467709,.629451,.654991,-.258998,.452123,.67566,.686873,-.254119,.433495,.723248,.719801,-.246946,.413657,.771156,.750355,-.237709,.390366,.81989,.780033,-.226549,.364947,.868601,.809254,-.214186,.337256,.920034,.836576,-.199639,.307395,.971706,.861774,-.183169,.275431,1.02479,.885707,-.165111,.243431,1.07837,.904742,-.144363,.210921,1.12783,.915604,-.121305,.17647,1.17254,.930959,-.0962119,.143106,1.21012,.948404,-.069969,.108112,1.24474,.967012,-.0427586,.0708478,1.27718,.984183,-.0147043,.032335,1.3083,.999577,.0142165,-.00726867,1.3382,.0229227,-299799e-11,.148623,462391e-12,.0232194,-758796e-10,.15054,117033e-10,.0232315,-303636e-9,.15063,468397e-10,.0232354,-683189e-9,.150624,105472e-9,.0232092,-.0012136,.150445,187744e-9,.0232523,-.00189765,.150679,294847e-9,.0232828,-.00273247,.150789,428013e-9,.0233371,-.00371287,.150995,591134e-9,.0234015,-.00484794,.15118,787642e-9,.023514,-.00612877,.151562,.00102547,.023679,-.00756125,.152116,.00131351,.0239559,-.00914651,.153162,.00166594,.0244334,-.010904,.155133,.00210182,.025139,-.0128615,.158035,.00264406,.0262598,-.0150628,.162751,.00332923,.0277875,-.0175532,.168944,.00419773,.0298472,-.0203981,.176835,.00530034,.0325444,-.023655,.186686,.00669777,.0355581,-.0272982,.196248,.00842661,.0392841,-.0314457,.207352,.0105854,.0436815,-.0361157,.219279,.0132458,.0485272,-.0412932,.230728,.0164736,.0541574,-.0470337,.242994,.0203715,.0609479,-.0535002,.257042,.0250953,.0685228,-.0605409,.27102,.0306856,.0768042,-.0680553,.28406,.037193,.0864844,-.0765011,.299186,.0449795,.0969415,-.0852674,.3132,.0538316,.108478,-.0947333,.327138,.0641149,.121705,-.10481,.342345,.0759185,.136743,-.115474,.358472,.0894116,.152986,-.126536,.374067,.104562,.170397,-.138061,.388267,.121632,.191392,-.150203,.406467,.140996,.211566,-.161751,.418641,.161696,.233567,-.173407,.430418,.184557,.257769,-.185397,.44277,.210092,.28531,-.197048,.457191,.237827,.311726,-.20784,.464712,.267253,.340537,-.218345,.472539,.299332,.372921,-.228306,.482331,.333988,.402924,-.236665,.484378,.369722,.434475,-.244097,.484717,.407836,.469736,-.250547,.487093,.448465,.505045,-.25511,.485575,.490263,.540262,-.258444,.481225,.534495,.576347,-.259903,.473481,.579451,.608656,-.259572,.4603,.625604,.646679,-.257908,.450341,.674511,.679902,-.253663,.431561,.723269,.714159,-.247419,.412684,.773263,.745345,-.239122,.389388,.824182,.778248,-.228837,.365361,.876634,.807208,-.216197,.337667,.92945,.835019,-.201772,.307197,.985261,.860261,-.185291,.274205,1.04299,.877601,-.165809,.240178,1.09816,.898211,-.143897,.207571,1.14694,.915789,-.119513,.174904,1.19008,.931831,-.0932919,.141423,1.2297,.949244,-.0656528,.105603,1.26553,.967527,-.0370262,.0679551,1.29986,.984139,-.00730117,.0283133,1.33252,.999713,.0234648,-.0121785,1.36397,.0152135,-245447e-11,.122795,304092e-12,.0151652,-615778e-10,.122399,76292e-10,.0151181,-245948e-9,.122023,304802e-10,.0151203,-553394e-9,.12203,686634e-10,.015125,-983841e-9,.122037,122463e-9,.0151427,-.00153774,.12214,192706e-9,.0151708,-.0022103,.122237,281219e-9,.0152115,-.00300741,.12238,390804e-9,.0152877,-.00392494,.1227,526317e-9,.015412,-.00496597,.123244,69443e-8,.0156201,-.00613314,.124228,90547e-8,.0159658,-.00744113,.125945,.0011732,.0165674,-.00892546,.129098,.00151888,.017487,-.010627,.133865,.00197007,.018839,-.0126043,.140682,.0025637,.020554,-.0148814,.148534,.00333637,.0226727,-.0175123,.157381,.00433738,.0251879,-.0205266,.166685,.00561664,.0283635,-.0240319,.177796,.00725563,.0318694,-.0279432,.188251,.00928811,.0361044,-.0324313,.200038,.011835,.0406656,-.0373527,.210685,.0149146,.0463846,-.0430132,.224182,.0187254,.0525696,-.0491013,.23634,.0232283,.0598083,-.0559175,.250013,.0286521,.0679437,-.0633657,.263981,.0350634,.0771181,-.0714602,.278072,.0425882,.0881273,-.0803502,.29511,.0514487,.0996628,-.0896903,.309976,.0615766,.112702,-.099644,.325611,.0732139,.126488,-.109829,.339321,.0862324,.142625,-.120859,.35574,.101275,.15953,-.131956,.369845,.117892,.176991,-.143145,.38146,.136205,.199715,-.155292,.40052,.157252,.220787,-.167066,.412055,.179966,.243697,-.178396,.423133,.204418,.272106,-.190433,.439524,.232141,.297637,-.201265,.447041,.261109,.325273,-.211834,.454488,.292627,.357219,-.221889,.465004,.326669,.387362,-.230729,.468527,.362426,.423131,-.23924,.475836,.401533,.45543,-.246067,.475017,.441902,.493393,-.251557,.478017,.484239,.526253,-.255571,.4709,.528586,.560554,-.257752,.463167,.574346,.599306,-.258076,.456452,.621655,.634541,-.256471,.443725,.670492,.668907,-.253283,.428719,.721943,.705619,-.247562,.411348,.772477,.739034,-.240626,.388939,.8264,.771408,-.231493,.36425,.881702,.803312,-.220125,.337321,.9385,.828457,-.206645,.305364,.997437,.854819,-.190664,.273715,1.05693,.878666,-.171429,.242218,1.11251,.898404,-.149235,.209556,1.16398,.917416,-.12435,.176863,1.21014,.933133,-.0972703,.142775,1.25178,.95066,-.0683607,.106735,1.29028,.968589,-.0378724,.0681609,1.32703,.984776,-.00605712,.0273966,1.36158,.99994,.0263276,-.0138124,1.3943,.00867437,-186005e-11,.0928979,173682e-12,.00864003,-466389e-10,.0925237,435505e-11,.00864593,-186594e-9,.0925806,174322e-10,.00864095,-419639e-9,.0924903,392862e-10,.00863851,-746272e-9,.0924589,702598e-10,.00868531,-.00116456,.0929,111188e-9,.00869667,-.00167711,.0928529,163867e-9,.00874332,-.00228051,.0930914,23104e-8,.00882709,-.00297864,.0935679,31741e-8,.00898874,-.00377557,.0946165,430186e-9,.00929346,-.00469247,.0967406,580383e-9,.00978271,-.00575491,.100084,783529e-9,.0105746,-.00701514,.105447,.00106304,.0116949,-.00851797,.112494,.00144685,.0130419,-.0102757,.119876,.00196439,.0148375,-.012381,.129034,.00266433,.0168725,-.01482,.137812,.00358364,.0193689,-.0176563,.147696,.00478132,.0222691,-.0209211,.157795,.00631721,.0256891,-.0246655,.168431,.00826346,.0294686,-.0288597,.178587,.0106714,.0340412,-.0336441,.190251,.0136629,.0393918,-.039033,.202999,.0173272,.0453947,-.0450087,.215655,.0217448,.0521936,-.0515461,.228686,.0269941,.0600279,-.058817,.242838,.033272,.0692398,-.0667228,.258145,.0406457,.0793832,-.0752401,.273565,.0492239,.0902297,-.0841851,.287735,.0590105,.102014,-.0936479,.301161,.0702021,.116054,-.103967,.317438,.0832001,.13191,-.114622,.334166,.0977951,.148239,-.125452,.348192,.113985,.165809,-.136453,.361094,.131928,.184616,-.147648,.373534,.151811,.207491,-.159607,.39101,.174476,.230106,-.171119,.402504,.198798,.257036,-.182906,.418032,.225796,.281172,-.193605,.425468,.254027,.312034,-.204771,.440379,.285713,.340402,-.214988,.445406,.319196,.370231,-.224711,.44968,.35537,.407105,-.233516,.460747,.393838,.439037,-.240801,.460624,.433747,.47781,-.24762,.465957,.477234,.510655,-.251823,.460054,.52044,.550584,-.255552,.459172,.567853,.585872,-.257036,.450311,.615943,.620466,-.257535,.437763,.667693,.660496,-.255248,.426639,.718988,.695578,-.251141,.409185,.772503,.732176,-.244718,.39015,.827023,.760782,-.236782,.362594,.885651,.79422,-.225923,.33711,.943756,.824521,-.213855,.308272,1.00874,.854964,-.197723,.278529,1.06764,.878065,-.179209,.246208,1.12836,.899834,-.157569,.21329,1.18318,.918815,-.133206,.181038,1.23161,.934934,-.106545,.146993,1.27644,.952115,-.0780574,.111175,1.31842,.96906,-.0478279,.0728553,1.35839,.985178,-.0160014,.032579,1.39697,1.00039,.0173126,-.0095256,1.43312,.00384146,-124311e-11,.0613583,778271e-13,.00390023,-314043e-10,.0622919,196626e-11,.00389971,-125622e-9,.0622632,787379e-11,.00389491,-282352e-9,.0620659,1778e-8,.00391618,-502512e-9,.0624687,320918e-10,.00392662,-784458e-9,.0625113,515573e-10,.00396053,-.00112907,.0628175,778668e-10,.00401911,-.00153821,.0633286,113811e-9,.00414994,-.0020208,.0646443,16445e-8,.00441223,-.00260007,.0673886,237734e-9,.00484427,-.0033097,.0716528,345929e-9,.00549109,-.00418966,.0774998,505987e-9,.00636293,-.00527331,.0844758,739208e-9,.00746566,-.00660428,.0921325,.00107347,.00876625,-.00818826,.0997067,.00153691,.0103125,-.0100811,.107433,.00217153,.0123309,-.0123643,.117088,.00303427,.0146274,-.0150007,.126438,.00416018,.0172295,-.0180531,.135672,.00561513,.0204248,-.0215962,.146244,.007478,.0241597,-.0256234,.157481,.00981046,.0284693,-.0302209,.169125,.0127148,.033445,-.0353333,.181659,.0162453,.0391251,-.0410845,.1944,.0205417,.0454721,-.0473451,.207082,.0256333,.0530983,-.0542858,.221656,.0317036,.0615356,-.0618384,.236036,.0388319,.0703363,-.0697631,.248398,.046974,.0810391,-.0784757,.263611,.0565246,.0920144,-.0873488,.275857,.0671724,.105584,-.0973652,.292555,.0798105,.119506,-.107271,.306333,.0935945,.134434,-.117608,.318888,.109106,.153399,-.128938,.337552,.127074,.171258,-.139944,.349955,.14643,.191059,-.151288,.361545,.168,.215069,-.163018,.378421,.192082,.237838,-.174226,.38879,.217838,.266965,-.186063,.405857,.246931,.292827,-.196909,.414146,.277505,.324352,-.207473,.426955,.310711,.354427,-.217713,.433429,.346794,.389854,-.227183,.443966,.385237,.420749,-.235131,.44471,.424955,.459597,-.242786,.451729,.468446,.495316,-.248767,.45072,.513422,.534903,-.253351,.450924,.560618,.572369,-.256277,.445266,.609677,.612383,-.2576,.438798,.660995,.644037,-.256931,.421693,.713807,.686749,-.254036,.4109,.767616,.719814,-.249785,.390151,.82533,.754719,-.244283,.367847,.888311,.792022,-.235076,.345013,.948177,.822404,-.225061,.316193,1.01661,.853084,-.211113,.287013,1.08075,.879871,-.19449,.255424,1.14501,.901655,-.174023,.222879,1.20203,.919957,-.1509,.18989,1.25698,.938412,-.124923,.15606,1.30588,.953471,-.0968139,.120512,1.3529,.970451,-.066734,.0828515,1.3986,.985522,-.034734,.0424458,1.44148,1.00099,-.00102222,678929e-9,1.48398,965494e-9,-627338e-12,.0306409,197672e-13,99168e-8,-158573e-10,.0314638,499803e-12,991068e-9,-634012e-10,.031363,200682e-11,974567e-9,-14144e-8,.03036,457312e-11,998079e-9,-252812e-9,.031496,860131e-11,.00102243,-396506e-9,.0319955,148288e-10,.00107877,-577593e-9,.0331376,249141e-10,.00121622,-816816e-9,.0359396,423011e-10,.0014455,-.00113761,.0399652,724613e-10,.00178791,-.00156959,.0450556,123929e-9,.00225668,-.00214064,.0508025,208531e-9,.00285627,-.00287655,.0568443,341969e-9,.0035991,-.00380271,.0630892,544158e-9,.00455524,-.00496264,.0702204,842423e-9,.00569143,-.0063793,.0773426,.00126704,.00716928,-.00813531,.0860839,.00186642,.00885307,-.0101946,.0944079,.00267014,.0109316,-.0126386,.103951,.00374033,.0133704,-.0154876,.113786,.0051304,.0161525,-.0187317,.123477,.00688858,.0194267,-.0224652,.133986,.00910557,.0230967,-.0265976,.143979,.0118074,.0273627,-.0312848,.154645,.0151266,.0323898,-.0365949,.166765,.0191791,.0379225,-.0422914,.177932,.0239236,.0447501,-.0487469,.19167,.0296568,.0519391,-.0556398,.203224,.0362924,.0599464,-.0631646,.215652,.0440585,.0702427,-.0714308,.232089,.0531619,.0806902,-.0800605,.245258,.0634564,.0923194,-.0892815,.258609,.0752481,.106938,-.09931,.276654,.0888914,.121238,-.109575,.289847,.104055,.138817,-.120461,.307566,.121266,.15595,-.131209,.320117,.139944,.178418,-.143049,.339677,.161591,.197875,-.154074,.349886,.184303,.224368,-.166307,.369352,.210669,.252213,-.178051,.386242,.238895,.277321,-.189335,.395294,.269182,.310332,-.200683,.412148,.302508,.338809,-.210856,.418266,.337264,.372678,-.220655,.428723,.374881,.405632,-.230053,.433887,.415656,.442293,-.237993,.439911,.457982,.477256,-.244897,.440175,.502831,.515592,-.250657,.441079,.550277,.550969,-.255459,.435219,.601102,.592883,-.257696,.432882,.651785,.629092,-.259894,.421054,.708961,.672033,-.258592,.41177,.763806,.709147,-.256525,.395267,.824249,.745367,-.254677,.375013,.8951,.784715,-.247892,.353906,.959317,.818107,-.240162,.327801,1.03153,.847895,-.229741,.298821,1.10601,.879603,-.213084,.269115,1.164,.902605,-.195242,.236606,1.22854,.922788,-.174505,.203442,1.29017,.944831,-.150169,.169594,1.34157,.959656,-.124099,.135909,1.3956,.972399,-.0960626,.0990563,1.45128,.986549,-.0657097,.0602348,1.50312,1.00013,-.0333558,.0186694,1.55364,619747e-11,-1e-7,.00778326,796756e-16,237499e-13,-999999e-13,282592e-10,114596e-15,100292e-11,-166369e-11,250354e-9,677492e-14,350752e-11,-637769e-11,357289e-9,631655e-13,826445e-11,-174689e-10,516179e-9,31851e-11,242481e-10,-450868e-10,.0010223,130577e-11,455631e-10,-89044e-9,.00144302,374587e-11,971222e-10,-178311e-9,.00241912,102584e-10,171403e-9,-313976e-9,.00354938,236481e-10,292747e-9,-520026e-9,.00513765,496014e-10,789827e-9,-.00118187,.0238621,139056e-9,.00114093,-.00171827,.0286691,244093e-9,.00176119,-.00249667,.0368565,420623e-9,.0022233,-.00333742,.0400469,65673e-8,.00343382,-.00481976,.0535751,.00109323,.00427602,-.00600755,.057099,.00155268,.00461435,-.00737637,.0551084,.00215031,.00695698,-.00971401,.0715767,.00316529,.00867619,-.0120943,.0793314,.00436995,.0106694,-.0148202,.0869391,.0058959,.0140351,-.0183501,.101572,.00798757,.0168939,-.022006,.11018,.0104233,.020197,-.0261568,.119041,.0134167,.0254702,-.0312778,.135404,.0173009,.0298384,-.0362469,.1437,.0215428,.035159,-.042237,.15512,.0268882,.0427685,-.0488711,.17128,.033235,.0494848,-.0557997,.181813,.0404443,.0592394,-.0635578,.198745,.0490043,.0681463,-.071838,.210497,.0588239,.0804753,-.0809297,.228864,.0702835,.0942205,-.0906488,.247008,.0834012,.106777,-.100216,.258812,.0975952,.124471,-.110827,.278617,.114162,.138389,-.121193,.287049,.131983,.159543,-.13253,.307151,.152541,.176432,-.143611,.31564,.174673,.201723,-.15548,.33538,.199842,.229721,-.167166,.355256,.227097,.250206,-.178238,.360047,.256014,.282118,-.189905,.378761,.28855,.312821,-.201033,.39181,.323348,.341482,-.211584,.397716,.360564,.377368,-.221314,.410141,.400004,.418229,-.230474,.423485,.442371,.444881,-.239443,.418874,.488796,.488899,-.245987,.427545,.535012,.520317,-.253948,.422147,.589678,.568566,-.256616,.42719,.637683,.599607,-.26376,.415114,.703363,.64222,-.268687,.408715,.771363,.685698,-.2694,.399722,.83574,.732327,-.266642,.388651,.897764,.769873,-.267712,.369198,.983312,.806733,-.263479,.346802,1.06222,.843466,-.254575,.321368,1.13477,.873008,-.242749,.29211,1.20712,.908438,-.22725,.262143,1.27465,.936321,-.207621,.228876,1.33203,.950353,-.187932,.19484,1.40439,.96442,-.165154,.163178,1.4732,.979856,-.139302,.127531,1.53574,.982561,-.11134,.0903457,1.59982,.996389,-.0808124,.0489007,1.6577],t=[1,0,0,0,1,791421e-36,0,0,1,104392e-29,0,0,1,349405e-26,0,0,1,109923e-23,0,0,1,947414e-22,0,0,1,359627e-20,0,0,1,772053e-19,0,0,1,108799e-17,0,0,1,110655e-16,0,0,1,865818e-16,0,0,.999998,545037e-15,0,0,.999994,285095e-14,0,0,.999989,126931e-13,0,0,.999973,489938e-13,0,0,.999947,166347e-12,0,0,.999894,502694e-12,0,0,.999798,136532e-11,0,0,.999617,335898e-11,0,0,.999234,752126e-11,0,0,.998258,152586e-10,0,0,.99504,266207e-10,0,0,.980816,236802e-10,0,0,.967553,207684e-11,0,0,.966877,403733e-11,0,0,.965752,741174e-11,0,0,.96382,127746e-10,0,0,.960306,202792e-10,0,0,.953619,280232e-10,0,0,.941103,278816e-10,0,0,.926619,160221e-10,0,0,.920983,235164e-10,0,0,.912293,311924e-10,0,.0158731,.899277,348118e-10,0,.0476191,.880884,26041e-9,0,.0793651,.870399,338726e-10,0,.111111,.856138,392906e-10,0,.142857,.837436,372874e-10,0,.174603,.820973,392558e-10,0,.206349,.803583,434658e-10,0,.238095,.782168,40256e-9,0,.269841,.764107,448159e-10,0,.301587,.743092,457627e-10,0,.333333,.721626,455314e-10,0,.365079,.700375,477335e-10,0,.396825,.677334,461072e-10,0,.428571,.655702,484393e-10,0,.460317,.632059,464583e-10,0,.492064,.610125,483923e-10,0,.52381,.58653,464342e-10,0,.555556,.564508,477033e-10,0,.587302,.541405,459263e-10,0,.619048,.519556,46412e-9,0,.650794,.497292,448913e-10,0,.68254,.475898,445789e-10,0,.714286,.454722,433496e-10,0,.746032,.434042,423054e-10,0,.777778,.414126,413737e-10,0,.809524,.394387,397265e-10,0,.84127,.375841,390709e-10,0,.873016,.357219,369938e-10,0,.904762,.340084,365618e-10,0,.936508,.322714,342533e-10,0,.968254,.306974,339596e-10,0,1,1,101524e-23,0,0,1,10292e-22,0,0,1,130908e-23,0,0,1,473331e-23,0,0,1,625319e-22,0,0,1,107932e-20,0,0,1,163779e-19,0,0,1,203198e-18,0,0,1,204717e-17,0,0,.999999,168995e-16,0,0,.999998,115855e-15,0,0,.999996,66947e-14,0,0,.999991,330863e-14,0,0,.999983,141737e-13,0,0,.999968,532626e-13,0,0,.99994,177431e-12,0,0,.999891,528835e-12,0,0,.999797,142169e-11,0,0,.999617,347057e-11,0,0,.999227,77231e-10,0,0,.998239,155753e-10,0,0,.994937,268495e-10,0,0,.980225,213742e-10,0,0,.967549,21631e-10,0,0,.966865,417989e-11,0,0,.965739,763341e-11,0,0,.963794,130892e-10,0,0,.960244,206456e-10,0,0,.953495,282016e-10,0,148105e-9,.940876,271581e-10,0,.002454,.926569,164159e-10,0,.00867491,.920905,239521e-10,0,.01956,.912169,315127e-10,0,.035433,.899095,346626e-10,0,.056294,.882209,290223e-10,0,.0818191,.870272,342992e-10,0,.111259,.855977,394164e-10,0,.142857,.837431,372343e-10,0,.174603,.820826,396691e-10,0,.206349,.803408,435395e-10,0,.238095,.782838,419579e-10,0,.269841,.763941,450953e-10,0,.301587,.742904,455847e-10,0,.333333,.721463,458833e-10,0,.365079,.700197,477159e-10,0,.396825,.677501,470641e-10,0,.428571,.655527,484732e-10,0,.460317,.6324,476834e-10,0,.492064,.609964,484213e-10,0,.52381,.586839,475541e-10,0,.555556,.564353,476951e-10,0,.587302,.541589,467611e-10,0,.619048,.519413,463493e-10,0,.650794,.497337,453994e-10,0,.68254,.475797,445308e-10,0,.714286,.454659,435787e-10,0,.746032,.434065,424839e-10,0,.777778,.414018,41436e-9,0,.809524,.39455,401902e-10,0,.84127,.375742,390813e-10,0,.873016,.357501,377116e-10,0,.904762,.339996,36535e-9,0,.936508,.323069,351265e-10,0,.968254,.306897,339112e-10,0,1,1,10396e-19,0,0,1,104326e-20,0,0,1,110153e-20,0,0,1,144668e-20,0,0,1,34528e-19,0,0,1,175958e-19,0,0,1,12627e-17,0,0,1,936074e-18,0,0,1,645742e-17,0,0,.999998,401228e-16,0,0,.999997,222338e-15,0,0,.999995,10967e-13,0,0,.999991,482132e-14,0,0,.999981,189434e-13,0,0,.999967,667716e-13,0,0,.999938,212066e-12,0,0,.999886,60977e-11,0,0,.999792,159504e-11,0,0,.999608,381191e-11,0,0,.999209,833727e-11,0,0,.998179,165288e-10,0,0,.994605,274387e-10,0,0,.979468,167316e-10,0,0,.967529,242877e-11,0,0,.966836,461696e-11,0,0,.96569,830977e-11,0,0,.963706,140427e-10,0,244659e-11,.960063,217353e-10,0,760774e-9,.953113,286606e-10,0,.00367261,.940192,247691e-10,0,.00940263,.927731,195814e-10,0,.018333,.920669,252531e-10,0,.0306825,.911799,324277e-10,0,.0465556,.89857,340982e-10,0,.0659521,.883283,319622e-10,0,.0887677,.86989,35548e-9,0,.114784,.855483,397143e-10,0,.143618,.837987,391665e-10,0,.174606,.820546,411306e-10,0,.206349,.802878,436753e-10,0,.238095,.783402,444e-7,0,.269841,.763439,458726e-10,0,.301587,.742925,467097e-10,0,.333333,.721633,478887e-10,0,.365079,.69985,481251e-10,0,.396825,.67783,491811e-10,0,.428571,.655126,488199e-10,0,.460318,.632697,496025e-10,0,.492064,.609613,48829e-9,0,.52381,.587098,492754e-10,0,.555556,.564119,482625e-10,0,.587302,.541813,482807e-10,0,.619048,.519342,471552e-10,0,.650794,.497514,466765e-10,0,.68254,.475879,455582e-10,0,.714286,.454789,446007e-10,0,.746032,.434217,435382e-10,0,.777778,.414086,421753e-10,0,.809524,.394744,412093e-10,0,.84127,.375782,396634e-10,0,.873016,.357707,386419e-10,0,.904762,.340038,370345e-10,0,.936508,.323284,359725e-10,0,.968254,.306954,3436e-8,0,1,1,599567e-19,0,0,1,600497e-19,0,0,1,614839e-19,0,0,1,686641e-19,0,0,1,972658e-19,0,0,1,221271e-18,0,0,1,833195e-18,0,0,1,403601e-17,0,0,.999999,206001e-16,0,0,.999998,101739e-15,0,0,.999997,470132e-15,0,0,.999993,200436e-14,0,0,.999988,783682e-14,0,0,.999979,280338e-13,0,0,.999962,917033e-13,0,0,.999933,274514e-12,0,0,.999881,753201e-12,0,0,.999783,189826e-11,0,0,.999594,440279e-11,0,0,.999178,93898e-10,0,0,.998073,181265e-10,0,0,.993993,280487e-10,0,0,.979982,149422e-10,0,0,.968145,378481e-11,0,0,.966786,53771e-10,0,0,.965611,947508e-11,0,388934e-10,.963557,156616e-10,0,9693e-7,.959752,235144e-10,0,.00370329,.952461,291568e-10,0,.00868428,.940193,240102e-10,0,.0161889,.929042,231235e-10,0,.0263948,.920266,273968e-10,0,.0394088,.911178,337915e-10,0,.0552818,.897873,333629e-10,0,.0740138,.884053,351405e-10,0,.0955539,.869455,378034e-10,0,.119795,.854655,399378e-10,0,.14656,.838347,419108e-10,0,.175573,.820693,440831e-10,0,.206388,.802277,445599e-10,0,.238095,.783634,472691e-10,0,.269841,.763159,476984e-10,0,.301587,.742914,491487e-10,0,.333333,.721662,502312e-10,0,.365079,.699668,502817e-10,0,.396825,.677839,51406e-9,0,.428571,.655091,511095e-10,0,.460317,.632665,516067e-10,0,.492064,.609734,512255e-10,0,.52381,.587043,510263e-10,0,.555556,.564298,50565e-9,0,.587302,.541769,497951e-10,0,.619048,.519529,492698e-10,0,.650794,.497574,482066e-10,0,.68254,.476028,473689e-10,0,.714286,.454961,461941e-10,0,.746032,.434341,450618e-10,0,.777778,.414364,438355e-10,0,.809524,.394832,424196e-10,0,.84127,.376109,412563e-10,0,.873016,.35779,396226e-10,0,.904762,.340379,384886e-10,0,.936508,.323385,368214e-10,0,.968254,.307295,356636e-10,0,1,1,106465e-17,0,0,1,106555e-17,0,0,1,107966e-17,0,0,1,114601e-17,0,0,1,137123e-17,0,0,1,21243e-16,0,0,.999999,489653e-17,0,0,.999999,160283e-16,0,0,.999998,62269e-15,0,0,.999997,251859e-15,0,0,.999996,996192e-15,0,0,.999992,374531e-14,0,0,.999986,132022e-13,0,0,.999975,433315e-13,0,0,.999959,131956e-12,0,0,.999927,372249e-12,0,0,.999871,972461e-12,0,0,.999771,235343e-11,0,0,.999572,52768e-10,0,0,.999133,109237e-10,0,0,.997912,203675e-10,0,0,.993008,279396e-10,0,0,.980645,139604e-10,0,0,.970057,646596e-11,0,0,.966717,65089e-10,0,474145e-10,.965497,111863e-10,0,89544e-8,.96334,179857e-10,0,.0032647,.959294,259045e-10,0,.0075144,.951519,292327e-10,0,.0138734,.940517,249769e-10,0,.0224952,.93014,26803e-9,0,.0334828,.91972,303656e-10,0,.0468973,.910294,353323e-10,0,.0627703,.897701,351002e-10,0,.0811019,.884522,388104e-10,0,.10186,.869489,412932e-10,0,.124985,.853983,415781e-10,0,.150372,.838425,454066e-10,0,.177868,.820656,471624e-10,0,.207245,.801875,475243e-10,0,.238143,.783521,505621e-10,0,.269841,.763131,50721e-9,0,.301587,.74261,523293e-10,0,.333333,.72148,528699e-10,0,.365079,.699696,538677e-10,0,.396825,.677592,539255e-10,0,.428571,.65525,546367e-10,0,.460317,.632452,541348e-10,0,.492064,.609903,544976e-10,0,.52381,.586928,536201e-10,0,.555556,.564464,535185e-10,0,.587302,.541801,524949e-10,0,.619048,.519681,51812e-9,0,.650794,.497685,507687e-10,0,.68254,.47622,496243e-10,0,.714286,.455135,485714e-10,0,.746032,.4346,471847e-10,0,.777778,.414564,459294e-10,0,.809524,.395165,444705e-10,0,.84127,.376333,430772e-10,0,.873016,.358197,416229e-10,0,.904762,.34064,401019e-10,0,.936508,.323816,386623e-10,0,.968254,.307581,370933e-10,0,1,1,991541e-17,0,0,1,992077e-17,0,0,1,100041e-16,0,0,1,10385e-15,0,0,1,115777e-16,0,0,1,150215e-16,0,0,.999999,254738e-16,0,0,.999999,598822e-16,0,0,.999998,179597e-15,0,0,.999997,602367e-15,0,0,.999994,206835e-14,0,0,.99999,694952e-14,0,0,.999984,223363e-13,0,0,.999972,678578e-13,0,0,.999952,193571e-12,0,0,.999919,516594e-12,0,0,.99986,128739e-11,0,0,.999753,299298e-11,0,0,.999546,648258e-11,0,0,.999074,129985e-10,0,0,.997671,232176e-10,0,0,.991504,256701e-10,0,0,.981148,131141e-10,0,0,.971965,869048e-11,0,280182e-10,.966624,808301e-11,0,695475e-9,.965344,135235e-10,0,.00265522,.963048,210592e-10,0,.00622975,.958673,287473e-10,0,.0116234,.950262,281379e-10,0,.018976,.940836,271089e-10,0,.0283844,.930996,30926e-9,0,.0399151,.919848,348359e-10,0,.0536063,.909136,366092e-10,0,.0694793,.897554,384162e-10,0,.0875342,.884691,430971e-10,0,.107749,.869414,447803e-10,0,.130087,.853462,452858e-10,0,.154481,.838187,495769e-10,0,.180833,.820381,502709e-10,0,.209005,.801844,522713e-10,0,.238791,.783061,541505e-10,0,.269869,.763205,553712e-10,0,.301587,.742362,564909e-10,0,.333333,.721393,572646e-10,0,.365079,.699676,581012e-10,0,.396825,.677395,58096e-9,0,.428571,.655208,585766e-10,0,.460317,.632451,583602e-10,0,.492064,.609839,580234e-10,0,.52381,.587093,577161e-10,0,.555556,.564467,568447e-10,0,.587302,.542043,563166e-10,0,.619048,.519826,55156e-9,0,.650794,.497952,541682e-10,0,.68254,.476477,528971e-10,0,.714286,.455412,514952e-10,0,.746032,.434926,502222e-10,0,.777778,.4149,485779e-10,0,.809524,.395552,472242e-10,0,.84127,.376712,454891e-10,0,.873016,.358622,440924e-10,0,.904762,.341048,422984e-10,0,.936508,.324262,408582e-10,0,.968254,.308013,390839e-10,0,1,1,613913e-16,0,0,1,614145e-16,0,0,1,617708e-16,0,0,1,633717e-16,0,0,1,681648e-16,0,0,1,808291e-16,0,0,1,114608e-15,0,0,.999998,210507e-15,0,0,.999997,499595e-15,0,0,.999995,139897e-14,0,0,.999994,419818e-14,0,0,.999988,127042e-13,0,0,.999979,375153e-13,0,0,.999965,106206e-12,0,0,.999945,285381e-12,0,0,.999908,723611e-12,0,0,.999846,17255e-10,0,0,.999733,386104e-11,0,0,.999511,808493e-11,0,0,.998993,156884e-10,0,0,.997326,265538e-10,0,0,.989706,206466e-10,0,0,.981713,130756e-10,0,70005e-10,.973636,106473e-10,0,464797e-9,.966509,10194e-9,0,.00201743,.965149,165881e-10,0,.00497549,.962669,249147e-10,0,.00953262,.95786,317449e-10,0,.0158211,.949334,281045e-10,0,.0239343,.941041,303263e-10,0,.0339372,.931575,356754e-10,0,.0458738,.920102,397075e-10,0,.059772,.908002,384886e-10,0,.075645,.897269,43027e-9,0,.0934929,.884559,479925e-10,0,.113302,.869161,48246e-9,0,.135045,.853342,509505e-10,0,.158678,.837633,542846e-10,0,.184136,.820252,554139e-10,0,.211325,.801872,581412e-10,0,.240113,.782418,585535e-10,0,.270306,.7631,610923e-10,0,.301594,.742183,613678e-10,0,.333333,.721098,627275e-10,0,.365079,.699512,629413e-10,0,.396825,.677372,636351e-10,0,.428571,.655059,633555e-10,0,.460317,.632567,636513e-10,0,.492064,.609784,628965e-10,0,.52381,.587237,625546e-10,0,.555556,.564525,615825e-10,0,.587302,.542181,605048e-10,0,.619048,.520017,596329e-10,0,.650794,.498204,581516e-10,0,.68254,.476742,569186e-10,0,.714286,.455803,553833e-10,0,.746032,.435251,537807e-10,0,.777778,.415374,522025e-10,0,.809524,.395921,503421e-10,0,.84127,.377253,488211e-10,0,.873016,.359021,468234e-10,0,.904762,.341637,453269e-10,0,.936508,.3247,433014e-10,0,.968254,.308625,418007e-10,0,1,1,286798e-15,0,0,1,286877e-15,0,0,1,288094e-15,0,0,1,293506e-15,0,0,1,309262e-15,0,0,.999999,348593e-15,0,0,.999999,444582e-15,0,0,.999998,688591e-15,0,0,.999996,134391e-14,0,0,.999993,317438e-14,0,0,.999989,835609e-14,0,0,.999983,228677e-13,0,0,.999974,623361e-13,0,0,.999959,165225e-12,0,0,.999936,419983e-12,0,0,.999896,101546e-11,0,0,.99983,232376e-11,0,0,.999709,50156e-10,0,0,.999469,10167e-9,0,0,.998886,190775e-10,0,0,.996819,300511e-10,0,0,.988837,185092e-10,0,168222e-12,.982178,134622e-10,0,259622e-9,.975017,125961e-10,0,.00142595,.967101,13507e-9,0,.00382273,.964905,205003e-10,0,.00764164,.96218,29546e-9,0,.0130121,.956821,343738e-10,0,.0200253,.948829,305063e-10,0,.0287452,.941092,346487e-10,0,.039218,.931883,412061e-10,0,.0514748,.920211,444651e-10,0,.0655351,.907307,431252e-10,0,.0814082,.89684,490382e-10,0,.0990939,.884119,53334e-9,0,.118583,.869148,54114e-9,0,.139856,.853377,578536e-10,0,.162882,.836753,592285e-10,0,.187615,.820063,622787e-10,0,.213991,.801694,645492e-10,0,.241918,.782116,65353e-9,0,.271267,.762673,674344e-10,0,.301847,.742133,682788e-10,0,.333333,.720779,691959e-10,0,.365079,.699386,696817e-10,0,.396826,.67732,699583e-10,0,.428572,.654888,698447e-10,0,.460318,.632499,694063e-10,0,.492064,.609825,691612e-10,0,.52381,.587287,681576e-10,0,.555556,.564743,674138e-10,0,.587302,.542409,661617e-10,0,.619048,.520282,647785e-10,0,.650794,.498506,633836e-10,0,.68254,.477102,615905e-10,0,.714286,.456167,601013e-10,0,.746032,.435728,581457e-10,0,.777778,.415809,564215e-10,0,.809524,.396517,544997e-10,0,.84127,.377737,525061e-10,0,.873016,.359698,506831e-10,0,.904762,.342164,48568e-9,0,.936508,.325417,467826e-10,0,.968254,.309186,446736e-10,0,1,1,109018e-14,0,0,1,10904e-13,0,0,1,109393e-14,0,0,1,11095e-13,0,0,1,1154e-12,0,0,1,126089e-14,0,0,.999999,15059e-13,0,0,.999997,207899e-14,0,0,.999994,348164e-14,0,0,.999993,705728e-14,0,0,.999987,163692e-13,0,0,.999981,406033e-13,0,0,.999969,10245e-11,0,0,.999953,255023e-12,0,0,.999925,61511e-11,0,0,.999881,142218e-11,0,0,.99981,313086e-11,0,0,.99968,653119e-11,0,0,.999418,12832e-9,0,0,.998748,232497e-10,0,0,.996066,329522e-10,0,0,.988379,179613e-10,0,108799e-9,.982567,143715e-10,0,921302e-9,.976097,148096e-10,0,.00280738,.968475,178905e-10,0,.00596622,.964606,253921e-10,0,.0105284,.961564,348623e-10,0,.0165848,.955517,357612e-10,0,.0242,.948381,343493e-10,0,.03342,.941095,405849e-10,0,.0442777,.931923,475394e-10,0,.0567958,.91996,484328e-10,0,.0709879,.907419,502146e-10,0,.086861,.89618,561654e-10,0,.104415,.88337,587612e-10,0,.123643,.869046,618057e-10,0,.144531,.853278,657392e-10,0,.167057,.836091,66303e-9,0,.191188,.819644,704445e-10,0,.216878,.801246,714071e-10,0,.244062,.782031,740093e-10,0,.272649,.762066,74685e-9,0,.302509,.741964,766647e-10,0,.333442,.720554,766328e-10,0,.365079,.699098,777857e-10,0,.396826,.677189,774633e-10,0,.428572,.65484,776235e-10,0,.460318,.632496,770316e-10,0,.492064,.609908,762669e-10,0,.52381,.587312,753972e-10,0,.555556,.564938,739994e-10,0,.587302,.542577,728382e-10,0,.619048,.52062,71112e-9,0,.650794,.498819,694004e-10,0,.68254,.477555,675575e-10,0,.714286,.456568,653449e-10,0,.746032,.436278,636068e-10,0,.777778,.41637,613466e-10,0,.809524,.397144,594177e-10,0,.84127,.378412,570987e-10,0,.873016,.360376,550419e-10,0,.904762,.342906,527422e-10,0,.936508,.326136,506544e-10,0,.968254,.30997,484307e-10,0,1,1,354014e-14,0,0,1,354073e-14,0,0,1,354972e-14,0,0,1,358929e-14,0,0,1,370093e-14,0,0,.999999,396194e-14,0,0,.999998,453352e-14,0,0,.999997,578828e-14,0,0,.999994,863812e-14,0,0,.999991,153622e-13,0,0,.999985,316356e-13,0,0,.999977,712781e-13,0,0,.999964,166725e-12,0,0,.999945,390501e-12,0,0,.999912,895622e-12,0,0,.999866,198428e-11,0,0,.999786,421038e-11,0,0,.999647,850239e-11,0,0,.999356,162059e-10,0,0,.998563,282652e-10,0,0,.994928,336309e-10,0,244244e-10,.987999,178458e-10,0,523891e-9,.982893,159162e-10,0,.00194729,.977044,178056e-10,0,.00451099,.969972,230624e-10,0,.00835132,.964237,313922e-10,0,.013561,.960791,406145e-10,0,.0202056,.954292,372796e-10,0,.0283321,.948052,403199e-10,0,.0379739,.940938,479537e-10,0,.0491551,.931689,545292e-10,0,.0618918,.91987,54038e-9,0,.0761941,.907665,589909e-10,0,.0920672,.895281,642651e-10,0,.109511,.882621,659707e-10,0,.12852,.86873,709973e-10,0,.149085,.853008,742221e-10,0,.171189,.835944,761754e-10,0,.194809,.818949,797052e-10,0,.21991,.800951,812434e-10,0,.246447,.781847,838075e-10,0,.274352,.761649,84501e-9,0,.303535,.74152,860258e-10,0,.333857,.720495,866233e-10,0,.365104,.698742,868326e-10,0,.396826,.677096,87133e-9,0,.428572,.654782,863497e-10,0,.460318,.632335,860206e-10,0,.492064,.610031,849337e-10,0,.52381,.587457,838279e-10,0,.555556,.56513,82309e-9,0,.587302,.542877,803542e-10,0,.619048,.5209,786928e-10,0,.650794,.499291,765171e-10,0,.68254,.477971,744753e-10,0,.714286,.457221,72209e-9,0,.746032,.436803,697448e-10,0,.777778,.417083,675333e-10,0,.809524,.397749,648058e-10,0,.84127,.379177,625759e-10,0,.873016,.361061,598584e-10,0,.904762,.343713,575797e-10,0,.936508,.326894,549999e-10,0,.968254,.310816,527482e-10,0,1,1,10153e-12,0,0,1,101544e-13,0,0,1,101751e-13,0,0,1,102662e-13,0,0,1,10521e-12,0,0,.999999,111049e-13,0,0,.999999,123408e-13,0,0,.999996,14924e-12,0,0,.999992,204471e-13,0,0,.999989,326539e-13,0,0,.99998,603559e-13,0,0,.999971,123936e-12,0,0,.999955,269058e-12,0,0,.999933,593604e-12,0,0,.999901,129633e-11,0,0,.999847,275621e-11,0,0,.999761,564494e-11,0,0,.999607,110485e-10,0,0,.999282,204388e-10,0,0,.99831,341084e-10,0,22038e-11,.993288,294949e-10,0,242388e-9,.987855,192736e-10,0,.0012503,.983167,182383e-10,0,.0032745,.977908,218633e-10,0,.00646321,.971194,290662e-10,0,.0109133,.963867,386401e-10,0,.0166927,.95982,462827e-10,0,.0238494,.953497,420705e-10,0,.0324178,.947621,477743e-10,0,.0424225,.940611,568258e-10,0,.0538808,.931174,618061e-10,0,.0668047,.919919,627098e-10,0,.0812014,.907856,694714e-10,0,.0970745,.894509,735008e-10,0,.114424,.881954,763369e-10,0,.133246,.868309,821896e-10,0,.153534,.852511,83769e-9,0,.175275,.835821,881615e-10,0,.198453,.817981,896368e-10,0,.223042,.800504,930906e-10,0,.249009,.78141,945056e-10,0,.276304,.761427,963605e-10,0,.304862,.74094,968088e-10,0,.334584,.720233,981481e-10,0,.365322,.698592,979122e-10,0,.396826,.676763,981057e-10,0,.428571,.654808,973956e-10,0,.460318,.632326,962619e-10,0,.492064,.610049,952996e-10,0,.52381,.58763,933334e-10,0,.555556,.565261,917573e-10,0,.587302,.543244,896636e-10,0,.619048,.521273,873304e-10,0,.650794,.499818,852648e-10,0,.68254,.478536,823961e-10,0,.714286,.457826,79939e-9,0,.746032,.437549,77126e-9,0,.777778,.41776,743043e-10,0,.809524,.39863,716426e-10,0,.84127,.379954,686456e-10,0,.873016,.362025,660514e-10,0,.904762,.344581,630755e-10,0,.936508,.327909,605439e-10,0,.968254,.311736,576345e-10,0,1,1,263344e-13,0,0,1,263373e-13,0,0,1,263815e-13,0,0,1,265753e-13,0,0,1,271132e-13,0,0,.999999,283279e-13,0,0,.999997,30833e-12,0,0,.999995,358711e-13,0,0,.999992,461266e-13,0,0,.999985,67574e-12,0,0,.999977,11358e-11,0,0,.999966,213657e-12,0,0,.999948,431151e-12,0,0,.999923,896656e-12,0,0,.999884,186603e-11,0,0,.999826,381115e-11,0,0,.999732,754184e-11,0,0,.999561,143192e-10,0,0,.999191,257061e-10,0,0,.997955,405724e-10,0,744132e-10,.992228,276537e-10,0,716477e-9,.987638,208885e-10,0,.0022524,.983395,215226e-10,0,.00484816,.978614,270795e-10,0,.00860962,.972389,365282e-10,0,.0136083,.964392,474747e-10,0,.0198941,.95861,509141e-10,0,.0275023,.952806,48963e-9,0,.0364584,.94712,571119e-10,0,.04678,.940104,671704e-10,0,.0584799,.930398,687586e-10,0,.0715665,.919866,738161e-10,0,.086045,.907853,813235e-10,0,.101918,.894078,834582e-10,0,.119186,.881177,892093e-10,0,.137845,.867575,944548e-10,0,.157891,.852107,969607e-10,0,.179316,.835502,101456e-9,0,.202106,.81756,103256e-9,0,.226243,.79984,106954e-9,0,.251704,.780998,108066e-9,0,.278451,.761132,110111e-9,0,.306436,.740429,110459e-9,0,.335586,.719836,111219e-9,0,.365796,.698467,11145e-8,0,.3969,.676446,110393e-9,0,.428571,.654635,110035e-9,0,.460318,.632411,108548e-9,0,.492064,.609986,106963e-9,0,.52381,.587872,105238e-9,0,.555556,.565528,102665e-9,0,.587302,.543563,100543e-9,0,.619048,.52176,976182e-10,0,.650794,.500188,947099e-10,0,.68254,.479204,919929e-10,0,.714286,.458413,886139e-10,0,.746032,.438314,857839e-10,0,.777778,.418573,82411e-9,0,.809524,.39947,792211e-10,0,.84127,.380892,759546e-10,0,.873016,.362953,727571e-10,0,.904762,.345601,695738e-10,0,.936508,.328895,664907e-10,0,.968254,.312808,634277e-10,0,1,1,628647e-13,0,0,1,628705e-13,0,0,1,629587e-13,0,0,1,633441e-13,0,0,.999999,644087e-13,0,0,.999998,667856e-13,0,0,.999997,715889e-13,0,0,.999995,809577e-13,0,0,.999989,992764e-13,0,0,.999983,135834e-12,0,0,.999974,210482e-12,0,0,.999959,365215e-12,0,0,.999939,686693e-12,0,0,.999911,13472e-10,0,0,.999868,26731e-10,0,0,.999804,524756e-11,0,0,.9997,100403e-10,0,0,.99951,185019e-10,0,0,.999078,322036e-10,0,620676e-11,.997428,470002e-10,0,341552e-9,.99162,287123e-10,0,.00143727,.987479,234706e-10,0,.00349201,.983582,260083e-10,0,.0066242,.979186,337927e-10,0,.0109113,.97325,454689e-10,0,.0164064,.965221,573759e-10,0,.0231463,.957262,544114e-10,0,.0311571,.952211,587006e-10,0,.0404572,.946631,692256e-10,0,.0510592,.939391,787819e-10,0,.0629723,.929795,792368e-10,0,.0762025,.91965,875075e-10,0,.090753,.907737,950903e-10,0,.106626,.893899,972963e-10,0,.123822,.880239,10459e-8,0,.142337,.866562,107689e-9,0,.16217,.85164,113081e-9,0,.183314,.835021,116636e-9,0,.20576,.817311,120074e-9,0,.229496,.798845,121921e-9,0,.254502,.780479,12475e-8,0,.280753,.760694,125255e-9,0,.308212,.740142,126719e-9,0,.336825,.719248,12636e-8,0,.366517,.698209,126712e-9,0,.397167,.676398,125769e-9,0,.428578,.654378,124432e-9,0,.460318,.632484,123272e-9,0,.492064,.610113,12085e-8,0,.52381,.587931,118411e-9,0,.555556,.565872,11569e-8,0,.587302,.543814,112521e-9,0,.619048,.522265,109737e-9,0,.650794,.500835,106228e-9,0,.68254,.479818,102591e-9,0,.714286,.459258,991288e-10,0,.746032,.439061,952325e-10,0,.777778,.419552,91895e-9,0,.809524,.400399,879051e-10,0,.84127,.381976,844775e-10,0,.873016,.364009,806316e-10,0,.904762,.346761,771848e-10,0,.936508,.330049,735429e-10,0,.968254,.314018,702103e-10,0,1,1,139968e-12,0,0,1,139979e-12,0,0,1,140145e-12,0,0,1,14087e-11,0,0,.999999,142865e-12,0,0,.999998,147279e-12,0,0,.999997,156057e-12,0,0,.999992,17276e-11,0,0,.999989,204352e-12,0,0,.99998,26494e-11,0,0,.999969,383435e-12,0,0,.999953,618641e-12,0,0,.999929,108755e-11,0,0,.999898,201497e-11,0,0,.999849,381346e-11,0,0,.999778,719815e-11,0,0,.999661,133215e-10,0,0,.999451,238313e-10,0,0,.998936,401343e-10,0,113724e-9,.99662,517346e-10,0,820171e-9,.991094,304323e-10,0,.00238143,.987487,281757e-10,0,.00493527,.983731,320048e-10,0,.00856859,.979647,423905e-10,0,.0133393,.973837,562935e-10,0,.0192863,.96584,677442e-10,0,.0264369,.956309,623073e-10,0,.03481,.951523,704131e-10,0,.0444184,.946003,836594e-10,0,.0552713,.938454,911736e-10,0,.0673749,.929279,938264e-10,0,.0807329,.919239,103754e-9,0,.0953479,.907293,109928e-9,0,.111221,.893936,115257e-9,0,.128352,.879674,122265e-9,0,.14674,.865668,125733e-9,0,.166382,.850998,132305e-9,0,.187276,.834498,134844e-9,0,.209413,.816903,139276e-9,0,.232786,.798235,140984e-9,0,.257382,.779724,14378e-8,0,.283181,.760251,144623e-9,0,.310156,.739808,145228e-9,0,.338269,.718762,14539e-8,0,.367461,.697815,144432e-9,0,.397646,.67631,143893e-9,0,.428685,.654278,141846e-9,0,.460318,.632347,13935e-8,0,.492064,.610296,137138e-9,0,.52381,.588039,133806e-9,0,.555556,.566218,130755e-9,0,.587302,.544346,127128e-9,0,.619048,.522701,123002e-9,0,.650794,.501542,119443e-9,0,.68254,.480508,115055e-9,0,.714286,.460092,111032e-9,0,.746032,.440021,106635e-9,0,.777778,.420446,102162e-9,0,.809524,.401512,98184e-9,0,.84127,.38299,936497e-10,0,.873016,.365232,89813e-9,0,.904762,.347865,853073e-10,0,.936508,.331342,817068e-10,0,.968254,.315202,773818e-10,0,1,1,29368e-11,0,0,1,2937e-10,0,0,1,293998e-12,0,0,1,295298e-12,0,0,.999999,298865e-12,0,0,.999998,3067e-10,0,0,.999995,322082e-12,0,0,.999992,350767e-12,0,0,.999986,403538e-12,0,0,.999976,501372e-12,0,0,.999964,68562e-11,0,0,.999945,10374e-10,0,0,.999919,171269e-11,0,0,.999882,300175e-11,0,0,.999829,542144e-11,0,0,.999749,984182e-11,0,0,.99962,176213e-10,0,0,.999382,305995e-10,0,138418e-10,.998751,496686e-10,0,389844e-9,.995344,510733e-10,0,.00150343,.990768,345829e-10,0,.00352451,.987464,342841e-10,0,.00655379,.983846,399072e-10,0,.0106554,.980007,533219e-10,0,.0158723,.974494,696992e-10,0,.0222333,.96622,776754e-10,0,.029758,.956273,747718e-10,0,.0384596,.950952,864611e-10,0,.0483473,.945215,100464e-9,0,.0594266,.937287,103729e-9,0,.0717019,.928649,111665e-9,0,.0851752,.918791,12353e-8,0,.0998479,.906685,127115e-9,0,.115721,.893706,13628e-8,0,.132794,.879248,142427e-9,0,.151067,.864685,148091e-9,0,.170538,.850032,153517e-9,0,.191204,.833853,157322e-9,0,.213063,.816353,161086e-9,0,.236107,.797834,164111e-9,0,.260329,.778831,165446e-9,0,.285714,.759756,167492e-9,0,.312243,.739419,166928e-9,0,.339887,.718491,167e-6,0,.368604,.697392,165674e-9,0,.398329,.676102,163815e-9,0,.428961,.654243,162003e-9,0,.460331,.632176,158831e-9,0,.492064,.610407,155463e-9,0,.52381,.588394,152062e-9,0,.555556,.56645,147665e-9,0,.587302,.5449,14375e-8,0,.619048,.523276,138905e-9,0,.650794,.502179,134189e-9,0,.68254,.481359,129392e-9,0,.714286,.46092,124556e-9,0,.746032,.441084,11957e-8,0,.777778,.421517,114652e-9,0,.809524,.402721,109688e-9,0,.84127,.384222,104667e-9,0,.873016,.366534,999633e-10,0,.904762,.349205,950177e-10,0,.936508,.332702,907301e-10,0,.968254,.316599,859769e-10,0,1,1,585473e-12,0,0,1,585507e-12,0,0,1,58602e-11,0,0,.999999,588259e-12,0,0,.999999,594381e-12,0,0,.999998,607754e-12,0,0,.999995,633729e-12,0,0,.99999,68137e-11,0,0,.999984,767003e-12,0,0,.999973,921212e-12,0,0,.999959,120218e-11,0,0,.999936,172024e-11,0,0,.999907,268088e-11,0,0,.999866,445512e-11,0,0,.999806,768481e-11,0,0,.999716,1342e-8,0,0,.999576,232473e-10,0,0,.9993,391694e-10,0,129917e-9,.998498,608429e-10,0,845035e-9,.994132,489743e-10,0,.00237616,.99031,384644e-10,0,.00484456,.987409,421768e-10,0,.00832472,.983981,504854e-10,0,.0128643,.980268,671028e-10,0,.0184947,.974875,852749e-10,0,.025237,.966063,85531e-9,0,.0331046,.956779,900588e-10,0,.0421067,.950259,10577e-8,0,.0522487,.944239,119458e-9,0,.0635343,.936341,122164e-9,0,.0759654,.928047,134929e-9,0,.0895434,.918065,145544e-9,0,.104269,.906267,150531e-9,0,.120142,.893419,161652e-9,0,.137163,.878758,16593e-8,0,.15533,.863699,174014e-9,0,.174645,.848876,177877e-9,0,.195106,.833032,184049e-9,0,.21671,.815557,186088e-9,0,.239454,.797323,19054e-8,0,.263332,.778124,191765e-9,0,.288336,.758929,192535e-9,0,.314451,.738979,192688e-9,0,.341658,.718213,191522e-9,0,.369924,.696947,190491e-9,0,.399202,.675807,187913e-9,0,.429416,.654147,184451e-9,0,.460447,.63229,181442e-9,0,.492064,.610499,177139e-9,0,.523809,.588747,172596e-9,0,.555555,.566783,167457e-9,0,.587301,.545359,162518e-9,0,.619048,.523984,156818e-9,0,.650794,.502917,151884e-9,0,.68254,.482294,145514e-9,0,.714286,.461945,140199e-9,0,.746032,.442133,134101e-9,0,.777778,.422705,128374e-9,0,.809524,.403916,122996e-9,0,.84127,.38554,116808e-9,0,.873016,.367909,111973e-9,0,.904762,.350651,105938e-9,0,.936508,.334208,101355e-9,0,.968254,.318123,957629e-10,0,1,1,111633e-11,0,0,1,111639e-11,0,0,1,111725e-11,0,0,1,112096e-11,0,0,.999999,11311e-10,0,0,.999997,115315e-11,0,0,.999995,11956e-10,0,0,.999989,127239e-11,0,0,.999981,140772e-11,0,0,.999969,164541e-11,0,0,.999952,206607e-11,0,0,.999928,281783e-11,0,0,.999895,416835e-11,0,0,.999848,658728e-11,0,0,.999781,108648e-10,0,0,.999682,182579e-10,0,0,.999523,306003e-10,0,159122e-10,.999205,499862e-10,0,391184e-9,.998131,73306e-9,0,.00147534,.993334,513229e-10,0,.0034227,.99016,467783e-10,0,.00632232,.987321,523413e-10,0,.0102295,.984099,64267e-9,0,.0151794,.980432,843042e-10,0,.0211947,.974976,102819e-9,0,.0282899,.966429,996234e-10,0,.0364739,.957633,111074e-9,0,.0457522,.949422,128644e-9,0,.0561278,.943045,140076e-9,0,.0676023,.935448,146349e-9,0,.0801762,.927225,161854e-9,0,.0938499,.917033,169135e-9,0,.108623,.905762,179987e-9,0,.124496,.892879,189832e-9,0,.141469,.878435,195881e-9,0,.159541,.863114,20466e-8,0,.178713,.84776,209473e-9,0,.198985,.832084,214861e-9,0,.220355,.814915,217695e-9,0,.242823,.796711,220313e-9,0,.266385,.777603,22313e-8,0,.291036,.757991,222471e-9,0,.316767,.738371,222869e-9,0,.343563,.717872,221243e-9,0,.371402,.696619,218089e-9,0,.400248,.675379,21562e-8,0,.430047,.65411,21169e-8,0,.460709,.63241,206947e-9,0,.492079,.61046,201709e-9,0,.52381,.58903,196753e-9,0,.555556,.567267,189637e-9,0,.587302,.545886,184735e-9,0,.619048,.524714,177257e-9,0,.650794,.503789,171424e-9,0,.68254,.483204,164688e-9,0,.714286,.462976,157172e-9,0,.746032,.443294,151341e-9,0,.777778,.423988,143737e-9,0,.809524,.405325,138098e-9,0,.84127,.386981,130698e-9,0,.873016,.369436,125276e-9,0,.904762,.35219,118349e-9,0,.936508,.335804,11312e-8,0,.968254,.319749,106687e-9,0,1,1,204685e-11,0,0,1,204694e-11,0,0,1,204831e-11,0,0,.999999,205428e-11,0,0,.999999,207056e-11,0,0,.999997,210581e-11,0,0,.999993,21732e-10,0,0,.999987,229365e-11,0,0,.999979,250243e-11,0,0,.999965,286127e-11,0,0,.999947,348028e-11,0,0,.999918,455588e-11,0,0,.999881,643303e-11,0,0,.999828,970064e-11,0,0,.999753,153233e-10,0,0,.999642,24793e-9,0,0,.999464,402032e-10,0,122947e-9,.999089,635852e-10,0,807414e-9,.997567,857026e-10,0,.00227206,.992903,594912e-10,0,.00462812,.990011,578515e-10,0,.00794162,.987192,65399e-9,0,.0122534,.98418,819675e-10,0,.0175888,.980491,105514e-9,0,.0239635,.974779,121532e-9,0,.031387,.96675,119144e-9,0,.0398644,.958248,136125e-9,0,.0493982,.948884,155408e-9,0,.0599896,.941673,162281e-9,0,.0716382,.934521,176754e-9,0,.0843437,.926205,192873e-9,0,.0981056,.916089,200038e-9,0,.112923,.904963,213624e-9,0,.128796,.892089,221834e-9,0,.145725,.878028,232619e-9,0,.163709,.86249,238632e-9,0,.182749,.846587,247002e-9,0,.202847,.830988,250702e-9,0,.224001,.814165,255562e-9,0,.246214,.796135,257505e-9,0,.269482,.777052,258625e-9,0,.293805,.757201,258398e-9,0,.319176,.737655,256714e-9,0,.345587,.717477,255187e-9,0,.373021,.696433,251792e-9,0,.401454,.675084,247223e-9,0,.430844,.653907,242213e-9,0,.461125,.632561,237397e-9,0,.492187,.610658,229313e-9,0,.52381,.589322,224402e-9,0,.555556,.567857,216116e-9,0,.587302,.54652,209124e-9,0,.619048,.525433,201601e-9,0,.650794,.504679,192957e-9,0,.68254,.484203,186052e-9,0,.714286,.464203,177672e-9,0,.746032,.444549,170005e-9,0,.777778,.425346,162401e-9,0,.809524,.406706,1544e-7,0,.84127,.388576,147437e-9,0,.873016,.37094,139493e-9,0,.904762,.353996,133219e-9,0,.936508,.337391,125573e-9,0,.968254,.321648,119867e-9,0,1,1,362511e-11,0,0,1,362525e-11,0,0,1,362739e-11,0,0,.999999,363673e-11,0,0,.999998,366214e-11,0,0,.999996,371698e-11,0,0,.999992,382116e-11,0,0,.999986,400554e-11,0,0,.999976,432058e-11,0,0,.999961,485194e-11,0,0,.999938,574808e-11,0,0,.999908,726643e-11,0,0,.999865,984707e-11,0,0,.999807,142217e-10,0,0,.999723,215581e-10,0,0,.999602,336114e-10,0,119113e-10,.999398,527353e-10,0,355813e-9,.998946,805809e-10,0,.00137768,.996647,942908e-10,0,.00322469,.992298,668733e-10,0,.00597897,.989802,716564e-10,0,.00968903,.987019,821355e-10,0,.0143845,.984219,104555e-9,0,.0200831,.980425,131245e-9,0,.0267948,.974241,139613e-9,0,.034525,.967006,145931e-9,0,.0432757,.95893,167153e-9,0,.0530471,.949157,188146e-9,0,.0638386,.94062,194625e-9,0,.0756487,.933509,213721e-9,0,.0884762,.925088,229616e-9,0,.10232,.915178,239638e-9,0,.117178,.904093,254814e-9,0,.133051,.891337,263685e-9,0,.149939,.877326,274789e-9,0,.167841,.861794,280534e-9,0,.18676,.845758,289534e-9,0,.206696,.829792,294446e-9,0,.22765,.813037,296877e-9,0,.249625,.795285,300217e-9,0,.27262,.776323,299826e-9,0,.296636,.756673,299787e-9,0,.321671,.736856,297867e-9,0,.347718,.716883,294052e-9,0,.374768,.696089,289462e-9,0,.402804,.67505,285212e-9,0,.431796,.653509,27653e-8,0,.461695,.63258,271759e-9,0,.49242,.61104,262811e-9,0,.523822,.589567,255151e-9,0,.555556,.568322,246434e-9,0,.587302,.547235,237061e-9,0,.619048,.52616,228343e-9,0,.650794,.505716,219236e-9,0,.68254,.485274,209595e-9,0,.714286,.465411,201011e-9,0,.746032,.445854,19109e-8,0,.777778,.426911,182897e-9,0,.809524,.408222,173569e-9,0,.84127,.390307,165496e-9,0,.873016,.372624,156799e-9,0,.904762,.355804,14917e-8,0,.936508,.33924,140907e-9,0,.968254,.323534,134062e-9,0,1,1,622487e-11,0,0,1,62251e-10,0,0,1,622837e-11,0,0,.999999,624259e-11,0,0,.999998,628127e-11,0,0,.999996,636451e-11,0,0,.999991,65218e-10,0,0,.999984,679782e-11,0,0,.999973,726361e-11,0,0,.999955,803644e-11,0,0,.999931,931397e-11,0,0,.999896,114299e-10,0,0,.999847,149402e-10,0,0,.999784,207461e-10,0,0,.999692,302493e-10,0,0,.999554,454957e-10,0,997275e-10,.999326,690762e-10,0,724813e-9,.998757,101605e-9,0,.0020972,.995367,958745e-10,0,.00432324,.99209,832808e-10,0,.00746347,.989517,887601e-10,0,.0115534,.987008,10564e-8,0,.0166134,.98421,133179e-9,0,.0226552,.98021,161746e-9,0,.0296838,.973676,161821e-9,0,.0377016,.967052,178635e-9,0,.0467079,.959385,206765e-9,0,.0567013,.949461,22476e-8,0,.0676796,.939578,23574e-8,0,.0796403,.932416,25893e-8,0,.0925812,.923759,271228e-9,0,.106501,.914223,289165e-9,0,.121397,.902942,301156e-9,0,.13727,.890419,313852e-9,0,.15412,.876639,324408e-9,0,.171946,.861316,33249e-8,0,.190751,.84496,338497e-9,0,.210537,.828427,345861e-9,0,.231305,.811871,347863e-9,0,.253057,.794397,350225e-9,0,.275797,.775726,349915e-9,0,.299525,.75617,347297e-9,0,.324242,.736091,344232e-9,0,.349947,.716213,340835e-9,0,.376633,.695736,332369e-9,0,.404289,.674961,327943e-9,0,.432895,.653518,318533e-9,0,.462415,.632574,310391e-9,0,.492788,.61134,300755e-9,0,.523909,.590017,290506e-9,0,.555556,.568752,280446e-9,0,.587302,.548061,269902e-9,0,.619048,.52711,258815e-9,0,.650794,.506682,248481e-9,0,.68254,.486524,237141e-9,0,.714286,.466812,226872e-9,0,.746032,.44732,216037e-9,0,.777778,.428473,205629e-9,0,.809524,.409921,195691e-9,0,.84127,.392028,185457e-9,0,.873016,.374606,176436e-9,0,.904762,.357601,166508e-9,0,.936508,.341348,158385e-9,0,.968254,.32542,149203e-9,0,1,1,103967e-10,0,0,1,10397e-9,0,0,1,104019e-10,0,0,.999999,104231e-10,0,0,.999998,104806e-10,0,0,.999995,106042e-10,0,0,.999991,108366e-10,0,0,.999982,112415e-10,0,0,.999968,119174e-10,0,0,.99995,130227e-10,0,0,.999922,148176e-10,0,0,.999884,177303e-10,0,0,.99983,224564e-10,0,0,.999758,300966e-10,0,0,.999654,423193e-10,0,549083e-11,.999503,614848e-10,0,296087e-9,.999237,903576e-10,0,.00123144,.998491,1271e-7,0,.00295954,.994594,107754e-9,0,.00555829,.99178,103025e-9,0,.00907209,.989265,11154e-8,0,.0135257,.986998,136296e-9,0,.0189327,.984137,169154e-9,0,.0252993,.979798,196671e-9,0,.0326272,.97337,196678e-9,0,.0409157,.967239,223121e-9,0,.0501623,.959543,253809e-9,0,.0603638,.949466,265972e-9,0,.0715171,.939074,288372e-9,0,.0836187,.931118,310983e-9,0,.0966657,.922525,325561e-9,0,.110656,.912983,345725e-9,0,.125588,.901617,3556e-7,0,.141461,.889487,374012e-9,0,.158275,.875787,383445e-9,0,.176031,.860654,393972e-9,0,.19473,.844417,400311e-9,0,.214374,.82741,405004e-9,0,.234967,.810545,407378e-9,0,.256512,.793312,407351e-9,0,.279011,.774847,406563e-9,0,.302468,.755621,404903e-9,0,.326887,.735511,397486e-9,0,.352266,.715435,39357e-8,0,.378605,.695403,384739e-9,0,.405897,.674681,376108e-9,0,.43413,.65359,365997e-9,0,.463277,.632471,354957e-9,0,.493295,.61151,343593e-9,0,.524106,.59064,331841e-9,0,.555561,.569386,318891e-9,0,.587302,.548785,3072e-7,0,.619048,.528146,29361e-8,0,.650794,.507872,281709e-9,0,.68254,.487805,268627e-9,0,.714286,.468196,255887e-9,0,.746032,.448922,243997e-9,0,.777778,.430093,231662e-9,0,.809524,.411845,220339e-9,0,.84127,.393808,208694e-9,0,.873016,.376615,198045e-9,0,.904762,.359655,187375e-9,0,.936508,.343452,177371e-9,0,.968254,.32765,167525e-9,0,1,1,169351e-10,0,0,1,169356e-10,0,0,1,169427e-10,0,0,.999999,169736e-10,0,0,.999998,170575e-10,0,0,.999995,172372e-10,0,0,.99999,175739e-10,0,0,.999979,181568e-10,0,0,.999966,191206e-10,0,0,.999944,20677e-9,0,0,.999912,231644e-10,0,0,.999869,271268e-10,0,0,.999811,334272e-10,0,0,.99973,433979e-10,0,0,.999617,590083e-10,0,680315e-10,.999445,829497e-10,0,612796e-9,.999138,118019e-9,0,.00187408,.998095,156712e-9,0,.00395791,.993919,125054e-9,0,.00692144,.991333,126091e-9,0,.0107962,.989226,144912e-9,0,.0155986,.986954,175737e-9,0,.0213364,.983982,213883e-9,0,.0280114,.979128,234526e-9,0,.0356226,.973327,243725e-9,0,.0441668,.967416,2773e-7,0,.0536399,.959729,308799e-9,0,.0640376,.949758,322447e-9,0,.0753554,.939173,350021e-9,0,.0875893,.9296,370089e-9,0,.100736,.921181,391365e-9,0,.114793,.91164,413636e-9,0,.129759,.900435,427068e-9,0,.145632,.888183,441046e-9,0,.162412,.874772,454968e-9,0,.180101,.859566,461882e-9,0,.1987,.843579,471556e-9,0,.218213,.826453,474335e-9,0,.238641,.809164,477078e-9,0,.259989,.792179,47755e-8,0,.282262,.773866,472573e-9,0,.305464,.754944,469765e-9,0,.329599,.735133,462371e-9,0,.35467,.714858,453674e-9,0,.380678,.694829,443888e-9,0,.407622,.674453,432052e-9,0,.435493,.653685,420315e-9,0,.464275,.632666,406829e-9,0,.493938,.611676,392234e-9,0,.524422,.591193,379208e-9,0,.555624,.570145,36319e-8,0,.587302,.549566,349111e-9,0,.619048,.529278,334166e-9,0,.650794,.509026,318456e-9,0,.68254,.489186,30449e-8,0,.714286,.469662,289051e-9,0,.746032,.450691,275494e-9,0,.777778,.431841,261437e-9,0,.809524,.413752,247846e-9,0,.84127,.395951,235085e-9,0,.873016,.378633,222245e-9,0,.904762,.36194,210533e-9,0,.936508,.345599,198494e-9,0,.968254,.329999,188133e-9,0,1,1,269663e-10,0,0,1,26967e-9,0,0,1,269772e-10,0,0,.999999,270214e-10,0,0,.999998,271415e-10,0,0,.999994,27398e-9,0,0,.999988,278771e-10,0,0,.999977,287019e-10,0,0,.999961,300544e-10,0,0,.999937,322138e-10,0,0,.999904,356163e-10,0,0,.999854,409465e-10,0,0,.99979,492651e-10,0,0,.999699,621722e-10,0,88288e-11,.999572,819715e-10,0,223369e-9,.999381,111689e-9,0,.00105414,.999016,153862e-9,0,.0026493,.997437,187667e-9,0,.00508608,.993545,155672e-9,0,.00840554,.991135,161455e-9,0,.012629,.989157,188241e-9,0,.0177661,.986874,226229e-9,0,.0238198,.983714,268668e-9,0,.0307887,.978301,277109e-9,0,.0386688,.973227,303446e-9,0,.0474554,.967317,341851e-9,0,.0571428,.959477,370885e-9,0,.0677256,.950012,392753e-9,0,.0791988,.939484,42781e-8,0,.0915576,.928135,443866e-9,0,.104798,.919819,472959e-9,0,.118918,.910049,491551e-9,0,.133915,.899181,512616e-9,0,.149788,.886881,523563e-9,0,.166537,.87359,540183e-9,0,.184164,.858613,547386e-9,0,.202669,.842809,554809e-9,0,.222056,.825727,558316e-9,0,.242329,.808086,557824e-9,0,.263492,.790728,556346e-9,0,.285551,.772987,552672e-9,0,.30851,.7541,543738e-9,0,.332376,.734669,536107e-9,0,.357153,.714411,523342e-9,0,.382845,.694196,512238e-9,0,.409454,.674252,497465e-9,0,.436977,.65357,481096e-9,0,.465404,.632999,467054e-9,0,.494713,.611994,448771e-9,0,.524864,.591604,431889e-9,0,.555779,.571134,415238e-9,0,.587302,.550528,396369e-9,0,.619048,.530292,379477e-9,0,.650794,.510364,361488e-9,0,.68254,.490749,343787e-9,0,.714286,.471266,327822e-9,0,.746032,.452462,310626e-9,0,.777778,.433907,295352e-9,0,.809524,.415659,279179e-9,0,.84127,.398138,264685e-9,0,.873016,.380833,249905e-9,0,.904762,.364247,236282e-9,0,.936508,.348041,222905e-9,0,.968254,.332389,210522e-9,0,1,1,420604e-10,0,0,1,420614e-10,0,0,1,420757e-10,0,0,.999999,42138e-9,0,0,.999997,423067e-10,0,0,.999993,426668e-10,0,0,.999986,433372e-10,0,0,.999974,444857e-10,0,0,.999956,463554e-10,0,0,.99993,493105e-10,0,0,.999892,539077e-10,0,0,.999838,610005e-10,0,0,.999767,718822e-10,0,0,.999666,884581e-10,0,365471e-10,.999525,113398e-9,0,485623e-9,.999311,150043e-9,0,.00162096,.998865,200063e-9,0,.00355319,.996278,211014e-9,0,.00633818,.992956,189672e-9,0,.0100043,.991017,210262e-9,0,.0145648,.989055,244292e-9,0,.0200237,.986741,290481e-9,0,.0263798,.983288,334303e-9,0,.033629,.977784,340307e-9,0,.0417652,.973037,377864e-9,0,.0507821,.967181,4239e-7,0,.060673,.958971,443854e-9,0,.0714314,.950093,483039e-9,0,.0830518,.939552,517934e-9,0,.0955288,.927678,539449e-9,0,.108859,.918278,568604e-9,0,.123038,.908449,588505e-9,0,.138065,.897713,612473e-9,0,.153938,.885533,625575e-9,0,.170657,.872131,63854e-8,0,.188224,.857517,647034e-9,0,.20664,.841796,65209e-8,0,.225909,.824726,6544e-7,0,.246035,.807297,655744e-9,0,.267022,.789058,646716e-9,0,.288878,.77189,643898e-9,0,.311607,.753082,629973e-9,0,.335216,.7341,621564e-9,0,.359713,.714094,605171e-9,0,.385103,.693839,588752e-9,0,.41139,.673891,573294e-9,0,.438576,.653565,552682e-9,0,.466656,.633326,533446e-9,0,.495617,.612582,514635e-9,0,.525431,.59205,49303e-8,0,.556041,.571918,471842e-9,0,.587338,.551572,451713e-9,0,.619048,.531553,430049e-9,0,.650794,.51175,410445e-9,0,.68254,.49238,390098e-9,0,.714286,.473143,370033e-9,0,.746032,.45423,351205e-9,0,.777778,.435963,332049e-9,0,.809524,.41787,315021e-9,0,.84127,.400387,297315e-9,0,.873016,.383332,281385e-9,0,.904762,.366665,265397e-9,0,.936508,.350633,250601e-9,0,.968254,.334964,23589e-8,0,1,1,643736e-10,0,0,1,64375e-9,0,0,1,643947e-10,0,0,.999999,64481e-9,0,0,.999997,647143e-10,0,0,.999994,652119e-10,0,0,.999985,661359e-10,0,0,.999972,677116e-10,0,0,.999952,702599e-10,0,0,.999922,742517e-10,0,0,.99988,803906e-10,0,0,.99982,897315e-10,0,0,.999741,103838e-9,0,0,.999629,12496e-8,0,149024e-9,.999474,156161e-9,0,861027e-9,.999229,201034e-9,0,.00231198,.998662,259069e-9,0,.00458147,.995299,245439e-9,0,.00770895,.992732,24498e-8,0,.0117126,.990847,273211e-9,0,.0165989,.988911,316492e-9,0,.0223674,.98654,37161e-8,0,.0290135,.982636,410352e-9,0,.0365309,.977346,421756e-9,0,.0449117,.972909,475578e-9,0,.0541481,.966821,522482e-9,0,.0642326,.958686,545008e-9,0,.075158,.949754,589286e-9,0,.0869181,.939184,619995e-9,0,.0995074,.927505,654266e-9,0,.112922,.916606,682362e-9,0,.127157,.906707,704286e-9,0,.142212,.895937,725909e-9,0,.158085,.883913,743939e-9,0,.174776,.870642,755157e-9,0,.192287,.856241,764387e-9,0,.210619,.84069,771032e-9,0,.229775,.823728,765906e-9,0,.249761,.806481,767604e-9,0,.270582,.787924,754385e-9,0,.292243,.770588,749668e-9,0,.314753,.751991,731613e-9,0,.338118,.733407,717655e-9,0,.362347,.713688,700604e-9,0,.387447,.693595,678765e-9,0,.413424,.673426,657042e-9,0,.440284,.65359,635892e-9,0,.468027,.633576,611569e-9,0,.496645,.613144,586011e-9,0,.526122,.592711,563111e-9,0,.556417,.572722,537699e-9,0,.587451,.552762,512556e-9,0,.619048,.532985,489757e-9,0,.650794,.513219,464139e-9,0,.68254,.493992,442193e-9,0,.714286,.47509,418629e-9,0,.746032,.456287,397045e-9,0,.777778,.438152,375504e-9,0,.809524,.420294,35492e-8,0,.84127,.402749,335327e-9,0,.873016,.385879,316422e-9,0,.904762,.369352,298333e-9,0,.936508,.353301,281417e-9,0,.968254,.337781,265203e-9,0,1,1,968267e-10,0,0,1,968284e-10,0,0,1,968556e-10,0,0,.999999,969733e-10,0,0,.999997,972913e-10,0,0,.999993,979688e-10,0,0,.999984,992239e-10,0,0,.999969,101356e-9,0,0,.999946,104784e-9,0,0,.999913,110111e-9,0,0,.999868,118217e-9,0,0,.999801,130396e-9,0,0,.999712,148523e-9,0,124907e-10,.999589,175233e-9,0,355405e-9,.999416,213999e-9,0,.0013528,.999136,268529e-9,0,.00312557,.998367,333088e-9,0,.00573045,.994701,304757e-9,0,.00919397,.992497,318031e-9,0,.0135261,.990608,353863e-9,0,.0187278,.988715,409044e-9,0,.0247947,.986241,472967e-9,0,.0317196,.981696,495104e-9,0,.039494,.977097,532873e-9,0,.0481087,.972583,594447e-9,0,.0575549,.966142,636867e-9,0,.0678242,.95823,669899e-9,0,.0789089,.949677,719499e-9,0,.0908023,.939226,750584e-9,0,.103499,.927501,793183e-9,0,.116993,.915199,81995e-8,0,.131282,.90498,847654e-9,0,.146364,.894243,868929e-9,0,.162237,.882154,884278e-9,0,.178902,.869161,898108e-9,0,.196358,.854751,901254e-9,0,.21461,.839368,90679e-8,0,.23366,.822874,901541e-9,0,.253512,.805514,897297e-9,0,.274174,.78716,881856e-9,0,.29565,.769061,870032e-9,0,.31795,.751,851719e-9,0,.341081,.732614,830671e-9,0,.365053,.713171,806569e-9,0,.389874,.693472,78338e-8,0,.415553,.673528,756404e-9,0,.442098,.653397,726872e-9,0,.469512,.633781,700494e-9,0,.497794,.613877,67105e-8,0,.526935,.593506,640361e-9,0,.556908,.573667,613502e-9,0,.587657,.553932,583177e-9,0,.61906,.534345,554375e-9,0,.650794,.515042,527811e-9,0,.68254,.495674,499367e-9,0,.714286,.477132,47429e-8,0,.746032,.458609,447726e-9,0,.777778,.440354,424205e-9,0,.809524,.422765,399549e-9,0,.84127,.405472,378315e-9,0,.873016,.388482,355327e-9,0,.904762,.372191,336122e-9,0,.936508,.356099,315247e-9,0,.968254,.340737,29794e-8,0,1,1,143327e-9,0,0,1,14333e-8,0,0,1,143366e-9,0,0,.999999,143524e-9,0,0,.999996,143952e-9,0,0,.999991,144862e-9,0,0,.999981,146544e-9,0,0,.999966,149391e-9,0,0,.999941,153946e-9,0,0,.999905,160971e-9,0,0,.999852,171562e-9,0,0,.99978,18729e-8,0,0,.999681,210386e-9,0,826239e-10,.999546,243906e-9,0,664807e-9,.999352,291739e-9,0,.00196192,.999027,357419e-9,0,.00405941,.997886,422349e-9,0,.00699664,.99419,385008e-9,0,.0107896,.99214,409775e-9,0,.0154415,.990274,456418e-9,0,.0209488,.988455,527008e-9,0,.0273037,.985804,597685e-9,0,.0344969,.98103,613124e-9,0,.0425183,.976674,668321e-9,0,.0513575,.972021,736985e-9,0,.0610046,.965274,773789e-9,0,.0714508,.958046,830852e-9,0,.0826877,.949333,875766e-9,0,.0947085,.939135,917088e-9,0,.107507,.927119,952244e-9,0,.121078,.91469,990626e-9,0,.135419,.903006,.00101304,0,.150526,.892368,.00103834,0,.166399,.880231,.00105002,0,.183038,.867432,.00106331,0,.200443,.853208,.00106783,0,.218618,.837956,.00106458,0,.237566,.821772,.00105945,0,.257291,.804328,.00104685,0,.2778,.786465,.00103178,0,.2991,.768004,.00101077,0,.321199,.74972,985504e-9,0,.344106,.731682,962893e-9,0,.36783,.712813,932146e-9,0,.392383,.693139,89871e-8,0,.417774,.673566,869678e-9,0,.444013,.653483,835525e-9,0,.471107,.633891,799853e-9,0,.49906,.614433,766838e-9,0,.527869,.594586,732227e-9,0,.557517,.574769,696442e-9,0,.587966,.555149,663935e-9,0,.61913,.535898,629826e-9,0,.650794,.516753,596486e-9,0,.68254,.497816,567078e-9,0,.714286,.479034,534399e-9,0,.746032,.460975,507013e-9,0,.777778,.442935,477421e-9,0,.809524,.425263,451101e-9,0,.84127,.408248,424964e-9,0,.873016,.391339,39993e-8,0,.904762,.37513,377619e-9,0,.936508,.359172,354418e-9,0,.968254,.343876,334823e-9,0,1,1,209042e-9,0,0,1,209045e-9,0,0,1,209093e-9,0,0,.999999,209304e-9,0,0,.999996,209871e-9,0,0,.999991,211078e-9,0,0,.999979,213304e-9,0,0,.999963,217061e-9,0,0,.999933,223042e-9,0,0,.999894,232206e-9,0,0,.999837,245901e-9,0,0,.999756,266023e-9,0,102927e-11,.999648,295204e-9,0,233468e-9,.999499,336958e-9,0,.00108237,.999283,395563e-9,0,.00268832,.998896,473785e-9,0,.00511138,.997006,520008e-9,0,.00837705,.993819,497261e-9,0,.0124928,.991632,523722e-9,0,.0174561,.989875,587258e-9,0,.0232596,.988109,676329e-9,0,.0298932,.985155,747701e-9,0,.0373453,.980479,768803e-9,0,.0456045,.976271,841054e-9,0,.0546593,.971347,911469e-9,0,.0644994,.964528,953057e-9,0,.0751152,.957632,.00102221,0,.0864981,.948681,.00106122,0,.0986407,.938716,.00111857,0,.111537,.926629,.00114762,0,.125182,.914025,.00118995,0,.139571,.901026,.00121228,0,.154703,.890358,.00123946,0,.170576,.878283,.0012527,0,.18719,.865459,.00125536,0,.204547,.851407,.00126134,0,.222648,.836276,.00124759,0,.241498,.820436,.00124443,0,.261101,.803253,.00122071,0,.281465,.785562,.00120107,0,.302595,.76718,.00117762,0,.324501,.748551,.00114289,0,.347192,.730564,.00110872,0,.370679,.712253,.00107636,0,.394973,.692867,.00103646,0,.420085,.673695,996793e-9,0,.446027,.653912,95675e-8,0,.47281,.634129,916739e-9,0,.500441,.615004,874401e-9,0,.528921,.595587,833411e-9,0,.558244,.575965,794556e-9,0,.588384,.5566,75196e-8,0,.619281,.537428,716381e-9,0,.650795,.518623,676558e-9,0,.68254,.499964,64074e-8,0,.714286,.481356,605984e-9,0,.746032,.463279,570256e-9,0,.777778,.445673,540138e-9,0,.809524,.428032,507299e-9,0,.84127,.411112,479553e-9,0,.873016,.394444,450737e-9,0,.904762,.378247,424269e-9,0,.936508,.362415,399111e-9,0,.968254,.347103,375274e-9,0,1,1,300729e-9,0,0,1,300733e-9,0,0,1,300797e-9,0,0,.999998,301072e-9,0,0,.999996,301817e-9,0,0,.999989,303398e-9,0,0,.999977,306309e-9,0,0,.999958,311209e-9,0,0,.999927,318975e-9,0,0,.999884,330804e-9,0,0,.99982,34834e-8,0,0,.999733,373854e-9,0,326995e-10,.999613,410424e-9,0,477174e-9,.999447,462047e-9,0,.00161099,.999204,533322e-9,0,.00353153,.998725,624964e-9,0,.00627965,.995871,631786e-9,0,.0098693,.993194,632017e-9,0,.0143011,.991541,68923e-8,0,.019568,.989773,766892e-9,0,.0256593,.987647,863668e-9,0,.0325625,.984193,922089e-9,0,.0402647,.980016,970749e-9,0,.0487532,.975859,.00106027,0,.058016,.970514,.00112239,0,.0680419,.963625,.00117212,0,.0788208,.956959,.00125211,0,.0903439,.947956,.00129411,0,.102604,.93809,.00135879,0,.115594,.92659,.00139309,0,.129309,.913829,.00143253,0,.143745,.90005,.00145809,0,.158901,.888129,.0014748,0,.174774,.87607,.00148756,0,.191365,.863461,.00148714,0,.208674,.849594,.00148892,0,.226705,.834531,.00146496,0,.245461,.81903,.0014579,0,.264947,.802122,.00143039,0,.28517,.78445,.00139717,0,.306137,.766434,.00136312,0,.327857,.747816,.00132597,0,.350341,.729519,.00128323,0,.373598,.711454,.00123803,0,.397642,.692699,.00119097,0,.422485,.673723,.00114565,0,.448139,.654386,.00109552,0,.474619,.634673,.00104553,0,.501933,.615554,99985e-8,0,.530089,.596462,948207e-9,0,.559087,.577385,902299e-9,0,.588913,.558257,856448e-9,0,.619525,.5392,810395e-9,0,.650826,.520543,768558e-9,0,.68254,.502206,7239e-7,0,.714286,.48402,685794e-9,0,.746032,.465779,64471e-8,0,.777778,.448455,609583e-9,0,.809524,.431091,57227e-8,0,.84127,.414147,54042e-8,0,.873016,.39765,506545e-9,0,.904762,.381576,477635e-9,0,.936508,.365881,448446e-9,0,.968254,.350582,421424e-9,0,1,1,427144e-9,0,0,1,427151e-9,0,0,1,427232e-9,0,0,.999998,42759e-8,0,0,.999995,428555e-9,0,0,.999988,430603e-9,0,0,.999976,434368e-9,0,0,.999952,440688e-9,0,0,.999919,450667e-9,0,0,.999871,46578e-8,0,0,.999801,488024e-9,0,0,.999704,520092e-9,0,129791e-9,.999572,565553e-9,0,821056e-9,.999389,628906e-9,0,.00225241,.999114,714911e-9,0,.00449109,.998488,819218e-9,0,.00756249,.995234,80415e-8,0,.0114716,.993021,830181e-9,0,.0162131,.991407,902645e-9,0,.021776,.989625,996934e-9,0,.0281471,.987064,.00109707,0,.0353118,.983265,.00114353,0,.0432562,.979535,.0012272,0,.0519665,.975224,.00132642,0,.0614298,.969574,.00138092,0,.0716348,.963021,.00145896,0,.0825709,.956046,.00152834,0,.094229,.947136,.00158217,0,.106602,.937313,.0016347,0,.119682,.926073,.00168383,0,.133465,.913121,.00171627,0,.147947,.899165,.00174229,0,.163125,.885891,.00176137,0,.178998,.873783,.00176406,0,.195566,.861331,.00176156,0,.21283,.847569,.00175346,0,.230793,.832785,.00172753,0,.249459,.817442,.00170204,0,.268832,.800613,.00166576,0,.28892,.783597,.00162909,0,.30973,.76571,.0015826,0,.331271,.747021,.00153106,0,.353554,.728593,.00148036,0,.37659,.710661,.00142808,0,.400391,.692426,.00136906,0,.424973,.673623,.00131066,0,.450347,.65494,.00125569,0,.476531,.635448,.00119517,0,.503535,.616221,.00113828,0,.531372,.597531,.0010816,0,.560047,.578795,.00102673,0,.589554,.559892,970985e-9,0,.619869,.541307,919773e-9,0,.650923,.522608,868479e-9,0,.68254,.504484,82137e-8,0,.714286,.486603,772916e-9,0,.746032,.468802,730353e-9,0,.777778,.451172,684955e-9,0,.809524,.434348,647565e-9,0,.84127,.417445,605863e-9,0,.873016,.401077,571885e-9,0,.904762,.385039,536034e-9,0,.936508,.369483,504227e-9,0,.968254,.354272,473165e-9,0,1,1,599525e-9,0,0,1,599533e-9,0,0,1,599639e-9,0,0,.999998,600097e-9,0,0,.999994,601336e-9,0,0,.999987,603958e-9,0,0,.999972,608775e-9,0,0,.999949,616842e-9,0,0,.999912,629534e-9,0,0,.999857,648658e-9,0,0,.999781,676615e-9,0,538873e-11,.999674,716574e-9,0,308602e-9,.999528,772641e-9,0,.00127003,.999326,849806e-9,0,.00300783,.999009,952682e-9,0,.00556637,.998112,.00106394,0,.00895889,.994496,.00102228,0,.0131827,.992806,.00108586,0,.0182277,.991211,.0011759,0,.0240795,.989415,.00128955,0,.030723,.986499,.00139038,0,.0381418,.982679,.00144539,0,.046321,.978839,.00153954,0,.0552459,.974295,.00164417,0,.0649034,.968784,.00171517,0,.0752814,.962324,.00180282,0,.0863693,.954956,.00186387,0,.0981578,.94624,.00193817,0,.110639,.936517,.00198156,0,.123806,.925186,.00203042,0,.137655,.91252,.0020664,0,.15218,.898441,.00207822,0,.16738,.884394,.0020992,0,.183253,.871273,.00208748,0,.199799,.859057,.00208686,0,.21702,.845243,.00205519,0,.234918,.830723,.00202868,0,.253496,.815801,.00199501,0,.272761,.79914,.00194193,0,.292719,.782372,.00188824,0,.313377,.76482,.00183695,0,.334745,.746586,.00177418,0,.356833,.7281,.00170628,0,.379654,.709842,.00164063,0,.403221,.692019,.00157355,0,.427548,.67364,.00150262,0,.452651,.655277,.00143473,0,.478545,.636438,.00136371,0,.505246,.617364,.00129911,0,.532768,.598603,.00123014,0,.561122,.580195,.00116587,0,.590309,.561786,.00110398,0,.620318,.543377,.00104148,0,.651102,.525093,983984e-9,0,.682545,.506791,92667e-8,0,.714286,.489291,874326e-9,0,.746032,.471811,821734e-9,0,.777778,.454435,774698e-9,0,.809524,.437493,727302e-9,0,.84127,.420977,684039e-9,0,.873016,.404729,64373e-8,0,.904762,.388756,60285e-8,0,.936508,.373344,56765e-8,0,.968254,.358191,531929e-9,0,1,1,832169e-9,0,0,1,832178e-9,0,0,1,83231e-8,0,0,.999998,832893e-9,0,0,.999995,834465e-9,0,0,.999985,837791e-9,0,0,.999969,843893e-9,0,0,.999944,854086e-9,0,0,.999903,870071e-9,0,0,.999843,894042e-9,0,0,.999759,928865e-9,0,531805e-10,.999643,978242e-9,0,579365e-9,.99948,.00104684,0,.00182774,.999255,.00114012,0,.00387804,.998885,.00126188,0,.00675709,.997405,.00135888,0,.010468,.99424,.00133626,0,.0150018,.992458,.00140905,0,.0203443,.990929,.00152305,0,.0264786,.989116,.00165882,0,.0333875,.985624,.00174128,0,.0410536,.982003,.00182108,0,.0494609,.978336,.00194498,0,.0585941,.973184,.00202708,0,.0684396,.9678,.00212166,0,.0789851,.961348,.00221366,0,.0902199,.953841,.00228219,0,.102134,.94534,.00235662,0,.114721,.935552,.00240572,0,.127972,.924064,.00244405,0,.141884,.911827,.00247557,0,.156451,.897731,.00248374,0,.171672,.883409,.00249863,0,.187545,.868625,.00246688,0,.20407,.856529,.00246523,0,.221249,.842999,.00242368,0,.239083,.828505,.00237354,0,.257578,.813825,.00232588,0,.276738,.797813,.00226731,0,.296569,.781097,.00219704,0,.31708,.764038,.00212394,0,.338281,.746067,.00204786,0,.360181,.727687,.00196728,0,.382794,.709571,.00188779,0,.406133,.691503,.00180532,0,.430213,.673673,.00171849,0,.45505,.655732,.00164147,0,.480662,.637399,.00155858,0,.507065,.618616,.00147641,0,.534278,.60005,.00140125,0,.562313,.581713,.00132441,0,.59118,.563546,.00125014,0,.620875,.545605,.00118249,0,.651373,.527559,.0011116,0,.682593,.509764,.00104979,0,.714286,.49193,985977e-9,0,.746032,.475011,928592e-9,0,.777778,.457878,873466e-9,0,.809524,.440979,819585e-9,0,.84127,.424613,772365e-9,0,.873016,.408549,722195e-9,0,.904762,.392771,680014e-9,0,.936508,.377317,636797e-9,0,.968254,.362352,598318e-9,0,1,1,.00114313,0,0,1,.00114314,0,0,.999999,.00114331,0,0,.999998,.00114404,0,0,.999994,.00114601,0,0,.999984,.00115019,0,0,.999967,.00115784,0,0,.999937,.0011706,0,0,.999894,.00119054,0,0,.999828,.00122031,0,0,.999735,.00126331,0,169263e-9,.999606,.00132382,0,949167e-9,.999426,.0014071,0,.00249668,.999173,.00151895,0,.00486392,.99873,.00166102,0,.00806323,.996243,.0017023,0,.0120895,.993779,.00172782,0,.0169288,.9919,.0018108,0,.0225633,.990524,.00196028,0,.028974,.98868,.00212014,0,.036142,.984663,.00217598,0,.044049,.981457,.00230563,0,.0526781,.977608,.00243966,0,.0620137,.972215,.00251336,0,.0720418,.966798,.0026285,0,.0827499,.960241,.00271409,0,.0941271,.952489,.00278381,0,.106164,.944127,.00285399,0,.118852,.934282,.00290994,0,.132185,.923271,.00294558,0,.146157,.910803,.00296269,0,.160766,.896705,.00296803,0,.176007,.88238,.00296637,0,.19188,.867116,.00293163,0,.208385,.853636,.00289418,0,.225523,.840469,.00284663,0,.243296,.82639,.00278594,0,.261709,.811759,.00271618,0,.280767,.796113,.00263187,0,.300476,.779518,.00254589,0,.320845,.763142,.00246003,0,.341883,.745464,.00236529,0,.363601,.727491,.00226536,0,.386011,.709414,.00216375,0,.409128,.691396,.00207127,0,.432967,.67368,.00197106,0,.457545,.656049,.00187022,0,.482881,.638188,.00177605,0,.508992,.620177,.00168482,0,.535899,.601506,.00158909,0,.563619,.58362,.00150583,0,.592165,.565496,.00141791,0,.621544,.54789,.00133693,0,.651743,.530323,.00126038,0,.682709,.512795,.00118556,0,.714286,.495199,.00111527,0,.746032,.478101,.0010489,0,.777778,.461511,984264e-9,0,.809524,.444879,92591e-8,0,.84127,.428424,866582e-9,0,.873016,.412495,814463e-9,0,.904762,.396975,764498e-9,0,.936508,.381614,715967e-9,0,.968254,.366732,672483e-9,0,1,1,.00155501,0,0,1,.00155503,0,0,1,.00155524,0,0,.999998,.00155615,0,0,.999994,.0015586,0,0,.999983,.00156379,0,0,.999963,.0015733,0,0,.999932,.00158911,0,0,.999882,.00161376,0,0,.99981,.00165041,0,100875e-10,.999708,.00170304,0,367658e-9,.999565,.00177658,0,.0014234,.999368,.00187688,0,.00327939,.999081,.00200989,0,.00596629,.99852,.00217177,0,.0094852,.99549,.0021745,0,.013824,.993252,.00222357,0,.0189642,.991727,.00235022,0,.0248856,.989951,.00250561,0,.0315669,.988029,.00268829,0,.0389882,.984029,.0027496,0,.0471302,.980683,.00289793,0,.0559754,.976554,.00303315,0,.0655081,.97139,.00313257,0,.0757138,.965544,.00323656,0,.08658,.95912,.00333432,0,.0980954,.951183,.0034039,0,.110251,.942974,.00347515,0,.123038,.932642,.00350381,0,.13645,.922158,.00354519,0,.150482,.909404,.00353851,0,.165129,.896071,.0035435,0,.18039,.881206,.00349936,0,.196263,.866077,.00347256,0,.212748,.85093,.003415,0,.229847,.837703,.00333367,0,.247561,.823878,.003249,0,.265895,.809449,.00316347,0,.284854,.794379,.00306351,0,.304445,.778138,.0029499,0,.324675,.761997,.00284099,0,.345555,.744938,.00272104,0,.367095,.727212,.00260715,0,.389309,.709549,.00248855,0,.41221,.691704,.00236783,0,.435814,.673689,.00225178,0,.460138,.656453,.00213765,0,.485203,.639128,.00202178,0,.511028,.621512,.00191443,0,.537634,.603598,.00180977,0,.565041,.58559,.00170456,0,.593268,.567852,.00160927,0,.622327,.5503,.00151395,0,.652217,.533033,.00142499,0,.682907,.515942,.00133955,0,.714296,.498814,.0012602,0,.746032,.481595,.00118188,0,.777778,.465117,.00111171,0,.809524,.448865,.00104091,0,.84127,.432711,976618e-9,0,.873016,.416822,91859e-8,0,.904762,.401272,857704e-9,0,.936508,.386226,807172e-9,0,.968254,.371321,75464e-8,0,1,1,.00209596,0,0,1,.00209598,0,0,1,.00209624,0,0,.999997,.00209736,0,0,.999991,.00210039,0,0,.999979,.00210678,0,0,.999959,.00211847,0,0,.999925,.0021379,0,0,.99987,.00216809,0,0,.999791,.00221281,0,681487e-10,.999677,.00227669,0,658161e-9,.999521,.00236533,0,.00200635,.999301,.00248514,0,.0041779,.998977,.00264185,0,.00718648,.998191,.00281695,0,.0110239,.994801,.00278518,0,.015672,.993091,.00288774,0,.0211091,.991571,.00303931,0,.0273123,.9897,.00321643,0,.034259,.987023,.00337332,0,.0419282,.983289,.00346146,0,.0502998,.979892,.00363704,0,.0593562,.975111,.00373601,0,.069081,.970351,.0038842,0,.0794598,.964131,.00397053,0,.0904798,.957747,.00408078,0,.10213,.949536,.00413533,0,.1144,.941372,.00420305,0,.127284,.931049,.00422815,0,.140772,.920647,.00425048,0,.154862,.908033,.0042281,0,.169548,.895028,.00422026,0,.184828,.879968,.00415042,0,.200701,.864875,.00408821,0,.217167,.84918,.00400909,0,.234227,.834934,.00391178,0,.251884,.821397,.00380066,0,.270141,.807135,.00367974,0,.289004,.792363,.00355172,0,.308479,.776661,.003411,0,.328575,.760705,.00328123,0,.349301,.744408,.00314003,0,.370668,.726994,.0029906,0,.392689,.709598,.00285034,0,.415379,.692112,.00271179,0,.438754,.674435,.00257185,0,.46283,.65676,.00243425,0,.48763,.639982,.00230351,0,.513173,.622983,.0021777,0,.539482,.605471,.00204991,0,.566579,.58796,.00193759,0,.594488,.570463,.00181976,0,.623226,.553058,.00171497,0,.6528,.535894,.00161109,0,.683198,.519089,.00151394,0,.714354,.502454,.00142122,0,.746032,.485681,.00133488,0,.777778,.468935,.00124975,0,.809524,.452951,.00117309,0,.84127,.437139,.00110155,0,.873016,.421446,.00103124,0,.904762,.405951,966387e-9,0,.936508,.391003,908119e-9,0,.968254,.376198,848057e-9,0,1,1,.00280076,0,0,1,.00280078,0,0,.999999,.00280109,0,0,.999997,.00280246,0,0,.999992,.00280616,0,0,.999979,.00281396,0,0,.999956,.00282822,0,0,.999916,.00285186,0,0,.999857,.0028885,0,0,.999768,.00294259,0,196026e-9,.999645,.00301946,0,.00104842,.99947,.00312541,0,.00270199,.999229,.00326733,0,.00519449,.998852,.00344992,0,.00852602,.997558,.00361052,0,.0126804,.994417,.0035898,0,.017635,.992824,.00372393,0,.023365,.991344,.00390695,0,.0298456,.989337,.00410392,0,.0370529,.985811,.00420987,0,.0449651,.982772,.00437488,0,.0535615,.979001,.00455069,0,.0628243,.974102,.00464462,0,.0727368,.969197,.00480577,0,.0832844,.962759,.00487818,0,.0944545,.956207,.00498176,0,.106236,.947909,.00503392,0,.118619,.939596,.00507474,0,.131595,.929642,.00509798,0,.145159,.918807,.00508476,0,.159305,.906921,.00505634,0,.174028,.893312,.00498845,0,.189327,.878933,.0049133,0,.2052,.863986,.0048259,0,.221647,.847936,.00470848,0,.23867,.832253,.00456889,0,.25627,.818619,.00442726,0,.274453,.804788,.00427677,0,.293222,.790241,.00411906,0,.312585,.775162,.00394833,0,.33255,.759463,.00377366,0,.353126,.743598,.00361026,0,.374324,.72697,.00343627,0,.396158,.709646,.00326422,0,.418641,.69277,.00309717,0,.44179,.675371,.0029356,0,.465624,.657863,.00277712,0,.490163,.640772,.00261738,0,.515429,.624441,.0024737,0,.541445,.607497,.00233125,0,.568236,.590438,.00218994,0,.595828,.573224,.0020664,0,.624242,.556168,.00193526,0,.653496,.539232,.00182463,0,.683588,.522352,.00170735,0,.714482,.506172,.00160555,0,.746032,.489842,.00150451,0,.777778,.473463,.00140938,0,.809524,.457266,.00132568,0,.84127,.441609,.0012376,0,.873016,.426348,.00116265,0,.904762,.411002,.00108935,0,.936508,.396045,.00101946,0,.968254,.381448,955665e-9,0,1,1,.0037121,0,0,1,.00371213,0,0,1,.00371251,0,0,.999997,.00371417,0,0,.99999,.00371863,0,0,.999977,.00372807,0,0,.99995,.00374529,0,0,.999908,.0037738,0,0,.999843,.00381789,0,123596e-10,.999745,.00388273,0,407442e-9,.999608,.00397443,0,.0015447,.999415,.00409998,0,.00351385,.999143,.00426662,0,.0063316,.9987,.00447625,0,.00998679,.996363,.00455323,0,.0144569,.994021,.00461052,0,.0197151,.992372,.00476359,0,.0257344,.991007,.00499101,0,.0324882,.988767,.0051972,0,.0399517,.984872,.00528407,0,.0481022,.982004,.00548926,0,.0569191,.977714,.00564385,0,.0663839,.973076,.0057693,0,.0764801,.967565,.0058924,0,.0871928,.961384,.00599629,0,.0985095,.954435,.00605998,0,.110419,.946303,.0061133,0,.122912,.937662,.00612028,0,.13598,.927867,.00612209,0,.149617,.916475,.00604813,0,.163817,.90541,.00603088,0,.178577,.891591,.00592218,0,.193894,.877573,.00578854,0,.209767,.862511,.00566648,0,.226196,.846861,.00551481,0,.243182,.83068,.00533754,0,.260728,.815725,.00515487,0,.278837,.802321,.0049655,0,.297515,.787826,.00475421,0,.316768,.773454,.00456002,0,.336605,.758224,.00434727,0,.357034,.74265,.00414444,0,.378067,.726729,.00393738,0,.399717,.710155,.00373575,0,.421998,.693312,.00353736,0,.444928,.67653,.00334368,0,.468523,.659444,.00315981,0,.492806,.642051,.00297809,0,.517798,.625758,.00280592,0,.543525,.609615,.00264254,0,.570012,.592919,.00248459,0,.597288,.576298,.00233327,0,.625379,.559489,.00219519,0,.654307,.542891,.00205441,0,.684084,.526255,.00193385,0,.714693,.509853,.00180745,0,.746044,.494131,.00169817,0,.777778,.478114,.0015913,0,.809524,.462274,.00148981,0,.84127,.446412,.00139537,0,.873016,.431274,.00130984,0,.904762,.41635,.00122403,0,.936508,.401476,.00114809,0,.968254,.386993,.00107563,0,1,1,.00488216,0,0,1,.0048822,0,0,1,.00488265,0,0,.999997,.00488463,0,0,.999988,.00488999,0,0,.999974,.00490129,0,0,.999946,.00492191,0,0,.999897,.00495598,0,0,.999825,.00500855,0,744791e-10,.999718,.00508559,0,712744e-9,.999565,.005194,0,.00215249,.999352,.00534147,0,.00444576,.999046,.00553523,0,.00759218,.998492,.00577016,0,.0115714,.995564,.00578487,0,.0163557,.993339,.00586414,0,.021915,.991834,.00606002,0,.0282201,.990496,.00633312,0,.0352433,.987826,.00651941,0,.042959,.98383,.00660842,0,.0513439,.98109,.00685523,0,.0603772,.976131,.00695778,0,.0700402,.971922,.00714236,0,.0803163,.965901,.00721437,0,.0911908,.959606,.00732017,0,.102651,.952504,.00735788,0,.114686,.944365,.00738493,0,.127286,.935652,.00737969,0,.140443,.925813,.00733612,0,.154151,.914397,.00723094,0,.168405,.903257,.00714002,0,.183201,.890015,.00700149,0,.198536,.876014,.00682813,0,.214409,.861436,.00665567,0,.23082,.845752,.00644526,0,.24777,.829169,.00621635,0,.265263,.813435,.00597789,0,.283301,.799701,.00575694,0,.301889,.785726,.00549866,0,.321035,.77152,.0052503,0,.340746,.75683,.00499619,0,.361032,.741951,.0047543,0,.381904,.726367,.0045084,0,.403374,.710537,.00426784,0,.425457,.693965,.00403487,0,.448169,.677724,.0038075,0,.47153,.66117,.00359431,0,.495561,.644274,.00338354,0,.520284,.627449,.00318163,0,.545725,.611645,.00299672,0,.571911,.595614,.00281016,0,.598873,.579426,.00264252,0,.62664,.563016,.00247509,0,.655239,.546728,.00232647,0,.684692,.530539,.00217803,0,.714999,.514164,.00204216,0,.746106,.498344,.00191403,0,.777778,.482957,.00179203,0,.809524,.467336,.00167695,0,.84127,.451994,.00157567,0,.873016,.436514,.00147113,0,.904762,.42178,.00138034,0,.936508,.407271,.00129219,0,.968254,.392822,.0012098,0,1,1,.00637427,0,0,1,.00637431,0,0,.999999,.00637485,0,0,.999996,.00637721,0,0,.999987,.00638357,0,0,.999971,.006397,0,0,.999939,.00642142,0,0,.999888,.00646177,0,0,.999807,.00652387,0,207916e-9,.999689,.00661454,0,.00112051,.99952,.00674155,0,.00287719,.999283,.00691313,0,.00550145,.998936,.00713598,0,.00897928,.998165,.00738501,0,.0132829,.994847,.00734388,0,.01838,.993182,.00749991,0,.0242381,.991665,.0077246,0,.030826,.989708,.00797579,0,.0381152,.986663,.00813011,0,.0460794,.983288,.00830365,0,.0546951,.980104,.00853496,0,.0639411,.974855,.00861045,0,.0737988,.97045,.00879133,0,.0842516,.964509,.00886377,0,.0952848,.957594,.00890346,0,.106886,.950546,.00893289,0,.119044,.942225,.00890074,0,.131749,.933365,.00886826,0,.144994,.923202,.0087316,0,.158772,.912605,.00863082,0,.173078,.901099,.00847403,0,.187908,.888177,.00825838,0,.203261,.873955,.00801834,0,.219134,.860091,.00779026,0,.235527,.84434,.00752478,0,.252443,.828517,.00724074,0,.269883,.81239,.00693769,0,.287851,.79721,.00664817,0,.306352,.783489,.00634763,0,.325393,.769514,.00604221,0,.344981,.755419,.00573568,0,.365126,.741083,.00544359,0,.385839,.726059,.00515515,0,.407132,.710809,.00487139,0,.42902,.695052,.00459846,0,.45152,.678886,.00433412,0,.474651,.663042,.00407981,0,.498433,.646634,.00384264,0,.52289,.630117,.00360897,0,.548048,.613804,.00338863,0,.573936,.598338,.00318486,0,.600584,.582687,.00298377,0,.628027,.566809,.00280082,0,.656295,.550817,.00262255,0,.685417,.534937,.00245835,0,.715406,.519151,.00230574,0,.74624,.503118,.0021549,0,.777778,.487723,.00202008,0,.809524,.472725,.00189355,0,.84127,.457599,.00177108,0,.873016,.442558,.00165843,0,.904762,.427624,.00155494,0,.936508,.413171,.00145273,0,.968254,.399122,.00136454,0,1,1,.00826496,0,0,1,.00826499,0,0,1,.00826564,0,0,.999996,.00826842,0,0,.999987,.00827589,0,0,.999967,.00829167,0,0,.999933,.00832037,0,0,.999876,.00836768,0,109338e-10,.999786,.00844031,0,427145e-9,.999655,.00854603,0,.0016384,.999468,.00869337,0,.00372392,.999203,.008891,0,.00668513,.998803,.00914387,0,.0104968,.99748,.00935838,0,.015125,.994446,.00933309,0,.0205338,.99292,.00953084,0,.0266884,.991414,.0097893,0,.0335565,.989049,.0100228,0,.0411086,.98582,.0101664,0,.0493181,.982441,.0103582,0,.0581613,.978595,.0105292,0,.0676169,.973495,.0106274,0,.0776661,.968405,.0107261,0,.0882926,.962717,.0108234,0,.0994817,.955478,.0108102,0,.111221,.948275,.0107914,0,.123499,.940006,.0107161,0,.136308,.930831,.0106309,0,.149639,.920648,.0104083,0,.163485,.910205,.0102312,0,.177843,.898445,.0100051,0,.192707,.885986,.00971928,0,.208077,.872204,.00940747,0,.22395,.858436,.0091085,0,.240326,.843454,.00876595,0,.257208,.827437,.00839794,0,.274596,.811488,.00803692,0,.292496,.796039,.00767352,0,.310911,.781083,.0073097,0,.329849,.767642,.00694032,0,.349316,.753901,.00657476,0,.369323,.740131,.00622699,0,.38988,.725845,.0058838,0,.410999,.710991,.00555586,0,.432696,.696002,.00523089,0,.454987,.680461,.00492494,0,.47789,.664875,.00463464,0,.501426,.649273,.00435422,0,.52562,.63302,.0040875,0,.550498,.61705,.00384075,0,.576089,.601154,.00359557,0,.602427,.586008,.00337636,0,.629544,.570699,.00316019,0,.657479,.555166,.00296033,0,.686264,.539645,.00277552,0,.715924,.524159,.00259499,0,.746459,.508682,.00243257,0,.777789,.493163,.00227851,0,.809524,.478004,.00213083,0,.84127,.46347,.00199502,0,.873016,.448778,.00186967,0,.904762,.434105,.00174732,0,.936508,.419576,.00163861,0,.968254,.405541,.00153341,0,1,1,.0106462,0,0,1,.0106462,0,0,.999999,.010647,0,0,.999995,.0106502,0,0,.999985,.0106589,0,0,.999964,.0106773,0,0,.999925,.0107106,0,0,.999861,.0107655,0,712986e-10,.999763,.0108497,0,743959e-9,.999616,.0109716,0,.00227361,.999408,.0111408,0,.0046983,.999112,.0113659,0,.00800158,.998637,.0116475,0,.0121493,.996223,.0117231,0,.0171023,.994006,.0118064,0,.0228218,.992444,.0120254,0,.0292711,.991028,.0123314,0,.036417,.98803,.0124954,0,.0442295,.984816,.0126538,0,.0526815,.981399,.0128537,0,.0617492,.977085,.0129694,0,.0714114,.972154,.013091,0,.0816495,.966617,.0131166,0,.0924472,.960628,.0131583,0,.10379,.953295,.0131094,0,.115665,.94575,.0129966,0,.128062,.937654,.0128796,0,.140972,.927716,.0126477,0,.154387,.917932,.0123889,0,.168301,.907719,.012131,0,.182709,.89584,.0118013,0,.197608,.883526,.0114145,0,.212994,.870301,.0110075,0,.228867,.856272,.0106019,0,.245227,.842251,.0101938,0,.262074,.826466,.00973254,0,.279412,.810859,.0092846,0,.297244,.795051,.00883304,0,.315575,.780053,.00840272,0,.334412,.76575,.00796438,0,.35376,.752298,.00752526,0,.373631,.739153,.00711486,0,.394034,.725514,.00670361,0,.414983,.711473,.00632656,0,.436491,.696936,.00595206,0,.458575,.682126,.00559191,0,.481253,.667027,.00525362,0,.504547,.651875,.00493805,0,.528481,.636463,.00462848,0,.553081,.620641,.00433936,0,.578377,.604931,.00407,0,.604404,.589549,.00380864,0,.631197,.574712,.00357049,0,.658795,.559775,.00334466,0,.687238,.544514,.00312505,0,.716559,.529555,.00293199,0,.746776,.514402,.00274204,0,.777849,.499302,.00256647,0,.809524,.484114,.00239901,0,.84127,.469308,.00225148,0,.873016,.455133,.00210178,0,.904762,.440939,.0019727,0,.936508,.426627,.00184382,0,.968254,.412509,.00172548,0,1,1,.013628,0,0,1,.0136281,0,0,.999999,.0136289,0,0,.999995,.0136327,0,0,.999983,.0136427,0,0,.99996,.0136638,0,0,.999917,.0137022,0,0,.999846,.0137652,0,204597e-9,.999736,.0138615,0,.00116837,.999573,.0140007,0,.00303325,.99934,.0141927,0,.00580613,.999004,.0144457,0,.00945626,.998407,.0147489,0,.0139421,.995464,.014731,0,.0192202,.993328,.0148283,0,.0252495,.991799,.0150797,0,.0319921,.990397,.0154316,0,.0394138,.986835,.0155005,0,.0474843,.983938,.0157308,0,.0561763,.980154,.0158753,0,.0654661,.975659,.0159581,0,.0753326,.970171,.0159832,0,.0857571,.964803,.0160084,0,.0967236,.958366,.0159484,0,.108218,.950613,.0158001,0,.120227,.942874,.0155845,0,.132741,.935005,.0154292,0,.145751,.924991,.0150742,0,.159249,.914814,.0146757,0,.17323,.904743,.0143097,0,.187687,.893216,.0138695,0,.202619,.880769,.0133706,0,.218021,.868136,.0128606,0,.233894,.85469,.0123403,0,.250238,.840593,.0118091,0,.267052,.825808,.011253,0,.284341,.81009,.0107099,0,.302106,.79504,.0101636,0,.320354,.779757,.00964041,0,.33909,.764697,.00911896,0,.358322,.750913,.00859533,0,.378059,.738175,.00811592,0,.398311,.725242,.00764504,0,.41909,.711864,.00718885,0,.440412,.698009,.00675843,0,.462292,.683841,.00634984,0,.484748,.669391,.00595502,0,.507802,.654731,.00558671,0,.531477,.639805,.00523578,0,.555802,.624789,.00490834,0,.580805,.609325,.00459448,0,.606522,.593975,.00430342,0,.63299,.578983,.00403019,0,.66025,.564442,.0037707,0,.688346,.549835,.0035316,0,.717319,.535039,.00330255,0,.7472,.520403,.00308932,0,.777982,.505687,.00289335,0,.809524,.490939,.00270818,0,.84127,.476233,.0025343,0,.873016,.461624,.00237097,0,.904762,.447833,.00222065,0,.936508,.433992,.00207561,0,.968254,.420147,.00194955,0,1,1,.0173415,0,0,1,.0173416,0,0,.999999,.0173426,0,0,.999995,.0173468,0,0,.999983,.0173582,0,0,.999954,.0173822,0,0,.999908,.0174258,0,669501e-11,.999828,.0174973,0,427399e-9,.999705,.0176063,0,.00171019,.999524,.0177631,0,.0039248,.999263,.0179781,0,.00705382,.998878,.018258,0,.0110552,.998012,.0185551,0,.0158812,.994614,.0184264,0,.0214852,.993132,.0186385,0,.0278239,.991563,.0189067,0,.0348585,.989298,.0191577,0,.0425544,.986036,.0192522,0,.050881,.982558,.0194063,0,.059811,.978531,.019486,0,.0693209,.974198,.0195847,0,.0793895,.968148,.0194749,0,.0899984,.962565,.0194277,0,.101132,.956041,.0192991,0,.112775,.947749,.0189893,0,.124917,.94018,.018704,0,.137547,.93165,.0183458,0,.150655,.921798,.0178775,0,.164236,.911573,.0173618,0,.178281,.901569,.0168482,0,.192788,.890341,.016265,0,.207752,.877835,.0156199,0,.223171,.865472,.0149516,0,.239044,.852905,.0143274,0,.255371,.838906,.0136643,0,.272153,.824888,.0129903,0,.289393,.809977,.0123218,0,.307093,.794697,.0116572,0,.325259,.780028,.0110307,0,.343896,.765124,.0104236,0,.363012,.750411,.0098219,0,.382617,.737264,.00924397,0,.402719,.724799,.00868719,0,.423332,.712253,.00816476,0,.444469,.699267,.00767262,0,.466146,.685618,.00719746,0,.488383,.671736,.00673916,0,.511199,.657777,.00631937,0,.534618,.643497,.00592411,0,.558668,.62889,.00553928,0,.58338,.614299,.0051934,0,.608787,.599197,.00485985,0,.634929,.584175,.00454357,0,.661849,.569541,.00425787,0,.689594,.555193,.00397905,0,.718211,.540947,.00372364,0,.747742,.526593,.00348599,0,.778205,.512335,.00326103,0,.80953,.498017,.00305137,0,.84127,.483609,.00285485,0,.873016,.469368,.00267472,0,.904762,.455037,.00249945,0,.936508,.441493,.00234792,0,.968254,.428147,.00219936,0,1,1,.0219422,0,0,1,.0219423,0,0,.999998,.0219434,0,0,.999993,.0219481,0,0,.999981,.021961,0,0,.999949,.0219879,0,0,.999896,.0220367,0,593194e-10,.999808,.0221167,0,75364e-8,.99967,.0222383,0,.00237884,.999466,.0224125,0,.00495612,.999174,.0226495,0,.00844887,.998725,.0229525,0,.0128058,.996979,.0231123,0,.0179742,.994317,.0230742,0,.0239047,.992781,.0232895,0,.0305526,.991191,.0235734,0,.0378786,.987787,.0236152,0,.0458475,.985092,.0237994,0,.0544287,.981121,.0238553,0,.0635952,.976924,.0238706,0,.0733233,.97218,.0238704,0,.0835922,.965956,.0236598,0,.0943839,.959998,.0234735,0,.105682,.953245,.0232277,0,.117474,.944445,.0226973,0,.129747,.937087,.0223527,0,.142491,.928341,.0218144,0,.155697,.9184,.0211516,0,.169358,.907959,.0204553,0,.183469,.89808,.0197673,0,.198024,.887047,.0189915,0,.21302,.875221,.0182082,0,.228455,.86269,.0173584,0,.244329,.850735,.0165718,0,.260639,.837545,.0157524,0,.277389,.823639,.0149482,0,.29458,.809699,.0141431,0,.312216,.794797,.0133527,0,.3303,.780578,.0126193,0,.34884,.766019,.0118914,0,.367842,.751447,.0111839,0,.387315,.737275,.010514,0,.40727,.724545,.00987277,0,.427717,.712644,.00926569,0,.448671,.700432,.00869029,0,.470149,.687664,.00814691,0,.492167,.674288,.00763012,0,.514746,.660966,.00714437,0,.537911,.647264,.00668457,0,.561688,.633431,.00626581,0,.586108,.619133,.00585593,0,.611206,.604935,.00548188,0,.637022,.590236,.00513288,0,.663599,.575473,.0047906,0,.690989,.561228,.00448895,0,.719242,.547054,.00420233,0,.748411,.533175,.00392869,0,.778531,.519163,.00367445,0,.809583,.505328,.00344097,0,.84127,.491446,.00322003,0,.873016,.477356,.00301283,0,.904762,.46356,.00282592,0,.936508,.449623,.00264956,0,.968254,.436068,.00246956,0,1,1,.0276135,0,0,1,.0276136,0,0,.999998,.0276148,0,0,.999993,.0276201,0,0,.999976,.0276342,0,0,.999945,.027664,0,0,.999884,.0277179,0,18679e-8,.999784,.027806,0,.00119607,.99963,.0279394,0,.00318407,.999401,.0281295,0,.00613601,.999066,.0283858,0,.00999963,.998524,.0287027,0,.0147164,.995702,.0286256,0,.0202295,.993593,.0286733,0,.0264876,.992067,.0288989,0,.0334452,.990548,.0292135,0,.0410621,.986775,.0291296,0,.0493032,.984054,.0293099,0,.0581381,.979481,.0291881,0,.0675397,.975297,.0291598,0,.0774848,.96981,.028954,0,.0879528,.963524,.028628,0,.0989258,.957398,.0283135,0,.110388,.950088,.0278469,0,.122327,.941538,.0271798,0,.134729,.933332,.0265388,0,.147587,.924392,.0257776,0,.160889,.914581,.024916,0,.174631,.904347,.0240242,0,.188806,.894324,.0231229,0,.203409,.883724,.022153,0,.218437,.872207,.0211355,0,.233888,.859927,.0201048,0,.249761,.848373,.0191263,0,.266056,.836023,.0181306,0,.282774,.82289,.0171718,0,.299917,.809324,.0162196,0,.317488,.795361,.0152622,0,.335493,.781253,.01439,0,.353936,.767338,.013533,0,.372825,.753156,.0127244,0,.392168,.739122,.0119454,0,.411976,.725358,.0112054,0,.432259,.712949,.010487,0,.453032,.701621,.00984032,0,.47431,.689703,.00921495,0,.496111,.677216,.00862492,0,.518456,.664217,.00806882,0,.541367,.65137,.00755922,0,.564872,.638,.00705705,0,.589001,.62453,.00661266,0,.613789,.610601,.00618432,0,.639277,.59676,.00578033,0,.66551,.582433,.00540927,0,.692539,.568026,.00506104,0,.720422,.55414,.0047353,0,.749216,.540178,.00442889,0,.778974,.526513,.00414363,0,.809711,.512954,.00388237,0,.84127,.499403,.00362875,0,.873016,.486026,.00340827,0,.904762,.472345,.00318598,0,.936508,.458828,.00297635,0,.968254,.445379,.00279447,0,1,1,.0345716,0,0,1,.0345717,0,0,.999999,.034573,0,0,.999991,.0345787,0,0,.999974,.0345941,0,0,.999937,.0346263,0,188589e-11,.999869,.0346847,0,409238e-9,.999757,.0347798,0,.0017674,.999582,.0349233,0,.00413658,.999322,.0351265,0,.00747408,.998939,.0353967,0,.0117157,.998219,.0357018,0,.0167966,.994974,.0354726,0,.0226572,.993201,.0355621,0,.0292445,.991573,.0357641,0,.0365123,.989301,.0359252,0,.0444203,.985712,.0358017,0,.0529334,.982411,.0358353,0,.0620214,.977827,.035617,0,.0716574,.973278,.0354398,0,.0818186,.967397,.0350483,0,.0924846,.960696,.0344795,0,.103638,.954349,.0339861,0,.115263,.946066,.0331323,0,.127348,.938012,.032359,0,.13988,.929413,.0314413,0,.152849,.920355,.0304103,0,.166248,.910586,.0292785,0,.18007,.900609,.0281391,0,.194308,.890093,.0269103,0,.208958,.880013,.0257269,0,.224018,.869001,.0244671,0,.239485,.85751,.0232252,0,.255359,.84582,.0220117,0,.271638,.834383,.0208274,0,.288324,.822158,.0196628,0,.305419,.809056,.0185306,0,.322927,.795832,.0174174,0,.340851,.782547,.0163758,0,.359199,.7689,.015391,0,.377975,.755526,.0144488,0,.397189,.741681,.0135372,0,.416851,.728178,.0126957,0,.436971,.714642,.0118812,0,.457564,.702756,.0111165,0,.478644,.69175,.0104145,0,.500229,.680159,.00974439,0,.522339,.668073,.00911926,0,.544997,.655405,.00851393,0,.56823,.642921,.00797637,0,.592068,.629993,.00745119,0,.616546,.616828,.00696972,0,.641705,.603305,.00652425,0,.66759,.589833,.00610188,0,.694255,.575945,.00570834,0,.72176,.561745,.00533384,0,.750168,.548277,.00500001,0,.779545,.534467,.00467582,0,.809933,.521032,.00438092,0,.841272,.507877,.00410348,0,.873016,.494654,.00383618,0,.904762,.481592,.00358699,0,.936508,.468509,.00337281,0,.968254,.455293,.00316196,0,1,1,.0430698,0,0,1,.0430699,0,0,.999998,.0430713,0,0,.999991,.0430773,0,0,.99997,.0430936,0,0,.999928,.0431277,0,406396e-10,.999852,.0431893,0,744376e-9,.999724,.0432895,0,.0024806,.999527,.0434397,0,.00524779,.99923,.0436507,0,.00898164,.998783,.0439255,0,.0136083,.997507,.0441104,0,.0190582,.994418,.0438225,0,.0252694,.992864,.0439396,0,.0321879,.991127,.0440962,0,.039767,.987331,.0438408,0,.0479667,.984819,.0438991,0,.056752,.980384,.0435906,0,.0660929,.975846,.0432543,0,.075963,.970748,.0428293,0,.0863398,.964303,.042153,0,.0972035,.95772,.0414111,0,.108537,.950747,.0405893,0,.120325,.942533,.0394887,0,.132554,.934045,.0383544,0,.145215,.924942,.037057,0,.158296,.915811,.0356993,0,.17179,.90612,.0342401,0,.185691,.896434,.0328078,0,.199993,.886021,.031288,0,.214691,.876081,.0297776,0,.229782,.865608,.0282334,0,.245265,.854924,.026749,0,.261138,.843607,.02526,0,.277401,.832456,.0238214,0,.294056,.821342,.0224682,0,.311104,.809303,.0211297,0,.328548,.796468,.0198387,0,.346394,.784046,.0186227,0,.364645,.771262,.0174561,0,.38331,.758118,.0163806,0,.402396,.745075,.0153287,0,.421912,.731926,.0143647,0,.44187,.71863,.0134363,0,.462283,.705414,.0125603,0,.483165,.693792,.0117508,0,.504535,.683108,.0110016,0,.52641,.67183,.0102757,0,.548816,.66015,.00962044,0,.571776,.647907,.00898031,0,.595323,.635734,.00840811,0,.619489,.623208,.00786211,0,.644317,.610438,.00734953,0,.669852,.597345,.00687688,0,.696148,.584138,.00643469,0,.723267,.5707,.00602236,0,.75128,.556966,.0056324,0,.780258,.543607,.00528277,0,.810268,.530213,.00493999,0,.841311,.516912,.00462265,0,.873016,.503916,.0043307,0,.904762,.491146,.00406858,0,.936508,.478439,.00381436,0,.968254,.465834,.00358003,0,1,1,.0534039,0,0,1,.053404,0,0,.999998,.0534055,0,0,.999989,.0534116,0,0,.999968,.0534283,0,0,.999918,.0534633,0,155895e-9,.99983,.0535262,0,.00120914,.999685,.0536281,0,.00334944,.999461,.0537799,0,.00653077,.999119,.0539902,0,.0106718,.998582,.0542524,0,.0156907,.995919,.0540318,0,.0215147,.993735,.0538914,0,.0280801,.992126,.0539557,0,.0353323,.990266,.0540401,0,.0432247,.986317,.0536064,0,.0517172,.983213,.0534425,0,.0607754,.978303,.0528622,0,.0703698,.973665,.0523363,0,.0804742,.968091,.0516165,0,.0910667,.961026,.0505434,0,.102128,.954333,.049523,0,.113641,.946372,.0481698,0,.125591,.938254,.0467674,0,.137965,.929516,.0452341,0,.150754,.920106,.0435083,0,.163947,.910899,.0417399,0,.177537,.901532,.0399389,0,.191516,.891919,.0380901,0,.205881,.882006,.0362341,0,.220626,.871965,.0343444,0,.235749,.862145,.0324832,0,.251248,.852058,.0306681,0,.267121,.84161,.0289097,0,.283368,.830806,.0272079,0,.299992,.820476,.0256089,0,.316992,.809514,.0240394,0,.334374,.797865,.0225379,0,.35214,.785621,.0211235,0,.370296,.773765,.0197908,0,.388849,.761629,.0185235,0,.407807,.748891,.0173358,0,.427178,.736437,.0162305,0,.446974,.723707,.0151778,0,.467207,.710606,.0141791,0,.487892,.698019,.0132592,0,.509046,.686203,.0123887,0,.530687,.675692,.0115976,0,.552839,.664826,.0108325,0,.575527,.65349,.0101348,0,.59878,.641774,.00947756,0,.622634,.629794,.00886058,0,.647128,.617647,.00828526,0,.672308,.60534,.00775312,0,.698231,.592718,.00726033,0,.724958,.579746,.00679731,0,.752563,.566763,.00636111,0,.781127,.553515,.00595228,0,.810733,.540118,.00556876,0,.841426,.527325,.00523051,0,.873016,.514265,.00490712,0,.904762,.501406,.00460297,0,.936508,.488922,.00431247,0,.968254,.476541,.0040472,0,1,1,.0659184,0,0,1,.0659185,0,0,.999998,.06592,0,0,.999988,.0659259,0,0,.999963,.0659423,0,0,.999907,.0659764,0,374198e-9,.999806,.0660376,0,.00182071,.999639,.0661361,0,.0043894,.999378,.0662814,0,.00800055,.998985,.0664779,0,.0125594,.998285,.0666914,0,.0179786,.995071,.0661989,0,.0241822,.993172,.0660454,0,.031106,.991438,.0660105,0,.0386952,.988428,.0656875,0,.0469032,.985218,.0652913,0,.0556905,.981128,.0647107,0,.065023,.976015,.0638491,0,.0748717,.97097,.062993,0,.0852112,.964582,.0617927,0,.0960199,.957383,.0603626,0,.107279,.949969,.0588128,0,.118971,.941843,.0570274,0,.131084,.933624,.0551885,0,.143604,.924543,.053122,0,.156521,.914919,.0508897,0,.169825,.905773,.0486418,0,.18351,.896434,.0463364,0,.197569,.887195,.0440623,0,.211997,.877706,.0417799,0,.226789,.867719,.03945,0,.241944,.858587,.037243,0,.257458,.849317,.0350956,0,.273331,.839585,.0329852,0,.289563,.829856,.0310028,0,.306154,.819589,.0290953,0,.323108,.809714,.0272738,0,.340426,.79934,.0255631,0,.358113,.788224,.0239175,0,.376175,.776619,.0223831,0,.394616,.76521,.0209298,0,.413445,.753716,.0195786,0,.432671,.741564,.0183001,0,.452305,.729413,.0171259,0,.472358,.717146,.0159933,0,.492845,.70436,.0149495,0,.513783,.69219,.0139681,0,.535189,.680289,.0130577,0,.557087,.669611,.0122198,0,.5795,.659113,.0114174,0,.602459,.648148,.0106729,0,.625997,.636905,.00998997,0,.650154,.625154,.00934313,0,.674976,.613481,.00874839,0,.700518,.60154,.00818265,0,.726845,.58943,.00766889,0,.754032,.576828,.00717153,0,.782167,.564194,.00672696,0,.811344,.551501,.00630863,0,.841644,.538635,.00592177,0,.873016,.525724,.00554888,0,.904762,.513209,.00520225,0,.936508,.500457,.00488231,0,.968254,.48799,.00457153,0,1,1,.0810131,0,0,1,.0810133,0,0,.999997,.0810145,0,0,.999985,.08102,0,0,.999956,.0810347,0,195026e-10,.999893,.0810656,0,719316e-9,.999777,.0811205,0,.00259774,.999583,.081208,0,.00561807,.999281,.0813343,0,.00967472,.998813,.0814969,0,.0146627,.997597,.0815217,0,.0204902,.994379,.0808502,0,.0270802,.992744,.0806792,0,.0343674,.990745,.0804589,0,.0422974,.986646,.0796107,0,.0508242,.983611,.0790913,0,.0599087,.978869,.0780746,0,.0695175,.973475,.0768218,0,.0796223,.967845,.0754926,0,.0901983,.960778,.0737063,0,.101224,.953333,.0718052,0,.112682,.945274,.0695946,0,.124555,.936955,.0672492,0,.136831,.928319,.0647732,0,.149496,.919075,.0620947,0,.162542,.909114,.0591816,0,.175958,.900137,.0563917,0,.189739,.891069,.0535392,0,.203877,.882262,.0507642,0,.218368,.873232,.0479793,0,.233208,.864042,.045226,0,.248393,.855002,.0425413,0,.263923,.846569,.0400126,0,.279796,.837714,.0375269,0,.296012,.828918,.0352027,0,.312573,.819783,.0330011,0,.329479,.810129,.0308908,0,.346734,.800866,.0289112,0,.364342,.79093,.0270255,0,.382307,.780593,.0252758,0,.400637,.769511,.0236178,0,.419337,.758558,.0220652,0,.438418,.747632,.0206289,0,.457889,.736146,.0192873,0,.477761,.724093,.0180333,0,.49805,.71234,.0168264,0,.51877,.700201,.015746,0,.53994,.687949,.0147027,0,.561581,.676163,.0137512,0,.583718,.665001,.0128655,0,.60638,.65472,.0120366,0,.629599,.644213,.0112604,0,.653415,.633382,.0105413,0,.677874,.62212,.00986498,0,.70303,.610631,.00923308,0,.728948,.599078,.00864206,0,.755706,.587519,.00811784,0,.783396,.575505,.00761237,0,.812121,.563148,.00713949,0,.841989,.550828,.00668379,0,.873035,.538458,.00627715,0,.904762,.525905,.00588336,0,.936508,.513517,.00552687,0,.968254,.501395,.00519681,0,1,1,.0991506,0,0,1,.0991504,0,0,.999996,.0991515,0,0,.999984,.0991558,0,0,.999947,.0991672,0,114389e-9,.999874,.0991912,0,.00121503,.999739,.0992331,0,.00356108,.999514,.0992983,0,.00705578,.999159,.0993877,0,.011574,.998586,.0994837,0,.017003,.995731,.0988425,0,.0232484,.993384,.098276,0,.0302318,.991615,.0979269,0,.0378884,.989029,.0973432,0,.0461641,.985373,.0963539,0,.0550136,.981278,.0952306,0,.0643988,.975777,.0936233,0,.0742868,.970526,.0920219,0,.0846501,.963755,.0898912,0,.0954644,.956676,.0876064,0,.106709,.948099,.0847751,0,.118367,.939718,.0818638,0,.130423,.931305,.078857,0,.142862,.922342,.0756127,0,.155674,.912842,.0721473,0,.168849,.903304,.0686195,0,.182378,.89411,.0650589,0,.196255,.885512,.0616022,0,.210473,.877193,.0582434,0,.225027,.86877,.0548979,0,.239915,.860267,.0516095,0,.255132,.851915,.048468,0,.270678,.843912,.0454447,0,.286551,.83604,.0425612,0,.302751,.828245,.0398752,0,.31928,.820159,.0373198,0,.336138,.81167,.034916,0,.35333,.802659,.0326402,0,.370858,.793921,.0304901,0,.388728,.784713,.0284857,0,.406944,.774946,.0266186,0,.425515,.76448,.0248593,0,.444449,.753793,.0232114,0,.463756,.743506,.0217039,0,.483447,.732555,.0202841,0,.503535,.720965,.0189648,0,.524036,.709422,.0177189,0,.544968,.697756,.0165626,0,.56635,.685565,.015483,0,.588208,.673987,.0144892,0,.610569,.66244,.0135607,0,.633466,.651675,.0126956,0,.656936,.641598,.0118788,0,.681025,.63121,.0111261,0,.705788,.620514,.010437,0,.731289,.609366,.00978747,0,.757606,.598137,.00917257,0,.784834,.586966,.00859778,0,.813085,.575549,.00806803,0,.842485,.563797,.00757294,0,.87313,.551758,.00710592,0,.904762,.539894,.0066841,0,.936508,.527901,.00627901,0,.968254,.515819,.00590506,0,1,1,.120864,0,0,1,.120864,0,0,.999996,.120864,0,0,.99998,.120867,0,0,.99994,.120872,0,323781e-9,.999852,.120884,0,.00188693,.999693,.120903,0,.00473489,.999426,.120929,0,.00872704,.999002,.120955,0,.0137237,.998235,.120918,0,.0196068,.994608,.119764,0,.0262803,.992997,.119265,0,.0336657,.990968,.11863,0,.0416987,.987002,.117261,0,.0503261,.983524,.116009,0,.0595035,.97875,.114252,0,.0691935,.972652,.11193,0,.0793645,.966613,.109555,0,.0899894,.959275,.106612,0,.101045,.951272,.103375,0,.112512,.942323,.0996594,0,.124372,.933679,.0958841,0,.136611,.924822,.0919265,0,.149216,.915742,.0878061,0,.162176,.906348,.0834894,0,.175482,.896883,.079085,0,.189125,.88774,.0746745,0,.203098,.87986,.0705773,0,.217396,.871998,.0665005,0,.232015,.864325,.0625413,0,.24695,.856685,.0586781,0,.2622,.84925,.0550063,0,.277761,.841719,.0514727,0,.293634,.834755,.0481398,0,.309819,.827853,.0450172,0,.326315,.820888,.0420969,0,.343126,.813616,.0393702,0,.360254,.805767,.0367771,0,.377701,.797338,.0343274,0,.395474,.789122,.0320529,0,.413577,.780601,.0299485,0,.432018,.771424,.0279812,0,.450804,.761502,.0261054,0,.469944,.751166,.0243942,0,.489451,.741276,.0228087,0,.509337,.730898,.0213265,0,.529617,.719878,.0199307,0,.550307,.708379,.0186574,0,.571428,.697165,.0174446,0,.593003,.685554,.0163144,0,.615059,.673631,.015276,0,.637628,.662385,.0143003,0,.660746,.651059,.0134112,0,.68446,.640451,.0125794,0,.70882,.630536,.011793,0,.733893,.620316,.0110547,0,.759756,.609722,.0103668,0,.786505,.598804,.00973009,0,.814259,.587871,.00912812,0,.843157,.577121,.00858916,0,.87334,.566019,.00807333,0,.904762,.554664,.00759687,0,.936508,.543101,.00714759,0,.968254,.531558,.00673418,0,1,1,.146767,0,0,1,.146767,0,0,.999997,.146767,0,0,.999977,.146765,0,320658e-11,.999929,.146762,0,682576e-9,.999823,.146753,0,.00276402,.999633,.146735,0,.00614771,.999314,.146699,0,.0106613,.998796,.14662,0,.0161546,.997124,.146107,0,.0225063,.994062,.144857,0,.0296198,.992154,.144011,0,.037417,.989186,.142712,0,.0458348,.985279,.140926,0,.0548211,.980826,.13885,0,.0643326,.975056,.136168,0,.074333,.969005,.133217,0,.0847917,.961554,.12959,0,.0956828,.954206,.125886,0,.106984,.945046,.121335,0,.118675,.935678,.116492,0,.130741,.926748,.111635,0,.143166,.917764,.106625,0,.155939,.908358,.101325,0,.169049,.899219,.0960249,0,.182487,.890089,.0906527,0,.196245,.881488,.0853905,0,.210317,.874031,.0804177,0,.224697,.866932,.0756005,0,.23938,.859976,.0709019,0,.254364,.853375,.0664391,0,.269646,.846971,.0622012,0,.285223,.840483,.058129,0,.301096,.833969,.0542762,0,.317265,.82806,.0507042,0,.333729,.822128,.047368,0,.350491,.815989,.044272,0,.367554,.809336,.0413444,0,.38492,.802177,.038601,0,.402594,.79441,.0360227,0,.420582,.786573,.0336383,0,.438891,.778619,.0314321,0,.457527,.77,.029362,0,.476499,.760698,.0274102,0,.49582,.750932,.0256146,0,.5155,.740993,.023974,0,.535555,.731159,.0224182,0,.556,.720836,.0209889,0,.576855,.709913,.0196411,0,.598143,.698415,.0183824,0,.619888,.68745,.0172222,0,.642123,.676154,.0161509,0,.664883,.664383,.0151397,0,.688211,.6533,.0141873,0,.71216,.642072,.0133105,0,.736792,.631412,.0124932,0,.762186,.621622,.0117408,0,.788439,.611681,.0110358,0,.815672,.60142,.0103775,0,.844034,.59083,.00975623,0,.873699,.580254,.00918084,0,.904765,.569841,.00864721,0,.936508,.559224,.00815731,0,.968254,.548315,.00767924,0,1,1,.177563,0,0,1,.177563,0,0,.999994,.177562,0,0,.999972,.177555,0,664171e-10,.999914,.177536,0,.0012276,.999787,.177496,0,.00388025,.999556,.17742,0,.00783463,.999165,.177285,0,.0128953,.9985,.177037,0,.0189053,.995388,.175634,0,.025742,.993102,.174375,0,.033309,.990992,.173121,0,.0415298,.986932,.170896,0,.0503425,.982786,.16847,0,.0596964,.977592,.165455,0,.0695498,.971075,.161676,0,.0798676,.963967,.157458,0,.0906201,.956397,.152836,0,.101783,.947489,.147467,0,.113333,.937564,.14145,0,.125254,.928182,.135383,0,.137529,.919027,.129212,0,.150144,.909618,.12276,0,.163088,.900492,.116273,0,.176351,.891671,.1098,0,.189924,.883146,.103362,0,.203799,.875151,.0970799,0,.21797,.868338,.0911732,0,.232433,.862033,.0854966,0,.247182,.856107,.0800691,0,.262216,.850644,.0749618,0,.27753,.845261,.070079,0,.293124,.839885,.0654321,0,.308997,.834609,.0610975,0,.325149,.829083,.0569741,0,.341581,.82404,.0531736,0,.358294,.818968,.049665,0,.37529,.813496,.0463856,0,.392573,.807533,.0433217,0,.410148,.80099,.0404402,0,.428019,.793891,.0377578,0,.446192,.786281,.0352616,0,.464676,.778773,.0329577,0,.483478,.770737,.030808,0,.502608,.762094,.0287964,0,.522079,.752898,.0269254,0,.541905,.743306,.0251926,0,.5621,.733416,.023595,0,.582684,.723742,.0221155,0,.603677,.713542,.0207435,0,.625106,.702755,.019434,0,.646998,.691484,.0182046,0,.66939,.680531,.0170771,0,.692324,.66953,.0160339,0,.715849,.658126,.0150677,0,.740028,.646933,.0141551,0,.764937,.636107,.0133179,0,.790673,.625271,.0125284,0,.817358,.615225,.0117937,0,.84515,.605678,.0111181,0,.874244,.59583,.0104759,0,.904828,.585704,.00986672,0,.936508,.575413,.00929712,0,.968254,.565373,.00876713,0,1,1,.214058,0,0,.999999,.214058,0,0,.999994,.214055,0,0,.999966,.214039,0,259642e-9,.999893,.213998,0,.00200075,.999737,.21391,0,.00527775,.999449,.213745,0,.00983959,.99896,.213458,0,.0154755,.9979,.212855,0,.0220249,.994278,.210779,0,.0293654,.992254,.20926,0,.0374021,.98881,.206908,0,.0460604,.984715,.204009,0,.0552802,.979738,.200471,0,.0650127,.972884,.195813,0,.0752175,.965996,.190856,0,.0858612,.957974,.185077,0,.0969155,.949155,.17868,0,.108356,.939288,.171513,0,.120163,.928996,.163838,0,.132319,.919563,.156246,0,.144808,.910004,.148359,0,.157618,.900791,.140417,0,.170737,.892135,.132569,0,.184155,.883803,.124741,0,.197866,.876034,.117091,0,.211861,.869219,.109835,0,.226134,.863062,.102859,0,.240682,.857795,.0962928,0,.255499,.853009,.0900725,0,.270583,.848603,.0842101,0,.285931,.844335,.0786527,0,.301542,.840208,.0734397,0,.317415,.836035,.0685334,0,.33355,.83172,.0639275,0,.349948,.827135,.0595909,0,.36661,.822797,.0556204,0,.383539,.818387,.0519394,0,.400738,.813565,.0485317,0,.41821,.808142,.0453138,0,.435961,.802212,.0423354,0,.453997,.79573,.0395553,0,.472324,.788741,.036988,0,.490951,.781093,.0345688,0,.509887,.773597,.0323297,0,.529144,.765622,.0302719,0,.548735,.757083,.0283477,0,.568674,.747992,.0265562,0,.588979,.738591,.0248844,0,.609671,.728719,.0233342,0,.630773,.719146,.0219081,0,.652314,.709165,.0205711,0,.674328,.69875,.0193248,0,.696854,.687884,.0181582,0,.719942,.676818,.0170746,0,.743651,.666247,.0160718,0,.768057,.655284,.0151262,0,.793253,.64401,.0142561,0,.819363,.633353,.0134327,0,.846547,.622674,.012653,0,.875017,.612265,.0119354,0,.905021,.602455,.0112533,0,.936508,.593147,.0106234,0,.968254,.583592,.0100213,0,1,1,.25717,0,0,1,.25717,0,0,.999992,.257164,0,0,.999958,.257135,0,641715e-9,.999864,.25706,0,.00305314,.999666,.256897,0,.00700975,.999302,.256596,0,.0122194,.998663,.25607,0,.0184622,.995607,.254123,0,.0255773,.993094,.252081,0,.0334439,.9907,.249867,0,.0419696,.98594,.246118,0,.0510823,.981214,.242049,0,.0607242,.974966,.236869,0,.0708486,.967589,.230724,0,.081417,.95915,.223635,0,.0923974,.950257,.21596,0,.103763,.940165,.207296,0,.115491,.929396,.197901,0,.127562,.919288,.188437,0,.13996,.909428,.178762,0,.15267,.900105,.169072,0,.165679,.891418,.159478,0,.178979,.883347,.15002,0,.192558,.875992,.140813,0,.20641,.869466,.13196,0,.220529,.863699,.123501,0,.234907,.858553,.115436,0,.249542,.854379,.107901,0,.264428,.850894,.10088,0,.279564,.847632,.0942296,0,.294947,.844571,.0879861,0,.310575,.84163,.0821534,0,.326448,.838542,.0766409,0,.342566,.835412,.0715322,0,.358929,.831899,.0666883,0,.37554,.828177,.0622175,0,.392399,.82416,.0580452,0,.409511,.820393,.054267,0,.426878,.816068,.0507172,0,.444506,.811201,.0474041,0,.4624,.805785,.0443174,0,.480566,.799878,.0414562,0,.499013,.793469,.0388147,0,.517749,.786473,.0363453,0,.536785,.778874,.0340225,0,.556134,.771277,.0318599,0,.575809,.763426,.0298859,0,.595827,.755044,.0280357,0,.616207,.746161,.0262979,0,.636973,.737124,.0247295,0,.65815,.72761,.0232514,0,.679772,.717822,.0218755,0,.701876,.708279,.0205942,0,.724509,.698333,.0193947,0,.74773,.68802,.0182717,0,.771609,.677321,.0172044,0,.79624,.666504,.0162122,0,.821743,.656184,.0152924,0,.84828,.64556,.0144326,0,.876069,.634636,.0136157,0,.905404,.624124,.0128612,0,.936508,.613914,.0121435,0,.968254,.603589,.0114887,0,1,1,.307946,0,0,.999999,.307945,0,0,.999988,.307934,0,204479e-10,.999944,.307886,0,.00127833,.999824,.307756,0,.00445047,.999565,.30748,0,.00914673,.999085,.306966,0,.0150498,.998103,.306004,0,.0219367,.994249,.303028,0,.0296485,.991807,.300435,0,.038068,.987773,.296554,0,.0471062,.982673,.2916,0,.0566942,.976623,.285641,0,.0667768,.968757,.27815,0,.0773099,.959849,.269529,0,.088257,.950663,.260248,0,.0995879,.940129,.249704,0,.111277,.92895,.238291,0,.123304,.917996,.226501,0,.13565,.907813,.214669,0,.148299,.898305,.202835,0,.161237,.889626,.191158,0,.174455,.88175,.179695,0,.187941,.874715,.168548,0,.201687,.868746,.15792,0,.215687,.863703,.147807,0,.229933,.859315,.138149,0,.24442,.855538,.128993,0,.259145,.852428,.120414,0,.274103,.850168,.112498,0,.289293,.848132,.105054,0,.304711,.846291,.0981087,0,.320357,.844431,.0915942,0,.33623,.842493,.0855056,0,.35233,.840368,.0798204,0,.368658,.83798,.0745097,0,.385214,.83523,.0695424,0,.402002,.832091,.0649092,0,.419023,.828667,.0606291,0,.436282,.824805,.0566523,0,.453782,.820988,.0530229,0,.471529,.816635,.0496364,0,.489528,.811725,.0464658,0,.507788,.806316,.0435082,0,.526317,.800469,.0407873,0,.545124,.794107,.038255,0,.564221,.787218,.0358825,0,.583621,.779872,.0336785,0,.603341,.772097,.0316379,0,.623397,.764484,.0297379,0,.643812,.756428,.0279581,0,.664611,.748022,.0263153,0,.685824,.739268,.0247799,0,.707488,.73024,.0233385,0,.729646,.720893,.0220035,0,.752354,.71119,.0207555,0,.77568,.701791,.0195843,0,.799715,.692184,.0184891,0,.824574,.682258,.0174541,0,.850417,.67206,.0164873,0,.877466,.661717,.0155959,0,.90604,.651462,.0147519,0,.936528,.641467,.0139727,0,.968254,.631229,.0132363,0,1,1,.367573,0,0,.999999,.367571,0,0,.999984,.367553,0,183382e-9,.999925,.367473,0,.00225254,.999759,.367259,0,.00628165,.99941,.366801,0,.0117858,.998739,.365946,0,.0184359,.995529,.363191,0,.0260114,.992875,.360171,0,.0343581,.989135,.355981,0,.0433637,.984166,.350401,0,.0529438,.977871,.343348,0,.0630334,.96951,.334341,0,.0735805,.959964,.323862,0,.0845437,.950162,.312521,0,.095889,.938882,.299577,0,.107588,.926992,.285573,0,.119617,.915589,.271212,0,.131957,.904791,.256611,0,.144591,.895177,.242224,0,.157503,.886403,.227952,0,.170682,.878957,.214192,0,.184117,.872418,.200795,0,.197799,.867029,.188015,0,.21172,.862835,.175975,0,.225873,.859411,.164526,0,.240253,.856655,.153693,0,.254854,.854519,.14352,0,.269673,.852828,.13397,0,.284707,.851412,.124984,0,.299953,.850609,.116748,0,.315408,.849855,.10905,0,.331073,.849017,.101839,0,.346946,.848079,.0951359,0,.363028,.846911,.0888774,0,.379318,.845445,.0830375,0,.395818,.84362,.0775844,0,.41253,.841411,.0725054,0,.429457,.838768,.0677691,0,.446602,.835801,.0634016,0,.463968,.832341,.0593095,0,.481561,.828424,.0555121,0,.499386,.824312,.052024,0,.51745,.819918,.0487865,0,.535761,.815072,.0457801,0,.554328,.809863,.0430184,0,.573162,.804164,.0404245,0,.592275,.798034,.0380146,0,.611681,.791436,.0357436,0,.631398,.784498,.0336475,0,.651445,.777125,.0316666,0,.671845,.769365,.0298122,0,.692628,.761579,.0281001,0,.713827,.753746,.0265049,0,.735484,.745573,.0250067,0,.75765,.737083,.0236026,0,.78039,.728545,.0223302,0,.803789,.719691,.0211243,0,.82796,.710569,.0199983,0,.853056,.701216,.0189569,0,.879298,.692094,.0179702,0,.907014,.682909,.0170418,0,.936691,.673509,.0161732,0,.968254,.663863,.0153406,0,1,1,.437395,0,0,.999998,.437394,0,0,.99998,.437363,0,616704e-9,.999891,.437232,0,.00367925,.999656,.436877,0,.00867446,.999148,.436121,0,.0150679,.997959,.434564,0,.022531,.993464,.430134,0,.0308507,.990606,.426077,0,.0398805,.985027,.419397,0,.0495148,.978491,.41118,0,.0596749,.969643,.40048,0,.0703001,.959189,.38769,0,.0813427,.948223,.373575,0,.0927641,.935955,.357622,0,.104533,.923237,.34043,0,.116624,.911074,.322735,0,.129015,.899724,.30479,0,.141687,.890189,.287392,0,.154626,.881796,.270248,0,.167818,.874781,.253659,0,.181252,.869166,.237786,0,.194918,.864725,.222618,0,.208807,.861565,.208356,0,.222913,.859284,.194867,0,.237229,.857677,.18212,0,.25175,.856714,.17018,0,.266473,.856155,.158969,0,.281392,.8558,.148413,0,.296505,.855672,.138578,0,.311811,.855538,.129345,0,.327306,.855689,.120861,0,.342991,.855767,.112969,0,.358864,.855618,.105593,0,.374925,.85525,.0987451,0,.391176,.854583,.0923727,0,.407616,.853534,.0864143,0,.424249,.852061,.0808338,0,.441076,.850253,.0756771,0,.4581,.848004,.0708612,0,.475324,.845333,.0663784,0,.492754,.842376,.0622631,0,.510394,.838956,.0584112,0,.528251,.835121,.0548328,0,.546331,.830842,.0514838,0,.564644,.826212,.048355,0,.583198,.821522,.0454714,0,.602005,.816551,.0428263,0,.621078,.811211,.0403612,0,.640434,.805479,.038039,0,.660089,.799409,.0358739,0,.680066,.79306,.0338727,0,.70039,.786395,.0319985,0,.721094,.779416,.030241,0,.742215,.77214,.0285951,0,.7638,.764636,.0270747,0,.785912,.756836,.0256354,0,.808628,.749315,.0243027,0,.832055,.741561,.0230497,0,.856338,.733589,.0218801,0,.88169,.725479,.020784,0,.908441,.717255,.0197702,0,.937125,.708829,.0188168,0,.968254,.700191,.0179113,0,1,1,.518937,0,0,.999998,.518933,0,0,.999967,.518883,0,.00147741,.999832,.51866,0,.00573221,.999466,.518057,0,.011826,.998644,.516752,0,.0192116,.994458,.512347,0,.027573,.991223,.507675,0,.0367099,.985515,.500188,0,.046487,.978308,.490408,0,.0568071,.968359,.477357,0,.0675984,.95682,.461752,0,.0788059,.943929,.443796,0,.090386,.930224,.423893,0,.102304,.916514,.402682,0,.114532,.903653,.380914,0,.127047,.892315,.359212,0,.139828,.882942,.338102,0,.152861,.875438,.31773,0,.16613,.869642,.298186,0,.179624,.865304,.279491,0,.193332,.862382,.261804,0,.207247,.860666,.245146,0,.22136,.859788,.229406,0,.235666,.859608,.214605,0,.250158,.859912,.200691,0,.264832,.86053,.187623,0,.279684,.861368,.17539,0,.294711,.862237,.163901,0,.309911,.863127,.153175,0,.32528,.863923,.143147,0,.340819,.864567,.133781,0,.356524,.865013,.125042,0,.372397,.86539,.116952,0,.388438,.865591,.109476,0,.404645,.865517,.102542,0,.421022,.865084,.0960688,0,.437569,.864309,.0900499,0,.454287,.863151,.0844328,0,.471181,.861649,.0792218,0,.488253,.859742,.0743482,0,.505507,.857446,.0697963,0,.522947,.854757,.0655364,0,.54058,.851783,.061608,0,.558412,.848516,.0579701,0,.576449,.844897,.0545742,0,.594701,.840956,.0514167,0,.613178,.836676,.0484598,0,.631892,.832075,.0456934,0,.650856,.827191,.0431178,0,.670088,.822295,.0407718,0,.689606,.817294,.0386032,0,.709434,.812013,.0365675,0,.7296,.806465,.0346547,0,.750138,.800691,.0328717,0,.771093,.794709,.031211,0,.792519,.788493,.0296504,0,.814488,.782049,.0281782,0,.837097,.775403,.0267965,0,.860481,.76857,.0255002,0,.884842,.761536,.0242759,0,.910494,.754303,.0231142,0,.937985,.74692,.0220305,0,.968254,.739745,.0210192,0,1,1,.613914,0,0,.999996,.613907,0,963597e-10,.999942,.613814,0,.00301247,.999704,.613407,0,.00870385,.999046,.612302,0,.0160714,.995516,.608266,0,.0245899,.991726,.602863,0,.0339681,.985157,.593956,0,.0440254,.97642,.581748,0,.0546409,.964404,.565183,0,.0657284,.950601,.545273,0,.0772246,.935158,.522129,0,.0890812,.919364,.496782,0,.10126,.904754,.470571,0,.113731,.89176,.444037,0,.126469,.881492,.418322,0,.139454,.873656,.393522,0,.15267,.868053,.369795,0,.166101,.864336,.347171,0,.179736,.862259,.325737,0,.193565,.861556,.305532,0,.207578,.861776,.286416,0,.221769,.862661,.268355,0,.23613,.864015,.251334,0,.250656,.865711,.235352,0,.265343,.867519,.220302,0,.280187,.869351,.206161,0,.295183,.871144,.192908,0,.31033,.872839,.180505,0,.325624,.874307,.168848,0,.341065,.875667,.158021,0,.35665,.876758,.147877,0,.37238,.87764,.138441,0,.388253,.878237,.129627,0,.404269,.878563,.121415,0,.42043,.878572,.113741,0,.436735,.87842,.106652,0,.453187,.878057,.100097,0,.469786,.877413,.0940128,0,.486536,.87646,.0883462,0,.503439,.875233,.0830924,0,.520498,.8737,.0781975,0,.537717,.871873,.07364,0,.555102,.86978,.0694103,0,.572657,.867405,.0654696,0,.59039,.864751,.0617914,0,.608307,.861818,.0583491,0,.626419,.858645,.0551443,0,.644733,.855307,.0521894,0,.663264,.851736,.0494334,0,.682025,.847927,.0468504,0,.701032,.843888,.0444261,0,.720308,.839629,.0421497,0,.739875,.835158,.0400082,0,.759764,.830509,.0380076,0,.780014,.825714,.0361488,0,.800673,.820729,.0343956,0,.821803,.815751,.0327781,0,.843492,.810752,.031275,0,.86586,.805587,.0298542,0,.889087,.800317,.0285397,0,.913466,.79489,.0272948,0,.93952,.789314,.0261139,0,.96835,.783593,.0249938,0,1,1,.724258,0,0,.999992,.724243,0,726889e-9,.99987,.724044,0,.00569574,.999336,.72317,0,.0131702,.996271,.719432,0,.0220738,.991159,.712576,0,.0319405,.982465,.700927,0,.0425202,.97049,.684297,0,.0536599,.953973,.661244,0,.065258,.935546,.633804,0,.0772427,.916596,.603071,0,.0895616,.899353,.57105,0,.102175,.885216,.539206,0,.11505,.875076,.508714,0,.128164,.868334,.479571,0,.141495,.864414,.451796,0,.155026,.862678,.425328,0,.168745,.862835,.400352,0,.182639,.864067,.376532,0,.196699,.866086,.35391,0,.210915,.868557,.332424,0,.225282,.871271,.312053,0,.239792,.874058,.292764,0,.25444,.8768,.27453,0,.269223,.87939,.257297,0,.284135,.8819,.24114,0,.299174,.884187,.225934,0,.314337,.886262,.211669,0,.329622,.888119,.198311,0,.345026,.889709,.185783,0,.360549,.891054,.174063,0,.376189,.892196,.163143,0,.391946,.893101,.152952,0,.407819,.893803,.143475,0,.423808,.894277,.134647,0,.439914,.894532,.126434,0,.456137,.894576,.1188,0,.472479,.894393,.111694,0,.48894,.893976,.105069,0,.505523,.893346,.0989077,0,.52223,.892502,.0931724,0,.539064,.891441,.0878276,0,.556028,.890276,.082903,0,.573125,.888972,.0783505,0,.590361,.887469,.0741083,0,.607741,.885785,.0701633,0,.62527,.883914,.0664835,0,.642957,.881872,.0630567,0,.660809,.879651,.0598527,0,.678836,.877267,.0568615,0,.69705,.874717,.05406,0,.715465,.872012,.0514378,0,.734098,.869157,.0489805,0,.752968,.866155,.0466727,0,.772101,.863014,.0445056,0,.791529,.859748,.0424733,0,.81129,.856416,.0405957,0,.831438,.852958,.0388273,0,.852044,.849382,.0371619,0,.87321,.845694,.0355959,0,.89509,.841893,.0341155,0,.917932,.837981,.0327141,0,.942204,.833963,.0313856,0,.968981,.829847,.0301275,0,1,1,.85214,0,0,.999969,.852095,0,.00279627,.999483,.851408,0,.0107635,.994545,.84579,0,.0206454,.986188,.835231,0,.0315756,.969847,.814687,0,.0432021,.945951,.783735,0,.0553396,.91917,.746074,0,.0678766,.895488,.706938,0,.0807395,.878232,.669534,0,.0938767,.868252,.635168,0,.10725,.863873,.603069,0,.120832,.863369,.572514,0,.134598,.86545,.543169,0,.148533,.868803,.514578,0,.16262,.872794,.486762,0,.176849,.87702,.459811,0,.19121,.881054,.433654,0,.205694,.884974,.408574,0,.220294,.888587,.384525,0,.235005,.891877,.36156,0,.24982,.894793,.339661,0,.264737,.89743,.318913,0,.279751,.899796,.299302,0,.294859,.901943,.280843,0,.310058,.903858,.263481,0,.325346,.905574,.247197,0,.340721,.907069,.231915,0,.356181,.908379,.217614,0,.371725,.90952,.20425,0,.387353,.910483,.191758,0,.403063,.91128,.180092,0,.418854,.911936,.169222,0,.434727,.912454,.159098,0,.450682,.912835,.149668,0,.466718,.913078,.140884,0,.482837,.913192,.132709,0,.499038,.913175,.125095,0,.515324,.91304,.118012,0,.531695,.912781,.111417,0,.548153,.91241,.105281,0,.5647,.911924,.0995691,0,.581338,.911331,.0942531,0,.59807,.910637,.0893076,0,.6149,.90984,.0846998,0,.63183,.908941,.0804044,0,.648865,.907944,.0763984,0,.666011,.906857,.0726638,0,.683273,.90568,.0691783,0,.700659,.904416,.0659222,0,.718176,.903067,.0628782,0,.735834,.901637,.0600307,0,.753646,.900128,.0573647,0,.771625,.898544,.0548668,0,.78979,.89689,.052527,0,.808162,.895165,.0503306,0,.826771,.893371,.0482668,0,.845654,.891572,.0463605,0,.864863,.889763,.0445998,0,.884472,.887894,.0429451,0,.904592,.885967,.0413884,0,.925407,.883984,.0399225,0,.947271,.881945,.0385405,0,.97105,.879854,.0372362,0,1,.999804,.995833,0,0,.938155,.933611,0,.0158731,.864755,.854311,0,.0317461,.888594,.865264,0,.0476191,.905575,.863922,0,.0634921,.915125,.850558,0,.0793651,.920665,.829254,0,.0952381,.924073,.802578,0,.111111,.926304,.772211,0,.126984,.927829,.739366,0,.142857,.928924,.705033,0,.15873,.92973,.670019,0,.174603,.930339,.634993,0,.190476,.930811,.600485,0,.206349,.931191,.566897,0,.222222,.93149,.534485,0,.238095,.931737,.503429,0,.253968,.931939,.473811,0,.269841,.932108,.445668,0,.285714,.93225,.418993,0,.301587,.932371,.393762,0,.31746,.932474,.369939,0,.333333,.932562,.347479,0,.349206,.932638,.326336,0,.365079,.932703,.306462,0,.380952,.93276,.287805,0,.396825,.932809,.270313,0,.412698,.932851,.253933,0,.428571,.932887,.23861,0,.444444,.932917,.224289,0,.460317,.932943,.210917,0,.47619,.932965,.19844,0,.492063,.932982,.186807,0,.507937,.932995,.175966,0,.52381,.933005,.165869,0,.539683,.933011,.156468,0,.555556,.933013,.147719,0,.571429,.933013,.139579,0,.587302,.93301,.132007,0,.603175,.933004,.124965,0,.619048,.932994,.118416,0,.634921,.932982,.112326,0,.650794,.932968,.106663,0,.666667,.93295,.101397,0,.68254,.932931,.0964993,0,.698413,.932908,.0919438,0,.714286,.932883,.0877057,0,.730159,.932856,.0837623,0,.746032,.932827,.0800921,0,.761905,.932796,.0766754,0,.777778,.932762,.0734936,0,.793651,.932727,.0705296,0,.809524,.932689,.0677676,0,.825397,.93265,.0651929,0,.84127,.932609,.0627917,0,.857143,.932565,.0605515,0,.873016,.932521,.0584606,0,.888889,.932474,.0565082,0,.904762,.932427,.0546841,0,.920635,.932377,.0529793,0,.936508,.932326,.0513851,0,.952381,.932274,.0498936,0,.968254,.93222,.0484975,0,.984127,.932164,.0471899,0,1],n=new Float32Array(e),r=new Float32Array(t),i=new zw(n,64,64,V0,Th,a_,l0,l0,xc,c0,1),a=new zw(r,64,64,V0,Th,a_,l0,l0,xc,c0,1);i.needsUpdate=!0,a.needsUpdate=!0;const c=new Uint16Array(e.length);e.forEach(function(x,S){c[S]=Xpe.toHalfFloat(x)});const h=new Uint16Array(t.length);t.forEach(function(x,S){h[S]=Xpe.toHalfFloat(x)});const p=new zw(c,64,64,V0,v6,a_,l0,l0,xc,c0,1),v=new zw(h,64,64,V0,v6,a_,l0,l0,xc,c0,1);return p.needsUpdate=!0,v.needsUpdate=!0,this.LTC_HALF_1=p,this.LTC_HALF_2=v,this.LTC_FLOAT_1=i,this.LTC_FLOAT_2=a,this}}Y_.LTC_HALF_1=null;Y_.LTC_HALF_2=null;Y_.LTC_FLOAT_1=null;Y_.LTC_FLOAT_2=null;class CWe{static init(){Y_.init();const{LTC_FLOAT_1:e,LTC_FLOAT_2:t,LTC_HALF_1:n,LTC_HALF_2:r}=Y_;Bn.LTC_FLOAT_1=e,Bn.LTC_FLOAT_2=t,Bn.LTC_HALF_1=n,Bn.LTC_HALF_2=r}}const U2e=new Ie;class K5e extends vI{constructor(){super();et(this,"renderTarget");et(this,"camera");et(this,"mesh");this.name="RTTScene";const t=GI.get("environment").clone();this.background=t,this.camera=new La(60,1,10,2e3),this.camera.position.set(0,0,100),this.camera.lookAt(U2e);const n=new GH(new Vn(16777215),1);n.name="sun",this.add(n),this.mesh=new Mn(new UH(10,3,100,6),new Vk({envMap:t,envMapIntensity:10})),this.mesh.name="normalMesh",this.add(this.mesh);const r=new Mn(new S6(10),new L9e);r.name="ball",r.position.set(25,25,0),this.add(r);const i=new Mn(new b6(200,200),new Vk({envMap:t}));i.name="floor",i.rotation.x=-Math.PI/2,i.position.set(0,-20,0),this.add(i),this.renderTarget=new AH(512,512),B_(this)}draw(t,n){const i=t*.05*Math.PI*2,a=Math.cos(i)*100,c=Math.sin(i)*100;this.camera.position.set(a,0,c),this.camera.lookAt(U2e),n.isWebGLRenderer?(n.setRenderTarget(this.renderTarget),n.render(this,this.camera),n.setRenderTarget(null)):(n.setRenderTarget(this.renderTarget),n.renderAsync(this,this.camera),n.setRenderTarget(null))}}const z2e="Custom Group";class Z5e extends X5e{constructor(){super();et(this,"dance");et(this,"rttScene");et(this,"speed",1);this.name="Scene2"}init(){const t=this.app.components.get("three");this.camera.position.set(0,100,125),this.camera.lookAt(0,50,0),this.createLights(),this.createWorld(),this.createAnimation(),B_(this),t.addScene(this),t.setScene(this),t.addCamera(this.camera),t.renderer&&(this.renderer=t.renderer)}dispose(){const t=this.app.components.get("three");t.removeGroup(z2e),this.rttScene&&t.removeScene(this.rttScene),super.dispose()}createLights(){const t=this.app.components.get("three"),n=new Ci;n.name="lights",this.add(n);const r=new VH(16777215,3);if(r.angle=5.8,r.decay=0,r.distance=1e3,r.penumbra=Math.PI,r.name="spotlight",r.position.set(-250,200,200),r.lookAt(0,50,0),n.add(r),t.renderer!==void 0&&t.renderer.isWebGLRenderer){CWe.init();const i=new ZMe(16711680,1,300,100);i.name="rectLight",i.position.set(250,100,100),i.lookAt(0,50,0),n.add(i)}}createWorld(){const t=this.app.components.get("three"),n=GI.get("environment").clone();this.background=n;const r=new Ci;r.name="world",this.add(r);const i=KW.get("uv_grid");i.repeat.setScalar(10),i.needsUpdate=!0;const a=new Vk({map:i,envMap:n}),c=new Mn(new _I(250,36),a);c.name="floor",c.receiveShadow=!0,c.rotateX(-Math.PI/2),r.add(c);const h=new dMe(new S6(50),new C9e({size:.5}));h.name="points",h.position.set(-100,50,0),r.add(h);const p=new NE(new S6(50),new vf);p.name="lines",p.position.set(100,50,0),r.add(p),this.rttScene=new K5e,t.addScene(this.rttScene);const v=new wu;v.map=this.rttScene.renderTarget.texture;const x=new Mn(new b6(100,100),v);if(x.name="rttExample",x.position.set(-100,0,-150),this.camera.add(x),t.renderer.isWebGLRenderer){const S=new Mn(new b6(100,100),new N5e);S.name="customShaderMaterial",S.position.set(100,50,-100),r.add(S)}else x.scale.y=-1,v.side=u0,v.needsUpdate=!0;this.dance=new q5e("Flair"),this.dance.name="flair",this.dance.traverse(S=>{if(S instanceof NH){const C=S;C.material=new U9e}}),r.add(this.dance),t.addGroup({title:z2e,items:[{title:"Speed",prop:"speed",value:1,min:0,max:2,step:.01,type:"range"},{title:"Name",prop:"name",value:"Hello World!",type:"string"},{title:"Color",prop:"color",value:new Vn(16711680),type:"color"}],onUpdate:(S,C)=>{switch(console.log(S,C),S){case"speed":this.speed=C;break}}})}createAnimation(){const t=this.app.components.get("theatre");t.sheet(this.name),t.sheetObject(this.name,"Camera",{position:{x:this.camera.position.x,y:this.camera.position.y,z:this.camera.position.z},rotation:{x:this.camera.rotation.x,y:this.camera.rotation.y,z:this.camera.rotation.z}},n=>{this.camera.position.set(n.position.x,n.position.y,n.position.z),this.camera.rotation.set(n.rotation.x,n.rotation.y,n.rotation.z)}),t.sheetObject(this.name,"Dancer",{position:{x:this.dance.position.x,y:this.dance.position.y,z:this.dance.position.z},rotation:{x:this.dance.rotation.x,y:this.dance.rotation.y,z:this.dance.rotation.z}},n=>{this.dance.position.set(n.position.x,n.position.y,n.position.z),this.dance.rotation.set(n.rotation.x,n.rotation.y,n.rotation.z)})}update(){var n;const t=this.clock.getDelta();this.dance.update(t*this.speed),this.renderer&&((n=this.rttScene)==null||n.draw(this.clock.getElapsedTime(),this.renderer))}}function AWe(){setTimeout(()=>{const o=document.getElementById("theatrejs-studio-root");if(o===null||o.shadowRoot===null)return;const e=o.shadowRoot.getElementById("pointer-root");if(e===null)return;const t=e.children[0];if(t===null)return;const n=t.children[1];n.style.justifyContent="left";try{const r=n.children[1];for(r.style.transform="translateX(10px)";r.children.length>1;)r.removeChild(r.children[0])}catch{}try{const r=t.children[3];r.style.top="0",r.style.right="300px"}catch{}},1e3)}function PWe(o){const[e,t]=Rn.useState(!1);Rn.useEffect(()=>{const r=()=>{w6.removeEventListener(X3.LOAD_COMPLETE,r),AWe(),t(!0)};w6.addEventListener(X3.LOAD_COMPLETE,r)},[]);const n=new Map;return n.set("Scene1",Y5e),n.set("Scene2",Z5e),n.set("RTTScene",K5e),Je.jsx(Je.Fragment,{children:e&&Je.jsx(DHe,{app:o.app,three:o.app.components.get("three"),scenes:n,onSceneSet:r=>{r.setup(o.app),r.init()},onSceneUpdate:r=>{r.update()}})})}class Q5e{constructor(e,t,n){this.id=0,this.name=e,this.fg=t,this.bg=n,this.gradient=null,this.PR=Math.round(window.devicePixelRatio||1),this.WIDTH=90*this.PR,this.HEIGHT=48*this.PR,this.TEXT_X=3*this.PR,this.TEXT_Y=2*this.PR,this.GRAPH_X=3*this.PR,this.GRAPH_Y=15*this.PR,this.GRAPH_WIDTH=84*this.PR,this.GRAPH_HEIGHT=30*this.PR,this.canvas=document.createElement("canvas"),this.canvas.width=this.WIDTH,this.canvas.height=this.HEIGHT,this.canvas.style.width="90px",this.canvas.style.height="48px",this.canvas.style.position="absolute",this.canvas.style.cssText="width:90px;height:48px;background-color: transparent !important;",this.context=this.canvas.getContext("2d"),this.initializeCanvas()}createGradient(){if(!this.context)throw new Error("No context");const e=this.context.createLinearGradient(0,this.GRAPH_Y,0,this.GRAPH_Y+this.GRAPH_HEIGHT);let t;const n=this.fg;switch(this.fg.toLowerCase()){case"#0ff":t="#006666";break;case"#0f0":t="#006600";break;case"#ff0":t="#666600";break;case"#e1e1e1":t="#666666";break;default:t=this.bg;break}return e.addColorStop(0,t),e.addColorStop(1,n),e}initializeCanvas(){this.context&&(this.context.imageSmoothingEnabled=!1,this.context.font="bold "+9*this.PR+"px Helvetica,Arial,sans-serif",this.context.textBaseline="top",this.gradient=this.createGradient(),this.context.fillStyle=this.bg,this.context.fillRect(0,0,this.WIDTH,this.HEIGHT),this.context.fillStyle=this.fg,this.context.fillText(this.name,this.TEXT_X,this.TEXT_Y),this.context.fillStyle=this.bg,this.context.globalAlpha=.9,this.context.fillRect(this.GRAPH_X,this.GRAPH_Y,this.GRAPH_WIDTH,this.GRAPH_HEIGHT))}update(e,t,n=0){if(!this.context||!this.gradient)return;const r=Math.min(1/0,e),i=Math.max(t,e);this.context.globalAlpha=1,this.context.fillStyle=this.bg,this.context.fillRect(0,0,this.WIDTH,this.GRAPH_Y),this.context.fillStyle=this.fg,this.context.fillText(`${e.toFixed(n)} ${this.name} (${r.toFixed(n)}-${parseFloat(i.toFixed(n))})`,this.TEXT_X,this.TEXT_Y)}updateGraph(e,t){if(!this.context||!this.gradient)return;e===0&&t===0&&(t=1),t=Math.max(t,e,.1),e=Math.max(e,0);const n=Math.round(this.GRAPH_X),r=Math.round(this.GRAPH_Y),i=Math.round(this.GRAPH_WIDTH),a=Math.round(this.GRAPH_HEIGHT),c=Math.round(this.PR);this.context.drawImage(this.canvas,n+c,r,i-c,a,n,r,i-c,a),this.context.fillStyle=this.bg,this.context.fillRect(n+i-c,r,c,a);const h=Math.min(a,Math.round(e/t*a));h>0&&(this.context.globalAlpha=.9,this.context.fillStyle=this.gradient,this.context.fillRect(n+i-c,r+(a-h),c,h)),this.context.globalAlpha=1}}class RWe extends Q5e{constructor(e,t,n){super(e,t,n),this.vsyncValue=0,this.SMALL_HEIGHT=9*this.PR,this.HEIGHT=this.SMALL_HEIGHT,this.WIDTH=35*this.PR,this.TEXT_Y=0*this.PR,this.canvas.height=this.HEIGHT,this.canvas.width=this.WIDTH,this.canvas.style.height="9px",this.canvas.style.width="35px",this.canvas.style.cssText=`
            width: 35px;
            height: 9px;
            position: absolute;
            top: 0;
            left: 0;
            background-color: transparent !important;
            pointer-events: none;
        `,this.initializeCanvas()}initializeCanvas(){this.context&&(this.context.imageSmoothingEnabled=!1,this.context.font="bold "+9*this.PR+"px Helvetica,Arial,sans-serif",this.context.textBaseline="top",this.context.globalAlpha=1)}update(e,t,n=0){this.context&&(this.vsyncValue=e,this.context.clearRect(0,0,this.WIDTH,this.HEIGHT),this.context.globalAlpha=1,this.context.fillStyle=this.bg,this.context.fillText(`${e.toFixed(0)}Hz`,this.TEXT_X,this.TEXT_Y))}updateGraph(e,t){}setOffset(e,t){this.canvas.style.transform=`translate(${e}px, ${t}px)`}}const J5e=class s_{constructor({trackGPU:e=!1,trackCPT:t=!1,trackHz:n=!1,logsPerSecond:r=4,graphsPerSecond:i=30,samplesLog:a=40,samplesGraph:c=10,precision:h=2,minimal:p=!1,horizontal:v=!0,mode:x=0}={}){this.gl=null,this.ext=null,this.activeQuery=null,this.gpuQueries=[],this.threeRendererPatched=!1,this.frameTimes=[],this.renderCount=0,this.totalCpuDuration=0,this.totalGpuDuration=0,this.totalGpuDurationCompute=0,this.gpuPanel=null,this.gpuPanelCompute=null,this.vsyncPanel=null,this.averageFps={logs:[],graph:[]},this.averageCpu={logs:[],graph:[]},this.averageGpu={logs:[],graph:[]},this.averageGpuCompute={logs:[],graph:[]},this.updateCounter=0,this.lastMin={},this.lastMax={},this.lastValue={},this.VSYNC_RATES=[{refreshRate:60,frameTime:16.67},{refreshRate:75,frameTime:13.33},{refreshRate:90,frameTime:11.11},{refreshRate:120,frameTime:8.33},{refreshRate:144,frameTime:6.94},{refreshRate:165,frameTime:6.06},{refreshRate:240,frameTime:4.17}],this.detectedVSync=null,this.frameTimeHistory=[],this.HISTORY_SIZE=120,this.VSYNC_THRESHOLD=.05,this.lastFrameTime=0,this.handleClick=C=>{C.preventDefault(),this.showPanel(++this.mode%this.dom.children.length)},this.handleResize=()=>{this.resizePanel(this.fpsPanel),this.resizePanel(this.msPanel),this.gpuPanel&&this.resizePanel(this.gpuPanel),this.gpuPanelCompute&&this.resizePanel(this.gpuPanelCompute)},this.mode=x,this.horizontal=v,this.minimal=p,this.trackGPU=e,this.trackCPT=t,this.trackHz=n,this.samplesLog=a,this.samplesGraph=c,this.precision=h,this.logsPerSecond=r,this.graphsPerSecond=i;const S=performance.now();this.prevGraphTime=S,this.dom=document.createElement("div"),this.initializeDOM(),this.beginTime=performance.now(),this.prevTextTime=this.beginTime,this.prevCpuTime=this.beginTime,this._panelId=0,this.fpsPanel=this.addPanel(new s_.Panel("FPS","#0ff","#002")),this.msPanel=this.addPanel(new s_.Panel("CPU","#0f0","#020")),this.trackHz===!0&&(this.vsyncPanel=new RWe("","#f0f","#202"),this.dom.appendChild(this.vsyncPanel.canvas),this.vsyncPanel.setOffset(56,35)),this.setupEventListeners()}initializeDOM(){this.dom.style.cssText=`
      position: fixed;
      top: 0;
      left: 0;
      opacity: 0.9;
      z-index: 10000;
      ${this.minimal?"cursor: pointer;":""}
    `}setupEventListeners(){this.minimal?(this.dom.addEventListener("click",this.handleClick),this.showPanel(this.mode)):window.addEventListener("resize",this.handleResize)}async init(e){if(!e){console.error('Stats: The "canvas" parameter is undefined.');return}if(!this.handleThreeRenderer(e)&&!await this.handleWebGPURenderer(e))if(this.initializeWebGL(e)){this.trackGPU&&this.initializeGPUTracking();return}else console.error("Stats-gl: Failed to initialize WebGL context")}handleThreeRenderer(e){return e.isWebGLRenderer&&!this.threeRendererPatched?(this.patchThreeRenderer(e),this.gl=e.getContext(),this.trackGPU&&this.initializeGPUTracking(),!0):!1}async handleWebGPURenderer(e){return e.isWebGPURenderer?((this.trackGPU||this.trackCPT)&&(e.backend.trackTimestamp=!0,await e.hasFeatureAsync("timestamp-query")&&this.initializeWebGPUPanels()),this.info=e.info,this.patchThreeWebGPU(e),!0):!1}initializeWebGPUPanels(){this.trackGPU&&(this.gpuPanel=this.addPanel(new s_.Panel("GPU","#ff0","#220"))),this.trackCPT&&(this.gpuPanelCompute=this.addPanel(new s_.Panel("CPT","#e1e1e1","#212121")))}initializeWebGL(e){if(e instanceof WebGL2RenderingContext)this.gl=e;else if(e instanceof HTMLCanvasElement||e instanceof OffscreenCanvas){if(this.gl=e.getContext("webgl2"),!this.gl)return console.error("Stats: Unable to obtain WebGL2 context."),!1}else return console.error("Stats: Invalid input type. Expected WebGL2RenderingContext, HTMLCanvasElement, or OffscreenCanvas."),!1;return!0}initializeGPUTracking(){this.gl&&(this.ext=this.gl.getExtension("EXT_disjoint_timer_query_webgl2"),this.ext&&(this.gpuPanel=this.addPanel(new s_.Panel("GPU","#ff0","#220"))))}begin(){this.beginProfiling("cpu-started"),!(!this.gl||!this.ext)&&(this.activeQuery&&this.gl.endQuery(this.ext.TIME_ELAPSED_EXT),this.activeQuery=this.gl.createQuery(),this.activeQuery&&this.gl.beginQuery(this.ext.TIME_ELAPSED_EXT,this.activeQuery))}end(){this.renderCount++,this.gl&&this.ext&&this.activeQuery&&(this.gl.endQuery(this.ext.TIME_ELAPSED_EXT),this.gpuQueries.push({query:this.activeQuery}),this.activeQuery=null),this.endProfiling("cpu-started","cpu-finished","cpu-duration")}update(){this.endProfiling("cpu-started","cpu-finished","cpu-duration"),this.info?this.processWebGPUTimestamps():this.processGpuQueries(),this.updateAverages(),this.resetCounters()}processWebGPUTimestamps(){this.totalGpuDuration=this.info.render.timestamp,this.totalGpuDurationCompute=this.info.compute.timestamp}resetCounters(){this.renderCount=0,this.totalCpuDuration=0,this.beginTime=this.endInternal()}resizePanel(e){e.canvas.style.position="absolute",this.minimal?e.canvas.style.display="none":(e.canvas.style.display="block",this.horizontal?(e.canvas.style.top="0px",e.canvas.style.left=e.id*e.WIDTH/e.PR+"px"):(e.canvas.style.left="0px",e.canvas.style.top=e.id*e.HEIGHT/e.PR+"px"))}addPanel(e){return e.canvas&&(this.dom.appendChild(e.canvas),e.id=this._panelId,this.resizePanel(e),this._panelId++),e}showPanel(e){for(let t=0;t<this.dom.children.length;t++){const n=this.dom.children[t];n.style.display=t===e?"block":"none"}this.mode=e}processGpuQueries(){!this.gl||!this.ext||(this.totalGpuDuration=0,this.gpuQueries.forEach((e,t)=>{if(this.gl){const n=this.gl.getQueryParameter(e.query,this.gl.QUERY_RESULT_AVAILABLE),r=this.gl.getParameter(this.ext.GPU_DISJOINT_EXT);if(n&&!r){const a=this.gl.getQueryParameter(e.query,this.gl.QUERY_RESULT)*1e-6;this.totalGpuDuration+=a,this.gl.deleteQuery(e.query),this.gpuQueries.splice(t,1)}}}))}detectVSync(e){if(this.lastFrameTime===0){this.lastFrameTime=e;return}const t=e-this.lastFrameTime;if(this.lastFrameTime=e,this.frameTimeHistory.push(t),this.frameTimeHistory.length>this.HISTORY_SIZE&&this.frameTimeHistory.shift(),this.frameTimeHistory.length<60)return;const n=this.frameTimeHistory.reduce((h,p)=>h+p)/this.frameTimeHistory.length,r=this.frameTimeHistory.reduce((h,p)=>h+Math.pow(p-n,2),0)/this.frameTimeHistory.length;if(Math.sqrt(r)>2){this.detectedVSync=null;return}let a=null,c=1/0;for(const h of this.VSYNC_RATES){const p=Math.abs(n-h.frameTime);p<c&&(c=p,a=h)}a&&c/a.frameTime<=this.VSYNC_THRESHOLD?this.detectedVSync=a:this.detectedVSync=null}endInternal(){var e;const t=performance.now();for(this.frameTimes.push(t);this.frameTimes.length>0&&this.frameTimes[0]<=t-1e3;)this.frameTimes.shift();const n=Math.round(this.frameTimes.length);this.addToAverage(n,this.averageFps);const r=t>=this.prevTextTime+1e3/this.logsPerSecond,i=t>=this.prevGraphTime+1e3/this.graphsPerSecond;if(this.updatePanelComponents(this.fpsPanel,this.averageFps,0,r,i),this.updatePanelComponents(this.msPanel,this.averageCpu,this.precision,r,i),this.gpuPanel&&this.updatePanelComponents(this.gpuPanel,this.averageGpu,this.precision,r,i),this.trackCPT&&this.gpuPanelCompute&&this.updatePanelComponents(this.gpuPanelCompute,this.averageGpuCompute,this.precision,r,i),r&&(this.prevTextTime=t),i&&(this.prevGraphTime=t),this.vsyncPanel!==null){this.detectVSync(t);const a=((e=this.detectedVSync)==null?void 0:e.refreshRate)||0;r&&a>0&&this.vsyncPanel.update(a,a)}return t}updatePanelComponents(e,t,n,r,i){if(!e||t.logs.length===0)return;e.name in this.lastMin||(this.lastMin[e.name]=1/0,this.lastMax[e.name]=0,this.lastValue[e.name]=0);const a=t.logs[t.logs.length-1];this.lastMax[e.name]=Math.max(...t.logs),this.lastMin[e.name]=Math.min(this.lastMin[e.name],a),this.lastValue[e.name]=this.lastValue[e.name]*.7+a*.3;const c=Math.max(Math.max(...t.logs),...t.graph.slice(-this.samplesGraph));this.updateCounter++,r&&e.update(this.lastValue[e.name],this.lastMax[e.name],n),i&&e.updateGraph(a,c)}beginProfiling(e){if(window.performance)try{window.performance.clearMarks(e),window.performance.mark(e)}catch(t){console.debug("Stats: Performance marking failed:",t)}}endProfiling(e,t,n){if(!(!window.performance||!t||!e))try{window.performance.getEntriesByName(e,"mark").length===0&&this.beginProfiling(e),window.performance.clearMarks(t),window.performance.mark(t),window.performance.clearMeasures(n);const i=performance.measure(n,e,t);this.totalCpuDuration+=i.duration,window.performance.clearMarks(e),window.performance.clearMarks(t),window.performance.clearMeasures(n)}catch(r){console.debug("Stats: Performance measurement failed:",r)}}updatePanel(e,t,n=2){if(!e||t.logs.length===0)return;const r=performance.now();e.name in this.lastMin||(this.lastMin[e.name]=1/0,this.lastMax[e.name]=0,this.lastValue[e.name]=0);const i=t.logs[t.logs.length-1],a=Math.max(...t.logs.slice(-30));this.lastMin[e.name]=Math.min(this.lastMin[e.name],i),this.lastMax[e.name]=Math.max(this.lastMax[e.name],i),this.lastValue[e.name]=this.lastValue[e.name]*.7+i*.3;const c=Math.max(a,...t.graph.slice(-this.samplesGraph));this.updateCounter++,this.updateCounter%(this.logsPerSecond*2)===0&&(this.lastMax[e.name]=a,this.lastMin[e.name]=i),e.update&&(r>=this.prevCpuTime+1e3/this.logsPerSecond&&e.update(this.lastValue[e.name],i,this.lastMax[e.name],c,n),r>=this.prevGraphTime+1e3/this.graphsPerSecond&&(e.updateGraph(i,c),this.prevGraphTime=r))}updateAverages(){this.addToAverage(this.totalCpuDuration,this.averageCpu),this.addToAverage(this.totalGpuDuration,this.averageGpu),this.info&&this.totalGpuDurationCompute!==void 0&&this.addToAverage(this.totalGpuDurationCompute,this.averageGpuCompute)}addToAverage(e,t){t.logs.push(e),t.logs.length>this.samplesLog&&(t.logs=t.logs.slice(-this.samplesLog)),t.graph.push(e),t.graph.length>this.samplesGraph&&(t.graph=t.graph.slice(-this.samplesGraph))}get domElement(){return this.dom}patchThreeWebGPU(e){const t=e.info.reset,n=this;e.info.reset=function(){n.beginProfiling("cpu-started"),t.call(this)}}patchThreeRenderer(e){const t=e.render,n=this;e.render=function(r,i){n.begin(),t.call(this,r,i),n.end()},this.threeRendererPatched=!0}};J5e.Panel=Q5e;let kWe=J5e;function IWe(o){return Rn.useEffect(()=>{function e(c){let h=null;return o.three.scenes.forEach(p=>{c.search(p.uuid)>-1&&(h=p)}),h}const t=c=>{const h=c.value,p=e(h),v=p==null?void 0:p.getObjectByProperty("uuid",h);v!==void 0?o.three.setObject(v):console.log(`Hermes - can't find object: ${h}`,p)},n=(c,h,p)=>{const v=e(c),x=v==null?void 0:v.getObjectByProperty("uuid",c);x!==void 0?jo(x,h,p):console.log(`Hermes - can't set object: ${c}`,v)},r=c=>{const h=c.value,{key:p,value:v,uuid:x}=h;n(x,p,v)},i=c=>{const h=c.value,p=e(h.uuid),v=p==null?void 0:p.getObjectByProperty("uuid",h.uuid);if(v!==void 0){const x=S=>{const C=h.key.split(".");switch(C.length){case 1:v[C[0]]=S;break;case 2:v[C[0]][C[1]]=S;break;case 3:v[C[0]][C[1]][C[2]]=S;break;case 4:v[C[0]][C[1]][C[2]][C[3]]=S;break;case 5:v[C[0]][C[1]][C[2]][C[3]][C[4]]=S;break}v.material.needsUpdate=!0};h.value.src.length>0?qH(h.value.src).then(S=>{S.offset.set(h.value.offset[0],h.value.offset[1]),S.repeat.set(h.value.repeat[0],h.value.repeat[1]),x(S)}):x(null)}},a=c=>{const{key:h,uuid:p,value:v,subitem:x}=c.value,S=e(p),C=S==null?void 0:S.getObjectByProperty("uuid",p);if(C!==void 0)try{x!==void 0?dIe(C,x)[h](v):C[h](v)}catch(I){console.log("Error requesting method:"),console.log(I),console.log(h),console.log(v)}};return o.app.addEventListener(br.GET_OBJECT,t),o.app.addEventListener(br.UPDATE_OBJECT,r),o.app.addEventListener(br.CREATE_TEXTURE,i),o.app.addEventListener(br.REQUEST_METHOD,a),()=>{o.app.removeEventListener(br.GET_OBJECT,t),o.app.removeEventListener(br.UPDATE_OBJECT,r),o.app.removeEventListener(br.CREATE_TEXTURE,i),o.app.removeEventListener(br.REQUEST_METHOD,a)}},[]),null}function xG(o,e,t,n){return new(t||(t=Promise))(function(r,i){function a(p){try{h(n.next(p))}catch(v){i(v)}}function c(p){try{h(n.throw(p))}catch(v){i(v)}}function h(p){var v;p.done?r(p.value):(v=p.value,v instanceof t?v:new t(function(x){x(v)})).then(a,c)}h((n=n.apply(o,[])).next())})}const NWe=["geforce 320m","geforce 8600","geforce 8600m gt","geforce 8800 gs","geforce 8800 gt","geforce 9400","geforce 9400m g","geforce 9400m","geforce 9600m gt","geforce 9600m","geforce fx go5200","geforce gt 120","geforce gt 130","geforce gt 330m","geforce gtx 285","google swiftshader","intel g41","intel g45","intel gma 4500mhd","intel gma x3100","intel hd 3000","intel q45","legacy","mali-2","mali-3","mali-4","quadro fx 1500","quadro fx 4","quadro fx 5","radeon hd 2400","radeon hd 2600","radeon hd 4670","radeon hd 4850","radeon hd 4870","radeon hd 5670","radeon hd 5750","radeon hd 6290","radeon hd 6300","radeon hd 6310","radeon hd 6320","radeon hd 6490m","radeon hd 6630m","radeon hd 6750m","radeon hd 6770m","radeon hd 6970m","sgx 543","sgx543"];function V2e(o){return o=o.toLowerCase().replace(/.*angle ?\((.+)\)(?: on vulkan [0-9.]+)?$/i,"$1").replace(/\s(\d{1,2}gb|direct3d.+$)|\(r\)| \([^)]+\)$/g,"").replace(/(?:vulkan|opengl) \d+\.\d+(?:\.\d+)?(?: \((.*)\))?/,"$1")}const e8e=typeof window>"u",qp=(()=>{if(e8e)return;const{userAgent:o,platform:e,maxTouchPoints:t}=window.navigator,n=/(iphone|ipod|ipad)/i.test(o),r=e==="iPad"||e==="MacIntel"&&t>0&&!window.MSStream;return{isIpad:r,isMobile:/android/i.test(o)||n||r,isSafari12:/Version\/12.+Safari/.test(o),isFirefox:/Firefox/.test(o)}})();function DWe(o,e,t){if(!t)return[e];const n=function(p){const v=`
    precision highp float;
    attribute vec3 aPosition;
    varying float vvv;
    void main() {
      vvv = 0.31622776601683794;
      gl_Position = vec4(aPosition, 1.0);
    }
  `,x=`
    precision highp float;
    varying float vvv;
    void main() {
      vec4 enc = vec4(1.0, 255.0, 65025.0, 16581375.0) * vvv;
      enc = fract(enc);
      enc -= enc.yzww * vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 0.0);
      gl_FragColor = enc;
    }
  `,S=p.createShader(35633),C=p.createShader(35632),I=p.createProgram();if(!(C&&S&&I))return;p.shaderSource(S,v),p.shaderSource(C,x),p.compileShader(S),p.compileShader(C),p.attachShader(I,S),p.attachShader(I,C),p.linkProgram(I),p.detachShader(I,S),p.detachShader(I,C),p.deleteShader(S),p.deleteShader(C),p.useProgram(I);const L=p.createBuffer();p.bindBuffer(34962,L),p.bufferData(34962,new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),35044);const U=p.getAttribLocation(I,"aPosition");p.vertexAttribPointer(U,3,5126,!1,0,0),p.enableVertexAttribArray(U),p.clearColor(1,1,1,1),p.clear(16384),p.viewport(0,0,1,1),p.drawArrays(4,0,3);const R=new Uint8Array(4);return p.readPixels(0,0,1,1,6408,5121,R),p.deleteProgram(I),p.deleteBuffer(L),R.join("")}(o),r="801621810",i="8016218135",a="80162181161",c=qp!=null&&qp.isIpad?[["a7",a,12],["a8",i,15],["a8x",i,15],["a9",i,15],["a9x",i,15],["a10",i,15],["a10x",i,15],["a12",r,15],["a12x",r,15],["a12z",r,15],["a14",r,15],["a15",r,15],["m1",r,15],["m2",r,15]]:[["a7",a,12],["a8",i,12],["a9",i,15],["a10",i,15],["a11",r,15],["a12",r,15],["a13",r,15],["a14",r,15],["a15",r,15],["a16",r,15],["a17",r,15]];let h;return n==="80162181255"?h=c.filter(([,,p])=>p>=14):(h=c.filter(([,p])=>p===n),h.length||(h=c)),h.map(([p])=>`apple ${p} gpu`)}class G2e extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}const bG=[],j2e=[];function OWe(o,e){if(o===e)return 0;const t=o;o.length>e.length&&(o=e,e=t);let n=o.length,r=e.length;for(;n>0&&o.charCodeAt(~-n)===e.charCodeAt(~-r);)n--,r--;let i,a=0;for(;a<n&&o.charCodeAt(a)===e.charCodeAt(a);)a++;if(n-=a,r-=a,n===0)return r;let c,h,p=0,v=0,x=0;for(;v<n;)j2e[v]=o.charCodeAt(a+v),bG[v]=++v;for(;x<r;)for(i=e.charCodeAt(a+x),c=x++,p=x,v=0;v<n;v++)h=i===j2e[v]?c:c+1,c=bG[v],p=bG[v]=c>p?h>p?p+1:h:h>c?c+1:h;return p}function FWe(o){return o!=null}const LWe=({mobileTiers:o=[0,15,30,60],desktopTiers:e=[0,15,30,60],override:t={},glContext:n,failIfMajorPerformanceCaveat:r=!1,benchmarksURL:i="https://unpkg.com/detect-gpu@5.0.70/dist/benchmarks"}={})=>xG(void 0,void 0,void 0,function*(){const a={};if(e8e)return{tier:0,type:"SSR"};const{isIpad:c=!!(qp!=null&&qp.isIpad),isMobile:h=!!(qp!=null&&qp.isMobile),screenSize:p=window.screen,loadBenchmarks:v=ie=>xG(void 0,void 0,void 0,function*(){const ue=yield fetch(`${i}/${ie}`).then(ce=>ce.json());if(parseInt(ue.shift().split(".")[0],10)<4)throw new G2e("Detect GPU benchmark data is out of date. Please update to version 4x");return ue})}=t;let{renderer:x}=t;const S=(ie,ue,ce,Q,ae)=>({device:ae,fps:Q,gpu:ce,isMobile:h,tier:ie,type:ue});let C,I="";if(x)x=V2e(x),C=[x];else{const ie=n||function(ce,Q=!1){const ae={alpha:!1,antialias:!1,depth:!1,failIfMajorPerformanceCaveat:Q,powerPreference:"high-performance",stencil:!1};ce&&delete ae.powerPreference;const le=window.document.createElement("canvas"),J=le.getContext("webgl",ae)||le.getContext("experimental-webgl",ae);return J??void 0}(qp==null?void 0:qp.isSafari12,r);if(!ie)return S(0,"WEBGL_UNSUPPORTED");const ue=qp!=null&&qp.isFirefox?null:ie.getExtension("WEBGL_debug_renderer_info");if(x=ue?ie.getParameter(ue.UNMASKED_RENDERER_WEBGL):ie.getParameter(ie.RENDERER),!x)return S(1,"FALLBACK");I=x,x=V2e(x),C=function(ce,Q,ae){return Q==="apple gpu"?DWe(ce,Q,ae):[Q]}(ie,x,h)}const L=(yield Promise.all(C.map(function(ie){var ue;return xG(this,void 0,void 0,function*(){const ce=(Jt=>{const dt=h?["adreno","apple","mali-t","mali","nvidia","powervr","samsung"]:["intel","apple","amd","radeon","nvidia","geforce","adreno"];for(const Dt of dt)if(Jt.includes(Dt))return Dt})(ie);if(!ce)return;const Q=`${h?"m":"d"}-${ce}${c?"-ipad":""}.json`,ae=a[Q]=(ue=a[Q])!==null&&ue!==void 0?ue:v(Q);let le;try{le=yield ae}catch(Jt){if(Jt instanceof G2e)throw Jt;return}const J=function(Jt){var dt;const Dt=(Jt=Jt.replace(/\([^)]+\)/,"")).match(/\d+/)||Jt.match(/(\W|^)([A-Za-z]{1,3})(\W|$)/g);return(dt=Dt==null?void 0:Dt.join("").replace(/\W|amd/g,""))!==null&&dt!==void 0?dt:""}(ie);let Ue=le.filter(([,Jt])=>Jt===J);Ue.length||(Ue=le.filter(([Jt])=>Jt.includes(ie)));const je=Ue.length;if(je===0)return;const rt=ie.split(/[.,()\[\]/\s]/g).sort().filter((Jt,dt,Dt)=>dt===0||Jt!==Dt[dt-1]).join(" ");let at,[Se,,,,gt]=je>1?Ue.map(Jt=>[Jt,OWe(rt,Jt[2])]).sort(([,Jt],[,dt])=>Jt-dt)[0][0]:Ue[0],Ae=Number.MAX_VALUE;const{devicePixelRatio:lt}=window,pt=p.width*lt*p.height*lt;for(const Jt of gt){const[dt,Dt]=Jt,gn=dt*Dt,qt=Math.abs(pt-gn);qt<Ae&&(Ae=qt,at=Jt)}if(!at)return;const[,,De,_t]=at;return[Ae,De,Se,_t]})}))).filter(FWe).sort(([ie=Number.MAX_VALUE,ue],[ce=Number.MAX_VALUE,Q])=>ie===ce?ue-Q:ie-ce);if(!L.length){const ie=NWe.find(ue=>x.includes(ue));return ie?S(0,"BLOCKLISTED",ie):S(1,"FALLBACK",`${x} (${I})`)}const[,U,R,$]=L[0];if(U===-1)return S(0,"BLOCKLISTED",R,U,$);const Z=h?o:e;let k=0;for(let ie=0;ie<Z.length;ie++)U>=Z[ie]&&(k=ie);return S(k,"BENCHMARK",R,U,$)});function BWe(o){let e=0;const t=performance.now();function n(){e++;const r=performance.now();if(r-t>=100){const i=e/((r-t)/1e3),a=Math.round(i/30)*30;o(a)}else requestAnimationFrame(n)}requestAnimationFrame(n)}function UWe(o,e,t){return new Promise(n=>{LWe().then(r=>{let i=!1;const a=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);if(i="transferControlToOffscreen"in o,a){const h=navigator.userAgent.match(/version\/(\d+)/i);i=(h?parseInt(h[1]):0)>=17}const c={dpr:devicePixelRatio,fps:30,width:innerWidth,height:innerHeight,mobile:r.isMobile!==void 0?r.isMobile:!1,supportOffScreenCanvas:i,quality:2,dev:e,editor:t};r.tier===3?c.quality=0:r.tier===2&&(c.quality=1),BWe(h=>{c.fps=h,n(c)}),n(c)})})}let dg,yo,Bw="";function zWe(o){const e=Rn.useRef(null),t=Rn.useRef(null),n=o.app.components.get("theatre"),r=o.app.components.get("three");Rn.useEffect(()=>{const h=e.current;h.style.visibility=o.app.editor?"hidden":"inherit",n.sheet("App");const p=n==null?void 0:n.sheetObject("App","Box",{x:iH.types.number(100,{range:[0,window.innerWidth]}),y:iH.types.number(100,{range:[0,window.innerHeight]})},v=>{h.style.left=`${v.x}px`,h.style.top=`${v.y}px`});return()=>{p!==void 0&&(n==null||n.unsubscribe(p)),o.app.dispose()}},[]),Rn.useEffect(()=>{const h=t.current;h!==null&&UWe(h,J9e,_j).then(p=>console.log("Settings",p))},[]),o.app.isApp&&Rn.useEffect(()=>{const h=t.current;return console.log("WebGPU:",!1),dg=new tE({canvas:h,stencil:!1}),dg.shadowMap.enabled=!0,dg.setPixelRatio(devicePixelRatio),dg.setClearColor(0),r.setRenderer(dg,h),()=>{dg.dispose()}},[]),o.app.isApp&&Rn.useEffect(()=>{const h=new kWe;h.init(dg),document.body.appendChild(h.dom);let p=-1;const v=()=>{const S=window.innerWidth,C=window.innerHeight;yo==null||yo.resize(S,C),dg.setSize(S,C)},x=()=>{yo==null||yo.update(),h.begin(),yo==null||yo.draw(),h.end(),h.update(),p=requestAnimationFrame(x)};return window.addEventListener("resize",v),v(),x(),()=>{yo!==void 0&&(r.removeCamera(yo.camera),r.removeScene(yo),pf(yo)),window.removeEventListener("resize",v),cancelAnimationFrame(p),p=-1}},[]);const i=()=>{yo!==void 0&&(yo.camera!==void 0&&r.removeCamera(yo.camera),r.removeScene(yo),pf(yo)),Bw==="scene1"?yo=new Y5e:yo=new Z5e,yo.setup(o.app,dg),yo.init(),yo.resize(window.innerWidth,window.innerHeight)},a=()=>{Bw!=="scene1"&&(Bw="scene1",i())},c=()=>{Bw!=="scene2"&&(Bw="scene2",i())};return Rn.useEffect(()=>{const h=e.current;h.style.visibility=o.app.editor?"hidden":"inherit";const p=x=>{console.log("Custom:",x.value)},v=x=>{const S=x.value.value;S==="scene1"?a():S==="scene2"&&c()};return o.app.addEventListener(br.CUSTOM,p),o.app.addEventListener(br.SELECT_DROPDOWN,v),()=>{o.app.removeEventListener(br.CUSTOM,p),o.app.removeEventListener(br.SELECT_DROPDOWN,v)}},[]),Je.jsxs(Je.Fragment,{children:[o.app.isApp&&Je.jsx("canvas",{ref:t}),Je.jsx("div",{id:"box",ref:e,children:Je.jsx("button",{onClick:()=>{o.app.send({target:"editor",event:"custom",data:"hello editor!"}),n.playSheet("App")},children:"Click"})}),o.app.isApp&&Je.jsxs("div",{style:{position:"absolute",bottom:"20px",left:"20px"},children:[Je.jsx("button",{onClick:a,children:"Scene 1"}),Je.jsx("button",{onClick:c,children:"Scene 2"})]}),Je.jsx(IWe,{app:o.app,three:r})]})}function VWe(o){const[e,t]=Rn.useState(!1);return Rn.useEffect(()=>{const n=()=>{w6.removeEventListener(X3.LOAD_COMPLETE,n),t(!0)};w6.addEventListener(X3.LOAD_COMPLETE,n),MWe(o.app)},[t]),Je.jsxs(Je.Fragment,{children:[!e&&Je.jsx("p",{children:"Loading..."}),e&&Je.jsx(zWe,{app:o.app})]})}function GWe(){const o=Rn.useMemo(()=>{const e=new rIe("ws://localhost:8080",J9e,_j);return e.addComponent("theatre",new lIe(e)),e.addComponent("three",new pIe(e)),e},[]);return Je.jsxs(Je.Fragment,{children:[Je.jsx(gIe,{app:o}),_j&&Je.jsx(PWe,{app:o}),Je.jsx(VWe,{app:o})]})}W2e.initialize();$Ee.createRoot(document.getElementById("root")).render(Je.jsx(Je.Fragment,{children:Je.jsx(Je.Fragment,{children:Je.jsx(GWe,{})})}));
